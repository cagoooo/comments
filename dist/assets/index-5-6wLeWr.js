var CA=Object.defineProperty;var IA=(t,e,r)=>e in t?CA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var cm=(t,e,r)=>IA(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var e0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var um={exports:{}},bu={},fm={exports:{}},yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R_;function FA(){if(R_)return yt;R_=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function x(ee){return ee===null||typeof ee!="object"?null:(ee=g&&ee[g]||ee["@@iterator"],typeof ee=="function"?ee:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,w={};function S(ee,O,te){this.props=ee,this.context=O,this.refs=w,this.updater=te||y}S.prototype.isReactComponent={},S.prototype.setState=function(ee,O){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,O,"setState")},S.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function N(){}N.prototype=S.prototype;function B(ee,O,te){this.props=ee,this.context=O,this.refs=w,this.updater=te||y}var b=B.prototype=new N;b.constructor=B,k(b,S.prototype),b.isPureReactComponent=!0;var j=Array.isArray,X=Object.prototype.hasOwnProperty,G={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function C(ee,O,te){var J,Z={},oe=null,_e=null;if(O!=null)for(J in O.ref!==void 0&&(_e=O.ref),O.key!==void 0&&(oe=""+O.key),O)X.call(O,J)&&!A.hasOwnProperty(J)&&(Z[J]=O[J]);var ve=arguments.length-2;if(ve===1)Z.children=te;else if(1<ve){for(var xe=Array(ve),Ee=0;Ee<ve;Ee++)xe[Ee]=arguments[Ee+2];Z.children=xe}if(ee&&ee.defaultProps)for(J in ve=ee.defaultProps,ve)Z[J]===void 0&&(Z[J]=ve[J]);return{$$typeof:t,type:ee,key:oe,ref:_e,props:Z,_owner:G.current}}function F(ee,O){return{$$typeof:t,type:ee.type,key:O,ref:ee.ref,props:ee.props,_owner:ee._owner}}function V(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===t}function M(ee){var O={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(te){return O[te]})}var D=/\/+/g;function L(ee,O){return typeof ee=="object"&&ee!==null&&ee.key!=null?M(""+ee.key):O.toString(36)}function ke(ee,O,te,J,Z){var oe=typeof ee;(oe==="undefined"||oe==="boolean")&&(ee=null);var _e=!1;if(ee===null)_e=!0;else switch(oe){case"string":case"number":_e=!0;break;case"object":switch(ee.$$typeof){case t:case e:_e=!0}}if(_e)return _e=ee,Z=Z(_e),ee=J===""?"."+L(_e,0):J,j(Z)?(te="",ee!=null&&(te=ee.replace(D,"$&/")+"/"),ke(Z,O,te,"",function(Ee){return Ee})):Z!=null&&(V(Z)&&(Z=F(Z,te+(!Z.key||_e&&_e.key===Z.key?"":(""+Z.key).replace(D,"$&/")+"/")+ee)),O.push(Z)),1;if(_e=0,J=J===""?".":J+":",j(ee))for(var ve=0;ve<ee.length;ve++){oe=ee[ve];var xe=J+L(oe,ve);_e+=ke(oe,O,te,xe,Z)}else if(xe=x(ee),typeof xe=="function")for(ee=xe.call(ee),ve=0;!(oe=ee.next()).done;)oe=oe.value,xe=J+L(oe,ve++),_e+=ke(oe,O,te,xe,Z);else if(oe==="object")throw O=String(ee),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.");return _e}function Se(ee,O,te){if(ee==null)return ee;var J=[],Z=0;return ke(ee,J,"","",function(oe){return O.call(te,oe,Z++)}),J}function De(ee){if(ee._status===-1){var O=ee._result;O=O(),O.then(function(te){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=te)},function(te){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=te)}),ee._status===-1&&(ee._status=0,ee._result=O)}if(ee._status===1)return ee._result.default;throw ee._result}var Ne={current:null},Ce={transition:null},ne={ReactCurrentDispatcher:Ne,ReactCurrentBatchConfig:Ce,ReactCurrentOwner:G};function ye(){throw Error("act(...) is not supported in production builds of React.")}return yt.Children={map:Se,forEach:function(ee,O,te){Se(ee,function(){O.apply(this,arguments)},te)},count:function(ee){var O=0;return Se(ee,function(){O++}),O},toArray:function(ee){return Se(ee,function(O){return O})||[]},only:function(ee){if(!V(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}},yt.Component=S,yt.Fragment=r,yt.Profiler=s,yt.PureComponent=B,yt.StrictMode=n,yt.Suspense=u,yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,yt.act=ye,yt.cloneElement=function(ee,O,te){if(ee==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ee+".");var J=k({},ee.props),Z=ee.key,oe=ee.ref,_e=ee._owner;if(O!=null){if(O.ref!==void 0&&(oe=O.ref,_e=G.current),O.key!==void 0&&(Z=""+O.key),ee.type&&ee.type.defaultProps)var ve=ee.type.defaultProps;for(xe in O)X.call(O,xe)&&!A.hasOwnProperty(xe)&&(J[xe]=O[xe]===void 0&&ve!==void 0?ve[xe]:O[xe])}var xe=arguments.length-2;if(xe===1)J.children=te;else if(1<xe){ve=Array(xe);for(var Ee=0;Ee<xe;Ee++)ve[Ee]=arguments[Ee+2];J.children=ve}return{$$typeof:t,type:ee.type,key:Z,ref:oe,props:J,_owner:_e}},yt.createContext=function(ee){return ee={$$typeof:o,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ee.Provider={$$typeof:i,_context:ee},ee.Consumer=ee},yt.createElement=C,yt.createFactory=function(ee){var O=C.bind(null,ee);return O.type=ee,O},yt.createRef=function(){return{current:null}},yt.forwardRef=function(ee){return{$$typeof:c,render:ee}},yt.isValidElement=V,yt.lazy=function(ee){return{$$typeof:d,_payload:{_status:-1,_result:ee},_init:De}},yt.memo=function(ee,O){return{$$typeof:h,type:ee,compare:O===void 0?null:O}},yt.startTransition=function(ee){var O=Ce.transition;Ce.transition={};try{ee()}finally{Ce.transition=O}},yt.unstable_act=ye,yt.useCallback=function(ee,O){return Ne.current.useCallback(ee,O)},yt.useContext=function(ee){return Ne.current.useContext(ee)},yt.useDebugValue=function(){},yt.useDeferredValue=function(ee){return Ne.current.useDeferredValue(ee)},yt.useEffect=function(ee,O){return Ne.current.useEffect(ee,O)},yt.useId=function(){return Ne.current.useId()},yt.useImperativeHandle=function(ee,O,te){return Ne.current.useImperativeHandle(ee,O,te)},yt.useInsertionEffect=function(ee,O){return Ne.current.useInsertionEffect(ee,O)},yt.useLayoutEffect=function(ee,O){return Ne.current.useLayoutEffect(ee,O)},yt.useMemo=function(ee,O){return Ne.current.useMemo(ee,O)},yt.useReducer=function(ee,O,te){return Ne.current.useReducer(ee,O,te)},yt.useRef=function(ee){return Ne.current.useRef(ee)},yt.useState=function(ee){return Ne.current.useState(ee)},yt.useSyncExternalStore=function(ee,O,te){return Ne.current.useSyncExternalStore(ee,O,te)},yt.useTransition=function(){return Ne.current.useTransition()},yt.version="18.3.1",yt}var D_;function Og(){return D_||(D_=1,fm.exports=FA()),fm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P_;function bA(){if(P_)return bu;P_=1;var t=Og(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(c,u,h){var d,g={},x=null,y=null;h!==void 0&&(x=""+h),u.key!==void 0&&(x=""+u.key),u.ref!==void 0&&(y=u.ref);for(d in u)n.call(u,d)&&!i.hasOwnProperty(d)&&(g[d]=u[d]);if(c&&c.defaultProps)for(d in u=c.defaultProps,u)g[d]===void 0&&(g[d]=u[d]);return{$$typeof:e,type:c,key:x,ref:y,props:g,_owner:s.current}}return bu.Fragment=r,bu.jsx=o,bu.jsxs=o,bu}var O_;function NA(){return O_||(O_=1,um.exports=bA()),um.exports}var v=NA(),Te=Og();const tf=Nw(Te);var t0={},hm={exports:{}},ns={},dm={exports:{}},pm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L_;function RA(){return L_||(L_=1,(function(t){function e(Ce,ne){var ye=Ce.length;Ce.push(ne);e:for(;0<ye;){var ee=ye-1>>>1,O=Ce[ee];if(0<s(O,ne))Ce[ee]=ne,Ce[ye]=O,ye=ee;else break e}}function r(Ce){return Ce.length===0?null:Ce[0]}function n(Ce){if(Ce.length===0)return null;var ne=Ce[0],ye=Ce.pop();if(ye!==ne){Ce[0]=ye;e:for(var ee=0,O=Ce.length,te=O>>>1;ee<te;){var J=2*(ee+1)-1,Z=Ce[J],oe=J+1,_e=Ce[oe];if(0>s(Z,ye))oe<O&&0>s(_e,Z)?(Ce[ee]=_e,Ce[oe]=ye,ee=oe):(Ce[ee]=Z,Ce[J]=ye,ee=J);else if(oe<O&&0>s(_e,ye))Ce[ee]=_e,Ce[oe]=ye,ee=oe;else break e}}return ne}function s(Ce,ne){var ye=Ce.sortIndex-ne.sortIndex;return ye!==0?ye:Ce.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],h=[],d=1,g=null,x=3,y=!1,k=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(Ce){for(var ne=r(h);ne!==null;){if(ne.callback===null)n(h);else if(ne.startTime<=Ce)n(h),ne.sortIndex=ne.expirationTime,e(u,ne);else break;ne=r(h)}}function j(Ce){if(w=!1,b(Ce),!k)if(r(u)!==null)k=!0,De(X);else{var ne=r(h);ne!==null&&Ne(j,ne.startTime-Ce)}}function X(Ce,ne){k=!1,w&&(w=!1,N(C),C=-1),y=!0;var ye=x;try{for(b(ne),g=r(u);g!==null&&(!(g.expirationTime>ne)||Ce&&!M());){var ee=g.callback;if(typeof ee=="function"){g.callback=null,x=g.priorityLevel;var O=ee(g.expirationTime<=ne);ne=t.unstable_now(),typeof O=="function"?g.callback=O:g===r(u)&&n(u),b(ne)}else n(u);g=r(u)}if(g!==null)var te=!0;else{var J=r(h);J!==null&&Ne(j,J.startTime-ne),te=!1}return te}finally{g=null,x=ye,y=!1}}var G=!1,A=null,C=-1,F=5,V=-1;function M(){return!(t.unstable_now()-V<F)}function D(){if(A!==null){var Ce=t.unstable_now();V=Ce;var ne=!0;try{ne=A(!0,Ce)}finally{ne?L():(G=!1,A=null)}}else G=!1}var L;if(typeof B=="function")L=function(){B(D)};else if(typeof MessageChannel<"u"){var ke=new MessageChannel,Se=ke.port2;ke.port1.onmessage=D,L=function(){Se.postMessage(null)}}else L=function(){S(D,0)};function De(Ce){A=Ce,G||(G=!0,L())}function Ne(Ce,ne){C=S(function(){Ce(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ce){Ce.callback=null},t.unstable_continueExecution=function(){k||y||(k=!0,De(X))},t.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<Ce?Math.floor(1e3/Ce):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(Ce){switch(x){case 1:case 2:case 3:var ne=3;break;default:ne=x}var ye=x;x=ne;try{return Ce()}finally{x=ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ce,ne){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var ye=x;x=Ce;try{return ne()}finally{x=ye}},t.unstable_scheduleCallback=function(Ce,ne,ye){var ee=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?ee+ye:ee):ye=ee,Ce){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ye+O,Ce={id:d++,callback:ne,priorityLevel:Ce,startTime:ye,expirationTime:O,sortIndex:-1},ye>ee?(Ce.sortIndex=ye,e(h,Ce),r(u)===null&&Ce===r(h)&&(w?(N(C),C=-1):w=!0,Ne(j,ye-ee))):(Ce.sortIndex=O,e(u,Ce),k||y||(k=!0,De(X))),Ce},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(Ce){var ne=x;return function(){var ye=x;x=ne;try{return Ce.apply(this,arguments)}finally{x=ye}}}})(pm)),pm}var M_;function DA(){return M_||(M_=1,dm.exports=RA()),dm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B_;function PA(){if(B_)return ns;B_=1;var t=Og(),e=DA();function r(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function i(a,l){o(a,l),o(a+"Capture",l)}function o(a,l){for(s[a]=l,a=0;a<l.length;a++)n.add(l[a])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},g={};function x(a){return u.call(g,a)?!0:u.call(d,a)?!1:h.test(a)?g[a]=!0:(d[a]=!0,!1)}function y(a,l,f,m){if(f!==null&&f.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return m?!1:f!==null?!f.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function k(a,l,f,m){if(l===null||typeof l>"u"||y(a,l,f,m))return!0;if(m)return!1;if(f!==null)switch(f.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function w(a,l,f,m,_,E,R){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=m,this.attributeNamespace=_,this.mustUseProperty=f,this.propertyName=a,this.type=l,this.sanitizeURL=E,this.removeEmptyString=R}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){S[a]=new w(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var l=a[0];S[l]=new w(l,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){S[a]=new w(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){S[a]=new w(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){S[a]=new w(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){S[a]=new w(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){S[a]=new w(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){S[a]=new w(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){S[a]=new w(a,5,!1,a.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function B(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var l=a.replace(N,B);S[l]=new w(l,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var l=a.replace(N,B);S[l]=new w(l,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var l=a.replace(N,B);S[l]=new w(l,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){S[a]=new w(a,1,!1,a.toLowerCase(),null,!1,!1)}),S.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){S[a]=new w(a,1,!1,a.toLowerCase(),null,!0,!0)});function b(a,l,f,m){var _=S.hasOwnProperty(l)?S[l]:null;(_!==null?_.type!==0:m||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(k(l,f,_,m)&&(f=null),m||_===null?x(l)&&(f===null?a.removeAttribute(l):a.setAttribute(l,""+f)):_.mustUseProperty?a[_.propertyName]=f===null?_.type===3?!1:"":f:(l=_.attributeName,m=_.attributeNamespace,f===null?a.removeAttribute(l):(_=_.type,f=_===3||_===4&&f===!0?"":""+f,m?a.setAttributeNS(m,l,f):a.setAttribute(l,f))))}var j=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,X=Symbol.for("react.element"),G=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),M=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),ke=Symbol.for("react.suspense_list"),Se=Symbol.for("react.memo"),De=Symbol.for("react.lazy"),Ne=Symbol.for("react.offscreen"),Ce=Symbol.iterator;function ne(a){return a===null||typeof a!="object"?null:(a=Ce&&a[Ce]||a["@@iterator"],typeof a=="function"?a:null)}var ye=Object.assign,ee;function O(a){if(ee===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);ee=l&&l[1]||""}return`
`+ee+a}var te=!1;function J(a,l){if(!a||te)return"";te=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(de){var m=de}Reflect.construct(a,[],l)}else{try{l.call()}catch(de){m=de}a.call(l.prototype)}else{try{throw Error()}catch(de){m=de}a()}}catch(de){if(de&&m&&typeof de.stack=="string"){for(var _=de.stack.split(`
`),E=m.stack.split(`
`),R=_.length-1,Q=E.length-1;1<=R&&0<=Q&&_[R]!==E[Q];)Q--;for(;1<=R&&0<=Q;R--,Q--)if(_[R]!==E[Q]){if(R!==1||Q!==1)do if(R--,Q--,0>Q||_[R]!==E[Q]){var re=`
`+_[R].replace(" at new "," at ");return a.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",a.displayName)),re}while(1<=R&&0<=Q);break}}}finally{te=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?O(a):""}function Z(a){switch(a.tag){case 5:return O(a.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return a=J(a.type,!1),a;case 11:return a=J(a.type.render,!1),a;case 1:return a=J(a.type,!0),a;default:return""}}function oe(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case A:return"Fragment";case G:return"Portal";case F:return"Profiler";case C:return"StrictMode";case L:return"Suspense";case ke:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case M:return(a.displayName||"Context")+".Consumer";case V:return(a._context.displayName||"Context")+".Provider";case D:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Se:return l=a.displayName||null,l!==null?l:oe(a.type)||"Memo";case De:l=a._payload,a=a._init;try{return oe(a(l))}catch{}}return null}function _e(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oe(l);case 8:return l===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ve(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function xe(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ee(a){var l=xe(a)?"checked":"value",f=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),m=""+a[l];if(!a.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var _=f.get,E=f.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return _.call(this)},set:function(R){m=""+R,E.call(this,R)}}),Object.defineProperty(a,l,{enumerable:f.enumerable}),{getValue:function(){return m},setValue:function(R){m=""+R},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function st(a){a._valueTracker||(a._valueTracker=Ee(a))}function Y(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var f=l.getValue(),m="";return a&&(m=xe(a)?a.checked?"true":"false":a.value),a=m,a!==f?(l.setValue(a),!0):!1}function Et(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function gt(a,l){var f=l.checked;return ye({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??a._wrapperState.initialChecked})}function It(a,l){var f=l.defaultValue==null?"":l.defaultValue,m=l.checked!=null?l.checked:l.defaultChecked;f=ve(l.value!=null?l.value:f),a._wrapperState={initialChecked:m,initialValue:f,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function ht(a,l){l=l.checked,l!=null&&b(a,"checked",l,!1)}function je(a,l){ht(a,l);var f=ve(l.value),m=l.type;if(f!=null)m==="number"?(f===0&&a.value===""||a.value!=f)&&(a.value=""+f):a.value!==""+f&&(a.value=""+f);else if(m==="submit"||m==="reset"){a.removeAttribute("value");return}l.hasOwnProperty("value")?St(a,l.type,f):l.hasOwnProperty("defaultValue")&&St(a,l.type,ve(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(a.defaultChecked=!!l.defaultChecked)}function Ht(a,l,f){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var m=l.type;if(!(m!=="submit"&&m!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+a._wrapperState.initialValue,f||l===a.value||(a.value=l),a.defaultValue=l}f=a.name,f!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,f!==""&&(a.name=f)}function St(a,l,f){(l!=="number"||Et(a.ownerDocument)!==a)&&(f==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+f&&(a.defaultValue=""+f))}var Tt=Array.isArray;function fr(a,l,f,m){if(a=a.options,l){l={};for(var _=0;_<f.length;_++)l["$"+f[_]]=!0;for(f=0;f<a.length;f++)_=l.hasOwnProperty("$"+a[f].value),a[f].selected!==_&&(a[f].selected=_),_&&m&&(a[f].defaultSelected=!0)}else{for(f=""+ve(f),l=null,_=0;_<a.length;_++){if(a[_].value===f){a[_].selected=!0,m&&(a[_].defaultSelected=!0);return}l!==null||a[_].disabled||(l=a[_])}l!==null&&(l.selected=!0)}}function Xn(a,l){if(l.dangerouslySetInnerHTML!=null)throw Error(r(91));return ye({},l,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function ln(a,l){var f=l.value;if(f==null){if(f=l.children,l=l.defaultValue,f!=null){if(l!=null)throw Error(r(92));if(Tt(f)){if(1<f.length)throw Error(r(93));f=f[0]}l=f}l==null&&(l=""),f=l}a._wrapperState={initialValue:ve(f)}}function $r(a,l){var f=ve(l.value),m=ve(l.defaultValue);f!=null&&(f=""+f,f!==a.value&&(a.value=f),l.defaultValue==null&&a.defaultValue!==f&&(a.defaultValue=f)),m!=null&&(a.defaultValue=""+m)}function Dr(a){var l=a.textContent;l===a._wrapperState.initialValue&&l!==""&&l!==null&&(a.value=l)}function yn(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Un(a,l){return a==null||a==="http://www.w3.org/1999/xhtml"?yn(l):a==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var $t,Jr=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,f,m,_){MSApp.execUnsafeLocalFunction(function(){return a(l,f,m,_)})}:a})(function(a,l){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=l;else{for($t=$t||document.createElement("div"),$t.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=$t.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}});function ot(a,l){if(l){var f=a.firstChild;if(f&&f===a.lastChild&&f.nodeType===3){f.nodeValue=l;return}}a.textContent=l}var Rt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gr=["Webkit","ms","Moz","O"];Object.keys(Rt).forEach(function(a){Gr.forEach(function(l){l=l+a.charAt(0).toUpperCase()+a.substring(1),Rt[l]=Rt[a]})});function jt(a,l,f){return l==null||typeof l=="boolean"||l===""?"":f||typeof l!="number"||l===0||Rt.hasOwnProperty(a)&&Rt[a]?(""+l).trim():l+"px"}function wn(a,l){a=a.style;for(var f in l)if(l.hasOwnProperty(f)){var m=f.indexOf("--")===0,_=jt(f,l[f],m);f==="float"&&(f="cssFloat"),m?a.setProperty(f,_):a[f]=_}}var hi=ye({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function En(a,l){if(l){if(hi[a]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(r(137,a));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(r(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(r(61))}if(l.style!=null&&typeof l.style!="object")throw Error(r(62))}}function di(a,l){if(a.indexOf("-")===-1)return typeof l.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var us=null;function Ks(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Yn=null,Qn=null,Zt=null;function As(a){if(a=mu(a)){if(typeof Yn!="function")throw Error(r(280));var l=a.stateNode;l&&(l=mh(l),Yn(a.stateNode,a.type,l))}}function Cs(a){Qn?Zt?Zt.push(a):Zt=[a]:Qn=a}function Is(){if(Qn){var a=Qn,l=Zt;if(Zt=Qn=null,As(a),l)for(a=0;a<l.length;a++)As(l[a])}}function Ia(a,l){return a(l)}function Qe(){}var Je=!1;function Ut(a,l,f){if(Je)return a(l,f);Je=!0;try{return Ia(a,l,f)}finally{Je=!1,(Qn!==null||Zt!==null)&&(Qe(),Is())}}function rr(a,l){var f=a.stateNode;if(f===null)return null;var m=mh(f);if(m===null)return null;f=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var hr=!1;if(c)try{var Zr={};Object.defineProperty(Zr,"passive",{get:function(){hr=!0}}),window.addEventListener("test",Zr,Zr),window.removeEventListener("test",Zr,Zr)}catch{hr=!1}function Gi(a,l,f,m,_,E,R,Q,re){var de=Array.prototype.slice.call(arguments,3);try{l.apply(f,de)}catch(be){this.onError(be)}}var cn=!1,Pr=null,P=!1,H=null,z={onError:function(a){cn=!0,Pr=a}};function W(a,l,f,m,_,E,R,Q,re){cn=!1,Pr=null,Gi.apply(z,arguments)}function K(a,l,f,m,_,E,R,Q,re){if(W.apply(this,arguments),cn){if(cn){var de=Pr;cn=!1,Pr=null}else throw Error(r(198));P||(P=!0,H=de)}}function q(a){var l=a,f=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(f=l.return),a=l.return;while(a)}return l.tag===3?f:null}function ce(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function ge(a){if(q(a)!==a)throw Error(r(188))}function le(a){var l=a.alternate;if(!l){if(l=q(a),l===null)throw Error(r(188));return l!==a?null:a}for(var f=a,m=l;;){var _=f.return;if(_===null)break;var E=_.alternate;if(E===null){if(m=_.return,m!==null){f=m;continue}break}if(_.child===E.child){for(E=_.child;E;){if(E===f)return ge(_),a;if(E===m)return ge(_),l;E=E.sibling}throw Error(r(188))}if(f.return!==m.return)f=_,m=E;else{for(var R=!1,Q=_.child;Q;){if(Q===f){R=!0,f=_,m=E;break}if(Q===m){R=!0,m=_,f=E;break}Q=Q.sibling}if(!R){for(Q=E.child;Q;){if(Q===f){R=!0,f=E,m=_;break}if(Q===m){R=!0,m=E,f=_;break}Q=Q.sibling}if(!R)throw Error(r(189))}}if(f.alternate!==m)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?a:l}function fe(a){return a=le(a),a!==null?he(a):null}function he(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=he(a);if(l!==null)return l;a=a.sibling}return null}var Re=e.unstable_scheduleCallback,Be=e.unstable_cancelCallback,We=e.unstable_shouldYield,Pe=e.unstable_requestPaint,Oe=e.unstable_now,ct=e.unstable_getCurrentPriorityLevel,zt=e.unstable_ImmediatePriority,Gt=e.unstable_UserBlockingPriority,cr=e.unstable_NormalPriority,qs=e.unstable_LowPriority,Fs=e.unstable_IdlePriority,fs=null,Ar=null;function Fa(a){if(Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(fs,a,void 0,(a.current.flags&128)===128)}catch{}}var dr=Math.clz32?Math.clz32:Ao,pi=Math.log,bs=Math.LN2;function Ao(a){return a>>>=0,a===0?32:31-(pi(a)/bs|0)|0}var mi=64,ba=4194304;function Bt(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Ki(a,l){var f=a.pendingLanes;if(f===0)return 0;var m=0,_=a.suspendedLanes,E=a.pingedLanes,R=f&268435455;if(R!==0){var Q=R&~_;Q!==0?m=Bt(Q):(E&=R,E!==0&&(m=Bt(E)))}else R=f&~_,R!==0?m=Bt(R):E!==0&&(m=Bt(E));if(m===0)return 0;if(l!==0&&l!==m&&(l&_)===0&&(_=m&-m,E=l&-l,_>=E||_===16&&(E&4194240)!==0))return l;if((m&4)!==0&&(m|=f&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=m;0<l;)f=31-dr(l),_=1<<f,m|=a[f],l&=~_;return m}function Co(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Io(a,l){for(var f=a.suspendedLanes,m=a.pingedLanes,_=a.expirationTimes,E=a.pendingLanes;0<E;){var R=31-dr(E),Q=1<<R,re=_[R];re===-1?((Q&f)===0||(Q&m)!==0)&&(_[R]=Co(Q,l)):re<=l&&(a.expiredLanes|=Q),E&=~Q}}function qc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Xc(){var a=mi;return mi<<=1,(mi&4194240)===0&&(mi=64),a}function Yc(a){for(var l=[],f=0;31>f;f++)l.push(a);return l}function Fo(a,l,f){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-dr(l),a[l]=f}function Ud(a,l){var f=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var m=a.eventTimes;for(a=a.expirationTimes;0<f;){var _=31-dr(f),E=1<<_;l[_]=0,m[_]=-1,a[_]=-1,f&=~E}}function Qc(a,l){var f=a.entangledLanes|=l;for(a=a.entanglements;f;){var m=31-dr(f),_=1<<m;_&l|a[m]&l&&(a[m]|=l),f&=~_}}var Ft=0;function gi(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Jc,Al,Zc,eu,tu,xi=!1,Cl=[],vi=null,_i=null,un=null,bo=new Map,qi=new Map,hs=[],Zf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Na(a,l){switch(a){case"focusin":case"focusout":vi=null;break;case"dragenter":case"dragleave":_i=null;break;case"mouseover":case"mouseout":un=null;break;case"pointerover":case"pointerout":bo.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":qi.delete(l.pointerId)}}function Xs(a,l,f,m,_,E){return a===null||a.nativeEvent!==E?(a={blockedOn:l,domEventName:f,eventSystemFlags:m,nativeEvent:E,targetContainers:[_]},l!==null&&(l=mu(l),l!==null&&Al(l)),a):(a.eventSystemFlags|=m,l=a.targetContainers,_!==null&&l.indexOf(_)===-1&&l.push(_),a)}function eh(a,l,f,m,_){switch(l){case"focusin":return vi=Xs(vi,a,l,f,m,_),!0;case"dragenter":return _i=Xs(_i,a,l,f,m,_),!0;case"mouseover":return un=Xs(un,a,l,f,m,_),!0;case"pointerover":var E=_.pointerId;return bo.set(E,Xs(bo.get(E)||null,a,l,f,m,_)),!0;case"gotpointercapture":return E=_.pointerId,qi.set(E,Xs(qi.get(E)||null,a,l,f,m,_)),!0}return!1}function Il(a){var l=Po(a.target);if(l!==null){var f=q(l);if(f!==null){if(l=f.tag,l===13){if(l=ce(f),l!==null){a.blockedOn=l,tu(a.priority,function(){Zc(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){a.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Jt(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var f=Fl(a.domEventName,a.eventSystemFlags,l[0],a.nativeEvent);if(f===null){f=a.nativeEvent;var m=new f.constructor(f.type,f);us=m,f.target.dispatchEvent(m),us=null}else return l=mu(f),l!==null&&Al(l),a.blockedOn=f,!1;l.shift()}return!0}function th(a,l,f){Jt(a)&&f.delete(l)}function zd(){xi=!1,vi!==null&&Jt(vi)&&(vi=null),_i!==null&&Jt(_i)&&(_i=null),un!==null&&Jt(un)&&(un=null),bo.forEach(th),qi.forEach(th)}function Ra(a,l){a.blockedOn===l&&(a.blockedOn=null,xi||(xi=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,zd)))}function Da(a){function l(_){return Ra(_,a)}if(0<Cl.length){Ra(Cl[0],a);for(var f=1;f<Cl.length;f++){var m=Cl[f];m.blockedOn===a&&(m.blockedOn=null)}}for(vi!==null&&Ra(vi,a),_i!==null&&Ra(_i,a),un!==null&&Ra(un,a),bo.forEach(l),qi.forEach(l),f=0;f<hs.length;f++)m=hs[f],m.blockedOn===a&&(m.blockedOn=null);for(;0<hs.length&&(f=hs[0],f.blockedOn===null);)Il(f),f.blockedOn===null&&hs.shift()}var Xi=j.ReactCurrentBatchConfig,Yi=!0;function yi(a,l,f,m){var _=Ft,E=Xi.transition;Xi.transition=null;try{Ft=1,ru(a,l,f,m)}finally{Ft=_,Xi.transition=E}}function rh(a,l,f,m){var _=Ft,E=Xi.transition;Xi.transition=null;try{Ft=4,ru(a,l,f,m)}finally{Ft=_,Xi.transition=E}}function ru(a,l,f,m){if(Yi){var _=Fl(a,l,f,m);if(_===null)Zd(a,l,m,wi,f),Na(a,m);else if(eh(_,a,l,f,m))m.stopPropagation();else if(Na(a,m),l&4&&-1<Zf.indexOf(a)){for(;_!==null;){var E=mu(_);if(E!==null&&Jc(E),E=Fl(a,l,f,m),E===null&&Zd(a,l,m,wi,f),E===_)break;_=E}_!==null&&m.stopPropagation()}else Zd(a,l,m,null,f)}}var wi=null;function Fl(a,l,f,m){if(wi=null,a=Ks(m),a=Po(a),a!==null)if(l=q(a),l===null)a=null;else if(f=l.tag,f===13){if(a=ce(l),a!==null)return a;a=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null);return wi=a,null}function bl(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ct()){case zt:return 1;case Gt:return 4;case cr:case qs:return 16;case Fs:return 536870912;default:return 16}default:return 16}}var ds=null,Nl=null,Qi=null;function nh(){if(Qi)return Qi;var a,l=Nl,f=l.length,m,_="value"in ds?ds.value:ds.textContent,E=_.length;for(a=0;a<f&&l[a]===_[a];a++);var R=f-a;for(m=1;m<=R&&l[f-m]===_[E-m];m++);return Qi=_.slice(a,1<m?1-m:void 0)}function No(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function Ei(){return!0}function nu(){return!1}function Tn(a){function l(f,m,_,E,R){this._reactName=f,this._targetInst=_,this.type=m,this.nativeEvent=E,this.target=R,this.currentTarget=null;for(var Q in a)a.hasOwnProperty(Q)&&(f=a[Q],this[Q]=f?f(E):E[Q]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?Ei:nu,this.isPropagationStopped=nu,this}return ye(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Ei)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Ei)},persist:function(){},isPersistent:Ei}),l}var Ti={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ro=Tn(Ti),Pa=ye({},Ti,{view:0,detail:0}),Rl=Tn(Pa),Dl,Pl,ps,Do=ye({},Pa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pt,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ps&&(ps&&a.type==="mousemove"?(Dl=a.screenX-ps.screenX,Pl=a.screenY-ps.screenY):Pl=Dl=0,ps=a),Dl)},movementY:function(a){return"movementY"in a?a.movementY:Pl}}),su=Tn(Do),sh=ye({},Do,{dataTransfer:0}),ih=Tn(sh),Ol=ye({},Pa,{relatedTarget:0}),fn=Tn(Ol),ah=ye({},Ti,{animationName:0,elapsedTime:0,pseudoElement:0}),oh=Tn(ah),Oa=ye({},Ti,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),p=Tn(Oa),T=ye({},Ti,{data:0}),I=Tn(T),U={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ae={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ze(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=pe[a])?!!l[a]:!1}function pt(){return ze}var Cr=ye({},Pa,{key:function(a){if(a.key){var l=U[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=No(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?ae[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pt,charCode:function(a){return a.type==="keypress"?No(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?No(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Kt=Tn(Cr),Or=ye({},Do,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ms=Tn(Or),Ji=ye({},Pa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pt}),Si=Tn(Ji),ki=ye({},Ti,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ll=Tn(ki),iu=ye({},Do,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),w4=Tn(iu),E4=[9,13,27,32],Wd=c&&"CompositionEvent"in window,au=null;c&&"documentMode"in document&&(au=document.documentMode);var T4=c&&"TextEvent"in window&&!au,Sx=c&&(!Wd||au&&8<au&&11>=au),kx=" ",Ax=!1;function Cx(a,l){switch(a){case"keyup":return E4.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ix(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ml=!1;function S4(a,l){switch(a){case"compositionend":return Ix(l);case"keypress":return l.which!==32?null:(Ax=!0,kx);case"textInput":return a=l.data,a===kx&&Ax?null:a;default:return null}}function k4(a,l){if(Ml)return a==="compositionend"||!Wd&&Cx(a,l)?(a=nh(),Qi=Nl=ds=null,Ml=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Sx&&l.locale!=="ko"?null:l.data;default:return null}}var A4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fx(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!A4[a.type]:l==="textarea"}function bx(a,l,f,m){Cs(m),l=hh(l,"onChange"),0<l.length&&(f=new Ro("onChange","change",null,f,m),a.push({event:f,listeners:l}))}var ou=null,lu=null;function C4(a){qx(a,0)}function lh(a){var l=zl(a);if(Y(l))return a}function I4(a,l){if(a==="change")return l}var Nx=!1;if(c){var Hd;if(c){var $d="oninput"in document;if(!$d){var Rx=document.createElement("div");Rx.setAttribute("oninput","return;"),$d=typeof Rx.oninput=="function"}Hd=$d}else Hd=!1;Nx=Hd&&(!document.documentMode||9<document.documentMode)}function Dx(){ou&&(ou.detachEvent("onpropertychange",Px),lu=ou=null)}function Px(a){if(a.propertyName==="value"&&lh(lu)){var l=[];bx(l,lu,a,Ks(a)),Ut(C4,l)}}function F4(a,l,f){a==="focusin"?(Dx(),ou=l,lu=f,ou.attachEvent("onpropertychange",Px)):a==="focusout"&&Dx()}function b4(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return lh(lu)}function N4(a,l){if(a==="click")return lh(l)}function R4(a,l){if(a==="input"||a==="change")return lh(l)}function D4(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Ys=typeof Object.is=="function"?Object.is:D4;function cu(a,l){if(Ys(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var f=Object.keys(a),m=Object.keys(l);if(f.length!==m.length)return!1;for(m=0;m<f.length;m++){var _=f[m];if(!u.call(l,_)||!Ys(a[_],l[_]))return!1}return!0}function Ox(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Lx(a,l){var f=Ox(a);a=0;for(var m;f;){if(f.nodeType===3){if(m=a+f.textContent.length,a<=l&&m>=l)return{node:f,offset:l-a};a=m}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Ox(f)}}function Mx(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Mx(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function Bx(){for(var a=window,l=Et();l instanceof a.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)a=l.contentWindow;else break;l=Et(a.document)}return l}function Gd(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function P4(a){var l=Bx(),f=a.focusedElem,m=a.selectionRange;if(l!==f&&f&&f.ownerDocument&&Mx(f.ownerDocument.documentElement,f)){if(m!==null&&Gd(f)){if(l=m.start,a=m.end,a===void 0&&(a=l),"selectionStart"in f)f.selectionStart=l,f.selectionEnd=Math.min(a,f.value.length);else if(a=(l=f.ownerDocument||document)&&l.defaultView||window,a.getSelection){a=a.getSelection();var _=f.textContent.length,E=Math.min(m.start,_);m=m.end===void 0?E:Math.min(m.end,_),!a.extend&&E>m&&(_=m,m=E,E=_),_=Lx(f,E);var R=Lx(f,m);_&&R&&(a.rangeCount!==1||a.anchorNode!==_.node||a.anchorOffset!==_.offset||a.focusNode!==R.node||a.focusOffset!==R.offset)&&(l=l.createRange(),l.setStart(_.node,_.offset),a.removeAllRanges(),E>m?(a.addRange(l),a.extend(R.node,R.offset)):(l.setEnd(R.node,R.offset),a.addRange(l)))}}for(l=[],a=f;a=a.parentNode;)a.nodeType===1&&l.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<l.length;f++)a=l[f],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var O4=c&&"documentMode"in document&&11>=document.documentMode,Bl=null,Kd=null,uu=null,qd=!1;function Vx(a,l,f){var m=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;qd||Bl==null||Bl!==Et(m)||(m=Bl,"selectionStart"in m&&Gd(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),uu&&cu(uu,m)||(uu=m,m=hh(Kd,"onSelect"),0<m.length&&(l=new Ro("onSelect","select",null,l,f),a.push({event:l,listeners:m}),l.target=Bl)))}function ch(a,l){var f={};return f[a.toLowerCase()]=l.toLowerCase(),f["Webkit"+a]="webkit"+l,f["Moz"+a]="moz"+l,f}var Vl={animationend:ch("Animation","AnimationEnd"),animationiteration:ch("Animation","AnimationIteration"),animationstart:ch("Animation","AnimationStart"),transitionend:ch("Transition","TransitionEnd")},Xd={},jx={};c&&(jx=document.createElement("div").style,"AnimationEvent"in window||(delete Vl.animationend.animation,delete Vl.animationiteration.animation,delete Vl.animationstart.animation),"TransitionEvent"in window||delete Vl.transitionend.transition);function uh(a){if(Xd[a])return Xd[a];if(!Vl[a])return a;var l=Vl[a],f;for(f in l)if(l.hasOwnProperty(f)&&f in jx)return Xd[a]=l[f];return a}var Ux=uh("animationend"),zx=uh("animationiteration"),Wx=uh("animationstart"),Hx=uh("transitionend"),$x=new Map,Gx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function La(a,l){$x.set(a,l),i(l,[a])}for(var Yd=0;Yd<Gx.length;Yd++){var Qd=Gx[Yd],L4=Qd.toLowerCase(),M4=Qd[0].toUpperCase()+Qd.slice(1);La(L4,"on"+M4)}La(Ux,"onAnimationEnd"),La(zx,"onAnimationIteration"),La(Wx,"onAnimationStart"),La("dblclick","onDoubleClick"),La("focusin","onFocus"),La("focusout","onBlur"),La(Hx,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B4=new Set("cancel close invalid load scroll toggle".split(" ").concat(fu));function Kx(a,l,f){var m=a.type||"unknown-event";a.currentTarget=f,K(m,l,void 0,a),a.currentTarget=null}function qx(a,l){l=(l&4)!==0;for(var f=0;f<a.length;f++){var m=a[f],_=m.event;m=m.listeners;e:{var E=void 0;if(l)for(var R=m.length-1;0<=R;R--){var Q=m[R],re=Q.instance,de=Q.currentTarget;if(Q=Q.listener,re!==E&&_.isPropagationStopped())break e;Kx(_,Q,de),E=re}else for(R=0;R<m.length;R++){if(Q=m[R],re=Q.instance,de=Q.currentTarget,Q=Q.listener,re!==E&&_.isPropagationStopped())break e;Kx(_,Q,de),E=re}}}if(P)throw a=H,P=!1,H=null,a}function nr(a,l){var f=l[ip];f===void 0&&(f=l[ip]=new Set);var m=a+"__bubble";f.has(m)||(Xx(l,a,2,!1),f.add(m))}function Jd(a,l,f){var m=0;l&&(m|=4),Xx(f,a,m,l)}var fh="_reactListening"+Math.random().toString(36).slice(2);function hu(a){if(!a[fh]){a[fh]=!0,n.forEach(function(f){f!=="selectionchange"&&(B4.has(f)||Jd(f,!1,a),Jd(f,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[fh]||(l[fh]=!0,Jd("selectionchange",!1,l))}}function Xx(a,l,f,m){switch(bl(l)){case 1:var _=yi;break;case 4:_=rh;break;default:_=ru}f=_.bind(null,l,f,a),_=void 0,!hr||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(_=!0),m?_!==void 0?a.addEventListener(l,f,{capture:!0,passive:_}):a.addEventListener(l,f,!0):_!==void 0?a.addEventListener(l,f,{passive:_}):a.addEventListener(l,f,!1)}function Zd(a,l,f,m,_){var E=m;if((l&1)===0&&(l&2)===0&&m!==null)e:for(;;){if(m===null)return;var R=m.tag;if(R===3||R===4){var Q=m.stateNode.containerInfo;if(Q===_||Q.nodeType===8&&Q.parentNode===_)break;if(R===4)for(R=m.return;R!==null;){var re=R.tag;if((re===3||re===4)&&(re=R.stateNode.containerInfo,re===_||re.nodeType===8&&re.parentNode===_))return;R=R.return}for(;Q!==null;){if(R=Po(Q),R===null)return;if(re=R.tag,re===5||re===6){m=E=R;continue e}Q=Q.parentNode}}m=m.return}Ut(function(){var de=E,be=Ks(f),Le=[];e:{var Fe=$x.get(a);if(Fe!==void 0){var $e=Ro,qe=a;switch(a){case"keypress":if(No(f)===0)break e;case"keydown":case"keyup":$e=Kt;break;case"focusin":qe="focus",$e=fn;break;case"focusout":qe="blur",$e=fn;break;case"beforeblur":case"afterblur":$e=fn;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$e=su;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$e=ih;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$e=Si;break;case Ux:case zx:case Wx:$e=oh;break;case Hx:$e=Ll;break;case"scroll":$e=Rl;break;case"wheel":$e=w4;break;case"copy":case"cut":case"paste":$e=p;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$e=ms}var Xe=(l&4)!==0,Ir=!Xe&&a==="scroll",ie=Xe?Fe!==null?Fe+"Capture":null:Fe;Xe=[];for(var se=de,ue;se!==null;){ue=se;var Me=ue.stateNode;if(ue.tag===5&&Me!==null&&(ue=Me,ie!==null&&(Me=rr(se,ie),Me!=null&&Xe.push(du(se,Me,ue)))),Ir)break;se=se.return}0<Xe.length&&(Fe=new $e(Fe,qe,null,f,be),Le.push({event:Fe,listeners:Xe}))}}if((l&7)===0){e:{if(Fe=a==="mouseover"||a==="pointerover",$e=a==="mouseout"||a==="pointerout",Fe&&f!==us&&(qe=f.relatedTarget||f.fromElement)&&(Po(qe)||qe[Zi]))break e;if(($e||Fe)&&(Fe=be.window===be?be:(Fe=be.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,$e?(qe=f.relatedTarget||f.toElement,$e=de,qe=qe?Po(qe):null,qe!==null&&(Ir=q(qe),qe!==Ir||qe.tag!==5&&qe.tag!==6)&&(qe=null)):($e=null,qe=de),$e!==qe)){if(Xe=su,Me="onMouseLeave",ie="onMouseEnter",se="mouse",(a==="pointerout"||a==="pointerover")&&(Xe=ms,Me="onPointerLeave",ie="onPointerEnter",se="pointer"),Ir=$e==null?Fe:zl($e),ue=qe==null?Fe:zl(qe),Fe=new Xe(Me,se+"leave",$e,f,be),Fe.target=Ir,Fe.relatedTarget=ue,Me=null,Po(be)===de&&(Xe=new Xe(ie,se+"enter",qe,f,be),Xe.target=ue,Xe.relatedTarget=Ir,Me=Xe),Ir=Me,$e&&qe)t:{for(Xe=$e,ie=qe,se=0,ue=Xe;ue;ue=jl(ue))se++;for(ue=0,Me=ie;Me;Me=jl(Me))ue++;for(;0<se-ue;)Xe=jl(Xe),se--;for(;0<ue-se;)ie=jl(ie),ue--;for(;se--;){if(Xe===ie||ie!==null&&Xe===ie.alternate)break t;Xe=jl(Xe),ie=jl(ie)}Xe=null}else Xe=null;$e!==null&&Yx(Le,Fe,$e,Xe,!1),qe!==null&&Ir!==null&&Yx(Le,Ir,qe,Xe,!0)}}e:{if(Fe=de?zl(de):window,$e=Fe.nodeName&&Fe.nodeName.toLowerCase(),$e==="select"||$e==="input"&&Fe.type==="file")var Ye=I4;else if(Fx(Fe))if(Nx)Ye=R4;else{Ye=b4;var tt=F4}else($e=Fe.nodeName)&&$e.toLowerCase()==="input"&&(Fe.type==="checkbox"||Fe.type==="radio")&&(Ye=N4);if(Ye&&(Ye=Ye(a,de))){bx(Le,Ye,f,be);break e}tt&&tt(a,Fe,de),a==="focusout"&&(tt=Fe._wrapperState)&&tt.controlled&&Fe.type==="number"&&St(Fe,"number",Fe.value)}switch(tt=de?zl(de):window,a){case"focusin":(Fx(tt)||tt.contentEditable==="true")&&(Bl=tt,Kd=de,uu=null);break;case"focusout":uu=Kd=Bl=null;break;case"mousedown":qd=!0;break;case"contextmenu":case"mouseup":case"dragend":qd=!1,Vx(Le,f,be);break;case"selectionchange":if(O4)break;case"keydown":case"keyup":Vx(Le,f,be)}var rt;if(Wd)e:{switch(a){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else Ml?Cx(a,f)&&(ut="onCompositionEnd"):a==="keydown"&&f.keyCode===229&&(ut="onCompositionStart");ut&&(Sx&&f.locale!=="ko"&&(Ml||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&Ml&&(rt=nh()):(ds=be,Nl="value"in ds?ds.value:ds.textContent,Ml=!0)),tt=hh(de,ut),0<tt.length&&(ut=new I(ut,a,null,f,be),Le.push({event:ut,listeners:tt}),rt?ut.data=rt:(rt=Ix(f),rt!==null&&(ut.data=rt)))),(rt=T4?S4(a,f):k4(a,f))&&(de=hh(de,"onBeforeInput"),0<de.length&&(be=new I("onBeforeInput","beforeinput",null,f,be),Le.push({event:be,listeners:de}),be.data=rt))}qx(Le,l)})}function du(a,l,f){return{instance:a,listener:l,currentTarget:f}}function hh(a,l){for(var f=l+"Capture",m=[];a!==null;){var _=a,E=_.stateNode;_.tag===5&&E!==null&&(_=E,E=rr(a,f),E!=null&&m.unshift(du(a,E,_)),E=rr(a,l),E!=null&&m.push(du(a,E,_))),a=a.return}return m}function jl(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function Yx(a,l,f,m,_){for(var E=l._reactName,R=[];f!==null&&f!==m;){var Q=f,re=Q.alternate,de=Q.stateNode;if(re!==null&&re===m)break;Q.tag===5&&de!==null&&(Q=de,_?(re=rr(f,E),re!=null&&R.unshift(du(f,re,Q))):_||(re=rr(f,E),re!=null&&R.push(du(f,re,Q)))),f=f.return}R.length!==0&&a.push({event:l,listeners:R})}var V4=/\r\n?/g,j4=/\u0000|\uFFFD/g;function Qx(a){return(typeof a=="string"?a:""+a).replace(V4,`
`).replace(j4,"")}function dh(a,l,f){if(l=Qx(l),Qx(a)!==l&&f)throw Error(r(425))}function ph(){}var ep=null,tp=null;function rp(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var np=typeof setTimeout=="function"?setTimeout:void 0,U4=typeof clearTimeout=="function"?clearTimeout:void 0,Jx=typeof Promise=="function"?Promise:void 0,z4=typeof queueMicrotask=="function"?queueMicrotask:typeof Jx<"u"?function(a){return Jx.resolve(null).then(a).catch(W4)}:np;function W4(a){setTimeout(function(){throw a})}function sp(a,l){var f=l,m=0;do{var _=f.nextSibling;if(a.removeChild(f),_&&_.nodeType===8)if(f=_.data,f==="/$"){if(m===0){a.removeChild(_),Da(l);return}m--}else f!=="$"&&f!=="$?"&&f!=="$!"||m++;f=_}while(f);Da(l)}function Ma(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return a}function Zx(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var f=a.data;if(f==="$"||f==="$!"||f==="$?"){if(l===0)return a;l--}else f==="/$"&&l++}a=a.previousSibling}return null}var Ul=Math.random().toString(36).slice(2),Ai="__reactFiber$"+Ul,pu="__reactProps$"+Ul,Zi="__reactContainer$"+Ul,ip="__reactEvents$"+Ul,H4="__reactListeners$"+Ul,$4="__reactHandles$"+Ul;function Po(a){var l=a[Ai];if(l)return l;for(var f=a.parentNode;f;){if(l=f[Zi]||f[Ai]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(a=Zx(a);a!==null;){if(f=a[Ai])return f;a=Zx(a)}return l}a=f,f=a.parentNode}return null}function mu(a){return a=a[Ai]||a[Zi],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function zl(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(r(33))}function mh(a){return a[pu]||null}var ap=[],Wl=-1;function Ba(a){return{current:a}}function sr(a){0>Wl||(a.current=ap[Wl],ap[Wl]=null,Wl--)}function er(a,l){Wl++,ap[Wl]=a.current,a.current=l}var Va={},Sn=Ba(Va),Jn=Ba(!1),Oo=Va;function Hl(a,l){var f=a.type.contextTypes;if(!f)return Va;var m=a.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===l)return m.__reactInternalMemoizedMaskedChildContext;var _={},E;for(E in f)_[E]=l[E];return m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=_),_}function Zn(a){return a=a.childContextTypes,a!=null}function gh(){sr(Jn),sr(Sn)}function ev(a,l,f){if(Sn.current!==Va)throw Error(r(168));er(Sn,l),er(Jn,f)}function tv(a,l,f){var m=a.stateNode;if(l=l.childContextTypes,typeof m.getChildContext!="function")return f;m=m.getChildContext();for(var _ in m)if(!(_ in l))throw Error(r(108,_e(a)||"Unknown",_));return ye({},f,m)}function xh(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Va,Oo=Sn.current,er(Sn,a),er(Jn,Jn.current),!0}function rv(a,l,f){var m=a.stateNode;if(!m)throw Error(r(169));f?(a=tv(a,l,Oo),m.__reactInternalMemoizedMergedChildContext=a,sr(Jn),sr(Sn),er(Sn,a)):sr(Jn),er(Jn,f)}var ea=null,vh=!1,op=!1;function nv(a){ea===null?ea=[a]:ea.push(a)}function G4(a){vh=!0,nv(a)}function ja(){if(!op&&ea!==null){op=!0;var a=0,l=Ft;try{var f=ea;for(Ft=1;a<f.length;a++){var m=f[a];do m=m(!0);while(m!==null)}ea=null,vh=!1}catch(_){throw ea!==null&&(ea=ea.slice(a+1)),Re(zt,ja),_}finally{Ft=l,op=!1}}return null}var $l=[],Gl=0,_h=null,yh=0,Ns=[],Rs=0,Lo=null,ta=1,ra="";function Mo(a,l){$l[Gl++]=yh,$l[Gl++]=_h,_h=a,yh=l}function sv(a,l,f){Ns[Rs++]=ta,Ns[Rs++]=ra,Ns[Rs++]=Lo,Lo=a;var m=ta;a=ra;var _=32-dr(m)-1;m&=~(1<<_),f+=1;var E=32-dr(l)+_;if(30<E){var R=_-_%5;E=(m&(1<<R)-1).toString(32),m>>=R,_-=R,ta=1<<32-dr(l)+_|f<<_|m,ra=E+a}else ta=1<<E|f<<_|m,ra=a}function lp(a){a.return!==null&&(Mo(a,1),sv(a,1,0))}function cp(a){for(;a===_h;)_h=$l[--Gl],$l[Gl]=null,yh=$l[--Gl],$l[Gl]=null;for(;a===Lo;)Lo=Ns[--Rs],Ns[Rs]=null,ra=Ns[--Rs],Ns[Rs]=null,ta=Ns[--Rs],Ns[Rs]=null}var gs=null,xs=null,ur=!1,Qs=null;function iv(a,l){var f=Ls(5,null,null,0);f.elementType="DELETED",f.stateNode=l,f.return=a,l=a.deletions,l===null?(a.deletions=[f],a.flags|=16):l.push(f)}function av(a,l){switch(a.tag){case 5:var f=a.type;return l=l.nodeType!==1||f.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(a.stateNode=l,gs=a,xs=Ma(l.firstChild),!0):!1;case 6:return l=a.pendingProps===""||l.nodeType!==3?null:l,l!==null?(a.stateNode=l,gs=a,xs=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(f=Lo!==null?{id:ta,overflow:ra}:null,a.memoizedState={dehydrated:l,treeContext:f,retryLane:1073741824},f=Ls(18,null,null,0),f.stateNode=l,f.return=a,a.child=f,gs=a,xs=null,!0):!1;default:return!1}}function up(a){return(a.mode&1)!==0&&(a.flags&128)===0}function fp(a){if(ur){var l=xs;if(l){var f=l;if(!av(a,l)){if(up(a))throw Error(r(418));l=Ma(f.nextSibling);var m=gs;l&&av(a,l)?iv(m,f):(a.flags=a.flags&-4097|2,ur=!1,gs=a)}}else{if(up(a))throw Error(r(418));a.flags=a.flags&-4097|2,ur=!1,gs=a}}}function ov(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;gs=a}function wh(a){if(a!==gs)return!1;if(!ur)return ov(a),ur=!0,!1;var l;if((l=a.tag!==3)&&!(l=a.tag!==5)&&(l=a.type,l=l!=="head"&&l!=="body"&&!rp(a.type,a.memoizedProps)),l&&(l=xs)){if(up(a))throw lv(),Error(r(418));for(;l;)iv(a,l),l=Ma(l.nextSibling)}if(ov(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8){var f=a.data;if(f==="/$"){if(l===0){xs=Ma(a.nextSibling);break e}l--}else f!=="$"&&f!=="$!"&&f!=="$?"||l++}a=a.nextSibling}xs=null}}else xs=gs?Ma(a.stateNode.nextSibling):null;return!0}function lv(){for(var a=xs;a;)a=Ma(a.nextSibling)}function Kl(){xs=gs=null,ur=!1}function hp(a){Qs===null?Qs=[a]:Qs.push(a)}var K4=j.ReactCurrentBatchConfig;function gu(a,l,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(r(309));var m=f.stateNode}if(!m)throw Error(r(147,a));var _=m,E=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===E?l.ref:(l=function(R){var Q=_.refs;R===null?delete Q[E]:Q[E]=R},l._stringRef=E,l)}if(typeof a!="string")throw Error(r(284));if(!f._owner)throw Error(r(290,a))}return a}function Eh(a,l){throw a=Object.prototype.toString.call(l),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function cv(a){var l=a._init;return l(a._payload)}function uv(a){function l(ie,se){if(a){var ue=ie.deletions;ue===null?(ie.deletions=[se],ie.flags|=16):ue.push(se)}}function f(ie,se){if(!a)return null;for(;se!==null;)l(ie,se),se=se.sibling;return null}function m(ie,se){for(ie=new Map;se!==null;)se.key!==null?ie.set(se.key,se):ie.set(se.index,se),se=se.sibling;return ie}function _(ie,se){return ie=qa(ie,se),ie.index=0,ie.sibling=null,ie}function E(ie,se,ue){return ie.index=ue,a?(ue=ie.alternate,ue!==null?(ue=ue.index,ue<se?(ie.flags|=2,se):ue):(ie.flags|=2,se)):(ie.flags|=1048576,se)}function R(ie){return a&&ie.alternate===null&&(ie.flags|=2),ie}function Q(ie,se,ue,Me){return se===null||se.tag!==6?(se=nm(ue,ie.mode,Me),se.return=ie,se):(se=_(se,ue),se.return=ie,se)}function re(ie,se,ue,Me){var Ye=ue.type;return Ye===A?be(ie,se,ue.props.children,Me,ue.key):se!==null&&(se.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===De&&cv(Ye)===se.type)?(Me=_(se,ue.props),Me.ref=gu(ie,se,ue),Me.return=ie,Me):(Me=Gh(ue.type,ue.key,ue.props,null,ie.mode,Me),Me.ref=gu(ie,se,ue),Me.return=ie,Me)}function de(ie,se,ue,Me){return se===null||se.tag!==4||se.stateNode.containerInfo!==ue.containerInfo||se.stateNode.implementation!==ue.implementation?(se=sm(ue,ie.mode,Me),se.return=ie,se):(se=_(se,ue.children||[]),se.return=ie,se)}function be(ie,se,ue,Me,Ye){return se===null||se.tag!==7?(se=$o(ue,ie.mode,Me,Ye),se.return=ie,se):(se=_(se,ue),se.return=ie,se)}function Le(ie,se,ue){if(typeof se=="string"&&se!==""||typeof se=="number")return se=nm(""+se,ie.mode,ue),se.return=ie,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case X:return ue=Gh(se.type,se.key,se.props,null,ie.mode,ue),ue.ref=gu(ie,null,se),ue.return=ie,ue;case G:return se=sm(se,ie.mode,ue),se.return=ie,se;case De:var Me=se._init;return Le(ie,Me(se._payload),ue)}if(Tt(se)||ne(se))return se=$o(se,ie.mode,ue,null),se.return=ie,se;Eh(ie,se)}return null}function Fe(ie,se,ue,Me){var Ye=se!==null?se.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return Ye!==null?null:Q(ie,se,""+ue,Me);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case X:return ue.key===Ye?re(ie,se,ue,Me):null;case G:return ue.key===Ye?de(ie,se,ue,Me):null;case De:return Ye=ue._init,Fe(ie,se,Ye(ue._payload),Me)}if(Tt(ue)||ne(ue))return Ye!==null?null:be(ie,se,ue,Me,null);Eh(ie,ue)}return null}function $e(ie,se,ue,Me,Ye){if(typeof Me=="string"&&Me!==""||typeof Me=="number")return ie=ie.get(ue)||null,Q(se,ie,""+Me,Ye);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case X:return ie=ie.get(Me.key===null?ue:Me.key)||null,re(se,ie,Me,Ye);case G:return ie=ie.get(Me.key===null?ue:Me.key)||null,de(se,ie,Me,Ye);case De:var tt=Me._init;return $e(ie,se,ue,tt(Me._payload),Ye)}if(Tt(Me)||ne(Me))return ie=ie.get(ue)||null,be(se,ie,Me,Ye,null);Eh(se,Me)}return null}function qe(ie,se,ue,Me){for(var Ye=null,tt=null,rt=se,ut=se=0,rn=null;rt!==null&&ut<ue.length;ut++){rt.index>ut?(rn=rt,rt=null):rn=rt.sibling;var Lt=Fe(ie,rt,ue[ut],Me);if(Lt===null){rt===null&&(rt=rn);break}a&&rt&&Lt.alternate===null&&l(ie,rt),se=E(Lt,se,ut),tt===null?Ye=Lt:tt.sibling=Lt,tt=Lt,rt=rn}if(ut===ue.length)return f(ie,rt),ur&&Mo(ie,ut),Ye;if(rt===null){for(;ut<ue.length;ut++)rt=Le(ie,ue[ut],Me),rt!==null&&(se=E(rt,se,ut),tt===null?Ye=rt:tt.sibling=rt,tt=rt);return ur&&Mo(ie,ut),Ye}for(rt=m(ie,rt);ut<ue.length;ut++)rn=$e(rt,ie,ut,ue[ut],Me),rn!==null&&(a&&rn.alternate!==null&&rt.delete(rn.key===null?ut:rn.key),se=E(rn,se,ut),tt===null?Ye=rn:tt.sibling=rn,tt=rn);return a&&rt.forEach(function(Xa){return l(ie,Xa)}),ur&&Mo(ie,ut),Ye}function Xe(ie,se,ue,Me){var Ye=ne(ue);if(typeof Ye!="function")throw Error(r(150));if(ue=Ye.call(ue),ue==null)throw Error(r(151));for(var tt=Ye=null,rt=se,ut=se=0,rn=null,Lt=ue.next();rt!==null&&!Lt.done;ut++,Lt=ue.next()){rt.index>ut?(rn=rt,rt=null):rn=rt.sibling;var Xa=Fe(ie,rt,Lt.value,Me);if(Xa===null){rt===null&&(rt=rn);break}a&&rt&&Xa.alternate===null&&l(ie,rt),se=E(Xa,se,ut),tt===null?Ye=Xa:tt.sibling=Xa,tt=Xa,rt=rn}if(Lt.done)return f(ie,rt),ur&&Mo(ie,ut),Ye;if(rt===null){for(;!Lt.done;ut++,Lt=ue.next())Lt=Le(ie,Lt.value,Me),Lt!==null&&(se=E(Lt,se,ut),tt===null?Ye=Lt:tt.sibling=Lt,tt=Lt);return ur&&Mo(ie,ut),Ye}for(rt=m(ie,rt);!Lt.done;ut++,Lt=ue.next())Lt=$e(rt,ie,ut,Lt.value,Me),Lt!==null&&(a&&Lt.alternate!==null&&rt.delete(Lt.key===null?ut:Lt.key),se=E(Lt,se,ut),tt===null?Ye=Lt:tt.sibling=Lt,tt=Lt);return a&&rt.forEach(function(AA){return l(ie,AA)}),ur&&Mo(ie,ut),Ye}function Ir(ie,se,ue,Me){if(typeof ue=="object"&&ue!==null&&ue.type===A&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case X:e:{for(var Ye=ue.key,tt=se;tt!==null;){if(tt.key===Ye){if(Ye=ue.type,Ye===A){if(tt.tag===7){f(ie,tt.sibling),se=_(tt,ue.props.children),se.return=ie,ie=se;break e}}else if(tt.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===De&&cv(Ye)===tt.type){f(ie,tt.sibling),se=_(tt,ue.props),se.ref=gu(ie,tt,ue),se.return=ie,ie=se;break e}f(ie,tt);break}else l(ie,tt);tt=tt.sibling}ue.type===A?(se=$o(ue.props.children,ie.mode,Me,ue.key),se.return=ie,ie=se):(Me=Gh(ue.type,ue.key,ue.props,null,ie.mode,Me),Me.ref=gu(ie,se,ue),Me.return=ie,ie=Me)}return R(ie);case G:e:{for(tt=ue.key;se!==null;){if(se.key===tt)if(se.tag===4&&se.stateNode.containerInfo===ue.containerInfo&&se.stateNode.implementation===ue.implementation){f(ie,se.sibling),se=_(se,ue.children||[]),se.return=ie,ie=se;break e}else{f(ie,se);break}else l(ie,se);se=se.sibling}se=sm(ue,ie.mode,Me),se.return=ie,ie=se}return R(ie);case De:return tt=ue._init,Ir(ie,se,tt(ue._payload),Me)}if(Tt(ue))return qe(ie,se,ue,Me);if(ne(ue))return Xe(ie,se,ue,Me);Eh(ie,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,se!==null&&se.tag===6?(f(ie,se.sibling),se=_(se,ue),se.return=ie,ie=se):(f(ie,se),se=nm(ue,ie.mode,Me),se.return=ie,ie=se),R(ie)):f(ie,se)}return Ir}var ql=uv(!0),fv=uv(!1),Th=Ba(null),Sh=null,Xl=null,dp=null;function pp(){dp=Xl=Sh=null}function mp(a){var l=Th.current;sr(Th),a._currentValue=l}function gp(a,l,f){for(;a!==null;){var m=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),a===f)break;a=a.return}}function Yl(a,l){Sh=a,dp=Xl=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&l)!==0&&(es=!0),a.firstContext=null)}function Ds(a){var l=a._currentValue;if(dp!==a)if(a={context:a,memoizedValue:l,next:null},Xl===null){if(Sh===null)throw Error(r(308));Xl=a,Sh.dependencies={lanes:0,firstContext:a}}else Xl=Xl.next=a;return l}var Bo=null;function xp(a){Bo===null?Bo=[a]:Bo.push(a)}function hv(a,l,f,m){var _=l.interleaved;return _===null?(f.next=f,xp(l)):(f.next=_.next,_.next=f),l.interleaved=f,na(a,m)}function na(a,l){a.lanes|=l;var f=a.alternate;for(f!==null&&(f.lanes|=l),f=a,a=a.return;a!==null;)a.childLanes|=l,f=a.alternate,f!==null&&(f.childLanes|=l),f=a,a=a.return;return f.tag===3?f.stateNode:null}var Ua=!1;function vp(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dv(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function sa(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function za(a,l,f){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(Dt&2)!==0){var _=m.pending;return _===null?l.next=l:(l.next=_.next,_.next=l),m.pending=l,na(a,f)}return _=m.interleaved,_===null?(l.next=l,xp(m)):(l.next=_.next,_.next=l),m.interleaved=l,na(a,f)}function kh(a,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194240)!==0)){var m=l.lanes;m&=a.pendingLanes,f|=m,l.lanes=f,Qc(a,f)}}function pv(a,l){var f=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,f===m)){var _=null,E=null;if(f=f.firstBaseUpdate,f!==null){do{var R={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};E===null?_=E=R:E=E.next=R,f=f.next}while(f!==null);E===null?_=E=l:E=E.next=l}else _=E=l;f={baseState:m.baseState,firstBaseUpdate:_,lastBaseUpdate:E,shared:m.shared,effects:m.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=l:a.next=l,f.lastBaseUpdate=l}function Ah(a,l,f,m){var _=a.updateQueue;Ua=!1;var E=_.firstBaseUpdate,R=_.lastBaseUpdate,Q=_.shared.pending;if(Q!==null){_.shared.pending=null;var re=Q,de=re.next;re.next=null,R===null?E=de:R.next=de,R=re;var be=a.alternate;be!==null&&(be=be.updateQueue,Q=be.lastBaseUpdate,Q!==R&&(Q===null?be.firstBaseUpdate=de:Q.next=de,be.lastBaseUpdate=re))}if(E!==null){var Le=_.baseState;R=0,be=de=re=null,Q=E;do{var Fe=Q.lane,$e=Q.eventTime;if((m&Fe)===Fe){be!==null&&(be=be.next={eventTime:$e,lane:0,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null});e:{var qe=a,Xe=Q;switch(Fe=l,$e=f,Xe.tag){case 1:if(qe=Xe.payload,typeof qe=="function"){Le=qe.call($e,Le,Fe);break e}Le=qe;break e;case 3:qe.flags=qe.flags&-65537|128;case 0:if(qe=Xe.payload,Fe=typeof qe=="function"?qe.call($e,Le,Fe):qe,Fe==null)break e;Le=ye({},Le,Fe);break e;case 2:Ua=!0}}Q.callback!==null&&Q.lane!==0&&(a.flags|=64,Fe=_.effects,Fe===null?_.effects=[Q]:Fe.push(Q))}else $e={eventTime:$e,lane:Fe,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},be===null?(de=be=$e,re=Le):be=be.next=$e,R|=Fe;if(Q=Q.next,Q===null){if(Q=_.shared.pending,Q===null)break;Fe=Q,Q=Fe.next,Fe.next=null,_.lastBaseUpdate=Fe,_.shared.pending=null}}while(!0);if(be===null&&(re=Le),_.baseState=re,_.firstBaseUpdate=de,_.lastBaseUpdate=be,l=_.shared.interleaved,l!==null){_=l;do R|=_.lane,_=_.next;while(_!==l)}else E===null&&(_.shared.lanes=0);Uo|=R,a.lanes=R,a.memoizedState=Le}}function mv(a,l,f){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var m=a[l],_=m.callback;if(_!==null){if(m.callback=null,m=f,typeof _!="function")throw Error(r(191,_));_.call(m)}}}var xu={},Ci=Ba(xu),vu=Ba(xu),_u=Ba(xu);function Vo(a){if(a===xu)throw Error(r(174));return a}function _p(a,l){switch(er(_u,l),er(vu,a),er(Ci,xu),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:Un(null,"");break;default:a=a===8?l.parentNode:l,l=a.namespaceURI||null,a=a.tagName,l=Un(l,a)}sr(Ci),er(Ci,l)}function Ql(){sr(Ci),sr(vu),sr(_u)}function gv(a){Vo(_u.current);var l=Vo(Ci.current),f=Un(l,a.type);l!==f&&(er(vu,a),er(Ci,f))}function yp(a){vu.current===a&&(sr(Ci),sr(vu))}var pr=Ba(0);function Ch(a){for(var l=a;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var wp=[];function Ep(){for(var a=0;a<wp.length;a++)wp[a]._workInProgressVersionPrimary=null;wp.length=0}var Ih=j.ReactCurrentDispatcher,Tp=j.ReactCurrentBatchConfig,jo=0,mr=null,Kr=null,en=null,Fh=!1,yu=!1,wu=0,q4=0;function kn(){throw Error(r(321))}function Sp(a,l){if(l===null)return!1;for(var f=0;f<l.length&&f<a.length;f++)if(!Ys(a[f],l[f]))return!1;return!0}function kp(a,l,f,m,_,E){if(jo=E,mr=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Ih.current=a===null||a.memoizedState===null?J4:Z4,a=f(m,_),yu){E=0;do{if(yu=!1,wu=0,25<=E)throw Error(r(301));E+=1,en=Kr=null,l.updateQueue=null,Ih.current=eA,a=f(m,_)}while(yu)}if(Ih.current=Rh,l=Kr!==null&&Kr.next!==null,jo=0,en=Kr=mr=null,Fh=!1,l)throw Error(r(300));return a}function Ap(){var a=wu!==0;return wu=0,a}function Ii(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?mr.memoizedState=en=a:en=en.next=a,en}function Ps(){if(Kr===null){var a=mr.alternate;a=a!==null?a.memoizedState:null}else a=Kr.next;var l=en===null?mr.memoizedState:en.next;if(l!==null)en=l,Kr=a;else{if(a===null)throw Error(r(310));Kr=a,a={memoizedState:Kr.memoizedState,baseState:Kr.baseState,baseQueue:Kr.baseQueue,queue:Kr.queue,next:null},en===null?mr.memoizedState=en=a:en=en.next=a}return en}function Eu(a,l){return typeof l=="function"?l(a):l}function Cp(a){var l=Ps(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=a;var m=Kr,_=m.baseQueue,E=f.pending;if(E!==null){if(_!==null){var R=_.next;_.next=E.next,E.next=R}m.baseQueue=_=E,f.pending=null}if(_!==null){E=_.next,m=m.baseState;var Q=R=null,re=null,de=E;do{var be=de.lane;if((jo&be)===be)re!==null&&(re=re.next={lane:0,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),m=de.hasEagerState?de.eagerState:a(m,de.action);else{var Le={lane:be,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null};re===null?(Q=re=Le,R=m):re=re.next=Le,mr.lanes|=be,Uo|=be}de=de.next}while(de!==null&&de!==E);re===null?R=m:re.next=Q,Ys(m,l.memoizedState)||(es=!0),l.memoizedState=m,l.baseState=R,l.baseQueue=re,f.lastRenderedState=m}if(a=f.interleaved,a!==null){_=a;do E=_.lane,mr.lanes|=E,Uo|=E,_=_.next;while(_!==a)}else _===null&&(f.lanes=0);return[l.memoizedState,f.dispatch]}function Ip(a){var l=Ps(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=a;var m=f.dispatch,_=f.pending,E=l.memoizedState;if(_!==null){f.pending=null;var R=_=_.next;do E=a(E,R.action),R=R.next;while(R!==_);Ys(E,l.memoizedState)||(es=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),f.lastRenderedState=E}return[E,m]}function xv(){}function vv(a,l){var f=mr,m=Ps(),_=l(),E=!Ys(m.memoizedState,_);if(E&&(m.memoizedState=_,es=!0),m=m.queue,Fp(wv.bind(null,f,m,a),[a]),m.getSnapshot!==l||E||en!==null&&en.memoizedState.tag&1){if(f.flags|=2048,Tu(9,yv.bind(null,f,m,_,l),void 0,null),tn===null)throw Error(r(349));(jo&30)!==0||_v(f,l,_)}return _}function _v(a,l,f){a.flags|=16384,a={getSnapshot:l,value:f},l=mr.updateQueue,l===null?(l={lastEffect:null,stores:null},mr.updateQueue=l,l.stores=[a]):(f=l.stores,f===null?l.stores=[a]:f.push(a))}function yv(a,l,f,m){l.value=f,l.getSnapshot=m,Ev(l)&&Tv(a)}function wv(a,l,f){return f(function(){Ev(l)&&Tv(a)})}function Ev(a){var l=a.getSnapshot;a=a.value;try{var f=l();return!Ys(a,f)}catch{return!0}}function Tv(a){var l=na(a,1);l!==null&&ti(l,a,1,-1)}function Sv(a){var l=Ii();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eu,lastRenderedState:a},l.queue=a,a=a.dispatch=Q4.bind(null,mr,a),[l.memoizedState,a]}function Tu(a,l,f,m){return a={tag:a,create:l,destroy:f,deps:m,next:null},l=mr.updateQueue,l===null?(l={lastEffect:null,stores:null},mr.updateQueue=l,l.lastEffect=a.next=a):(f=l.lastEffect,f===null?l.lastEffect=a.next=a:(m=f.next,f.next=a,a.next=m,l.lastEffect=a)),a}function kv(){return Ps().memoizedState}function bh(a,l,f,m){var _=Ii();mr.flags|=a,_.memoizedState=Tu(1|l,f,void 0,m===void 0?null:m)}function Nh(a,l,f,m){var _=Ps();m=m===void 0?null:m;var E=void 0;if(Kr!==null){var R=Kr.memoizedState;if(E=R.destroy,m!==null&&Sp(m,R.deps)){_.memoizedState=Tu(l,f,E,m);return}}mr.flags|=a,_.memoizedState=Tu(1|l,f,E,m)}function Av(a,l){return bh(8390656,8,a,l)}function Fp(a,l){return Nh(2048,8,a,l)}function Cv(a,l){return Nh(4,2,a,l)}function Iv(a,l){return Nh(4,4,a,l)}function Fv(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function bv(a,l,f){return f=f!=null?f.concat([a]):null,Nh(4,4,Fv.bind(null,l,a),f)}function bp(){}function Nv(a,l){var f=Ps();l=l===void 0?null:l;var m=f.memoizedState;return m!==null&&l!==null&&Sp(l,m[1])?m[0]:(f.memoizedState=[a,l],a)}function Rv(a,l){var f=Ps();l=l===void 0?null:l;var m=f.memoizedState;return m!==null&&l!==null&&Sp(l,m[1])?m[0]:(a=a(),f.memoizedState=[a,l],a)}function Dv(a,l,f){return(jo&21)===0?(a.baseState&&(a.baseState=!1,es=!0),a.memoizedState=f):(Ys(f,l)||(f=Xc(),mr.lanes|=f,Uo|=f,a.baseState=!0),l)}function X4(a,l){var f=Ft;Ft=f!==0&&4>f?f:4,a(!0);var m=Tp.transition;Tp.transition={};try{a(!1),l()}finally{Ft=f,Tp.transition=m}}function Pv(){return Ps().memoizedState}function Y4(a,l,f){var m=Ga(a);if(f={lane:m,action:f,hasEagerState:!1,eagerState:null,next:null},Ov(a))Lv(l,f);else if(f=hv(a,l,f,m),f!==null){var _=Wn();ti(f,a,m,_),Mv(f,l,m)}}function Q4(a,l,f){var m=Ga(a),_={lane:m,action:f,hasEagerState:!1,eagerState:null,next:null};if(Ov(a))Lv(l,_);else{var E=a.alternate;if(a.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var R=l.lastRenderedState,Q=E(R,f);if(_.hasEagerState=!0,_.eagerState=Q,Ys(Q,R)){var re=l.interleaved;re===null?(_.next=_,xp(l)):(_.next=re.next,re.next=_),l.interleaved=_;return}}catch{}finally{}f=hv(a,l,_,m),f!==null&&(_=Wn(),ti(f,a,m,_),Mv(f,l,m))}}function Ov(a){var l=a.alternate;return a===mr||l!==null&&l===mr}function Lv(a,l){yu=Fh=!0;var f=a.pending;f===null?l.next=l:(l.next=f.next,f.next=l),a.pending=l}function Mv(a,l,f){if((f&4194240)!==0){var m=l.lanes;m&=a.pendingLanes,f|=m,l.lanes=f,Qc(a,f)}}var Rh={readContext:Ds,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useInsertionEffect:kn,useLayoutEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useMutableSource:kn,useSyncExternalStore:kn,useId:kn,unstable_isNewReconciler:!1},J4={readContext:Ds,useCallback:function(a,l){return Ii().memoizedState=[a,l===void 0?null:l],a},useContext:Ds,useEffect:Av,useImperativeHandle:function(a,l,f){return f=f!=null?f.concat([a]):null,bh(4194308,4,Fv.bind(null,l,a),f)},useLayoutEffect:function(a,l){return bh(4194308,4,a,l)},useInsertionEffect:function(a,l){return bh(4,2,a,l)},useMemo:function(a,l){var f=Ii();return l=l===void 0?null:l,a=a(),f.memoizedState=[a,l],a},useReducer:function(a,l,f){var m=Ii();return l=f!==void 0?f(l):l,m.memoizedState=m.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},m.queue=a,a=a.dispatch=Y4.bind(null,mr,a),[m.memoizedState,a]},useRef:function(a){var l=Ii();return a={current:a},l.memoizedState=a},useState:Sv,useDebugValue:bp,useDeferredValue:function(a){return Ii().memoizedState=a},useTransition:function(){var a=Sv(!1),l=a[0];return a=X4.bind(null,a[1]),Ii().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,f){var m=mr,_=Ii();if(ur){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),tn===null)throw Error(r(349));(jo&30)!==0||_v(m,l,f)}_.memoizedState=f;var E={value:f,getSnapshot:l};return _.queue=E,Av(wv.bind(null,m,E,a),[a]),m.flags|=2048,Tu(9,yv.bind(null,m,E,f,l),void 0,null),f},useId:function(){var a=Ii(),l=tn.identifierPrefix;if(ur){var f=ra,m=ta;f=(m&~(1<<32-dr(m)-1)).toString(32)+f,l=":"+l+"R"+f,f=wu++,0<f&&(l+="H"+f.toString(32)),l+=":"}else f=q4++,l=":"+l+"r"+f.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},Z4={readContext:Ds,useCallback:Nv,useContext:Ds,useEffect:Fp,useImperativeHandle:bv,useInsertionEffect:Cv,useLayoutEffect:Iv,useMemo:Rv,useReducer:Cp,useRef:kv,useState:function(){return Cp(Eu)},useDebugValue:bp,useDeferredValue:function(a){var l=Ps();return Dv(l,Kr.memoizedState,a)},useTransition:function(){var a=Cp(Eu)[0],l=Ps().memoizedState;return[a,l]},useMutableSource:xv,useSyncExternalStore:vv,useId:Pv,unstable_isNewReconciler:!1},eA={readContext:Ds,useCallback:Nv,useContext:Ds,useEffect:Fp,useImperativeHandle:bv,useInsertionEffect:Cv,useLayoutEffect:Iv,useMemo:Rv,useReducer:Ip,useRef:kv,useState:function(){return Ip(Eu)},useDebugValue:bp,useDeferredValue:function(a){var l=Ps();return Kr===null?l.memoizedState=a:Dv(l,Kr.memoizedState,a)},useTransition:function(){var a=Ip(Eu)[0],l=Ps().memoizedState;return[a,l]},useMutableSource:xv,useSyncExternalStore:vv,useId:Pv,unstable_isNewReconciler:!1};function Js(a,l){if(a&&a.defaultProps){l=ye({},l),a=a.defaultProps;for(var f in a)l[f]===void 0&&(l[f]=a[f]);return l}return l}function Np(a,l,f,m){l=a.memoizedState,f=f(m,l),f=f==null?l:ye({},l,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var Dh={isMounted:function(a){return(a=a._reactInternals)?q(a)===a:!1},enqueueSetState:function(a,l,f){a=a._reactInternals;var m=Wn(),_=Ga(a),E=sa(m,_);E.payload=l,f!=null&&(E.callback=f),l=za(a,E,_),l!==null&&(ti(l,a,_,m),kh(l,a,_))},enqueueReplaceState:function(a,l,f){a=a._reactInternals;var m=Wn(),_=Ga(a),E=sa(m,_);E.tag=1,E.payload=l,f!=null&&(E.callback=f),l=za(a,E,_),l!==null&&(ti(l,a,_,m),kh(l,a,_))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var f=Wn(),m=Ga(a),_=sa(f,m);_.tag=2,l!=null&&(_.callback=l),l=za(a,_,m),l!==null&&(ti(l,a,m,f),kh(l,a,m))}};function Bv(a,l,f,m,_,E,R){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,E,R):l.prototype&&l.prototype.isPureReactComponent?!cu(f,m)||!cu(_,E):!0}function Vv(a,l,f){var m=!1,_=Va,E=l.contextType;return typeof E=="object"&&E!==null?E=Ds(E):(_=Zn(l)?Oo:Sn.current,m=l.contextTypes,E=(m=m!=null)?Hl(a,_):Va),l=new l(f,E),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Dh,a.stateNode=l,l._reactInternals=a,m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=_,a.__reactInternalMemoizedMaskedChildContext=E),l}function jv(a,l,f,m){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,m),l.state!==a&&Dh.enqueueReplaceState(l,l.state,null)}function Rp(a,l,f,m){var _=a.stateNode;_.props=f,_.state=a.memoizedState,_.refs={},vp(a);var E=l.contextType;typeof E=="object"&&E!==null?_.context=Ds(E):(E=Zn(l)?Oo:Sn.current,_.context=Hl(a,E)),_.state=a.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(Np(a,l,E,f),_.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(l=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),l!==_.state&&Dh.enqueueReplaceState(_,_.state,null),Ah(a,f,_,m),_.state=a.memoizedState),typeof _.componentDidMount=="function"&&(a.flags|=4194308)}function Jl(a,l){try{var f="",m=l;do f+=Z(m),m=m.return;while(m);var _=f}catch(E){_=`
Error generating stack: `+E.message+`
`+E.stack}return{value:a,source:l,stack:_,digest:null}}function Dp(a,l,f){return{value:a,source:null,stack:f??null,digest:l??null}}function Pp(a,l){try{console.error(l.value)}catch(f){setTimeout(function(){throw f})}}var tA=typeof WeakMap=="function"?WeakMap:Map;function Uv(a,l,f){f=sa(-1,f),f.tag=3,f.payload={element:null};var m=l.value;return f.callback=function(){jh||(jh=!0,Xp=m),Pp(a,l)},f}function zv(a,l,f){f=sa(-1,f),f.tag=3;var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var _=l.value;f.payload=function(){return m(_)},f.callback=function(){Pp(a,l)}}var E=a.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(f.callback=function(){Pp(a,l),typeof m!="function"&&(Ha===null?Ha=new Set([this]):Ha.add(this));var R=l.stack;this.componentDidCatch(l.value,{componentStack:R!==null?R:""})}),f}function Wv(a,l,f){var m=a.pingCache;if(m===null){m=a.pingCache=new tA;var _=new Set;m.set(l,_)}else _=m.get(l),_===void 0&&(_=new Set,m.set(l,_));_.has(f)||(_.add(f),a=mA.bind(null,a,l,f),l.then(a,a))}function Hv(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function $v(a,l,f,m,_){return(a.mode&1)===0?(a===l?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(l=sa(-1,1),l.tag=2,za(f,l,1))),f.lanes|=1),a):(a.flags|=65536,a.lanes=_,a)}var rA=j.ReactCurrentOwner,es=!1;function zn(a,l,f,m){l.child=a===null?fv(l,null,f,m):ql(l,a.child,f,m)}function Gv(a,l,f,m,_){f=f.render;var E=l.ref;return Yl(l,_),m=kp(a,l,f,m,E,_),f=Ap(),a!==null&&!es?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~_,ia(a,l,_)):(ur&&f&&lp(l),l.flags|=1,zn(a,l,m,_),l.child)}function Kv(a,l,f,m,_){if(a===null){var E=f.type;return typeof E=="function"&&!rm(E)&&E.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(l.tag=15,l.type=E,qv(a,l,E,m,_)):(a=Gh(f.type,null,m,l,l.mode,_),a.ref=l.ref,a.return=l,l.child=a)}if(E=a.child,(a.lanes&_)===0){var R=E.memoizedProps;if(f=f.compare,f=f!==null?f:cu,f(R,m)&&a.ref===l.ref)return ia(a,l,_)}return l.flags|=1,a=qa(E,m),a.ref=l.ref,a.return=l,l.child=a}function qv(a,l,f,m,_){if(a!==null){var E=a.memoizedProps;if(cu(E,m)&&a.ref===l.ref)if(es=!1,l.pendingProps=m=E,(a.lanes&_)!==0)(a.flags&131072)!==0&&(es=!0);else return l.lanes=a.lanes,ia(a,l,_)}return Op(a,l,f,m,_)}function Xv(a,l,f){var m=l.pendingProps,_=m.children,E=a!==null?a.memoizedState:null;if(m.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},er(ec,vs),vs|=f;else{if((f&1073741824)===0)return a=E!==null?E.baseLanes|f:f,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,er(ec,vs),vs|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=E!==null?E.baseLanes:f,er(ec,vs),vs|=m}else E!==null?(m=E.baseLanes|f,l.memoizedState=null):m=f,er(ec,vs),vs|=m;return zn(a,l,_,f),l.child}function Yv(a,l){var f=l.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(l.flags|=512,l.flags|=2097152)}function Op(a,l,f,m,_){var E=Zn(f)?Oo:Sn.current;return E=Hl(l,E),Yl(l,_),f=kp(a,l,f,m,E,_),m=Ap(),a!==null&&!es?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~_,ia(a,l,_)):(ur&&m&&lp(l),l.flags|=1,zn(a,l,f,_),l.child)}function Qv(a,l,f,m,_){if(Zn(f)){var E=!0;xh(l)}else E=!1;if(Yl(l,_),l.stateNode===null)Oh(a,l),Vv(l,f,m),Rp(l,f,m,_),m=!0;else if(a===null){var R=l.stateNode,Q=l.memoizedProps;R.props=Q;var re=R.context,de=f.contextType;typeof de=="object"&&de!==null?de=Ds(de):(de=Zn(f)?Oo:Sn.current,de=Hl(l,de));var be=f.getDerivedStateFromProps,Le=typeof be=="function"||typeof R.getSnapshotBeforeUpdate=="function";Le||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(Q!==m||re!==de)&&jv(l,R,m,de),Ua=!1;var Fe=l.memoizedState;R.state=Fe,Ah(l,m,R,_),re=l.memoizedState,Q!==m||Fe!==re||Jn.current||Ua?(typeof be=="function"&&(Np(l,f,be,m),re=l.memoizedState),(Q=Ua||Bv(l,f,Q,m,Fe,re,de))?(Le||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(l.flags|=4194308)):(typeof R.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=re),R.props=m,R.state=re,R.context=de,m=Q):(typeof R.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{R=l.stateNode,dv(a,l),Q=l.memoizedProps,de=l.type===l.elementType?Q:Js(l.type,Q),R.props=de,Le=l.pendingProps,Fe=R.context,re=f.contextType,typeof re=="object"&&re!==null?re=Ds(re):(re=Zn(f)?Oo:Sn.current,re=Hl(l,re));var $e=f.getDerivedStateFromProps;(be=typeof $e=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(Q!==Le||Fe!==re)&&jv(l,R,m,re),Ua=!1,Fe=l.memoizedState,R.state=Fe,Ah(l,m,R,_);var qe=l.memoizedState;Q!==Le||Fe!==qe||Jn.current||Ua?(typeof $e=="function"&&(Np(l,f,$e,m),qe=l.memoizedState),(de=Ua||Bv(l,f,de,m,Fe,qe,re)||!1)?(be||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(m,qe,re),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(m,qe,re)),typeof R.componentDidUpdate=="function"&&(l.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof R.componentDidUpdate!="function"||Q===a.memoizedProps&&Fe===a.memoizedState||(l.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||Q===a.memoizedProps&&Fe===a.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=qe),R.props=m,R.state=qe,R.context=re,m=de):(typeof R.componentDidUpdate!="function"||Q===a.memoizedProps&&Fe===a.memoizedState||(l.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||Q===a.memoizedProps&&Fe===a.memoizedState||(l.flags|=1024),m=!1)}return Lp(a,l,f,m,E,_)}function Lp(a,l,f,m,_,E){Yv(a,l);var R=(l.flags&128)!==0;if(!m&&!R)return _&&rv(l,f,!1),ia(a,l,E);m=l.stateNode,rA.current=l;var Q=R&&typeof f.getDerivedStateFromError!="function"?null:m.render();return l.flags|=1,a!==null&&R?(l.child=ql(l,a.child,null,E),l.child=ql(l,null,Q,E)):zn(a,l,Q,E),l.memoizedState=m.state,_&&rv(l,f,!0),l.child}function Jv(a){var l=a.stateNode;l.pendingContext?ev(a,l.pendingContext,l.pendingContext!==l.context):l.context&&ev(a,l.context,!1),_p(a,l.containerInfo)}function Zv(a,l,f,m,_){return Kl(),hp(_),l.flags|=256,zn(a,l,f,m),l.child}var Mp={dehydrated:null,treeContext:null,retryLane:0};function Bp(a){return{baseLanes:a,cachePool:null,transitions:null}}function e_(a,l,f){var m=l.pendingProps,_=pr.current,E=!1,R=(l.flags&128)!==0,Q;if((Q=R)||(Q=a!==null&&a.memoizedState===null?!1:(_&2)!==0),Q?(E=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(_|=1),er(pr,_&1),a===null)return fp(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((l.mode&1)===0?l.lanes=1:a.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(R=m.children,a=m.fallback,E?(m=l.mode,E=l.child,R={mode:"hidden",children:R},(m&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=R):E=Kh(R,m,0,null),a=$o(a,m,f,null),E.return=l,a.return=l,E.sibling=a,l.child=E,l.child.memoizedState=Bp(f),l.memoizedState=Mp,a):Vp(l,R));if(_=a.memoizedState,_!==null&&(Q=_.dehydrated,Q!==null))return nA(a,l,R,m,Q,_,f);if(E){E=m.fallback,R=l.mode,_=a.child,Q=_.sibling;var re={mode:"hidden",children:m.children};return(R&1)===0&&l.child!==_?(m=l.child,m.childLanes=0,m.pendingProps=re,l.deletions=null):(m=qa(_,re),m.subtreeFlags=_.subtreeFlags&14680064),Q!==null?E=qa(Q,E):(E=$o(E,R,f,null),E.flags|=2),E.return=l,m.return=l,m.sibling=E,l.child=m,m=E,E=l.child,R=a.child.memoizedState,R=R===null?Bp(f):{baseLanes:R.baseLanes|f,cachePool:null,transitions:R.transitions},E.memoizedState=R,E.childLanes=a.childLanes&~f,l.memoizedState=Mp,m}return E=a.child,a=E.sibling,m=qa(E,{mode:"visible",children:m.children}),(l.mode&1)===0&&(m.lanes=f),m.return=l,m.sibling=null,a!==null&&(f=l.deletions,f===null?(l.deletions=[a],l.flags|=16):f.push(a)),l.child=m,l.memoizedState=null,m}function Vp(a,l){return l=Kh({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function Ph(a,l,f,m){return m!==null&&hp(m),ql(l,a.child,null,f),a=Vp(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function nA(a,l,f,m,_,E,R){if(f)return l.flags&256?(l.flags&=-257,m=Dp(Error(r(422))),Ph(a,l,R,m)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(E=m.fallback,_=l.mode,m=Kh({mode:"visible",children:m.children},_,0,null),E=$o(E,_,R,null),E.flags|=2,m.return=l,E.return=l,m.sibling=E,l.child=m,(l.mode&1)!==0&&ql(l,a.child,null,R),l.child.memoizedState=Bp(R),l.memoizedState=Mp,E);if((l.mode&1)===0)return Ph(a,l,R,null);if(_.data==="$!"){if(m=_.nextSibling&&_.nextSibling.dataset,m)var Q=m.dgst;return m=Q,E=Error(r(419)),m=Dp(E,m,void 0),Ph(a,l,R,m)}if(Q=(R&a.childLanes)!==0,es||Q){if(m=tn,m!==null){switch(R&-R){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(m.suspendedLanes|R))!==0?0:_,_!==0&&_!==E.retryLane&&(E.retryLane=_,na(a,_),ti(m,a,_,-1))}return tm(),m=Dp(Error(r(421))),Ph(a,l,R,m)}return _.data==="$?"?(l.flags|=128,l.child=a.child,l=gA.bind(null,a),_._reactRetry=l,null):(a=E.treeContext,xs=Ma(_.nextSibling),gs=l,ur=!0,Qs=null,a!==null&&(Ns[Rs++]=ta,Ns[Rs++]=ra,Ns[Rs++]=Lo,ta=a.id,ra=a.overflow,Lo=l),l=Vp(l,m.children),l.flags|=4096,l)}function t_(a,l,f){a.lanes|=l;var m=a.alternate;m!==null&&(m.lanes|=l),gp(a.return,l,f)}function jp(a,l,f,m,_){var E=a.memoizedState;E===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:f,tailMode:_}:(E.isBackwards=l,E.rendering=null,E.renderingStartTime=0,E.last=m,E.tail=f,E.tailMode=_)}function r_(a,l,f){var m=l.pendingProps,_=m.revealOrder,E=m.tail;if(zn(a,l,m.children,f),m=pr.current,(m&2)!==0)m=m&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&t_(a,f,l);else if(a.tag===19)t_(a,f,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}if(er(pr,m),(l.mode&1)===0)l.memoizedState=null;else switch(_){case"forwards":for(f=l.child,_=null;f!==null;)a=f.alternate,a!==null&&Ch(a)===null&&(_=f),f=f.sibling;f=_,f===null?(_=l.child,l.child=null):(_=f.sibling,f.sibling=null),jp(l,!1,_,f,E);break;case"backwards":for(f=null,_=l.child,l.child=null;_!==null;){if(a=_.alternate,a!==null&&Ch(a)===null){l.child=_;break}a=_.sibling,_.sibling=f,f=_,_=a}jp(l,!0,f,null,E);break;case"together":jp(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Oh(a,l){(l.mode&1)===0&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function ia(a,l,f){if(a!==null&&(l.dependencies=a.dependencies),Uo|=l.lanes,(f&l.childLanes)===0)return null;if(a!==null&&l.child!==a.child)throw Error(r(153));if(l.child!==null){for(a=l.child,f=qa(a,a.pendingProps),l.child=f,f.return=l;a.sibling!==null;)a=a.sibling,f=f.sibling=qa(a,a.pendingProps),f.return=l;f.sibling=null}return l.child}function sA(a,l,f){switch(l.tag){case 3:Jv(l),Kl();break;case 5:gv(l);break;case 1:Zn(l.type)&&xh(l);break;case 4:_p(l,l.stateNode.containerInfo);break;case 10:var m=l.type._context,_=l.memoizedProps.value;er(Th,m._currentValue),m._currentValue=_;break;case 13:if(m=l.memoizedState,m!==null)return m.dehydrated!==null?(er(pr,pr.current&1),l.flags|=128,null):(f&l.child.childLanes)!==0?e_(a,l,f):(er(pr,pr.current&1),a=ia(a,l,f),a!==null?a.sibling:null);er(pr,pr.current&1);break;case 19:if(m=(f&l.childLanes)!==0,(a.flags&128)!==0){if(m)return r_(a,l,f);l.flags|=128}if(_=l.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),er(pr,pr.current),m)break;return null;case 22:case 23:return l.lanes=0,Xv(a,l,f)}return ia(a,l,f)}var n_,Up,s_,i_;n_=function(a,l){for(var f=l.child;f!==null;){if(f.tag===5||f.tag===6)a.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Up=function(){},s_=function(a,l,f,m){var _=a.memoizedProps;if(_!==m){a=l.stateNode,Vo(Ci.current);var E=null;switch(f){case"input":_=gt(a,_),m=gt(a,m),E=[];break;case"select":_=ye({},_,{value:void 0}),m=ye({},m,{value:void 0}),E=[];break;case"textarea":_=Xn(a,_),m=Xn(a,m),E=[];break;default:typeof _.onClick!="function"&&typeof m.onClick=="function"&&(a.onclick=ph)}En(f,m);var R;f=null;for(de in _)if(!m.hasOwnProperty(de)&&_.hasOwnProperty(de)&&_[de]!=null)if(de==="style"){var Q=_[de];for(R in Q)Q.hasOwnProperty(R)&&(f||(f={}),f[R]="")}else de!=="dangerouslySetInnerHTML"&&de!=="children"&&de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&de!=="autoFocus"&&(s.hasOwnProperty(de)?E||(E=[]):(E=E||[]).push(de,null));for(de in m){var re=m[de];if(Q=_!=null?_[de]:void 0,m.hasOwnProperty(de)&&re!==Q&&(re!=null||Q!=null))if(de==="style")if(Q){for(R in Q)!Q.hasOwnProperty(R)||re&&re.hasOwnProperty(R)||(f||(f={}),f[R]="");for(R in re)re.hasOwnProperty(R)&&Q[R]!==re[R]&&(f||(f={}),f[R]=re[R])}else f||(E||(E=[]),E.push(de,f)),f=re;else de==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,Q=Q?Q.__html:void 0,re!=null&&Q!==re&&(E=E||[]).push(de,re)):de==="children"?typeof re!="string"&&typeof re!="number"||(E=E||[]).push(de,""+re):de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&(s.hasOwnProperty(de)?(re!=null&&de==="onScroll"&&nr("scroll",a),E||Q===re||(E=[])):(E=E||[]).push(de,re))}f&&(E=E||[]).push("style",f);var de=E;(l.updateQueue=de)&&(l.flags|=4)}},i_=function(a,l,f,m){f!==m&&(l.flags|=4)};function Su(a,l){if(!ur)switch(a.tailMode){case"hidden":l=a.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function An(a){var l=a.alternate!==null&&a.alternate.child===a.child,f=0,m=0;if(l)for(var _=a.child;_!==null;)f|=_.lanes|_.childLanes,m|=_.subtreeFlags&14680064,m|=_.flags&14680064,_.return=a,_=_.sibling;else for(_=a.child;_!==null;)f|=_.lanes|_.childLanes,m|=_.subtreeFlags,m|=_.flags,_.return=a,_=_.sibling;return a.subtreeFlags|=m,a.childLanes=f,l}function iA(a,l,f){var m=l.pendingProps;switch(cp(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return An(l),null;case 1:return Zn(l.type)&&gh(),An(l),null;case 3:return m=l.stateNode,Ql(),sr(Jn),sr(Sn),Ep(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(wh(l)?l.flags|=4:a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Qs!==null&&(Jp(Qs),Qs=null))),Up(a,l),An(l),null;case 5:yp(l);var _=Vo(_u.current);if(f=l.type,a!==null&&l.stateNode!=null)s_(a,l,f,m,_),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!m){if(l.stateNode===null)throw Error(r(166));return An(l),null}if(a=Vo(Ci.current),wh(l)){m=l.stateNode,f=l.type;var E=l.memoizedProps;switch(m[Ai]=l,m[pu]=E,a=(l.mode&1)!==0,f){case"dialog":nr("cancel",m),nr("close",m);break;case"iframe":case"object":case"embed":nr("load",m);break;case"video":case"audio":for(_=0;_<fu.length;_++)nr(fu[_],m);break;case"source":nr("error",m);break;case"img":case"image":case"link":nr("error",m),nr("load",m);break;case"details":nr("toggle",m);break;case"input":It(m,E),nr("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!E.multiple},nr("invalid",m);break;case"textarea":ln(m,E),nr("invalid",m)}En(f,E),_=null;for(var R in E)if(E.hasOwnProperty(R)){var Q=E[R];R==="children"?typeof Q=="string"?m.textContent!==Q&&(E.suppressHydrationWarning!==!0&&dh(m.textContent,Q,a),_=["children",Q]):typeof Q=="number"&&m.textContent!==""+Q&&(E.suppressHydrationWarning!==!0&&dh(m.textContent,Q,a),_=["children",""+Q]):s.hasOwnProperty(R)&&Q!=null&&R==="onScroll"&&nr("scroll",m)}switch(f){case"input":st(m),Ht(m,E,!0);break;case"textarea":st(m),Dr(m);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(m.onclick=ph)}m=_,l.updateQueue=m,m!==null&&(l.flags|=4)}else{R=_.nodeType===9?_:_.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=yn(f)),a==="http://www.w3.org/1999/xhtml"?f==="script"?(a=R.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof m.is=="string"?a=R.createElement(f,{is:m.is}):(a=R.createElement(f),f==="select"&&(R=a,m.multiple?R.multiple=!0:m.size&&(R.size=m.size))):a=R.createElementNS(a,f),a[Ai]=l,a[pu]=m,n_(a,l,!1,!1),l.stateNode=a;e:{switch(R=di(f,m),f){case"dialog":nr("cancel",a),nr("close",a),_=m;break;case"iframe":case"object":case"embed":nr("load",a),_=m;break;case"video":case"audio":for(_=0;_<fu.length;_++)nr(fu[_],a);_=m;break;case"source":nr("error",a),_=m;break;case"img":case"image":case"link":nr("error",a),nr("load",a),_=m;break;case"details":nr("toggle",a),_=m;break;case"input":It(a,m),_=gt(a,m),nr("invalid",a);break;case"option":_=m;break;case"select":a._wrapperState={wasMultiple:!!m.multiple},_=ye({},m,{value:void 0}),nr("invalid",a);break;case"textarea":ln(a,m),_=Xn(a,m),nr("invalid",a);break;default:_=m}En(f,_),Q=_;for(E in Q)if(Q.hasOwnProperty(E)){var re=Q[E];E==="style"?wn(a,re):E==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,re!=null&&Jr(a,re)):E==="children"?typeof re=="string"?(f!=="textarea"||re!=="")&&ot(a,re):typeof re=="number"&&ot(a,""+re):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(s.hasOwnProperty(E)?re!=null&&E==="onScroll"&&nr("scroll",a):re!=null&&b(a,E,re,R))}switch(f){case"input":st(a),Ht(a,m,!1);break;case"textarea":st(a),Dr(a);break;case"option":m.value!=null&&a.setAttribute("value",""+ve(m.value));break;case"select":a.multiple=!!m.multiple,E=m.value,E!=null?fr(a,!!m.multiple,E,!1):m.defaultValue!=null&&fr(a,!!m.multiple,m.defaultValue,!0);break;default:typeof _.onClick=="function"&&(a.onclick=ph)}switch(f){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return An(l),null;case 6:if(a&&l.stateNode!=null)i_(a,l,a.memoizedProps,m);else{if(typeof m!="string"&&l.stateNode===null)throw Error(r(166));if(f=Vo(_u.current),Vo(Ci.current),wh(l)){if(m=l.stateNode,f=l.memoizedProps,m[Ai]=l,(E=m.nodeValue!==f)&&(a=gs,a!==null))switch(a.tag){case 3:dh(m.nodeValue,f,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&dh(m.nodeValue,f,(a.mode&1)!==0)}E&&(l.flags|=4)}else m=(f.nodeType===9?f:f.ownerDocument).createTextNode(m),m[Ai]=l,l.stateNode=m}return An(l),null;case 13:if(sr(pr),m=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(ur&&xs!==null&&(l.mode&1)!==0&&(l.flags&128)===0)lv(),Kl(),l.flags|=98560,E=!1;else if(E=wh(l),m!==null&&m.dehydrated!==null){if(a===null){if(!E)throw Error(r(318));if(E=l.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(r(317));E[Ai]=l}else Kl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;An(l),E=!1}else Qs!==null&&(Jp(Qs),Qs=null),E=!0;if(!E)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=f,l):(m=m!==null,m!==(a!==null&&a.memoizedState!==null)&&m&&(l.child.flags|=8192,(l.mode&1)!==0&&(a===null||(pr.current&1)!==0?qr===0&&(qr=3):tm())),l.updateQueue!==null&&(l.flags|=4),An(l),null);case 4:return Ql(),Up(a,l),a===null&&hu(l.stateNode.containerInfo),An(l),null;case 10:return mp(l.type._context),An(l),null;case 17:return Zn(l.type)&&gh(),An(l),null;case 19:if(sr(pr),E=l.memoizedState,E===null)return An(l),null;if(m=(l.flags&128)!==0,R=E.rendering,R===null)if(m)Su(E,!1);else{if(qr!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(R=Ch(a),R!==null){for(l.flags|=128,Su(E,!1),m=R.updateQueue,m!==null&&(l.updateQueue=m,l.flags|=4),l.subtreeFlags=0,m=f,f=l.child;f!==null;)E=f,a=m,E.flags&=14680066,R=E.alternate,R===null?(E.childLanes=0,E.lanes=a,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=R.childLanes,E.lanes=R.lanes,E.child=R.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=R.memoizedProps,E.memoizedState=R.memoizedState,E.updateQueue=R.updateQueue,E.type=R.type,a=R.dependencies,E.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),f=f.sibling;return er(pr,pr.current&1|2),l.child}a=a.sibling}E.tail!==null&&Oe()>tc&&(l.flags|=128,m=!0,Su(E,!1),l.lanes=4194304)}else{if(!m)if(a=Ch(R),a!==null){if(l.flags|=128,m=!0,f=a.updateQueue,f!==null&&(l.updateQueue=f,l.flags|=4),Su(E,!0),E.tail===null&&E.tailMode==="hidden"&&!R.alternate&&!ur)return An(l),null}else 2*Oe()-E.renderingStartTime>tc&&f!==1073741824&&(l.flags|=128,m=!0,Su(E,!1),l.lanes=4194304);E.isBackwards?(R.sibling=l.child,l.child=R):(f=E.last,f!==null?f.sibling=R:l.child=R,E.last=R)}return E.tail!==null?(l=E.tail,E.rendering=l,E.tail=l.sibling,E.renderingStartTime=Oe(),l.sibling=null,f=pr.current,er(pr,m?f&1|2:f&1),l):(An(l),null);case 22:case 23:return em(),m=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==m&&(l.flags|=8192),m&&(l.mode&1)!==0?(vs&1073741824)!==0&&(An(l),l.subtreeFlags&6&&(l.flags|=8192)):An(l),null;case 24:return null;case 25:return null}throw Error(r(156,l.tag))}function aA(a,l){switch(cp(l),l.tag){case 1:return Zn(l.type)&&gh(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Ql(),sr(Jn),sr(Sn),Ep(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 5:return yp(l),null;case 13:if(sr(pr),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Kl()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return sr(pr),null;case 4:return Ql(),null;case 10:return mp(l.type._context),null;case 22:case 23:return em(),null;case 24:return null;default:return null}}var Lh=!1,Cn=!1,oA=typeof WeakSet=="function"?WeakSet:Set,Ke=null;function Zl(a,l){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(m){yr(a,l,m)}else f.current=null}function zp(a,l,f){try{f()}catch(m){yr(a,l,m)}}var a_=!1;function lA(a,l){if(ep=Yi,a=Bx(),Gd(a)){if("selectionStart"in a)var f={start:a.selectionStart,end:a.selectionEnd};else e:{f=(f=a.ownerDocument)&&f.defaultView||window;var m=f.getSelection&&f.getSelection();if(m&&m.rangeCount!==0){f=m.anchorNode;var _=m.anchorOffset,E=m.focusNode;m=m.focusOffset;try{f.nodeType,E.nodeType}catch{f=null;break e}var R=0,Q=-1,re=-1,de=0,be=0,Le=a,Fe=null;t:for(;;){for(var $e;Le!==f||_!==0&&Le.nodeType!==3||(Q=R+_),Le!==E||m!==0&&Le.nodeType!==3||(re=R+m),Le.nodeType===3&&(R+=Le.nodeValue.length),($e=Le.firstChild)!==null;)Fe=Le,Le=$e;for(;;){if(Le===a)break t;if(Fe===f&&++de===_&&(Q=R),Fe===E&&++be===m&&(re=R),($e=Le.nextSibling)!==null)break;Le=Fe,Fe=Le.parentNode}Le=$e}f=Q===-1||re===-1?null:{start:Q,end:re}}else f=null}f=f||{start:0,end:0}}else f=null;for(tp={focusedElem:a,selectionRange:f},Yi=!1,Ke=l;Ke!==null;)if(l=Ke,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,Ke=a;else for(;Ke!==null;){l=Ke;try{var qe=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(qe!==null){var Xe=qe.memoizedProps,Ir=qe.memoizedState,ie=l.stateNode,se=ie.getSnapshotBeforeUpdate(l.elementType===l.type?Xe:Js(l.type,Xe),Ir);ie.__reactInternalSnapshotBeforeUpdate=se}break;case 3:var ue=l.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Me){yr(l,l.return,Me)}if(a=l.sibling,a!==null){a.return=l.return,Ke=a;break}Ke=l.return}return qe=a_,a_=!1,qe}function ku(a,l,f){var m=l.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var _=m=m.next;do{if((_.tag&a)===a){var E=_.destroy;_.destroy=void 0,E!==void 0&&zp(l,f,E)}_=_.next}while(_!==m)}}function Mh(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var f=l=l.next;do{if((f.tag&a)===a){var m=f.create;f.destroy=m()}f=f.next}while(f!==l)}}function Wp(a){var l=a.ref;if(l!==null){var f=a.stateNode;switch(a.tag){case 5:a=f;break;default:a=f}typeof l=="function"?l(a):l.current=a}}function o_(a){var l=a.alternate;l!==null&&(a.alternate=null,o_(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&(delete l[Ai],delete l[pu],delete l[ip],delete l[H4],delete l[$4])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function l_(a){return a.tag===5||a.tag===3||a.tag===4}function c_(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||l_(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Hp(a,l,f){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?f.nodeType===8?f.parentNode.insertBefore(a,l):f.insertBefore(a,l):(f.nodeType===8?(l=f.parentNode,l.insertBefore(a,f)):(l=f,l.appendChild(a)),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=ph));else if(m!==4&&(a=a.child,a!==null))for(Hp(a,l,f),a=a.sibling;a!==null;)Hp(a,l,f),a=a.sibling}function $p(a,l,f){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?f.insertBefore(a,l):f.appendChild(a);else if(m!==4&&(a=a.child,a!==null))for($p(a,l,f),a=a.sibling;a!==null;)$p(a,l,f),a=a.sibling}var hn=null,Zs=!1;function Wa(a,l,f){for(f=f.child;f!==null;)u_(a,l,f),f=f.sibling}function u_(a,l,f){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(fs,f)}catch{}switch(f.tag){case 5:Cn||Zl(f,l);case 6:var m=hn,_=Zs;hn=null,Wa(a,l,f),hn=m,Zs=_,hn!==null&&(Zs?(a=hn,f=f.stateNode,a.nodeType===8?a.parentNode.removeChild(f):a.removeChild(f)):hn.removeChild(f.stateNode));break;case 18:hn!==null&&(Zs?(a=hn,f=f.stateNode,a.nodeType===8?sp(a.parentNode,f):a.nodeType===1&&sp(a,f),Da(a)):sp(hn,f.stateNode));break;case 4:m=hn,_=Zs,hn=f.stateNode.containerInfo,Zs=!0,Wa(a,l,f),hn=m,Zs=_;break;case 0:case 11:case 14:case 15:if(!Cn&&(m=f.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){_=m=m.next;do{var E=_,R=E.destroy;E=E.tag,R!==void 0&&((E&2)!==0||(E&4)!==0)&&zp(f,l,R),_=_.next}while(_!==m)}Wa(a,l,f);break;case 1:if(!Cn&&(Zl(f,l),m=f.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=f.memoizedProps,m.state=f.memoizedState,m.componentWillUnmount()}catch(Q){yr(f,l,Q)}Wa(a,l,f);break;case 21:Wa(a,l,f);break;case 22:f.mode&1?(Cn=(m=Cn)||f.memoizedState!==null,Wa(a,l,f),Cn=m):Wa(a,l,f);break;default:Wa(a,l,f)}}function f_(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new oA),l.forEach(function(m){var _=xA.bind(null,a,m);f.has(m)||(f.add(m),m.then(_,_))})}}function ei(a,l){var f=l.deletions;if(f!==null)for(var m=0;m<f.length;m++){var _=f[m];try{var E=a,R=l,Q=R;e:for(;Q!==null;){switch(Q.tag){case 5:hn=Q.stateNode,Zs=!1;break e;case 3:hn=Q.stateNode.containerInfo,Zs=!0;break e;case 4:hn=Q.stateNode.containerInfo,Zs=!0;break e}Q=Q.return}if(hn===null)throw Error(r(160));u_(E,R,_),hn=null,Zs=!1;var re=_.alternate;re!==null&&(re.return=null),_.return=null}catch(de){yr(_,l,de)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)h_(l,a),l=l.sibling}function h_(a,l){var f=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(ei(l,a),Fi(a),m&4){try{ku(3,a,a.return),Mh(3,a)}catch(Xe){yr(a,a.return,Xe)}try{ku(5,a,a.return)}catch(Xe){yr(a,a.return,Xe)}}break;case 1:ei(l,a),Fi(a),m&512&&f!==null&&Zl(f,f.return);break;case 5:if(ei(l,a),Fi(a),m&512&&f!==null&&Zl(f,f.return),a.flags&32){var _=a.stateNode;try{ot(_,"")}catch(Xe){yr(a,a.return,Xe)}}if(m&4&&(_=a.stateNode,_!=null)){var E=a.memoizedProps,R=f!==null?f.memoizedProps:E,Q=a.type,re=a.updateQueue;if(a.updateQueue=null,re!==null)try{Q==="input"&&E.type==="radio"&&E.name!=null&&ht(_,E),di(Q,R);var de=di(Q,E);for(R=0;R<re.length;R+=2){var be=re[R],Le=re[R+1];be==="style"?wn(_,Le):be==="dangerouslySetInnerHTML"?Jr(_,Le):be==="children"?ot(_,Le):b(_,be,Le,de)}switch(Q){case"input":je(_,E);break;case"textarea":$r(_,E);break;case"select":var Fe=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!E.multiple;var $e=E.value;$e!=null?fr(_,!!E.multiple,$e,!1):Fe!==!!E.multiple&&(E.defaultValue!=null?fr(_,!!E.multiple,E.defaultValue,!0):fr(_,!!E.multiple,E.multiple?[]:"",!1))}_[pu]=E}catch(Xe){yr(a,a.return,Xe)}}break;case 6:if(ei(l,a),Fi(a),m&4){if(a.stateNode===null)throw Error(r(162));_=a.stateNode,E=a.memoizedProps;try{_.nodeValue=E}catch(Xe){yr(a,a.return,Xe)}}break;case 3:if(ei(l,a),Fi(a),m&4&&f!==null&&f.memoizedState.isDehydrated)try{Da(l.containerInfo)}catch(Xe){yr(a,a.return,Xe)}break;case 4:ei(l,a),Fi(a);break;case 13:ei(l,a),Fi(a),_=a.child,_.flags&8192&&(E=_.memoizedState!==null,_.stateNode.isHidden=E,!E||_.alternate!==null&&_.alternate.memoizedState!==null||(qp=Oe())),m&4&&f_(a);break;case 22:if(be=f!==null&&f.memoizedState!==null,a.mode&1?(Cn=(de=Cn)||be,ei(l,a),Cn=de):ei(l,a),Fi(a),m&8192){if(de=a.memoizedState!==null,(a.stateNode.isHidden=de)&&!be&&(a.mode&1)!==0)for(Ke=a,be=a.child;be!==null;){for(Le=Ke=be;Ke!==null;){switch(Fe=Ke,$e=Fe.child,Fe.tag){case 0:case 11:case 14:case 15:ku(4,Fe,Fe.return);break;case 1:Zl(Fe,Fe.return);var qe=Fe.stateNode;if(typeof qe.componentWillUnmount=="function"){m=Fe,f=Fe.return;try{l=m,qe.props=l.memoizedProps,qe.state=l.memoizedState,qe.componentWillUnmount()}catch(Xe){yr(m,f,Xe)}}break;case 5:Zl(Fe,Fe.return);break;case 22:if(Fe.memoizedState!==null){m_(Le);continue}}$e!==null?($e.return=Fe,Ke=$e):m_(Le)}be=be.sibling}e:for(be=null,Le=a;;){if(Le.tag===5){if(be===null){be=Le;try{_=Le.stateNode,de?(E=_.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(Q=Le.stateNode,re=Le.memoizedProps.style,R=re!=null&&re.hasOwnProperty("display")?re.display:null,Q.style.display=jt("display",R))}catch(Xe){yr(a,a.return,Xe)}}}else if(Le.tag===6){if(be===null)try{Le.stateNode.nodeValue=de?"":Le.memoizedProps}catch(Xe){yr(a,a.return,Xe)}}else if((Le.tag!==22&&Le.tag!==23||Le.memoizedState===null||Le===a)&&Le.child!==null){Le.child.return=Le,Le=Le.child;continue}if(Le===a)break e;for(;Le.sibling===null;){if(Le.return===null||Le.return===a)break e;be===Le&&(be=null),Le=Le.return}be===Le&&(be=null),Le.sibling.return=Le.return,Le=Le.sibling}}break;case 19:ei(l,a),Fi(a),m&4&&f_(a);break;case 21:break;default:ei(l,a),Fi(a)}}function Fi(a){var l=a.flags;if(l&2){try{e:{for(var f=a.return;f!==null;){if(l_(f)){var m=f;break e}f=f.return}throw Error(r(160))}switch(m.tag){case 5:var _=m.stateNode;m.flags&32&&(ot(_,""),m.flags&=-33);var E=c_(a);$p(a,E,_);break;case 3:case 4:var R=m.stateNode.containerInfo,Q=c_(a);Hp(a,Q,R);break;default:throw Error(r(161))}}catch(re){yr(a,a.return,re)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function cA(a,l,f){Ke=a,d_(a)}function d_(a,l,f){for(var m=(a.mode&1)!==0;Ke!==null;){var _=Ke,E=_.child;if(_.tag===22&&m){var R=_.memoizedState!==null||Lh;if(!R){var Q=_.alternate,re=Q!==null&&Q.memoizedState!==null||Cn;Q=Lh;var de=Cn;if(Lh=R,(Cn=re)&&!de)for(Ke=_;Ke!==null;)R=Ke,re=R.child,R.tag===22&&R.memoizedState!==null?g_(_):re!==null?(re.return=R,Ke=re):g_(_);for(;E!==null;)Ke=E,d_(E),E=E.sibling;Ke=_,Lh=Q,Cn=de}p_(a)}else(_.subtreeFlags&8772)!==0&&E!==null?(E.return=_,Ke=E):p_(a)}}function p_(a){for(;Ke!==null;){var l=Ke;if((l.flags&8772)!==0){var f=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Cn||Mh(5,l);break;case 1:var m=l.stateNode;if(l.flags&4&&!Cn)if(f===null)m.componentDidMount();else{var _=l.elementType===l.type?f.memoizedProps:Js(l.type,f.memoizedProps);m.componentDidUpdate(_,f.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var E=l.updateQueue;E!==null&&mv(l,E,m);break;case 3:var R=l.updateQueue;if(R!==null){if(f=null,l.child!==null)switch(l.child.tag){case 5:f=l.child.stateNode;break;case 1:f=l.child.stateNode}mv(l,R,f)}break;case 5:var Q=l.stateNode;if(f===null&&l.flags&4){f=Q;var re=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":re.autoFocus&&f.focus();break;case"img":re.src&&(f.src=re.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var de=l.alternate;if(de!==null){var be=de.memoizedState;if(be!==null){var Le=be.dehydrated;Le!==null&&Da(Le)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Cn||l.flags&512&&Wp(l)}catch(Fe){yr(l,l.return,Fe)}}if(l===a){Ke=null;break}if(f=l.sibling,f!==null){f.return=l.return,Ke=f;break}Ke=l.return}}function m_(a){for(;Ke!==null;){var l=Ke;if(l===a){Ke=null;break}var f=l.sibling;if(f!==null){f.return=l.return,Ke=f;break}Ke=l.return}}function g_(a){for(;Ke!==null;){var l=Ke;try{switch(l.tag){case 0:case 11:case 15:var f=l.return;try{Mh(4,l)}catch(re){yr(l,f,re)}break;case 1:var m=l.stateNode;if(typeof m.componentDidMount=="function"){var _=l.return;try{m.componentDidMount()}catch(re){yr(l,_,re)}}var E=l.return;try{Wp(l)}catch(re){yr(l,E,re)}break;case 5:var R=l.return;try{Wp(l)}catch(re){yr(l,R,re)}}}catch(re){yr(l,l.return,re)}if(l===a){Ke=null;break}var Q=l.sibling;if(Q!==null){Q.return=l.return,Ke=Q;break}Ke=l.return}}var uA=Math.ceil,Bh=j.ReactCurrentDispatcher,Gp=j.ReactCurrentOwner,Os=j.ReactCurrentBatchConfig,Dt=0,tn=null,Lr=null,dn=0,vs=0,ec=Ba(0),qr=0,Au=null,Uo=0,Vh=0,Kp=0,Cu=null,ts=null,qp=0,tc=1/0,aa=null,jh=!1,Xp=null,Ha=null,Uh=!1,$a=null,zh=0,Iu=0,Yp=null,Wh=-1,Hh=0;function Wn(){return(Dt&6)!==0?Oe():Wh!==-1?Wh:Wh=Oe()}function Ga(a){return(a.mode&1)===0?1:(Dt&2)!==0&&dn!==0?dn&-dn:K4.transition!==null?(Hh===0&&(Hh=Xc()),Hh):(a=Ft,a!==0||(a=window.event,a=a===void 0?16:bl(a.type)),a)}function ti(a,l,f,m){if(50<Iu)throw Iu=0,Yp=null,Error(r(185));Fo(a,f,m),((Dt&2)===0||a!==tn)&&(a===tn&&((Dt&2)===0&&(Vh|=f),qr===4&&Ka(a,dn)),rs(a,m),f===1&&Dt===0&&(l.mode&1)===0&&(tc=Oe()+500,vh&&ja()))}function rs(a,l){var f=a.callbackNode;Io(a,l);var m=Ki(a,a===tn?dn:0);if(m===0)f!==null&&Be(f),a.callbackNode=null,a.callbackPriority=0;else if(l=m&-m,a.callbackPriority!==l){if(f!=null&&Be(f),l===1)a.tag===0?G4(v_.bind(null,a)):nv(v_.bind(null,a)),z4(function(){(Dt&6)===0&&ja()}),f=null;else{switch(gi(m)){case 1:f=zt;break;case 4:f=Gt;break;case 16:f=cr;break;case 536870912:f=Fs;break;default:f=cr}f=A_(f,x_.bind(null,a))}a.callbackPriority=l,a.callbackNode=f}}function x_(a,l){if(Wh=-1,Hh=0,(Dt&6)!==0)throw Error(r(327));var f=a.callbackNode;if(rc()&&a.callbackNode!==f)return null;var m=Ki(a,a===tn?dn:0);if(m===0)return null;if((m&30)!==0||(m&a.expiredLanes)!==0||l)l=$h(a,m);else{l=m;var _=Dt;Dt|=2;var E=y_();(tn!==a||dn!==l)&&(aa=null,tc=Oe()+500,Wo(a,l));do try{dA();break}catch(Q){__(a,Q)}while(!0);pp(),Bh.current=E,Dt=_,Lr!==null?l=0:(tn=null,dn=0,l=qr)}if(l!==0){if(l===2&&(_=qc(a),_!==0&&(m=_,l=Qp(a,_))),l===1)throw f=Au,Wo(a,0),Ka(a,m),rs(a,Oe()),f;if(l===6)Ka(a,m);else{if(_=a.current.alternate,(m&30)===0&&!fA(_)&&(l=$h(a,m),l===2&&(E=qc(a),E!==0&&(m=E,l=Qp(a,E))),l===1))throw f=Au,Wo(a,0),Ka(a,m),rs(a,Oe()),f;switch(a.finishedWork=_,a.finishedLanes=m,l){case 0:case 1:throw Error(r(345));case 2:Ho(a,ts,aa);break;case 3:if(Ka(a,m),(m&130023424)===m&&(l=qp+500-Oe(),10<l)){if(Ki(a,0)!==0)break;if(_=a.suspendedLanes,(_&m)!==m){Wn(),a.pingedLanes|=a.suspendedLanes&_;break}a.timeoutHandle=np(Ho.bind(null,a,ts,aa),l);break}Ho(a,ts,aa);break;case 4:if(Ka(a,m),(m&4194240)===m)break;for(l=a.eventTimes,_=-1;0<m;){var R=31-dr(m);E=1<<R,R=l[R],R>_&&(_=R),m&=~E}if(m=_,m=Oe()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*uA(m/1960))-m,10<m){a.timeoutHandle=np(Ho.bind(null,a,ts,aa),m);break}Ho(a,ts,aa);break;case 5:Ho(a,ts,aa);break;default:throw Error(r(329))}}}return rs(a,Oe()),a.callbackNode===f?x_.bind(null,a):null}function Qp(a,l){var f=Cu;return a.current.memoizedState.isDehydrated&&(Wo(a,l).flags|=256),a=$h(a,l),a!==2&&(l=ts,ts=f,l!==null&&Jp(l)),a}function Jp(a){ts===null?ts=a:ts.push.apply(ts,a)}function fA(a){for(var l=a;;){if(l.flags&16384){var f=l.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var m=0;m<f.length;m++){var _=f[m],E=_.getSnapshot;_=_.value;try{if(!Ys(E(),_))return!1}catch{return!1}}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ka(a,l){for(l&=~Kp,l&=~Vh,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var f=31-dr(l),m=1<<f;a[f]=-1,l&=~m}}function v_(a){if((Dt&6)!==0)throw Error(r(327));rc();var l=Ki(a,0);if((l&1)===0)return rs(a,Oe()),null;var f=$h(a,l);if(a.tag!==0&&f===2){var m=qc(a);m!==0&&(l=m,f=Qp(a,m))}if(f===1)throw f=Au,Wo(a,0),Ka(a,l),rs(a,Oe()),f;if(f===6)throw Error(r(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,Ho(a,ts,aa),rs(a,Oe()),null}function Zp(a,l){var f=Dt;Dt|=1;try{return a(l)}finally{Dt=f,Dt===0&&(tc=Oe()+500,vh&&ja())}}function zo(a){$a!==null&&$a.tag===0&&(Dt&6)===0&&rc();var l=Dt;Dt|=1;var f=Os.transition,m=Ft;try{if(Os.transition=null,Ft=1,a)return a()}finally{Ft=m,Os.transition=f,Dt=l,(Dt&6)===0&&ja()}}function em(){vs=ec.current,sr(ec)}function Wo(a,l){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==-1&&(a.timeoutHandle=-1,U4(f)),Lr!==null)for(f=Lr.return;f!==null;){var m=f;switch(cp(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&gh();break;case 3:Ql(),sr(Jn),sr(Sn),Ep();break;case 5:yp(m);break;case 4:Ql();break;case 13:sr(pr);break;case 19:sr(pr);break;case 10:mp(m.type._context);break;case 22:case 23:em()}f=f.return}if(tn=a,Lr=a=qa(a.current,null),dn=vs=l,qr=0,Au=null,Kp=Vh=Uo=0,ts=Cu=null,Bo!==null){for(l=0;l<Bo.length;l++)if(f=Bo[l],m=f.interleaved,m!==null){f.interleaved=null;var _=m.next,E=f.pending;if(E!==null){var R=E.next;E.next=_,m.next=R}f.pending=m}Bo=null}return a}function __(a,l){do{var f=Lr;try{if(pp(),Ih.current=Rh,Fh){for(var m=mr.memoizedState;m!==null;){var _=m.queue;_!==null&&(_.pending=null),m=m.next}Fh=!1}if(jo=0,en=Kr=mr=null,yu=!1,wu=0,Gp.current=null,f===null||f.return===null){qr=1,Au=l,Lr=null;break}e:{var E=a,R=f.return,Q=f,re=l;if(l=dn,Q.flags|=32768,re!==null&&typeof re=="object"&&typeof re.then=="function"){var de=re,be=Q,Le=be.tag;if((be.mode&1)===0&&(Le===0||Le===11||Le===15)){var Fe=be.alternate;Fe?(be.updateQueue=Fe.updateQueue,be.memoizedState=Fe.memoizedState,be.lanes=Fe.lanes):(be.updateQueue=null,be.memoizedState=null)}var $e=Hv(R);if($e!==null){$e.flags&=-257,$v($e,R,Q,E,l),$e.mode&1&&Wv(E,de,l),l=$e,re=de;var qe=l.updateQueue;if(qe===null){var Xe=new Set;Xe.add(re),l.updateQueue=Xe}else qe.add(re);break e}else{if((l&1)===0){Wv(E,de,l),tm();break e}re=Error(r(426))}}else if(ur&&Q.mode&1){var Ir=Hv(R);if(Ir!==null){(Ir.flags&65536)===0&&(Ir.flags|=256),$v(Ir,R,Q,E,l),hp(Jl(re,Q));break e}}E=re=Jl(re,Q),qr!==4&&(qr=2),Cu===null?Cu=[E]:Cu.push(E),E=R;do{switch(E.tag){case 3:E.flags|=65536,l&=-l,E.lanes|=l;var ie=Uv(E,re,l);pv(E,ie);break e;case 1:Q=re;var se=E.type,ue=E.stateNode;if((E.flags&128)===0&&(typeof se.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(Ha===null||!Ha.has(ue)))){E.flags|=65536,l&=-l,E.lanes|=l;var Me=zv(E,Q,l);pv(E,Me);break e}}E=E.return}while(E!==null)}E_(f)}catch(Ye){l=Ye,Lr===f&&f!==null&&(Lr=f=f.return);continue}break}while(!0)}function y_(){var a=Bh.current;return Bh.current=Rh,a===null?Rh:a}function tm(){(qr===0||qr===3||qr===2)&&(qr=4),tn===null||(Uo&268435455)===0&&(Vh&268435455)===0||Ka(tn,dn)}function $h(a,l){var f=Dt;Dt|=2;var m=y_();(tn!==a||dn!==l)&&(aa=null,Wo(a,l));do try{hA();break}catch(_){__(a,_)}while(!0);if(pp(),Dt=f,Bh.current=m,Lr!==null)throw Error(r(261));return tn=null,dn=0,qr}function hA(){for(;Lr!==null;)w_(Lr)}function dA(){for(;Lr!==null&&!We();)w_(Lr)}function w_(a){var l=k_(a.alternate,a,vs);a.memoizedProps=a.pendingProps,l===null?E_(a):Lr=l,Gp.current=null}function E_(a){var l=a;do{var f=l.alternate;if(a=l.return,(l.flags&32768)===0){if(f=iA(f,l,vs),f!==null){Lr=f;return}}else{if(f=aA(f,l),f!==null){f.flags&=32767,Lr=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{qr=6,Lr=null;return}}if(l=l.sibling,l!==null){Lr=l;return}Lr=l=a}while(l!==null);qr===0&&(qr=5)}function Ho(a,l,f){var m=Ft,_=Os.transition;try{Os.transition=null,Ft=1,pA(a,l,f,m)}finally{Os.transition=_,Ft=m}return null}function pA(a,l,f,m){do rc();while($a!==null);if((Dt&6)!==0)throw Error(r(327));f=a.finishedWork;var _=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(r(177));a.callbackNode=null,a.callbackPriority=0;var E=f.lanes|f.childLanes;if(Ud(a,E),a===tn&&(Lr=tn=null,dn=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||Uh||(Uh=!0,A_(cr,function(){return rc(),null})),E=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||E){E=Os.transition,Os.transition=null;var R=Ft;Ft=1;var Q=Dt;Dt|=4,Gp.current=null,lA(a,f),h_(f,a),P4(tp),Yi=!!ep,tp=ep=null,a.current=f,cA(f),Pe(),Dt=Q,Ft=R,Os.transition=E}else a.current=f;if(Uh&&(Uh=!1,$a=a,zh=_),E=a.pendingLanes,E===0&&(Ha=null),Fa(f.stateNode),rs(a,Oe()),l!==null)for(m=a.onRecoverableError,f=0;f<l.length;f++)_=l[f],m(_.value,{componentStack:_.stack,digest:_.digest});if(jh)throw jh=!1,a=Xp,Xp=null,a;return(zh&1)!==0&&a.tag!==0&&rc(),E=a.pendingLanes,(E&1)!==0?a===Yp?Iu++:(Iu=0,Yp=a):Iu=0,ja(),null}function rc(){if($a!==null){var a=gi(zh),l=Os.transition,f=Ft;try{if(Os.transition=null,Ft=16>a?16:a,$a===null)var m=!1;else{if(a=$a,$a=null,zh=0,(Dt&6)!==0)throw Error(r(331));var _=Dt;for(Dt|=4,Ke=a.current;Ke!==null;){var E=Ke,R=E.child;if((Ke.flags&16)!==0){var Q=E.deletions;if(Q!==null){for(var re=0;re<Q.length;re++){var de=Q[re];for(Ke=de;Ke!==null;){var be=Ke;switch(be.tag){case 0:case 11:case 15:ku(8,be,E)}var Le=be.child;if(Le!==null)Le.return=be,Ke=Le;else for(;Ke!==null;){be=Ke;var Fe=be.sibling,$e=be.return;if(o_(be),be===de){Ke=null;break}if(Fe!==null){Fe.return=$e,Ke=Fe;break}Ke=$e}}}var qe=E.alternate;if(qe!==null){var Xe=qe.child;if(Xe!==null){qe.child=null;do{var Ir=Xe.sibling;Xe.sibling=null,Xe=Ir}while(Xe!==null)}}Ke=E}}if((E.subtreeFlags&2064)!==0&&R!==null)R.return=E,Ke=R;else e:for(;Ke!==null;){if(E=Ke,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:ku(9,E,E.return)}var ie=E.sibling;if(ie!==null){ie.return=E.return,Ke=ie;break e}Ke=E.return}}var se=a.current;for(Ke=se;Ke!==null;){R=Ke;var ue=R.child;if((R.subtreeFlags&2064)!==0&&ue!==null)ue.return=R,Ke=ue;else e:for(R=se;Ke!==null;){if(Q=Ke,(Q.flags&2048)!==0)try{switch(Q.tag){case 0:case 11:case 15:Mh(9,Q)}}catch(Ye){yr(Q,Q.return,Ye)}if(Q===R){Ke=null;break e}var Me=Q.sibling;if(Me!==null){Me.return=Q.return,Ke=Me;break e}Ke=Q.return}}if(Dt=_,ja(),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(fs,a)}catch{}m=!0}return m}finally{Ft=f,Os.transition=l}}return!1}function T_(a,l,f){l=Jl(f,l),l=Uv(a,l,1),a=za(a,l,1),l=Wn(),a!==null&&(Fo(a,1,l),rs(a,l))}function yr(a,l,f){if(a.tag===3)T_(a,a,f);else for(;l!==null;){if(l.tag===3){T_(l,a,f);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Ha===null||!Ha.has(m))){a=Jl(f,a),a=zv(l,a,1),l=za(l,a,1),a=Wn(),l!==null&&(Fo(l,1,a),rs(l,a));break}}l=l.return}}function mA(a,l,f){var m=a.pingCache;m!==null&&m.delete(l),l=Wn(),a.pingedLanes|=a.suspendedLanes&f,tn===a&&(dn&f)===f&&(qr===4||qr===3&&(dn&130023424)===dn&&500>Oe()-qp?Wo(a,0):Kp|=f),rs(a,l)}function S_(a,l){l===0&&((a.mode&1)===0?l=1:(l=ba,ba<<=1,(ba&130023424)===0&&(ba=4194304)));var f=Wn();a=na(a,l),a!==null&&(Fo(a,l,f),rs(a,f))}function gA(a){var l=a.memoizedState,f=0;l!==null&&(f=l.retryLane),S_(a,f)}function xA(a,l){var f=0;switch(a.tag){case 13:var m=a.stateNode,_=a.memoizedState;_!==null&&(f=_.retryLane);break;case 19:m=a.stateNode;break;default:throw Error(r(314))}m!==null&&m.delete(l),S_(a,f)}var k_;k_=function(a,l,f){if(a!==null)if(a.memoizedProps!==l.pendingProps||Jn.current)es=!0;else{if((a.lanes&f)===0&&(l.flags&128)===0)return es=!1,sA(a,l,f);es=(a.flags&131072)!==0}else es=!1,ur&&(l.flags&1048576)!==0&&sv(l,yh,l.index);switch(l.lanes=0,l.tag){case 2:var m=l.type;Oh(a,l),a=l.pendingProps;var _=Hl(l,Sn.current);Yl(l,f),_=kp(null,l,m,a,_,f);var E=Ap();return l.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Zn(m)?(E=!0,xh(l)):E=!1,l.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,vp(l),_.updater=Dh,l.stateNode=_,_._reactInternals=l,Rp(l,m,a,f),l=Lp(null,l,m,!0,E,f)):(l.tag=0,ur&&E&&lp(l),zn(null,l,_,f),l=l.child),l;case 16:m=l.elementType;e:{switch(Oh(a,l),a=l.pendingProps,_=m._init,m=_(m._payload),l.type=m,_=l.tag=_A(m),a=Js(m,a),_){case 0:l=Op(null,l,m,a,f);break e;case 1:l=Qv(null,l,m,a,f);break e;case 11:l=Gv(null,l,m,a,f);break e;case 14:l=Kv(null,l,m,Js(m.type,a),f);break e}throw Error(r(306,m,""))}return l;case 0:return m=l.type,_=l.pendingProps,_=l.elementType===m?_:Js(m,_),Op(a,l,m,_,f);case 1:return m=l.type,_=l.pendingProps,_=l.elementType===m?_:Js(m,_),Qv(a,l,m,_,f);case 3:e:{if(Jv(l),a===null)throw Error(r(387));m=l.pendingProps,E=l.memoizedState,_=E.element,dv(a,l),Ah(l,m,null,f);var R=l.memoizedState;if(m=R.element,E.isDehydrated)if(E={element:m,isDehydrated:!1,cache:R.cache,pendingSuspenseBoundaries:R.pendingSuspenseBoundaries,transitions:R.transitions},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){_=Jl(Error(r(423)),l),l=Zv(a,l,m,f,_);break e}else if(m!==_){_=Jl(Error(r(424)),l),l=Zv(a,l,m,f,_);break e}else for(xs=Ma(l.stateNode.containerInfo.firstChild),gs=l,ur=!0,Qs=null,f=fv(l,null,m,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Kl(),m===_){l=ia(a,l,f);break e}zn(a,l,m,f)}l=l.child}return l;case 5:return gv(l),a===null&&fp(l),m=l.type,_=l.pendingProps,E=a!==null?a.memoizedProps:null,R=_.children,rp(m,_)?R=null:E!==null&&rp(m,E)&&(l.flags|=32),Yv(a,l),zn(a,l,R,f),l.child;case 6:return a===null&&fp(l),null;case 13:return e_(a,l,f);case 4:return _p(l,l.stateNode.containerInfo),m=l.pendingProps,a===null?l.child=ql(l,null,m,f):zn(a,l,m,f),l.child;case 11:return m=l.type,_=l.pendingProps,_=l.elementType===m?_:Js(m,_),Gv(a,l,m,_,f);case 7:return zn(a,l,l.pendingProps,f),l.child;case 8:return zn(a,l,l.pendingProps.children,f),l.child;case 12:return zn(a,l,l.pendingProps.children,f),l.child;case 10:e:{if(m=l.type._context,_=l.pendingProps,E=l.memoizedProps,R=_.value,er(Th,m._currentValue),m._currentValue=R,E!==null)if(Ys(E.value,R)){if(E.children===_.children&&!Jn.current){l=ia(a,l,f);break e}}else for(E=l.child,E!==null&&(E.return=l);E!==null;){var Q=E.dependencies;if(Q!==null){R=E.child;for(var re=Q.firstContext;re!==null;){if(re.context===m){if(E.tag===1){re=sa(-1,f&-f),re.tag=2;var de=E.updateQueue;if(de!==null){de=de.shared;var be=de.pending;be===null?re.next=re:(re.next=be.next,be.next=re),de.pending=re}}E.lanes|=f,re=E.alternate,re!==null&&(re.lanes|=f),gp(E.return,f,l),Q.lanes|=f;break}re=re.next}}else if(E.tag===10)R=E.type===l.type?null:E.child;else if(E.tag===18){if(R=E.return,R===null)throw Error(r(341));R.lanes|=f,Q=R.alternate,Q!==null&&(Q.lanes|=f),gp(R,f,l),R=E.sibling}else R=E.child;if(R!==null)R.return=E;else for(R=E;R!==null;){if(R===l){R=null;break}if(E=R.sibling,E!==null){E.return=R.return,R=E;break}R=R.return}E=R}zn(a,l,_.children,f),l=l.child}return l;case 9:return _=l.type,m=l.pendingProps.children,Yl(l,f),_=Ds(_),m=m(_),l.flags|=1,zn(a,l,m,f),l.child;case 14:return m=l.type,_=Js(m,l.pendingProps),_=Js(m.type,_),Kv(a,l,m,_,f);case 15:return qv(a,l,l.type,l.pendingProps,f);case 17:return m=l.type,_=l.pendingProps,_=l.elementType===m?_:Js(m,_),Oh(a,l),l.tag=1,Zn(m)?(a=!0,xh(l)):a=!1,Yl(l,f),Vv(l,m,_),Rp(l,m,_,f),Lp(null,l,m,!0,a,f);case 19:return r_(a,l,f);case 22:return Xv(a,l,f)}throw Error(r(156,l.tag))};function A_(a,l){return Re(a,l)}function vA(a,l,f,m){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ls(a,l,f,m){return new vA(a,l,f,m)}function rm(a){return a=a.prototype,!(!a||!a.isReactComponent)}function _A(a){if(typeof a=="function")return rm(a)?1:0;if(a!=null){if(a=a.$$typeof,a===D)return 11;if(a===Se)return 14}return 2}function qa(a,l){var f=a.alternate;return f===null?(f=Ls(a.tag,l,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=l,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,l=a.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function Gh(a,l,f,m,_,E){var R=2;if(m=a,typeof a=="function")rm(a)&&(R=1);else if(typeof a=="string")R=5;else e:switch(a){case A:return $o(f.children,_,E,l);case C:R=8,_|=8;break;case F:return a=Ls(12,f,l,_|2),a.elementType=F,a.lanes=E,a;case L:return a=Ls(13,f,l,_),a.elementType=L,a.lanes=E,a;case ke:return a=Ls(19,f,l,_),a.elementType=ke,a.lanes=E,a;case Ne:return Kh(f,_,E,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case V:R=10;break e;case M:R=9;break e;case D:R=11;break e;case Se:R=14;break e;case De:R=16,m=null;break e}throw Error(r(130,a==null?a:typeof a,""))}return l=Ls(R,f,l,_),l.elementType=a,l.type=m,l.lanes=E,l}function $o(a,l,f,m){return a=Ls(7,a,m,l),a.lanes=f,a}function Kh(a,l,f,m){return a=Ls(22,a,m,l),a.elementType=Ne,a.lanes=f,a.stateNode={isHidden:!1},a}function nm(a,l,f){return a=Ls(6,a,null,l),a.lanes=f,a}function sm(a,l,f){return l=Ls(4,a.children!==null?a.children:[],a.key,l),l.lanes=f,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function yA(a,l,f,m,_){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yc(0),this.expirationTimes=Yc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yc(0),this.identifierPrefix=m,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function im(a,l,f,m,_,E,R,Q,re){return a=new yA(a,l,f,Q,re),l===1?(l=1,E===!0&&(l|=8)):l=0,E=Ls(3,null,null,l),a.current=E,E.stateNode=a,E.memoizedState={element:m,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},vp(E),a}function wA(a,l,f){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:m==null?null:""+m,children:a,containerInfo:l,implementation:f}}function C_(a){if(!a)return Va;a=a._reactInternals;e:{if(q(a)!==a||a.tag!==1)throw Error(r(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Zn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(r(171))}if(a.tag===1){var f=a.type;if(Zn(f))return tv(a,f,l)}return l}function I_(a,l,f,m,_,E,R,Q,re){return a=im(f,m,!0,a,_,E,R,Q,re),a.context=C_(null),f=a.current,m=Wn(),_=Ga(f),E=sa(m,_),E.callback=l??null,za(f,E,_),a.current.lanes=_,Fo(a,_,m),rs(a,m),a}function qh(a,l,f,m){var _=l.current,E=Wn(),R=Ga(_);return f=C_(f),l.context===null?l.context=f:l.pendingContext=f,l=sa(E,R),l.payload={element:a},m=m===void 0?null:m,m!==null&&(l.callback=m),a=za(_,l,R),a!==null&&(ti(a,_,R,E),kh(a,_,R)),R}function Xh(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function F_(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<l?f:l}}function am(a,l){F_(a,l),(a=a.alternate)&&F_(a,l)}function EA(){return null}var b_=typeof reportError=="function"?reportError:function(a){console.error(a)};function om(a){this._internalRoot=a}Yh.prototype.render=om.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(r(409));qh(a,l,null,null)},Yh.prototype.unmount=om.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;zo(function(){qh(null,a,null,null)}),l[Zi]=null}};function Yh(a){this._internalRoot=a}Yh.prototype.unstable_scheduleHydration=function(a){if(a){var l=eu();a={blockedOn:null,target:a,priority:l};for(var f=0;f<hs.length&&l!==0&&l<hs[f].priority;f++);hs.splice(f,0,a),f===0&&Il(a)}};function lm(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Qh(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function N_(){}function TA(a,l,f,m,_){if(_){if(typeof m=="function"){var E=m;m=function(){var de=Xh(R);E.call(de)}}var R=I_(l,m,a,0,null,!1,!1,"",N_);return a._reactRootContainer=R,a[Zi]=R.current,hu(a.nodeType===8?a.parentNode:a),zo(),R}for(;_=a.lastChild;)a.removeChild(_);if(typeof m=="function"){var Q=m;m=function(){var de=Xh(re);Q.call(de)}}var re=im(a,0,!1,null,null,!1,!1,"",N_);return a._reactRootContainer=re,a[Zi]=re.current,hu(a.nodeType===8?a.parentNode:a),zo(function(){qh(l,re,f,m)}),re}function Jh(a,l,f,m,_){var E=f._reactRootContainer;if(E){var R=E;if(typeof _=="function"){var Q=_;_=function(){var re=Xh(R);Q.call(re)}}qh(l,R,a,_)}else R=TA(f,l,a,_,m);return Xh(R)}Jc=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var f=Bt(l.pendingLanes);f!==0&&(Qc(l,f|1),rs(l,Oe()),(Dt&6)===0&&(tc=Oe()+500,ja()))}break;case 13:zo(function(){var m=na(a,1);if(m!==null){var _=Wn();ti(m,a,1,_)}}),am(a,1)}},Al=function(a){if(a.tag===13){var l=na(a,134217728);if(l!==null){var f=Wn();ti(l,a,134217728,f)}am(a,134217728)}},Zc=function(a){if(a.tag===13){var l=Ga(a),f=na(a,l);if(f!==null){var m=Wn();ti(f,a,l,m)}am(a,l)}},eu=function(){return Ft},tu=function(a,l){var f=Ft;try{return Ft=a,l()}finally{Ft=f}},Yn=function(a,l,f){switch(l){case"input":if(je(a,f),l=f.name,f.type==="radio"&&l!=null){for(f=a;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<f.length;l++){var m=f[l];if(m!==a&&m.form===a.form){var _=mh(m);if(!_)throw Error(r(90));Y(m),je(m,_)}}}break;case"textarea":$r(a,f);break;case"select":l=f.value,l!=null&&fr(a,!!f.multiple,l,!1)}},Ia=Zp,Qe=zo;var SA={usingClientEntryPoint:!1,Events:[mu,zl,mh,Cs,Is,Zp]},Fu={findFiberByHostInstance:Po,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kA={bundleType:Fu.bundleType,version:Fu.version,rendererPackageName:Fu.rendererPackageName,rendererConfig:Fu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=fe(a),a===null?null:a.stateNode},findFiberByHostInstance:Fu.findFiberByHostInstance||EA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zh.isDisabled&&Zh.supportsFiber)try{fs=Zh.inject(kA),Ar=Zh}catch{}}return ns.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SA,ns.createPortal=function(a,l){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lm(l))throw Error(r(200));return wA(a,l,null,f)},ns.createRoot=function(a,l){if(!lm(a))throw Error(r(299));var f=!1,m="",_=b_;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onRecoverableError!==void 0&&(_=l.onRecoverableError)),l=im(a,1,!1,null,null,f,!1,m,_),a[Zi]=l.current,hu(a.nodeType===8?a.parentNode:a),new om(l)},ns.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=fe(l),a=a===null?null:a.stateNode,a},ns.flushSync=function(a){return zo(a)},ns.hydrate=function(a,l,f){if(!Qh(l))throw Error(r(200));return Jh(null,a,l,!0,f)},ns.hydrateRoot=function(a,l,f){if(!lm(a))throw Error(r(405));var m=f!=null&&f.hydratedSources||null,_=!1,E="",R=b_;if(f!=null&&(f.unstable_strictMode===!0&&(_=!0),f.identifierPrefix!==void 0&&(E=f.identifierPrefix),f.onRecoverableError!==void 0&&(R=f.onRecoverableError)),l=I_(l,null,a,1,f??null,_,!1,E,R),a[Zi]=l.current,hu(a),m)for(a=0;a<m.length;a++)f=m[a],_=f._getVersion,_=_(f._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[f,_]:l.mutableSourceEagerHydrationData.push(f,_);return new Yh(l)},ns.render=function(a,l,f){if(!Qh(l))throw Error(r(200));return Jh(null,a,l,!1,f)},ns.unmountComponentAtNode=function(a){if(!Qh(a))throw Error(r(40));return a._reactRootContainer?(zo(function(){Jh(null,null,a,!1,function(){a._reactRootContainer=null,a[Zi]=null})}),!0):!1},ns.unstable_batchedUpdates=Zp,ns.unstable_renderSubtreeIntoContainer=function(a,l,f,m){if(!Qh(f))throw Error(r(200));if(a==null||a._reactInternals===void 0)throw Error(r(38));return Jh(a,l,f,!1,m)},ns.version="18.3.1-next-f1338f8080-20240426",ns}var V_;function OA(){if(V_)return hm.exports;V_=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),hm.exports=PA(),hm.exports}var j_;function LA(){if(j_)return t0;j_=1;var t=OA();return t0.createRoot=t.createRoot,t0.hydrateRoot=t.hydrateRoot,t0}var MA=LA();const BA=Nw(MA),mm={" ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],:["","","","","","","","","","","","","","","","","",""],:["","","","","",""]},Lg=[{id:"qualitative",name:"",desc:""},{id:"emotional",name:"",desc:""},{id:"friendly",name:"",desc:""},{id:"humorous",name:"",desc:""},{id:"internal",name:"",desc:""},{id:"philosophical",name:"",desc:""},{id:"practical",name:"",desc:""},{id:"resonance",name:"",desc:""},{id:"blessing",name:"",desc:""},{id:"scenario",name:"",desc:""},{id:"milestone",name:"",desc:""},{id:"journey",name:"",desc:""}],Rw=()=>localStorage.getItem("gemini_api_key")||"",U_=()=>!!Rw(),z_=async(t,e,r=[],n)=>{var k,w,S,N,B;const s=Rw();if(!s)return"  API Key Gemini API Key";const i=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${s}`;let o="";r.length>0?o=r.map(b=>{const j=Lg.find(X=>X.id===b);return j?`${j.name}${j.desc}`:""}).join(`
`):o="";const u=`${{normal:"",casual:"",formal:""}[n.tone]||""}`,h=` ${n.wordCount||80} `,d=`""

${t}
${e||""}

****
1. ${u}
2. ${h}

 ${r.length||1} 
${o}

****
1. 
2. 
3. ** Markdown ** ******# 
4. ****
5. 
6. 

...
()

...
`;let g=0;const x=5,y=[1e3,2e3,4e3,8e3,16e3];for(;g<=x;)try{const b=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:d}]}]})});if(!b.ok){if(b.status===400||b.status===401||b.status===403)return" API Key ";throw new Error(`API Error: ${b.status}`)}return((B=(N=(S=(w=(k=(await b.json()).candidates)==null?void 0:k[0])==null?void 0:w.content)==null?void 0:S.parts)==null?void 0:N[0])==null?void 0:B.text)||""}catch(b){if(g===x)return console.error("Gemini API Failed:",b),"";await new Promise(j=>setTimeout(j,y[g])),g++}};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VA=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Dw=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var jA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=Te.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:o,...c},u)=>Te.createElement("svg",{ref:u,...jA,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:Dw("lucide",s),...c},[...o.map(([h,d])=>Te.createElement(h,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=(t,e)=>{const r=Te.forwardRef(({className:n,...s},i)=>Te.createElement(UA,{ref:i,iconNode:e,className:Dw(`lucide-${VA(t)}`,n),...s}));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=bt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WA=bt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=bt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N0=bt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gm=bt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=bt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tc=bt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=bt("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $A=bt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rf=bt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GA=bt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KA=bt("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=bt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qA=bt("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=bt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=bt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XA=bt("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=bt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YA=bt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QA=bt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JA=bt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=bt("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=bt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=bt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=bt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nf=bt("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=bt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=bt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=bt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=bt("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=bt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=bt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gm=bt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=bt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=bt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Uw=Te.createContext(null),W_={success:{bg:"bg-[#1DD1A1]",icon:Gm,iconColor:"text-white"},error:{bg:"bg-[#FF6B6B]",icon:Pw,iconColor:"text-white"},warning:{bg:"bg-[#FECA57]",icon:N0,iconColor:"text-[#2D3436]"},info:{bg:"bg-[#54A0FF]",icon:Lw,iconColor:"text-white"}},i3=({id:t,message:e,type:r,onRemove:n})=>{const s=W_[r]||W_.info,i=s.icon;return v.jsxs("div",{className:`${s.bg} text-white px-4 py-3 rounded-lg shadow-lg border-2 border-[#2D3436] 
                       flex items-center gap-3 min-w-[280px] max-w-[400px] animate-in 
                       slide-in-from-right-5 duration-300`,role:"alert",children:[v.jsx(i,{size:20,className:s.iconColor}),v.jsx("span",{className:"flex-1 font-medium text-sm",children:e}),v.jsx("button",{onClick:()=>n(t),className:"p-1 hover:bg-white/20 rounded transition-colors",children:v.jsx(Ss,{size:16})})]})},a3=({toasts:t,onRemove:e})=>t.length===0?null:v.jsx("div",{className:"fixed top-4 right-4 z-[100] flex flex-col gap-2",children:t.map(r=>v.jsx(i3,{...r,onRemove:e},r.id))}),o3=({children:t})=>{const[e,r]=Te.useState([]),n=Te.useCallback(o=>{r(c=>c.filter(u=>u.id!==o))},[]),s=Te.useCallback((o,c="info",u=3e3)=>{const h=Date.now()+Math.random();return r(d=>[...d,{id:h,message:o,type:c}]),u>0&&setTimeout(()=>n(h),u),h},[n]),i={success:(o,c)=>s(o,"success",c),error:(o,c)=>s(o,"error",c??5e3),warning:(o,c)=>s(o,"warning",c),info:(o,c)=>s(o,"info",c)};return v.jsxs(Uw.Provider,{value:{showToast:s,toast:i,removeToast:n},children:[t,v.jsx(a3,{toasts:e,onRemove:n})]})},zw=()=>{const t=Te.useContext(Uw);if(!t)throw new Error("useToast  ToastProvider ");return t},l3=(t,e)=>{let r="";e==="csv"?(r=`\uFEFF,,
`,t.forEach(o=>{const u=[...o.selectedTags,o.manualTraits].filter(Boolean).join("").replace(/,/g,""),h=o.comment.replace(/,/g,"").replace(/\n/g," ");r+=`${o.name},"${u}","${h}"
`})):t.forEach(o=>{const c=[...o.selectedTags,o.manualTraits].filter(Boolean).join("");r+=`${o.name}
${c||""}

${o.comment}
-------------------
`});const n=new Blob([r],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download=`_${new Date().toLocaleDateString()}.${e}`,i.click(),URL.revokeObjectURL(s)},c3=()=>{const[t,e]=Te.useState({isOpen:!1,type:"info",title:"",message:"",onConfirm:null}),r=Te.useCallback(()=>{e(i=>({...i,isOpen:!1}))},[]),n=Te.useCallback((i,o,c)=>{e({isOpen:!0,type:"confirm",title:i,message:o,onConfirm:c})},[]),s=Te.useCallback(i=>{e({isOpen:!0,type:"info",title:"",message:i,onConfirm:null})},[]);return{dialog:t,closeDialog:r,showConfirm:n,showAlert:s}},u3=()=>{};var H_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},f3=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],o=t[r++],c=t[r++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Hw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,d=i>>2,g=(i&3)<<4|c>>4;let x=(c&15)<<2|h>>6,y=h&63;u||(y=64,o||(x=64)),n.push(r[d],r[g],r[x],r[y])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ww(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):f3(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],c=s<t.length?r[t.charAt(s)]:0;++s;const h=s<t.length?r[t.charAt(s)]:64;++s;const g=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||c==null||h==null||g==null)throw new h3;const x=i<<2|c>>4;if(n.push(x),h!==64){const y=c<<4&240|h>>2;if(n.push(y),g!==64){const k=h<<6&192|g;n.push(k)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class h3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const d3=function(t){const e=Ww(t);return Hw.encodeByteArray(e,!0)},R0=function(t){return d3(t).replace(/\./g,"")},$w=function(t){try{return Hw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m3=()=>p3().__FIREBASE_DEFAULTS__,g3=()=>{if(typeof process>"u"||typeof H_>"u")return;const t=H_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},x3=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&$w(t[1]);return e&&JSON.parse(e)},fd=()=>{try{return u3()||m3()||g3()||x3()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Gw=t=>{var e,r;return(r=(e=fd())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},v3=t=>{const e=Gw(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Kw=()=>{var t;return(t=fd())==null?void 0:t.config},qw=t=>{var e;return(e=fd())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _3{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Xw(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y3(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[R0(JSON.stringify(r)),R0(JSON.stringify(o)),""].join(".")}const ju={};function w3(){const t={prod:[],emulator:[]};for(const e of Object.keys(ju))ju[e]?t.emulator.push(e):t.prod.push(e);return t}function E3(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let $_=!1;function Yw(t,e){if(typeof window>"u"||typeof document>"u"||!Lc(window.location.host)||ju[t]===e||ju[t]||$_)return;ju[t]=e;function r(x){return`__firebase__banner__${x}`}const n="__firebase__banner",i=w3().prod.length>0;function o(){const x=document.getElementById(n);x&&x.remove()}function c(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function u(x,y){x.setAttribute("width","24"),x.setAttribute("id",y),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function h(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{$_=!0,o()},x}function d(x,y){x.setAttribute("id",y),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function g(){const x=E3(n),y=r("text"),k=document.getElementById(y)||document.createElement("span"),w=r("learnmore"),S=document.getElementById(w)||document.createElement("a"),N=r("preprendIcon"),B=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const b=x.element;c(b),d(S,w);const j=h();u(B,N),b.append(B,k,S,j),document.body.appendChild(b)}i?(k.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function T3(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Bn())}function S3(){var e;const t=(e=fd())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function k3(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function A3(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function C3(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function I3(){const t=Bn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function F3(){return!S3()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function b3(){try{return typeof indexedDB=="object"}catch{return!1}}function N3(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R3="FirebaseError";class Sa extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=R3,Object.setPrototypeOf(this,Sa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ff.prototype.create)}}class Ff{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?D3(i,n):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Sa(s,c,n)}}function D3(t,e){return t.replace(P3,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const P3=/\{\$([^}]+)}/g;function O3(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function al(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],o=e[s];if(G_(i)&&G_(o)){if(!al(i,o))return!1}else if(i!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function G_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function L3(t,e){const r=new M3(t,e);return r.subscribe.bind(r)}class M3{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");B3(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=xm),s.error===void 0&&(s.error=xm),s.complete===void 0&&(s.complete=xm);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function B3(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function xm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(t){return t&&t._delegate?t._delegate:t}class ol{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new _3;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(U3(e))try{this.getOrInitializeService({instanceIdentifier:Go})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Go){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Go){return this.instances.has(e)}getOptions(e=Go){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);n===c&&o.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:j3(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Go){return this.component?this.component.multipleInstances?e:Go:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function j3(t){return t===Go?void 0:t}function U3(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new V3(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(kt||(kt={}));const W3={debug:kt.DEBUG,verbose:kt.VERBOSE,info:kt.INFO,warn:kt.WARN,error:kt.ERROR,silent:kt.SILENT},H3=kt.INFO,$3={[kt.DEBUG]:"log",[kt.VERBOSE]:"log",[kt.INFO]:"info",[kt.WARN]:"warn",[kt.ERROR]:"error"},G3=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=$3[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Mg{constructor(e){this.name=e,this._logLevel=H3,this._logHandler=G3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in kt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?W3[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,kt.DEBUG,...e),this._logHandler(this,kt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,kt.VERBOSE,...e),this._logHandler(this,kt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,kt.INFO,...e),this._logHandler(this,kt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,kt.WARN,...e),this._logHandler(this,kt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,kt.ERROR,...e),this._logHandler(this,kt.ERROR,...e)}}const K3=(t,e)=>e.some(r=>t instanceof r);let K_,q_;function q3(){return K_||(K_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function X3(){return q_||(q_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Qw=new WeakMap,Km=new WeakMap,Jw=new WeakMap,vm=new WeakMap,Bg=new WeakMap;function Y3(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(so(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&Qw.set(r,t)}).catch(()=>{}),Bg.set(e,t),e}function Q3(t){if(Km.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Km.set(t,e)}let qm={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Km.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Jw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return so(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function J3(t){qm=t(qm)}function Z3(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(_m(this),e,...r);return Jw.set(n,e.sort?e.sort():[e]),so(n)}:X3().includes(t)?function(...e){return t.apply(_m(this),e),so(Qw.get(this))}:function(...e){return so(t.apply(_m(this),e))}}function eC(t){return typeof t=="function"?Z3(t):(t instanceof IDBTransaction&&Q3(t),K3(t,q3())?new Proxy(t,qm):t)}function so(t){if(t instanceof IDBRequest)return Y3(t);if(vm.has(t))return vm.get(t);const e=eC(t);return e!==t&&(vm.set(t,e),Bg.set(e,t)),e}const _m=t=>Bg.get(t);function tC(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=so(o);return n&&o.addEventListener("upgradeneeded",u=>{n(so(o.result),u.oldVersion,u.newVersion,so(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const rC=["get","getKey","getAll","getAllKeys","count"],nC=["put","add","delete","clear"],ym=new Map;function X_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ym.get(e))return ym.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=nC.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||rC.includes(r)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),s&&u.done]))[0]};return ym.set(e,i),i}J3(t=>({...t,get:(e,r,n)=>X_(e,r)||t.get(e,r,n),has:(e,r)=>!!X_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(iC(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function iC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Xm="@firebase/app",Y_="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a=new Mg("@firebase/app"),aC="@firebase/app-compat",oC="@firebase/analytics-compat",lC="@firebase/analytics",cC="@firebase/app-check-compat",uC="@firebase/app-check",fC="@firebase/auth",hC="@firebase/auth-compat",dC="@firebase/database",pC="@firebase/data-connect",mC="@firebase/database-compat",gC="@firebase/functions",xC="@firebase/functions-compat",vC="@firebase/installations",_C="@firebase/installations-compat",yC="@firebase/messaging",wC="@firebase/messaging-compat",EC="@firebase/performance",TC="@firebase/performance-compat",SC="@firebase/remote-config",kC="@firebase/remote-config-compat",AC="@firebase/storage",CC="@firebase/storage-compat",IC="@firebase/firestore",FC="@firebase/ai",bC="@firebase/firestore-compat",NC="firebase",RC="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ym="[DEFAULT]",DC={[Xm]:"fire-core",[aC]:"fire-core-compat",[lC]:"fire-analytics",[oC]:"fire-analytics-compat",[uC]:"fire-app-check",[cC]:"fire-app-check-compat",[fC]:"fire-auth",[hC]:"fire-auth-compat",[dC]:"fire-rtdb",[pC]:"fire-data-connect",[mC]:"fire-rtdb-compat",[gC]:"fire-fn",[xC]:"fire-fn-compat",[vC]:"fire-iid",[_C]:"fire-iid-compat",[yC]:"fire-fcm",[wC]:"fire-fcm-compat",[EC]:"fire-perf",[TC]:"fire-perf-compat",[SC]:"fire-rc",[kC]:"fire-rc-compat",[AC]:"fire-gcs",[CC]:"fire-gcs-compat",[IC]:"fire-fst",[bC]:"fire-fst-compat",[FC]:"fire-vertex","fire-js":"fire-js",[NC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D0=new Map,PC=new Map,Qm=new Map;function Q_(t,e){try{t.container.addComponent(e)}catch(r){_a.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Sc(t){const e=t.name;if(Qm.has(e))return _a.debug(`There were multiple attempts to register component ${e}.`),!1;Qm.set(e,t);for(const r of D0.values())Q_(r,t);for(const r of PC.values())Q_(r,t);return!0}function Vg(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ni(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},io=new Ff("app","Firebase",OC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ol("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw io.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc=RC;function Zw(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Ym,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw io.create("bad-app-name",{appName:String(s)});if(r||(r=Kw()),!r)throw io.create("no-options");const i=D0.get(s);if(i){if(al(r,i.options)&&al(n,i.config))return i;throw io.create("duplicate-app",{appName:s})}const o=new z3(s);for(const u of Qm.values())o.addComponent(u);const c=new LC(r,n,o);return D0.set(s,c),c}function eE(t=Ym){const e=D0.get(t);if(!e&&t===Ym&&Kw())return Zw();if(!e)throw io.create("no-app",{appName:t});return e}function ao(t,e,r){let n=DC[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${n}" with version "${e}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_a.warn(o.join(" "));return}Sc(new ol(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC="firebase-heartbeat-database",BC=1,sf="firebase-heartbeat-store";let wm=null;function tE(){return wm||(wm=tC(MC,BC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(sf)}catch(r){console.warn(r)}}}}).catch(t=>{throw io.create("idb-open",{originalErrorMessage:t.message})})),wm}async function VC(t){try{const r=(await tE()).transaction(sf),n=await r.objectStore(sf).get(rE(t));return await r.done,n}catch(e){if(e instanceof Sa)_a.warn(e.message);else{const r=io.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});_a.warn(r.message)}}}async function J_(t,e){try{const n=(await tE()).transaction(sf,"readwrite");await n.objectStore(sf).put(e,rE(t)),await n.done}catch(r){if(r instanceof Sa)_a.warn(r.message);else{const n=io.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});_a.warn(n.message)}}}function rE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC=1024,UC=30;class zC{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new HC(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Z_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>UC){const o=$C(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){_a.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Z_(),{heartbeatsToSend:n,unsentEntries:s}=WC(this._heartbeatsCache.heartbeats),i=R0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return _a.warn(r),""}}}function Z_(){return new Date().toISOString().substring(0,10)}function WC(t,e=jC){const r=[];let n=t.slice();for(const s of t){const i=r.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),e2(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),e2(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class HC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return b3()?N3().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await VC(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return J_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return J_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function e2(t){return R0(JSON.stringify({version:2,heartbeats:t})).length}function $C(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(t){Sc(new ol("platform-logger",e=>new sC(e),"PRIVATE")),Sc(new ol("heartbeat",e=>new zC(e),"PRIVATE")),ao(Xm,Y_,t),ao(Xm,Y_,"esm2020"),ao("fire-js","")}GC("");var KC="firebase",qC="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ao(KC,qC,"app");var t2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var oo,nE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,C){function F(){}F.prototype=C.prototype,A.F=C.prototype,A.prototype=new F,A.prototype.constructor=A,A.D=function(V,M,D){for(var L=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)L[ke-2]=arguments[ke];return C.prototype[M].apply(V,L)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(A,C,F){F||(F=0);const V=Array(16);if(typeof C=="string")for(var M=0;M<16;++M)V[M]=C.charCodeAt(F++)|C.charCodeAt(F++)<<8|C.charCodeAt(F++)<<16|C.charCodeAt(F++)<<24;else for(M=0;M<16;++M)V[M]=C[F++]|C[F++]<<8|C[F++]<<16|C[F++]<<24;C=A.g[0],F=A.g[1],M=A.g[2];let D=A.g[3],L;L=C+(D^F&(M^D))+V[0]+3614090360&4294967295,C=F+(L<<7&4294967295|L>>>25),L=D+(M^C&(F^M))+V[1]+3905402710&4294967295,D=C+(L<<12&4294967295|L>>>20),L=M+(F^D&(C^F))+V[2]+606105819&4294967295,M=D+(L<<17&4294967295|L>>>15),L=F+(C^M&(D^C))+V[3]+3250441966&4294967295,F=M+(L<<22&4294967295|L>>>10),L=C+(D^F&(M^D))+V[4]+4118548399&4294967295,C=F+(L<<7&4294967295|L>>>25),L=D+(M^C&(F^M))+V[5]+1200080426&4294967295,D=C+(L<<12&4294967295|L>>>20),L=M+(F^D&(C^F))+V[6]+2821735955&4294967295,M=D+(L<<17&4294967295|L>>>15),L=F+(C^M&(D^C))+V[7]+4249261313&4294967295,F=M+(L<<22&4294967295|L>>>10),L=C+(D^F&(M^D))+V[8]+1770035416&4294967295,C=F+(L<<7&4294967295|L>>>25),L=D+(M^C&(F^M))+V[9]+2336552879&4294967295,D=C+(L<<12&4294967295|L>>>20),L=M+(F^D&(C^F))+V[10]+4294925233&4294967295,M=D+(L<<17&4294967295|L>>>15),L=F+(C^M&(D^C))+V[11]+2304563134&4294967295,F=M+(L<<22&4294967295|L>>>10),L=C+(D^F&(M^D))+V[12]+1804603682&4294967295,C=F+(L<<7&4294967295|L>>>25),L=D+(M^C&(F^M))+V[13]+4254626195&4294967295,D=C+(L<<12&4294967295|L>>>20),L=M+(F^D&(C^F))+V[14]+2792965006&4294967295,M=D+(L<<17&4294967295|L>>>15),L=F+(C^M&(D^C))+V[15]+1236535329&4294967295,F=M+(L<<22&4294967295|L>>>10),L=C+(M^D&(F^M))+V[1]+4129170786&4294967295,C=F+(L<<5&4294967295|L>>>27),L=D+(F^M&(C^F))+V[6]+3225465664&4294967295,D=C+(L<<9&4294967295|L>>>23),L=M+(C^F&(D^C))+V[11]+643717713&4294967295,M=D+(L<<14&4294967295|L>>>18),L=F+(D^C&(M^D))+V[0]+3921069994&4294967295,F=M+(L<<20&4294967295|L>>>12),L=C+(M^D&(F^M))+V[5]+3593408605&4294967295,C=F+(L<<5&4294967295|L>>>27),L=D+(F^M&(C^F))+V[10]+38016083&4294967295,D=C+(L<<9&4294967295|L>>>23),L=M+(C^F&(D^C))+V[15]+3634488961&4294967295,M=D+(L<<14&4294967295|L>>>18),L=F+(D^C&(M^D))+V[4]+3889429448&4294967295,F=M+(L<<20&4294967295|L>>>12),L=C+(M^D&(F^M))+V[9]+568446438&4294967295,C=F+(L<<5&4294967295|L>>>27),L=D+(F^M&(C^F))+V[14]+3275163606&4294967295,D=C+(L<<9&4294967295|L>>>23),L=M+(C^F&(D^C))+V[3]+4107603335&4294967295,M=D+(L<<14&4294967295|L>>>18),L=F+(D^C&(M^D))+V[8]+1163531501&4294967295,F=M+(L<<20&4294967295|L>>>12),L=C+(M^D&(F^M))+V[13]+2850285829&4294967295,C=F+(L<<5&4294967295|L>>>27),L=D+(F^M&(C^F))+V[2]+4243563512&4294967295,D=C+(L<<9&4294967295|L>>>23),L=M+(C^F&(D^C))+V[7]+1735328473&4294967295,M=D+(L<<14&4294967295|L>>>18),L=F+(D^C&(M^D))+V[12]+2368359562&4294967295,F=M+(L<<20&4294967295|L>>>12),L=C+(F^M^D)+V[5]+4294588738&4294967295,C=F+(L<<4&4294967295|L>>>28),L=D+(C^F^M)+V[8]+2272392833&4294967295,D=C+(L<<11&4294967295|L>>>21),L=M+(D^C^F)+V[11]+1839030562&4294967295,M=D+(L<<16&4294967295|L>>>16),L=F+(M^D^C)+V[14]+4259657740&4294967295,F=M+(L<<23&4294967295|L>>>9),L=C+(F^M^D)+V[1]+2763975236&4294967295,C=F+(L<<4&4294967295|L>>>28),L=D+(C^F^M)+V[4]+1272893353&4294967295,D=C+(L<<11&4294967295|L>>>21),L=M+(D^C^F)+V[7]+4139469664&4294967295,M=D+(L<<16&4294967295|L>>>16),L=F+(M^D^C)+V[10]+3200236656&4294967295,F=M+(L<<23&4294967295|L>>>9),L=C+(F^M^D)+V[13]+681279174&4294967295,C=F+(L<<4&4294967295|L>>>28),L=D+(C^F^M)+V[0]+3936430074&4294967295,D=C+(L<<11&4294967295|L>>>21),L=M+(D^C^F)+V[3]+3572445317&4294967295,M=D+(L<<16&4294967295|L>>>16),L=F+(M^D^C)+V[6]+76029189&4294967295,F=M+(L<<23&4294967295|L>>>9),L=C+(F^M^D)+V[9]+3654602809&4294967295,C=F+(L<<4&4294967295|L>>>28),L=D+(C^F^M)+V[12]+3873151461&4294967295,D=C+(L<<11&4294967295|L>>>21),L=M+(D^C^F)+V[15]+530742520&4294967295,M=D+(L<<16&4294967295|L>>>16),L=F+(M^D^C)+V[2]+3299628645&4294967295,F=M+(L<<23&4294967295|L>>>9),L=C+(M^(F|~D))+V[0]+4096336452&4294967295,C=F+(L<<6&4294967295|L>>>26),L=D+(F^(C|~M))+V[7]+1126891415&4294967295,D=C+(L<<10&4294967295|L>>>22),L=M+(C^(D|~F))+V[14]+2878612391&4294967295,M=D+(L<<15&4294967295|L>>>17),L=F+(D^(M|~C))+V[5]+4237533241&4294967295,F=M+(L<<21&4294967295|L>>>11),L=C+(M^(F|~D))+V[12]+1700485571&4294967295,C=F+(L<<6&4294967295|L>>>26),L=D+(F^(C|~M))+V[3]+2399980690&4294967295,D=C+(L<<10&4294967295|L>>>22),L=M+(C^(D|~F))+V[10]+4293915773&4294967295,M=D+(L<<15&4294967295|L>>>17),L=F+(D^(M|~C))+V[1]+2240044497&4294967295,F=M+(L<<21&4294967295|L>>>11),L=C+(M^(F|~D))+V[8]+1873313359&4294967295,C=F+(L<<6&4294967295|L>>>26),L=D+(F^(C|~M))+V[15]+4264355552&4294967295,D=C+(L<<10&4294967295|L>>>22),L=M+(C^(D|~F))+V[6]+2734768916&4294967295,M=D+(L<<15&4294967295|L>>>17),L=F+(D^(M|~C))+V[13]+1309151649&4294967295,F=M+(L<<21&4294967295|L>>>11),L=C+(M^(F|~D))+V[4]+4149444226&4294967295,C=F+(L<<6&4294967295|L>>>26),L=D+(F^(C|~M))+V[11]+3174756917&4294967295,D=C+(L<<10&4294967295|L>>>22),L=M+(C^(D|~F))+V[2]+718787259&4294967295,M=D+(L<<15&4294967295|L>>>17),L=F+(D^(M|~C))+V[9]+3951481745&4294967295,A.g[0]=A.g[0]+C&4294967295,A.g[1]=A.g[1]+(M+(L<<21&4294967295|L>>>11))&4294967295,A.g[2]=A.g[2]+M&4294967295,A.g[3]=A.g[3]+D&4294967295}n.prototype.v=function(A,C){C===void 0&&(C=A.length);const F=C-this.blockSize,V=this.C;let M=this.h,D=0;for(;D<C;){if(M==0)for(;D<=F;)s(this,A,D),D+=this.blockSize;if(typeof A=="string"){for(;D<C;)if(V[M++]=A.charCodeAt(D++),M==this.blockSize){s(this,V),M=0;break}}else for(;D<C;)if(V[M++]=A[D++],M==this.blockSize){s(this,V),M=0;break}}this.h=M,this.o+=C},n.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var C=1;C<A.length-8;++C)A[C]=0;C=this.o*8;for(var F=A.length-8;F<A.length;++F)A[F]=C&255,C/=256;for(this.v(A),A=Array(16),C=0,F=0;F<4;++F)for(let V=0;V<32;V+=8)A[C++]=this.g[F]>>>V&255;return A};function i(A,C){var F=c;return Object.prototype.hasOwnProperty.call(F,A)?F[A]:F[A]=C(A)}function o(A,C){this.h=C;const F=[];let V=!0;for(let M=A.length-1;M>=0;M--){const D=A[M]|0;V&&D==C||(F[M]=D,V=!1)}this.g=F}var c={};function u(A){return-128<=A&&A<128?i(A,function(C){return new o([C|0],C<0?-1:0)}):new o([A|0],A<0?-1:0)}function h(A){if(isNaN(A)||!isFinite(A))return g;if(A<0)return S(h(-A));const C=[];let F=1;for(let V=0;A>=F;V++)C[V]=A/F|0,F*=4294967296;return new o(C,0)}function d(A,C){if(A.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(A.charAt(0)=="-")return S(d(A.substring(1),C));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const F=h(Math.pow(C,8));let V=g;for(let D=0;D<A.length;D+=8){var M=Math.min(8,A.length-D);const L=parseInt(A.substring(D,D+M),C);M<8?(M=h(Math.pow(C,M)),V=V.j(M).add(h(L))):(V=V.j(F),V=V.add(h(L)))}return V}var g=u(0),x=u(1),y=u(16777216);t=o.prototype,t.m=function(){if(w(this))return-S(this).m();let A=0,C=1;for(let F=0;F<this.g.length;F++){const V=this.i(F);A+=(V>=0?V:4294967296+V)*C,C*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(k(this))return"0";if(w(this))return"-"+S(this).toString(A);const C=h(Math.pow(A,6));var F=this;let V="";for(;;){const M=j(F,C).g;F=N(F,M.j(C));let D=((F.g.length>0?F.g[0]:F.h)>>>0).toString(A);if(F=M,k(F))return D+V;for(;D.length<6;)D="0"+D;V=D+V}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function k(A){if(A.h!=0)return!1;for(let C=0;C<A.g.length;C++)if(A.g[C]!=0)return!1;return!0}function w(A){return A.h==-1}t.l=function(A){return A=N(this,A),w(A)?-1:k(A)?0:1};function S(A){const C=A.g.length,F=[];for(let V=0;V<C;V++)F[V]=~A.g[V];return new o(F,~A.h).add(x)}t.abs=function(){return w(this)?S(this):this},t.add=function(A){const C=Math.max(this.g.length,A.g.length),F=[];let V=0;for(let M=0;M<=C;M++){let D=V+(this.i(M)&65535)+(A.i(M)&65535),L=(D>>>16)+(this.i(M)>>>16)+(A.i(M)>>>16);V=L>>>16,D&=65535,L&=65535,F[M]=L<<16|D}return new o(F,F[F.length-1]&-2147483648?-1:0)};function N(A,C){return A.add(S(C))}t.j=function(A){if(k(this)||k(A))return g;if(w(this))return w(A)?S(this).j(S(A)):S(S(this).j(A));if(w(A))return S(this.j(S(A)));if(this.l(y)<0&&A.l(y)<0)return h(this.m()*A.m());const C=this.g.length+A.g.length,F=[];for(var V=0;V<2*C;V++)F[V]=0;for(V=0;V<this.g.length;V++)for(let M=0;M<A.g.length;M++){const D=this.i(V)>>>16,L=this.i(V)&65535,ke=A.i(M)>>>16,Se=A.i(M)&65535;F[2*V+2*M]+=L*Se,B(F,2*V+2*M),F[2*V+2*M+1]+=D*Se,B(F,2*V+2*M+1),F[2*V+2*M+1]+=L*ke,B(F,2*V+2*M+1),F[2*V+2*M+2]+=D*ke,B(F,2*V+2*M+2)}for(A=0;A<C;A++)F[A]=F[2*A+1]<<16|F[2*A];for(A=C;A<2*C;A++)F[A]=0;return new o(F,0)};function B(A,C){for(;(A[C]&65535)!=A[C];)A[C+1]+=A[C]>>>16,A[C]&=65535,C++}function b(A,C){this.g=A,this.h=C}function j(A,C){if(k(C))throw Error("division by zero");if(k(A))return new b(g,g);if(w(A))return C=j(S(A),C),new b(S(C.g),S(C.h));if(w(C))return C=j(A,S(C)),new b(S(C.g),C.h);if(A.g.length>30){if(w(A)||w(C))throw Error("slowDivide_ only works with positive integers.");for(var F=x,V=C;V.l(A)<=0;)F=X(F),V=X(V);var M=G(F,1),D=G(V,1);for(V=G(V,2),F=G(F,2);!k(V);){var L=D.add(V);L.l(A)<=0&&(M=M.add(F),D=L),V=G(V,1),F=G(F,1)}return C=N(A,M.j(C)),new b(M,C)}for(M=g;A.l(C)>=0;){for(F=Math.max(1,Math.floor(A.m()/C.m())),V=Math.ceil(Math.log(F)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),D=h(F),L=D.j(C);w(L)||L.l(A)>0;)F-=V,D=h(F),L=D.j(C);k(D)&&(D=x),M=M.add(D),A=N(A,L)}return new b(M,A)}t.B=function(A){return j(this,A).h},t.and=function(A){const C=Math.max(this.g.length,A.g.length),F=[];for(let V=0;V<C;V++)F[V]=this.i(V)&A.i(V);return new o(F,this.h&A.h)},t.or=function(A){const C=Math.max(this.g.length,A.g.length),F=[];for(let V=0;V<C;V++)F[V]=this.i(V)|A.i(V);return new o(F,this.h|A.h)},t.xor=function(A){const C=Math.max(this.g.length,A.g.length),F=[];for(let V=0;V<C;V++)F[V]=this.i(V)^A.i(V);return new o(F,this.h^A.h)};function X(A){const C=A.g.length+1,F=[];for(let V=0;V<C;V++)F[V]=A.i(V)<<1|A.i(V-1)>>>31;return new o(F,A.h)}function G(A,C){const F=C>>5;C%=32;const V=A.g.length-F,M=[];for(let D=0;D<V;D++)M[D]=C>0?A.i(D+F)>>>C|A.i(D+F+1)<<32-C:A.i(D+F);return new o(M,A.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,nE=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,oo=o}).apply(typeof t2<"u"?t2:typeof self<"u"?self:typeof window<"u"?window:{});var r0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sE,Ru,iE,_0,Jm,aE,oE,lE;(function(){var t,e=Object.defineProperty;function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof r0=="object"&&r0];for(var T=0;T<p.length;++T){var I=p[T];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var n=r(this);function s(p,T){if(T)e:{var I=n;p=p.split(".");for(var U=0;U<p.length-1;U++){var ae=p[U];if(!(ae in I))break e;I=I[ae]}p=p[p.length-1],U=I[p],T=T(U),T!=U&&T!=null&&e(I,p,{configurable:!0,writable:!0,value:T})}}s("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(p){return p||function(T){var I=[],U;for(U in T)Object.prototype.hasOwnProperty.call(T,U)&&I.push([U,T[U]]);return I}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function c(p){var T=typeof p;return T=="object"&&p!=null||T=="function"}function u(p,T,I){return p.call.apply(p.bind,arguments)}function h(p,T,I){return h=u,h.apply(null,arguments)}function d(p,T){var I=Array.prototype.slice.call(arguments,1);return function(){var U=I.slice();return U.push.apply(U,arguments),p.apply(this,U)}}function g(p,T){function I(){}I.prototype=T.prototype,p.Z=T.prototype,p.prototype=new I,p.prototype.constructor=p,p.Ob=function(U,ae,pe){for(var ze=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)ze[pt-2]=arguments[pt];return T.prototype[ae].apply(U,ze)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function y(p){const T=p.length;if(T>0){const I=Array(T);for(let U=0;U<T;U++)I[U]=p[U];return I}return[]}function k(p,T){for(let U=1;U<arguments.length;U++){const ae=arguments[U];var I=typeof ae;if(I=I!="object"?I:ae?Array.isArray(ae)?"array":I:"null",I=="array"||I=="object"&&typeof ae.length=="number"){I=p.length||0;const pe=ae.length||0;p.length=I+pe;for(let ze=0;ze<pe;ze++)p[I+ze]=ae[ze]}else p.push(ae)}}class w{constructor(T,I){this.i=T,this.j=I,this.h=0,this.g=null}get(){let T;return this.h>0?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function S(p){o.setTimeout(()=>{throw p},0)}function N(){var p=A;let T=null;return p.g&&(T=p.g,p.g=p.g.next,p.g||(p.h=null),T.next=null),T}class B{constructor(){this.h=this.g=null}add(T,I){const U=b.get();U.set(T,I),this.h?this.h.next=U:this.g=U,this.h=U}}var b=new w(()=>new j,p=>p.reset());class j{constructor(){this.next=this.g=this.h=null}set(T,I){this.h=T,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let X,G=!1,A=new B,C=()=>{const p=Promise.resolve(void 0);X=()=>{p.then(F)}};function F(){for(var p;p=N();){try{p.h.call(p.g)}catch(I){S(I)}var T=b;T.j(p),T.h<100&&(T.h++,p.next=T.g,T.g=p)}G=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(p,T){this.type=p,this.g=this.target=T,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var D=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,T=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const I=()=>{};o.addEventListener("test",I,T),o.removeEventListener("test",I,T)}catch{}return p})();function L(p){return/^[\s\xa0]*$/.test(p)}function ke(p,T){M.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,T)}g(ke,M),ke.prototype.init=function(p,T){const I=this.type=p.type,U=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=T,T=p.relatedTarget,T||(I=="mouseover"?T=p.fromElement:I=="mouseout"&&(T=p.toElement)),this.relatedTarget=T,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&ke.Z.h.call(this)},ke.prototype.h=function(){ke.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Se="closure_listenable_"+(Math.random()*1e6|0),De=0;function Ne(p,T,I,U,ae){this.listener=p,this.proxy=null,this.src=T,this.type=I,this.capture=!!U,this.ha=ae,this.key=++De,this.da=this.fa=!1}function Ce(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ne(p,T,I){for(const U in p)T.call(I,p[U],U,p)}function ye(p,T){for(const I in p)T.call(void 0,p[I],I,p)}function ee(p){const T={};for(const I in p)T[I]=p[I];return T}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function te(p,T){let I,U;for(let ae=1;ae<arguments.length;ae++){U=arguments[ae];for(I in U)p[I]=U[I];for(let pe=0;pe<O.length;pe++)I=O[pe],Object.prototype.hasOwnProperty.call(U,I)&&(p[I]=U[I])}}function J(p){this.src=p,this.g={},this.h=0}J.prototype.add=function(p,T,I,U,ae){const pe=p.toString();p=this.g[pe],p||(p=this.g[pe]=[],this.h++);const ze=oe(p,T,U,ae);return ze>-1?(T=p[ze],I||(T.fa=!1)):(T=new Ne(T,this.src,pe,!!U,ae),T.fa=I,p.push(T)),T};function Z(p,T){const I=T.type;if(I in p.g){var U=p.g[I],ae=Array.prototype.indexOf.call(U,T,void 0),pe;(pe=ae>=0)&&Array.prototype.splice.call(U,ae,1),pe&&(Ce(T),p.g[I].length==0&&(delete p.g[I],p.h--))}}function oe(p,T,I,U){for(let ae=0;ae<p.length;++ae){const pe=p[ae];if(!pe.da&&pe.listener==T&&pe.capture==!!I&&pe.ha==U)return ae}return-1}var _e="closure_lm_"+(Math.random()*1e6|0),ve={};function xe(p,T,I,U,ae){if(Array.isArray(T)){for(let pe=0;pe<T.length;pe++)xe(p,T[pe],I,U,ae);return null}return I=Ht(I),p&&p[Se]?p.J(T,I,c(U)?!!U.capture:!1,ae):Ee(p,T,I,!1,U,ae)}function Ee(p,T,I,U,ae,pe){if(!T)throw Error("Invalid event type");const ze=c(ae)?!!ae.capture:!!ae;let pt=ht(p);if(pt||(p[_e]=pt=new J(p)),I=pt.add(T,I,U,ze,pe),I.proxy)return I;if(U=st(),I.proxy=U,U.src=p,U.listener=I,p.addEventListener)D||(ae=ze),ae===void 0&&(ae=!1),p.addEventListener(T.toString(),U,ae);else if(p.attachEvent)p.attachEvent(gt(T.toString()),U);else if(p.addListener&&p.removeListener)p.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return I}function st(){function p(I){return T.call(p.src,p.listener,I)}const T=It;return p}function Y(p,T,I,U,ae){if(Array.isArray(T))for(var pe=0;pe<T.length;pe++)Y(p,T[pe],I,U,ae);else U=c(U)?!!U.capture:!!U,I=Ht(I),p&&p[Se]?(p=p.i,pe=String(T).toString(),pe in p.g&&(T=p.g[pe],I=oe(T,I,U,ae),I>-1&&(Ce(T[I]),Array.prototype.splice.call(T,I,1),T.length==0&&(delete p.g[pe],p.h--)))):p&&(p=ht(p))&&(T=p.g[T.toString()],p=-1,T&&(p=oe(T,I,U,ae)),(I=p>-1?T[p]:null)&&Et(I))}function Et(p){if(typeof p!="number"&&p&&!p.da){var T=p.src;if(T&&T[Se])Z(T.i,p);else{var I=p.type,U=p.proxy;T.removeEventListener?T.removeEventListener(I,U,p.capture):T.detachEvent?T.detachEvent(gt(I),U):T.addListener&&T.removeListener&&T.removeListener(U),(I=ht(T))?(Z(I,p),I.h==0&&(I.src=null,T[_e]=null)):Ce(p)}}}function gt(p){return p in ve?ve[p]:ve[p]="on"+p}function It(p,T){if(p.da)p=!0;else{T=new ke(T,this);const I=p.listener,U=p.ha||p.src;p.fa&&Et(p),p=I.call(U,T)}return p}function ht(p){return p=p[_e],p instanceof J?p:null}var je="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ht(p){return typeof p=="function"?p:(p[je]||(p[je]=function(T){return p.handleEvent(T)}),p[je])}function St(){V.call(this),this.i=new J(this),this.M=this,this.G=null}g(St,V),St.prototype[Se]=!0,St.prototype.removeEventListener=function(p,T,I,U){Y(this,p,T,I,U)};function Tt(p,T){var I,U=p.G;if(U)for(I=[];U;U=U.G)I.push(U);if(p=p.M,U=T.type||T,typeof T=="string")T=new M(T,p);else if(T instanceof M)T.target=T.target||p;else{var ae=T;T=new M(U,p),te(T,ae)}ae=!0;let pe,ze;if(I)for(ze=I.length-1;ze>=0;ze--)pe=T.g=I[ze],ae=fr(pe,U,!0,T)&&ae;if(pe=T.g=p,ae=fr(pe,U,!0,T)&&ae,ae=fr(pe,U,!1,T)&&ae,I)for(ze=0;ze<I.length;ze++)pe=T.g=I[ze],ae=fr(pe,U,!1,T)&&ae}St.prototype.N=function(){if(St.Z.N.call(this),this.i){var p=this.i;for(const T in p.g){const I=p.g[T];for(let U=0;U<I.length;U++)Ce(I[U]);delete p.g[T],p.h--}}this.G=null},St.prototype.J=function(p,T,I,U){return this.i.add(String(p),T,!1,I,U)},St.prototype.K=function(p,T,I,U){return this.i.add(String(p),T,!0,I,U)};function fr(p,T,I,U){if(T=p.i.g[String(T)],!T)return!0;T=T.concat();let ae=!0;for(let pe=0;pe<T.length;++pe){const ze=T[pe];if(ze&&!ze.da&&ze.capture==I){const pt=ze.listener,Cr=ze.ha||ze.src;ze.fa&&Z(p.i,ze),ae=pt.call(Cr,U)!==!1&&ae}}return ae&&!U.defaultPrevented}function Xn(p,T){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(T)>2147483647?-1:o.setTimeout(p,T||0)}function ln(p){p.g=Xn(()=>{p.g=null,p.i&&(p.i=!1,ln(p))},p.l);const T=p.h;p.h=null,p.m.apply(null,T)}class $r extends V{constructor(T,I){super(),this.m=T,this.l=I,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:ln(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dr(p){V.call(this),this.h=p,this.g={}}g(Dr,V);var yn=[];function Un(p){ne(p.g,function(T,I){this.g.hasOwnProperty(I)&&Et(T)},p),p.g={}}Dr.prototype.N=function(){Dr.Z.N.call(this),Un(this)},Dr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var $t=o.JSON.stringify,Jr=o.JSON.parse,ot=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function Rt(){}function Gr(){}var jt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function wn(){M.call(this,"d")}g(wn,M);function hi(){M.call(this,"c")}g(hi,M);var En={},di=null;function us(){return di=di||new St}En.Ia="serverreachability";function Ks(p){M.call(this,En.Ia,p)}g(Ks,M);function Yn(p){const T=us();Tt(T,new Ks(T))}En.STAT_EVENT="statevent";function Qn(p,T){M.call(this,En.STAT_EVENT,p),this.stat=T}g(Qn,M);function Zt(p){const T=us();Tt(T,new Qn(T,p))}En.Ja="timingevent";function As(p,T){M.call(this,En.Ja,p),this.size=T}g(As,M);function Cs(p,T){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},T)}function Is(){this.g=!0}Is.prototype.ua=function(){this.g=!1};function Ia(p,T,I,U,ae,pe){p.info(function(){if(p.g)if(pe){var ze="",pt=pe.split("&");for(let Kt=0;Kt<pt.length;Kt++){var Cr=pt[Kt].split("=");if(Cr.length>1){const Or=Cr[0];Cr=Cr[1];const ms=Or.split("_");ze=ms.length>=2&&ms[1]=="type"?ze+(Or+"="+Cr+"&"):ze+(Or+"=redacted&")}}}else ze=null;else ze=pe;return"XMLHTTP REQ ("+U+") [attempt "+ae+"]: "+T+`
`+I+`
`+ze})}function Qe(p,T,I,U,ae,pe,ze){p.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+ae+"]: "+T+`
`+I+`
`+pe+" "+ze})}function Je(p,T,I,U){p.info(function(){return"XMLHTTP TEXT ("+T+"): "+rr(p,I)+(U?" "+U:"")})}function Ut(p,T){p.info(function(){return"TIMEOUT: "+T})}Is.prototype.info=function(){};function rr(p,T){if(!p.g)return T;if(!T)return null;try{const pe=JSON.parse(T);if(pe){for(p=0;p<pe.length;p++)if(Array.isArray(pe[p])){var I=pe[p];if(!(I.length<2)){var U=I[1];if(Array.isArray(U)&&!(U.length<1)){var ae=U[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(let ze=1;ze<U.length;ze++)U[ze]=""}}}}return $t(pe)}catch{return T}}var hr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Zr={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Gi;function cn(){}g(cn,Rt),cn.prototype.g=function(){return new XMLHttpRequest},Gi=new cn;function Pr(p){return encodeURIComponent(String(p))}function P(p){var T=1;p=p.split(":");const I=[];for(;T>0&&p.length;)I.push(p.shift()),T--;return p.length&&I.push(p.join(":")),I}function H(p,T,I,U){this.j=p,this.i=T,this.l=I,this.S=U||1,this.V=new Dr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new z}function z(){this.i=null,this.g="",this.h=!1}var W={},K={};function q(p,T,I){p.M=1,p.A=Ki(bs(T)),p.u=I,p.R=!0,ce(p,null)}function ce(p,T){p.F=Date.now(),he(p),p.B=bs(p.A);var I=p.B,U=p.S;Array.isArray(U)||(U=[String(U)]),eu(I.i,"t",U),p.C=0,I=p.j.L,p.h=new z,p.g=sh(p.j,I?T:null,!p.u),p.P>0&&(p.O=new $r(h(p.Y,p,p.g),p.P)),T=p.V,I=p.g,U=p.ba;var ae="readystatechange";Array.isArray(ae)||(ae&&(yn[0]=ae.toString()),ae=yn);for(let pe=0;pe<ae.length;pe++){const ze=xe(I,ae[pe],U||T.handleEvent,!1,T.h||T);if(!ze)break;T.g[ze.key]=ze}T=p.J?ee(p.J):{},p.u?(p.v||(p.v="POST"),T["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,T)):(p.v="GET",p.g.ea(p.B,p.v,null,T)),Yn(),Ia(p.i,p.v,p.B,p.l,p.S,p.u)}H.prototype.ba=function(p){p=p.target;const T=this.O;T&&yi(p)==3?T.j():this.Y(p)},H.prototype.Y=function(p){try{if(p==this.g)e:{const pt=yi(this.g),Cr=this.g.ya(),Kt=this.g.ca();if(!(pt<3)&&(pt!=3||this.g&&(this.h.h||this.g.la()||rh(this.g)))){this.K||pt!=4||Cr==7||(Cr==8||Kt<=0?Yn(3):Yn(2)),Be(this);var T=this.g.ca();this.X=T;var I=ge(this);if(this.o=T==200,Qe(this.i,this.v,this.B,this.l,this.S,pt,T),this.o){if(this.U&&!this.L){t:{if(this.g){var U,ae=this.g;if((U=ae.g?ae.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(U)){var pe=U;break t}}pe=null}if(p=pe)Je(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Oe(this,p);else{this.o=!1,this.m=3,Zt(12),Pe(this),We(this);break e}}if(this.R){p=!0;let Or;for(;!this.K&&this.C<I.length;)if(Or=fe(this,I),Or==K){pt==4&&(this.m=4,Zt(14),p=!1),Je(this.i,this.l,null,"[Incomplete Response]");break}else if(Or==W){this.m=4,Zt(15),Je(this.i,this.l,I,"[Invalid Chunk]"),p=!1;break}else Je(this.i,this.l,Or,null),Oe(this,Or);if(le(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pt!=4||I.length!=0||this.h.h||(this.m=1,Zt(16),p=!1),this.o=this.o&&p,!p)Je(this.i,this.l,I,"[Invalid Chunked Response]"),Pe(this),We(this);else if(I.length>0&&!this.W){this.W=!0;var ze=this.j;ze.g==this&&ze.aa&&!ze.P&&(ze.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),Ro(ze),ze.P=!0,Zt(11))}}else Je(this.i,this.l,I,null),Oe(this,I);pt==4&&Pe(this),this.o&&!this.K&&(pt==4?Dl(this.j,this):(this.o=!1,he(this)))}else ru(this.g),T==400&&I.indexOf("Unknown SID")>0?(this.m=3,Zt(12)):(this.m=0,Zt(13)),Pe(this),We(this)}}}catch{}finally{}};function ge(p){if(!le(p))return p.g.la();const T=rh(p.g);if(T==="")return"";let I="";const U=T.length,ae=yi(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Pe(p),We(p),"";p.h.i=new o.TextDecoder}for(let pe=0;pe<U;pe++)p.h.h=!0,I+=p.h.i.decode(T[pe],{stream:!(ae&&pe==U-1)});return T.length=0,p.h.g+=I,p.C=0,p.h.g}function le(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function fe(p,T){var I=p.C,U=T.indexOf(`
`,I);return U==-1?K:(I=Number(T.substring(I,U)),isNaN(I)?W:(U+=1,U+I>T.length?K:(T=T.slice(U,U+I),p.C=U+I,T)))}H.prototype.cancel=function(){this.K=!0,Pe(this)};function he(p){p.T=Date.now()+p.H,Re(p,p.H)}function Re(p,T){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Cs(h(p.aa,p),T)}function Be(p){p.D&&(o.clearTimeout(p.D),p.D=null)}H.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Ut(this.i,this.B),this.M!=2&&(Yn(),Zt(17)),Pe(this),this.m=2,We(this)):Re(this,this.T-p)};function We(p){p.j.I==0||p.K||Dl(p.j,p)}function Pe(p){Be(p);var T=p.O;T&&typeof T.dispose=="function"&&T.dispose(),p.O=null,Un(p.V),p.g&&(T=p.g,p.g=null,T.abort(),T.dispose())}function Oe(p,T){try{var I=p.j;if(I.I!=0&&(I.g==p||qs(I.h,p))){if(!p.L&&qs(I.h,p)&&I.I==3){try{var U=I.Ba.g.parse(T)}catch{U=null}if(Array.isArray(U)&&U.length==3){var ae=U;if(ae[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<p.F)Rl(I),ds(I);else break e;Ti(I),Zt(18)}}else I.xa=ae[1],0<I.xa-I.K&&ae[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=Cs(h(I.Va,I),6e3));cr(I.h)<=1&&I.ta&&(I.ta=void 0)}else ps(I,11)}else if((p.L||I.g==p)&&Rl(I),!L(T))for(ae=I.Ba.g.parse(T),T=0;T<ae.length;T++){let Kt=ae[T];const Or=Kt[0];if(!(Or<=I.K))if(I.K=Or,Kt=Kt[1],I.I==2)if(Kt[0]=="c"){I.M=Kt[1],I.ba=Kt[2];const ms=Kt[3];ms!=null&&(I.ka=ms,I.j.info("VER="+I.ka));const Ji=Kt[4];Ji!=null&&(I.za=Ji,I.j.info("SVER="+I.za));const Si=Kt[5];Si!=null&&typeof Si=="number"&&Si>0&&(U=1.5*Si,I.O=U,I.j.info("backChannelRequestTimeoutMs_="+U)),U=I;const ki=p.g;if(ki){const Ll=ki.g?ki.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ll){var pe=U.h;pe.g||Ll.indexOf("spdy")==-1&&Ll.indexOf("quic")==-1&&Ll.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(Fs(pe,pe.h),pe.h=null))}if(U.G){const iu=ki.g?ki.g.getResponseHeader("X-HTTP-Session-Id"):null;iu&&(U.wa=iu,Bt(U.J,U.G,iu))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-p.F,I.j.info("Handshake RTT: "+I.T+"ms")),U=I;var ze=p;if(U.na=su(U,U.L?U.ba:null,U.W),ze.L){fs(U.h,ze);var pt=ze,Cr=U.O;Cr&&(pt.H=Cr),pt.D&&(Be(pt),he(pt)),U.g=ze}else Tn(U);I.i.length>0&&Qi(I)}else Kt[0]!="stop"&&Kt[0]!="close"||ps(I,7);else I.I==3&&(Kt[0]=="stop"||Kt[0]=="close"?Kt[0]=="stop"?ps(I,7):bl(I):Kt[0]!="noop"&&I.l&&I.l.qa(Kt),I.A=0)}}Yn(4)}catch{}}var ct=class{constructor(p,T){this.g=p,this.map=T}};function zt(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Gt(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function cr(p){return p.h?1:p.g?p.g.size:0}function qs(p,T){return p.h?p.h==T:p.g?p.g.has(T):!1}function Fs(p,T){p.g?p.g.add(T):p.h=T}function fs(p,T){p.h&&p.h==T?p.h=null:p.g&&p.g.has(T)&&p.g.delete(T)}zt.prototype.cancel=function(){if(this.i=Ar(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Ar(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let T=p.i;for(const I of p.g.values())T=T.concat(I.G);return T}return y(p.i)}var Fa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function dr(p,T){if(p){p=p.split("&");for(let I=0;I<p.length;I++){const U=p[I].indexOf("=");let ae,pe=null;U>=0?(ae=p[I].substring(0,U),pe=p[I].substring(U+1)):ae=p[I],T(ae,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function pi(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let T;p instanceof pi?(this.l=p.l,Ao(this,p.j),this.o=p.o,this.g=p.g,mi(this,p.u),this.h=p.h,ba(this,tu(p.i)),this.m=p.m):p&&(T=String(p).match(Fa))?(this.l=!1,Ao(this,T[1]||"",!0),this.o=Co(T[2]||""),this.g=Co(T[3]||"",!0),mi(this,T[4]),this.h=Co(T[5]||"",!0),ba(this,T[6]||"",!0),this.m=Co(T[7]||"")):(this.l=!1,this.i=new Ft(null,this.l))}pi.prototype.toString=function(){const p=[];var T=this.j;T&&p.push(Io(T,Xc,!0),":");var I=this.g;return(I||T=="file")&&(p.push("//"),(T=this.o)&&p.push(Io(T,Xc,!0),"@"),p.push(Pr(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&p.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&p.push("/"),p.push(Io(I,I.charAt(0)=="/"?Fo:Yc,!0))),(I=this.i.toString())&&p.push("?",I),(I=this.m)&&p.push("#",Io(I,Qc)),p.join("")},pi.prototype.resolve=function(p){const T=bs(this);let I=!!p.j;I?Ao(T,p.j):I=!!p.o,I?T.o=p.o:I=!!p.g,I?T.g=p.g:I=p.u!=null;var U=p.h;if(I)mi(T,p.u);else if(I=!!p.h){if(U.charAt(0)!="/")if(this.g&&!this.h)U="/"+U;else{var ae=T.h.lastIndexOf("/");ae!=-1&&(U=T.h.slice(0,ae+1)+U)}if(ae=U,ae==".."||ae==".")U="";else if(ae.indexOf("./")!=-1||ae.indexOf("/.")!=-1){U=ae.lastIndexOf("/",0)==0,ae=ae.split("/");const pe=[];for(let ze=0;ze<ae.length;){const pt=ae[ze++];pt=="."?U&&ze==ae.length&&pe.push(""):pt==".."?((pe.length>1||pe.length==1&&pe[0]!="")&&pe.pop(),U&&ze==ae.length&&pe.push("")):(pe.push(pt),U=!0)}U=pe.join("/")}else U=ae}return I?T.h=U:I=p.i.toString()!=="",I?ba(T,tu(p.i)):I=!!p.m,I&&(T.m=p.m),T};function bs(p){return new pi(p)}function Ao(p,T,I){p.j=I?Co(T,!0):T,p.j&&(p.j=p.j.replace(/:$/,""))}function mi(p,T){if(T){if(T=Number(T),isNaN(T)||T<0)throw Error("Bad port number "+T);p.u=T}else p.u=null}function ba(p,T,I){T instanceof Ft?(p.i=T,Cl(p.i,p.l)):(I||(T=Io(T,Ud)),p.i=new Ft(T,p.l))}function Bt(p,T,I){p.i.set(T,I)}function Ki(p){return Bt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Co(p,T){return p?T?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Io(p,T,I){return typeof p=="string"?(p=encodeURI(p).replace(T,qc),I&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function qc(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Xc=/[#\/\?@]/g,Yc=/[#\?:]/g,Fo=/[#\?]/g,Ud=/[#\?@]/g,Qc=/#/g;function Ft(p,T){this.h=this.g=null,this.i=p||null,this.j=!!T}function gi(p){p.g||(p.g=new Map,p.h=0,p.i&&dr(p.i,function(T,I){p.add(decodeURIComponent(T.replace(/\+/g," ")),I)}))}t=Ft.prototype,t.add=function(p,T){gi(this),this.i=null,p=xi(this,p);let I=this.g.get(p);return I||this.g.set(p,I=[]),I.push(T),this.h+=1,this};function Jc(p,T){gi(p),T=xi(p,T),p.g.has(T)&&(p.i=null,p.h-=p.g.get(T).length,p.g.delete(T))}function Al(p,T){return gi(p),T=xi(p,T),p.g.has(T)}t.forEach=function(p,T){gi(this),this.g.forEach(function(I,U){I.forEach(function(ae){p.call(T,ae,U,this)},this)},this)};function Zc(p,T){gi(p);let I=[];if(typeof T=="string")Al(p,T)&&(I=I.concat(p.g.get(xi(p,T))));else for(p=Array.from(p.g.values()),T=0;T<p.length;T++)I=I.concat(p[T]);return I}t.set=function(p,T){return gi(this),this.i=null,p=xi(this,p),Al(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[T]),this.h+=1,this},t.get=function(p,T){return p?(p=Zc(this,p),p.length>0?String(p[0]):T):T};function eu(p,T,I){Jc(p,T),I.length>0&&(p.i=null,p.g.set(xi(p,T),y(I)),p.h+=I.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],T=Array.from(this.g.keys());for(let U=0;U<T.length;U++){var I=T[U];const ae=Pr(I);I=Zc(this,I);for(let pe=0;pe<I.length;pe++){let ze=ae;I[pe]!==""&&(ze+="="+Pr(I[pe])),p.push(ze)}}return this.i=p.join("&")};function tu(p){const T=new Ft;return T.i=p.i,p.g&&(T.g=new Map(p.g),T.h=p.h),T}function xi(p,T){return T=String(T),p.j&&(T=T.toLowerCase()),T}function Cl(p,T){T&&!p.j&&(gi(p),p.i=null,p.g.forEach(function(I,U){const ae=U.toLowerCase();U!=ae&&(Jc(this,U),eu(this,ae,I))},p)),p.j=T}function vi(p,T){const I=new Is;if(o.Image){const U=new Image;U.onload=d(un,I,"TestLoadImage: loaded",!0,T,U),U.onerror=d(un,I,"TestLoadImage: error",!1,T,U),U.onabort=d(un,I,"TestLoadImage: abort",!1,T,U),U.ontimeout=d(un,I,"TestLoadImage: timeout",!1,T,U),o.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=p}else T(!1)}function _i(p,T){const I=new Is,U=new AbortController,ae=setTimeout(()=>{U.abort(),un(I,"TestPingServer: timeout",!1,T)},1e4);fetch(p,{signal:U.signal}).then(pe=>{clearTimeout(ae),pe.ok?un(I,"TestPingServer: ok",!0,T):un(I,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(ae),un(I,"TestPingServer: error",!1,T)})}function un(p,T,I,U,ae){try{ae&&(ae.onload=null,ae.onerror=null,ae.onabort=null,ae.ontimeout=null),U(I)}catch{}}function bo(){this.g=new ot}function qi(p){this.i=p.Sb||null,this.h=p.ab||!1}g(qi,Rt),qi.prototype.g=function(){return new hs(this.i,this.h)};function hs(p,T){St.call(this),this.H=p,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(hs,St),t=hs.prototype,t.open=function(p,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=T,this.readyState=1,Xs(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const T={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(T.body=p),(this.H||o).fetch(new Request(this.D,T)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Na(this)),this.readyState=0},t.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Xs(this)),this.g&&(this.readyState=3,Xs(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Zf(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Zf(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}t.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var T=p.value?p.value:new Uint8Array(0);(T=this.B.decode(T,{stream:!p.done}))&&(this.response=this.responseText+=T)}p.done?Na(this):Xs(this),this.readyState==3&&Zf(this)}},t.Oa=function(p){this.g&&(this.response=this.responseText=p,Na(this))},t.Na=function(p){this.g&&(this.response=p,Na(this))},t.ga=function(){this.g&&Na(this)};function Na(p){p.readyState=4,p.l=null,p.j=null,p.B=null,Xs(p)}t.setRequestHeader=function(p,T){this.A.append(p,T)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],T=this.h.entries();for(var I=T.next();!I.done;)I=I.value,p.push(I[0]+": "+I[1]),I=T.next();return p.join(`\r
`)};function Xs(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(hs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function eh(p){let T="";return ne(p,function(I,U){T+=U,T+=":",T+=I,T+=`\r
`}),T}function Il(p,T,I){e:{for(U in I){var U=!1;break e}U=!0}U||(I=eh(I),typeof p=="string"?I!=null&&Pr(I):Bt(p,T,I))}function Jt(p){St.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(Jt,St);var th=/^https?$/i,zd=["POST","PUT"];t=Jt.prototype,t.Fa=function(p){this.H=p},t.ea=function(p,T,I,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);T=T?T.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Gi.g(),this.g.onreadystatechange=x(h(this.Ca,this));try{this.B=!0,this.g.open(T,String(p),!0),this.B=!1}catch(pe){Ra(this,pe);return}if(p=I||"",I=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var ae in U)I.set(ae,U[ae]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const pe of U.keys())I.set(pe,U.get(pe));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(I.keys()).find(pe=>pe.toLowerCase()=="content-type"),ae=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(zd,T,void 0)>=0)||U||ae||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,ze]of I)this.g.setRequestHeader(pe,ze);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(pe){Ra(this,pe)}};function Ra(p,T){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=T,p.o=5,Da(p),Yi(p)}function Da(p){p.A||(p.A=!0,Tt(p,"complete"),Tt(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Tt(this,"complete"),Tt(this,"abort"),Yi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yi(this,!0)),Jt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Xi(this):this.Xa())},t.Xa=function(){Xi(this)};function Xi(p){if(p.h&&typeof i<"u"){if(p.v&&yi(p)==4)setTimeout(p.Ca.bind(p),0);else if(Tt(p,"readystatechange"),yi(p)==4){p.h=!1;try{const pe=p.ca();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var I;if(!(I=T)){var U;if(U=pe===0){let ze=String(p.D).match(Fa)[1]||null;!ze&&o.self&&o.self.location&&(ze=o.self.location.protocol.slice(0,-1)),U=!th.test(ze?ze.toLowerCase():"")}I=U}if(I)Tt(p,"complete"),Tt(p,"success");else{p.o=6;try{var ae=yi(p)>2?p.g.statusText:""}catch{ae=""}p.l=ae+" ["+p.ca()+"]",Da(p)}}finally{Yi(p)}}}}function Yi(p,T){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const I=p.g;p.g=null,T||Tt(p,"ready");try{I.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function yi(p){return p.g?p.g.readyState:0}t.ca=function(){try{return yi(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(p){if(this.g){var T=this.g.responseText;return p&&T.indexOf(p)==0&&(T=T.substring(p.length)),Jr(T)}};function rh(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function ru(p){const T={};p=(p.g&&yi(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<p.length;U++){if(L(p[U]))continue;var I=P(p[U]);const ae=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const pe=T[ae]||[];T[ae]=pe,pe.push(I)}ye(T,function(U){return U.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function wi(p,T,I){return I&&I.internalChannelParams&&I.internalChannelParams[p]||T}function Fl(p){this.za=0,this.i=[],this.j=new Is,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=wi("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=wi("baseRetryDelayMs",5e3,p),this.Za=wi("retryDelaySeedMs",1e4,p),this.Ta=wi("forwardChannelMaxRetries",2,p),this.va=wi("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new zt(p&&p.concurrentRequestLimit),this.Ba=new bo,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Fl.prototype,t.ka=8,t.I=1,t.connect=function(p,T,I,U){Zt(0),this.W=p,this.H=T||{},I&&U!==void 0&&(this.H.OSID=I,this.H.OAID=U),this.F=this.X,this.J=su(this,null,this.W),Qi(this)};function bl(p){if(Nl(p),p.I==3){var T=p.V++,I=bs(p.J);if(Bt(I,"SID",p.M),Bt(I,"RID",T),Bt(I,"TYPE","terminate"),Ei(p,I),T=new H(p,p.j,T),T.M=2,T.A=Ki(bs(I)),I=!1,o.navigator&&o.navigator.sendBeacon)try{I=o.navigator.sendBeacon(T.A.toString(),"")}catch{}!I&&o.Image&&(new Image().src=T.A,I=!0),I||(T.g=sh(T.j,null),T.g.ea(T.A)),T.F=Date.now(),he(T)}Do(p)}function ds(p){p.g&&(Ro(p),p.g.cancel(),p.g=null)}function Nl(p){ds(p),p.v&&(o.clearTimeout(p.v),p.v=null),Rl(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function Qi(p){if(!Gt(p.h)&&!p.m){p.m=!0;var T=p.Ea;X||C(),G||(X(),G=!0),A.add(T,p),p.D=0}}function nh(p,T){return cr(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=T.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Cs(h(p.Ea,p,T),Pl(p,p.D)),p.D++,!0)}t.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const ae=new H(this,this.j,p);let pe=this.o;if(this.U&&(pe?(pe=ee(pe),te(pe,this.U)):pe=this.U),this.u!==null||this.R||(ae.J=pe,pe=null),this.S)e:{for(var T=0,I=0;I<this.i.length;I++){t:{var U=this.i[I];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(T+=U,T>4096){T=I;break e}if(T===4096||I===this.i.length-1){T=I+1;break e}}T=1e3}else T=1e3;T=nu(this,ae,T),I=bs(this.J),Bt(I,"RID",p),Bt(I,"CVER",22),this.G&&Bt(I,"X-HTTP-Session-Id",this.G),Ei(this,I),pe&&(this.R?T="headers="+Pr(eh(pe))+"&"+T:this.u&&Il(I,this.u,pe)),Fs(this.h,ae),this.Ra&&Bt(I,"TYPE","init"),this.S?(Bt(I,"$req",T),Bt(I,"SID","null"),ae.U=!0,q(ae,I,null)):q(ae,I,T),this.I=2}}else this.I==3&&(p?No(this,p):this.i.length==0||Gt(this.h)||No(this))};function No(p,T){var I;T?I=T.l:I=p.V++;const U=bs(p.J);Bt(U,"SID",p.M),Bt(U,"RID",I),Bt(U,"AID",p.K),Ei(p,U),p.u&&p.o&&Il(U,p.u,p.o),I=new H(p,p.j,I,p.D+1),p.u===null&&(I.J=p.o),T&&(p.i=T.G.concat(p.i)),T=nu(p,I,1e3),I.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),Fs(p.h,I),q(I,U,T)}function Ei(p,T){p.H&&ne(p.H,function(I,U){Bt(T,U,I)}),p.l&&ne({},function(I,U){Bt(T,U,I)})}function nu(p,T,I){I=Math.min(p.i.length,I);const U=p.l?h(p.l.Ka,p.l,p):null;e:{var ae=p.i;let pt=-1;for(;;){const Cr=["count="+I];pt==-1?I>0?(pt=ae[0].g,Cr.push("ofs="+pt)):pt=0:Cr.push("ofs="+pt);let Kt=!0;for(let Or=0;Or<I;Or++){var pe=ae[Or].g;const ms=ae[Or].map;if(pe-=pt,pe<0)pt=Math.max(0,ae[Or].g-100),Kt=!1;else try{pe="req"+pe+"_"||"";try{var ze=ms instanceof Map?ms:Object.entries(ms);for(const[Ji,Si]of ze){let ki=Si;c(Si)&&(ki=$t(Si)),Cr.push(pe+Ji+"="+encodeURIComponent(ki))}}catch(Ji){throw Cr.push(pe+"type="+encodeURIComponent("_badmap")),Ji}}catch{U&&U(ms)}}if(Kt){ze=Cr.join("&");break e}}ze=void 0}return p=p.i.splice(0,I),T.G=p,ze}function Tn(p){if(!p.g&&!p.v){p.Y=1;var T=p.Da;X||C(),G||(X(),G=!0),A.add(T,p),p.A=0}}function Ti(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Cs(h(p.Da,p),Pl(p,p.A)),p.A++,!0)}t.Da=function(){if(this.v=null,Pa(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Cs(h(this.Wa,this),p)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Zt(10),ds(this),Pa(this))};function Ro(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function Pa(p){p.g=new H(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var T=bs(p.na);Bt(T,"RID","rpc"),Bt(T,"SID",p.M),Bt(T,"AID",p.K),Bt(T,"CI",p.F?"0":"1"),!p.F&&p.ia&&Bt(T,"TO",p.ia),Bt(T,"TYPE","xmlhttp"),Ei(p,T),p.u&&p.o&&Il(T,p.u,p.o),p.O&&(p.g.H=p.O);var I=p.g;p=p.ba,I.M=1,I.A=Ki(bs(T)),I.u=null,I.R=!0,ce(I,p)}t.Va=function(){this.C!=null&&(this.C=null,ds(this),Ti(this),Zt(19))};function Rl(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function Dl(p,T){var I=null;if(p.g==T){Rl(p),Ro(p),p.g=null;var U=2}else if(qs(p.h,T))I=T.G,fs(p.h,T),U=1;else return;if(p.I!=0){if(T.o)if(U==1){I=T.u?T.u.length:0,T=Date.now()-T.F;var ae=p.D;U=us(),Tt(U,new As(U,I)),Qi(p)}else Tn(p);else if(ae=T.m,ae==3||ae==0&&T.X>0||!(U==1&&nh(p,T)||U==2&&Ti(p)))switch(I&&I.length>0&&(T=p.h,T.i=T.i.concat(I)),ae){case 1:ps(p,5);break;case 4:ps(p,10);break;case 3:ps(p,6);break;default:ps(p,2)}}}function Pl(p,T){let I=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(I*=2),I*T}function ps(p,T){if(p.j.info("Error code "+T),T==2){var I=h(p.bb,p),U=p.Ua;const ae=!U;U=new pi(U||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ao(U,"https"),Ki(U),ae?vi(U.toString(),I):_i(U.toString(),I)}else Zt(2);p.I=0,p.l&&p.l.pa(T),Do(p),Nl(p)}t.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Zt(2)):(this.j.info("Failed to ping google.com"),Zt(1))};function Do(p){if(p.I=0,p.ja=[],p.l){const T=Ar(p.h);(T.length!=0||p.i.length!=0)&&(k(p.ja,T),k(p.ja,p.i),p.h.i.length=0,y(p.i),p.i.length=0),p.l.oa()}}function su(p,T,I){var U=I instanceof pi?bs(I):new pi(I);if(U.g!="")T&&(U.g=T+"."+U.g),mi(U,U.u);else{var ae=o.location;U=ae.protocol,T=T?T+"."+ae.hostname:ae.hostname,ae=+ae.port;const pe=new pi(null);U&&Ao(pe,U),T&&(pe.g=T),ae&&mi(pe,ae),I&&(pe.h=I),U=pe}return I=p.G,T=p.wa,I&&T&&Bt(U,I,T),Bt(U,"VER",p.ka),Ei(p,U),U}function sh(p,T,I){if(T&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return T=p.Aa&&!p.ma?new Jt(new qi({ab:I})):new Jt(p.ma),T.Fa(p.L),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ih(){}t=ih.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Ol(){}Ol.prototype.g=function(p,T){return new fn(p,T)};function fn(p,T){St.call(this),this.g=new Fl(T),this.l=p,this.h=T&&T.messageUrlParams||null,p=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(p?p["X-WebChannel-Content-Type"]=T.messageContentType:p={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.sa&&(p?p["X-WebChannel-Client-Profile"]=T.sa:p={"X-WebChannel-Client-Profile":T.sa}),this.g.U=p,(p=T&&T.Qb)&&!L(p)&&(this.g.u=p),this.A=T&&T.supportsCrossDomainXhr||!1,this.v=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!L(T)&&(this.g.G=T,p=this.h,p!==null&&T in p&&(p=this.h,T in p&&delete p[T])),this.j=new Oa(this)}g(fn,St),fn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},fn.prototype.close=function(){bl(this.g)},fn.prototype.o=function(p){var T=this.g;if(typeof p=="string"){var I={};I.__data__=p,p=I}else this.v&&(I={},I.__data__=$t(p),p=I);T.i.push(new ct(T.Ya++,p)),T.I==3&&Qi(T)},fn.prototype.N=function(){this.g.l=null,delete this.j,bl(this.g),delete this.g,fn.Z.N.call(this)};function ah(p){wn.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var T=p.__sm__;if(T){e:{for(const I in T){p=I;break e}p=void 0}(this.i=p)&&(p=this.i,T=T!==null&&p in T?T[p]:void 0),this.data=T}else this.data=p}g(ah,wn);function oh(){hi.call(this),this.status=1}g(oh,hi);function Oa(p){this.g=p}g(Oa,ih),Oa.prototype.ra=function(){Tt(this.g,"a")},Oa.prototype.qa=function(p){Tt(this.g,new ah(p))},Oa.prototype.pa=function(p){Tt(this.g,new oh)},Oa.prototype.oa=function(){Tt(this.g,"b")},Ol.prototype.createWebChannel=Ol.prototype.g,fn.prototype.send=fn.prototype.o,fn.prototype.open=fn.prototype.m,fn.prototype.close=fn.prototype.close,lE=function(){return new Ol},oE=function(){return us()},aE=En,Jm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},hr.NO_ERROR=0,hr.TIMEOUT=8,hr.HTTP_ERROR=6,_0=hr,Zr.COMPLETE="complete",iE=Zr,Gr.EventType=jt,jt.OPEN="a",jt.CLOSE="b",jt.ERROR="c",jt.MESSAGE="d",St.prototype.listen=St.prototype.J,Ru=Gr,Jt.prototype.listenOnce=Jt.prototype.K,Jt.prototype.getLastError=Jt.prototype.Ha,Jt.prototype.getLastErrorCode=Jt.prototype.ya,Jt.prototype.getStatus=Jt.prototype.ca,Jt.prototype.getResponseJson=Jt.prototype.La,Jt.prototype.getResponseText=Jt.prototype.la,Jt.prototype.send=Jt.prototype.ea,Jt.prototype.setWithCredentials=Jt.prototype.Fa,sE=Jt}).apply(typeof r0<"u"?r0:typeof self<"u"?self:typeof window<"u"?window:{});const r2="@firebase/firestore",n2="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}bn.UNAUTHENTICATED=new bn(null),bn.GOOGLE_CREDENTIALS=new bn("google-credentials-uid"),bn.FIRST_PARTY=new bn("first-party-uid"),bn.MOCK_USER=new bn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bc="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ll=new Mg("@firebase/firestore");function oc(){return ll.logLevel}function Ge(t,...e){if(ll.logLevel<=kt.DEBUG){const r=e.map(jg);ll.debug(`Firestore (${Bc}): ${t}`,...r)}}function ya(t,...e){if(ll.logLevel<=kt.ERROR){const r=e.map(jg);ll.error(`Firestore (${Bc}): ${t}`,...r)}}function kc(t,...e){if(ll.logLevel<=kt.WARN){const r=e.map(jg);ll.warn(`Firestore (${Bc}): ${t}`,...r)}}function jg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(r){return JSON.stringify(r)})(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function at(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,cE(t,n,r)}function cE(t,e,r){let n=`FIRESTORE (${Bc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ya(n),new Error(n)}function Wt(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||cE(e,s,n)}function mt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const we={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class He extends Sa{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class XC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(bn.UNAUTHENTICATED)))}shutdown(){}}class YC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class QC{constructor(e){this.t=e,this.currentUser=bn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Wt(this.o===void 0,42304);let n=this.i;const s=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let i=new ma;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ma,e.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const u=i;e.enqueueRetryable((async()=>{await u.promise,await s(this.currentUser)}))},c=u=>{Ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ma)}}),0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(Ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Wt(typeof n.accessToken=="string",31837,{l:n}),new uE(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Wt(e===null||typeof e=="string",2055,{h:e}),new bn(e)}}class JC{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=bn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ZC{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new JC(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(bn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class s2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eI{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ni(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Wt(this.o===void 0,3512);const n=i=>{i.error!=null&&Ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Ge("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>n(i)))};const s=i=>{Ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new s2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Wt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new s2(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tI(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=tI(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%62))}return n}}function At(t,e){return t<e?-1:t>e?1:0}function Zm(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),i=e.charAt(n);if(s!==i)return Em(s)===Em(i)?At(s,i):Em(s)?1:-1}return At(t.length,e.length)}const rI=55296,nI=57343;function Em(t){const e=t.charCodeAt(0);return e>=rI&&e<=nI}function Ac(t,e,r){return t.length===e.length&&t.every(((n,s)=>r(n,e[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2="__name__";class Di{constructor(e,r,n){r===void 0?r=0:r>e.length&&at(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&at(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Di.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Di?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=Di.compareSegments(e.get(s),r.get(s));if(i!==0)return i}return At(e.length,r.length)}static compareSegments(e,r){const n=Di.isNumericId(e),s=Di.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?Di.extractNumericId(e).compare(Di.extractNumericId(r)):Zm(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return oo.fromString(e.substring(4,e.length-2))}}class tr extends Di{construct(e,r,n){return new tr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new He(we.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((s=>s.length>0)))}return new tr(r)}static emptyPath(){return new tr([])}}const sI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xn extends Di{construct(e,r,n){return new xn(e,r,n)}static isValidIdentifier(e){return sI.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===i2}static keyField(){return new xn([i2])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new He(we.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new He(we.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new He(we.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(n+=c,s++):(i(),s++)}if(i(),o)throw new He(we.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xn(r)}static emptyPath(){return new xn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e){this.path=e}static fromPath(e){return new et(tr.fromString(e))}static fromName(e){return new et(tr.fromString(e).popFirst(5))}static empty(){return new et(tr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return tr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new et(new tr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE(t,e,r){if(!r)throw new He(we.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iI(t,e,r,n){if(e===!0&&n===!0)throw new He(we.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function a2(t){if(!et.isDocumentKey(t))throw new He(we.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function o2(t){if(et.isDocumentKey(t))throw new He(we.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function hE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function hd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":at(12329,{type:typeof t})}function Gn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new He(we.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=hd(t);throw new He(we.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(t,e){const r={typeString:t};return e&&(r.value=e),r}function Nf(t,e){if(!hE(t))throw new He(we.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(s&&typeof o!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new He(we.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2=-62135596800,c2=1e6;class ar{static now(){return ar.fromMillis(Date.now())}static fromDate(e){return ar.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*c2);return new ar(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new He(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new He(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<l2)throw new He(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new He(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/c2}_compareTo(e){return this.seconds===e.seconds?At(this.nanoseconds,e.nanoseconds):At(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ar._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Nf(e,ar._jsonSchema))return new ar(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-l2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ar._jsonSchemaVersion="firestore/timestamp/1.0",ar._jsonSchema={type:Wr("string",ar._jsonSchemaVersion),seconds:Wr("number"),nanoseconds:Wr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{static fromTimestamp(e){return new dt(e)}static min(){return new dt(new ar(0,0))}static max(){return new dt(new ar(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af=-1;function aI(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=dt.fromTimestamp(n===1e9?new ar(r+1,0):new ar(r,n));return new co(s,et.empty(),e)}function oI(t){return new co(t.readTime,t.key,af)}class co{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new co(dt.min(),et.empty(),af)}static max(){return new co(dt.max(),et.empty(),af)}}function lI(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=et.comparator(t.documentKey,e.documentKey),r!==0?r:At(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vc(t){if(t.code!==we.FAILED_PRECONDITION||t.message!==cI)throw t;Ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&at(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Ae(((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof Ae?r:Ae.resolve(r)}catch(r){return Ae.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):Ae.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):Ae.reject(r)}static resolve(e){return new Ae(((r,n)=>{r(e)}))}static reject(e){return new Ae(((r,n)=>{n(e)}))}static waitFor(e){return new Ae(((r,n)=>{let s=0,i=0,o=!1;e.forEach((c=>{++s,c.next((()=>{++i,o&&i===s&&r()}),(u=>n(u)))})),o=!0,i===s&&r()}))}static or(e){let r=Ae.resolve(!1);for(const n of e)r=r.next((s=>s?Ae.resolve(s):n()));return r}static forEach(e,r){const n=[];return e.forEach(((s,i)=>{n.push(r.call(this,s,i))})),this.waitFor(n)}static mapArray(e,r){return new Ae(((n,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;r(e[h]).next((d=>{o[h]=d,++c,c===i&&n(o)}),(d=>s(d)))}}))}static doWhile(e,r){return new Ae(((n,s)=>{const i=()=>{e()===!0?r().next((()=>{i()}),s):n()};i()}))}}function fI(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function jc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}dd.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zg=-1;function pd(t){return t==null}function P0(t){return t===0&&1/t==-1/0}function hI(t){return typeof t=="number"&&Number.isInteger(t)&&!P0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE="";function dI(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=u2(e)),e=pI(t.get(r),e);return u2(e)}function pI(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case dE:r+="";break;default:r+=i}}return r}function u2(t){return t+dE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f2(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function yo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function pE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,r){this.comparator=e,this.root=r||mn.EMPTY}insert(e,r){return new _r(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,mn.BLACK,null,null))}remove(e){return new _r(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new n0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new n0(this.root,e,this.comparator,!1)}getReverseIterator(){return new n0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new n0(this.root,e,this.comparator,!0)}}class n0{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mn{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??mn.RED,this.left=s??mn.EMPTY,this.right=i??mn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new mn(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return mn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return mn.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw at(43730,{key:this.key,value:this.value});if(this.right.isRed())throw at(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw at(27949);return e+(this.isRed()?0:1)}}mn.EMPTY=null,mn.RED=!0,mn.BLACK=!1;mn.EMPTY=new class{constructor(){this.size=0}get key(){throw at(57766)}get value(){throw at(16141)}get color(){throw at(16727)}get left(){throw at(29726)}get right(){throw at(36894)}copy(e,r,n,s,i){return this}insert(e,r,n){return new mn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this.comparator=e,this.data=new _r(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new h2(this.data.getIterator())}getIteratorFrom(e){return new h2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof Yr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new Yr(this.comparator);return r.data=e,r}}class h2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this.fields=e,e.sort(xn.comparator)}static empty(){return new Ts([])}unionWith(e){let r=new Yr(xn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ts(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Ac(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new mE("Invalid base64 string: "+i):i}})(e);return new _n(r)}static fromUint8Array(e){const r=(function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i})(e);return new _n(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return At(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_n.EMPTY_BYTE_STRING=new _n("");const mI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function uo(t){if(Wt(!!t,39018),typeof t=="string"){let e=0;const r=mI.exec(t);if(Wt(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:br(t.seconds),nanos:br(t.nanos)}}function br(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function fo(t){return typeof t=="string"?_n.fromBase64String(t):_n.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE="server_timestamp",xE="__type__",vE="__previous_value__",_E="__local_write_time__";function Wg(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[xE])==null?void 0:n.stringValue)===gE}function md(t){const e=t.mapValue.fields[vE];return Wg(e)?md(e):e}function of(t){const e=uo(t.mapValue.fields[_E].timestampValue);return new ar(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(e,r,n,s,i,o,c,u,h,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=d}}const O0="(default)";class lf{constructor(e,r){this.projectId=e,this.database=r||O0}static empty(){return new lf("","")}get isDefaultDatabase(){return this.database===O0}isEqual(e){return e instanceof lf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yE="__type__",xI="__max__",s0={mapValue:{}},wE="__vector__",L0="value";function ho(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Wg(t)?4:_I(t)?9007199254740991:vI(t)?10:11:at(28295,{value:t})}function Ui(t,e){if(t===e)return!0;const r=ho(t);if(r!==ho(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return of(t).isEqual(of(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=uo(s.timestampValue),c=uo(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(s,i){return fo(s.bytesValue).isEqual(fo(i.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(s,i){return br(s.geoPointValue.latitude)===br(i.geoPointValue.latitude)&&br(s.geoPointValue.longitude)===br(i.geoPointValue.longitude)})(t,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return br(s.integerValue)===br(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=br(s.doubleValue),c=br(i.doubleValue);return o===c?P0(o)===P0(c):isNaN(o)&&isNaN(c)}return!1})(t,e);case 9:return Ac(t.arrayValue.values||[],e.arrayValue.values||[],Ui);case 10:case 11:return(function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(f2(o)!==f2(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Ui(o[u],c[u])))return!1;return!0})(t,e);default:return at(52216,{left:t})}}function cf(t,e){return(t.values||[]).find((r=>Ui(r,e)))!==void 0}function Cc(t,e){if(t===e)return 0;const r=ho(t),n=ho(e);if(r!==n)return At(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return At(t.booleanValue,e.booleanValue);case 2:return(function(i,o){const c=br(i.integerValue||i.doubleValue),u=br(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(t,e);case 3:return d2(t.timestampValue,e.timestampValue);case 4:return d2(of(t),of(e));case 5:return Zm(t.stringValue,e.stringValue);case 6:return(function(i,o){const c=fo(i),u=fo(o);return c.compareTo(u)})(t.bytesValue,e.bytesValue);case 7:return(function(i,o){const c=i.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){const d=At(c[h],u[h]);if(d!==0)return d}return At(c.length,u.length)})(t.referenceValue,e.referenceValue);case 8:return(function(i,o){const c=At(br(i.latitude),br(o.latitude));return c!==0?c:At(br(i.longitude),br(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return p2(t.arrayValue,e.arrayValue);case 10:return(function(i,o){var x,y,k,w;const c=i.fields||{},u=o.fields||{},h=(x=c[L0])==null?void 0:x.arrayValue,d=(y=u[L0])==null?void 0:y.arrayValue,g=At(((k=h==null?void 0:h.values)==null?void 0:k.length)||0,((w=d==null?void 0:d.values)==null?void 0:w.length)||0);return g!==0?g:p2(h,d)})(t.mapValue,e.mapValue);case 11:return(function(i,o){if(i===s0.mapValue&&o===s0.mapValue)return 0;if(i===s0.mapValue)return 1;if(o===s0.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),h=o.fields||{},d=Object.keys(h);u.sort(),d.sort();for(let g=0;g<u.length&&g<d.length;++g){const x=Zm(u[g],d[g]);if(x!==0)return x;const y=Cc(c[u[g]],h[d[g]]);if(y!==0)return y}return At(u.length,d.length)})(t.mapValue,e.mapValue);default:throw at(23264,{he:r})}}function d2(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return At(t,e);const r=uo(t),n=uo(e),s=At(r.seconds,n.seconds);return s!==0?s:At(r.nanos,n.nanos)}function p2(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Cc(r[s],n[s]);if(i)return i}return At(r.length,n.length)}function Ic(t){return eg(t)}function eg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=uo(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return fo(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return et.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=eg(i);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const o of n)i?i=!1:s+=",",s+=`${o}:${eg(r.fields[o])}`;return s+"}"})(t.mapValue):at(61005,{value:t})}function y0(t){switch(ho(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=md(t);return e?16+y0(e):16;case 5:return 2*t.stringValue.length;case 6:return fo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,i)=>s+y0(i)),0)})(t.arrayValue);case 10:case 11:return(function(n){let s=0;return yo(n.fields,((i,o)=>{s+=i.length+y0(o)})),s})(t.mapValue);default:throw at(13486,{value:t})}}function m2(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function tg(t){return!!t&&"integerValue"in t}function Hg(t){return!!t&&"arrayValue"in t}function g2(t){return!!t&&"nullValue"in t}function x2(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function w0(t){return!!t&&"mapValue"in t}function vI(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[yE])==null?void 0:n.stringValue)===wE}function Uu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return yo(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=Uu(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Uu(t.arrayValue.values[r]);return e}return{...t}}function _I(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===xI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e){this.value=e}static empty(){return new as({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!w0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Uu(r)}setAll(e){let r=xn.emptyPath(),n={},s=[];e.forEach(((o,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,s),n={},s=[],r=c.popLast()}o?n[c.lastSegment()]=Uu(o):s.push(c.lastSegment())}));const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());w0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ui(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];w0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){yo(r,((s,i)=>e[s]=i));for(const s of n)delete e[s]}clone(){return new as(Uu(this.value))}}function EE(t){const e=[];return yo(t.fields,((r,n)=>{const s=new xn([r]);if(w0(n)){const i=EE(n.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)})),new Ts(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e,r,n,s,i,o,c){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Pn(e,0,dt.min(),dt.min(),dt.min(),as.empty(),0)}static newFoundDocument(e,r,n,s){return new Pn(e,1,r,dt.min(),n,s,0)}static newNoDocument(e,r){return new Pn(e,2,r,dt.min(),dt.min(),as.empty(),0)}static newUnknownDocument(e,r){return new Pn(e,3,r,dt.min(),dt.min(),as.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=as.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=as.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=dt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e,r){this.position=e,this.inclusive=r}}function v2(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?n=et.comparator(et.fromName(o.referenceValue),r.key):n=Cc(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function _2(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ui(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,r="asc"){this.field=e,this.dir=r}}function yI(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{}class zr extends TE{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new EI(e,r,n):r==="array-contains"?new kI(e,n):r==="in"?new AI(e,n):r==="not-in"?new CI(e,n):r==="array-contains-any"?new II(e,n):new zr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new TI(e,n):new SI(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Cc(r,this.value)):r!==null&&ho(this.value)===ho(r)&&this.matchesComparison(Cc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return at(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ui extends TE{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new ui(e,r)}matches(e){return SE(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function SE(t){return t.op==="and"}function kE(t){return wI(t)&&SE(t)}function wI(t){for(const e of t.filters)if(e instanceof ui)return!1;return!0}function rg(t){if(t instanceof zr)return t.field.canonicalString()+t.op.toString()+Ic(t.value);if(kE(t))return t.filters.map((e=>rg(e))).join(",");{const e=t.filters.map((r=>rg(r))).join(",");return`${t.op}(${e})`}}function AE(t,e){return t instanceof zr?(function(n,s){return s instanceof zr&&n.op===s.op&&n.field.isEqual(s.field)&&Ui(n.value,s.value)})(t,e):t instanceof ui?(function(n,s){return s instanceof ui&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((i,o,c)=>i&&AE(o,s.filters[c])),!0):!1})(t,e):void at(19439)}function CE(t){return t instanceof zr?(function(r){return`${r.field.canonicalString()} ${r.op} ${Ic(r.value)}`})(t):t instanceof ui?(function(r){return r.op.toString()+" {"+r.getFilters().map(CE).join(" ,")+"}"})(t):"Filter"}class EI extends zr{constructor(e,r,n){super(e,r,n),this.key=et.fromName(n.referenceValue)}matches(e){const r=et.comparator(e.key,this.key);return this.matchesComparison(r)}}class TI extends zr{constructor(e,r){super(e,"in",r),this.keys=IE("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class SI extends zr{constructor(e,r){super(e,"not-in",r),this.keys=IE("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function IE(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map((n=>et.fromName(n.referenceValue)))}class kI extends zr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Hg(r)&&cf(r.arrayValue,this.value)}}class AI extends zr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&cf(this.value.arrayValue,r)}}class CI extends zr{constructor(e,r){super(e,"not-in",r)}matches(e){if(cf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!cf(this.value.arrayValue,r)}}class II extends zr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Hg(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>cf(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e,r=null,n=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.Te=null}}function y2(t,e=null,r=[],n=[],s=null,i=null,o=null){return new FI(t,e,r,n,s,i,o)}function $g(t){const e=mt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>rg(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(i){return i.field.canonicalString()+i.dir})(n))).join(","),pd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>Ic(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>Ic(n))).join(",")),e.Te=r}return e.Te}function Gg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!yI(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!AE(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!_2(t.startAt,e.startAt)&&_2(t.endAt,e.endAt)}function ng(t){return et.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e,r=null,n=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function bI(t,e,r,n,s,i,o,c){return new Uc(t,e,r,n,s,i,o,c)}function gd(t){return new Uc(t)}function w2(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function FE(t){return t.collectionGroup!==null}function zu(t){const e=mt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Yr(xn.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new uf(i,n))})),r.has(xn.keyField().canonicalString())||e.Ie.push(new uf(xn.keyField(),n))}return e.Ie}function Li(t){const e=mt(t);return e.Ee||(e.Ee=NI(e,zu(t))),e.Ee}function NI(t,e){if(t.limitType==="F")return y2(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new uf(s.field,i)}));const r=t.endAt?new M0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new M0(t.startAt.position,t.startAt.inclusive):null;return y2(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function sg(t,e){const r=t.filters.concat([e]);return new Uc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function ig(t,e,r){return new Uc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function xd(t,e){return Gg(Li(t),Li(e))&&t.limitType===e.limitType}function bE(t){return`${$g(Li(t))}|lt:${t.limitType}`}function lc(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((s=>CE(s))).join(", ")}]`),pd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((s=>Ic(s))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((s=>Ic(s))).join(",")),`Target(${n})`})(Li(t))}; limitType=${t.limitType})`}function vd(t,e){return e.isFoundDocument()&&(function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):et.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)})(t,e)&&(function(n,s){for(const i of zu(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(t,e)&&(function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0})(t,e)&&(function(n,s){return!(n.startAt&&!(function(o,c,u){const h=v2(o,c,u);return o.inclusive?h<=0:h<0})(n.startAt,zu(n),s)||n.endAt&&!(function(o,c,u){const h=v2(o,c,u);return o.inclusive?h>=0:h>0})(n.endAt,zu(n),s))})(t,e)}function RI(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function NE(t){return(e,r)=>{let n=!1;for(const s of zu(t)){const i=DI(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function DI(t,e,r){const n=t.field.isKeyField()?et.comparator(e.key,r.key):(function(i,o,c){const u=o.data.field(i),h=c.data.field(i);return u!==null&&h!==null?Cc(u,h):at(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return at(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){yo(this.inner,((r,n)=>{for(const[s,i]of n)e(s,i)}))}isEmpty(){return pE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PI=new _r(et.comparator);function wa(){return PI}const RE=new _r(et.comparator);function Du(...t){let e=RE;for(const r of t)e=e.insert(r.key,r);return e}function DE(t){let e=RE;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function qo(){return Wu()}function PE(){return Wu()}function Wu(){return new xl((t=>t.toString()),((t,e)=>t.isEqual(e)))}const OI=new _r(et.comparator),LI=new Yr(et.comparator);function Ct(...t){let e=LI;for(const r of t)e=e.add(r);return e}const MI=new Yr(At);function BI(){return MI}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:P0(e)?"-0":e}}function OE(t){return{integerValue:""+t}}function VI(t,e){return hI(e)?OE(e):Kg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(){this._=void 0}}function jI(t,e,r){return t instanceof ff?(function(s,i){const o={fields:{[xE]:{stringValue:gE},[_E]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Wg(i)&&(i=md(i)),i&&(o.fields[vE]=i),{mapValue:o}})(r,e):t instanceof hf?ME(t,e):t instanceof df?BE(t,e):(function(s,i){const o=LE(s,i),c=E2(o)+E2(s.Ae);return tg(o)&&tg(s.Ae)?OE(c):Kg(s.serializer,c)})(t,e)}function UI(t,e,r){return t instanceof hf?ME(t,e):t instanceof df?BE(t,e):r}function LE(t,e){return t instanceof B0?(function(n){return tg(n)||(function(i){return!!i&&"doubleValue"in i})(n)})(e)?e:{integerValue:0}:null}class ff extends _d{}class hf extends _d{constructor(e){super(),this.elements=e}}function ME(t,e){const r=VE(e);for(const n of t.elements)r.some((s=>Ui(s,n)))||r.push(n);return{arrayValue:{values:r}}}class df extends _d{constructor(e){super(),this.elements=e}}function BE(t,e){let r=VE(e);for(const n of t.elements)r=r.filter((s=>!Ui(s,n)));return{arrayValue:{values:r}}}class B0 extends _d{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function E2(t){return br(t.integerValue||t.doubleValue)}function VE(t){return Hg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(e,r){this.field=e,this.transform=r}}function WI(t,e){return t.field.isEqual(e.field)&&(function(n,s){return n instanceof hf&&s instanceof hf||n instanceof df&&s instanceof df?Ac(n.elements,s.elements,Ui):n instanceof B0&&s instanceof B0?Ui(n.Ae,s.Ae):n instanceof ff&&s instanceof ff})(t.transform,e.transform)}class HI{constructor(e,r){this.version=e,this.transformResults=r}}class Kn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Kn}static exists(e){return new Kn(void 0,e)}static updateTime(e){return new Kn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function E0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class yd{}function jE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new wd(t.key,Kn.none()):new Rf(t.key,t.data,Kn.none());{const r=t.data,n=as.empty();let s=new Yr(xn.comparator);for(let i of e.fields)if(!s.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),s=s.add(i)}return new wo(t.key,n,new Ts(s.toArray()),Kn.none())}}function $I(t,e,r){t instanceof Rf?(function(s,i,o){const c=s.value.clone(),u=S2(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(t,e,r):t instanceof wo?(function(s,i,o){if(!E0(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=S2(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(UE(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(t,e,r):(function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,r)}function Hu(t,e,r,n){return t instanceof Rf?(function(i,o,c,u){if(!E0(i.precondition,o))return c;const h=i.value.clone(),d=k2(i.fieldTransforms,u,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(t,e,r,n):t instanceof wo?(function(i,o,c,u){if(!E0(i.precondition,o))return c;const h=k2(i.fieldTransforms,u,o),d=o.data;return d.setAll(UE(i)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((g=>g.field)))})(t,e,r,n):(function(i,o,c){return E0(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(t,e,r)}function GI(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=LE(n.transform,s||null);i!=null&&(r===null&&(r=as.empty()),r.set(n.field,i))}return r||null}function T2(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Ac(n,s,((i,o)=>WI(i,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Rf extends yd{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class wo extends yd{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function UE(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function S2(t,e,r){const n=new Map;Wt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);n.set(i.field,UI(o,c,r[s]))}return n}function k2(t,e,r){const n=new Map;for(const s of t){const i=s.transform,o=r.data.field(s.field);n.set(s.field,jI(i,o,e))}return n}class wd extends yd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class KI extends yd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&$I(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Hu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Hu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=PE();return this.mutations.forEach((s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=r.has(s.key)?null:c;const u=jE(o,c);u!==null&&n.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(dt.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Ct())}isEqual(e){return this.batchId===e.batchId&&Ac(this.mutations,e.mutations,((r,n)=>T2(r,n)))&&Ac(this.baseMutations,e.baseMutations,((r,n)=>T2(r,n)))}}class qg{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){Wt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=(function(){return OI})();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,n[o].version);return new qg(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Br,Nt;function QI(t){switch(t){case we.OK:return at(64938);case we.CANCELLED:case we.UNKNOWN:case we.DEADLINE_EXCEEDED:case we.RESOURCE_EXHAUSTED:case we.INTERNAL:case we.UNAVAILABLE:case we.UNAUTHENTICATED:return!1;case we.INVALID_ARGUMENT:case we.NOT_FOUND:case we.ALREADY_EXISTS:case we.PERMISSION_DENIED:case we.FAILED_PRECONDITION:case we.ABORTED:case we.OUT_OF_RANGE:case we.UNIMPLEMENTED:case we.DATA_LOSS:return!0;default:return at(15467,{code:t})}}function zE(t){if(t===void 0)return ya("GRPC error has no .code"),we.UNKNOWN;switch(t){case Br.OK:return we.OK;case Br.CANCELLED:return we.CANCELLED;case Br.UNKNOWN:return we.UNKNOWN;case Br.DEADLINE_EXCEEDED:return we.DEADLINE_EXCEEDED;case Br.RESOURCE_EXHAUSTED:return we.RESOURCE_EXHAUSTED;case Br.INTERNAL:return we.INTERNAL;case Br.UNAVAILABLE:return we.UNAVAILABLE;case Br.UNAUTHENTICATED:return we.UNAUTHENTICATED;case Br.INVALID_ARGUMENT:return we.INVALID_ARGUMENT;case Br.NOT_FOUND:return we.NOT_FOUND;case Br.ALREADY_EXISTS:return we.ALREADY_EXISTS;case Br.PERMISSION_DENIED:return we.PERMISSION_DENIED;case Br.FAILED_PRECONDITION:return we.FAILED_PRECONDITION;case Br.ABORTED:return we.ABORTED;case Br.OUT_OF_RANGE:return we.OUT_OF_RANGE;case Br.UNIMPLEMENTED:return we.UNIMPLEMENTED;case Br.DATA_LOSS:return we.DATA_LOSS;default:return at(39323,{code:t})}}(Nt=Br||(Br={}))[Nt.OK=0]="OK",Nt[Nt.CANCELLED=1]="CANCELLED",Nt[Nt.UNKNOWN=2]="UNKNOWN",Nt[Nt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Nt[Nt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Nt[Nt.NOT_FOUND=5]="NOT_FOUND",Nt[Nt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Nt[Nt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Nt[Nt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Nt[Nt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Nt[Nt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Nt[Nt.ABORTED=10]="ABORTED",Nt[Nt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Nt[Nt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Nt[Nt.INTERNAL=13]="INTERNAL",Nt[Nt.UNAVAILABLE=14]="UNAVAILABLE",Nt[Nt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI=new oo([4294967295,4294967295],0);function A2(t){const e=JI().encode(t),r=new nE;return r.update(e),new Uint8Array(r.digest())}function C2(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new oo([r,n],0),new oo([s,i],0)]}class Xg{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Pu(`Invalid padding: ${r}`);if(n<0)throw new Pu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Pu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Pu(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=oo.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(oo.fromNumber(n)));return s.compare(ZI)===1&&(s=new oo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=A2(e),[n,s]=C2(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,s,i);if(!this.we(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Xg(i,s,r);return n.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const r=A2(e),[n,s]=C2(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,s,i);this.Se(o)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Pu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Df.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Ed(dt.min(),s,new _r(At),wa(),Ct())}}class Df{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Df(n,r,Ct(),Ct(),Ct())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class WE{constructor(e,r){this.targetId=e,this.Ce=r}}class HE{constructor(e,r,n=_n.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class I2{constructor(){this.ve=0,this.Fe=F2(),this.Me=_n.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ct(),r=Ct(),n=Ct();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:at(38017,{changeType:i})}})),new Df(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=F2()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Wt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class eF{constructor(e){this.Ge=e,this.ze=new Map,this.je=wa(),this.Je=i0(),this.He=i0(),this.Ye=new _r(At)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:at(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,s)=>{this.rt(s)&&r(s)}))}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const i=s.target;if(ng(i))if(n===0){const o=new et(i.path);this.et(r,o,Pn.newNoDocument(o,dt.min()))}else Wt(n===1,20013,{expectedCount:n});else{const o=this._t(r);if(o!==n){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let o,c;try{o=fo(n).toUint8Array()}catch(u){if(u instanceof mE)return kc("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Xg(o,s,i)}catch(u){return kc(u instanceof Pu?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach((i=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(r,i,null),s++)})),s}Tt(e){const r=new Map;this.ze.forEach(((i,o)=>{const c=this.ot(o);if(c){if(i.current&&ng(c.target)){const u=new et(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Pn.newNoDocument(u,e))}i.Be&&(r.set(o,i.ke()),i.qe())}}));let n=Ct();this.He.forEach(((i,o)=>{let c=!0;o.forEachWhile((u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(n=n.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const s=new Ed(e,r,this.Ye,this.je,n);return this.je=wa(),this.Je=i0(),this.He=i0(),this.Ye=new _r(At),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new I2,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Yr(At),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Yr(At),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ge("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new I2),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function i0(){return new _r(et.comparator)}function F2(){return new _r(et.comparator)}const tF={asc:"ASCENDING",desc:"DESCENDING"},rF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},nF={and:"AND",or:"OR"};class sF{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function ag(t,e){return t.useProto3Json||pd(e)?e:{value:e}}function V0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $E(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function iF(t,e){return V0(t,e.toTimestamp())}function Mi(t){return Wt(!!t,49232),dt.fromTimestamp((function(r){const n=uo(r);return new ar(n.seconds,n.nanos)})(t))}function Yg(t,e){return og(t,e).canonicalString()}function og(t,e){const r=(function(s){return new tr(["projects",s.projectId,"databases",s.database])})(t).child("documents");return e===void 0?r:r.child(e)}function GE(t){const e=tr.fromString(t);return Wt(QE(e),10190,{key:e.toString()}),e}function lg(t,e){return Yg(t.databaseId,e.path)}function Tm(t,e){const r=GE(e);if(r.get(1)!==t.databaseId.projectId)throw new He(we.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new He(we.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new et(qE(r))}function KE(t,e){return Yg(t.databaseId,e)}function aF(t){const e=GE(t);return e.length===4?tr.emptyPath():qE(e)}function cg(t){return new tr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function qE(t){return Wt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function b2(t,e,r){return{name:lg(t,e),fields:r.value.mapValue.fields}}function oF(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:at(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(Wt(d===void 0||typeof d=="string",58123),_n.fromBase64String(d||"")):(Wt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),_n.fromUint8Array(d||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(h){const d=h.code===void 0?we.UNKNOWN:zE(h.code);return new He(d,h.message||"")})(o);r=new HE(n,s,i,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Tm(t,n.document.name),i=Mi(n.document.updateTime),o=n.document.createTime?Mi(n.document.createTime):dt.min(),c=new as({mapValue:{fields:n.document.fields}}),u=Pn.newFoundDocument(s,i,o,c),h=n.targetIds||[],d=n.removedTargetIds||[];r=new T0(h,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Tm(t,n.document),i=n.readTime?Mi(n.readTime):dt.min(),o=Pn.newNoDocument(s,i),c=n.removedTargetIds||[];r=new T0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Tm(t,n.document),i=n.removedTargetIds||[];r=new T0([],i,s,null)}else{if(!("filter"in e))return at(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,o=new YI(s,i),c=n.targetId;r=new WE(c,o)}}return r}function lF(t,e){let r;if(e instanceof Rf)r={update:b2(t,e.key,e.value)};else if(e instanceof wd)r={delete:lg(t,e.key)};else if(e instanceof wo)r={update:b2(t,e.key,e.data),updateMask:xF(e.fieldMask)};else{if(!(e instanceof KI))return at(16599,{Vt:e.type});r={verify:lg(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(i,o){const c=o.transform;if(c instanceof ff)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof hf)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof df)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof B0)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw at(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:iF(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:at(27497)})(t,e.precondition)),r}function cF(t,e){return t&&t.length>0?(Wt(e!==void 0,14353),t.map((r=>(function(s,i){let o=s.updateTime?Mi(s.updateTime):Mi(i);return o.isEqual(dt.min())&&(o=Mi(i)),new HI(o,s.transformResults||[])})(r,e)))):[]}function uF(t,e){return{documents:[KE(t,e.path)]}}function fF(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=KE(t,s);const i=(function(h){if(h.length!==0)return YE(ui.create(h,"and"))})(e.filters);i&&(r.structuredQuery.where=i);const o=(function(h){if(h.length!==0)return h.map((d=>(function(x){return{field:cc(x.field),direction:pF(x.dir)}})(d)))})(e.orderBy);o&&(r.structuredQuery.orderBy=o);const c=ag(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:r,parent:s}}function hF(t){let e=aF(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Wt(n===1,65062);const d=r.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];r.where&&(i=(function(g){const x=XE(g);return x instanceof ui&&kE(x)?x.getFilters():[x]})(r.where));let o=[];r.orderBy&&(o=(function(g){return g.map((x=>(function(k){return new uf(uc(k.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(x)))})(r.orderBy));let c=null;r.limit&&(c=(function(g){let x;return x=typeof g=="object"?g.value:g,pd(x)?null:x})(r.limit));let u=null;r.startAt&&(u=(function(g){const x=!!g.before,y=g.values||[];return new M0(y,x)})(r.startAt));let h=null;return r.endAt&&(h=(function(g){const x=!g.before,y=g.values||[];return new M0(y,x)})(r.endAt)),bI(e,s,o,i,c,"F",u,h)}function dF(t,e){const r=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return at(28987,{purpose:s})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function XE(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=uc(r.unaryFilter.field);return zr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=uc(r.unaryFilter.field);return zr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=uc(r.unaryFilter.field);return zr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=uc(r.unaryFilter.field);return zr.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return at(61313);default:return at(60726)}})(t):t.fieldFilter!==void 0?(function(r){return zr.create(uc(r.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return at(58110);default:return at(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return ui.create(r.compositeFilter.filters.map((n=>XE(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return at(1026)}})(r.compositeFilter.op))})(t):at(30097,{filter:t})}function pF(t){return tF[t]}function mF(t){return rF[t]}function gF(t){return nF[t]}function cc(t){return{fieldPath:t.canonicalString()}}function uc(t){return xn.fromServerFormat(t.fieldPath)}function YE(t){return t instanceof zr?(function(r){if(r.op==="=="){if(x2(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NAN"}};if(g2(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(x2(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NOT_NAN"}};if(g2(r.value))return{unaryFilter:{field:cc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cc(r.field),op:mF(r.op),value:r.value}}})(t):t instanceof ui?(function(r){const n=r.getFilters().map((s=>YE(s)));return n.length===1?n[0]:{compositeFilter:{op:gF(r.op),filters:n}}})(t):at(54877,{filter:t})}function xF(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function QE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,r,n,s,i=dt.min(),o=dt.min(),c=_n.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new to(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vF{constructor(e){this.yt=e}}function _F(t){const e=hF({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ig(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yF{constructor(){this.Cn=new wF}addToCollectionParentIndex(e,r){return this.Cn.add(r),Ae.resolve()}getCollectionParents(e,r){return Ae.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Ae.resolve()}deleteFieldIndex(e,r){return Ae.resolve()}deleteAllFieldIndexes(e){return Ae.resolve()}createTargetIndexes(e,r){return Ae.resolve()}getDocumentsMatchingTarget(e,r){return Ae.resolve(null)}getIndexType(e,r){return Ae.resolve(0)}getFieldIndexes(e,r){return Ae.resolve([])}getNextCollectionGroupToUpdate(e){return Ae.resolve(null)}getMinOffset(e,r){return Ae.resolve(co.min())}getMinOffsetFromCollectionGroup(e,r){return Ae.resolve(co.min())}updateCollectionGroup(e,r,n){return Ae.resolve()}updateIndexEntries(e,r){return Ae.resolve()}}class wF{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Yr(tr.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Yr(tr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},JE=41943040;class is{static withCacheSize(e){return new is(e,is.DEFAULT_COLLECTION_PERCENTILE,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */is.DEFAULT_COLLECTION_PERCENTILE=10,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,is.DEFAULT=new is(JE,is.DEFAULT_COLLECTION_PERCENTILE,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),is.DISABLED=new is(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Fc(0)}static cr(){return new Fc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R2="LruGarbageCollector",EF=1048576;function D2([t,e],[r,n]){const s=At(t,r);return s===0?At(e,n):s}class TF{constructor(e){this.Ir=e,this.buffer=new Yr(D2),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();D2(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class SF{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ge(R2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){jc(r)?Ge(R2,"Ignoring IndexedDB error during garbage collection: ",r):await Vc(r)}await this.Vr(3e5)}))}}class kF{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return Ae.resolve(dd.ce);const n=new TF(r);return this.mr.forEachTarget(e,(s=>n.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>n.Ar(s))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ge("LruGarbageCollector","Garbage collection skipped; disabled"),Ae.resolve(N2)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),N2):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,i,o,c,u,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(Ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),s=this.params.maximumSequenceNumbersToCollect):s=g,o=Date.now(),this.nthSequenceNumber(e,s)))).next((g=>(n=g,c=Date.now(),this.removeTargets(e,n,r)))).next((g=>(i=g,u=Date.now(),this.removeOrphanedDocuments(e,n)))).next((g=>(h=Date.now(),oc()<=kt.DEBUG&&Ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-d}ms`),Ae.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:g}))))}}function AF(t,e){return new kF(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(){this.changes=new xl((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Pn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ae.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,r)))).next((s=>(n!==null&&Hu(n.mutation,s,Ts.empty(),ar.now()),s)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Ct()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Ct()){const s=qo();return this.populateOverlays(e,s,r).next((()=>this.computeViews(e,r,s,n).next((i=>{let o=Du();return i.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,r){const n=qo();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Ct())))}populateOverlays(e,r,n){const s=[];return n.forEach((i=>{r.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((o,c)=>{r.set(o,c)}))}))}computeViews(e,r,n,s){let i=wa();const o=Wu(),c=(function(){return Wu()})();return r.forEach(((u,h)=>{const d=n.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof wo)?i=i.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),Hu(d.mutation,h,d.mutation.getFieldMask(),ar.now())):o.set(h.key,Ts.empty())})),this.recalculateAndSaveOverlays(e,i).next((u=>(u.forEach(((h,d)=>o.set(h,d))),r.forEach(((h,d)=>c.set(h,new IF(d,o.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,r){const n=Wu();let s=new _r(((o,c)=>o-c)),i=Ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((o=>{for(const c of o)c.keys().forEach((u=>{const h=r.get(u);if(h===null)return;let d=n.get(u)||Ts.empty();d=c.applyToLocalView(h,d),n.set(u,d);const g=(s.get(c.batchId)||Ct()).add(u);s=s.insert(c.batchId,g)}))})).next((()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,d=u.value,g=PE();d.forEach((x=>{if(!i.has(x)){const y=jE(r.get(x),n.get(x));y!==null&&g.set(x,y),i=i.add(x)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return Ae.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,s){return(function(o){return et.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):FE(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next((i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):Ae.resolve(qo());let c=af,u=i;return o.next((h=>Ae.forEach(h,((d,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(d)?Ae.resolve():this.remoteDocumentCache.getEntry(e,d).next((x=>{u=u.insert(d,x)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,u,h,Ct()))).next((d=>({batchId:c,changes:DE(d)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new et(r)).next((n=>{let s=Du();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let o=Du();return this.indexManager.getCollectionParents(e,i).next((c=>Ae.forEach(c,(u=>{const h=(function(g,x){return new Uc(x,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(r,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,n,s).next((d=>{d.forEach(((g,x)=>{o=o.insert(g,x)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s)))).next((o=>{i.forEach(((u,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Pn.newInvalidDocument(d)))}));let c=Du();return o.forEach(((u,h)=>{const d=i.get(u);d!==void 0&&Hu(d.mutation,h,Ts.empty(),ar.now()),vd(r,h)&&(c=c.insert(u,h))})),c}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Ae.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(s){return{id:s.id,version:s.version,createTime:Mi(s.createTime)}})(r)),Ae.resolve()}getNamedQuery(e,r){return Ae.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(s){return{name:s.name,query:_F(s.bundledQuery),readTime:Mi(s.readTime)}})(r)),Ae.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(){this.overlays=new _r(et.comparator),this.qr=new Map}getOverlay(e,r){return Ae.resolve(this.overlays.get(r))}getOverlays(e,r){const n=qo();return Ae.forEach(r,(s=>this.getOverlay(e,s).next((i=>{i!==null&&n.set(s,i)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((s,i)=>{this.St(e,r,i)})),Ae.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(n)),Ae.resolve()}getOverlaysForCollection(e,r,n){const s=qo(),i=r.length+1,o=new et(r.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>n&&s.set(u.getKey(),u)}return Ae.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new _r(((h,d)=>h-d));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let d=i.get(h.largestBatchId);d===null&&(d=qo(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=qo(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,d)=>c.set(h,d))),!(c.size()>=s)););return Ae.resolve(c)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new XI(r,n));let i=this.qr.get(r);i===void 0&&(i=Ct(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(){this.sessionToken=_n.EMPTY_BYTE_STRING}getSessionToken(e){return Ae.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Ae.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(){this.Qr=new Yr(nn.$r),this.Ur=new Yr(nn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new nn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new nn(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new et(new tr([])),n=new nn(r,e),s=new nn(r,e+1),i=[];return this.Ur.forEachInRange([n,s],(o=>{this.Gr(o),i.push(o.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new et(new tr([])),n=new nn(r,e),s=new nn(r,e+1);let i=Ct();return this.Ur.forEachInRange([n,s],(o=>{i=i.add(o.key)})),i}containsKey(e){const r=new nn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class nn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return et.comparator(e.key,r.key)||At(e.Yr,r.Yr)}static Kr(e,r){return At(e.Yr,r.Yr)||et.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Yr(nn.$r)}checkEmpty(e){return Ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new qI(i,r,n,s);this.mutationQueue.push(o);for(const c of s)this.Zr=this.Zr.add(new nn(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Ae.resolve(o)}lookupMutationBatch(e,r){return Ae.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),i=s<0?0:s;return Ae.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Ae.resolve(this.mutationQueue.length===0?zg:this.tr-1)}getAllMutationBatches(e){return Ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new nn(r,0),s=new nn(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],(o=>{const c=this.Xr(o.Yr);i.push(c)})),Ae.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Yr(At);return r.forEach((s=>{const i=new nn(s,0),o=new nn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],(c=>{n=n.add(c.Yr)}))})),Ae.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;et.isDocumentKey(i)||(i=i.child(""));const o=new nn(new et(i),0);let c=new Yr(At);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===s&&(c=c.add(u.Yr)),!0)}),o),Ae.resolve(this.ti(c))}ti(e){const r=[];return e.forEach((n=>{const s=this.Xr(n);s!==null&&r.push(s)})),r}removeMutationBatch(e,r){Wt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Ae.forEach(r.mutations,(s=>{const i=new nn(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new nn(r,0),s=this.Zr.firstAfterOrEqual(n);return Ae.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ae.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PF{constructor(e){this.ri=e,this.docs=(function(){return new _r(et.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,o=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Ae.resolve(n?n.document.mutableCopy():Pn.newInvalidDocument(r))}getEntries(e,r){let n=wa();return r.forEach((s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Pn.newInvalidDocument(s))})),Ae.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=wa();const o=r.path,c=new et(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:d}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||lI(oI(d),n)<=0||(s.has(d.key)||vd(r,d))&&(i=i.insert(d.key,d.mutableCopy()))}return Ae.resolve(i)}getAllFromCollectionGroup(e,r,n,s){at(9500)}ii(e,r){return Ae.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new OF(this)}getSize(e){return Ae.resolve(this.size)}}class OF extends CF{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)})),Ae.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(e){this.persistence=e,this.si=new xl((r=>$g(r)),Gg),this.lastRemoteSnapshotVersion=dt.min(),this.highestTargetId=0,this.oi=0,this._i=new Qg,this.targetCount=0,this.ai=Fc.ur()}forEachTarget(e,r){return this.si.forEach(((n,s)=>r(s))),Ae.resolve()}getLastRemoteSnapshotVersion(e){return Ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ae.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ae.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Ae.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Fc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Ae.resolve()}updateTargetData(e,r){return this.Pr(r),Ae.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Ae.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),Ae.waitFor(i).next((()=>s))}getTargetCount(e){return Ae.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Ae.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Ae.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach((o=>{i.push(s.markPotentiallyOrphaned(e,o))})),Ae.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Ae.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Ae.resolve(n)}containsKey(e,r){return Ae.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e,r){this.ui={},this.overlays={},this.ci=new dd(0),this.li=!1,this.li=!0,this.hi=new RF,this.referenceDelegate=e(this),this.Pi=new LF(this),this.indexManager=new yF,this.remoteDocumentCache=(function(s){return new PF(s)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new vF(r),this.Ii=new bF(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new NF,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new DF(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ge("MemoryPersistence","Starting transaction:",e);const s=new MF(this.ci.next());return this.referenceDelegate.Ei(),n(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,r){return Ae.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class MF extends uI{constructor(e){super(),this.currentSequenceNumber=e}}class Jg{constructor(e){this.persistence=e,this.Ri=new Qg,this.Vi=null}static mi(e){return new Jg(e)}get fi(){if(this.Vi)return this.Vi;throw at(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Ae.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Ae.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Ae.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((s=>this.fi.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ae.forEach(this.fi,(n=>{const s=et.fromPath(n);return this.gi(e,s).next((i=>{i||r.removeEntry(s,dt.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return Ae.or([()=>Ae.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class j0{constructor(e,r){this.persistence=e,this.pi=new xl((n=>dI(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=AF(this,r)}static mi(e,r){return new j0(e,r)}Ei(){}di(e){return Ae.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((s=>n+s))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return Ae.forEach(this.pi,((n,s)=>this.br(e,n,s).next((i=>i?Ae.resolve():r(s)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(o=>this.br(e,o,r).next((c=>{c||(n++,i.removeEntry(o,dt.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Ae.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Ae.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Ae.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Ae.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=y0(e.data.value)),r}br(e,r,n){return Ae.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return Ae.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=Ct(),s=Ct();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Zg(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return F3()?8:fI(Bn())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.ys(e,r).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ws(e,r,s,n).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new BF;return this.Ss(e,r,o).next((c=>{if(i.result=c,this.Vs)return this.bs(e,r,o,c.size)}))})).next((()=>i.result))}bs(e,r,n,s){return n.documentReadCount<this.fs?(oc()<=kt.DEBUG&&Ge("QueryEngine","SDK will not create cache indexes for query:",lc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ae.resolve()):(oc()<=kt.DEBUG&&Ge("QueryEngine","Query:",lc(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(oc()<=kt.DEBUG&&Ge("QueryEngine","The SDK decides to create cache indexes for query:",lc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Li(r))):Ae.resolve())}ys(e,r){if(w2(r))return Ae.resolve(null);let n=Li(r);return this.indexManager.getIndexType(e,n).next((s=>s===0?null:(r.limit!==null&&s===1&&(r=ig(r,null,"F"),n=Li(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const o=Ct(...i);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,n).next((u=>{const h=this.Ds(r,c);return this.Cs(r,h,o,u.readTime)?this.ys(e,ig(r,null,"F")):this.vs(e,h,r,u)}))))})))))}ws(e,r,n,s){return w2(r)||s.isEqual(dt.min())?Ae.resolve(null):this.ps.getDocuments(e,n).next((i=>{const o=this.Ds(r,i);return this.Cs(r,o,n,s)?Ae.resolve(null):(oc()<=kt.DEBUG&&Ge("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),lc(r)),this.vs(e,o,r,aI(s,af)).next((c=>c)))}))}Ds(e,r){let n=new Yr(NE(e));return r.forEach(((s,i)=>{vd(e,i)&&(n=n.add(i))})),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,r,n){return oc()<=kt.DEBUG&&Ge("QueryEngine","Using full collection scan to execute query:",lc(r)),this.ps.getDocumentsMatchingQuery(e,r,co.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next((i=>(r.forEach((o=>{i=i.insert(o.key,o)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1="LocalStore",jF=3e8;class UF{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new _r(At),this.xs=new xl((i=>$g(i)),Gg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new FF(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function zF(t,e,r,n){return new UF(t,e,r,n)}async function eT(t,e){const r=mt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next((i=>(s=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((i=>{const o=[],c=[];let u=Ct();for(const h of s){o.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}return r.localDocuments.getDocuments(n,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:c})))}))}))}function WF(t,e){const r=mt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,h,d){const g=h.batch,x=g.keys();let y=Ae.resolve();return x.forEach((k=>{y=y.next((()=>d.getEntry(u,k))).next((w=>{const S=h.docVersions.get(k);Wt(S!==null,48541),w.version.compareTo(S)<0&&(g.applyToRemoteDocument(w,h),w.isValidDocument()&&(w.setReadTime(h.commitVersion),d.addEntry(w)))}))})),y.next((()=>c.mutationQueue.removeMutationBatch(u,g)))})(r,n,e,i).next((()=>i.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(c){let u=Ct();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u})(e)))).next((()=>r.localDocuments.getDocuments(n,s)))}))}function tT(t){const e=mt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function HF(t,e){const r=mt(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const c=[];e.targetChanges.forEach(((d,g)=>{const x=s.get(g);if(!x)return;c.push(r.Pi.removeMatchingKeys(i,d.removedDocuments,g).next((()=>r.Pi.addMatchingKeys(i,d.addedDocuments,g))));let y=x.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?y=y.withResumeToken(_n.EMPTY_BYTE_STRING,dt.min()).withLastLimboFreeSnapshotVersion(dt.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,n)),s=s.insert(g,y),(function(w,S,N){return w.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=jF?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0})(x,y,d)&&c.push(r.Pi.updateTargetData(i,y))}));let u=wa(),h=Ct();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(i,d))})),c.push($F(i,o,e.documentUpdates).next((d=>{u=d.ks,h=d.qs}))),!n.isEqual(dt.min())){const d=r.Pi.getLastRemoteSnapshotVersion(i).next((g=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n)));c.push(d)}return Ae.waitFor(c).next((()=>o.apply(i))).next((()=>r.localDocuments.getLocalViewOfDocuments(i,u,h))).next((()=>u))})).then((i=>(r.Ms=s,i)))}function $F(t,e,r){let n=Ct(),s=Ct();return r.forEach((i=>n=n.add(i))),e.getEntries(t,n).next((i=>{let o=wa();return r.forEach(((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(dt.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Ge(e1,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)})),{ks:o,qs:s}}))}function GF(t,e){const r=mt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=zg),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function KF(t,e){const r=mt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return r.Pi.getTargetData(n,e).next((i=>i?(s=i,Ae.resolve(s)):r.Pi.allocateTargetId(n).next((o=>(s=new to(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function ug(t,e,r){const n=mt(t),s=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,(o=>n.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!jc(o))throw o;Ge(e1,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function P2(t,e,r){const n=mt(t);let s=dt.min(),i=Ct();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,h,d){const g=mt(u),x=g.xs.get(d);return x!==void 0?Ae.resolve(g.Ms.get(x)):g.Pi.getTargetData(h,d)})(n,o,Li(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{i=u}))})).next((()=>n.Fs.getDocumentsMatchingQuery(o,e,r?s:dt.min(),r?i:Ct()))).next((c=>(qF(n,RI(e),c),{documents:c,Qs:i})))))}function qF(t,e,r){let n=t.Os.get(e)||dt.min();r.forEach(((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)})),t.Os.set(e,n)}class O2{constructor(){this.activeTargetIds=BI()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class XF{constructor(){this.Mo=new O2,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new O2,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2="ConnectivityMonitor";class M2{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ge(L2,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ge(L2,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a0=null;function fg(){return a0===null?a0=(function(){return 268435456+Math.round(2147483648*Math.random())})():a0++,"0x"+a0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm="RestConnection",QF={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class JF{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===O0?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,i){const o=fg(),c=this.zo(e,r.toUriEncodedString());Ge(Sm,`Sending RPC '${e}' ${o}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:h}=new URL(c),d=Lc(h);return this.Jo(e,c,u,n,d).then((g=>(Ge(Sm,`Received RPC '${e}' ${o}: `,g),g)),(g=>{throw kc(Sm,`RPC '${e}' ${o} failed with error: `,g,"url: ",c,"request:",n),g}))}Ho(e,r,n,s,i,o){return this.Go(e,r,n,s,i)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Bc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((s,i)=>e[i]=s)),n&&n.headers.forEach(((s,i)=>e[i]=s))}zo(e,r){const n=QF[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In="WebChannelConnection";class eb extends JF{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,i){const o=fg();return new Promise(((c,u)=>{const h=new sE;h.setWithCredentials(!0),h.listenOnce(iE.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case _0.NO_ERROR:const g=h.getResponseJson();Ge(In,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),c(g);break;case _0.TIMEOUT:Ge(In,`RPC '${e}' ${o} timed out`),u(new He(we.DEADLINE_EXCEEDED,"Request time out"));break;case _0.HTTP_ERROR:const x=h.getStatus();if(Ge(In,`RPC '${e}' ${o} failed with status:`,x,"response text:",h.getResponseText()),x>0){let y=h.getResponseJson();Array.isArray(y)&&(y=y[0]);const k=y==null?void 0:y.error;if(k&&k.status&&k.message){const w=(function(N){const B=N.toLowerCase().replace(/_/g,"-");return Object.values(we).indexOf(B)>=0?B:we.UNKNOWN})(k.status);u(new He(w,k.message))}else u(new He(we.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new He(we.UNAVAILABLE,"Connection failed."));break;default:at(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Ge(In,`RPC '${e}' ${o} completed.`)}}));const d=JSON.stringify(s);Ge(In,`RPC '${e}' ${o} sending request:`,s),h.send(r,"POST",d,n,15)}))}T_(e,r,n){const s=fg(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=lE(),c=oE(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const d=i.join("");Ge(In,`Creating RPC '${e}' stream ${s}: ${d}`,u);const g=o.createWebChannel(d,u);this.I_(g);let x=!1,y=!1;const k=new ZF({Yo:S=>{y?Ge(In,`Not sending because RPC '${e}' stream ${s} is closed:`,S):(x||(Ge(In,`Opening RPC '${e}' stream ${s} transport.`),g.open(),x=!0),Ge(In,`RPC '${e}' stream ${s} sending:`,S),g.send(S))},Zo:()=>g.close()}),w=(S,N,B)=>{S.listen(N,(b=>{try{B(b)}catch(j){setTimeout((()=>{throw j}),0)}}))};return w(g,Ru.EventType.OPEN,(()=>{y||(Ge(In,`RPC '${e}' stream ${s} transport opened.`),k.o_())})),w(g,Ru.EventType.CLOSE,(()=>{y||(y=!0,Ge(In,`RPC '${e}' stream ${s} transport closed`),k.a_(),this.E_(g))})),w(g,Ru.EventType.ERROR,(S=>{y||(y=!0,kc(In,`RPC '${e}' stream ${s} transport errored. Name:`,S.name,"Message:",S.message),k.a_(new He(we.UNAVAILABLE,"The operation could not be completed")))})),w(g,Ru.EventType.MESSAGE,(S=>{var N;if(!y){const B=S.data[0];Wt(!!B,16349);const b=B,j=(b==null?void 0:b.error)||((N=b[0])==null?void 0:N.error);if(j){Ge(In,`RPC '${e}' stream ${s} received error:`,j);const X=j.status;let G=(function(F){const V=Br[F];if(V!==void 0)return zE(V)})(X),A=j.message;G===void 0&&(G=we.INTERNAL,A="Unknown error status: "+X+" with message "+j.message),y=!0,k.a_(new He(G,A)),g.close()}else Ge(In,`RPC '${e}' stream ${s} received:`,B),k.u_(B)}})),w(c,aE.STAT_EVENT,(S=>{S.stat===Jm.PROXY?Ge(In,`RPC '${e}' stream ${s} detected buffering proxy`):S.stat===Jm.NOPROXY&&Ge(In,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{k.__()}),0),k}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function km(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td(t){return new sF(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(e,r,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&Ge("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2="PersistentStream";class nT{constructor(e,r,n,s,i,o,c,u){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new rT(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===we.RESOURCE_EXHAUSTED?(ya(r.toString()),ya("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===we.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===r&&this.G_(n,s)}),(n=>{e((()=>{const s=new He(we.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ge(B2,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(Ge(B2,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class tb extends nT{constructor(e,r,n,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=oF(this.serializer,e),n=(function(i){if(!("targetChange"in i))return dt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?dt.min():o.readTime?Mi(o.readTime):dt.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=cg(this.serializer),r.addTarget=(function(i,o){let c;const u=o.target;if(c=ng(u)?{documents:uF(i,u)}:{query:fF(i,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=$E(i,o.resumeToken);const h=ag(i,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(dt.min())>0){c.readTime=V0(i,o.snapshotVersion.toTimestamp());const h=ag(i,o.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const n=dF(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=cg(this.serializer),r.removeTarget=e,this.q_(r)}}class rb extends nT{constructor(e,r,n,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Wt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Wt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Wt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=cF(e.writeResults,e.commitTime),n=Mi(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=cg(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>lF(this.serializer,n)))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{}class sb extends nb{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new He(we.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Go(e,og(r,n),s,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new He(we.UNKNOWN,i.toString())}))}Ho(e,r,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,og(r,n),s,o,c,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new He(we.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class ib{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ya(r),this.aa=!1):Ge("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl="RemoteStore";class ab{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((o=>{n.enqueueAndForget((async()=>{vl(this)&&(Ge(cl,"Restarting streams for network reachability change."),await(async function(u){const h=mt(u);h.Ea.add(4),await Pf(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Sd(h)})(this))}))})),this.Ra=new ib(n,s)}}async function Sd(t){if(vl(t))for(const e of t.da)await e(!0)}async function Pf(t){for(const e of t.da)await e(!1)}function sT(t,e){const r=mt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),s1(r)?n1(r):zc(r).O_()&&r1(r,e))}function t1(t,e){const r=mt(t),n=zc(r);r.Ia.delete(e),n.O_()&&iT(r,e),r.Ia.size===0&&(n.O_()?n.L_():vl(r)&&r.Ra.set("Unknown"))}function r1(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(dt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}zc(t).Y_(e)}function iT(t,e){t.Va.Ue(e),zc(t).Z_(e)}function n1(t){t.Va=new eF({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),zc(t).start(),t.Ra.ua()}function s1(t){return vl(t)&&!zc(t).x_()&&t.Ia.size>0}function vl(t){return mt(t).Ea.size===0}function aT(t){t.Va=void 0}async function ob(t){t.Ra.set("Online")}async function lb(t){t.Ia.forEach(((e,r)=>{r1(t,e)}))}async function cb(t,e){aT(t),s1(t)?(t.Ra.ha(e),n1(t)):t.Ra.set("Unknown")}async function ub(t,e,r){if(t.Ra.set("Online"),e instanceof HE&&e.state===2&&e.cause)try{await(async function(s,i){const o=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.Va.removeTarget(c))})(t,e)}catch(n){Ge(cl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await U0(t,n)}else if(e instanceof T0?t.Va.Ze(e):e instanceof WE?t.Va.st(e):t.Va.tt(e),!r.isEqual(dt.min()))try{const n=await tT(t.localStore);r.compareTo(n)>=0&&await(function(i,o){const c=i.Va.Tt(o);return c.targetChanges.forEach(((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,h)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(_n.EMPTY_BYTE_STRING,d.snapshotVersion)),iT(i,u);const g=new to(d.target,u,h,d.sequenceNumber);r1(i,g)})),i.remoteSyncer.applyRemoteEvent(c)})(t,r)}catch(n){Ge(cl,"Failed to raise snapshot:",n),await U0(t,n)}}async function U0(t,e,r){if(!jc(e))throw e;t.Ea.add(1),await Pf(t),t.Ra.set("Offline"),r||(r=()=>tT(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ge(cl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Sd(t)}))}function oT(t,e){return e().catch((r=>U0(t,r,e)))}async function kd(t){const e=mt(t),r=po(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:zg;for(;fb(e);)try{const s=await GF(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,hb(e,s)}catch(s){await U0(e,s)}lT(e)&&cT(e)}function fb(t){return vl(t)&&t.Ta.length<10}function hb(t,e){t.Ta.push(e);const r=po(t);r.O_()&&r.X_&&r.ea(e.mutations)}function lT(t){return vl(t)&&!po(t).x_()&&t.Ta.length>0}function cT(t){po(t).start()}async function db(t){po(t).ra()}async function pb(t){const e=po(t);for(const r of t.Ta)e.ea(r.mutations)}async function mb(t,e,r){const n=t.Ta.shift(),s=qg.from(n,e,r);await oT(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await kd(t)}async function gb(t,e){e&&po(t).X_&&await(async function(n,s){if((function(o){return QI(o)&&o!==we.ABORTED})(s.code)){const i=n.Ta.shift();po(n).B_(),await oT(n,(()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s))),await kd(n)}})(t,e),lT(t)&&cT(t)}async function V2(t,e){const r=mt(t);r.asyncQueue.verifyOperationInProgress(),Ge(cl,"RemoteStore received new credentials");const n=vl(r);r.Ea.add(3),await Pf(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Sd(r)}async function xb(t,e){const r=mt(t);e?(r.Ea.delete(2),await Sd(r)):e||(r.Ea.add(2),await Pf(r),r.Ra.set("Unknown"))}function zc(t){return t.ma||(t.ma=(function(r,n,s){const i=mt(r);return i.sa(),new tb(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(t.datastore,t.asyncQueue,{Xo:ob.bind(null,t),t_:lb.bind(null,t),r_:cb.bind(null,t),H_:ub.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),s1(t)?n1(t):t.Ra.set("Unknown")):(await t.ma.stop(),aT(t))}))),t.ma}function po(t){return t.fa||(t.fa=(function(r,n,s){const i=mt(r);return i.sa(),new rb(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:db.bind(null,t),r_:gb.bind(null,t),ta:pb.bind(null,t),na:mb.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await kd(t)):(await t.fa.stop(),t.Ta.length>0&&(Ge(cl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new ma,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const o=Date.now()+n,c=new i1(e,r,o,s,i);return c.start(n),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new He(we.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function a1(t,e){if(ya("AsyncQueue",`${e}: ${t}`),jc(t))return new He(we.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{static emptySet(e){return new mc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||et.comparator(r.key,n.key):(r,n)=>et.comparator(r.key,n.key),this.keyedMap=Du(),this.sortedSet=new _r(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof mc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new mc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(){this.ga=new _r(et.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):at(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class bc{constructor(e,r,n,s,i,o,c,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,s,i){const o=[];return r.forEach((c=>{o.push({type:0,doc:c})})),new bc(e,r,mc.emptySet(r),o,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class _b{constructor(){this.queries=U2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=mt(r),i=s.queries;s.queries=U2(),i.forEach(((o,c)=>{for(const u of c.Sa)u.onError(n)}))})(this,new He(we.ABORTED,"Firestore shutting down"))}}function U2(){return new xl((t=>bE(t)),xd)}async function o1(t,e){const r=mt(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new vb,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(s,!0);break;case 1:i.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const c=a1(o,`Initialization of query '${lc(e.query)}' failed`);return void e.onError(c)}r.queries.set(s,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&c1(r)}async function l1(t,e){const r=mt(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function yb(t,e){const r=mt(t);let n=!1;for(const s of e){const i=s.query,o=r.queries.get(i);if(o){for(const c of o.Sa)c.Fa(s)&&(n=!0);o.wa=s}}n&&c1(r)}function wb(t,e,r){const n=mt(t),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(r);n.queries.delete(e)}function c1(t){t.Ca.forEach((e=>{e.next()}))}var hg,z2;(z2=hg||(hg={})).Ma="default",z2.Cache="cache";class u1{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new bc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=bc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==hg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e){this.key=e}}class fT{constructor(e){this.key=e}}class Eb{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ct(),this.mutatedKeys=Ct(),this.eu=NE(e),this.tu=new mc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new j2,s=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,g)=>{const x=s.get(d),y=vd(this.query,g)?g:null,k=!!x&&this.mutatedKeys.has(x.key),w=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let S=!1;x&&y?x.data.isEqual(y.data)?k!==w&&(n.track({type:3,doc:y}),S=!0):this.su(x,y)||(n.track({type:2,doc:y}),S=!0,(u&&this.eu(y,u)>0||h&&this.eu(y,h)<0)&&(c=!0)):!x&&y?(n.track({type:0,doc:y}),S=!0):x&&!y&&(n.track({type:1,doc:x}),S=!0,(u||h)&&(c=!0)),S&&(y?(o=o.add(y),i=w?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),n.track({type:1,doc:d})}return{tu:o,iu:n,Cs:c,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((d,g)=>(function(y,k){const w=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return at(20277,{Rt:S})}};return w(y)-w(k)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(n),s=s??!1;const c=r&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,h=u!==this.Za;return this.Za=u,o.length!==0||h?{snapshot:new bc(this.query,e.tu,i,o,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new j2,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ct(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new fT(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new uT(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=Ct();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return bc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const f1="SyncEngine";class Tb{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class Sb{constructor(e){this.key=e,this.hu=!1}}class kb{constructor(e,r,n,s,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new xl((c=>bE(c)),xd),this.Iu=new Map,this.Eu=new Set,this.du=new _r(et.comparator),this.Au=new Map,this.Ru=new Qg,this.Vu={},this.mu=new Map,this.fu=Fc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Ab(t,e,r=!0){const n=xT(t);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await hT(n,e,r,!0),s}async function Cb(t,e){const r=xT(t);await hT(r,e,!0,!1)}async function hT(t,e,r,n){const s=await KF(t.localStore,Li(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let c;return n&&(c=await Ib(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&sT(t.remoteStore,s),c}async function Ib(t,e,r,n,s){t.pu=(g,x,y)=>(async function(w,S,N,B){let b=S.view.ru(N);b.Cs&&(b=await P2(w.localStore,S.query,!1).then((({documents:A})=>S.view.ru(A,b))));const j=B&&B.targetChanges.get(S.targetId),X=B&&B.targetMismatches.get(S.targetId)!=null,G=S.view.applyChanges(b,w.isPrimaryClient,j,X);return H2(w,S.targetId,G.au),G.snapshot})(t,g,x,y);const i=await P2(t.localStore,e,!0),o=new Eb(e,i.Qs),c=o.ru(i.documents),u=Df.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),h=o.applyChanges(c,t.isPrimaryClient,u);H2(t,r,h.au);const d=new Tb(e,r,o);return t.Tu.set(e,d),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function Fb(t,e,r){const n=mt(t),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter((o=>!xd(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await ug(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),r&&t1(n.remoteStore,s.targetId),dg(n,s.targetId)})).catch(Vc)):(dg(n,s.targetId),await ug(n.localStore,s.targetId,!0))}async function bb(t,e){const r=mt(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),t1(r.remoteStore,n.targetId))}async function Nb(t,e,r){const n=Bb(t);try{const s=await(function(o,c){const u=mt(o),h=ar.now(),d=c.reduce(((y,k)=>y.add(k.key)),Ct());let g,x;return u.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let k=wa(),w=Ct();return u.Ns.getEntries(y,d).next((S=>{k=S,k.forEach(((N,B)=>{B.isValidDocument()||(w=w.add(N))}))})).next((()=>u.localDocuments.getOverlayedDocuments(y,k))).next((S=>{g=S;const N=[];for(const B of c){const b=GI(B,g.get(B.key).overlayedDocument);b!=null&&N.push(new wo(B.key,b,EE(b.value.mapValue),Kn.exists(!0)))}return u.mutationQueue.addMutationBatch(y,h,N,c)})).next((S=>{x=S;const N=S.applyToLocalDocumentSet(g,w);return u.documentOverlayCache.saveOverlays(y,S.batchId,N)}))})).then((()=>({batchId:x.batchId,changes:DE(g)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),(function(o,c,u){let h=o.Vu[o.currentUser.toKey()];h||(h=new _r(At)),h=h.insert(c,u),o.Vu[o.currentUser.toKey()]=h})(n,s.batchId,r),await Of(n,s.changes),await kd(n.remoteStore)}catch(s){const i=a1(s,"Failed to persist write");r.reject(i)}}async function dT(t,e){const r=mt(t);try{const n=await HF(r.localStore,e);e.targetChanges.forEach(((s,i)=>{const o=r.Au.get(i);o&&(Wt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Wt(o.hu,14607):s.removedDocuments.size>0&&(Wt(o.hu,42227),o.hu=!1))})),await Of(r,n,e)}catch(n){await Vc(n)}}function W2(t,e,r){const n=mt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach(((i,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(o,c){const u=mt(o);u.onlineState=c;let h=!1;u.queries.forEach(((d,g)=>{for(const x of g.Sa)x.va(c)&&(h=!0)})),h&&c1(u)})(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Rb(t,e,r){const n=mt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),i=s&&s.key;if(i){let o=new _r(et.comparator);o=o.insert(i,Pn.newNoDocument(i,dt.min()));const c=Ct().add(i),u=new Ed(dt.min(),new Map,new _r(At),o,c);await dT(n,u),n.du=n.du.remove(i),n.Au.delete(e),h1(n)}else await ug(n.localStore,e,!1).then((()=>dg(n,e,r))).catch(Vc)}async function Db(t,e){const r=mt(t),n=e.batch.batchId;try{const s=await WF(r.localStore,e);mT(r,n,null),pT(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Of(r,s)}catch(s){await Vc(s)}}async function Pb(t,e,r){const n=mt(t);try{const s=await(function(o,c){const u=mt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return u.mutationQueue.lookupMutationBatch(h,c).next((g=>(Wt(g!==null,37113),d=g.keys(),u.mutationQueue.removeMutationBatch(h,g)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,d,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>u.localDocuments.getDocuments(h,d)))}))})(n.localStore,e);mT(n,e,r),pT(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Of(n,s)}catch(s){await Vc(s)}}function pT(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function mT(t,e,r){const n=mt(t);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function dg(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||gT(t,n)}))}function gT(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(t1(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),h1(t))}function H2(t,e,r){for(const n of r)n instanceof uT?(t.Ru.addReference(n.key,e),Ob(t,n)):n instanceof fT?(Ge(f1,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||gT(t,n.key)):at(19791,{wu:n})}function Ob(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ge(f1,"New document in limbo: "+r),t.Eu.add(n),h1(t))}function h1(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new et(tr.fromString(e)),n=t.fu.next();t.Au.set(n,new Sb(r)),t.du=t.du.insert(r,n),sT(t.remoteStore,new to(Li(gd(r.path)),n,"TargetPurposeLimboResolution",dd.ce))}}async function Of(t,e,r){const n=mt(t),s=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((c,u)=>{o.push(n.pu(u,e,r).then((h=>{var d;if((h||r)&&n.isPrimaryClient){const g=h?!h.fromCache:(d=r==null?void 0:r.targetChanges.get(u.targetId))==null?void 0:d.current;n.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){s.push(h);const g=Zg.As(u.targetId,h);i.push(g)}})))})),await Promise.all(o),n.Pu.H_(s),await(async function(u,h){const d=mt(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>Ae.forEach(h,(x=>Ae.forEach(x.Es,(y=>d.persistence.referenceDelegate.addReference(g,x.targetId,y))).next((()=>Ae.forEach(x.ds,(y=>d.persistence.referenceDelegate.removeReference(g,x.targetId,y)))))))))}catch(g){if(!jc(g))throw g;Ge(e1,"Failed to update sequence numbers: "+g)}for(const g of h){const x=g.targetId;if(!g.fromCache){const y=d.Ms.get(x),k=y.snapshotVersion,w=y.withLastLimboFreeSnapshotVersion(k);d.Ms=d.Ms.insert(x,w)}}})(n.localStore,i))}async function Lb(t,e){const r=mt(t);if(!r.currentUser.isEqual(e)){Ge(f1,"User change. New user:",e.toKey());const n=await eT(r.localStore,e);r.currentUser=e,(function(i,o){i.mu.forEach((c=>{c.forEach((u=>{u.reject(new He(we.CANCELLED,o))}))})),i.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Of(r,n.Ls)}}function Mb(t,e){const r=mt(t),n=r.Au.get(e);if(n&&n.hu)return Ct().add(n.key);{let s=Ct();const i=r.Iu.get(e);if(!i)return s;for(const o of i){const c=r.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function xT(t){const e=mt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=dT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Mb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Rb.bind(null,e),e.Pu.H_=yb.bind(null,e.eventManager),e.Pu.yu=wb.bind(null,e.eventManager),e}function Bb(t){const e=mt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Db.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Pb.bind(null,e),e}class z0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Td(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return zF(this.persistence,new VF,e.initialUser,this.serializer)}Cu(e){return new ZE(Jg.mi,this.serializer)}Du(e){return new XF}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}z0.provider={build:()=>new z0};class Vb extends z0{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Wt(this.persistence.referenceDelegate instanceof j0,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new SF(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?is.withCacheSize(this.cacheSizeBytes):is.DEFAULT;return new ZE((n=>j0.mi(n,r)),this.serializer)}}class pg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>W2(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Lb.bind(null,this.syncEngine),await xb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new _b})()}createDatastore(e){const r=Td(e.databaseInfo.databaseId),n=(function(i){return new eb(i)})(e.databaseInfo);return(function(i,o,c,u){return new sb(i,o,c,u)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,s,i,o,c){return new ab(n,s,i,o,c)})(this.localStore,this.datastore,e.asyncQueue,(r=>W2(this.syncEngine,r,0)),(function(){return M2.v()?new M2:new YF})())}createSyncEngine(e,r){return(function(s,i,o,c,u,h,d){const g=new kb(s,i,o,c,u,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await(async function(s){const i=mt(s);Ge(cl,"RemoteStore shutting down."),i.Ea.add(5),await Pf(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}pg.provider={build:()=>new pg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ya("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo="FirestoreClient";class jb{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=bn.UNAUTHENTICATED,this.clientId=Ug.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async o=>{Ge(mo,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(Ge(mo,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ma;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=a1(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Am(t,e){t.asyncQueue.verifyOperationInProgress(),Ge(mo,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async s=>{n.isEqual(s)||(await eT(e.localStore,s),n=s)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function $2(t,e){t.asyncQueue.verifyOperationInProgress();const r=await Ub(t);Ge(mo,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>V2(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,s)=>V2(e.remoteStore,s))),t._onlineComponents=e}async function Ub(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ge(mo,"Using user provided OfflineComponentProvider");try{await Am(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(s){return s.name==="FirebaseError"?s.code===we.FAILED_PRECONDITION||s.code===we.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(r))throw r;kc("Error using user provided cache. Falling back to memory cache: "+r),await Am(t,new z0)}}else Ge(mo,"Using default OfflineComponentProvider"),await Am(t,new Vb(void 0));return t._offlineComponents}async function vT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ge(mo,"Using user provided OnlineComponentProvider"),await $2(t,t._uninitializedComponentsProvider._online)):(Ge(mo,"Using default OnlineComponentProvider"),await $2(t,new pg))),t._onlineComponents}function zb(t){return vT(t).then((e=>e.syncEngine))}async function W0(t){const e=await vT(t),r=e.eventManager;return r.onListen=Ab.bind(null,e.syncEngine),r.onUnlisten=Fb.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=Cb.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=bb.bind(null,e.syncEngine),r}function Wb(t,e,r={}){const n=new ma;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,c,u,h){const d=new d1({next:x=>{d.Nu(),o.enqueueAndForget((()=>l1(i,g)));const y=x.docs.has(c);!y&&x.fromCache?h.reject(new He(we.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&x.fromCache&&u&&u.source==="server"?h.reject(new He(we.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(x)},error:x=>h.reject(x)}),g=new u1(gd(c.path),d,{includeMetadataChanges:!0,qa:!0});return o1(i,g)})(await W0(t),t.asyncQueue,e,r,n))),n.promise}function Hb(t,e,r={}){const n=new ma;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,c,u,h){const d=new d1({next:x=>{d.Nu(),o.enqueueAndForget((()=>l1(i,g))),x.fromCache&&u.source==="server"?h.reject(new He(we.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(x)},error:x=>h.reject(x)}),g=new u1(c,d,{includeMetadataChanges:!0,qa:!0});return o1(i,g)})(await W0(t),t.asyncQueue,e,r,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G2=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT="firestore.googleapis.com",K2=!0;class q2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new He(we.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yT,this.ssl=K2}else this.host=e.host,this.ssl=e.ssl??K2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=JE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<EF)throw new He(we.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_T(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new He(we.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new He(we.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new He(we.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ad{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new q2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new He(we.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new He(we.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new q2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new XC;switch(n.type){case"firstParty":return new ZC(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new He(we.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=G2.get(r);n&&(Ge("ComponentProvider","Removing Datastore"),G2.delete(r),n.terminate())})(this),Promise.resolve()}}function $b(t,e,r,n={}){var h;t=Gn(t,Ad);const s=Lc(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;s&&(Xw(`https://${c}`),Yw("Firestore",!0)),i.host!==yT&&i.host!==c&&kc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:c,ssl:s,emulatorOptions:n};if(!al(u,o)&&(t._setSettings(u),n.mockUserToken)){let d,g;if(typeof n.mockUserToken=="string")d=n.mockUserToken,g=bn.MOCK_USER;else{d=y3(n.mockUserToken,(h=t._app)==null?void 0:h.options.projectId);const x=n.mockUserToken.sub||n.mockUserToken.user_id;if(!x)throw new He(we.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new bn(x)}t._authCredentials=new YC(new uE(d,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Eo(this.firestore,e,this._query)}}class Tr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tr(this.firestore,e,this._key)}toJSON(){return{type:Tr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Nf(r,Tr._jsonSchema))return new Tr(e,n||null,new et(tr.fromString(r.referencePath)))}}Tr._jsonSchemaVersion="firestore/documentReference/1.0",Tr._jsonSchema={type:Wr("string",Tr._jsonSchemaVersion),referencePath:Wr("string")};class lo extends Eo{constructor(e,r,n){super(e,r,gd(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tr(this.firestore,null,new et(e))}withConverter(e){return new lo(this.firestore,e,this._path)}}function Qo(t,e,...r){if(t=Hr(t),fE("collection","path",e),t instanceof Ad){const n=tr.fromString(e,...r);return o2(n),new lo(t,null,n)}{if(!(t instanceof Tr||t instanceof lo))throw new He(we.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(tr.fromString(e,...r));return o2(n),new lo(t.firestore,null,n)}}function os(t,e,...r){if(t=Hr(t),arguments.length===1&&(e=Ug.newId()),fE("doc","path",e),t instanceof Ad){const n=tr.fromString(e,...r);return a2(n),new Tr(t,null,new et(n))}{if(!(t instanceof Tr||t instanceof lo))throw new He(we.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(tr.fromString(e,...r));return a2(n),new Tr(t.firestore,t instanceof lo?t.converter:null,new et(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2="AsyncQueue";class Y2{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new rT(this,"async_queue_retry"),this._c=()=>{const n=km();n&&Ge(X2,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=km();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=km();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new ma;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!jc(e))throw e;Ge(X2,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,ya("INTERNAL UNHANDLED ERROR: ",Q2(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=i1.createAndSchedule(this,e,r,n,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&at(47125,{Pc:Q2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Q2(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1})(t,["next","error","complete"])}class zi extends Ad{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new Y2,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Y2(e),this._firestoreClient=void 0,await e}}}function Gb(t,e){const r=typeof t=="object"?t:eE(),n=typeof t=="string"?t:O0,s=Vg(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=v3("firestore");i&&$b(s,...i)}return s}function Lf(t){if(t._terminated)throw new He(we.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Kb(t),t._firestoreClient}function Kb(t){var n,s,i;const e=t._freezeSettings(),r=(function(c,u,h,d){return new gI(c,u,h,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,_T(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)})(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new jb(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}})(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ws(_n.fromBase64String(e))}catch(r){throw new He(we.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Ws(_n.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ws._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Nf(e,Ws._jsonSchema))return Ws.fromBase64String(e.bytes)}}Ws._jsonSchemaVersion="firestore/bytes/1.0",Ws._jsonSchema={type:Wr("string",Ws._jsonSchemaVersion),bytes:Wr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new He(we.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new He(we.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new He(we.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return At(this._lat,e._lat)||At(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Bi._jsonSchemaVersion}}static fromJSON(e){if(Nf(e,Bi._jsonSchema))return new Bi(e.latitude,e.longitude)}}Bi._jsonSchemaVersion="firestore/geoPoint/1.0",Bi._jsonSchema={type:Wr("string",Bi._jsonSchemaVersion),latitude:Wr("number"),longitude:Wr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Vi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Nf(e,Vi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new Vi(e.vectorValues);throw new He(we.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Vi._jsonSchemaVersion="firestore/vectorValue/1.0",Vi._jsonSchema={type:Wr("string",Vi._jsonSchemaVersion),vectorValues:Wr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb=/^__.*__$/;class Xb{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new wo(e,this.data,this.fieldMask,r,this.fieldTransforms):new Rf(e,this.data,r,this.fieldTransforms)}}class wT{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new wo(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function ET(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw at(40011,{Ac:t})}}class p1{constructor(e,r,n,s,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new p1({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return H0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(ET(this.Ac)&&qb.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Yb{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Td(e)}Cc(e,r,n,s=!1){return new p1({Ac:e,methodName:r,Dc:n,path:xn.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Bf(t){const e=t._freezeSettings(),r=Td(t._databaseId);return new Yb(t._databaseId,!!e.ignoreUndefinedProperties,r)}function m1(t,e,r,n,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,r,s);x1("Data must be an object, but it was:",o,n);const c=kT(n,o);let u,h;if(i.merge)u=new Ts(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const g of i.mergeFields){const x=mg(e,g,r);if(!o.contains(x))throw new He(we.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);CT(d,x)||d.push(x)}u=new Ts(d),h=o.fieldTransforms.filter((g=>u.covers(g.field)))}else u=null,h=o.fieldTransforms;return new Xb(new as(c),u,h)}class Id extends Cd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Id}}class g1 extends Cd{_toFieldTransform(e){return new zI(e.path,new ff)}isEqual(e){return e instanceof g1}}function TT(t,e,r,n){const s=t.Cc(1,e,r);x1("Data must be an object, but it was:",s,n);const i=[],o=as.empty();yo(n,((u,h)=>{const d=v1(e,u,r);h=Hr(h);const g=s.yc(d);if(h instanceof Id)i.push(d);else{const x=Vf(h,g);x!=null&&(i.push(d),o.set(d,x))}}));const c=new Ts(i);return new wT(o,c,s.fieldTransforms)}function ST(t,e,r,n,s,i){const o=t.Cc(1,e,r),c=[mg(e,n,r)],u=[s];if(i.length%2!=0)throw new He(we.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<i.length;x+=2)c.push(mg(e,i[x])),u.push(i[x+1]);const h=[],d=as.empty();for(let x=c.length-1;x>=0;--x)if(!CT(h,c[x])){const y=c[x];let k=u[x];k=Hr(k);const w=o.yc(y);if(k instanceof Id)h.push(y);else{const S=Vf(k,w);S!=null&&(h.push(y),d.set(y,S))}}const g=new Ts(h);return new wT(d,g,o.fieldTransforms)}function Qb(t,e,r,n=!1){return Vf(r,t.Cc(n?4:3,e))}function Vf(t,e){if(AT(t=Hr(t)))return x1("Unsupported field value:",e,t),kT(t,e);if(t instanceof Cd)return(function(n,s){if(!ET(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,s){const i=[];let o=0;for(const c of n){let u=Vf(c,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}})(t,e)}return(function(n,s){if((n=Hr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return VI(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=ar.fromDate(n);return{timestampValue:V0(s.serializer,i)}}if(n instanceof ar){const i=new ar(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:V0(s.serializer,i)}}if(n instanceof Bi)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ws)return{bytesValue:$E(s.serializer,n._byteString)};if(n instanceof Tr){const i=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Yg(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Vi)return(function(o,c){return{mapValue:{fields:{[yE]:{stringValue:wE},[L0]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Kg(c.serializer,h)}))}}}}}})(n,s);throw s.Sc(`Unsupported field value: ${hd(n)}`)})(t,e)}function kT(t,e){const r={};return pE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yo(t,((n,s)=>{const i=Vf(s,e.mc(n));i!=null&&(r[n]=i)})),{mapValue:{fields:r}}}function AT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ar||t instanceof Bi||t instanceof Ws||t instanceof Tr||t instanceof Cd||t instanceof Vi)}function x1(t,e,r){if(!AT(r)||!hE(r)){const n=hd(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function mg(t,e,r){if((e=Hr(e))instanceof Mf)return e._internalPath;if(typeof e=="string")return v1(t,e);throw H0("Field path arguments must be of type string or ",t,!1,void 0,r)}const Jb=new RegExp("[~\\*/\\[\\]]");function v1(t,e,r){if(e.search(Jb)>=0)throw H0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Mf(...e.split("."))._internalPath}catch{throw H0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function H0(t,e,r,n,s){const i=n&&!n.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${n}`),o&&(u+=` in document ${s}`),u+=")"),new He(we.INVALID_ARGUMENT,c+t+u)}function CT(t,e){return t.some((r=>r.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Tr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Zb(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(_1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Zb extends IT{data(){return super.data()}}function _1(t,e){return typeof e=="string"?v1(t,e):e instanceof Mf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new He(we.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class y1{}class bT extends y1{}function eN(t,e,...r){let n=[];e instanceof y1&&n.push(e),n=n.concat(r),(function(i){const o=i.filter((u=>u instanceof E1)).length,c=i.filter((u=>u instanceof w1)).length;if(o>1||o>0&&c>0)throw new He(we.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const s of n)t=s._apply(t);return t}class w1 extends bT{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new w1(e,r,n)}_apply(e){const r=this._parse(e);return NT(e._query,r),new Eo(e.firestore,e.converter,sg(e._query,r))}_parse(e){const r=Bf(e.firestore);return(function(i,o,c,u,h,d,g){let x;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new He(we.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ey(g,d);const k=[];for(const w of g)k.push(Z2(u,i,w));x={arrayValue:{values:k}}}else x=Z2(u,i,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ey(g,d),x=Qb(c,o,g,d==="in"||d==="not-in");return zr.create(h,d,x)})(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class E1 extends y1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new E1(e,r)}_parse(e){const r=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return r.length===1?r[0]:ui.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:((function(s,i){let o=s;const c=i.getFlattenedFilters();for(const u of c)NT(o,u),o=sg(o,u)})(e._query,r),new Eo(e.firestore,e.converter,sg(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class T1 extends bT{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new T1(e,r)}_apply(e){const r=(function(s,i,o){if(s.startAt!==null)throw new He(we.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new He(we.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new uf(i,o)})(e._query,this._field,this._direction);return new Eo(e.firestore,e.converter,(function(s,i){const o=s.explicitOrderBy.concat([i]);return new Uc(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,r))}}function tN(t,e="asc"){const r=e,n=_1("orderBy",t);return T1._create(n,r)}function Z2(t,e,r){if(typeof(r=Hr(r))=="string"){if(r==="")throw new He(we.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!FE(e)&&r.indexOf("/")!==-1)throw new He(we.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(tr.fromString(r));if(!et.isDocumentKey(n))throw new He(we.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return m2(t,new et(n))}if(r instanceof Tr)return m2(t,r._key);throw new He(we.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hd(r)}.`)}function ey(t,e){if(!Array.isArray(t)||t.length===0)throw new He(we.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function NT(t,e){const r=(function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null})(t.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(r!==null)throw r===e.op?new He(we.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new He(we.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class rN{convertValue(e,r="none"){switch(ho(e)){case 0:return null;case 1:return e.booleanValue;case 2:return br(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(fo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw at(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return yo(e,((s,i)=>{n[s]=this.convertValue(i,r)})),n}convertVectorValue(e){var n,s,i;const r=(i=(s=(n=e.fields)==null?void 0:n[L0].arrayValue)==null?void 0:s.values)==null?void 0:i.map((o=>br(o.doubleValue)));return new Vi(r)}convertGeoPoint(e){return new Bi(br(e.latitude),br(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=md(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(of(e));default:return null}}convertTimestamp(e){const r=uo(e);return new ar(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=tr.fromString(e);Wt(QE(n),9688,{name:e});const s=new lf(n.get(1),n.get(3)),i=new et(n.popFirst(5));return s.isEqual(r)||ya(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S1(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Ou{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Jo extends IT{constructor(e,r,n,s,i,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new S0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(_1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new He(we.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Jo._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Jo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Jo._jsonSchema={type:Wr("string",Jo._jsonSchemaVersion),bundleSource:Wr("string","DocumentSnapshot"),bundleName:Wr("string"),bundle:Wr("string")};class S0 extends Jo{data(e={}){return super.data(e)}}class Zo{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Ou(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new S0(this._firestore,this._userDataWriter,n.key,n,new Ou(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new He(we.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((c=>{const u=new S0(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ou(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const u=new S0(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Ou(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),d=o.indexOf(c.doc.key)),{type:nN(c.type),doc:u,oldIndex:h,newIndex:d}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new He(we.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Zo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ug.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function nN(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return at(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(t){t=Gn(t,Tr);const e=Gn(t.firestore,zi);return Wb(Lf(e),t._key).then((r=>DT(e,t,r)))}Zo._jsonSchemaVersion="firestore/querySnapshot/1.0",Zo._jsonSchema={type:Wr("string",Zo._jsonSchemaVersion),bundleSource:Wr("string","QuerySnapshot"),bundleName:Wr("string"),bundle:Wr("string")};class k1 extends rN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ws(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Tr(this.firestore,null,r)}}function RT(t){t=Gn(t,Eo);const e=Gn(t.firestore,zi),r=Lf(e),n=new k1(e);return FT(t._query),Hb(r,t._query).then((s=>new Zo(e,n,t,s)))}function fi(t,e,r){t=Gn(t,Tr);const n=Gn(t.firestore,zi),s=S1(t.converter,e,r);return Uf(n,[m1(Bf(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,Kn.none())])}function Cm(t,e,r,...n){t=Gn(t,Tr);const s=Gn(t.firestore,zi),i=Bf(s);let o;return o=typeof(e=Hr(e))=="string"||e instanceof Mf?ST(i,"updateDoc",t._key,e,r,n):TT(i,"updateDoc",t._key,e),Uf(s,[o.toMutation(t._key,Kn.exists(!0))])}function jf(t){return Uf(Gn(t.firestore,zi),[new wd(t._key,Kn.none())])}function sN(t,e){const r=Gn(t.firestore,zi),n=os(t),s=S1(t.converter,e);return Uf(r,[m1(Bf(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Kn.exists(!1))]).then((()=>n))}function _l(t,...e){var u,h,d;t=Hr(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||J2(e[n])||(r=e[n++]);const s={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(J2(e[n])){const g=e[n];e[n]=(u=g.next)==null?void 0:u.bind(g),e[n+1]=(h=g.error)==null?void 0:h.bind(g),e[n+2]=(d=g.complete)==null?void 0:d.bind(g)}let i,o,c;if(t instanceof Tr)o=Gn(t.firestore,zi),c=gd(t._key.path),i={next:g=>{e[n]&&e[n](DT(o,t,g))},error:e[n+1],complete:e[n+2]};else{const g=Gn(t,Eo);o=Gn(g.firestore,zi),c=g._query;const x=new k1(o);i={next:y=>{e[n]&&e[n](new Zo(o,x,g,y))},error:e[n+1],complete:e[n+2]},FT(t._query)}return(function(x,y,k,w){const S=new d1(w),N=new u1(y,S,k);return x.asyncQueue.enqueueAndForget((async()=>o1(await W0(x),N))),()=>{S.Nu(),x.asyncQueue.enqueueAndForget((async()=>l1(await W0(x),N)))}})(Lf(o),c,s,i)}function Uf(t,e){return(function(n,s){const i=new ma;return n.asyncQueue.enqueueAndForget((async()=>Nb(await zb(n),s,i))),i.promise})(Lf(t),e)}function DT(t,e,r){const n=r.docs.get(e._key),s=new k1(t);return new Jo(t,s,e._key,n,new Ou(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Bf(e)}set(e,r,n){this._verifyNotCommitted();const s=Im(e,this._firestore),i=S1(s.converter,r,n),o=m1(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(o.toMutation(s._key,Kn.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=Im(e,this._firestore);let o;return o=typeof(r=Hr(r))=="string"||r instanceof Mf?ST(this._dataReader,"WriteBatch.update",i._key,r,n,s):TT(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,Kn.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Im(e,this._firestore);return this._mutations=this._mutations.concat(new wd(r._key,Kn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new He(we.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Im(t,e){if((t=Hr(t)).firestore!==e)throw new He(we.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Er(){return new g1("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fm(t){return Lf(t=Gn(t,zi)),new iN(t,(e=>Uf(t,e)))}(function(e,r=!0){(function(s){Bc=s})(Mc),Sc(new ol("firestore",((n,{instanceIdentifier:s,options:i})=>{const o=n.getProvider("app").getImmediate(),c=new zi(new QC(n.getProvider("auth-internal")),new eI(o,n.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new He(we.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new lf(h.options.projectId,d)})(o,s),o);return i={useFetchStreams:r,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),ao(r2,n2,e),ao(r2,n2,"esm2020")})();function PT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const aN=PT,OT=new Ff("auth","Firebase",PT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0=new Mg("@firebase/auth");function oN(t,...e){$0.logLevel<=kt.WARN&&$0.warn(`Auth (${Mc}): ${t}`,...e)}function k0(t,...e){$0.logLevel<=kt.ERROR&&$0.error(`Auth (${Mc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(t,...e){throw C1(t,...e)}function oi(t,...e){return C1(t,...e)}function A1(t,e,r){const n={...aN(),[e]:r};return new Ff("auth","Firebase",n).create(e,{appName:t.name})}function el(t){return A1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lN(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Wi(t,"argument-error"),A1(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function C1(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return OT.create(t,...e)}function ft(t,e,...r){if(!t)throw C1(e,...r)}function ua(t){const e="INTERNAL ASSERTION FAILED: "+t;throw k0(e),new Error(e)}function Ea(t,e){t||ua(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xg(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function cN(){return ty()==="http:"||ty()==="https:"}function ty(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(cN()||A3()||"connection"in navigator)?navigator.onLine:!0}function fN(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ea(r>e,"Short delay should be less than long delay!"),this.isMobile=T3()||C3()}get(){return uN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1(t,e){Ea(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ua("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ua("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ua("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],pN=new zf(3e4,6e4);function F1(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Wc(t,e,r,n,s={}){return MT(t,s,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const c=bf({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:u,...i};return k3()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&Lc(t.emulatorConfig.host)&&(h.credentials="include"),LT.fetch()(await BT(t,t.config.apiHost,r,c),h)})}async function MT(t,e,r){t._canInitEmulator=!1;const n={...hN,...e};try{const s=new gN(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw o0(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw o0(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw o0(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw o0(t,"user-disabled",o);const d=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw A1(t,d,h);Wi(t,d)}}catch(s){if(s instanceof Sa)throw s;Wi(t,"network-request-failed",{message:String(s)})}}async function mN(t,e,r,n,s={}){const i=await Wc(t,e,r,n,s);return"mfaPendingCredential"in i&&Wi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function BT(t,e,r,n){const s=`${e}${r}?${n}`,i=t,o=i.config.emulator?I1(t.config,s):`${t.config.apiScheme}://${s}`;return dN.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class gN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(oi(this.auth,"network-request-failed")),pN.get())})}}function o0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=oi(t,e,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xN(t,e){return Wc(t,"POST","/v1/accounts:delete",e)}async function G0(t,e){return Wc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $u(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function vN(t,e=!1){const r=Hr(t),n=await r.getIdToken(e),s=b1(n);ft(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:$u(bm(s.auth_time)),issuedAtTime:$u(bm(s.iat)),expirationTime:$u(bm(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function bm(t){return Number(t)*1e3}function b1(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return k0("JWT malformed, contained fewer than 3 sections"),null;try{const s=$w(r);return s?JSON.parse(s):(k0("Failed to decode base64 JWT payload"),null)}catch(s){return k0("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function ry(t){const e=b1(t);return ft(e,"internal-error"),ft(typeof e.exp<"u","internal-error"),ft(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Sa&&_N(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function _N({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=$u(this.lastLoginAt),this.creationTime=$u(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K0(t){var g;const e=t.auth,r=await t.getIdToken(),n=await pf(t,G0(e,{idToken:r}));ft(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const i=(g=s.providerUserInfo)!=null&&g.length?VT(s.providerUserInfo):[],o=EN(t.providerData,i),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),h=c?u:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new vg(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,d)}async function wN(t){const e=Hr(t);await K0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function EN(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function VT(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TN(t,e){const r=await MT(t,{},async()=>{const n=bf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await BT(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return t.emulatorConfig&&Lc(t.emulatorConfig.host)&&(u.credentials="include"),LT.fetch()(o,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function SN(t,e){return Wc(t,"POST","/v2/accounts:revokeToken",F1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ft(e.idToken,"internal-error"),ft(typeof e.idToken<"u","internal-error"),ft(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ry(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ft(e.length!==0,"internal-error");const r=ry(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ft(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await TN(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,o=new gc;return n&&(ft(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(ft(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ft(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gc,this.toJSON())}_performRefresh(){return ua("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ya(t,e){ft(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class si{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new yN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new vg(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await pf(this,this.stsTokenManager.getToken(this.auth,e));return ft(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return vN(this,e)}reload(){return wN(this)}_assign(e){this!==e&&(ft(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new si({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await K0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ni(this.auth.app))return Promise.reject(el(this.auth));const e=await this.getIdToken();return await pf(this,xN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,i=r.phoneNumber??void 0,o=r.photoURL??void 0,c=r.tenantId??void 0,u=r._redirectEventId??void 0,h=r.createdAt??void 0,d=r.lastLoginAt??void 0,{uid:g,emailVerified:x,isAnonymous:y,providerData:k,stsTokenManager:w}=r;ft(g&&w,e,"internal-error");const S=gc.fromJSON(this.name,w);ft(typeof g=="string",e,"internal-error"),Ya(n,e.name),Ya(s,e.name),ft(typeof x=="boolean",e,"internal-error"),ft(typeof y=="boolean",e,"internal-error"),Ya(i,e.name),Ya(o,e.name),Ya(c,e.name),Ya(u,e.name),Ya(h,e.name),Ya(d,e.name);const N=new si({uid:g,auth:e,email:s,emailVerified:x,displayName:n,isAnonymous:y,photoURL:o,phoneNumber:i,tenantId:c,stsTokenManager:S,createdAt:h,lastLoginAt:d});return k&&Array.isArray(k)&&(N.providerData=k.map(B=>({...B}))),u&&(N._redirectEventId=u),N}static async _fromIdTokenResponse(e,r,n=!1){const s=new gc;s.updateFromServerResponse(r);const i=new si({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await K0(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];ft(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?VT(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new gc;c.updateFromIdToken(n);const u=new si({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new vg(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ny=new Map;function fa(t){Ea(t instanceof Function,"Expected a class definition");let e=ny.get(t);return e?(Ea(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ny.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}jT.type="NONE";const sy=jT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(t,e,r){return`firebase:${t}:${e}:${r}`}class xc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=A0(this.userKey,s.apiKey,i),this.fullPersistenceKey=A0("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await G0(this.auth,{idToken:e}).catch(()=>{});return r?si._fromGetAccountInfoResponse(this.auth,r,e):null}return si._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new xc(fa(sy),e,n);const s=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||fa(sy);const o=A0(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const d=await h._get(o);if(d){let g;if(typeof d=="string"){const x=await G0(e,{idToken:d}).catch(()=>{});if(!x)break;g=await si._fromGetAccountInfoResponse(e,x,d)}else g=si._fromJSON(e,d);h!==i&&(c=g),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new xc(i,e,n):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new xc(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(HT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(UT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(GT(e))return"Blackberry";if(KT(e))return"Webos";if(zT(e))return"Safari";if((e.includes("chrome/")||WT(e))&&!e.includes("edge/"))return"Chrome";if($T(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function UT(t=Bn()){return/firefox\//i.test(t)}function zT(t=Bn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function WT(t=Bn()){return/crios\//i.test(t)}function HT(t=Bn()){return/iemobile/i.test(t)}function $T(t=Bn()){return/android/i.test(t)}function GT(t=Bn()){return/blackberry/i.test(t)}function KT(t=Bn()){return/webos/i.test(t)}function N1(t=Bn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function kN(t=Bn()){var e;return N1(t)&&!!((e=window.navigator)!=null&&e.standalone)}function AN(){return I3()&&document.documentMode===10}function qT(t=Bn()){return N1(t)||$T(t)||KT(t)||GT(t)||/windows phone/i.test(t)||HT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XT(t,e=[]){let r;switch(t){case"Browser":r=iy(Bn());break;case"Worker":r=`${iy(Bn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Mc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IN(t,e={}){return Wc(t,"GET","/v2/passwordPolicy",F1(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN=6;class bN{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??FN,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ay(this),this.idTokenSubscription=new ay(this),this.beforeStateQueue=new CN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=OT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=fa(r)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await xc.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await G0(this,{idToken:e}),n=await si._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(ni(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=n==null?void 0:n._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(n=u.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await K0(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ni(this.app))return Promise.reject(el(this));const r=e?Hr(e):null;return r&&ft(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ft(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ni(this.app)?Promise.reject(el(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ni(this.app)?Promise.reject(el(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(fa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await IN(this),r=new bN(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ff("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await SN(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&fa(e)||this._popupRedirectResolver;ft(r,this,"argument-error"),this.redirectPersistenceManager=await xc.create(this,[fa(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ft(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,s);return()=>{o=!0,u()}}else{const u=e.addObserver(r);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=XT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(ni(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&oN(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Fd(t){return Hr(t)}class ay{constructor(e){this.auth=e,this.observer=null,this.addObserver=L3(r=>this.observer=r)}get next(){return ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function RN(t){R1=t}function DN(t){return R1.loadJS(t)}function PN(){return R1.gapiScript}function ON(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(t,e){const r=Vg(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(al(i,e??{}))return s;Wi(s,"already-initialized")}return r.initialize({options:e})}function MN(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(fa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function BN(t,e,r){const n=Fd(t);ft(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=YT(e),{host:o,port:c}=VN(e),u=c===null?"":`:${c}`,h={url:`${i}//${o}${u}/`},d=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){ft(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ft(al(h,n.config.emulator)&&al(d,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=d,n.settings.appVerificationDisabledForTesting=!0,Lc(o)?(Xw(`${i}//${o}${u}`),Yw("Auth",!0)):jN()}function YT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function VN(t){const e=YT(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:oy(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:oy(o)}}}function oy(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function jN(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return ua("not implemented")}_getIdTokenResponse(e){return ua("not implemented")}_linkToIdToken(e,r){return ua("not implemented")}_getReauthenticationResolver(e){return ua("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vc(t,e){return mN(t,"POST","/v1/accounts:signInWithIdp",F1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN="http://localhost";class ul extends QT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ul(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Wi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=r;if(!n||!s)return null;const o=new ul(n,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return vc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,vc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,vc(e,r)}buildRequest(){const e={requestUri:UN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=bf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf extends D1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja extends Wf{constructor(){super("facebook.com")}static credential(e){return ul._fromParams({providerId:Ja.PROVIDER_ID,signInMethod:Ja.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ja.credentialFromTaggedObject(e)}static credentialFromError(e){return Ja.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ja.credential(e.oauthAccessToken)}catch{return null}}}Ja.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ja.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la extends Wf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ul._fromParams({providerId:la.PROVIDER_ID,signInMethod:la.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return la.credentialFromTaggedObject(e)}static credentialFromError(e){return la.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return la.credential(r,n)}catch{return null}}}la.GOOGLE_SIGN_IN_METHOD="google.com";la.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za extends Wf{constructor(){super("github.com")}static credential(e){return ul._fromParams({providerId:Za.PROVIDER_ID,signInMethod:Za.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Za.credentialFromTaggedObject(e)}static credentialFromError(e){return Za.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Za.credential(e.oauthAccessToken)}catch{return null}}}Za.GITHUB_SIGN_IN_METHOD="github.com";Za.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo extends Wf{constructor(){super("twitter.com")}static credential(e,r){return ul._fromParams({providerId:eo.PROVIDER_ID,signInMethod:eo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return eo.credentialFromTaggedObject(e)}static credentialFromError(e){return eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return eo.credential(r,n)}catch{return null}}}eo.TWITTER_SIGN_IN_METHOD="twitter.com";eo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await si._fromIdTokenResponse(e,n,s),o=ly(n);return new Nc({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=ly(n);return new Nc({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function ly(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0 extends Sa{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,q0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new q0(e,r,n,s)}}function JT(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?q0._fromErrorAndOperation(t,i,e,n):i})}async function zN(t,e,r=!1){const n=await pf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Nc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WN(t,e,r=!1){const{auth:n}=t;if(ni(n.app))return Promise.reject(el(n));const s="reauthenticate";try{const i=await pf(t,JT(n,s,e,t),r);ft(i.idToken,n,"internal-error");const o=b1(i.idToken);ft(o,n,"internal-error");const{sub:c}=o;return ft(t.uid===c,n,"user-mismatch"),Nc._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Wi(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HN(t,e,r=!1){if(ni(t.app))return Promise.reject(el(t));const n="signIn",s=await JT(t,n,e),i=await Nc._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}function $N(t,e,r,n){return Hr(t).onIdTokenChanged(e,r,n)}function GN(t,e,r){return Hr(t).beforeAuthStateChanged(e,r)}function KN(t,e,r,n){return Hr(t).onAuthStateChanged(e,r,n)}function qN(t){return Hr(t).signOut()}const X0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(X0,"1"),this.storage.removeItem(X0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XN=1e3,YN=10;class eS extends ZT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);AN()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,YN):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},XN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}eS.type="LOCAL";const QN=eS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS extends ZT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}tS.type="SESSION";const rS=tS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new bd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(o).map(async h=>h(r.origin,i)),u=await JN(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const h=P1("",20);s.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(g){const x=g;if(x.data.eventId===h)switch(x.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(x.data.response);break;default:clearTimeout(d),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ji(){return window}function e6(t){ji().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(){return typeof ji().WorkerGlobalScope<"u"&&typeof ji().importScripts=="function"}async function t6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function r6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function n6(){return nS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sS="firebaseLocalStorageDb",s6=1,Y0="firebaseLocalStorage",iS="fbase_key";class Hf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Nd(t,e){return t.transaction([Y0],e?"readwrite":"readonly").objectStore(Y0)}function i6(){const t=indexedDB.deleteDatabase(sS);return new Hf(t).toPromise()}function _g(){const t=indexedDB.open(sS,s6);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Y0,{keyPath:iS})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Y0)?e(n):(n.close(),await i6(),e(await _g()))})})}async function cy(t,e,r){const n=Nd(t,!0).put({[iS]:e,value:r});return new Hf(n).toPromise()}async function a6(t,e){const r=Nd(t,!1).get(e),n=await new Hf(r).toPromise();return n===void 0?null:n.value}function uy(t,e){const r=Nd(t,!0).delete(e);return new Hf(r).toPromise()}const o6=800,l6=3;class aS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _g(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>l6)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bd._getInstance(n6()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await t6(),!this.activeServiceWorker)return;this.sender=new ZN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||r6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _g();return await cy(e,X0,"1"),await uy(e,X0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>cy(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>a6(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>uy(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Nd(s,!1).getAll();return new Hf(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),o6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}aS.type="LOCAL";const c6=aS;new zf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(t,e){return e?fa(e):(ft(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1 extends QT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return vc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return vc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function u6(t){return HN(t.auth,new O1(t),t.bypassAuthState)}function f6(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),WN(r,new O1(t),t.bypassAuthState)}async function h6(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),zN(r,new O1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return u6;case"linkViaPopup":case"linkViaRedirect":return h6;case"reauthViaPopup":case"reauthViaRedirect":return f6;default:Wi(this.auth,"internal-error")}}resolve(e){Ea(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ea(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d6=new zf(2e3,1e4);async function p6(t,e,r){if(ni(t.app))return Promise.reject(oi(t,"operation-not-supported-in-this-environment"));const n=Fd(t);lN(t,e,D1);const s=oS(n,r);return new Xo(n,"signInViaPopup",e,s).executeNotNull()}class Xo extends lS{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Xo.currentPopupAction&&Xo.currentPopupAction.cancel(),Xo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ft(e,this.auth,"internal-error"),e}async onExecution(){Ea(this.filter.length===1,"Popup operations only handle one event");const e=P1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(oi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(oi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Xo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(oi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,d6.get())};e()}}Xo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6="pendingRedirect",C0=new Map;class g6 extends lS{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=C0.get(this.auth._key());if(!e){try{const n=await x6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}C0.set(this.auth._key(),e)}return this.bypassAuthState||C0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function x6(t,e){const r=y6(e),n=_6(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function v6(t,e){C0.set(t._key(),e)}function _6(t){return fa(t._redirectPersistence)}function y6(t){return A0(m6,t.config.apiKey,t.name)}async function w6(t,e,r=!1){if(ni(t.app))return Promise.reject(el(t));const n=Fd(t),s=oS(n,e),o=await new g6(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E6=600*1e3;class T6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!S6(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!cS(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(oi(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=E6&&this.cachedEventUids.clear(),this.cachedEventUids.has(fy(e))}saveEventToCache(e){this.cachedEventUids.add(fy(e)),this.lastProcessedEventTime=Date.now()}}function fy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function cS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function S6(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k6(t,e={}){return Wc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,C6=/^https?/;async function I6(t){if(t.config.emulator)return;const{authorizedDomains:e}=await k6(t);for(const r of e)try{if(F6(r))return}catch{}Wi(t,"unauthorized-domain")}function F6(t){const e=xg(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!C6.test(r))return!1;if(A6.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6=new zf(3e4,6e4);function hy(){const t=ji().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function N6(t){return new Promise((e,r)=>{var s,i,o;function n(){hy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hy(),r(oi(t,"network-request-failed"))},timeout:b6.get()})}if((i=(s=ji().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=ji().gapi)!=null&&o.load)n();else{const c=ON("iframefcb");return ji()[c]=()=>{gapi.load?n():r(oi(t,"network-request-failed"))},DN(`${PN()}?onload=${c}`).catch(u=>r(u))}}).catch(e=>{throw I0=null,e})}let I0=null;function R6(t){return I0=I0||N6(t),I0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D6=new zf(5e3,15e3),P6="__/auth/iframe",O6="emulator/auth/iframe",L6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},M6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function B6(t){const e=t.config;ft(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?I1(e,O6):`https://${t.config.authDomain}/${P6}`,n={apiKey:e.apiKey,appName:t.name,v:Mc},s=M6.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${bf(n).slice(1)}`}async function V6(t){const e=await R6(t),r=ji().gapi;return ft(r,t,"internal-error"),e.open({where:document.body,url:B6(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:L6,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const o=oi(t,"network-request-failed"),c=ji().setTimeout(()=>{i(o)},D6.get());function u(){ji().clearTimeout(c),s(n)}n.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},U6=500,z6=600,W6="_blank",H6="http://localhost";class dy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $6(t,e,r,n=U6,s=z6){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...j6,width:n.toString(),height:s.toString(),top:i,left:o},h=Bn().toLowerCase();r&&(c=WT(h)?W6:r),UT(h)&&(e=e||H6,u.scrollbars="yes");const d=Object.entries(u).reduce((x,[y,k])=>`${x}${y}=${k},`,"");if(kN(h)&&c!=="_self")return G6(e||"",c),new dy(null);const g=window.open(e||"",c,d);ft(g,t,"popup-blocked");try{g.focus()}catch{}return new dy(g)}function G6(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K6="__/auth/handler",q6="emulator/auth/handler",X6=encodeURIComponent("fac");async function py(t,e,r,n,s,i){ft(t.config.authDomain,t,"auth-domain-config-required"),ft(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Mc,eventId:s};if(e instanceof D1){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",O3(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(e instanceof Wf){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const u=await t._getAppCheckToken(),h=u?`#${X6}=${encodeURIComponent(u)}`:"";return`${Y6(t)}?${bf(c).slice(1)}${h}`}function Y6({config:t}){return t.emulator?I1(t,q6):`https://${t.authDomain}/${K6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nm="webStorageSupport";class Q6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rS,this._completeRedirectFn=w6,this._overrideRedirectResult=v6}async _openPopup(e,r,n,s){var o;Ea((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await py(e,r,n,xg(),s);return $6(e,i,P1())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await py(e,r,n,xg(),s);return e6(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(Ea(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await V6(e),n=new T6(e);return r.register("authEvent",s=>(ft(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Nm,{type:Nm},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Nm];i!==void 0&&r(!!i),Wi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=I6(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return qT()||zT()||N1()}}const J6=Q6;var my="@firebase/auth",gy="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eR(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function tR(t){Sc(new ol("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;ft(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:XT(t)},h=new NN(n,s,i,u);return MN(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Sc(new ol("auth-internal",e=>{const r=Fd(e.getProvider("auth").getImmediate());return(n=>new Z6(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ao(my,gy,eR(t)),ao(my,gy,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=300,nR=qw("authIdTokenMaxAge")||rR;let xy=null;const sR=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>nR)return;const s=r==null?void 0:r.token;xy!==s&&(xy=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function iR(t=eE()){const e=Vg(t,"auth");if(e.isInitialized())return e.getImmediate();const r=LN(t,{popupRedirectResolver:J6,persistence:[c6,QN,rS]}),n=qw("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=sR(i.toString());GN(r,o,()=>o(r.currentUser)),$N(r,c=>o(c))}}const s=Gw("auth");return s&&BN(r,`http://${s}`),r}function aR(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}RN({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=oi("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",aR().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});tR("Browser");const oR={apiKey:"AIzaSyBBfpg8D4bqcqOTTuO5ONIQRInRCPOZM5k",authDomain:"comments-67079.firebaseapp.com",projectId:"comments-67079",storageBucket:"comments-67079.firebasestorage.app",messagingSenderId:"36001866008",appId:"1:36001866008:web:448de13685ad843551be6d"},uS=Zw(oR),gr=Gb(uS),hc=iR(uS),fS=new la;fS.setCustomParameters({prompt:"select_account"});let Nn=null;const lR=t=>{Nn=t},Vt={USERS:"users",STUDENTS:"students",SETTINGS:"settings",TEMPLATES:"templates",CLASSES:"classes",SCHOOLS:"schools"},yg=t=>{if(!Nn)throw new Error(" ID  setCurrentUserId()");return Qo(gr,Vt.USERS,Nn,t)},Pi=(t,e)=>{if(!Nn)throw new Error(" ID  setCurrentUserId()");return os(gr,Vt.USERS,Nn,t,e)},oa={subscribe:(t,e=null)=>{if(!Nn)return console.error(" ID "),t([]),()=>{};const r=yg(Vt.STUDENTS);return _l(r,n=>{let s=[];n.forEach(i=>{const o={id:i.id,...i.data()};(!e||o.classId===e)&&s.push(o)}),s.sort((i,o)=>{var c,u,h,d;return(((u=(c=i.createdAt)==null?void 0:c.toMillis)==null?void 0:u.call(c))||0)-(((d=(h=o.createdAt)==null?void 0:h.toMillis)==null?void 0:d.call(h))||0)}),t(s)},n=>{console.error("Firestore :",n),t([])})},add:async t=>{try{const e=Pi(Vt.STUDENTS,t.id.toString());await fi(e,{...t,createdAt:Er(),updatedAt:Er()})}catch(e){throw console.error(":",e),e}},addBatch:async t=>{try{const e=Fm(gr);t.forEach(r=>{const n=Pi(Vt.STUDENTS,r.id.toString());e.set(n,{...r,createdAt:Er(),updatedAt:Er()})}),await e.commit()}catch(e){throw console.error(":",e),e}},update:async(t,e)=>{try{const r=Pi(Vt.STUDENTS,t.toString());await fi(r,{...e,updatedAt:Er()},{merge:!0})}catch(r){throw console.error(":",r),r}},delete:async t=>{try{const e=Pi(Vt.STUDENTS,t.toString());await jf(e)}catch(e){throw console.error(":",e),e}},deleteBatch:async t=>{try{const e=Fm(gr);t.forEach(r=>{const n=Pi(Vt.STUDENTS,r.toString());e.delete(n)}),await e.commit()}catch(e){throw console.error(":",e),e}},deleteAll:async()=>{try{const t=yg(Vt.STUDENTS),e=await RT(t),r=Fm(gr);e.forEach(n=>{r.delete(n.ref)}),await r.commit()}catch(t){throw console.error(":",t),t}}},Lu={subscribe:t=>{if(!Nn)return console.error(" ID "),t({}),()=>{};const e=Pi(Vt.SETTINGS,"user");return _l(e,r=>{r.exists()?t(r.data()):t({})},r=>{console.error(":",r),t({})})},save:async t=>{try{const e=Pi(Vt.SETTINGS,"user");await fi(e,{...t,updatedAt:Er()},{merge:!0})}catch(e){throw console.error(":",e),e}}},Gu={subscribe:t=>{if(!Nn)return console.error(" ID "),t([]),()=>{};const e=yg(Vt.TEMPLATES);return _l(e,r=>{const n=[];r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>{var o,c,u,h;return(((c=(o=i.createdAt)==null?void 0:o.toMillis)==null?void 0:c.call(o))||0)-(((h=(u=s.createdAt)==null?void 0:u.toMillis)==null?void 0:h.call(u))||0)}),t(n)},r=>{console.error(":",r),t([])})},add:async t=>{try{const e=Date.now().toString(),r=Pi(Vt.TEMPLATES,e);return await fi(r,{...t,createdAt:Er(),usageCount:0}),e}catch(e){throw console.error(":",e),e}},delete:async t=>{try{const e=Pi(Vt.TEMPLATES,t.toString());await jf(e)}catch(e){throw console.error(":",e),e}},incrementUsage:async t=>{try{const e=Pi(Vt.TEMPLATES,t.toString()),r=await gg(e);r.exists()&&await fi(e,{usageCount:(r.data().usageCount||0)+1,updatedAt:Er()},{merge:!0})}catch(e){console.error(":",e)}}},ha={subscribe:t=>{const e=Qo(gr,Vt.CLASSES);return _l(e,r=>{const n=[];r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>{var o,c,u,h;return(((c=(o=s.createdAt)==null?void 0:o.toMillis)==null?void 0:c.call(o))||0)-(((h=(u=i.createdAt)==null?void 0:u.toMillis)==null?void 0:h.call(u))||0)}),t(n)},r=>{console.error(":",r)})},add:async t=>{try{const e=Date.now().toString(),r=os(gr,Vt.CLASSES,e);return await fi(r,{...t,createdAt:Er(),updatedAt:Er()}),e}catch(e){throw console.error(":",e),e}},update:async(t,e)=>{try{const r=os(gr,Vt.CLASSES,t.toString());await fi(r,{...e,updatedAt:Er()},{merge:!0})}catch(r){throw console.error(":",r),r}},delete:async t=>{try{const e=os(gr,Vt.CLASSES,t.toString());await jf(e)}catch(e){throw console.error(":",e),e}}},F0={subscribe:t=>{const e=Qo(gr,Vt.SCHOOLS);return _l(e,r=>{const n=[];r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>(s.name||"").localeCompare(i.name||"","zh-TW")),t(n)},r=>{console.error(":",r),t([])})},add:async t=>{try{const e=Date.now().toString(),r=os(gr,Vt.SCHOOLS,e);return await fi(r,{...t,createdAt:Er(),updatedAt:Er()}),e}catch(e){throw console.error(":",e),e}},update:async(t,e)=>{try{const r=os(gr,Vt.SCHOOLS,t.toString());await fi(r,{...e,updatedAt:Er()},{merge:!0})}catch(r){throw console.error(":",r),r}},delete:async t=>{try{const e=os(gr,Vt.SCHOOLS,t.toString());await jf(e)}catch(e){throw console.error(":",e),e}}},wg={subscribe:(t,e)=>{if(!Nn)return console.error(" ID "),e([]),()=>{};const r=Qo(gr,Vt.USERS,Nn,Vt.STUDENTS,t.toString(),"history");return _l(r,n=>{const s=[];n.forEach(i=>{s.push({id:i.id,...i.data()})}),s.sort((i,o)=>{var c,u,h,d;return(((u=(c=o.createdAt)==null?void 0:c.toMillis)==null?void 0:u.call(c))||0)-(((d=(h=i.createdAt)==null?void 0:h.toMillis)==null?void 0:d.call(h))||0)}),e(s)},n=>{console.error(":",n),e([])})},add:async(t,e,r=[])=>{if(!Nn)throw new Error(" ID ");try{const n=Qo(gr,Vt.USERS,Nn,Vt.STUDENTS,t.toString(),"history");await sN(n,{comment:e,styles:r,createdAt:Er()})}catch(n){throw console.error(":",n),n}},getAll:async t=>{if(!Nn)return console.error(" ID "),[];try{const e=Qo(gr,Vt.USERS,Nn,Vt.STUDENTS,t.toString(),"history"),r=await RT(e),n=[];return r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>{var o,c,u,h;return(((c=(o=i.createdAt)==null?void 0:o.toMillis)==null?void 0:c.call(o))||0)-(((h=(u=s.createdAt)==null?void 0:u.toMillis)==null?void 0:h.call(u))||0)})}catch(e){return console.error(":",e),[]}},delete:async(t,e)=>{if(!Nn)throw new Error(" ID ");try{const r=os(gr,Vt.USERS,Nn,Vt.STUDENTS,t.toString(),"history",e);await jf(r)}catch(r){throw console.error(":",r),r}}},cR="cagooo@gmail.com",nc={USERS:"users"},Ur={ADMIN:"admin",TEACHER:"teacher",PENDING:"pending"},Eg={getCurrentUser:()=>hc.currentUser,onAuthStateChange:t=>KN(hc,async e=>{if(e){const r=await da.getOrCreate(e);t({...e,...r})}else t(null)}),signInWithGoogle:async()=>{try{const e=(await p6(hc,fS)).user;return await da.getOrCreate(e),{success:!0,user:e}}catch(t){return console.error("Google :",t),{success:!1,error:t.message}}},signOut:async()=>{try{return await qN(hc),{success:!0}}catch(t){return console.error(":",t),{success:!1,error:t.message}}}},da={getOrCreate:async t=>{const e=os(gr,nc.USERS,t.uid),r=await gg(e);if(r.exists())return await fi(e,{lastLoginAt:Er()},{merge:!0}),{id:r.id,...r.data()};const n=t.email===cR,s={uid:t.uid,email:t.email,displayName:t.displayName||"",photoURL:t.photoURL||null,role:n?Ur.ADMIN:Ur.PENDING,assignedClasses:[],createdAt:Er(),lastLoginAt:Er(),approvedAt:n?Er():null,approvedBy:n?"system":null};return await fi(e,s),{id:t.uid,...s}},get:async t=>{const e=os(gr,nc.USERS,t),r=await gg(e);return r.exists()?{id:r.id,...r.data()}:null},subscribeAll:t=>{const e=Qo(gr,nc.USERS),r=eN(e,tN("createdAt","desc"));return _l(r,n=>{const s=[];n.forEach(i=>{s.push({id:i.id,...i.data()})}),t(s)},n=>{console.error(":",n)})},approve:async(t,e=[],r=null)=>{var n;try{const s=os(gr,nc.USERS,t),i={role:Ur.TEACHER,assignedClasses:e,approvedAt:Er(),approvedBy:((n=hc.currentUser)==null?void 0:n.uid)||"unknown"};return r&&(i.schoolId=r),await Cm(s,i),{success:!0}}catch(s){return console.error(":",s),{success:!1,error:s.message}}},updateAssignedClasses:async(t,e,r=null)=>{try{const n=os(gr,nc.USERS,t),s={assignedClasses:e,updatedAt:Er()};return r!==void 0&&(s.schoolId=r),await Cm(n,s),{success:!0}}catch(n){return console.error(":",n),{success:!1,error:n.message}}},reject:async t=>{var e;try{const r=os(gr,nc.USERS,t);return await Cm(r,{role:Ur.PENDING,assignedClasses:[],rejectedAt:Er(),rejectedBy:((e=hc.currentUser)==null?void 0:e.uid)||"unknown"}),{success:!0}}catch(r){return console.error(":",r),{success:!1,error:r.message}}},isAdmin:t=>(t==null?void 0:t.role)===Ur.ADMIN,isApproved:t=>(t==null?void 0:t.role)===Ur.ADMIN||(t==null?void 0:t.role)===Ur.TEACHER},uR=t=>{const[e,r]=Te.useState([]),[n,s]=Te.useState(new Set),[i,o]=Te.useState(!0),[c,u]=Te.useState(!1);Te.useEffect(()=>{if(!t){r([]),o(!1);return}lR(t),o(!0);const j=oa.subscribe(X=>{const G=X.map(A=>({...A,id:parseInt(A.id)||A.id,selectedTags:A.selectedTags||[],manualTraits:A.manualTraits||"",comment:A.comment||""}));r(G),o(!1)});return()=>j()},[t]);const h=Te.useCallback(async j=>{const X=j.split(`
`).map(A=>A.trim()).filter(A=>A!=="");if(X.length===0)return[];const G=X.map((A,C)=>({id:Date.now()+C,name:A,selectedTags:[],manualTraits:"",comment:""}));u(!0);try{await oa.addBatch(G)}catch(A){console.error(":",A)}return u(!1),G},[]),d=Te.useCallback(async(j,X,G)=>{r(A=>A.map(C=>C.id===j?{...C,[X]:G}:C));try{const A=e.find(C=>C.id===j);A&&await oa.update(j,{...A,[X]:G})}catch(A){console.error(":",A)}},[e]),g=Te.useCallback(async j=>{r(X=>X.filter(G=>G.id!==j)),s(X=>{const G=new Set(X);return G.delete(j),G});try{await oa.delete(j)}catch(X){console.error(":",X)}},[]),x=Te.useCallback(async()=>{const j=Array.from(n);r(X=>X.filter(G=>!n.has(G.id))),s(new Set);try{await oa.deleteBatch(j)}catch(X){console.error(":",X)}},[n]),y=Te.useCallback(async()=>{r([]),s(new Set);try{await oa.deleteAll()}catch(j){console.error(":",j)}},[]),k=Te.useCallback(j=>{s(X=>{const G=new Set(X);return G.has(j)?G.delete(j):G.add(j),G})},[]),w=Te.useCallback(()=>{if(n.size===e.length&&e.length>0)s(new Set);else{const j=new Set(e.map(X=>X.id));s(j)}},[n.size,e]),S=Te.useCallback(async(j,X)=>{r(G=>G.map(A=>j.includes(A.id)?A.selectedTags.includes(X)?A:{...A,selectedTags:[...A.selectedTags,X]}:A));try{for(const G of j){const A=e.find(C=>C.id===G);A&&!A.selectedTags.includes(X)&&await oa.update(G,{selectedTags:[...A.selectedTags,X]})}}catch(G){console.error(":",G)}},[e]),N=Te.useCallback(async(j,X)=>{r(G=>G.map(A=>A.id===j?{...A,selectedTags:A.selectedTags.filter(C=>C!==X)}:A));try{const G=e.find(A=>A.id===j);G&&await oa.update(j,{selectedTags:G.selectedTags.filter(A=>A!==X)})}catch(G){console.error(":",G)}},[e]),B=Te.useCallback(j=>{r(X=>typeof j=="function"?j(X):j)},[]),b=Te.useCallback(async(j,X)=>{try{await oa.update(j,{comment:X})}catch(G){console.error(":",G)}},[]);return{students:e,setStudents:B,selectedIds:n,isLoading:i,isSyncing:c,generateStudents:h,updateStudent:d,deleteStudent:g,deleteSelected:x,resetStudents:y,toggleSelection:k,toggleAllSelection:w,addTagToStudents:S,removeTag:N,syncComment:b}},fR=({isSidebarOpen:t,setIsSidebarOpen:e,onOpenSettings:r,onOpenTemplates:n,onOpenClasses:s,onOpenAdmin:i,onOpenImportExport:o,onLogout:c,hasApiKey:u,templateCount:h=0,currentClassName:d="",currentUser:g,isAdmin:x})=>v.jsxs("header",{className:"bg-[#FFF9E6] border-b-4 border-[#2D3436] h-16 sm:h-20 flex items-center justify-between px-3 sm:px-6 shrink-0 z-20 sticky top-0 shadow-[0_4px_0_#2D3436]",children:[v.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[v.jsx("div",{className:"bg-[#FECA57] text-[#2D3436] p-2 sm:p-3 border-3 border-[#2D3436] shadow-[3px_3px_0_#2D3436] transform rotate-[-2deg] rounded-lg",children:v.jsx("span",{className:"text-xl sm:text-2xl",children:""})}),v.jsxs("div",{children:[v.jsxs("h1",{className:"text-lg sm:text-2xl font-black text-[#2D3436] tracking-wide",children:[v.jsxs("span",{className:"hidden sm:inline relative",children:[v.jsx("span",{className:"relative z-10",children:""}),v.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-3 bg-[#FF6B9D] -z-0 transform -rotate-1"})]}),v.jsx("span",{className:"hidden sm:inline ml-1",children:""}),v.jsx("span",{className:"sm:hidden",children:""})]}),v.jsxs("button",{onClick:s,className:"text-xs font-bold text-[#636E72] hover:text-[#A29BFE] transition-colors flex items-center gap-1 mt-0.5",children:[v.jsx(nf,{size:12}),d,v.jsx("span",{className:"text-[10px]",children:""})]})]})]}),v.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[x&&v.jsxs("button",{onClick:i,className:"btn-pop p-2 sm:px-3 sm:py-2 bg-[#FF6B9D] text-white flex items-center gap-1 text-sm",title:"",children:[v.jsx(Vw,{size:18}),v.jsx("span",{className:"hidden sm:inline",children:""})]}),v.jsxs("button",{onClick:n,className:"btn-pop p-2 sm:px-3 sm:py-2 bg-[#A29BFE] text-white flex items-center gap-1 text-sm relative",title:"",children:[v.jsx(ud,{size:18}),v.jsx("span",{className:"hidden sm:inline",children:""}),h>0&&v.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-[#2D3436] text-white text-xs font-bold rounded-full flex items-center justify-center",children:h>9?"9+":h})]}),v.jsxs("button",{onClick:o,className:"btn-pop p-2 sm:px-3 sm:py-2 bg-[#54A0FF] text-white flex items-center gap-1 text-sm",title:"Excel /",children:[v.jsx(Ow,{size:18}),v.jsx("span",{className:"hidden sm:inline",children:"Excel"})]}),v.jsxs("button",{onClick:r,className:`btn-pop p-2 sm:px-3 sm:py-2 flex items-center gap-1 text-sm
            ${u?"bg-[#1DD1A1] text-white":"bg-[#FF6B6B] text-white animate-pulse"}`,title:u?"API Key ":" API Key",children:[v.jsx(r3,{size:18}),v.jsx("span",{className:"hidden sm:inline",children:u?"":""})]}),v.jsxs("button",{onClick:()=>e(!t),className:`btn-pop px-3 sm:px-4 py-2 flex items-center gap-1 sm:gap-2 text-sm sm:text-base
            ${t?"bg-[#FF6B9D] text-white":"bg-[#54A0FF] text-white"}`,children:[t?v.jsx(Ss,{size:18}):v.jsx(QA,{size:18}),v.jsx("span",{className:"hidden sm:inline",children:t?"":""}),v.jsx("span",{className:"sm:hidden",children:""})]}),v.jsxs("div",{className:"relative group",children:[g!=null&&g.photoURL?v.jsx("img",{src:g.photoURL,alt:g.displayName,className:"w-9 h-9 sm:w-10 sm:h-10 rounded-full border-2 border-[#2D3436] cursor-pointer hover:ring-2 hover:ring-[#FECA57] transition-all"}):v.jsx("div",{className:"w-9 h-9 sm:w-10 sm:h-10 bg-[#FECA57] rounded-full border-2 border-[#2D3436] flex items-center justify-center cursor-pointer",children:v.jsx("span",{className:"text-lg",children:""})}),v.jsxs("div",{className:"absolute right-0 top-12 bg-white border-2 border-[#2D3436] rounded-lg shadow-[3px_3px_0_#2D3436] p-3 w-56 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[v.jsx("div",{className:"text-sm font-bold text-[#2D3436] truncate",children:g==null?void 0:g.displayName}),v.jsx("div",{className:"text-xs text-[#636E72] truncate",children:g==null?void 0:g.email}),(g==null?void 0:g.schoolName)&&v.jsx("div",{className:"mt-2 pt-2 border-t border-dashed border-[#E8DCC8]",children:v.jsxs("div",{className:"text-xs text-[#636E72] flex items-center gap-1",children:[" ",v.jsx("span",{className:"font-bold text-[#A29BFE]",children:g.schoolName})]})}),(g==null?void 0:g.assignedClassNames)&&g.assignedClassNames.length>0&&v.jsx("div",{className:`${g!=null&&g.schoolName?"mt-1":"mt-2 pt-2 border-t border-dashed border-[#E8DCC8]"}`,children:v.jsxs("div",{className:"text-xs text-[#636E72] flex items-start gap-1",children:[v.jsx(nf,{size:12,className:"mt-0.5 shrink-0"}),v.jsx("span",{className:"font-bold text-[#54A0FF]",children:g.assignedClassNames.join("")})]})}),v.jsxs("button",{onClick:c,className:"w-full btn-pop px-3 py-2 bg-[#636E72] text-white text-xs font-bold flex items-center justify-center gap-2 mt-3",children:[v.jsx(YA,{size:14}),""]})]})]})]})]}),hR=()=>v.jsx("footer",{className:"bg-[#FECA57] text-[#2D3436] text-xs sm:text-sm py-3 sm:py-4 text-center border-t-4 border-[#2D3436] shrink-0 font-bold",children:v.jsxs("p",{className:"flex items-center justify-center gap-2",children:[v.jsx("span",{children:""}),v.jsx("span",{children:" "}),v.jsx("span",{children:""})]})}),dR=({dialog:t,closeDialog:e})=>t.isOpen?v.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",children:v.jsxs("div",{className:"card-pop w-full max-w-sm overflow-hidden animate-in",children:[v.jsx("div",{className:"p-4 sm:p-5 bg-[#FF6B9D] border-b-3 border-[#2D3436]",children:v.jsxs("h3",{className:"font-black text-lg sm:text-xl text-white flex items-center gap-2",children:[t.type==="confirm"?v.jsx(jw,{size:24}):v.jsx(Lw,{size:24}),t.title]})}),v.jsx("div",{className:"p-4 sm:p-6 bg-[#FFFDF5] text-[#2D3436] font-bold text-base sm:text-lg",children:t.message}),v.jsx("div",{className:"p-3 sm:p-4 bg-[#FFF9E6] flex justify-end gap-2 sm:gap-3 border-t-2 border-dashed border-[#E8DCC8]",children:t.type==="confirm"?v.jsxs(v.Fragment,{children:[v.jsx("button",{onClick:e,className:"btn-pop px-4 sm:px-6 py-2 bg-white text-[#2D3436] text-sm sm:text-base",children:" "}),v.jsx("button",{onClick:t.onConfirm,className:"btn-pop px-4 sm:px-6 py-2 bg-[#FF6B6B] text-white text-sm sm:text-base",children:" "})]}):v.jsx("button",{onClick:e,className:"btn-pop px-4 sm:px-6 py-2 bg-[#1DD1A1] text-white text-sm sm:text-base",children:" "})})]})}):null,pR=({progress:t})=>{const e=t.total>0?t.current/t.total*100:0;return v.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-[#2D3436]/70 backdrop-blur-md p-4",children:v.jsxs("div",{className:"card-pop w-[95%] sm:w-[90%] max-w-2xl flex flex-col items-center justify-center p-6 sm:p-10 text-center animate-in bg-[#FFF9E6]",children:[v.jsx("div",{className:"mb-4 sm:mb-6 text-6xl sm:text-8xl animate-bounce-soft",children:""}),v.jsxs("h2",{className:"text-2xl sm:text-4xl md:text-5xl font-black text-[#2D3436] mb-4 sm:mb-6",children:[v.jsxs("span",{className:"relative inline-block",children:["",v.jsx("span",{className:"absolute bottom-1 left-0 right-0 h-3 bg-[#FECA57] -z-10 transform rotate-1"})]}),v.jsx("span",{className:"animate-pulse",children:"..."})]}),v.jsx("div",{className:"w-full max-w-md bg-white border-3 border-[#2D3436] h-8 sm:h-10 mb-3 sm:mb-4 overflow-hidden rounded-full shadow-[4px_4px_0_#2D3436]",children:v.jsx("div",{className:"h-full transition-all duration-300 ease-out bg-gradient-to-r from-[#FF6B9D] via-[#FECA57] to-[#1DD1A1]",style:{width:`${e}%`}})}),v.jsxs("p",{className:"text-lg sm:text-2xl text-[#2D3436] font-bold mb-4 sm:mb-6",children:[" ",t.current," / ",t.total," "]}),v.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl text-[#FF6B9D] font-black",children:" "})]})})},mR=({isOpen:t,onClose:e,globalStyles:r,toggleGlobalStyle:n})=>{if(!t)return null;const s=["#FF6B9D","#FF9F43","#FECA57","#1DD1A1","#54A0FF","#A29BFE","#FF6B6B","#FF6B9D","#FF9F43","#FECA57","#1DD1A1","#54A0FF"];return v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-2 sm:p-4",children:v.jsxs("div",{className:"card-pop w-full max-w-3xl max-h-[95vh] sm:max-h-[90vh] flex flex-col animate-in bg-[#FFF9E6]",children:[v.jsxs("div",{className:"p-3 sm:p-5 bg-[#A29BFE] border-b-3 border-[#2D3436] flex items-center justify-between",children:[v.jsxs("h3",{className:"font-black text-white flex items-center gap-2 sm:gap-3 text-lg sm:text-2xl",children:[v.jsx("span",{className:"text-2xl",children:""}),v.jsx("span",{className:"hidden sm:inline",children:""}),v.jsx("span",{className:"sm:hidden",children:""})]}),v.jsx("button",{onClick:e,className:"btn-pop p-2 bg-white text-[#2D3436]",children:v.jsx(Ss,{size:20})})]}),v.jsxs("div",{className:"p-3 sm:p-6 overflow-y-auto flex-1 mobile-scroll-hide",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-4 p-2 sm:p-3 bg-[#FECA57] border-2 border-[#2D3436] rounded-lg text-sm sm:text-base font-bold text-[#2D3436]",children:[v.jsx("span",{className:"text-xl",children:""})," 2 "]}),v.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:Lg.map((i,o)=>{const c=r.includes(i.id),u=!c&&r.length>=2,h=s[o%s.length];return v.jsx("div",{onClick:()=>!u&&n(i.id),className:`
                    p-3 sm:p-4 cursor-pointer transition-all border-3 border-[#2D3436] rounded-lg
                    ${c?"shadow-[4px_4px_0_#2D3436] transform -translate-y-1":"shadow-[2px_2px_0_#2D3436]"}
                    ${u?"opacity-50 cursor-not-allowed":"hover:-translate-y-1 hover:shadow-[4px_4px_0_#2D3436]"}
                  `,style:{backgroundColor:c?h:"#FFFDF5"},children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx("div",{className:`w-6 h-6 sm:w-7 sm:h-7 border-2 border-[#2D3436] rounded flex items-center justify-center shrink-0
                      ${c?"bg-[#2D3436] text-white":"bg-white"}`,children:c&&v.jsx("span",{className:"text-sm",children:""})}),v.jsxs("div",{children:[v.jsx("h4",{className:`font-black text-base sm:text-lg ${c?"text-white":"text-[#2D3436]"}`,children:i.name}),v.jsx("p",{className:`text-xs sm:text-sm mt-1 leading-relaxed ${c?"text-white/90":"text-[#636E72]"}`,children:i.desc})]})]})},i.id)})})]}),v.jsxs("div",{className:"p-3 sm:p-5 bg-[#FFF9E6] flex justify-between items-center border-t-2 border-dashed border-[#E8DCC8]",children:[v.jsxs("span",{className:"text-sm sm:text-lg font-bold text-[#2D3436]",children:[" ",r.length," / 2  "]}),v.jsx("button",{onClick:e,className:"btn-pop bg-[#1DD1A1] text-white px-6 sm:px-8 py-2 sm:py-3 text-sm sm:text-base",children:" "})]})]})})},gR=({rawInput:t,setRawInput:e,numberCount:r,setNumberCount:n,onGenerateStudents:s,onGenerateNumbers:i,onResetList:o,isGenerating:c})=>v.jsxs("div",{className:"flex-1 w-full flex flex-col gap-3 p-3 sm:p-4 bg-[#FF9F43] border-3 border-[#2D3436] rounded-lg shadow-[4px_4px_0_#2D3436] transform rotate-[-0.5deg]",children:[v.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 text-white font-black text-base sm:text-xl mb-1",children:[v.jsx("span",{className:"text-2xl",children:""}),"1. "]}),v.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1",children:[v.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[v.jsx("textarea",{className:"flex-1 min-h-[100px] sm:min-h-[120px] p-3 sm:p-4 border-3 border-[#2D3436] rounded-lg outline-none text-sm sm:text-base resize-none font-medium placeholder:text-[#2D3436]/40 text-[#2D3436] leading-relaxed bg-white shadow-[inset_2px_2px_4px_rgba(0,0,0,0.1)]",placeholder:`...


`,value:t,onChange:u=>e(u.target.value),disabled:c}),v.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 bg-white p-2 sm:p-3 border-2 border-[#2D3436] rounded-lg",children:[v.jsxs("span",{className:"text-[#2D3436] font-bold text-xs sm:text-sm flex items-center gap-1",children:[v.jsx(qA,{size:14})," "]}),v.jsx("input",{type:"number",min:"1",max:"100",value:r,onChange:u=>n(Number(u.target.value)),className:"w-14 sm:w-16 text-center border-2 border-[#2D3436] text-[#2D3436] font-bold text-xs sm:text-sm py-1.5 outline-none rounded"}),v.jsx("span",{className:"text-[#2D3436] text-xs sm:text-sm font-bold",children:""}),v.jsx("button",{onClick:i,className:"btn-pop ml-auto bg-[#FECA57] text-[#2D3436] px-3 py-1 text-xs sm:text-sm",children:" "})]})]}),v.jsxs("div",{className:"flex flex-row sm:flex-col gap-2 sm:gap-3 sm:w-24",children:[v.jsxs("button",{onClick:s,disabled:c,className:"flex-1 btn-pop bg-[#1DD1A1] text-white font-bold px-3 sm:px-2 py-3 sm:py-4 text-sm sm:text-base flex flex-row sm:flex-col items-center justify-center gap-2 disabled:opacity-50",children:[v.jsx(Mw,{size:20}),v.jsx("span",{children:""})]}),v.jsxs("button",{onClick:o,disabled:c,className:"flex-1 btn-pop bg-white text-[#FF6B6B] font-bold px-3 sm:px-2 py-3 sm:py-4 text-sm sm:text-base flex flex-row sm:flex-col items-center justify-center gap-2 disabled:opacity-50",children:[v.jsx(Bw,{size:18}),v.jsx("span",{children:""})]})]})]})]}),xR=({students:t,selectedIds:e,isGenerating:r,extraSettings:n,setExtraSettings:s,onGenerateSelected:i,onGenerateAll:o,onDownload:c,onDeleteSelected:u,onResetList:h})=>v.jsxs("div",{className:"flex-1 w-full flex flex-col gap-3 sm:gap-4 p-3 sm:p-4 bg-[#54A0FF] border-3 border-[#2D3436] rounded-lg shadow-[4px_4px_0_#2D3436] transform rotate-[0.5deg]",children:[v.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 text-white font-black text-base sm:text-xl",children:[v.jsx("span",{className:"text-2xl",children:""}),"2. AI "]}),v.jsxs("div",{className:"bg-white/90 border-2 border-[#2D3436] rounded-lg p-2 sm:p-3 flex flex-col gap-2 sm:gap-3",children:[v.jsx("div",{className:"flex items-center justify-between text-xs sm:text-sm font-bold text-[#2D3436] border-b-2 border-dashed border-[#E8DCC8] pb-2",children:v.jsx("span",{className:"flex items-center gap-1",children:" "})}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[v.jsx("div",{className:"flex bg-[#FFF9E6] border-2 border-[#2D3436] rounded-lg overflow-hidden",children:[{val:"normal",label:"",emoji:""},{val:"casual",label:"",emoji:""},{val:"formal",label:"",emoji:""}].map(d=>v.jsxs("button",{onClick:()=>s(g=>({...g,tone:d.val})),className:`px-2 sm:px-3 py-1.5 text-xs sm:text-sm font-bold transition-colors 
                  ${n.tone===d.val?"bg-[#FF6B9D] text-white":"text-[#2D3436] hover:bg-[#FECA57]"}`,children:[v.jsx("span",{className:"hidden sm:inline",children:d.emoji})," ",d.label]},d.val))}),v.jsxs("div",{className:"flex items-center gap-2 bg-[#FFF9E6] border-2 border-[#2D3436] rounded-lg px-2 sm:px-3 py-1.5 ml-auto",children:[v.jsx("span",{className:"text-xs sm:text-sm font-bold text-[#2D3436]",children:" "}),v.jsx("input",{type:"number",min:"20",max:"500",step:"10",value:n.wordCount,onChange:d=>s(g=>({...g,wordCount:Number(d.target.value)})),className:"w-12 text-xs sm:text-sm font-bold text-[#2D3436] text-center outline-none bg-white border-2 border-[#2D3436] rounded"})]})]})]}),v.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[v.jsxs("button",{onClick:i,disabled:e.size===0||r,className:`flex-1 btn-pop py-3 sm:py-4 text-sm sm:text-base font-black flex items-center justify-center gap-2 
            ${e.size>0&&!r?"bg-white text-[#2D3436]":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-60"}`,children:[v.jsx(n3,{size:18}),r?"...":` (${e.size})`]}),v.jsxs("button",{onClick:o,disabled:t.length===0||r,className:`flex-1 btn-pop py-3 sm:py-4 text-sm sm:text-base font-black flex items-center justify-center gap-2
            ${t.length>0&&!r?"bg-[#FECA57] text-[#2D3436]":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-60"}`,children:[v.jsx("span",{className:"text-xl",children:""}),r?"AI ...":""]})]}),v.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs sm:text-sm pt-2 border-t-2 border-dashed border-white/50",children:[v.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[v.jsxs("button",{onClick:()=>c("txt"),disabled:t.length===0,className:"btn-pop bg-white text-[#2D3436] px-2 sm:px-3 py-1 flex items-center gap-1 disabled:opacity-50",children:[v.jsx(rf,{size:14})," TXT"]}),v.jsxs("button",{onClick:()=>c("csv"),disabled:t.length===0,className:"btn-pop bg-white text-[#2D3436] px-2 sm:px-3 py-1 flex items-center gap-1 disabled:opacity-50",children:[v.jsx(rf,{size:14})," CSV"]})]}),v.jsxs("div",{className:"flex gap-2",children:[e.size>0&&v.jsxs("button",{onClick:u,disabled:r,className:"btn-pop bg-[#FF6B6B] text-white px-2 sm:px-3 py-1 flex items-center gap-1 text-xs sm:text-sm disabled:opacity-50",children:[v.jsx(Oc,{size:12}),"  (",e.size,")"]}),v.jsx("button",{onClick:h,disabled:r||t.length===0,className:"text-white/80 hover:text-white font-bold transition-colors disabled:opacity-50",children:" "})]})]})]}),vR=({globalStyles:t,onOpenStyleModal:e,isGenerating:r})=>{const n={qualitative:"#FF6B9D",emotional:"#FF9F43",friendly:"#FECA57",humorous:"#1DD1A1",internal:"#54A0FF",philosophical:"#A29BFE",practical:"#FF6B6B",resonance:"#FF6B9D",blessing:"#FF9F43",scenario:"#FECA57",milestone:"#1DD1A1",journey:"#54A0FF"};return v.jsxs("div",{className:"mb-4 sm:mb-6 bg-[#FFFDF5] border-3 border-[#2D3436] rounded-lg p-3 sm:p-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 shadow-[4px_4px_0_#2D3436]",children:[v.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-[#2D3436] text-sm sm:text-base font-black",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsx("span",{children:""}),v.jsx("div",{className:"flex gap-2 flex-wrap",children:t.length>0?t.map(s=>{var i;return v.jsx("span",{className:"px-3 py-1 border-2 border-[#2D3436] rounded-full text-xs sm:text-sm font-bold text-white shadow-[2px_2px_0_#2D3436]",style:{backgroundColor:n[s]||"#A29BFE"},children:(i=Lg.find(o=>o.id===s))==null?void 0:i.name},s)}):v.jsx("span",{className:"text-[#636E72] font-medium text-xs sm:text-sm bg-[#E8DCC8] px-3 py-1 rounded-full",children:" (: )"})})]}),v.jsxs("button",{onClick:e,disabled:r,className:"btn-pop w-full sm:w-auto bg-[#A29BFE] text-white px-4 sm:px-6 py-2 text-xs sm:text-sm font-bold flex items-center justify-center gap-2 disabled:opacity-50",children:[v.jsx(JA,{size:14})," "]})]})},_R=({student:t,isSelected:e,isFocused:r,isGenerating:n,isGeneratingSingle:s,onToggleSelection:i,onFocus:o,onOpenSidebar:c,onRemoveTag:u,onUpdateStudent:h,onDeleteStudent:d,onGenerateSingle:g,onSaveTemplate:x,onOpenHistory:y})=>{const k=["-1deg","0.5deg","-0.5deg","1deg","0deg"],w=k[t.id%k.length],S=s===t.id,N=B=>B<50?"text-[#FF6B6B]":B>120?"text-[#FF9F43]":"text-[#1DD1A1]";return v.jsxs("div",{className:`bg-[#FFFDF5] border-3 border-[#2D3436] rounded-lg overflow-hidden shadow-[4px_4px_0_#2D3436] transition-all
        ${e?"ring-4 ring-[#FF6B9D]":""}
        ${r?"ring-4 ring-[#54A0FF]":""}
        ${S?"ring-4 ring-[#FECA57] animate-pulse":""}`,style:{transform:`rotate(${w})`},children:[v.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#FECA57] border-b-2 border-[#2D3436]",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("button",{onClick:()=>i(t.id),disabled:n||S,className:`w-6 h-6 border-2 border-[#2D3436] rounded flex items-center justify-center
              ${e?"bg-[#FF6B9D] text-white":"bg-white"}`,children:e&&v.jsx("span",{className:"text-sm font-bold",children:""})}),v.jsxs("span",{className:"font-black text-[#2D3436] text-base",children:[" ",t.name]})]}),v.jsxs("div",{className:"flex items-center gap-1",children:[v.jsxs("button",{onClick:()=>g(t.id),disabled:n||S,className:"btn-pop px-2 py-1 bg-[#1DD1A1] text-white text-xs font-bold flex items-center gap-1 disabled:opacity-50",children:[S?v.jsx(pc,{size:14,className:"animate-spin"}):v.jsx(v.Fragment,{children:""}),v.jsx("span",{className:"hidden sm:inline",children:S?"":""})]}),v.jsx("button",{onClick:()=>d(t.id),disabled:n||S,className:"text-[#2D3436]/50 hover:text-[#FF6B6B] transition-colors disabled:opacity-30 p-1",children:v.jsx(Oc,{size:18})})]})]}),v.jsxs("div",{className:"p-3 border-b-2 border-dashed border-[#E8DCC8]",children:[v.jsx("div",{className:"text-xs font-bold text-[#636E72] mb-2",children:" "}),v.jsx("div",{onClick:()=>{o(t.id),c()},className:`p-2 border-2 border-dashed bg-white min-h-[50px] flex flex-col gap-2 cursor-pointer transition-colors rounded-lg
            ${r?"border-[#54A0FF] bg-[#54A0FF]/10":"border-[#E8DCC8]"}`,children:t.selectedTags.length>0?v.jsx("div",{className:"flex flex-wrap gap-1.5",children:t.selectedTags.map((B,b)=>v.jsxs("span",{className:"tag-handwrite text-xs",children:[B,v.jsx("button",{onClick:j=>{j.stopPropagation(),u(t.id,B)},className:"hover:text-[#FF6B6B] ml-1",children:""})]},b))}):v.jsx("span",{className:"text-[#636E72]/50 text-xs",children:" ..."})}),v.jsx("input",{type:"text",value:t.manualTraits,onChange:B=>h(t.id,"manualTraits",B.target.value),placeholder:" ...",disabled:n||S,className:"w-full mt-2 p-2 text-sm font-medium outline-none border-2 border-[#E8DCC8] focus:border-[#FF9F43] rounded-lg bg-white text-[#2D3436] placeholder:text-[#636E72]/40"})]}),v.jsxs("div",{className:"p-3 bg-[#FFF9E6]",children:[v.jsxs("div",{className:"text-xs font-bold text-[#636E72] mb-2 flex items-center justify-between",children:[v.jsx("span",{className:"flex items-center gap-1",children:" AI "}),v.jsxs("div",{className:"flex items-center gap-2",children:[y&&v.jsxs("button",{onClick:()=>y(t),className:"flex items-center gap-1 text-[#54A0FF] hover:text-[#2D3436] transition-colors",title:"",children:[v.jsx(Tc,{size:14}),v.jsx("span",{children:""})]}),t.comment&&!t.comment.includes("")&&!t.comment.includes("")&&v.jsxs("button",{onClick:()=>x(t),className:"flex items-center gap-1 text-[#FF6B9D] hover:text-[#FF6B6B] transition-colors",title:"",children:[v.jsx(ud,{size:14}),v.jsx("span",{children:""})]})]})]}),v.jsx("textarea",{value:t.comment,onChange:B=>h(t.id,"comment",B.target.value),placeholder:" AI ...",disabled:S,className:`w-full text-sm p-3 border-2 border-[#E8DCC8] focus:border-[#1DD1A1] outline-none resize-y min-h-[100px] leading-relaxed font-medium text-[#2D3436] rounded-lg
            ${S?"bg-[#FECA57]/30 animate-pulse":"bg-white"}`}),t.comment&&v.jsxs("div",{className:`text-right text-xs mt-1 font-bold ${N(t.comment.length)}`,children:[t.comment.length," "]})]})]})},yR=({students:t,selectedIds:e,focusedStudentId:r,isGenerating:n,isGeneratingSingle:s,onToggleSelection:i,onToggleAllSelection:o,onFocusStudent:c,onOpenSidebar:u,onRemoveTag:h,onUpdateStudent:d,onDeleteStudent:g,onGenerateSingle:x,onSaveTemplate:y,onOpenHistory:k})=>{const w=typeof window<"u"&&window.innerWidth<768,S=N=>N<50?"text-[#FF6B6B]":N>120?"text-[#FF9F43]":"text-[#1DD1A1]";return w?v.jsx("div",{className:"space-y-4",children:t.length===0?v.jsxs("div",{className:"p-10 text-center font-bold text-lg bg-[#FFFDF5] border-3 border-[#2D3436] rounded-lg shadow-[4px_4px_0_#2D3436]",children:[v.jsx("span",{className:"text-4xl block mb-3",children:""}),v.jsx("span",{className:"text-[#636E72]",children:""})]}):v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"flex items-center justify-between bg-[#A29BFE] text-white border-3 border-[#2D3436] p-3 rounded-lg shadow-[3px_3px_0_#2D3436]",children:v.jsxs("button",{onClick:o,className:"flex items-center gap-2 font-bold text-sm",disabled:n,children:[v.jsx("span",{className:`w-5 h-5 border-2 border-white rounded flex items-center justify-center ${e.size===t.length&&t.length>0?"bg-white text-[#A29BFE]":""}`,children:e.size===t.length&&t.length>0&&v.jsx("span",{className:"text-xs",children:""})})," (",e.size,"/",t.length,")"]})}),t.map(N=>v.jsx(_R,{student:N,isSelected:e.has(N.id),isFocused:r===N.id,isGenerating:n,isGeneratingSingle:s,onToggleSelection:i,onFocus:c,onOpenSidebar:u,onRemoveTag:h,onUpdateStudent:d,onDeleteStudent:g,onGenerateSingle:x,onSaveTemplate:y,onOpenHistory:k},N.id))]})}):v.jsx("div",{className:"card-pop overflow-x-auto",children:v.jsxs("table",{className:"w-full text-left border-collapse min-w-[1000px]",children:[v.jsx("thead",{className:"bg-[#FF6B9D] text-white",children:v.jsxs("tr",{className:"text-base font-black",children:[v.jsx("th",{className:"p-4 lg:p-5 w-12 text-center border-r-2 border-[#2D3436]/20",children:v.jsx("button",{onClick:o,className:"w-6 h-6 border-2 border-white rounded flex items-center justify-center mx-auto bg-white/20 hover:bg-white/40 transition",disabled:n,children:e.size===t.length&&t.length>0&&v.jsx("span",{className:"text-sm",children:""})})}),v.jsx("th",{className:"p-4 lg:p-5 w-32 lg:w-40 border-r-2 border-[#2D3436]/20",children:" "}),v.jsx("th",{className:"p-4 lg:p-5 border-r-2 border-[#2D3436]/20 w-1/4",children:" "}),v.jsx("th",{className:"p-4 lg:p-5 border-r-2 border-[#2D3436]/20",children:" AI "}),v.jsx("th",{className:"p-4 lg:p-5 w-20 text-center",children:""})]})}),v.jsxs("tbody",{className:"bg-[#FFFDF5]",children:[t.length===0&&v.jsx("tr",{children:v.jsxs("td",{colSpan:"5",className:"p-16 lg:p-20 text-center font-bold text-xl text-[#636E72]",children:[v.jsx("span",{className:"text-5xl block mb-4",children:""}),""]})}),t.map(N=>{const B=s===N.id;return v.jsxs("tr",{className:`border-t-2 border-dashed border-[#E8DCC8] hover:bg-[#FECA57]/20 transition-colors ${e.has(N.id)?"bg-[#FF6B9D]/10":""} ${B?"bg-[#FECA57]/30":""}`,children:[v.jsx("td",{className:"p-4 lg:p-5 text-center align-top pt-6 lg:pt-8 border-r-2 border-dashed border-[#E8DCC8]",children:v.jsx("button",{onClick:()=>i(N.id),disabled:n||B,className:`w-6 h-6 border-2 border-[#2D3436] rounded flex items-center justify-center mx-auto transition ${e.has(N.id)?"bg-[#FF6B9D] text-white":"bg-white hover:bg-[#FECA57]"}`,children:e.has(N.id)&&v.jsx("span",{className:"text-sm font-bold",children:""})})}),v.jsxs("td",{className:"p-4 lg:p-5 align-top pt-6 lg:pt-8 border-r-2 border-dashed border-[#E8DCC8]",children:[v.jsx("div",{className:"font-black text-[#2D3436] text-base lg:text-lg mb-2",children:N.name}),v.jsx("button",{onClick:()=>x(N.id),disabled:n||B,className:"btn-pop px-3 py-1.5 bg-[#1DD1A1] text-white text-xs font-bold flex items-center gap-1 disabled:opacity-50 w-full justify-center",children:B?v.jsxs(v.Fragment,{children:[v.jsx(pc,{size:14,className:"animate-spin"})," ..."]}):v.jsx(v.Fragment,{children:" "})})]}),v.jsxs("td",{className:"p-4 lg:p-5 align-top border-r-2 border-dashed border-[#E8DCC8]",children:[v.jsx("div",{onClick:()=>{c(N.id),u()},className:`p-3 border-2 border-dashed bg-white min-h-[80px] lg:min-h-[100px] flex flex-col gap-3 cursor-pointer transition-colors rounded-lg ${r===N.id?"border-[#54A0FF] bg-[#54A0FF]/10":"border-[#E8DCC8] hover:border-[#FF9F43]"}`,children:N.selectedTags.length>0?v.jsx("div",{className:"flex flex-wrap gap-2",children:N.selectedTags.map((b,j)=>v.jsxs("span",{className:"tag-handwrite text-sm",children:[b,v.jsx("button",{onClick:X=>{X.stopPropagation(),h(N.id,b)},className:"hover:text-[#FF6B6B] ml-1",children:""})]},j))}):v.jsx("span",{className:"text-[#636E72]/50 text-sm",children:" ..."})}),v.jsx("input",{type:"text",value:N.manualTraits,onChange:b=>d(N.id,"manualTraits",b.target.value),placeholder:" ...",disabled:n||B,className:"w-full mt-3 p-3 text-sm lg:text-base font-medium outline-none border-2 border-[#E8DCC8] focus:border-[#FF9F43] rounded-lg bg-white text-[#2D3436] placeholder:text-[#636E72]/40 transition-all"})]}),v.jsxs("td",{className:"p-4 lg:p-5 align-top border-r-2 border-dashed border-[#E8DCC8]",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("span",{className:"text-xs font-bold text-[#636E72]",children:""}),v.jsxs("div",{className:"flex items-center gap-2",children:[k&&v.jsxs("button",{onClick:()=>k(N),className:"flex items-center gap-1 text-xs text-[#54A0FF] hover:text-[#2D3436] transition-colors font-bold",title:"",children:[v.jsx(Tc,{size:12})," "]}),N.comment&&!N.comment.includes("")&&!N.comment.includes("")&&v.jsxs("button",{onClick:()=>y(N),className:"flex items-center gap-1 text-xs text-[#FF6B9D] hover:text-[#FF6B6B] transition-colors font-bold",title:"",children:[v.jsx(ud,{size:12})," "]})]})]}),v.jsx("textarea",{value:N.comment,onChange:b=>d(N.id,"comment",b.target.value),placeholder:" AI ...",disabled:B,className:`w-full text-sm lg:text-base p-3 lg:p-4 border-2 border-[#E8DCC8] focus:border-[#1DD1A1] outline-none resize-y min-h-[180px] lg:min-h-[200px] leading-relaxed font-medium text-[#2D3436] rounded-lg transition-all ${B?"bg-[#FECA57]/30 animate-pulse":"bg-white"}`}),N.comment&&v.jsxs("div",{className:`text-right text-xs mt-1 font-bold ${S(N.comment.length)}`,children:[N.comment.length," "]})]}),v.jsx("td",{className:"p-4 lg:p-5 text-center align-top pt-6 lg:pt-8",children:v.jsx("button",{onClick:()=>g(N.id),disabled:n||B,className:"text-[#636E72]/50 hover:text-[#FF6B6B] transition-colors disabled:opacity-30",children:v.jsx(Oc,{size:18})})})]},N.id)})]})]})})},wR=({isOpen:t,onClose:e,selectedIds:r,expandedCategories:n,onToggleCategory:s,onIdiomClick:i})=>{const[o,c]=Te.useState(""),u={" ()":"#1DD1A1"," ()":"#FF6B6B"," ()":"#54A0FF"," ()":"#FECA57"," ()":"#FF9F43"," ()":"#A29BFE"," ()":"#FF6B9D"," ()":"#1DD1A1"," ()":"#FECA57"," ()":"#FF6B6B"," ()":"#54A0FF"," ()":"#A29BFE"," ()":"#FF9F43",:"#FF6B9D",:"#636E72"},h=w=>{try{return JSON.parse(localStorage.getItem("idiom_usage")||"{}")[w]||0}catch{return 0}},d=w=>{try{const S=JSON.parse(localStorage.getItem("idiom_usage")||"{}");S[w]=(S[w]||0)+1,localStorage.setItem("idiom_usage",JSON.stringify(S))}catch(S){console.error(":",S)}},g=w=>{d(w),i(w)},x=Te.useMemo(()=>{if(!o.trim())return mm;const w=o.trim().toLowerCase(),S={};return Object.entries(mm).forEach(([N,B])=>{const b=B.filter(j=>j.toLowerCase().includes(w));b.length>0&&(S[N]=b)}),S},[o]),y=Te.useMemo(()=>Object.values(mm).flat().map(N=>({idiom:N,count:h(N)})).filter(N=>N.count>0).sort((N,B)=>B.count-N.count).slice(0,12).map(N=>N.idiom),[t]),k=Object.values(x).reduce((w,S)=>w+S.length,0);return v.jsxs(v.Fragment,{children:[t&&v.jsx("div",{className:"fixed inset-0 bg-black/30 z-40 backdrop-blur-[2px] transition-opacity",onClick:e}),v.jsxs("div",{className:`fixed top-0 right-0 bottom-0 bg-[#FFF9E6] border-l-4 border-[#2D3436] shadow-[-8px_0_0_#2D3436] transform transition-transform duration-300 ease-in-out flex flex-col z-50
          ${t?"translate-x-0":"translate-x-full"}
          w-full sm:w-[80%] md:w-[50%] lg:w-[35%] xl:w-[30%] max-w-[400px]`,children:[v.jsxs("div",{className:"p-3 sm:p-5 bg-[#1DD1A1] border-b-3 border-[#2D3436] flex items-center justify-between shrink-0",children:[v.jsxs("h2",{className:"font-black text-white flex items-center gap-2 sm:gap-3 text-base sm:text-xl",children:[v.jsx("span",{className:"text-2xl",children:""})," "]}),v.jsx("button",{onClick:e,className:"btn-pop p-2 bg-white text-[#2D3436]",children:v.jsx(Ss,{size:20})})]}),v.jsxs("div",{className:"p-3 sm:p-4 bg-white border-b-2 border-dashed border-[#E8DCC8]",children:[v.jsxs("div",{className:"relative",children:[v.jsx(t3,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#636E72]"}),v.jsx("input",{type:"text",value:o,onChange:w=>c(w.target.value),placeholder:" ...",className:"w-full pl-10 pr-4 py-2.5 border-2 border-[#2D3436] rounded-lg text-sm font-medium outline-none focus:border-[#1DD1A1] bg-[#FFFDF5]"}),o&&v.jsx("button",{onClick:()=>c(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#636E72] hover:text-[#FF6B6B]",children:""})]}),o&&v.jsxs("div",{className:"mt-2 text-xs text-[#636E72] font-bold",children:[" ",k," "]})]}),v.jsxs("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 space-y-3 sm:space-y-4 mobile-scroll-hide",children:[v.jsxs("div",{className:"text-sm font-bold text-[#2D3436] bg-[#FECA57] px-3 py-2 border-2 border-[#2D3436] rounded-lg inline-flex items-center gap-2 shadow-[2px_2px_0_#2D3436]",children:[v.jsx("span",{children:""})," "]}),r.size>0&&v.jsxs("div",{className:"bg-[#54A0FF] text-white p-3 sm:p-4 border-2 border-[#2D3436] text-xs sm:text-sm font-bold rounded-lg shadow-[3px_3px_0_#2D3436]",children:[v.jsx("span",{className:"block mb-1 text-white/80",children:" "})," ",v.jsx("strong",{children:r.size})," "]}),y.length>0&&!o&&v.jsxs("div",{className:"border-2 border-[#2D3436] rounded-lg overflow-hidden shadow-[3px_3px_0_#2D3436]",children:[v.jsxs("div",{className:"w-full flex items-center justify-between p-3 sm:p-4 text-left text-sm sm:text-base font-black text-white bg-[#FF6B9D]",children:[v.jsx("span",{children:" "}),v.jsx("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded-full",children:y.length})]}),v.jsx("div",{className:"p-3 sm:p-4 bg-[#FFFDF5] flex flex-wrap gap-1.5 sm:gap-2 border-t-2 border-dashed border-[#E8DCC8]",children:y.map((w,S)=>v.jsx("button",{onClick:()=>g(w),className:"px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm bg-[#FF6B9D] border-2 border-[#2D3436] text-white font-bold rounded-lg hover:bg-[#FF5291] transition-all shadow-[2px_2px_0_#2D3436] hover:-translate-y-0.5",children:w},`popular-${w}-${S}`))})]}),Object.entries(x).map(([w,S])=>{const N=u[w]||"#A29BFE";return v.jsxs("div",{className:"border-2 border-[#2D3436] rounded-lg overflow-hidden shadow-[3px_3px_0_#2D3436]",children:[v.jsxs("button",{onClick:()=>s(w),className:"w-full flex items-center justify-between p-3 sm:p-4 text-left text-sm sm:text-base font-black text-white transition-colors",style:{backgroundColor:N},children:[v.jsx("span",{children:w}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded-full",children:S.length}),v.jsx("span",{className:"bg-white/20 rounded-full w-6 h-6 flex items-center justify-center",children:n[w]?"":""})]})]}),(n[w]||o)&&v.jsx("div",{className:"p-3 sm:p-4 bg-[#FFFDF5] flex flex-wrap gap-1.5 sm:gap-2 border-t-2 border-dashed border-[#E8DCC8]",children:S.map((B,b)=>v.jsx("button",{onClick:()=>g(B),className:"px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm bg-white border-2 border-[#2D3436] text-[#2D3436] font-bold rounded-lg hover:text-white transition-all shadow-[2px_2px_0_#2D3436] hover:-translate-y-0.5 hover:shadow-[3px_3px_0_#2D3436] active:translate-y-0 active:shadow-[1px_1px_0_#2D3436]",style:{"--hover-bg":N},onMouseEnter:j=>j.target.style.backgroundColor=N,onMouseLeave:j=>j.target.style.backgroundColor="white",children:o&&B.includes(o)?v.jsx("span",{dangerouslySetInnerHTML:{__html:B.replace(new RegExp(`(${o})`,"gi"),'<mark class="bg-[#FECA57] px-0.5 rounded">$1</mark>')}}):B},`${B}-${b}`))})]},w)}),o&&Object.keys(x).length===0&&v.jsxs("div",{className:"text-center py-10",children:[v.jsx("div",{className:"text-4xl mb-3",children:""}),v.jsxs("p",{className:"text-[#636E72] font-bold",children:["",o,""]})]})]})]})]})},ER=()=>v.jsx("div",{className:"fixed inset-0 z-[90] flex items-center justify-center bg-[#FFF9E6]",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"text-6xl mb-4 animate-bounce",children:""}),v.jsx("h2",{className:"text-2xl font-black text-[#2D3436] mb-2",children:"..."}),v.jsx("p",{className:"text-[#636E72] font-medium",children:""}),v.jsxs("div",{className:"mt-4 flex justify-center gap-1",children:[v.jsx("span",{className:"w-3 h-3 bg-[#FF6B9D] rounded-full animate-bounce",style:{animationDelay:"0ms"}}),v.jsx("span",{className:"w-3 h-3 bg-[#FECA57] rounded-full animate-bounce",style:{animationDelay:"150ms"}}),v.jsx("span",{className:"w-3 h-3 bg-[#1DD1A1] rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})}),TR=({isOpen:t,onClose:e,currentUser:r})=>{const[n,s]=Te.useState(""),[i,o]=Te.useState(!1),[c,u]=Te.useState(!1),[h,d]=Te.useState(null),[g,x]=Te.useState(""),[y,k]=Te.useState(!0);Te.useEffect(()=>{if(!t||!r)return;k(!0);const b=Lu.subscribe(j=>{const X=(j==null?void 0:j.apiKey)||"";x(X),s(X),k(!1)});return()=>b()},[t,r]);const w=async()=>{if(n.trim()){u(!0);try{await Lu.save({apiKey:n.trim()}),x(n.trim()),d(null),localStorage.setItem("gemini_api_key",n.trim())}catch(b){console.error(" API Key :",b),alert("")}u(!1)}},S=async()=>{if(window.confirm(" API Key ")){u(!0);try{await Lu.save({apiKey:""}),s(""),x(""),d(null),localStorage.removeItem("gemini_api_key")}catch(b){console.error(" API Key :",b)}u(!1)}},N=async()=>{if(!n.trim()){d("error");return}o(!0),d(null);try{const b=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${n.trim()}`;(await fetch(b,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:""}]}]})})).ok?(d("success"),await Lu.save({apiKey:n.trim()}),x(n.trim()),localStorage.setItem("gemini_api_key",n.trim())):d("error")}catch(b){console.error("API :",b),d("error")}o(!1)},B=b=>!b||b.length<10?b:b.substring(0,6)+""+b.substring(b.length-4);return t?v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-2 sm:p-4",children:v.jsxs("div",{className:"card-pop w-full max-w-lg flex flex-col animate-in bg-[#FFF9E6]",children:[v.jsxs("div",{className:"p-3 sm:p-5 bg-[#FF9F43] border-b-3 border-[#2D3436] flex items-center justify-between",children:[v.jsxs("h3",{className:"font-black text-white flex items-center gap-2 text-lg sm:text-xl",children:[v.jsx(XA,{size:24}),"API Key "]}),v.jsx("button",{onClick:e,className:"btn-pop p-2 bg-white text-[#2D3436]",children:v.jsx(Ss,{size:20})})]}),v.jsx("div",{className:"p-4 sm:p-6 space-y-4",children:y?v.jsx("div",{className:"flex items-center justify-center py-8",children:v.jsx(pc,{size:32,className:"animate-spin text-[#FF9F43]"})}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"bg-[#54A0FF]/20 border-2 border-[#54A0FF] rounded-lg p-3 text-sm text-[#2D3436]",children:[v.jsx("p",{className:"font-bold mb-1",children:"  API Key"}),v.jsx("p",{className:"text-[#636E72]",children:" Google AI Studio  Gemini API Key"}),v.jsxs("a",{href:"https://aistudio.google.com/apikey",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-[#54A0FF] hover:underline font-bold mt-2",children:[v.jsx(GA,{size:14})," API Key"]})]}),v.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[v.jsx("span",{className:"font-bold text-[#2D3436]",children:""}),g?v.jsxs("span",{className:"flex items-center gap-1 text-[#1DD1A1] font-bold",children:[v.jsx(Gm,{size:16})," (",B(g),")"]}):v.jsxs("span",{className:"flex items-center gap-1 text-[#FF6B6B] font-bold",children:[v.jsx(N0,{size:16}),""]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-bold text-[#2D3436] mb-2",children:" Gemini API Key"}),v.jsx("input",{type:"password",value:n,onChange:b=>{s(b.target.value),d(null)},placeholder:" API Key...",className:"w-full p-3 border-3 border-[#2D3436] rounded-lg text-[#2D3436] font-medium placeholder:text-[#636E72]/50 focus:border-[#FF9F43] outline-none"})]}),h&&v.jsx("div",{className:`p-3 rounded-lg border-2 flex items-center gap-2 text-sm font-bold
                                  ${h==="success"?"bg-[#1DD1A1]/20 border-[#1DD1A1] text-[#1DD1A1]":"bg-[#FF6B6B]/20 border-[#FF6B6B] text-[#FF6B6B]"}`,children:h==="success"?v.jsxs(v.Fragment,{children:[v.jsx(Gm,{size:18}),"API Key  "]}):v.jsxs(v.Fragment,{children:[v.jsx(N0,{size:18})," API Key "]})}),v.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 pt-2",children:[v.jsx("button",{onClick:N,disabled:!n.trim()||i||c,className:"btn-pop flex-1 py-3 bg-[#54A0FF] text-white font-bold flex items-center justify-center gap-2 disabled:opacity-50",children:i?v.jsxs(v.Fragment,{children:[v.jsx(pc,{size:18,className:"animate-spin"}),"..."]}):v.jsx(v.Fragment,{children:" "})}),v.jsx("button",{onClick:w,disabled:!n.trim()||c,className:"btn-pop flex-1 py-3 bg-[#1DD1A1] text-white font-bold disabled:opacity-50 flex items-center justify-center gap-2",children:c?v.jsxs(v.Fragment,{children:[v.jsx(pc,{size:18,className:"animate-spin"}),"..."]}):v.jsx(v.Fragment,{children:" "})})]}),g&&v.jsx("button",{onClick:S,disabled:c,className:"w-full text-center text-sm text-[#FF6B6B] hover:underline font-bold disabled:opacity-50",children:"  API Key"})]})}),v.jsxs("div",{className:"p-3 sm:p-4 bg-[#E8DCC8] border-t-2 border-dashed border-[#2D3436]/20 text-xs text-[#636E72] text-center flex items-center justify-center gap-1",children:[v.jsx(HA,{size:14}),"API Key "]})]})}):null},SR=({isOpen:t,onClose:e,onApplyTemplate:r})=>{const[n,s]=Te.useState([]),[i,o]=Te.useState(!0);Te.useEffect(()=>{if(!t)return;o(!0);const d=Gu.subscribe(g=>{s(g),o(!1)});return()=>d()},[t]);const c=async d=>{try{await Gu.delete(d)}catch(g){console.error(":",g)}},u=async d=>{try{await Gu.incrementUsage(d.id),r(d.content),e()}catch(g){console.error(":",g)}},h=async d=>{try{await navigator.clipboard.writeText(d)}catch(g){console.error(":",g)}};return t?v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-2 sm:p-4",children:v.jsxs("div",{className:"card-pop w-full max-w-2xl max-h-[90vh] flex flex-col animate-in bg-[#FFF9E6]",children:[v.jsxs("div",{className:"p-3 sm:p-5 bg-[#FF6B9D] border-b-3 border-[#2D3436] flex items-center justify-between",children:[v.jsxs("h3",{className:"font-black text-white flex items-center gap-2 text-lg sm:text-xl",children:[v.jsx(ud,{size:24}),""]}),v.jsx("button",{onClick:e,className:"btn-pop p-2 bg-white text-[#2D3436]",children:v.jsx(Ss,{size:20})})]}),v.jsx("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 mobile-scroll-hide",children:i?v.jsx("div",{className:"flex items-center justify-center py-20",children:v.jsx("div",{className:"text-4xl animate-bounce",children:""})}):n.length===0?v.jsxs("div",{className:"text-center py-16",children:[v.jsx("div",{className:"text-5xl mb-4",children:""}),v.jsx("p",{className:"text-lg font-bold text-[#636E72]",children:""}),v.jsx("p",{className:"text-sm text-[#636E72]/70 mt-2",children:"   "})]}):v.jsx("div",{className:"space-y-4",children:n.map(d=>v.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg overflow-hidden shadow-[3px_3px_0_#2D3436]",children:[v.jsxs("div",{className:"p-3 bg-[#FECA57] border-b-2 border-[#2D3436] flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-sm font-bold text-[#2D3436]",children:d.studentName||""}),d.tags&&d.tags.length>0&&v.jsxs("div",{className:"flex gap-1 flex-wrap",children:[d.tags.slice(0,3).map((g,x)=>v.jsx("span",{className:"px-2 py-0.5 bg-white text-[#2D3436] text-xs rounded-full border border-[#2D3436]",children:g},x)),d.tags.length>3&&v.jsxs("span",{className:"text-xs text-[#2D3436]",children:["+",d.tags.length-3]})]})]}),v.jsxs("span",{className:"text-xs text-[#2D3436]/70",children:[" ",d.usageCount||0," "]})]}),v.jsx("div",{className:"p-3 text-sm text-[#2D3436] leading-relaxed max-h-[120px] overflow-y-auto",children:d.content}),v.jsxs("div",{className:"p-2 bg-[#FFF9E6] border-t border-dashed border-[#E8DCC8] flex items-center justify-end gap-2",children:[v.jsxs("button",{onClick:()=>h(d.content),className:"btn-pop px-3 py-1.5 bg-white text-[#2D3436] text-xs font-bold flex items-center gap-1",children:[v.jsx($A,{size:12}),""]}),v.jsxs("button",{onClick:()=>u(d),className:"btn-pop px-3 py-1.5 bg-[#1DD1A1] text-white text-xs font-bold flex items-center gap-1",children:[v.jsx(zA,{size:12}),""]}),v.jsxs("button",{onClick:()=>c(d.id),className:"btn-pop px-3 py-1.5 bg-[#FF6B6B] text-white text-xs font-bold flex items-center gap-1",children:[v.jsx(Oc,{size:12}),""]})]})]},d.id))})}),v.jsxs("div",{className:"p-3 sm:p-4 bg-[#E8DCC8] border-t-2 border-dashed border-[#2D3436]/20 text-xs text-[#636E72] text-center",children:[" ",n.length,"  | "]})]})}):null},kR=()=>{const[t,e]=Te.useState(null),[r,n]=Te.useState(!1);Te.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches)return;const c=localStorage.getItem("pwa_install_dismissed");if(c&&Date.now()-parseInt(c)<1e3*60*60*24*7)return;const u=h=>{h.preventDefault(),e(h),n(!0)};return window.addEventListener("beforeinstallprompt",u),()=>window.removeEventListener("beforeinstallprompt",u)},[]);const s=async()=>{if(!t)return;t.prompt();const{outcome:o}=await t.userChoice;o==="accepted"&&n(!1),e(null)},i=()=>{n(!1),localStorage.setItem("pwa_install_dismissed",Date.now().toString())};return r?v.jsx("div",{className:"fixed bottom-4 left-4 right-4 sm:left-auto sm:right-4 sm:max-w-sm z-[100] animate-in",children:v.jsxs("div",{className:"bg-[#2D3436] text-white p-4 rounded-lg border-3 border-[#FECA57] shadow-[4px_4px_0_#FECA57] flex items-center gap-3",children:[v.jsx("div",{className:"text-3xl",children:""}),v.jsxs("div",{className:"flex-1",children:[v.jsx("h3",{className:"font-black text-sm",children:""}),v.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:""})]}),v.jsxs("button",{onClick:s,className:"btn-pop px-3 py-2 bg-[#FECA57] text-[#2D3436] text-xs font-bold flex items-center gap-1",children:[v.jsx(rf,{size:14}),""]}),v.jsx("button",{onClick:i,className:"text-white/50 hover:text-white p-1",children:v.jsx(Ss,{size:16})})]})}):null},AR=({isOpen:t,onClose:e,currentClassId:r,onSelectClass:n})=>{const[s,i]=Te.useState([]),[o,c]=Te.useState(!0),[u,h]=Te.useState(!1),[d,g]=Te.useState(null),[x,y]=Te.useState(""),[k,w]=Te.useState("");Te.useEffect(()=>{if(!t)return;c(!0);const j=ha.subscribe(X=>{i(X),c(!1)});return()=>j()},[t]);const S=async()=>{if(x.trim())try{await ha.add({name:x.trim(),year:new Date().getFullYear()}),y(""),h(!1)}catch(j){console.error(":",j)}},N=async j=>{if(k.trim())try{await ha.update(j,{name:k.trim()}),g(null),w("")}catch(X){console.error(":",X)}},B=async j=>{if(window.confirm(""))try{await ha.delete(j),r===j&&n(null)}catch(X){console.error(":",X)}},b=j=>{n(j),e()};return t?v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-2 sm:p-4",children:v.jsxs("div",{className:"card-pop w-full max-w-lg max-h-[85vh] flex flex-col animate-in bg-[#FFF9E6]",children:[v.jsxs("div",{className:"p-3 sm:p-5 bg-[#A29BFE] border-b-3 border-[#2D3436] flex items-center justify-between",children:[v.jsxs("h3",{className:"font-black text-white flex items-center gap-2 text-lg sm:text-xl",children:[v.jsx(nf,{size:24}),""]}),v.jsx("button",{onClick:e,className:"btn-pop p-2 bg-white text-[#2D3436]",children:v.jsx(Ss,{size:20})})]}),v.jsx("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 mobile-scroll-hide",children:o?v.jsx("div",{className:"flex items-center justify-center py-20",children:v.jsx("div",{className:"text-4xl animate-bounce",children:""})}):v.jsxs("div",{className:"space-y-3",children:[v.jsxs("button",{onClick:()=>b(null),className:`w-full p-4 border-2 border-[#2D3436] rounded-lg flex items-center justify-between transition-all shadow-[3px_3px_0_#2D3436]
                  ${r?"bg-white hover:bg-[#FECA57]/20":"bg-[#1DD1A1] text-white"}`,children:[v.jsxs("span",{className:"font-bold flex items-center gap-2",children:[v.jsx("span",{className:"text-lg",children:""})," "]}),!r&&v.jsx(ca,{size:20})]}),s.map(j=>v.jsx("div",{className:`p-4 border-2 border-[#2D3436] rounded-lg shadow-[3px_3px_0_#2D3436] transition-all
                    ${r===j.id?"bg-[#54A0FF] text-white":"bg-white"}`,children:d===j.id?v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("input",{type:"text",value:k,onChange:X=>w(X.target.value),className:"flex-1 p-2 border-2 border-[#2D3436] rounded-lg text-[#2D3436] font-bold",autoFocus:!0}),v.jsx("button",{onClick:()=>N(j.id),className:"btn-pop p-2 bg-[#1DD1A1] text-white",children:v.jsx(ca,{size:16})}),v.jsx("button",{onClick:()=>g(null),className:"btn-pop p-2 bg-[#636E72] text-white",children:v.jsx(Ss,{size:16})})]}):v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("button",{onClick:()=>b(j.id),className:"flex-1 text-left font-bold flex items-center gap-2",children:[v.jsx("span",{className:"text-lg",children:""})," ",j.name,r===j.id&&v.jsx(ca,{size:18})]}),v.jsxs("div",{className:"flex items-center gap-1",children:[v.jsx("button",{onClick:()=>{g(j.id),w(j.name)},className:"p-2 hover:text-[#54A0FF] transition-colors",children:v.jsx(ZA,{size:16})}),v.jsx("button",{onClick:()=>B(j.id),className:"p-2 hover:text-[#FF6B6B] transition-colors",children:v.jsx(Oc,{size:16})})]})]})},j.id)),u?v.jsx("div",{className:"p-4 border-2 border-dashed border-[#1DD1A1] rounded-lg bg-[#1DD1A1]/10",children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("input",{type:"text",value:x,onChange:j=>y(j.target.value),placeholder:"...",className:"flex-1 p-2 border-2 border-[#2D3436] rounded-lg font-bold",autoFocus:!0,onKeyDown:j=>j.key==="Enter"&&S()}),v.jsx("button",{onClick:S,className:"btn-pop p-2 bg-[#1DD1A1] text-white",children:v.jsx(ca,{size:16})}),v.jsx("button",{onClick:()=>{h(!1),y("")},className:"btn-pop p-2 bg-[#636E72] text-white",children:v.jsx(Ss,{size:16})})]})}):v.jsxs("button",{onClick:()=>h(!0),className:"w-full p-4 border-2 border-dashed border-[#1DD1A1] rounded-lg text-[#1DD1A1] font-bold flex items-center justify-center gap-2 hover:bg-[#1DD1A1]/10 transition-colors",children:[v.jsx(Mw,{size:20}),""]}),s.length===0&&!u&&v.jsxs("div",{className:"text-center py-8 text-[#636E72]",children:[v.jsx("div",{className:"text-4xl mb-3",children:""}),v.jsx("p",{className:"font-bold",children:""}),v.jsx("p",{className:"text-sm mt-1",children:""})]})]})}),v.jsxs("div",{className:"p-3 sm:p-4 bg-[#E8DCC8] border-t-2 border-dashed border-[#2D3436]/20 text-xs text-[#636E72] text-center",children:[" ",s.length,"  | "]})]})}):null},CR=({isOpen:t,onClose:e,student:r,onRestore:n})=>{const[s,i]=Te.useState([]),[o,c]=Te.useState(!0);Te.useEffect(()=>{if(!t||!r)return;c(!0);const g=wg.subscribe(r.id,x=>{i(x),c(!1)});return()=>g()},[t,r]);const u=g=>{n(g),e()},h=async g=>{if(window.confirm(""))try{await wg.delete(r.id,g)}catch(x){console.error(":",x)}},d=g=>g!=null&&g.toDate?g.toDate().toLocaleString("zh-TW",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"";return!t||!r?null:v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-2 sm:p-4",children:v.jsxs("div",{className:"card-pop w-full max-w-lg max-h-[85vh] flex flex-col animate-in bg-[#FFF9E6]",children:[v.jsxs("div",{className:"p-3 sm:p-5 bg-[#54A0FF] border-b-3 border-[#2D3436] flex items-center justify-between",children:[v.jsxs("h3",{className:"font-black text-white flex items-center gap-2 text-lg sm:text-xl",children:[v.jsx(Tc,{size:24}),r.name," "]}),v.jsx("button",{onClick:e,className:"btn-pop p-2 bg-white text-[#2D3436]",children:v.jsx(Ss,{size:20})})]}),v.jsx("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 mobile-scroll-hide",children:o?v.jsx("div",{className:"flex items-center justify-center py-20",children:v.jsx("div",{className:"text-4xl animate-bounce",children:""})}):s.length===0?v.jsxs("div",{className:"text-center py-16",children:[v.jsx("div",{className:"text-5xl mb-4",children:""}),v.jsx("p",{className:"text-lg font-bold text-[#636E72]",children:""}),v.jsx("p",{className:"text-sm text-[#636E72]/70 mt-2",children:""})]}):v.jsx("div",{className:"space-y-3",children:s.map((g,x)=>{var y;return v.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg overflow-hidden shadow-[3px_3px_0_#2D3436]",children:[v.jsxs("div",{className:"px-3 py-2 bg-[#E8DCC8] border-b border-dashed border-[#2D3436]/20 flex items-center justify-between",children:[v.jsxs("span",{className:"text-xs font-bold text-[#636E72] flex items-center gap-1",children:[v.jsx(Tc,{size:12}),d(g.createdAt),x===0&&v.jsx("span",{className:"ml-2 px-2 py-0.5 bg-[#1DD1A1] text-white rounded-full text-[10px]",children:""})]}),v.jsxs("span",{className:"text-xs text-[#636E72]",children:[((y=g.comment)==null?void 0:y.length)||0," "]})]}),v.jsx("div",{className:"p-3 text-sm text-[#2D3436] leading-relaxed max-h-[120px] overflow-y-auto",children:g.comment}),v.jsxs("div",{className:"p-2 bg-[#FFF9E6] border-t border-dashed border-[#E8DCC8] flex items-center justify-end gap-2",children:[v.jsxs("button",{onClick:()=>u(g.comment),className:"btn-pop px-3 py-1.5 bg-[#54A0FF] text-white text-xs font-bold flex items-center gap-1",children:[v.jsx(e3,{size:12}),""]}),v.jsx("button",{onClick:()=>h(g.id),className:"btn-pop px-3 py-1.5 bg-[#FF6B6B] text-white text-xs font-bold flex items-center gap-1",children:v.jsx(Oc,{size:12})})]})]},g.id)})})}),v.jsxs("div",{className:"p-3 sm:p-4 bg-[#E8DCC8] border-t-2 border-dashed border-[#2D3436]/20 text-xs text-[#636E72] text-center",children:[" ",s.length,"  | "]})]})})},IR=({isOpen:t,onClose:e,currentUser:r})=>{const[n,s]=Te.useState([]),[i,o]=Te.useState([]),[c,u]=Te.useState([]),[h,d]=Te.useState(!0),[g,x]=Te.useState(null),[y,k]=Te.useState([]),[w,S]=Te.useState(null);Te.useEffect(()=>{if(!t)return;d(!0);const C=da.subscribeAll(M=>{s(M),d(!1)}),F=ha.subscribe(M=>{o(M)}),V=F0.subscribe(M=>{u(M)});return()=>{C(),F(),V()}},[t]);const N=C=>{x(C),k(C.assignedClasses||[]),S(C.schoolId||null)},B=C=>{k(F=>F.includes(C)?F.filter(V=>V!==C):[...F,C])},b=async()=>{g&&(await da.approve(g.id,y,w),x(null),k([]),S(null))},j=async()=>{g&&(await da.updateAssignedClasses(g.id,y,w),x(null),k([]),S(null))},X=async C=>{window.confirm("/")&&await da.reject(C)},G=C=>{switch(C){case Ur.ADMIN:return v.jsx("span",{className:"px-2 py-0.5 bg-[#FF6B9D] text-white text-xs font-bold rounded-full",children:""});case Ur.TEACHER:return v.jsx("span",{className:"px-2 py-0.5 bg-[#1DD1A1] text-white text-xs font-bold rounded-full",children:""});default:return v.jsx("span",{className:"px-2 py-0.5 bg-[#FECA57] text-[#2D3436] text-xs font-bold rounded-full",children:""})}},A=C=>C!=null&&C.toDate?C.toDate().toLocaleDateString("zh-TW"):"-";return t?v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-2 sm:p-4",children:v.jsxs("div",{className:"card-pop w-full max-w-4xl max-h-[90vh] flex flex-col animate-in bg-[#FFF9E6]",children:[v.jsxs("div",{className:"p-3 sm:p-5 bg-[#FF6B9D] border-b-3 border-[#2D3436] flex items-center justify-between",children:[v.jsxs("h3",{className:"font-black text-white flex items-center gap-2 text-lg sm:text-xl",children:[v.jsx(Vw,{size:24}),""]}),v.jsx("button",{onClick:e,className:"btn-pop p-2 bg-white text-[#2D3436]",children:v.jsx(Ss,{size:20})})]}),v.jsx("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 mobile-scroll-hide",children:h?v.jsx("div",{className:"flex items-center justify-center py-20",children:v.jsx("div",{className:"text-4xl animate-bounce",children:""})}):g?v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center gap-3 p-4 bg-white border-2 border-[#2D3436] rounded-lg",children:[g.photoURL?v.jsx("img",{src:g.photoURL,alt:"",className:"w-12 h-12 rounded-full border-2 border-[#2D3436]"}):v.jsx("div",{className:"w-12 h-12 bg-[#FECA57] rounded-full border-2 border-[#2D3436] flex items-center justify-center",children:""}),v.jsxs("div",{children:[v.jsx("div",{className:"font-bold text-[#2D3436]",children:g.displayName}),v.jsx("div",{className:"text-sm text-[#636E72]",children:g.email})]}),G(g.role)]}),v.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg p-4",children:[v.jsxs("h4",{className:"font-bold text-[#2D3436] mb-3 flex items-center gap-2",children:[v.jsx(WA,{size:18}),""]}),c.length===0?v.jsx(yy,{onAdd:async(C,F,V)=>{await F0.add({name:C,city:F,district:V})}}):v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(C=>v.jsxs("button",{onClick:()=>S(w===C.id?null:C.id),className:`px-3 py-2 border-2 border-[#2D3436] rounded-lg font-bold text-sm transition-all
                                                      ${w===C.id?"bg-[#A29BFE] text-white shadow-[2px_2px_0_#2D3436]":"bg-white hover:bg-[#A29BFE]/20"}`,children:[w===C.id&&v.jsx(ca,{size:14,className:"inline mr-1"})," ",C.name,C.city&&v.jsxs("span",{className:"text-xs opacity-70 ml-1",children:["(",C.city,")"]})]},C.id))}),v.jsx(yy,{compact:!0,onAdd:async(C,F,V)=>{await F0.add({name:C,city:F,district:V})}})]})]}),v.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg p-4",children:[v.jsxs("h4",{className:"font-bold text-[#2D3436] mb-3 flex items-center gap-2",children:[v.jsx(nf,{size:18}),""]}),i.length===0?v.jsx(_y,{onAdd:async C=>{await ha.add({name:C})}}):v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(C=>v.jsxs("button",{onClick:()=>B(C.id),className:`px-3 py-2 border-2 border-[#2D3436] rounded-lg font-bold text-sm transition-all
                          ${y.includes(C.id)?"bg-[#54A0FF] text-white shadow-[2px_2px_0_#2D3436]":"bg-white hover:bg-[#FECA57]/20"}`,children:[y.includes(C.id)&&v.jsx(ca,{size:14,className:"inline mr-1"}),C.name]},C.id))}),v.jsx(_y,{compact:!0,onAdd:async C=>{await ha.add({name:C})}})]})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>{x(null),k([])},className:"btn-pop px-4 py-2 bg-[#636E72] text-white font-bold",children:""}),g.role===Ur.PENDING?v.jsxs("button",{onClick:b,className:"btn-pop px-4 py-2 bg-[#1DD1A1] text-white font-bold flex-1 flex items-center justify-center gap-2",children:[v.jsx(ca,{size:18}),""]}):v.jsxs("button",{onClick:j,className:"btn-pop px-4 py-2 bg-[#54A0FF] text-white font-bold flex-1 flex items-center justify-center gap-2",children:[v.jsx(ca,{size:18}),""]})]})]}):v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[v.jsxs("div",{className:"bg-[#FECA57] text-[#2D3436] p-3 border-2 border-[#2D3436] rounded-lg text-center",children:[v.jsx("div",{className:"text-2xl font-black",children:n.filter(C=>C.role===Ur.PENDING).length}),v.jsx("div",{className:"text-xs font-bold",children:""})]}),v.jsxs("div",{className:"bg-[#1DD1A1] text-white p-3 border-2 border-[#2D3436] rounded-lg text-center",children:[v.jsx("div",{className:"text-2xl font-black",children:n.filter(C=>C.role===Ur.TEACHER).length}),v.jsx("div",{className:"text-xs font-bold",children:""})]}),v.jsxs("div",{className:"bg-[#FF6B9D] text-white p-3 border-2 border-[#2D3436] rounded-lg text-center",children:[v.jsx("div",{className:"text-2xl font-black",children:n.filter(C=>C.role===Ur.ADMIN).length}),v.jsx("div",{className:"text-xs font-bold",children:""})]})]}),n.filter(C=>C.role===Ur.PENDING).length>0&&v.jsxs("div",{className:"mb-4",children:[v.jsxs("h4",{className:"font-bold text-[#FECA57] mb-2 flex items-center gap-2",children:[v.jsx(Tc,{size:18})," (",n.filter(C=>C.role===Ur.PENDING).length,")"]}),n.filter(C=>C.role===Ur.PENDING).map(C=>v.jsx(vy,{user:C,onEdit:N,onReject:X,getRoleBadge:G,formatTime:A,classes:i},C.id))]}),v.jsxs("div",{children:[v.jsxs("h4",{className:"font-bold text-[#1DD1A1] mb-2 flex items-center gap-2",children:[v.jsx(s3,{size:18}),""]}),n.filter(C=>C.role!==Ur.PENDING).map(C=>v.jsx(vy,{user:C,onEdit:N,onReject:X,getRoleBadge:G,formatTime:A,classes:i,isCurrentUser:C.id===(r==null?void 0:r.uid)},C.id))]})]})}),v.jsxs("div",{className:"p-3 sm:p-4 bg-[#E8DCC8] border-t-2 border-dashed border-[#2D3436]/20 text-xs text-[#636E72] text-center",children:[" ",n.length,"  | "]})]})}):null},vy=({user:t,onEdit:e,onReject:r,getRoleBadge:n,formatTime:s,classes:i,isCurrentUser:o})=>{const c=(t.assignedClasses||[]).map(u=>{var h;return(h=i.find(d=>d.id===u))==null?void 0:h.name}).filter(Boolean).join(", ");return v.jsxs("div",{className:`p-3 bg-white border-2 border-[#2D3436] rounded-lg mb-2 flex items-center justify-between
      ${o?"ring-2 ring-[#FF6B9D]":""}`,children:[v.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL?v.jsx("img",{src:t.photoURL,alt:"",className:"w-10 h-10 rounded-full border-2 border-[#2D3436]"}):v.jsx("div",{className:"w-10 h-10 bg-[#FECA57] rounded-full border-2 border-[#2D3436] flex items-center justify-center text-lg",children:""}),v.jsxs("div",{children:[v.jsxs("div",{className:"font-bold text-[#2D3436] text-sm flex items-center gap-2",children:[t.displayName,n(t.role),o&&v.jsx("span",{className:"text-xs text-[#636E72]",children:"()"})]}),v.jsx("div",{className:"text-xs text-[#636E72]",children:t.email}),c&&v.jsxs("div",{className:"text-xs text-[#54A0FF] flex items-center gap-1 mt-0.5",children:[v.jsx(nf,{size:10}),c]})]})]}),v.jsx("div",{className:"flex items-center gap-1",children:t.role!==Ur.ADMIN&&v.jsxs(v.Fragment,{children:[v.jsx("button",{onClick:()=>e(t),className:"btn-pop px-3 py-1.5 bg-[#54A0FF] text-white text-xs font-bold",children:t.role===Ur.PENDING?"":""}),t.role===Ur.TEACHER&&v.jsx("button",{onClick:()=>r(t.id),className:"btn-pop p-1.5 bg-[#FF6B6B] text-white",children:v.jsx(Pw,{size:14})})]})})]})},_y=({onAdd:t,compact:e=!1})=>{const[r,n]=Te.useState(""),[s,i]=Te.useState(!1),o=async()=>{if(r.trim()){i(!0);try{await t(r.trim()),n("")}catch(u){console.error(":",u)}i(!1)}},c=u=>{u.key==="Enter"&&o()};return e?v.jsxs("div",{className:"flex gap-2 items-center pt-2 border-t border-dashed border-[#2D3436]/20",children:[v.jsx("input",{type:"text",value:r,onChange:u=>n(u.target.value),onKeyDown:c,placeholder:"...",className:"flex-1 px-3 py-1.5 border-2 border-[#2D3436] rounded-lg text-sm",disabled:s}),v.jsx("button",{onClick:o,disabled:!r.trim()||s,className:"btn-pop px-3 py-1.5 bg-[#1DD1A1] text-white text-xs font-bold disabled:opacity-50",children:s?"...":"+ "})]}):v.jsxs("div",{className:"space-y-3",children:[v.jsx("p",{className:"text-sm text-[#636E72]",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"text",value:r,onChange:u=>n(u.target.value),onKeyDown:c,placeholder:" ()",className:"flex-1 px-3 py-2 border-2 border-[#2D3436] rounded-lg font-medium",disabled:s}),v.jsx("button",{onClick:o,disabled:!r.trim()||s,className:"btn-pop px-4 py-2 bg-[#1DD1A1] text-white font-bold disabled:opacity-50 flex items-center gap-1",children:s?"...":v.jsxs(v.Fragment,{children:[v.jsx("span",{children:"+"})," "]})})]})]})},yy=({onAdd:t,compact:e=!1})=>{const[r,n]=Te.useState(""),[s,i]=Te.useState(""),[o,c]=Te.useState(!1),u=async()=>{if(r.trim()){c(!0);try{await t(r.trim(),s.trim()||null,null),n(""),i("")}catch(g){console.error(":",g)}c(!1)}},h=g=>{g.key==="Enter"&&u()},d=["","","","","","","","","","","","","","","","","","","","","",""];return e?v.jsxs("div",{className:"flex gap-2 items-center pt-2 border-t border-dashed border-[#2D3436]/20",children:[v.jsxs("select",{value:s,onChange:g=>i(g.target.value),className:"px-2 py-1.5 border-2 border-[#2D3436] rounded-lg text-sm bg-white",disabled:o,children:[v.jsx("option",{value:"",children:""}),d.map(g=>v.jsx("option",{value:g,children:g},g))]}),v.jsx("input",{type:"text",value:r,onChange:g=>n(g.target.value),onKeyDown:h,placeholder:"...",className:"flex-1 px-3 py-1.5 border-2 border-[#2D3436] rounded-lg text-sm",disabled:o}),v.jsx("button",{onClick:u,disabled:!r.trim()||o,className:"btn-pop px-3 py-1.5 bg-[#A29BFE] text-white text-xs font-bold disabled:opacity-50",children:o?"...":"+ "})]}):v.jsxs("div",{className:"space-y-3",children:[v.jsx("p",{className:"text-sm text-[#636E72]",children:""}),v.jsxs("div",{className:"flex gap-2 flex-wrap",children:[v.jsxs("select",{value:s,onChange:g=>i(g.target.value),className:"px-3 py-2 border-2 border-[#2D3436] rounded-lg font-medium bg-white",disabled:o,children:[v.jsx("option",{value:"",children:""}),d.map(g=>v.jsx("option",{value:g,children:g},g))]}),v.jsx("input",{type:"text",value:r,onChange:g=>n(g.target.value),onKeyDown:h,placeholder:" ()",className:"flex-1 min-w-[200px] px-3 py-2 border-2 border-[#2D3436] rounded-lg font-medium",disabled:o}),v.jsx("button",{onClick:u,disabled:!r.trim()||o,className:"btn-pop px-4 py-2 bg-[#A29BFE] text-white font-bold disabled:opacity-50 flex items-center gap-1",children:o?"...":v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""})," "]})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Q0={};Q0.version="0.18.5";var hS=1252,FR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],L1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},M1=function(t){FR.indexOf(t)!=-1&&(hS=L1[0]=t)};function bR(){M1(1252)}var ii=function(t){M1(t)};function B1(){ii(1200),bR()}function wy(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function NR(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function dS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Mu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?NR(t.slice(2)):e==254&&r==255?dS(t.slice(2)):e==65279?t.slice(1):t},l0=function(e){return String.fromCharCode(e)},Ey=function(e){return String.fromCharCode(e)},mf,ro="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function gf(t){for(var e="",r=0,n=0,s=0,i=0,o=0,c=0,u=0,h=0;h<t.length;)r=t.charCodeAt(h++),i=r>>2,n=t.charCodeAt(h++),o=(r&3)<<4|n>>4,s=t.charCodeAt(h++),c=(n&15)<<2|s>>6,u=s&63,isNaN(n)?c=u=64:isNaN(s)&&(u=64),e+=ro.charAt(i)+ro.charAt(o)+ro.charAt(c)+ro.charAt(u);return e}function ks(t){var e="",r=0,n=0,s=0,i=0,o=0,c=0,u=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)i=ro.indexOf(t.charAt(h++)),o=ro.indexOf(t.charAt(h++)),r=i<<2|o>>4,e+=String.fromCharCode(r),c=ro.indexOf(t.charAt(h++)),n=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(n)),u=ro.indexOf(t.charAt(h++)),s=(c&3)<<6|u,u!==64&&(e+=String.fromCharCode(s));return e}var _t=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ka=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function go(t){return _t?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Ty(t){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ws=function(e){return _t?ka(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Rd(t){if(typeof ArrayBuffer>"u")return ws(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function To(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function RR(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function V1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return V1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var an=_t?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ka(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function DR(t){for(var e=[],r=0,n=t.length+250,s=go(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=t.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|c>>6&15|(o&3)<<4,s[r++]=128|c&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(e.push(s.slice(0,r)),r=0,s=go(65535),n=65530)}return e.push(s.slice(0,r)),an(e)}var qn=/\u0000/g,Bu=/[\u0001-\u0006]/g;function _c(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ai(t,e){var r=""+t;return r.length>=e?r:wr("0",e-r.length)+r}function j1(t,e){var r=""+t;return r.length>=e?r:wr(" ",e-r.length)+r}function J0(t,e){var r=""+t;return r.length>=e?r:r+wr(" ",e-r.length)}function PR(t,e){var r=""+Math.round(t);return r.length>=e?r:wr("0",e-r.length)+r}function OR(t,e){var r=""+t;return r.length>=e?r:wr("0",e-r.length)+r}var Sy=Math.pow(2,32);function sc(t,e){if(t>Sy||t<-Sy)return PR(t,e);var r=Math.round(t);return OR(r,e)}function Z0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var ky=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function LR(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ay={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},MR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ed(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,o=1,c=0,u=1,h=0,d=0,g=Math.floor(s);h<e&&(g=Math.floor(s),c=g*o+i,d=g*h+u,!(s-g<5e-8));)s=1/(s-g),i=o,o=c,u=h,h=d;if(d>e&&(h>e?(d=u,c=i):(d=h,c=o)),!r)return[0,n*c,d];var x=Math.floor(n*c/d);return[x,n*c-x*d,d]}function Yo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,o=[],c={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++n,++c.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),n<60&&(i=(i+6)%7),r&&(i=WR(u,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=i,c}var pS=new Date(1899,11,31,0,0,0),BR=pS.getTime(),VR=new Date(1900,2,1,0,0,0);function mS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=VR&&(r+=1440*60*1e3),(r-(BR+(t.getTimezoneOffset()-pS.getTimezoneOffset())*6e4))/(1440*60*1e3)}function U1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jR(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function UR(t){var e=t<0?12:11,r=U1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function zR(t){var e=U1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function xf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=UR(t):e===10?r=t.toFixed(10).substr(0,12):r=zR(t),U1(jR(r.toUpperCase()))}function fl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):xf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return $s(14,mS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function WR(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function HR(t,e,r,n){var s="",i=0,o=0,c=r.y,u,h=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:u=c%100,h=2;break;default:u=c%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:u=r.m,h=e.length;break;case 3:return Rm[r.m-1][1];case 5:return Rm[r.m-1][0];default:return Rm[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:u=r.d,h=e.length;break;case 3:return ky[r.q][0];default:return ky[r.q][1]}break;case 104:switch(e.length){case 1:case 2:u=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:u=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:u=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ai(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(s=ai(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:u=c,h=1;break}var d=h>0?ai(u,h):"";return d}function no(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var gS=/%/g;function $R(t,e,r){var n=e.replace(gS,""),s=e.length-n.length;return ga(t,n,r*Math.pow(10,2*s))+wr("%",s)}function GR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ga(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function xS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+xS(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var vS=/# (\?+)( ?)\/( ?)(\d+)/;function KR(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),o=s-i*n,c=n;return r+(i===0?"":""+i)+" "+(o===0?wr(" ",t[1].length+1+t[4].length):j1(o,t[1].length)+t[2]+"/"+t[3]+ai(c,t[4].length))}function qR(t,e,r){return r+(e===0?"":""+e)+wr(" ",t[1].length+2+t[4].length)}var _S=/^#*0*\.([0#]+)/,yS=/\).*[0#]/,wS=/\(###\) ###\\?-####/;function Hn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Cy(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Iy(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function XR(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function YR(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Bs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Bs("n",n,r):"("+Bs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return GR(t,e,r);if(e.indexOf("%")!==-1)return $R(t,e,r);if(e.indexOf("E")!==-1)return xS(e,r);if(e.charCodeAt(0)===36)return"$"+Bs(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+sc(u,e.length);if(e.match(/^[#?]+$/))return s=sc(r,0),s==="0"&&(s=""),s.length>e.length?s:Hn(e.substr(0,e.length-s.length))+s;if(i=e.match(vS))return KR(i,u,h);if(e.match(/^#+0+$/))return h+sc(u,e.length-e.indexOf("0"));if(i=e.match(_S))return s=Cy(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Hn(i[1])).replace(/\.$/,"."+Hn(i[1])).replace(/\.(\d*)$/,function(k,w){return"."+w+wr("0",Hn(i[1]).length-w.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+Cy(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+no(sc(u,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Bs(t,e,-r):no(""+(Math.floor(r)+XR(r,i[1].length)))+"."+ai(Iy(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Bs(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=_c(Bs(t,e.replace(/[\\-]/g,""),r)),o=0,_c(_c(e.replace(/\\/g,"")).replace(/[0#]/g,function(k){return o<s.length?s.charAt(o++):k==="0"?"0":""}));if(e.match(wS))return s=Bs(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=ed(u,Math.pow(10,o)-1,!1),s=""+h,d=ga("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=J0(c[2],o),d.length<i[4].length&&(d=Hn(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=ed(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?j1(c[1],o)+i[2]+"/"+i[3]+J0(c[2],o):wr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=sc(r,0),e.length<=s.length?s:Hn(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=e.indexOf(".")-o,x=e.length-s.length-g;return Hn(e.substr(0,g)+s+e.substr(e.length-x))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=Iy(r,i[1].length),r<0?"-"+Bs(t,e,-r):no(YR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?ai(0,3-k.length):"")+k})+"."+ai(o,i[1].length);switch(e){case"###,##0.00":return Bs(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=no(sc(u,0));return y!=="0"?h+y:"";case"###,###.00":return Bs(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Bs(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function QR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ga(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function JR(t,e,r){var n=e.replace(gS,""),s=e.length-n.length;return ga(t,n,r*Math.pow(10,2*s))+wr("%",s)}function ES(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ES(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ni(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ni("n",n,r):"("+Ni("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return QR(t,e,r);if(e.indexOf("%")!==-1)return JR(t,e,r);if(e.indexOf("E")!==-1)return ES(e,r);if(e.charCodeAt(0)===36)return"$"+Ni(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+ai(u,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Hn(e.substr(0,e.length-s.length))+s;if(i=e.match(vS))return qR(i,u,h);if(e.match(/^#+0+$/))return h+ai(u,e.length-e.indexOf("0"));if(i=e.match(_S))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Hn(i[1])).replace(/\.$/,"."+Hn(i[1])),s=s.replace(/\.(\d*)$/,function(k,w){return"."+w+wr("0",Hn(i[1]).length-w.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+no(""+u);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ni(t,e,-r):no(""+r)+"."+wr("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Ni(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=_c(Ni(t,e.replace(/[\\-]/g,""),r)),o=0,_c(_c(e.replace(/\\/g,"")).replace(/[0#]/g,function(k){return o<s.length?s.charAt(o++):k==="0"?"0":""}));if(e.match(wS))return s=Ni(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=ed(u,Math.pow(10,o)-1,!1),s=""+h,d=ga("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=J0(c[2],o),d.length<i[4].length&&(d=Hn(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=ed(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?j1(c[1],o)+i[2]+"/"+i[3]+J0(c[2],o):wr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Hn(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=e.indexOf(".")-o,x=e.length-s.length-g;return Hn(e.substr(0,g)+s+e.substr(e.length-x))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ni(t,e,-r):no(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?ai(0,3-k.length):"")+k})+"."+ai(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=no(""+u);return y!=="0"?h+y:"";default:if(e.match(/\.[0#?]*$/))return Ni(t,e.slice(0,e.lastIndexOf(".")),r)+Hn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ga(t,e,r){return(r|0)===r?Ni(t,e,r):Bs(t,e,r)}function ZR(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var TS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Hc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Z0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(TS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function eD(t,e,r,n){for(var s=[],i="",o=0,c="",u="t",h,d,g,x="H";o<t.length;)switch(c=t.charAt(o)){case"G":if(!Z0(t,o))throw new Error("unrecognized character "+c+" in "+t);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(g=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(g);s[s.length]={t:"t",v:i},++o;break;case"\\":var y=t.charAt(++o),k=y==="("||y===")"?y:"t";s[s.length]={t:k,v:y},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(h==null&&(h=Yo(e,r,t.charAt(o+1)==="2"),h==null))return"";s[s.length]={t:"X",v:t.substr(o,2)},u=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=Yo(e,r),h==null))return"";for(i=c;++o<t.length&&t.charAt(o).toLowerCase()===c;)i+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),s[s.length]={t:c,v:i},u=c;break;case"A":case"a":case"":var w={t:c,v:c};if(h==null&&(h=Yo(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(w.v=h.H>=12?"P":"A"),w.t="T",x="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(w.v=h.H>=12?"PM":"AM"),w.t="T",o+=5,x="h"):t.substr(o,5).toUpperCase()==="/"?(h!=null&&(w.v=h.H>=12?"":""),w.t="T",o+=5,x="h"):(w.t="t",++o),h==null&&w.t==="T")return"";s[s.length]=w,u=c;break;case"[":for(i=c;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(TS)){if(h==null&&(h=Yo(e,r),h==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Hc(t)||(s[s.length]={t:"t",v:i}));break;case".":if(h!=null){for(i=c;++o<t.length&&(c=t.charAt(o))==="0";)i+=c;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++o<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(o))>-1;)i+=c;s[s.length]={t:"n",v:i};break;case"?":for(i=c;t.charAt(++o)===c;)i+=c;s[s.length]={t:c,v:i},u=c;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:c,v:c},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);s[s.length]={t:"t",v:c},++o;break}var S=0,N=0,B;for(o=s.length-1,u="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=x,u="h",S<1&&(S=1);break;case"s":(B=s[o].v.match(/\.0+$/))&&(N=Math.max(N,B[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":u=s[o].t;break;case"m":u==="s"&&(s[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&s[o].v.match(/[Hh]/)&&(S=1),S<2&&s[o].v.match(/[Mm]/)&&(S=2),S<3&&s[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var b="",j;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=HR(s[o].t.charCodeAt(0),s[o].v,h,N),s[o].t="t";break;case"n":case"?":for(j=o+1;s[j]!=null&&((c=s[j].t)==="?"||c==="D"||(c===" "||c==="t")&&s[j+1]!=null&&(s[j+1].t==="?"||s[j+1].t==="t"&&s[j+1].v==="/")||s[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[j].v==="/"||s[j].v===" "&&s[j+1]!=null&&s[j+1].t=="?"));)s[o].v+=s[j].v,s[j]={v:"",t:";"},++j;b+=s[o].v,o=j-1;break;case"G":s[o].t="t",s[o].v=fl(e,r);break}var X="",G,A;if(b.length>0){b.charCodeAt(0)==40?(G=e<0&&b.charCodeAt(0)===45?-e:e,A=ga("n",b,G)):(G=e<0&&n>1?-e:e,A=ga("n",b,G),G<0&&s[0]&&s[0].t=="t"&&(A=A.substr(1),s[0].v="-"+s[0].v)),j=A.length-1;var C=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){C=o;break}var F=s.length;if(C===s.length&&A.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(j>=s[o].v.length-1?(j-=s[o].v.length,s[o].v=A.substr(j+1,s[o].v.length)):j<0?s[o].v="":(s[o].v=A.substr(0,j+1),j=-1),s[o].t="t",F=o);j>=0&&F<s.length&&(s[F].v=A.substr(0,j+1)+s[F].v)}else if(C!==s.length&&A.indexOf("E")===-1){for(j=A.indexOf(".")-1,o=C;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(d=s[o].v.indexOf(".")>-1&&o===C?s[o].v.indexOf(".")-1:s[o].v.length-1,X=s[o].v.substr(d+1);d>=0;--d)j>=0&&(s[o].v.charAt(d)==="0"||s[o].v.charAt(d)==="#")&&(X=A.charAt(j--)+X);s[o].v=X,s[o].t="t",F=o}for(j>=0&&F<s.length&&(s[F].v=A.substr(0,j+1)+s[F].v),j=A.indexOf(".")+1,o=C;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==C)){for(d=s[o].v.indexOf(".")>-1&&o===C?s[o].v.indexOf(".")+1:0,X=s[o].v.substr(0,d);d<s[o].v.length;++d)j<A.length&&(X+=A.charAt(j++));s[o].v=X,s[o].t="t",F=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(G=n>1&&e<0&&o>0&&s[o-1].v==="-"?-e:e,s[o].v=ga(s[o].t,s[o].v,G),s[o].t="t");var V="";for(o=0;o!==s.length;++o)s[o]!=null&&(V+=s[o].v);return V}var Fy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function by(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function tD(t,e){var r=ZR(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Fy),c=r[1].match(Fy);return by(e,o)?[n,r[0]]:by(e,c)?[n,r[1]]:[n,r[o!=null&&c!=null?2:1]]}return[n,i]}function $s(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:nt)[t],n==null&&(n=r.table&&r.table[Ay[t]]||nt[Ay[t]]),n==null&&(n=MR[t]||"General");break}if(Z0(n,0))return fl(e,r);e instanceof Date&&(e=mS(e,r.date1904));var s=tD(n,e);if(Z0(s[1]))return fl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return eD(s[1],e,r,s[0])}function xa(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(nt[r]==null){e<0&&(e=r);continue}if(nt[r]==t){e=r;break}}e<0&&(e=391)}return nt[e]=t,e}function Dd(t){for(var e=0;e!=392;++e)t[e]!==void 0&&xa(t[e],e)}function $c(){nt=LR()}var rD={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},SS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function nD(t){var e=typeof t=="number"?nt[t]:t;return e=e.replace(SS,"(\\d+)"),new RegExp("^"+e+"$")}function sD(t,e,r){var n=-1,s=-1,i=-1,o=-1,c=-1,u=-1;(e.match(SS)||[]).forEach(function(g,x){var y=parseInt(r[x+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=y;break;case"d":i=y;break;case"h":o=y;break;case"s":u=y;break;case"m":o>=0?c=y:s=y;break}}),u>=0&&c==-1&&s>=0&&(c=s,s=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&c==-1&&u==-1?h:n==-1&&s==-1&&i==-1?d:h+"T"+d}var iD=(function(){var t={};t.version="1.2.0";function e(){for(var A=0,C=new Array(256),F=0;F!=256;++F)A=F,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,C[F]=A;return typeof Int32Array<"u"?new Int32Array(C):C}var r=e();function n(A){var C=0,F=0,V=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)M[V]=A[V];for(V=0;V!=256;++V)for(F=A[V],C=256+V;C<4096;C+=256)F=M[C]=F>>>8^A[F&255];var D=[];for(V=1;V!=16;++V)D[V-1]=typeof Int32Array<"u"?M.subarray(V*256,V*256+256):M.slice(V*256,V*256+256);return D}var s=n(r),i=s[0],o=s[1],c=s[2],u=s[3],h=s[4],d=s[5],g=s[6],x=s[7],y=s[8],k=s[9],w=s[10],S=s[11],N=s[12],B=s[13],b=s[14];function j(A,C){for(var F=C^-1,V=0,M=A.length;V<M;)F=F>>>8^r[(F^A.charCodeAt(V++))&255];return~F}function X(A,C){for(var F=C^-1,V=A.length-15,M=0;M<V;)F=b[A[M++]^F&255]^B[A[M++]^F>>8&255]^N[A[M++]^F>>16&255]^S[A[M++]^F>>>24]^w[A[M++]]^k[A[M++]]^y[A[M++]]^x[A[M++]]^g[A[M++]]^d[A[M++]]^h[A[M++]]^u[A[M++]]^c[A[M++]]^o[A[M++]]^i[A[M++]]^r[A[M++]];for(V+=15;M<V;)F=F>>>8^r[(F^A[M++])&255];return~F}function G(A,C){for(var F=C^-1,V=0,M=A.length,D=0,L=0;V<M;)D=A.charCodeAt(V++),D<128?F=F>>>8^r[(F^D)&255]:D<2048?(F=F>>>8^r[(F^(192|D>>6&31))&255],F=F>>>8^r[(F^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,L=A.charCodeAt(V++)&1023,F=F>>>8^r[(F^(240|D>>8&7))&255],F=F>>>8^r[(F^(128|D>>2&63))&255],F=F>>>8^r[(F^(128|L>>6&15|(D&3)<<4))&255],F=F>>>8^r[(F^(128|L&63))&255]):(F=F>>>8^r[(F^(224|D>>12&15))&255],F=F>>>8^r[(F^(128|D>>6&63))&255],F=F>>>8^r[(F^(128|D&63))&255]);return~F}return t.table=r,t.bstr=j,t.buf=X,t.str=G,t})(),Ze=(function(){var e={};e.version="1.2.1";function r(P,H){for(var z=P.split("/"),W=H.split("/"),K=0,q=0,ce=Math.min(z.length,W.length);K<ce;++K){if(q=z[K].length-W[K].length)return q;if(z[K]!=W[K])return z[K]<W[K]?-1:1}return z.length-W.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var H=P.lastIndexOf("/");return H===-1?P:P.slice(0,H+1)}function s(P){if(P.charAt(P.length-1)=="/")return s(P.slice(0,-1));var H=P.lastIndexOf("/");return H===-1?P:P.slice(H+1)}function i(P,H){typeof H=="string"&&(H=new Date(H));var z=H.getHours();z=z<<6|H.getMinutes(),z=z<<5|H.getSeconds()>>>1,P.write_shift(2,z);var W=H.getFullYear()-1980;W=W<<4|H.getMonth()+1,W=W<<5|H.getDate(),P.write_shift(2,W)}function o(P){var H=P.read_shift(2)&65535,z=P.read_shift(2)&65535,W=new Date,K=z&31;z>>>=5;var q=z&15;z>>>=4,W.setMilliseconds(0),W.setFullYear(z+1980),W.setMonth(q-1),W.setDate(K);var ce=H&31;H>>>=5;var ge=H&63;return H>>>=6,W.setHours(H),W.setMinutes(ge),W.setSeconds(ce<<1),W}function c(P){gn(P,0);for(var H={},z=0;P.l<=P.length-4;){var W=P.read_shift(2),K=P.read_shift(2),q=P.l+K,ce={};switch(W){case 21589:z=P.read_shift(1),z&1&&(ce.mtime=P.read_shift(4)),K>5&&(z&2&&(ce.atime=P.read_shift(4)),z&4&&(ce.ctime=P.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}P.l=q,H[W]=ce}return H}var u;function h(){return u||(u={})}function d(P,H){if(P[0]==80&&P[1]==75)return Yn(P,H);if((P[0]|32)==109&&(P[1]|32)==105)return Ut(P,H);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var z=3,W=512,K=0,q=0,ce=0,ge=0,le=0,fe=[],he=P.slice(0,512);gn(he,0);var Re=g(he);switch(z=Re[0],z){case 3:W=512;break;case 4:W=4096;break;case 0:if(Re[1]==0)return Yn(P,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}W!==512&&(he=P.slice(0,W),gn(he,28));var Be=P.slice(0,W);x(he,z);var We=he.read_shift(4,"i");if(z===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);he.l+=4,ce=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),ge=he.read_shift(4,"i"),K=he.read_shift(4,"i"),le=he.read_shift(4,"i"),q=he.read_shift(4,"i");for(var Pe=-1,Oe=0;Oe<109&&(Pe=he.read_shift(4,"i"),!(Pe<0));++Oe)fe[Oe]=Pe;var ct=y(P,W);S(le,q,ct,W,fe);var zt=B(ct,ce,fe,W);zt[ce].name="!Directory",K>0&&ge!==L&&(zt[ge].name="!MiniFAT"),zt[fe[0]].name="!FAT",zt.fat_addrs=fe,zt.ssz=W;var Gt={},cr=[],qs=[],Fs=[];b(ce,zt,ct,cr,K,Gt,qs,ge),k(qs,Fs,cr),cr.shift();var fs={FileIndex:qs,FullPaths:Fs};return H&&H.raw&&(fs.raw={header:Be,sectors:ct}),fs}function g(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(ke,"Header Signature: "),P.l+=16;var H=P.read_shift(2,"u");return[P.read_shift(2,"u"),H]}function x(P,H){var z=9;switch(P.l+=2,z=P.read_shift(2)){case 9:if(H!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(H!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function y(P,H){for(var z=Math.ceil(P.length/H)-1,W=[],K=1;K<z;++K)W[K-1]=P.slice(K*H,(K+1)*H);return W[z-1]=P.slice(z*H),W}function k(P,H,z){for(var W=0,K=0,q=0,ce=0,ge=0,le=z.length,fe=[],he=[];W<le;++W)fe[W]=he[W]=W,H[W]=z[W];for(;ge<he.length;++ge)W=he[ge],K=P[W].L,q=P[W].R,ce=P[W].C,fe[W]===W&&(K!==-1&&fe[K]!==K&&(fe[W]=fe[K]),q!==-1&&fe[q]!==q&&(fe[W]=fe[q])),ce!==-1&&(fe[ce]=W),K!==-1&&W!=fe[W]&&(fe[K]=fe[W],he.lastIndexOf(K)<ge&&he.push(K)),q!==-1&&W!=fe[W]&&(fe[q]=fe[W],he.lastIndexOf(q)<ge&&he.push(q));for(W=1;W<le;++W)fe[W]===W&&(q!==-1&&fe[q]!==q?fe[W]=fe[q]:K!==-1&&fe[K]!==K&&(fe[W]=fe[K]));for(W=1;W<le;++W)if(P[W].type!==0){if(ge=W,ge!=fe[ge])do ge=fe[ge],H[W]=H[ge]+"/"+H[W];while(ge!==0&&fe[ge]!==-1&&ge!=fe[ge]);fe[W]=-1}for(H[0]+="/",W=1;W<le;++W)P[W].type!==2&&(H[W]+="/")}function w(P,H,z){for(var W=P.start,K=P.size,q=[],ce=W;z&&K>0&&ce>=0;)q.push(H.slice(ce*D,ce*D+D)),K-=D,ce=Ko(z,ce*4);return q.length===0?me(0):an(q).slice(0,P.size)}function S(P,H,z,W,K){var q=L;if(P===L){if(H!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var ce=z[P],ge=(W>>>2)-1;if(!ce)return;for(var le=0;le<ge&&(q=Ko(ce,le*4))!==L;++le)K.push(q);S(Ko(ce,W-4),H-1,z,W,K)}}function N(P,H,z,W,K){var q=[],ce=[];K||(K=[]);var ge=W-1,le=0,fe=0;for(le=H;le>=0;){K[le]=!0,q[q.length]=le,ce.push(P[le]);var he=z[Math.floor(le*4/W)];if(fe=le*4&ge,W<4+fe)throw new Error("FAT boundary crossed: "+le+" 4 "+W);if(!P[he])break;le=Ko(P[he],fe)}return{nodes:q,data:zy([ce])}}function B(P,H,z,W){var K=P.length,q=[],ce=[],ge=[],le=[],fe=W-1,he=0,Re=0,Be=0,We=0;for(he=0;he<K;++he)if(ge=[],Be=he+H,Be>=K&&(Be-=K),!ce[Be]){le=[];var Pe=[];for(Re=Be;Re>=0;){Pe[Re]=!0,ce[Re]=!0,ge[ge.length]=Re,le.push(P[Re]);var Oe=z[Math.floor(Re*4/W)];if(We=Re*4&fe,W<4+We)throw new Error("FAT boundary crossed: "+Re+" 4 "+W);if(!P[Oe]||(Re=Ko(P[Oe],We),Pe[Re]))break}q[Be]={nodes:ge,data:zy([le])}}return q}function b(P,H,z,W,K,q,ce,ge){for(var le=0,fe=W.length?2:0,he=H[P].data,Re=0,Be=0,We;Re<he.length;Re+=128){var Pe=he.slice(Re,Re+128);gn(Pe,64),Be=Pe.read_shift(2),We=q1(Pe,0,Be-fe),W.push(We);var Oe={name:We,type:Pe.read_shift(1),color:Pe.read_shift(1),L:Pe.read_shift(4,"i"),R:Pe.read_shift(4,"i"),C:Pe.read_shift(4,"i"),clsid:Pe.read_shift(16),state:Pe.read_shift(4,"i"),start:0,size:0},ct=Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2);ct!==0&&(Oe.ct=j(Pe,Pe.l-8));var zt=Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2)+Pe.read_shift(2);zt!==0&&(Oe.mt=j(Pe,Pe.l-8)),Oe.start=Pe.read_shift(4,"i"),Oe.size=Pe.read_shift(4,"i"),Oe.size<0&&Oe.start<0&&(Oe.size=Oe.type=0,Oe.start=L,Oe.name=""),Oe.type===5?(le=Oe.start,K>0&&le!==L&&(H[le].name="!StreamData")):Oe.size>=4096?(Oe.storage="fat",H[Oe.start]===void 0&&(H[Oe.start]=N(z,Oe.start,H.fat_addrs,H.ssz)),H[Oe.start].name=Oe.name,Oe.content=H[Oe.start].data.slice(0,Oe.size)):(Oe.storage="minifat",Oe.size<0?Oe.size=0:le!==L&&Oe.start!==L&&H[le]&&(Oe.content=w(Oe,H[le].data,(H[ge]||{}).data))),Oe.content&&gn(Oe.content,0),q[We]=Oe,ce.push(Oe)}}function j(P,H){return new Date((ys(P,H+4)/1e7*Math.pow(2,32)+ys(P,H)/1e7-11644473600)*1e3)}function X(P,H){return h(),d(u.readFileSync(P),H)}function G(P,H){var z=H&&H.type;switch(z||_t&&Buffer.isBuffer(P)&&(z="buffer"),z||"base64"){case"file":return X(P,H);case"base64":return d(ws(ks(P)),H);case"binary":return d(ws(P),H)}return d(P,H)}function A(P,H){var z=H||{},W=z.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=W+"/",P.FileIndex[0]={name:W,type:5}),z.CLSID&&(P.FileIndex[0].clsid=z.CLSID),C(P)}function C(P){var H="Sh33tJ5";if(!Ze.find(P,"/"+H)){var z=me(4);z[0]=55,z[1]=z[3]=50,z[2]=54,P.FileIndex.push({name:H,type:2,content:z,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+H),F(P)}}function F(P,H){A(P);for(var z=!1,W=!1,K=P.FullPaths.length-1;K>=0;--K){var q=P.FileIndex[K];switch(q.type){case 0:W?z=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(q.R*q.L*q.C)&&(z=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!H)){var ce=new Date(1987,1,19),ge=0,le=Object.create?Object.create(null):{},fe=[];for(K=0;K<P.FullPaths.length;++K)le[P.FullPaths[K]]=!0,P.FileIndex[K].type!==0&&fe.push([P.FullPaths[K],P.FileIndex[K]]);for(K=0;K<fe.length;++K){var he=n(fe[K][0]);W=le[he],W||(fe.push([he,{name:s(he).replace("/",""),type:1,clsid:De,ct:ce,mt:ce,content:null}]),le[he]=!0)}for(fe.sort(function(We,Pe){return r(We[0],Pe[0])}),P.FullPaths=[],P.FileIndex=[],K=0;K<fe.length;++K)P.FullPaths[K]=fe[K][0],P.FileIndex[K]=fe[K][1];for(K=0;K<fe.length;++K){var Re=P.FileIndex[K],Be=P.FullPaths[K];if(Re.name=s(Be).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||De,K===0)Re.C=fe.length>1?1:-1,Re.size=0,Re.type=5;else if(Be.slice(-1)=="/"){for(ge=K+1;ge<fe.length&&n(P.FullPaths[ge])!=Be;++ge);for(Re.C=ge>=fe.length?-1:ge,ge=K+1;ge<fe.length&&n(P.FullPaths[ge])!=n(Be);++ge);Re.R=ge>=fe.length?-1:ge,Re.type=1}else n(P.FullPaths[K+1]||"")==n(Be)&&(Re.R=K+1),Re.type=2}}}function V(P,H){var z=H||{};if(z.fileType=="mad")return rr(P,z);switch(F(P),z.fileType){case"zip":return Zt(P,z)}var W=(function(We){for(var Pe=0,Oe=0,ct=0;ct<We.FileIndex.length;++ct){var zt=We.FileIndex[ct];if(zt.content){var Gt=zt.content.length;Gt>0&&(Gt<4096?Pe+=Gt+63>>6:Oe+=Gt+511>>9)}}for(var cr=We.FullPaths.length+3>>2,qs=Pe+7>>3,Fs=Pe+127>>7,fs=qs+Oe+cr+Fs,Ar=fs+127>>7,Fa=Ar<=109?0:Math.ceil((Ar-109)/127);fs+Ar+Fa+127>>7>Ar;)Fa=++Ar<=109?0:Math.ceil((Ar-109)/127);var dr=[1,Fa,Ar,Fs,cr,Oe,Pe,0];return We.FileIndex[0].size=Pe<<6,dr[7]=(We.FileIndex[0].start=dr[0]+dr[1]+dr[2]+dr[3]+dr[4]+dr[5])+(dr[6]+7>>3),dr})(P),K=me(W[7]<<9),q=0,ce=0;{for(q=0;q<8;++q)K.write_shift(1,Se[q]);for(q=0;q<8;++q)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),q=0;q<3;++q)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,W[2]),K.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:L),K.write_shift(4,W[3]),K.write_shift(-4,W[1]?W[0]-1:L),K.write_shift(4,W[1]),q=0;q<109;++q)K.write_shift(-4,q<W[2]?W[1]+q:-1)}if(W[1])for(ce=0;ce<W[1];++ce){for(;q<236+ce*127;++q)K.write_shift(-4,q<W[2]?W[1]+q:-1);K.write_shift(-4,ce===W[1]-1?L:ce+1)}var ge=function(We){for(ce+=We;q<ce-1;++q)K.write_shift(-4,q+1);We&&(++q,K.write_shift(-4,L))};for(ce=q=0,ce+=W[1];q<ce;++q)K.write_shift(-4,Ne.DIFSECT);for(ce+=W[2];q<ce;++q)K.write_shift(-4,Ne.FATSECT);ge(W[3]),ge(W[4]);for(var le=0,fe=0,he=P.FileIndex[0];le<P.FileIndex.length;++le)he=P.FileIndex[le],he.content&&(fe=he.content.length,!(fe<4096)&&(he.start=ce,ge(fe+511>>9)));for(ge(W[6]+7>>3);K.l&511;)K.write_shift(-4,Ne.ENDOFCHAIN);for(ce=q=0,le=0;le<P.FileIndex.length;++le)he=P.FileIndex[le],he.content&&(fe=he.content.length,!(!fe||fe>=4096)&&(he.start=ce,ge(fe+63>>6)));for(;K.l&511;)K.write_shift(-4,Ne.ENDOFCHAIN);for(q=0;q<W[4]<<2;++q){var Re=P.FullPaths[q];if(!Re||Re.length===0){for(le=0;le<17;++le)K.write_shift(4,0);for(le=0;le<3;++le)K.write_shift(4,-1);for(le=0;le<12;++le)K.write_shift(4,0);continue}he=P.FileIndex[q],q===0&&(he.start=he.size?he.start-1:L);var Be=q===0&&z.root||he.name;if(fe=2*(Be.length+1),K.write_shift(64,Be,"utf16le"),K.write_shift(2,fe),K.write_shift(1,he.type),K.write_shift(1,he.color),K.write_shift(-4,he.L),K.write_shift(-4,he.R),K.write_shift(-4,he.C),he.clsid)K.write_shift(16,he.clsid,"hex");else for(le=0;le<4;++le)K.write_shift(4,0);K.write_shift(4,he.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,he.start),K.write_shift(4,he.size),K.write_shift(4,0)}for(q=1;q<P.FileIndex.length;++q)if(he=P.FileIndex[q],he.size>=4096)if(K.l=he.start+1<<9,_t&&Buffer.isBuffer(he.content))he.content.copy(K,K.l,0,he.size),K.l+=he.size+511&-512;else{for(le=0;le<he.size;++le)K.write_shift(1,he.content[le]);for(;le&511;++le)K.write_shift(1,0)}for(q=1;q<P.FileIndex.length;++q)if(he=P.FileIndex[q],he.size>0&&he.size<4096)if(_t&&Buffer.isBuffer(he.content))he.content.copy(K,K.l,0,he.size),K.l+=he.size+63&-64;else{for(le=0;le<he.size;++le)K.write_shift(1,he.content[le]);for(;le&63;++le)K.write_shift(1,0)}if(_t)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function M(P,H){var z=P.FullPaths.map(function(le){return le.toUpperCase()}),W=z.map(function(le){var fe=le.split("/");return fe[fe.length-(le.slice(-1)=="/"?2:1)]}),K=!1;H.charCodeAt(0)===47?(K=!0,H=z[0].slice(0,-1)+H):K=H.indexOf("/")!==-1;var q=H.toUpperCase(),ce=K===!0?z.indexOf(q):W.indexOf(q);if(ce!==-1)return P.FileIndex[ce];var ge=!q.match(Bu);for(q=q.replace(qn,""),ge&&(q=q.replace(Bu,"!")),ce=0;ce<z.length;++ce)if((ge?z[ce].replace(Bu,"!"):z[ce]).replace(qn,"")==q||(ge?W[ce].replace(Bu,"!"):W[ce]).replace(qn,"")==q)return P.FileIndex[ce];return null}var D=64,L=-2,ke="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],De="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:ke,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:De,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ce(P,H,z){h();var W=V(P,z);u.writeFileSync(H,W)}function ne(P){for(var H=new Array(P.length),z=0;z<P.length;++z)H[z]=String.fromCharCode(P[z]);return H.join("")}function ye(P,H){var z=V(P,H);switch(H&&H.type||"buffer"){case"file":return h(),u.writeFileSync(H.filename,z),z;case"binary":return typeof z=="string"?z:ne(z);case"base64":return gf(typeof z=="string"?z:ne(z));case"buffer":if(_t)return Buffer.isBuffer(z)?z:ka(z);case"array":return typeof z=="string"?ws(z):z}return z}var ee;function O(P){try{var H=P.InflateRaw,z=new H;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)ee=P;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function te(P,H){if(!ee)return us(P,H);var z=ee.InflateRaw,W=new z,K=W._processChunk(P.slice(P.l),W._finishFlushFlag);return P.l+=W.bytesRead,K}function J(P){return ee?ee.deflateRawSync(P):ot(P)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(P){var H=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(H>>16|H>>8|H)&255}for(var xe=typeof Uint8Array<"u",Ee=xe?new Uint8Array(256):[],st=0;st<256;++st)Ee[st]=ve(st);function Y(P,H){var z=Ee[P&255];return H<=8?z>>>8-H:(z=z<<8|Ee[P>>8&255],H<=16?z>>>16-H:(z=z<<8|Ee[P>>16&255],z>>>24-H))}function Et(P,H){var z=H&7,W=H>>>3;return(P[W]|(z<=6?0:P[W+1]<<8))>>>z&3}function gt(P,H){var z=H&7,W=H>>>3;return(P[W]|(z<=5?0:P[W+1]<<8))>>>z&7}function It(P,H){var z=H&7,W=H>>>3;return(P[W]|(z<=4?0:P[W+1]<<8))>>>z&15}function ht(P,H){var z=H&7,W=H>>>3;return(P[W]|(z<=3?0:P[W+1]<<8))>>>z&31}function je(P,H){var z=H&7,W=H>>>3;return(P[W]|(z<=1?0:P[W+1]<<8))>>>z&127}function Ht(P,H,z){var W=H&7,K=H>>>3,q=(1<<z)-1,ce=P[K]>>>W;return z<8-W||(ce|=P[K+1]<<8-W,z<16-W)||(ce|=P[K+2]<<16-W,z<24-W)||(ce|=P[K+3]<<24-W),ce&q}function St(P,H,z){var W=H&7,K=H>>>3;return W<=5?P[K]|=(z&7)<<W:(P[K]|=z<<W&255,P[K+1]=(z&7)>>8-W),H+3}function Tt(P,H,z){var W=H&7,K=H>>>3;return z=(z&1)<<W,P[K]|=z,H+1}function fr(P,H,z){var W=H&7,K=H>>>3;return z<<=W,P[K]|=z&255,z>>>=8,P[K+1]=z,H+8}function Xn(P,H,z){var W=H&7,K=H>>>3;return z<<=W,P[K]|=z&255,z>>>=8,P[K+1]=z&255,P[K+2]=z>>>8,H+16}function ln(P,H){var z=P.length,W=2*z>H?2*z:H+5,K=0;if(z>=H)return P;if(_t){var q=Ty(W);if(P.copy)P.copy(q);else for(;K<P.length;++K)q[K]=P[K];return q}else if(xe){var ce=new Uint8Array(W);if(ce.set)ce.set(P);else for(;K<z;++K)ce[K]=P[K];return ce}return P.length=W,P}function $r(P){for(var H=new Array(P),z=0;z<P;++z)H[z]=0;return H}function Dr(P,H,z){var W=1,K=0,q=0,ce=0,ge=0,le=P.length,fe=xe?new Uint16Array(32):$r(32);for(q=0;q<32;++q)fe[q]=0;for(q=le;q<z;++q)P[q]=0;le=P.length;var he=xe?new Uint16Array(le):$r(le);for(q=0;q<le;++q)fe[K=P[q]]++,W<K&&(W=K),he[q]=0;for(fe[0]=0,q=1;q<=W;++q)fe[q+16]=ge=ge+fe[q-1]<<1;for(q=0;q<le;++q)ge=P[q],ge!=0&&(he[q]=fe[ge+16]++);var Re=0;for(q=0;q<le;++q)if(Re=P[q],Re!=0)for(ge=Y(he[q],W)>>W-Re,ce=(1<<W+4-Re)-1;ce>=0;--ce)H[ge|ce<<Re]=Re&15|q<<4;return W}var yn=xe?new Uint16Array(512):$r(512),Un=xe?new Uint16Array(32):$r(32);if(!xe){for(var $t=0;$t<512;++$t)yn[$t]=0;for($t=0;$t<32;++$t)Un[$t]=0}(function(){for(var P=[],H=0;H<32;H++)P.push(5);Dr(P,Un,32);var z=[];for(H=0;H<=143;H++)z.push(8);for(;H<=255;H++)z.push(9);for(;H<=279;H++)z.push(7);for(;H<=287;H++)z.push(8);Dr(z,yn,288)})();var Jr=(function(){for(var H=xe?new Uint8Array(32768):[],z=0,W=0;z<_e.length-1;++z)for(;W<_e[z+1];++W)H[W]=z;for(;W<32768;++W)H[W]=29;var K=xe?new Uint8Array(259):[];for(z=0,W=0;z<oe.length-1;++z)for(;W<oe[z+1];++W)K[W]=z;function q(ge,le){for(var fe=0;fe<ge.length;){var he=Math.min(65535,ge.length-fe),Re=fe+he==ge.length;for(le.write_shift(1,+Re),le.write_shift(2,he),le.write_shift(2,~he&65535);he-- >0;)le[le.l++]=ge[fe++]}return le.l}function ce(ge,le){for(var fe=0,he=0,Re=xe?new Uint16Array(32768):[];he<ge.length;){var Be=Math.min(65535,ge.length-he);if(Be<10){for(fe=St(le,fe,+(he+Be==ge.length)),fe&7&&(fe+=8-(fe&7)),le.l=fe/8|0,le.write_shift(2,Be),le.write_shift(2,~Be&65535);Be-- >0;)le[le.l++]=ge[he++];fe=le.l*8;continue}fe=St(le,fe,+(he+Be==ge.length)+2);for(var We=0;Be-- >0;){var Pe=ge[he];We=(We<<5^Pe)&32767;var Oe=-1,ct=0;if((Oe=Re[We])&&(Oe|=he&-32768,Oe>he&&(Oe-=32768),Oe<he))for(;ge[Oe+ct]==ge[he+ct]&&ct<250;)++ct;if(ct>2){Pe=K[ct],Pe<=22?fe=fr(le,fe,Ee[Pe+1]>>1)-1:(fr(le,fe,3),fe+=5,fr(le,fe,Ee[Pe-23]>>5),fe+=3);var zt=Pe<8?0:Pe-4>>2;zt>0&&(Xn(le,fe,ct-oe[Pe]),fe+=zt),Pe=H[he-Oe],fe=fr(le,fe,Ee[Pe]>>3),fe-=3;var Gt=Pe<4?0:Pe-2>>1;Gt>0&&(Xn(le,fe,he-Oe-_e[Pe]),fe+=Gt);for(var cr=0;cr<ct;++cr)Re[We]=he&32767,We=(We<<5^ge[he])&32767,++he;Be-=ct-1}else Pe<=143?Pe=Pe+48:fe=Tt(le,fe,1),fe=fr(le,fe,Ee[Pe]),Re[We]=he&32767,++he}fe=fr(le,fe,0)-1}return le.l=(fe+7)/8|0,le.l}return function(le,fe){return le.length<8?q(le,fe):ce(le,fe)}})();function ot(P){var H=me(50+Math.floor(P.length*1.1)),z=Jr(P,H);return H.slice(0,z)}var Rt=xe?new Uint16Array(32768):$r(32768),Gr=xe?new Uint16Array(32768):$r(32768),jt=xe?new Uint16Array(128):$r(128),wn=1,hi=1;function En(P,H){var z=ht(P,H)+257;H+=5;var W=ht(P,H)+1;H+=5;var K=It(P,H)+4;H+=4;for(var q=0,ce=xe?new Uint8Array(19):$r(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,fe=xe?new Uint8Array(8):$r(8),he=xe?new Uint8Array(8):$r(8),Re=ce.length,Be=0;Be<K;++Be)ce[Z[Be]]=q=gt(P,H),le<q&&(le=q),fe[q]++,H+=3;var We=0;for(fe[0]=0,Be=1;Be<=le;++Be)he[Be]=We=We+fe[Be-1]<<1;for(Be=0;Be<Re;++Be)(We=ce[Be])!=0&&(ge[Be]=he[We]++);var Pe=0;for(Be=0;Be<Re;++Be)if(Pe=ce[Be],Pe!=0){We=Ee[ge[Be]]>>8-Pe;for(var Oe=(1<<7-Pe)-1;Oe>=0;--Oe)jt[We|Oe<<Pe]=Pe&7|Be<<3}var ct=[];for(le=1;ct.length<z+W;)switch(We=jt[je(P,H)],H+=We&7,We>>>=3){case 16:for(q=3+Et(P,H),H+=2,We=ct[ct.length-1];q-- >0;)ct.push(We);break;case 17:for(q=3+gt(P,H),H+=3;q-- >0;)ct.push(0);break;case 18:for(q=11+je(P,H),H+=7;q-- >0;)ct.push(0);break;default:ct.push(We),le<We&&(le=We);break}var zt=ct.slice(0,z),Gt=ct.slice(z);for(Be=z;Be<286;++Be)zt[Be]=0;for(Be=W;Be<30;++Be)Gt[Be]=0;return wn=Dr(zt,Rt,286),hi=Dr(Gt,Gr,30),H}function di(P,H){if(P[0]==3&&!(P[1]&3))return[go(H),2];for(var z=0,W=0,K=Ty(H||1<<18),q=0,ce=K.length>>>0,ge=0,le=0;(W&1)==0;){if(W=gt(P,z),z+=3,W>>>1)W>>1==1?(ge=9,le=5):(z=En(P,z),ge=wn,le=hi);else{z&7&&(z+=8-(z&7));var fe=P[z>>>3]|P[(z>>>3)+1]<<8;if(z+=32,fe>0)for(!H&&ce<q+fe&&(K=ln(K,q+fe),ce=K.length);fe-- >0;)K[q++]=P[z>>>3],z+=8;continue}for(;;){!H&&ce<q+32767&&(K=ln(K,q+32767),ce=K.length);var he=Ht(P,z,ge),Re=W>>>1==1?yn[he]:Rt[he];if(z+=Re&15,Re>>>=4,(Re>>>8&255)===0)K[q++]=Re;else{if(Re==256)break;Re-=257;var Be=Re<8?0:Re-4>>2;Be>5&&(Be=0);var We=q+oe[Re];Be>0&&(We+=Ht(P,z,Be),z+=Be),he=Ht(P,z,le),Re=W>>>1==1?Un[he]:Gr[he],z+=Re&15,Re>>>=4;var Pe=Re<4?0:Re-2>>1,Oe=_e[Re];for(Pe>0&&(Oe+=Ht(P,z,Pe),z+=Pe),!H&&ce<We&&(K=ln(K,We+100),ce=K.length);q<We;)K[q]=K[q-Oe],++q}}}return H?[K,z+7>>>3]:[K.slice(0,q),z+7>>>3]}function us(P,H){var z=P.slice(P.l||0),W=di(z,H);return P.l+=W[1],W[0]}function Ks(P,H){if(P)typeof console<"u"&&console.error(H);else throw new Error(H)}function Yn(P,H){var z=P;gn(z,0);var W=[],K=[],q={FileIndex:W,FullPaths:K};A(q,{root:H.root});for(var ce=z.length-4;(z[ce]!=80||z[ce+1]!=75||z[ce+2]!=5||z[ce+3]!=6)&&ce>=0;)--ce;z.l=ce+4,z.l+=4;var ge=z.read_shift(2);z.l+=6;var le=z.read_shift(4);for(z.l=le,ce=0;ce<ge;++ce){z.l+=20;var fe=z.read_shift(4),he=z.read_shift(4),Re=z.read_shift(2),Be=z.read_shift(2),We=z.read_shift(2);z.l+=8;var Pe=z.read_shift(4),Oe=c(z.slice(z.l+Re,z.l+Re+Be));z.l+=Re+Be+We;var ct=z.l;z.l=Pe+4,Qn(z,fe,he,q,Oe),z.l=ct}return q}function Qn(P,H,z,W,K){P.l+=2;var q=P.read_shift(2),ce=P.read_shift(2),ge=o(P);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var le=P.read_shift(4),fe=P.read_shift(4),he=P.read_shift(4),Re=P.read_shift(2),Be=P.read_shift(2),We="",Pe=0;Pe<Re;++Pe)We+=String.fromCharCode(P[P.l++]);if(Be){var Oe=c(P.slice(P.l,P.l+Be));(Oe[21589]||{}).mt&&(ge=Oe[21589].mt),((K||{})[21589]||{}).mt&&(ge=K[21589].mt)}P.l+=Be;var ct=P.slice(P.l,P.l+fe);switch(ce){case 8:ct=te(P,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var zt=!1;q&8&&(le=P.read_shift(4),le==134695760&&(le=P.read_shift(4),zt=!0),fe=P.read_shift(4),he=P.read_shift(4)),fe!=H&&Ks(zt,"Bad compressed size: "+H+" != "+fe),he!=z&&Ks(zt,"Bad uncompressed size: "+z+" != "+he),Zr(W,We,ct,{unsafe:!0,mt:ge})}function Zt(P,H){var z=H||{},W=[],K=[],q=me(1),ce=z.compression?8:0,ge=0,le=0,fe=0,he=0,Re=0,Be=P.FullPaths[0],We=Be,Pe=P.FileIndex[0],Oe=[],ct=0;for(le=1;le<P.FullPaths.length;++le)if(We=P.FullPaths[le].slice(Be.length),Pe=P.FileIndex[le],!(!Pe.size||!Pe.content||We=="Sh33tJ5")){var zt=he,Gt=me(We.length);for(fe=0;fe<We.length;++fe)Gt.write_shift(1,We.charCodeAt(fe)&127);Gt=Gt.slice(0,Gt.l),Oe[Re]=iD.buf(Pe.content,0);var cr=Pe.content;ce==8&&(cr=J(cr)),q=me(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,ge),q.write_shift(2,ce),Pe.mt?i(q,Pe.mt):q.write_shift(4,0),q.write_shift(-4,Oe[Re]),q.write_shift(4,cr.length),q.write_shift(4,Pe.content.length),q.write_shift(2,Gt.length),q.write_shift(2,0),he+=q.length,W.push(q),he+=Gt.length,W.push(Gt),he+=cr.length,W.push(cr),q=me(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,ge),q.write_shift(2,ce),q.write_shift(4,0),q.write_shift(-4,Oe[Re]),q.write_shift(4,cr.length),q.write_shift(4,Pe.content.length),q.write_shift(2,Gt.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,zt),ct+=q.l,K.push(q),ct+=Gt.length,K.push(Gt),++Re}return q=me(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,Re),q.write_shift(2,Re),q.write_shift(4,ct),q.write_shift(4,he),q.write_shift(2,0),an([an(W),an(K),q])}var As={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Cs(P,H){if(P.ctype)return P.ctype;var z=P.name||"",W=z.match(/\.([^\.]+)$/);return W&&As[W[1]]||H&&(W=(z=H).match(/[\.\\]([^\.\\])+$/),W&&As[W[1]])?As[W[1]]:"application/octet-stream"}function Is(P){for(var H=gf(P),z=[],W=0;W<H.length;W+=76)z.push(H.slice(W,W+76));return z.join(`\r
`)+`\r
`}function Ia(P){var H=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var he=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});H=H.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),H.charAt(0)==`
`&&(H="=0D"+H.slice(1)),H=H.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],W=H.split(`\r
`),K=0;K<W.length;++K){var q=W[K];if(q.length==0){z.push("");continue}for(var ce=0;ce<q.length;){var ge=76,le=q.slice(ce,ce+ge);le.charAt(ge-1)=="="?ge--:le.charAt(ge-2)=="="?ge-=2:le.charAt(ge-3)=="="&&(ge-=3),le=q.slice(ce,ce+ge),ce+=ge,ce<q.length&&(le+="="),z.push(le)}}return z.join(`\r
`)}function Qe(P){for(var H=[],z=0;z<P.length;++z){for(var W=P[z];z<=P.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+P[++z];H.push(W)}for(var K=0;K<H.length;++K)H[K]=H[K].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return ws(H.join(`\r
`))}function Je(P,H,z){for(var W="",K="",q="",ce,ge=0;ge<10;++ge){var le=H[ge];if(!le||le.match(/^\s*$/))break;var fe=le.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":W=fe[2].trim();break;case"content-type":q=fe[2].trim();break;case"content-transfer-encoding":K=fe[2].trim();break}}switch(++ge,K.toLowerCase()){case"base64":ce=ws(ks(H.slice(ge).join("")));break;case"quoted-printable":ce=Qe(H.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var he=Zr(P,W.slice(z.length),ce,{unsafe:!0});q&&(he.ctype=q)}function Ut(P,H){if(ne(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=H&&H.root||"",W=(_t&&Buffer.isBuffer(P)?P.toString("binary"):ne(P)).split(`\r
`),K=0,q="";for(K=0;K<W.length;++K)if(q=W[K],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),z||(z=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),q.slice(0,z.length)!=z););var ce=(W[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var ge="--"+(ce[1]||""),le=[],fe=[],he={FileIndex:le,FullPaths:fe};A(he);var Re,Be=0;for(K=0;K<W.length;++K){var We=W[K];We!==ge&&We!==ge+"--"||(Be++&&Je(he,W.slice(Re,K),z),Re=K)}return he}function rr(P,H){var z=H||{},W=z.boundary||"SheetJS";W="------="+W;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],q=P.FullPaths[0],ce=q,ge=P.FileIndex[0],le=1;le<P.FullPaths.length;++le)if(ce=P.FullPaths[le].slice(q.length),ge=P.FileIndex[le],!(!ge.size||!ge.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ct){return"_x"+ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ct){return"_u"+ct.charCodeAt(0).toString(16)+"_"});for(var fe=ge.content,he=_t&&Buffer.isBuffer(fe)?fe.toString("binary"):ne(fe),Re=0,Be=Math.min(1024,he.length),We=0,Pe=0;Pe<=Be;++Pe)(We=he.charCodeAt(Pe))>=32&&We<128&&++Re;var Oe=Re>=Be*4/5;K.push(W),K.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+ce),K.push("Content-Transfer-Encoding: "+(Oe?"quoted-printable":"base64")),K.push("Content-Type: "+Cs(ge,ce)),K.push(""),K.push(Oe?Ia(he):Is(he))}return K.push(W+`--\r
`),K.join(`\r
`)}function hr(P){var H={};return A(H,P),H}function Zr(P,H,z,W){var K=W&&W.unsafe;K||A(P);var q=!K&&Ze.find(P,H);if(!q){var ce=P.FullPaths[0];H.slice(0,ce.length)==ce?ce=H:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+H).replace("//","/")),q={name:s(H),type:2},P.FileIndex.push(q),P.FullPaths.push(ce),K||Ze.utils.cfb_gc(P)}return q.content=z,q.size=z?z.length:0,W&&(W.CLSID&&(q.clsid=W.CLSID),W.mt&&(q.mt=W.mt),W.ct&&(q.ct=W.ct)),q}function Gi(P,H){A(P);var z=Ze.find(P,H);if(z){for(var W=0;W<P.FileIndex.length;++W)if(P.FileIndex[W]==z)return P.FileIndex.splice(W,1),P.FullPaths.splice(W,1),!0}return!1}function cn(P,H,z){A(P);var W=Ze.find(P,H);if(W){for(var K=0;K<P.FileIndex.length;++K)if(P.FileIndex[K]==W)return P.FileIndex[K].name=s(z),P.FullPaths[K]=z,!0}return!1}function Pr(P){F(P,!0)}return e.find=M,e.read=G,e.parse=d,e.write=ye,e.writeFile=Ce,e.utils={cfb_new:hr,cfb_add:Zr,cfb_del:Gi,cfb_mov:cn,cfb_gc:Pr,ReadShift:Ku,CheckField:GS,prep_blob:gn,bconcat:an,use_zlib:O,_deflateRaw:ot,_inflateRaw:us,consts:Ne},e})();function aD(t){return typeof t=="string"?Rd(t):Array.isArray(t)?RR(t):t}function $f(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Rd(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Oi(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([aD(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=To(e)),c.write(e),c.close(),e}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+t)}function oD(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function kr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Ny(t,e){for(var r=[],n=kr(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function Pd(t){for(var e=[],r=kr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Od(t){for(var e=[],r=kr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function lD(t){for(var e=[],r=kr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var td=new Date(1899,11,30,0,0,0);function Qr(t,e){var r=t.getTime(),n=td.getTime()+(t.getTimezoneOffset()-td.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var kS=new Date,cD=td.getTime()+(kS.getTimezoneOffset()-td.getTimezoneOffset())*6e4,Ry=kS.getTimezoneOffset();function Ld(t){var e=new Date;return e.setTime(t*24*60*60*1e3+cD),e.getTimezoneOffset()!==Ry&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Ry)*6e4),e}function uD(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var Dy=new Date("2017-02-19T19:06:09.000Z"),AS=isNaN(Dy.getFullYear())?new Date("2/19/17"):Dy,fD=AS.getFullYear()==2017;function or(t,e){var r=new Date(t);if(fD)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(AS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function hl(t,e){if(_t&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Oi(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Oi(dS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Oi(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Oi(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function lr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=lr(t[r]));return e}function wr(t,e){for(var r="";r.length<e;)r+=t;return r}function li(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var hD=["january","february","march","april","may","june","july","august","september","october","november","december"];function Rc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&hD.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var dD=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],c=1;c<i.length;++c)o.push(s),o.push(i[c]);return o}})();function CS(t){return t?t.content&&t.type?hl(t.content,!0):t.data?Mu(t.data):t.asNodeBuffer&&_t?Mu(t.asNodeBuffer().toString("binary")):t.asBinary?Mu(t.asBinary()):t._data&&t._data.getContent?Mu(hl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function IS(t){if(!t)return null;if(t.data)return wy(t.data);if(t.asNodeBuffer&&_t)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?wy(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function pD(t){return t&&t.name.slice(-4)===".bin"?IS(t):CS(t)}function Us(t,e){for(var r=t.FullPaths||kr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function z1(t,e){var r=Us(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Vr(t,e,r){if(!r)return pD(z1(t,e));if(!e)return null;try{return Vr(t,e)}catch{return null}}function Es(t,e,r){if(!r)return CS(z1(t,e));if(!e)return null;try{return Es(t,e)}catch{return null}}function mD(t,e,r){return IS(z1(t,e))}function Py(t){for(var e=t.FullPaths||kr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function vt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return _t?n=ka(r):n=DR(r),Ze.utils.cfb_add(t,e,n)}Ze.utils.cfb_add(t,e,r)}else t.file(e,r)}function W1(){return Ze.utils.cfb_new()}function FS(t,e){switch(e.type){case"base64":return Ze.read(t,{type:"base64"});case"binary":return Ze.read(t,{type:"binary"});case"buffer":case"array":return Ze.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Vu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Rr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,gD=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Oy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,xD=/<[^>]*>/g,jn=Rr.match(Oy)?Oy:xD,vD=/<\w*:/,_D=/<(\/?)\w+:/;function lt(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var o=t.match(gD),c=0,u="",h=0,d="",g="",x=1;if(o)for(h=0;h!=o.length;++h){for(g=o[h],i=0;i!=g.length&&g.charCodeAt(i)!==61;++i);for(d=g.slice(0,i).trim();g.charCodeAt(i+1)==32;)++i;for(x=(s=g.charCodeAt(i+1))==34||s==39?1:0,u=g.slice(i+1+x,g.length-x),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var y=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(n[y]&&d.slice(c-3,c)=="ext")continue;n[y]=u,n[y.toLowerCase()]=u}}return n}function Hi(t){return t.replace(_D,"<$1")}var bS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},H1=Pd(bS),Pt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(c,u){return bS[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,u){return String.fromCharCode(parseInt(u,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}})(),$1=/[&<>'"]/g,yD=/[\u0000-\u0008\u000b-\u001f]/g;function Yt(t){var e=t+"";return e.replace($1,function(r){return H1[r]}).replace(yD,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ly(t){return Yt(t).replace(/ /g,"_x0020_")}var NS=/[\u0000-\u001f]/g;function G1(t){var e=t+"";return e.replace($1,function(r){return H1[r]}).replace(/\n/g,"<br/>").replace(NS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function wD(t){var e=t+"";return e.replace($1,function(r){return H1[r]}).replace(NS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var My=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function ED(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function ir(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Dm(t){for(var e="",r=0,n=0,s=0,i=0,o=0,c=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,e+=String.fromCharCode(o);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}o=t.charCodeAt(r++),c=((n&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function By(t){var e=go(2*t.length),r,n,s=1,i=0,o=0,c;for(n=0;n<t.length;n+=s)s=1,(c=t.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(t.charCodeAt(n+1)&63),s=2):c<240?(r=(c&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(c&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function Vy(t){return ka(t,"binary").toString("utf8")}var c0="foo bar baz",Qt=_t&&(Vy(c0)==Dm(c0)&&Vy||By(c0)==Dm(c0)&&By)||Dm,Oi=_t?function(t){return ka(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},vf=(function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),RS=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}})(),TD=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),SD=/<\/?(?:vt:)?variant>/g,kD=/<(?:vt:)([^>]*)>([\s\S]*)</;function jy(t,e){var r=lt(t),n=t.match(TD(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var o=i.replace(SD,"").match(kD);o&&s.push({v:Qt(o[2]),t:o[1]})}),s}var DS=/(^\s|\s$|\n)/;function vn(t,e){return"<"+t+(e.match(DS)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function _f(t){return kr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ve(t,e,r){return"<"+t+(r!=null?_f(r):"")+(e!=null?(e.match(DS)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Tg(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function AD(t,e){switch(typeof t){case"string":var r=Ve("vt:lpwstr",Yt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ve((t|0)==t?"vt:i4":"vt:r8",Yt(String(t)));case"boolean":return Ve("vt:bool",t?"true":"false")}if(t instanceof Date)return Ve("vt:filetime",Tg(t));throw new Error("Unable to serialize "+t)}function K1(t){if(_t&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Qt(To(V1(t)));throw new Error("Bad input format: expected Buffer or string")}var yf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Xr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},yl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_s={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function CD(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function ID(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,o=n?-e:e;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var c=0;c<=5;++c,i/=256)t[r+c]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var Uy=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},zy=_t?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ka(e)})):Uy(t)}:Uy,Wy=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(pa(t,s)));return n.join("").replace(qn,"")},q1=_t?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(qn,""):Wy(t,e,r)}:Wy,Hy=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},PS=_t?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Hy(t,e,r)}:Hy,$y=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(fc(t,s)));return n.join("")},Gf=_t?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):$y(e,r,n)}:$y,OS=function(t,e){var r=ys(t,e);return r>0?Gf(t,e+4,e+4+r-1):""},LS=OS,MS=function(t,e){var r=ys(t,e);return r>0?Gf(t,e+4,e+4+r-1):""},BS=MS,VS=function(t,e){var r=2*ys(t,e);return r>0?Gf(t,e+4,e+4+r-1):""},jS=VS,US=function(e,r){var n=ys(e,r);return n>0?q1(e,r+4,r+4+n):""},zS=US,WS=function(t,e){var r=ys(t,e);return r>0?Gf(t,e+4,e+4+r):""},HS=WS,$S=function(t,e){return CD(t,e)},rd=$S,X1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};_t&&(LS=function(e,r){if(!Buffer.isBuffer(e))return OS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},BS=function(e,r){if(!Buffer.isBuffer(e))return MS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},jS=function(e,r){if(!Buffer.isBuffer(e))return VS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},zS=function(e,r){if(!Buffer.isBuffer(e))return US(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},HS=function(e,r){if(!Buffer.isBuffer(e))return WS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},rd=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):$S(e,r)},X1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var fc=function(t,e){return t[e]},pa=function(t,e){return t[e+1]*256+t[e]},FD=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ys=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Ko=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},bD=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Ku(t,e){var r="",n,s,i=[],o,c,u,h;switch(e){case"dbcs":if(h=this.l,_t&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(u=0;u<t;++u)r+=String.fromCharCode(pa(this,h)),h+=2;t*=2;break;case"utf8":r=Gf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=q1(this,this.l,this.l+t);break;case"wstr":return Ku.call(this,t,"dbcs");case"lpstr-ansi":r=LS(this,this.l),t=4+ys(this,this.l);break;case"lpstr-cp":r=BS(this,this.l),t=4+ys(this,this.l);break;case"lpwstr":r=jS(this,this.l),t=4+2*ys(this,this.l);break;case"lpp4":t=4+ys(this,this.l),r=zS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ys(this,this.l),r=HS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=fc(this,this.l+t++))!==0;)i.push(l0(o));r=i.join("");break;case"_wstr":for(t=0,r="";(o=pa(this,this.l+t))!==0;)i.push(l0(o)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",h=this.l,u=0;u<t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=fc(this,h),this.l=h+1,c=Ku.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(l0(pa(this,h))),h+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,u=0;u!=t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=fc(this,h),this.l=h+1,c=Ku.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(l0(fc(this,h))),h+=1}r=i.join("");break;default:switch(t){case 1:return n=fc(this,this.l),this.l++,n;case 2:return n=(e==="i"?FD:pa)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Ko:bD)(this,this.l),this.l+=4,n):(s=ys(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=rd(this,this.l):s=rd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=PS(this,this.l,t);break}}return this.l+=t,r}var ND=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},RD=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},DD=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function PD(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)DD(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var o=e.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,ND(this,e,this.l);break;case 8:if(n=8,r==="f"){ID(this,e,this.l);break}case 16:break;case-4:n=4,RD(this,e,this.l);break}return this.l+=n,this}function GS(t,e){var r=PS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function gn(t,e){t.l=e,t.read_shift=Ku,t.chk=GS,t.write_shift=PD}function Vn(t,e){t.l+=e}function me(t){var e=go(t);return gn(e,0),e}function Aa(t,e,r){if(t){var n,s,i;gn(t,t.l||0);for(var o=t.length,c=0,u=0;t.l<o;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var h=Af[c]||Af[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;u=t.l+i;var d=h.f&&h.f(t,i,r);if(t.l=u,e(d,h,c))return}}}function ls(){var t=[],e=_t?256:2048,r=function(h){var d=me(h);return gn(d,0),d},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(h){return n&&h<n.length-n.l?n:(s(),n=r(Math.max(h+1,e)))},o=function(){return s(),an(t)},c=function(h){s(),n=h,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:c,end:o,_bufs:t}}function Ie(t,e,r,n){var s=+e,i;if(!isNaN(s)){n||(n=Af[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=t.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var c=0;c!=4;++c)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&X1(r)&&t.push(r)}}function qu(t,e,r){var n=lr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Gy(t,e,r){var n=lr(t);return n.s=qu(n.s,e.s,r),n.e=qu(n.e,e.s,r),n}function Xu(t,e){if(t.cRel&&t.c<0)for(t=lr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=lr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=it(t);return!t.cRel&&t.cRel!=null&&(r=MD(r)),!t.rRel&&t.rRel!=null&&(r=OD(r)),r}function Pm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+xr(t.s.c)+":"+(t.e.cRel?"":"$")+xr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Nr(t.s.r)+":"+(t.e.rRel?"":"$")+Nr(t.e.r):Xu(t.s,e.biff)+":"+Xu(t.e,e.biff)}function Y1(t){return parseInt(LD(t),10)-1}function Nr(t){return""+(t+1)}function OD(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function LD(t){return t.replace(/\$(\d+)$/,"$1")}function Q1(t){for(var e=BD(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function xr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function MD(t){return t.replace(/^([A-Z])/,"$$$1")}function BD(t){return t.replace(/^\$([A-Z])/,"$1")}function VD(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vr(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function it(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function cs(t){var e=t.indexOf(":");return e==-1?{s:vr(t),e:vr(t)}:{s:vr(t.slice(0,e)),e:vr(t.slice(e+1))}}function xt(t,e){return typeof e>"u"||typeof e=="number"?xt(t.s,t.e):(typeof t!="string"&&(t=it(t)),typeof e!="string"&&(e=it(e)),t==e?t:t+":"+e)}function Ot(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function Ky(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=$s(t.z,r?Qr(e):e)}catch{}try{return t.w=$s((t.XF||{}).numFmtId||(r?14:0),r?Qr(e):e)}catch{return""+e}}function Ta(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ca[t.v]||t.v:e==null?Ky(t,t.v):Ky(t,e))}function So(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function KS(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),o=0,c=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?vr(n.origin):n.origin;o=u.r,c=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Ot(i["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),o==-1&&(h.e.r=o=d.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[g].length;++x)if(!(typeof e[g][x]>"u")){var y={v:e[g][x]},k=o+g,w=c+x;if(h.s.r>k&&(h.s.r=k),h.s.c>w&&(h.s.c=w),h.e.r<k&&(h.e.r=k),h.e.c<w&&(h.e.c=w),e[g][x]&&typeof e[g][x]=="object"&&!Array.isArray(e[g][x])&&!(e[g][x]instanceof Date))y=e[g][x];else if(Array.isArray(y.v)&&(y.f=e[g][x][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||nt[14],n.cellDates?(y.t="d",y.w=$s(y.z,Qr(y.v))):(y.t="n",y.v=Qr(y.v),y.w=$s(y.z,y.v))):y.t="s";if(s)i[k]||(i[k]=[]),i[k][w]&&i[k][w].z&&(y.z=i[k][w].z),i[k][w]=y;else{var S=it({c:w,r:k});i[S]&&i[S].z&&(y.z=i[S].z),i[S]=y}}}return h.s.c<1e7&&(i["!ref"]=xt(h)),i}function Gc(t,e){return KS(null,t,e)}function jD(t){return t.read_shift(4,"i")}function ci(t,e){return e||(e=me(4)),e.write_shift(4,t),e}function Mn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function on(t,e){var r=!1;return e==null&&(r=!0,e=me(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function UD(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function zD(t,e){return e||(e=me(4)),e.write_shift(2,0),e.write_shift(2,0),e}function J1(t,e){var r=t.l,n=t.read_shift(1),s=Mn(t),i=[],o={t:s,h:s};if((n&1)!==0){for(var c=t.read_shift(4),u=0;u!=c;++u)i.push(UD(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function WD(t,e){var r=!1;return e==null&&(r=!0,e=me(15+4*t.t.length)),e.write_shift(1,0),on(t.t,e),r?e.slice(0,e.l):e}var HD=J1;function $D(t,e){var r=!1;return e==null&&(r=!0,e=me(23+4*t.t.length)),e.write_shift(1,1),on(t.t,e),e.write_shift(4,1),zD({},e),r?e.slice(0,e.l):e}function Gs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function wl(t,e){return e==null&&(e=me(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function El(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Tl(t,e){return e==null&&(e=me(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var GD=Mn,qS=on;function Z1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function nd(t,e){var r=!1;return e==null&&(r=!0,e=me(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var KD=Mn,Sg=Z1,ex=nd;function tx(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?rd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ko(e,0)>>2;return r?s/100:s}function XS(t,e){e==null&&(e=me(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function YS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function qD(t,e){return e||(e=me(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Sl=YS,Kc=qD;function Ln(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function dl(t,e){return(e||me(8)).write_shift(8,t,"f")}function XD(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),c=t.read_shift(1),u=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var h=tl[s];h&&(e.rgb=Ef(h));break;case 2:e.rgb=Ef([o,c,u]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function sd(t,e){if(e||(e=me(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function YD(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function QD(t,e){e||(e=me(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function QS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function JD(t){return QS(t,1)}function ZD(t){return QS(t,2)}var rx=2,ss=3,u0=11,qy=12,id=19,f0=64,eP=65,tP=71,rP=4108,nP=4126,sn=80,JS=81,sP=[sn,JS],kg={1:{n:"CodePage",t:rx},2:{n:"Category",t:sn},3:{n:"PresentationFormat",t:sn},4:{n:"ByteCount",t:ss},5:{n:"LineCount",t:ss},6:{n:"ParagraphCount",t:ss},7:{n:"SlideCount",t:ss},8:{n:"NoteCount",t:ss},9:{n:"HiddenCount",t:ss},10:{n:"MultimediaClipCount",t:ss},11:{n:"ScaleCrop",t:u0},12:{n:"HeadingPairs",t:rP},13:{n:"TitlesOfParts",t:nP},14:{n:"Manager",t:sn},15:{n:"Company",t:sn},16:{n:"LinksUpToDate",t:u0},17:{n:"CharacterCount",t:ss},19:{n:"SharedDoc",t:u0},22:{n:"HyperlinksChanged",t:u0},23:{n:"AppVersion",t:ss,p:"version"},24:{n:"DigSig",t:eP},26:{n:"ContentType",t:sn},27:{n:"ContentStatus",t:sn},28:{n:"Language",t:sn},29:{n:"Version",t:sn},255:{},2147483648:{n:"Locale",t:id},2147483651:{n:"Behavior",t:id},1919054434:{}},Ag={1:{n:"CodePage",t:rx},2:{n:"Title",t:sn},3:{n:"Subject",t:sn},4:{n:"Author",t:sn},5:{n:"Keywords",t:sn},6:{n:"Comments",t:sn},7:{n:"Template",t:sn},8:{n:"LastAuthor",t:sn},9:{n:"RevNumber",t:sn},10:{n:"EditTime",t:f0},11:{n:"LastPrinted",t:f0},12:{n:"CreatedDate",t:f0},13:{n:"ModifiedDate",t:f0},14:{n:"PageCount",t:ss},15:{n:"WordCount",t:ss},16:{n:"CharCount",t:ss},17:{n:"Thumbnail",t:tP},18:{n:"Application",t:sn},19:{n:"DocSecurity",t:ss},255:{},2147483648:{n:"Locale",t:id},2147483651:{n:"Behavior",t:id},1919054434:{}},Xy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},iP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function aP(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var oP=aP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),tl=lr(oP),Ca={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ZS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Cg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},h0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function nx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function lP(t){var e=nx();if(!t||!t.match)return e;var r={};if((t.match(jn)||[]).forEach(function(n){var s=lt(n);switch(s[0].replace(vD,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[Cg[s.ContentType]]!==void 0&&e[Cg[s.ContentType]].push(s.PartName);break}}),e.xmlns!==Xr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function ek(t,e){var r=lD(Cg),n=[],s;n[n.length]=Rr,n[n.length]=Ve("Types",null,{xmlns:Xr.CT,"xmlns:xsd":Xr.xsd,"xmlns:xsi":Xr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Ve("Default",null,{Extension:u[0],ContentType:u[1]})}));var i=function(u){t[u]&&t[u].length>0&&(s=t[u][0],n[n.length]=Ve("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:h0[u][e.bookType]||h0[u].xlsx}))},o=function(u){(t[u]||[]).forEach(function(h){n[n.length]=Ve("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:h0[u][e.bookType]||h0[u].xlsx})})},c=function(u){(t[u]||[]).forEach(function(h){n[n.length]=Ve("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[u][0]})})};return i("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var wt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Yu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(jn)||[]).forEach(function(s){var i=lt(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:Vu(i.Target,e);r[c]=o,n[i.Id]=o}}),r["!id"]=n,r}function yc(t){var e=[Rr,Ve("Relationships",null,{xmlns:Xr.RELS})];return kr(t["!id"]).forEach(function(r){e[e.length]=Ve("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Xt(t,e,r,n,s,i){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[wt.HLINK,wt.XPATH,wt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var cP="application/vnd.oasis.opendocument.spreadsheet";function uP(t,e){for(var r=K1(t),n,s;n=yf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=lt(n[0],!1),s.path=="/"&&s.type!==cP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function fP(t){var e=[Rr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Yy(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function hP(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function dP(t){var e=[Rr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Yy(t[r][0],t[r][1])),e.push(hP("",t[r][0]));return e.push(Yy("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function tk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Q0.version+"</meta:generator></office:meta></office:document-meta>"}var Hs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],pP=(function(){for(var t=new Array(Hs.length),e=0;e<Hs.length;++e){var r=Hs[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function rk(t){var e={};t=Qt(t);for(var r=0;r<Hs.length;++r){var n=Hs[r],s=t.match(pP[r]);s!=null&&s.length>0&&(e[n[1]]=Pt(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=or(e[n[1]]))}return e}function Om(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=Yt(e),n[n.length]=r?Ve(t,e,r):vn(t,e))}function nk(t,e){var r=e||{},n=[Rr,Ve("cp:coreProperties",null,{"xmlns:cp":Xr.CORE_PROPS,"xmlns:dc":Xr.dc,"xmlns:dcterms":Xr.dcterms,"xmlns:dcmitype":Xr.dcmitype,"xmlns:xsi":Xr.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Om("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Tg(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&Om("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Tg(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=Hs.length;++i){var o=Hs[i],c=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Om(o[0],c,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var rl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],sk=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ik(t,e,r,n){var s=[];if(typeof t=="string")s=jy(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(d){return{v:d}}));var o=typeof e=="string"?jy(e,n).map(function(d){return d.v}):e,c=0,u=0;if(o.length>0)for(var h=0;h!==s.length;h+=2){switch(u=+s[h+1].v,s[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(c,c+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(c,c+u);break}c+=u}}function mP(t,e,r){var n={};return e||(e={}),t=Qt(t),rl.forEach(function(s){var i=(t.match(vf(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=Pt(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var o=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ik(n.HeadingPairs,n.TitlesOfParts,e,r),e}function ak(t){var e=[],r=Ve;return t||(t={}),t.Application="SheetJS",e[e.length]=Rr,e[e.length]=Ve("Properties",null,{xmlns:Xr.EXT_PROPS,"xmlns:vt":Xr.vt}),rl.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Yt(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Yt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var gP=/<[^>]+>[^<]*/g;function xP(t,e){var r={},n="",s=t.match(gP);if(s)for(var i=0;i!=s.length;++i){var o=s[i],c=lt(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Pt(c.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),h=u[0].slice(4),d=u[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[n]=Pt(d);break;case"bool":r[n]=ir(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=or(d);break;case"cy":case"error":r[n]=Pt(d);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,u)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function ok(t){var e=[Rr,Ve("Properties",null,{xmlns:Xr.CUST_PROPS,"xmlns:vt":Xr.vt})];if(!t)return e.join("");var r=1;return kr(t).forEach(function(s){++r,e[e.length]=Ve("property",AD(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Yt(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Ig={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Lm;function vP(t,e,r){Lm||(Lm=Pd(Ig)),e=Lm[e]||e,t[e]=r}function _P(t,e){var r=[];return kr(Ig).map(function(n){for(var s=0;s<Hs.length;++s)if(Hs[s][1]==n)return Hs[s];for(s=0;s<rl.length;++s)if(rl[s][1]==n)return rl[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(vn(Ig[n[1]]||n[1],s))}}),Ve("DocumentProperties",r.join(""),{xmlns:_s.o})}function yP(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&kr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<Hs.length;++o)if(i==Hs[o][1])return;for(o=0;o<rl.length;++o)if(i==rl[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var c=t[i],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c=String(c),s.push(Ve(Ly(i),c,{"dt:dt":u}))}}),e&&kr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Ve(Ly(i),o,{"dt:dt":c}))}}),"<"+n+' xmlns="'+_s.o+'">'+s.join("")+"</"+n+">"}function sx(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function wP(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var o=me(8);return o.write_shift(4,n),o.write_shift(4,s),o}function lk(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function ck(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function uk(t,e,r){return e===31?ck(t):lk(t,e,r)}function Fg(t,e,r){return uk(t,e,r===!1?0:4)}function EP(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return uk(t,e,0)}function TP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(qn,""),t.l-s&2&&(t.l+=2)}return r}function SP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(qn,"");return r}function kP(t){var e=t.l,r=ad(t,JS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=ad(t,ss);return[r,n]}function AP(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(kP(t));return r}function Qy(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),o=t.read_shift(4);n[i]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(qn,"").replace(Bu,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function fk(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function CP(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function ad(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==qy&&n!==e&&sP.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===qy?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return lk(t,n,4).replace(qn,"");case 31:return ck(t);case 64:return sx(t);case 65:return fk(t);case 71:return CP(t);case 80:return Fg(t,n,!i.raw).replace(qn,"");case 81:return EP(t,n).replace(qn,"");case 4108:return AP(t);case 4126:case 4127:return n==4127?TP(t):SP(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Jy(t,e){var r=me(4),n=me(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=me(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=wP(e);break;case 31:case 80:for(n=me(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return an([r,n])}function Zy(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],o=0,c=0,u=-1,h={};for(o=0;o!=s;++o){var d=t.read_shift(4),g=t.read_shift(4);i[o]=[d,g+r]}i.sort(function(B,b){return B[1]-b[1]});var x={};for(o=0;o!=s;++o){if(t.l!==i[o][1]){var y=!0;if(o>0&&e)switch(e[i[o-1][0]].t){case 2:t.l+2===i[o][1]&&(t.l+=2,y=!1);break;case 80:t.l<=i[o][1]&&(t.l=i[o][1],y=!1);break;case 4108:t.l<=i[o][1]&&(t.l=i[o][1],y=!1);break}if((!e||o==0)&&t.l<=i[o][1]&&(y=!1,t.l=i[o][1]),y)throw new Error("Read Error: Expected address "+i[o][1]+" at "+t.l+" :"+o)}if(e){var k=e[i[o][0]];if(x[k.n]=ad(t,k.t,{raw:!0}),k.p==="version"&&(x[k.n]=String(x[k.n]>>16)+"."+("0000"+String(x[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(x[k.n]){case 0:x[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ii(c=x[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[k.n])}}else if(i[o][0]===1){if(c=x.CodePage=ad(t,rx),ii(c),u!==-1){var w=t.l;t.l=i[u][1],h=Qy(t,c),t.l=w}}else if(i[o][0]===0){if(c===0){u=o,t.l=i[o+1][1];continue}h=Qy(t,c)}else{var S=h[i[o][0]],N;switch(t[t.l]){case 65:t.l+=4,N=fk(t);break;case 30:t.l+=4,N=Fg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,N=Fg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,N=t.read_shift(4,"i");break;case 19:t.l+=4,N=t.read_shift(4);break;case 5:t.l+=4,N=t.read_shift(8,"f");break;case 11:t.l+=4,N=Fr(t,4);break;case 64:t.l+=4,N=or(sx(t));break;default:throw new Error("unparsed value: "+t[t.l])}x[S]=N}}return t.l=r+n,x}var hk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function IP(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function ew(t,e,r){var n=me(8),s=[],i=[],o=8,c=0,u=me(8),h=me(8);if(u.write_shift(4,2),u.write_shift(4,1200),h.write_shift(4,1),i.push(u),s.push(h),o+=8+u.length,!e){h=me(8),h.write_shift(4,0),s.unshift(h);var d=[me(4)];for(d[0].write_shift(4,t.length),c=0;c<t.length;++c){var g=t[c][0];for(u=me(8+2*(g.length+1)+(g.length%2?0:2)),u.write_shift(4,c+2),u.write_shift(4,g.length+1),u.write_shift(0,g,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=an(d),i.unshift(u),o+=8+u.length}for(c=0;c<t.length;++c)if(!(e&&!e[t[c][0]])&&!(hk.indexOf(t[c][0])>-1||sk.indexOf(t[c][0])>-1)&&t[c][1]!=null){var x=t[c][1],y=0;if(e){y=+e[t[c][0]];var k=r[y];if(k.p=="version"&&typeof x=="string"){var w=x.split(".");x=(+w[0]<<16)+(+w[1]||0)}u=Jy(k.t,x)}else{var S=IP(x);S==-1&&(S=31,x=String(x)),u=Jy(S,x)}i.push(u),h=me(8),h.write_shift(4,e?y:2+c),s.push(h),o+=8+u.length}var N=8*(i.length+1);for(c=0;c<i.length;++c)s[c].write_shift(4,N),N+=i[c].length;return n.write_shift(4,o),n.write_shift(4,i.length),an([n].concat(s).concat(i))}function tw(t,e,r){var n=t.content;if(!n)return{};gn(n,0);var s,i,o,c,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),d=n.read_shift(16);if(d!==Ze.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),c=n.read_shift(4),s===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);s===2&&(o=n.read_shift(16),u=n.read_shift(4));var g=Zy(n,e),x={SystemIdentifier:h};for(var y in g)x[y]=g[y];if(x.FMTID=i,s===1)return x;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var k;try{k=Zy(n,null)}catch{}for(y in k)x[y]=k[y];return x.FMTID=[i,o],x}function rw(t,e,r,n,s,i){var o=me(s?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ze.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,s?68:48);var u=ew(t,r,n);if(c.push(u),s){var h=ew(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+u.length),c.push(h)}return an(c)}function Qa(t,e){return t.read_shift(e),null}function FP(t,e){e||(e=me(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function bP(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Fr(t,e){return t.read_shift(e)===1}function $n(t,e){return e||(e=me(2)),e.write_shift(2,+!!t),e}function jr(t){return t.read_shift(2,"u")}function zs(t,e){return e||(e=me(2)),e.write_shift(2,t),e}function dk(t,e){return bP(t,e,jr)}function NP(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function pk(t,e,r){return r||(r=me(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Kf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?t.read_shift(n,s):"";return o}function RP(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),o=0,c,u={};s&&(o=t.read_shift(2)),n&&(c=t.read_shift(4));var h=i==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,h);return s&&(t.l+=4*o),n&&(t.l+=c),u.t=d,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function DP(t){var e=t.t||"",r=me(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=me(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return an(s)}function pl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function qf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):pl(t,n,r)}function kl(t,e,r){if(r.biff>5)return qf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function mk(t,e,r){return r||(r=me(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function PP(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function OP(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(qn,"");return n&&(t.l+=24),s}function LP(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(i>>1,"utf16le").replace(qn,"");return r+o}function MP(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return OP(t);case"0303000000000000c000000000000046":return LP(t);default:throw new Error("Unsupported Moniker "+r)}}function d0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(qn,""):"";return r}function nw(t,e){e||(e=me(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function BP(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,o,c,u,h="",d,g;s&16&&(i=d0(t,r-t.l)),s&128&&(o=d0(t,r-t.l)),(s&257)===257&&(c=d0(t,r-t.l)),(s&257)===1&&(u=MP(t,r-t.l)),s&8&&(h=d0(t,r-t.l)),s&32&&(d=t.read_shift(16)),s&64&&(g=sx(t)),t.l=r;var x=o||c||u||"";x&&h&&(x+="#"+h),x||(x="#"+h),s&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var y={Target:x};return d&&(y.guid=d),g&&(y.time=g),i&&(y.Tooltip=i),y}function VP(t){var e=me(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(i==28)n=n.slice(1),nw(n,e);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var c=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)e.write_shift(2,c.charCodeAt(r));e.write_shift(2,0),i&8&&nw(s>-1?n.slice(s+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var u=0;n.slice(u*3,u*3+3)=="../"||n.slice(u*3,u*3+3)=="..\\";)++u;for(e.write_shift(2,u),e.write_shift(4,n.length-3*u+1),r=0;r<n.length-3*u;++r)e.write_shift(1,n.charCodeAt(r+3*u)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function gk(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function xk(t,e){var r=gk(t);return r[3]=0,r}function $i(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function ml(t,e,r,n){return n||(n=me(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function jP(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function UP(t,e,r){return e===0?"":kl(t,e,r)}function zP(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[s,i,o]}function vk(t){var e=t.read_shift(2),r=tx(t);return[e,r]}function WP(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Kf(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Md(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function _k(t,e){return e||(e=me(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function yk(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var HP=yk;function wk(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function $P(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function GP(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Fn(t){t.l+=2,t.l+=t.read_shift(2)}var KP={0:Fn,4:Fn,5:Fn,6:Fn,7:GP,8:Fn,9:Fn,10:Fn,11:Fn,12:Fn,13:$P,14:Fn,15:Fn,16:Fn,17:Fn,18:Fn,19:Fn,20:Fn,21:wk};function qP(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(KP[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function p0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function ix(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=me(s);return i.write_shift(2,n),i.write_shift(2,e),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function XP(t,e){return e===0||t.read_shift(2),1200}function YP(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=kl(t,0,r);return t.read_shift(e+n-t.l),s}function QP(t,e){var r=!e||e.biff==8,n=me(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function JP(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function ZP(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=Kf(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:i,name:o}}function e8(t,e){var r=!e||e.biff>=8?2:1,n=me(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function t8(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],o=0;o!=s&&t.l<r;++o)i.push(RP(t));return i.Count=n,i.Unique=s,i}function r8(t,e){var r=me(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=DP(t[s]);var i=an([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function n8(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function s8(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function i8(t){var e=jP(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function a8(t){return t.read_shift(2),t.read_shift(4)}function sw(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function o8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:o,FirstTab:c,Selected:u,TabRatio:h}}function l8(){var t=me(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function c8(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function u8(t){var e=me(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function f8(){}function h8(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Kf(t,0,r),n}function d8(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,i=me(s);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function p8(t){var e=$i(t);return e.isst=t.read_shift(4),e}function m8(t,e,r,n){var s=me(10);return ml(t,e,n,s),s.write_shift(4,r),s}function g8(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=$i(t);r.biff==2&&t.l++;var i=qf(t,n-t.l,r);return s.val=i,s}function x8(t,e,r,n,s){var i=!s||s.biff==8,o=me(8+ +i+(1+i)*r.length);return ml(t,e,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function v8(t,e,r){var n=t.read_shift(2),s=kl(t,0,r);return[n,s]}function _8(t,e,r,n){var s=r&&r.biff==5;n||(n=me(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var y8=kl;function iw(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),o=t.read_shift(s),c=t.read_shift(2),u=t.read_shift(2);return t.l=n,{s:{r:i,c},e:{r:o,c:u}}}function w8(t,e){var r=e.biff==8||!e.biff?4:2,n=me(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function E8(t){var e=t.read_shift(2),r=t.read_shift(2),n=vk(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function T8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(vk(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:i}}function S8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:i}}function k8(t,e,r,n){var s={},i=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(2);return s.patternType=iP[c>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=c&127,s.icvBottom=c>>7&127,s.icvDiag=c>>14&127,s.dgDiag=c>>21&15,s.icvFore=u&127,s.icvBack=u>>7&127,s.fsxButton=u>>14&1),s}function A8(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=k8(t,e,n.fStyle,r),n}function aw(t,e,r,n){var s=r&&r.biff==5;n||(n=me(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function C8(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function I8(t){var e=me(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function ow(t,e,r){var n=$i(t);(r.biff==2||e==9)&&++t.l;var s=NP(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function F8(t,e,r,n,s,i){var o=me(8);return ml(t,e,n,o),pk(r,i,o),o}function b8(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=$i(t),s=Ln(t);return n.val=s,n}function N8(t,e,r,n){var s=me(14);return ml(t,e,n,s),dl(r,s),s}var lw=UP;function R8(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=pl(t,i),c=[];n>t.l;)c.push(qf(t));return[i,s,o,c]}function cw(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=WP(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var D8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function uw(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),u=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var h=pl(t,o,r);s&32&&(h=D8[h.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var g=n==t.l||c===0||!(d>0)?[]:qM(t,d,r,c);return{chKey:i,Name:h,itab:u,rgce:g}}function Ek(t,e,r){if(r.biff<8)return P8(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(zP(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function P8(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Kf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function O8(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=pl(t,n,r),o=pl(t,s,r);return[i,o]}function L8(t,e,r){var n=yk(t);t.l++;var s=t.read_shift(1);return e-=8,[XM(t,e,r),s,n]}function fw(t,e,r){var n=HP(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,GM(t,e,r)]}function M8(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function B8(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=kl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},c,o,i]}}function V8(t,e,r){return B8(t,e,r)}function j8(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Md(t));return r}function U8(t){var e=me(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)_k(t[r],e);return e}function z8(t,e,r){if(r&&r.biff<8)return H8(t,e,r);var n=wk(t),s=qP(t,e-22,n[1]);return{cmo:n,ft:s}}var W8={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function H8(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((W8[n]||Vn)(t,e,r)),{cmo:[s,n,i],ft:o}}function $8(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:o=PP(t,6,r);var c=t.read_shift(2);t.read_shift(2),jr(t,2);var u=t.read_shift(2);t.l+=u;for(var h=1;h<t.lens.length-1;++h){if(t.l-n!=t.lens[h])throw new Error("TxO: bad continue record");var d=t[t.l],g=pl(t,t.lens[h+1]-t.lens[h]-1);if(s+=g,s.length>=(d?c:2*c))break}if(s.length!==c&&s.length!==c*2)throw new Error("cchText: "+c+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function G8(t,e){var r=Md(t);t.l+=16;var n=BP(t,e-24);return[r,n]}function K8(t){var e=me(24),r=vr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return an([e,VP(t[1])])}function q8(t,e){t.read_shift(2);var r=Md(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(qn,""),[r,n]}function X8(t){var e=t[1].Tooltip,r=me(10+2*(e.length+1));r.write_shift(2,2048);var n=vr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function Y8(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Xy[r]||r,r=t.read_shift(2),e[1]=Xy[r]||r,e}function Q8(t){return t||(t=me(4)),t.write_shift(2,1),t.write_shift(2,1),t}function J8(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(xk(t));return r}function Z8(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(xk(t));return r}function e5(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function Tk(t,e,r){if(!r.cellStyles)return Vn(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(2);n==2&&(t.l+=2);var h={s,e:i,w:o,ixfe:c,flags:u};return(r.biff>=5||!r.biff)&&(h.level=u>>8&7),h}function t5(t,e){var r=me(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function r5(t,e){var r={};return e<32||(t.l+=16,r.header=Ln(t),r.footer=Ln(t),t.l+=2),r}function n5(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function s5(t){for(var e=me(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var i5=$i,a5=dk,o5=qf;function l5(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function c5(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=$i(t);++t.l;var s=kl(t,e-7,r);return n.t="str",n.val=s,n}function u5(t){var e=$i(t);++t.l;var r=Ln(t);return e.t="n",e.val=r,e}function f5(t,e,r){var n=me(15);return Jf(n,t,e),n.write_shift(8,r,"f"),n}function h5(t){var e=$i(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function d5(t,e,r){var n=me(9);return Jf(n,t,e),n.write_shift(2,r),n}function p5(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function m5(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function g5(t,e,r){var n=t.l+e,s=$i(t),i=t.read_shift(2),o=pl(t,i,r);return t.l=n,s.t="str",s.val=o,s}var x5=[2,3,48,49,131,139,140,245],bg=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Pd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,u){var h=[],d=go(1);switch(u.type){case"base64":d=ws(ks(c));break;case"binary":d=ws(c);break;case"buffer":case"array":d=c;break}gn(d,0);var g=d.read_shift(1),x=!!(g&136),y=!1,k=!1;switch(g){case 2:break;case 3:break;case 48:y=!0,x=!0;break;case 49:y=!0,x=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var w=0,S=521;g==2&&(w=d.read_shift(2)),d.l+=3,g!=2&&(w=d.read_shift(4)),w>1048576&&(w=1e6),g!=2&&(S=d.read_shift(2));var N=d.read_shift(2),B=u.codepage||1252;g!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(B=t[d[d.l]]),d.l+=1,d.l+=2),k&&(d.l+=36);for(var b=[],j={},X=Math.min(d.length,g==2?521:S-10-(y?264:0)),G=k?32:11;d.l<X&&d[d.l]!=13;)switch(j={},j.name=mf.utils.decode(B,d.slice(d.l,d.l+G)).replace(/[\u0000\r\n].*$/g,""),d.l+=G,j.type=String.fromCharCode(d.read_shift(1)),g!=2&&!k&&(j.offset=d.read_shift(4)),j.len=d.read_shift(1),g==2&&(j.offset=d.read_shift(2)),j.dec=d.read_shift(1),j.name.length&&b.push(j),g!=2&&(d.l+=k?13:14),j.type){case"B":(!y||j.len!=8)&&u.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(d[d.l]!==13&&(d.l=S-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=S;var A=0,C=0;for(h[0]=[],C=0;C!=b.length;++C)h[0][C]=b[C].name;for(;w-- >0;){if(d[d.l]===42){d.l+=N;continue}for(++d.l,h[++A]=[],C=0,C=0;C!=b.length;++C){var F=d.slice(d.l,d.l+b[C].len);d.l+=b[C].len,gn(F,0);var V=mf.utils.decode(B,F);switch(b[C].type){case"C":V.trim().length&&(h[A][C]=V.replace(/\s+$/,""));break;case"D":V.length===8?h[A][C]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):h[A][C]=V;break;case"F":h[A][C]=parseFloat(V.trim());break;case"+":case"I":h[A][C]=k?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":h[A][C]=!0;break;case"N":case"F":h[A][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));h[A][C]="##MEMO##"+(k?parseInt(V.trim(),10):F.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(h[A][C]=+V||0);break;case"@":h[A][C]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":h[A][C]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":h[A][C]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[A][C]=-F.read_shift(-8,"f");break;case"B":if(y&&b[C].len==8){h[A][C]=F.read_shift(8,"f");break}case"G":case"P":F.l+=b[C].len;break;case"0":if(b[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[C].type)}}}if(g!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(h=h.slice(0,u.sheetRows)),u.DBF=b,h}function n(c,u){var h=u||{};h.dateNF||(h.dateNF="yyyymmdd");var d=Gc(r(c,h),h);return d["!cols"]=h.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete h.DBF,d}function s(c,u){try{return So(n(c,u),u)}catch(h){if(u&&u.WTF)throw h}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,u){var h=u||{};if(+h.codepage>=0&&ii(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var d=ls(),g=cd(c,{header:1,raw:!0,cellDates:!0}),x=g[0],y=g.slice(1),k=c["!cols"]||[],w=0,S=0,N=0,B=1;for(w=0;w<x.length;++w){if(((k[w]||{}).DBF||{}).name){x[w]=k[w].DBF.name,++N;continue}if(x[w]!=null){if(++N,typeof x[w]=="number"&&(x[w]=x[w].toString(10)),typeof x[w]!="string")throw new Error("DBF Invalid column name "+x[w]+" |"+typeof x[w]+"|");if(x.indexOf(x[w])!==w){for(S=0;S<1024;++S)if(x.indexOf(x[w]+"_"+S)==-1){x[w]+="_"+S;break}}}}var b=Ot(c["!ref"]),j=[],X=[],G=[];for(w=0;w<=b.e.c-b.s.c;++w){var A="",C="",F=0,V=[];for(S=0;S<y.length;++S)y[S][w]!=null&&V.push(y[S][w]);if(V.length==0||x[w]==null){j[w]="?";continue}for(S=0;S<V.length;++S){switch(typeof V[S]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=V[S]instanceof Date?"D":"C";break;default:C="C"}F=Math.max(F,String(V[S]).length),A=A&&A!=C?"C":C}F>250&&(F=250),C=((k[w]||{}).DBF||{}).type,C=="C"&&k[w].DBF.len>F&&(F=k[w].DBF.len),A=="B"&&C=="N"&&(A="N",G[w]=k[w].DBF.dec,F=k[w].DBF.len),X[w]=A=="C"||C=="N"?F:i[A]||0,B+=X[w],j[w]=A}var M=d.next(32);for(M.write_shift(4,318902576),M.write_shift(4,y.length),M.write_shift(2,296+32*N),M.write_shift(2,B),w=0;w<4;++w)M.write_shift(4,0);for(M.write_shift(4,0|(+e[hS]||3)<<8),w=0,S=0;w<x.length;++w)if(x[w]!=null){var D=d.next(32),L=(x[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,L,"sbcs"),D.write_shift(1,j[w]=="?"?"C":j[w],"sbcs"),D.write_shift(4,S),D.write_shift(1,X[w]||i[j[w]]||0),D.write_shift(1,G[w]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),S+=X[w]||i[j[w]]||0}var ke=d.next(264);for(ke.write_shift(4,13),w=0;w<65;++w)ke.write_shift(4,0);for(w=0;w<y.length;++w){var Se=d.next(B);for(Se.write_shift(1,0),S=0;S<x.length;++S)if(x[S]!=null)switch(j[S]){case"L":Se.write_shift(1,y[w][S]==null?63:y[w][S]?84:70);break;case"B":Se.write_shift(8,y[w][S]||0,"f");break;case"N":var De="0";for(typeof y[w][S]=="number"&&(De=y[w][S].toFixed(G[S]||0)),N=0;N<X[S]-De.length;++N)Se.write_shift(1,32);Se.write_shift(1,De,"sbcs");break;case"D":y[w][S]?(Se.write_shift(4,("0000"+y[w][S].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(y[w][S].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+y[w][S].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(y[w][S]!=null?y[w][S]:"").slice(0,X[S]);for(Se.write_shift(1,Ne,"sbcs"),N=0;N<X[S]-Ne.length;++N)Se.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}})(),Sk=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+kr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,y){var k=t[y];return typeof k=="number"?Ey(k):k},n=function(x,y,k){var w=y.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return w==59?x:Ey(w)};t["|"]=254;function s(x,y){switch(y.type){case"base64":return i(ks(x),y);case"binary":return i(x,y);case"buffer":return i(_t&&Buffer.isBuffer(x)?x.toString("binary"):To(x),y);case"array":return i(hl(x),y)}throw new Error("Unrecognized type "+y.type)}function i(x,y){var k=x.split(/[\n\r]+/),w=-1,S=-1,N=0,B=0,b=[],j=[],X=null,G={},A=[],C=[],F=[],V=0,M;for(+y.codepage>=0&&ii(+y.codepage);N!==k.length;++N){V=0;var D=k[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),L=D.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),ke=L[0],Se;if(D.length>0)switch(ke){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&j.push(D.slice(3).replace(/;;/g,";"));break;case"C":var De=!1,Ne=!1,Ce=!1,ne=!1,ye=-1,ee=-1;for(B=1;B<L.length;++B)switch(L[B].charAt(0)){case"A":break;case"X":S=parseInt(L[B].slice(1))-1,Ne=!0;break;case"Y":for(w=parseInt(L[B].slice(1))-1,Ne||(S=0),M=b.length;M<=w;++M)b[M]=[];break;case"K":Se=L[B].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(li(Se))?isNaN(Rc(Se).getDate())||(Se=or(Se)):(Se=li(Se),X!==null&&Hc(X)&&(Se=Ld(Se))),De=!0;break;case"E":ne=!0;var O=wc(L[B].slice(1),{r:w,c:S});b[w][S]=[b[w][S],O];break;case"S":Ce=!0,b[w][S]=[b[w][S],"S5S"];break;case"G":break;case"R":ye=parseInt(L[B].slice(1))-1;break;case"C":ee=parseInt(L[B].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+D)}if(De&&(b[w][S]&&b[w][S].length==2?b[w][S][0]=Se:b[w][S]=Se,X=null),Ce){if(ne)throw new Error("SYLK shared formula cannot have own formula");var te=ye>-1&&b[ye][ee];if(!te||!te[1])throw new Error("SYLK shared formula cannot find base");b[w][S][1]=zk(te[1],{r:w-ye,c:S-ee})}break;case"F":var J=0;for(B=1;B<L.length;++B)switch(L[B].charAt(0)){case"X":S=parseInt(L[B].slice(1))-1,++J;break;case"Y":for(w=parseInt(L[B].slice(1))-1,M=b.length;M<=w;++M)b[M]=[];break;case"M":V=parseInt(L[B].slice(1))/20;break;case"F":break;case"G":break;case"P":X=j[parseInt(L[B].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=L[B].slice(1).split(" "),M=parseInt(F[0],10);M<=parseInt(F[1],10);++M)V=parseInt(F[2],10),C[M-1]=V===0?{hidden:!0}:{wch:V},xo(C[M-1]);break;case"C":S=parseInt(L[B].slice(1))-1,C[S]||(C[S]={});break;case"R":w=parseInt(L[B].slice(1))-1,A[w]||(A[w]={}),V>0?(A[w].hpt=V,A[w].hpx=Pc(V)):V===0&&(A[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+D)}J<1&&(X=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+D)}}return A.length>0&&(G["!rows"]=A),C.length>0&&(G["!cols"]=C),y&&y.sheetRows&&(b=b.slice(0,y.sheetRows)),[b,G]}function o(x,y){var k=s(x,y),w=k[0],S=k[1],N=Gc(w,y);return kr(S).forEach(function(B){N[B]=S[B]}),N}function c(x,y){return So(o(x,y),y)}function u(x,y,k,w){var S="C;Y"+(k+1)+";X"+(w+1)+";K";switch(x.t){case"n":S+=x.v||0,x.f&&!x.F&&(S+=";E"+fx(x.f,{r:k,c:w}));break;case"b":S+=x.v?"TRUE":"FALSE";break;case"e":S+=x.w||x.v;break;case"d":S+='"'+(x.w||x.v)+'"';break;case"s":S+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function h(x,y){y.forEach(function(k,w){var S="F;W"+(w+1)+" "+(w+1)+" ";k.hidden?S+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=Tf(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=Sf(k.wpx)),typeof k.wch=="number"&&(S+=Math.round(k.wch))),S.charAt(S.length-1)!=" "&&x.push(S)})}function d(x,y){y.forEach(function(k,w){var S="F;";k.hidden?S+="M0;":k.hpt?S+="M"+20*k.hpt+";":k.hpx&&(S+="M"+20*kf(k.hpx)+";"),S.length>2&&x.push(S+"R"+(w+1))})}function g(x,y){var k=["ID;PWXL;N;E"],w=[],S=Ot(x["!ref"]),N,B=Array.isArray(x),b=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),x["!cols"]&&h(k,x["!cols"]),x["!rows"]&&d(k,x["!rows"]),k.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var j=S.s.r;j<=S.e.r;++j)for(var X=S.s.c;X<=S.e.c;++X){var G=it({r:j,c:X});N=B?(x[j]||[])[X]:x[G],!(!N||N.v==null&&(!N.f||N.F))&&w.push(u(N,x,j,X))}return k.join(b)+b+w.join(b)+b+"E"+b}return{to_workbook:c,to_sheet:o,from_sheet:g}})(),kk=(function(){function t(i,o){switch(o.type){case"base64":return e(ks(i),o);case"binary":return e(i,o);case"buffer":return e(_t&&Buffer.isBuffer(i)?i.toString("binary"):To(i),o);case"array":return e(hl(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var c=i.split(`
`),u=-1,h=-1,d=0,g=[];d!==c.length;++d){if(c[d].trim()==="BOT"){g[++u]=[],h=0;continue}if(!(u<0)){var x=c[d].trim().split(","),y=x[0],k=x[1];++d;for(var w=c[d]||"";(w.match(/["]/g)||[]).length&1&&d<c.length-1;)w+=`
`+c[++d];switch(w=w.trim(),+y){case-1:if(w==="BOT"){g[++u]=[],h=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?g[u][h]=!0:w==="FALSE"?g[u][h]=!1:isNaN(li(k))?isNaN(Rc(k).getDate())?g[u][h]=k:g[u][h]=or(k):g[u][h]=li(k),++h;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),g[u][h++]=w!==""?w:null;break}if(w==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(i,o){return Gc(t(i,o),o)}function n(i,o){return So(r(i,o),o)}var s=(function(){var i=function(u,h,d,g,x){u.push(h),u.push(d+","+g),u.push('"'+x.replace(/"/g,'""')+'"')},o=function(u,h,d,g){u.push(h+","+d),u.push(h==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var h=[],d=Ot(u["!ref"]),g,x=Array.isArray(u);i(h,"TABLE",0,1,"sheetjs"),i(h,"VECTORS",0,d.e.r-d.s.r+1,""),i(h,"TUPLES",0,d.e.c-d.s.c+1,""),i(h,"DATA",0,0,"");for(var y=d.s.r;y<=d.e.r;++y){o(h,-1,0,"BOT");for(var k=d.s.c;k<=d.e.c;++k){var w=it({r:y,c:k});if(g=x?(u[y]||[])[k]:u[w],!g){o(h,1,0,"");continue}switch(g.t){case"n":var S=g.w;!S&&g.v!=null&&(S=g.v),S==null?g.f&&!g.F?o(h,1,0,"="+g.f):o(h,1,0,""):o(h,0,S,"V");break;case"b":o(h,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=$s(g.z||nt[14],Qr(or(g.v)))),o(h,0,g.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var N=`\r
`,B=h.join(N);return B}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),Ak=(function(){function t(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,x){for(var y=g.split(`
`),k=-1,w=-1,S=0,N=[];S!==y.length;++S){var B=y[S].trim().split(":");if(B[0]==="cell"){var b=vr(B[1]);if(N.length<=b.r)for(k=N.length;k<=b.r;++k)N[k]||(N[k]=[]);switch(k=b.r,w=b.c,B[2]){case"t":N[k][w]=t(B[3]);break;case"v":N[k][w]=+B[3];break;case"vtf":var j=B[B.length-1];case"vtc":switch(B[3]){case"nl":N[k][w]=!!+B[4];break;default:N[k][w]=+B[4];break}B[2]=="vtf"&&(N[k][w]=[N[k][w],j])}}}return x&&x.sheetRows&&(N=N.slice(0,x.sheetRows)),N}function n(g,x){return Gc(r(g,x),x)}function s(g,x){return So(n(g,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function h(g){if(!g||!g["!ref"])return"";for(var x=[],y=[],k,w="",S=cs(g["!ref"]),N=Array.isArray(g),B=S.s.r;B<=S.e.r;++B)for(var b=S.s.c;b<=S.e.c;++b)if(w=it({r:B,c:b}),k=N?(g[B]||[])[b]:g[w],!(!k||k.v==null||k.t==="z")){switch(y=["cell",w,"t"],k.t){case"s":case"str":y.push(e(k.v));break;case"n":k.f?(y[2]="vtf",y[3]="n",y[4]=k.v,y[5]=e(k.f)):(y[2]="v",y[3]=k.v);break;case"b":y[2]="vt"+(k.f?"f":"c"),y[3]="nl",y[4]=k.v?"1":"0",y[5]=e(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var j=Qr(or(k.v));y[2]="vtc",y[3]="nd",y[4]=""+j,y[5]=k.w||$s(k.z||nt[14],j);break;case"e":continue}x.push(y.join(":"))}return x.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(g){return[i,o,c,o,h(g),u].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}})(),Dc=(function(){function t(d,g,x,y,k){k.raw?g[x][y]=d:d===""||(d==="TRUE"?g[x][y]=!0:d==="FALSE"?g[x][y]=!1:isNaN(li(d))?isNaN(Rc(d).getDate())?g[x][y]=d:g[x][y]=or(d):g[x][y]=li(d))}function e(d,g){var x=g||{},y=[];if(!d||d.length===0)return y;for(var k=d.split(/[\r\n]/),w=k.length-1;w>=0&&k[w].length===0;)--w;for(var S=10,N=0,B=0;B<=w;++B)N=k[B].indexOf(" "),N==-1?N=k[B].length:N++,S=Math.max(S,N);for(B=0;B<=w;++B){y[B]=[];var b=0;for(t(k[B].slice(0,S).trim(),y,B,b,x),b=1;b<=(k[B].length-S)/10+1;++b)t(k[B].slice(S+(b-1)*10,S+b*10).trim(),y,B,b,x)}return x.sheetRows&&(y=y.slice(0,x.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var g={},x=!1,y=0,k=0;y<d.length;++y)(k=d.charCodeAt(y))==34?x=!x:!x&&k in r&&(g[k]=(g[k]||0)+1);k=[];for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&k.push([g[y],y]);if(!k.length){g=n;for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&k.push([g[y],y])}return k.sort(function(w,S){return w[0]-S[0]||n[w[1]]-n[S[1]]}),r[k.pop()[1]]||44}function i(d,g){var x=g||{},y="",k=x.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(y=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(y=d.charAt(4),d=d.slice(6)):y=s(d.slice(0,1024)):x&&x.FS?y=x.FS:y=s(d.slice(0,1024));var S=0,N=0,B=0,b=0,j=0,X=y.charCodeAt(0),G=!1,A=0,C=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var F=x.dateNF!=null?nD(x.dateNF):null;function V(){var M=d.slice(b,j),D={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)D.t="z";else if(x.raw)D.t="s",D.v=M;else if(M.trim().length===0)D.t="s",D.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(D.t="s",D.v=M.slice(2,-1).replace(/""/g,'"')):RL(M)?(D.t="n",D.f=M.slice(1)):(D.t="s",D.v=M);else if(M=="TRUE")D.t="b",D.v=!0;else if(M=="FALSE")D.t="b",D.v=!1;else if(!isNaN(B=li(M)))D.t="n",x.cellText!==!1&&(D.w=M),D.v=B;else if(!isNaN(Rc(M).getDate())||F&&M.match(F)){D.z=x.dateNF||nt[14];var L=0;F&&M.match(F)&&(M=sD(M,x.dateNF,M.match(F)||[]),L=1),x.cellDates?(D.t="d",D.v=or(M,L)):(D.t="n",D.v=Qr(or(M,L))),x.cellText!==!1&&(D.w=$s(D.z,D.v instanceof Date?Qr(D.v):D.v)),x.cellNF||delete D.z}else D.t="s",D.v=M;if(D.t=="z"||(x.dense?(k[S]||(k[S]=[]),k[S][N]=D):k[it({c:N,r:S})]=D),b=j+1,C=d.charCodeAt(b),w.e.c<N&&(w.e.c=N),w.e.r<S&&(w.e.r=S),A==X)++N;else if(N=0,++S,x.sheetRows&&x.sheetRows<=S)return!0}e:for(;j<d.length;++j)switch(A=d.charCodeAt(j)){case 34:C===34&&(G=!G);break;case X:case 10:case 13:if(!G&&V())break e;break}return j-b>0&&V(),k["!ref"]=xt(w),k}function o(d,g){return!(g&&g.PRN)||g.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,g):Gc(e(d,g),g)}function c(d,g){var x="",y=g.type=="string"?[0,0,0,0]:_x(d,g);switch(g.type){case"base64":x=ks(d);break;case"binary":x=d;break;case"buffer":g.codepage==65001?x=d.toString("utf8"):g.codepage&&typeof mf<"u"||(x=_t&&Buffer.isBuffer(d)?d.toString("binary"):To(d));break;case"array":x=hl(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+g.type)}return y[0]==239&&y[1]==187&&y[2]==191?x=Qt(x.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?x=Qt(x):g.type=="binary"&&typeof mf<"u",x.slice(0,19)=="socialcalc:version:"?Ak.to_sheet(g.type=="string"?x:Qt(x),g):o(x,g)}function u(d,g){return So(c(d,g),g)}function h(d){for(var g=[],x=Ot(d["!ref"]),y,k=Array.isArray(d),w=x.s.r;w<=x.e.r;++w){for(var S=[],N=x.s.c;N<=x.e.c;++N){var B=it({r:w,c:N});if(y=k?(d[w]||[])[N]:d[B],!y||y.v==null){S.push("          ");continue}for(var b=(y.w||(Ta(y),y.w)||"").slice(0,10);b.length<10;)b+=" ";S.push(b+(N===0?" ":""))}g.push(S.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:h}})();function v5(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=Sk.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Dc.to_workbook(t,e)}}var nl=(function(){function t(O,te,J){if(O){gn(O,O.l||0);for(var Z=J.Enum||ye;O.l<O.length;){var oe=O.read_shift(2),_e=Z[oe]||Z[65535],ve=O.read_shift(2),xe=O.l+ve,Ee=_e.f&&_e.f(O,ve,J);if(O.l=xe,te(Ee,_e,oe))return}}}function e(O,te){switch(te.type){case"base64":return r(ws(ks(O)),te);case"binary":return r(ws(O),te);case"buffer":case"array":return r(O,te)}throw"Unsupported type "+te.type}function r(O,te){if(!O)return O;var J=te||{},Z=J.dense?[]:{},oe="Sheet1",_e="",ve=0,xe={},Ee=[],st=[],Y={s:{r:0,c:0},e:{r:0,c:0}},Et=J.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)J.Enum=ye,t(O,function(je,Ht,St){switch(St){case 0:J.vers=je,je>=4096&&(J.qpro=!0);break;case 6:Y=je;break;case 204:je&&(_e=je);break;case 222:_e=je;break;case 15:case 51:J.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:St==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=J.dateNF||nt[14],J.cellDates&&(je[1].t="d",je[1].v=Ld(je[1].v))),J.qpro&&je[3]>ve&&(Z["!ref"]=xt(Y),xe[oe]=Z,Ee.push(oe),Z=J.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ve=je[3],oe=_e||"Sheet"+(ve+1),_e="");var Tt=J.dense?(Z[je[0].r]||[])[je[0].c]:Z[it(je[0])];if(Tt){Tt.t=je[1].t,Tt.v=je[1].v,je[1].z!=null&&(Tt.z=je[1].z),je[1].f!=null&&(Tt.f=je[1].f);break}J.dense?(Z[je[0].r]||(Z[je[0].r]=[]),Z[je[0].r][je[0].c]=je[1]):Z[it(je[0])]=je[1];break}},J);else if(O[2]==26||O[2]==14)J.Enum=ee,O[2]==14&&(J.qpro=!0,O.l=0),t(O,function(je,Ht,St){switch(St){case 204:oe=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>ve&&(Z["!ref"]=xt(Y),xe[oe]=Z,Ee.push(oe),Z=J.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ve=je[3],oe="Sheet"+(ve+1)),Et>0&&je[0].r>=Et)break;J.dense?(Z[je[0].r]||(Z[je[0].r]=[]),Z[je[0].r][je[0].c]=je[1]):Z[it(je[0])]=je[1],Y.e.c<je[0].c&&(Y.e.c=je[0].c),Y.e.r<je[0].r&&(Y.e.r=je[0].r);break;case 27:je[14e3]&&(st[je[14e3][0]]=je[14e3][1]);break;case 1537:st[je[0]]=je[1],je[0]==ve&&(oe=je[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(Z["!ref"]=xt(Y),xe[_e||oe]=Z,Ee.push(_e||oe),!st.length)return{SheetNames:Ee,Sheets:xe};for(var gt={},It=[],ht=0;ht<st.length;++ht)xe[Ee[ht]]?(It.push(st[ht]||Ee[ht]),gt[st[ht]]=xe[st[ht]]||xe[Ee[ht]]):(It.push(st[ht]),gt[st[ht]]={"!ref":"A1"});return{SheetNames:It,Sheets:gt}}function n(O,te){var J=te||{};if(+J.codepage>=0&&ii(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=ls(),oe=Ot(O["!ref"]),_e=Array.isArray(O),ve=[];Ue(Z,0,i(1030)),Ue(Z,6,u(oe));for(var xe=Math.min(oe.e.r,8191),Ee=oe.s.r;Ee<=xe;++Ee)for(var st=Nr(Ee),Y=oe.s.c;Y<=oe.e.c;++Y){Ee===oe.s.r&&(ve[Y]=xr(Y));var Et=ve[Y]+st,gt=_e?(O[Ee]||[])[Y]:O[Et];if(!(!gt||gt.t=="z"))if(gt.t=="n")(gt.v|0)==gt.v&&gt.v>=-32768&&gt.v<=32767?Ue(Z,13,y(Ee,Y,gt.v)):Ue(Z,14,w(Ee,Y,gt.v));else{var It=Ta(gt);Ue(Z,15,g(Ee,Y,It.slice(0,239)))}}return Ue(Z,1),Z.end()}function s(O,te){var J=te||{};if(+J.codepage>=0&&ii(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=ls();Ue(Z,0,o(O));for(var oe=0,_e=0;oe<O.SheetNames.length;++oe)(O.Sheets[O.SheetNames[oe]]||{})["!ref"]&&Ue(Z,27,ne(O.SheetNames[oe],_e++));var ve=0;for(oe=0;oe<O.SheetNames.length;++oe){var xe=O.Sheets[O.SheetNames[oe]];if(!(!xe||!xe["!ref"])){for(var Ee=Ot(xe["!ref"]),st=Array.isArray(xe),Y=[],Et=Math.min(Ee.e.r,8191),gt=Ee.s.r;gt<=Et;++gt)for(var It=Nr(gt),ht=Ee.s.c;ht<=Ee.e.c;++ht){gt===Ee.s.r&&(Y[ht]=xr(ht));var je=Y[ht]+It,Ht=st?(xe[gt]||[])[ht]:xe[je];if(!(!Ht||Ht.t=="z"))if(Ht.t=="n")Ue(Z,23,V(gt,ht,ve,Ht.v));else{var St=Ta(Ht);Ue(Z,22,A(gt,ht,ve,St.slice(0,239)))}}++ve}}return Ue(Z,1),Z.end()}function i(O){var te=me(2);return te.write_shift(2,O),te}function o(O){var te=me(26);te.write_shift(2,4096),te.write_shift(2,4),te.write_shift(4,0);for(var J=0,Z=0,oe=0,_e=0;_e<O.SheetNames.length;++_e){var ve=O.SheetNames[_e],xe=O.Sheets[ve];if(!(!xe||!xe["!ref"])){++oe;var Ee=cs(xe["!ref"]);J<Ee.e.r&&(J=Ee.e.r),Z<Ee.e.c&&(Z=Ee.e.c)}}return J>8191&&(J=8191),te.write_shift(2,J),te.write_shift(1,oe),te.write_shift(1,Z),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(1,1),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(4,0),te}function c(O,te,J){var Z={s:{c:0,r:0},e:{c:0,r:0}};return te==8&&J.qpro?(Z.s.c=O.read_shift(1),O.l++,Z.s.r=O.read_shift(2),Z.e.c=O.read_shift(1),O.l++,Z.e.r=O.read_shift(2),Z):(Z.s.c=O.read_shift(2),Z.s.r=O.read_shift(2),te==12&&J.qpro&&(O.l+=2),Z.e.c=O.read_shift(2),Z.e.r=O.read_shift(2),te==12&&J.qpro&&(O.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function u(O){var te=me(8);return te.write_shift(2,O.s.c),te.write_shift(2,O.s.r),te.write_shift(2,O.e.c),te.write_shift(2,O.e.r),te}function h(O,te,J){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(Z[0].c=O.read_shift(1),Z[3]=O.read_shift(1),Z[0].r=O.read_shift(2),O.l+=2):(Z[2]=O.read_shift(1),Z[0].c=O.read_shift(2),Z[0].r=O.read_shift(2)),Z}function d(O,te,J){var Z=O.l+te,oe=h(O,te,J);if(oe[1].t="s",J.vers==20768){O.l++;var _e=O.read_shift(1);return oe[1].v=O.read_shift(_e,"utf8"),oe}return J.qpro&&O.l++,oe[1].v=O.read_shift(Z-O.l,"cstr"),oe}function g(O,te,J){var Z=me(7+J.length);Z.write_shift(1,255),Z.write_shift(2,te),Z.write_shift(2,O),Z.write_shift(1,39);for(var oe=0;oe<Z.length;++oe){var _e=J.charCodeAt(oe);Z.write_shift(1,_e>=128?95:_e)}return Z.write_shift(1,0),Z}function x(O,te,J){var Z=h(O,te,J);return Z[1].v=O.read_shift(2,"i"),Z}function y(O,te,J){var Z=me(7);return Z.write_shift(1,255),Z.write_shift(2,te),Z.write_shift(2,O),Z.write_shift(2,J,"i"),Z}function k(O,te,J){var Z=h(O,te,J);return Z[1].v=O.read_shift(8,"f"),Z}function w(O,te,J){var Z=me(13);return Z.write_shift(1,255),Z.write_shift(2,te),Z.write_shift(2,O),Z.write_shift(8,J,"f"),Z}function S(O,te,J){var Z=O.l+te,oe=h(O,te,J);if(oe[1].v=O.read_shift(8,"f"),J.qpro)O.l=Z;else{var _e=O.read_shift(2);j(O.slice(O.l,O.l+_e),oe),O.l+=_e}return oe}function N(O,te,J){var Z=te&32768;return te&=-32769,te=(Z?O:0)+(te>=8192?te-16384:te),(Z?"":"$")+(J?xr(te):Nr(te))}var B={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(O,te){gn(O,0);for(var J=[],Z=0,oe="",_e="",ve="",xe="";O.l<O.length;){var Ee=O[O.l++];switch(Ee){case 0:J.push(O.read_shift(8,"f"));break;case 1:_e=N(te[0].c,O.read_shift(2),!0),oe=N(te[0].r,O.read_shift(2),!1),J.push(_e+oe);break;case 2:{var st=N(te[0].c,O.read_shift(2),!0),Y=N(te[0].r,O.read_shift(2),!1);_e=N(te[0].c,O.read_shift(2),!0),oe=N(te[0].r,O.read_shift(2),!1),J.push(st+Y+":"+_e+oe)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(O.read_shift(2));break;case 6:{for(var Et="";Ee=O[O.l++];)Et+=String.fromCharCode(Ee);J.push('"'+Et.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:xe=J.pop(),ve=J.pop(),J.push(["AND","OR"][Ee-20]+"("+ve+","+xe+")");break;default:if(Ee<32&&b[Ee])xe=J.pop(),ve=J.pop(),J.push(ve+b[Ee]+xe);else if(B[Ee]){if(Z=B[Ee][1],Z==69&&(Z=O[O.l++]),Z>J.length){console.error("WK1 bad formula parse 0x"+Ee.toString(16)+":|"+J.join("|")+"|");return}var gt=J.slice(-Z);J.length-=Z,J.push(B[Ee][0]+"("+gt.join(",")+")")}else return Ee<=7?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=24?console.error("WK1 unsupported op "+Ee.toString(16)):Ee<=30?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=115?console.error("WK1 unsupported function opcode "+Ee.toString(16)):console.error("WK1 unrecognized opcode "+Ee.toString(16))}}J.length==1?te[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function X(O){var te=[{c:0,r:0},{t:"n",v:0},0];return te[0].r=O.read_shift(2),te[3]=O[O.l++],te[0].c=O[O.l++],te}function G(O,te){var J=X(O);return J[1].t="s",J[1].v=O.read_shift(te-4,"cstr"),J}function A(O,te,J,Z){var oe=me(6+Z.length);oe.write_shift(2,O),oe.write_shift(1,J),oe.write_shift(1,te),oe.write_shift(1,39);for(var _e=0;_e<Z.length;++_e){var ve=Z.charCodeAt(_e);oe.write_shift(1,ve>=128?95:ve)}return oe.write_shift(1,0),oe}function C(O,te){var J=X(O);J[1].v=O.read_shift(2);var Z=J[1].v>>1;if(J[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return J[1].v=Z,J}function F(O,te){var J=X(O),Z=O.read_shift(4),oe=O.read_shift(4),_e=O.read_shift(2);if(_e==65535)return Z===0&&oe===3221225472?(J[1].t="e",J[1].v=15):Z===0&&oe===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var ve=_e&32768;return _e=(_e&32767)-16446,J[1].v=(1-ve*2)*(oe*Math.pow(2,_e+32)+Z*Math.pow(2,_e)),J}function V(O,te,J,Z){var oe=me(14);if(oe.write_shift(2,O),oe.write_shift(1,J),oe.write_shift(1,te),Z==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var _e=0,ve=0,xe=0,Ee=0;return Z<0&&(_e=1,Z=-Z),ve=Math.log2(Z)|0,Z/=Math.pow(2,ve-31),Ee=Z>>>0,(Ee&2147483648)==0&&(Z/=2,++ve,Ee=Z>>>0),Z-=Ee,Ee|=2147483648,Ee>>>=0,Z*=Math.pow(2,32),xe=Z>>>0,oe.write_shift(4,xe),oe.write_shift(4,Ee),ve+=16383+(_e?32768:0),oe.write_shift(2,ve),oe}function M(O,te){var J=F(O);return O.l+=te-14,J}function D(O,te){var J=X(O),Z=O.read_shift(4);return J[1].v=Z>>6,J}function L(O,te){var J=X(O),Z=O.read_shift(8,"f");return J[1].v=Z,J}function ke(O,te){var J=L(O);return O.l+=te-10,J}function Se(O,te){return O[O.l+te-1]==0?O.read_shift(te,"cstr"):""}function De(O,te){var J=O[O.l++];J>te-1&&(J=te-1);for(var Z="";Z.length<J;)Z+=String.fromCharCode(O[O.l++]);return Z}function Ne(O,te,J){if(!(!J.qpro||te<21)){var Z=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var oe=O.read_shift(te-21,"cstr");return[Z,oe]}}function Ce(O,te){for(var J={},Z=O.l+te;O.l<Z;){var oe=O.read_shift(2);if(oe==14e3){for(J[oe]=[0,""],J[oe][0]=O.read_shift(2);O[O.l];)J[oe][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return J}function ne(O,te){var J=me(5+O.length);J.write_shift(2,14e3),J.write_shift(2,te);for(var Z=0;Z<O.length;++Z){var oe=O.charCodeAt(Z);J[J.l++]=oe>127?95:oe}return J[J.l++]=0,J}var ye={0:{n:"BOF",f:jr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:De},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ce},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:ke},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}})();function _5(t){var e={},r=t.match(jn),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=lt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=L1[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var y5=(function(){var t=vf("t"),e=vf("rPr");function r(i){var o=i.match(t);if(!o)return{t:"s",v:""};var c={t:"s",v:Pt(o[1])},u=i.match(e);return u&&(c.s=_5(u[1])),c}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(c){return c.v})}})(),w5=(function(){var e=/(\r\n|\n)/g;function r(s,i,o){var c=[];s.u&&c.push("text-decoration: underline;"),s.uval&&c.push("text-underline-style:"+s.uval+";"),s.sz&&c.push("font-size:"+s.sz+"pt;"),s.outline&&c.push("text-effect: outline;"),s.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var u=s.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),E5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,T5=/<(?:\w+:)?r>/,S5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ax(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Pt(Qt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Qt(t),r&&(n.h=G1(n.t))):t.match(T5)&&(n.r=Qt(t),n.t=Pt(Qt((t.replace(S5,"").match(E5)||[]).join("").replace(jn,""))),r&&(n.h=w5(y5(n.r)))),n):{t:""}}var k5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,A5=/<(?:\w+:)?(?:si|sstItem)>/g,C5=/<\/(?:\w+:)?(?:si|sstItem)>/;function I5(t,e){var r=[],n="";if(!t)return r;var s=t.match(k5);if(s){n=s[2].replace(A5,"").split(C5);for(var i=0;i!=n.length;++i){var o=ax(n[i].trim(),e);o!=null&&(r[r.length]=o)}s=lt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var F5=/^\s|\s$|[\t\n\r]/;function Ck(t,e){if(!e.bookSST)return"";var r=[Rr];r[r.length]=Ve("sst",null,{xmlns:yl[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(F5)&&(i+=' xml:space="preserve"'),i+=">"+Yt(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function b5(t){return[t.read_shift(4),t.read_shift(4)]}function N5(t,e){var r=[],n=!1;return Aa(t,function(i,o,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function R5(t,e){return e||(e=me(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var D5=WD;function P5(t){var e=ls();Ie(e,159,R5(t));for(var r=0;r<t.length;++r)Ie(e,19,D5(t[r]));return Ie(e,160),e.end()}function Ik(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function va(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function O5(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=va(t,4),e.U=va(t,4),e.W=va(t,4),e}function L5(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function M5(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(L5(t));return e}function B5(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function V5(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=va(t,4),e.U=va(t,4),e.W=va(t,4),e}function j5(t){var e=V5(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Fk(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function bk(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function U5(t){var e=va(t);switch(e.Minor){case 2:return[e.Minor,z5(t)];case 3:return[e.Minor,W5()];case 4:return[e.Minor,H5(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function z5(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Fk(t,r),s=bk(t,t.length-t.l);return{t:"Std",h:n,v:s}}function W5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function H5(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(jn,function(i){var o=lt(i);switch(Hi(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){n[c]=o[c]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function $5(t,e){var r={},n=r.EncryptionVersionInfo=va(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=Fk(t,s),e-=s,r.EncryptionVerifier=bk(t,e),r}function G5(t){var e={},r=e.EncryptionVersionInfo=va(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function ox(t){var e=0,r,n=Ik(t),s=n.length+1,i,o,c,u,h;for(r=go(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)o=r[i],c=(e&16384)===0?0:1,u=e<<1&32767,h=c|u,e=h^o;return e^52811}var Nk=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,c){return n(o^c)},i=function(o){for(var c=e[o.length-1],u=104,h=o.length-1;h>=0;--h)for(var d=o[h],g=0;g!=7;++g)d&64&&(c^=r[u]),d*=2,--u;return c};return function(o){for(var c=Ik(o),u=i(c),h=c.length,d=go(16),g=0;g!=16;++g)d[g]=0;var x,y,k;for((h&1)===1&&(x=u>>8,d[h]=s(t[0],x),--h,x=u&255,y=c[c.length-1],d[h]=s(y,x));h>0;)--h,x=u>>8,d[h]=s(c[h],x),--h,x=u&255,d[h]=s(c[h],x);for(h=15,k=15-c.length;k>0;)x=u>>8,d[h]=s(t[k],x),--h,--k,x=u&255,d[h]=s(c[h],x),--h,--k;return d}})(),K5=function(t,e,r,n,s){s||(s=e),n||(n=Nk(t));var i,o;for(i=0;i!=e.length;++i)o=e[i],o^=n[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,n]},q5=function(t){var e=0,r=Nk(t);return function(n){var s=K5("",n,e,r);return e=s[1],s[0]}};function X5(t,e,r,n){var s={key:jr(t),verificationBytes:jr(t)};return r.password&&(s.verifier=ox(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=q5(r.password)),s}function Y5(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=G5(t):n.Data=$5(t,e),n}function Q5(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Y5(t,e-2,n):X5(t,r.biff>=8?e:e-2,r,n),n}var Rk=(function(){function t(s,i){switch(i.type){case"base64":return e(ks(s),i);case"binary":return e(s,i);case"buffer":return e(_t&&Buffer.isBuffer(s)?s.toString("binary"):To(s),i);case"array":return e(hl(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var o=i||{},c=o.dense?[]:{},u=s.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,g){Array.isArray(c)&&(c[g]=[]);for(var x=/\\\w+\b/g,y=0,k,w=-1;k=x.exec(d);){switch(k[0]){case"\\cell":var S=d.slice(y,x.lastIndex-k[0].length);if(S[0]==" "&&(S=S.slice(1)),++w,S.length){var N={v:S,t:"s"};Array.isArray(c)?c[g][w]=N:c[it({r:g,c:w})]=N}break}y=x.lastIndex}w>h.e.c&&(h.e.c=w)}),c["!ref"]=xt(h),c}function r(s,i){return So(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],o=Ot(s["!ref"]),c,u=Array.isArray(s),h=o.s.r;h<=o.e.r;++h){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var g=it({r:h,c:d});c=u?(s[h]||[])[d]:s[g],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(Ta(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function J5(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Ef(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Z5(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),o=s-i;if(o===0)return[0,0,e];var c=0,u=0,h=s+i;switch(u=o/(h>1?2-h:h),s){case e:c=((r-n)/o+6)%6;break;case r:c=(n-e)/o+2;break;case n:c=(e-r)/o+4;break}return[c/6,u,h/2]}function eO(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,o=[i,i,i],c=6*e,u;if(r!==0)switch(c|0){case 0:case 6:u=s*c,o[0]+=s,o[1]+=u;break;case 1:u=s*(2-c),o[0]+=u,o[1]+=s;break;case 2:u=s*(c-2),o[1]+=s,o[2]+=u;break;case 3:u=s*(4-c),o[1]+=u,o[2]+=s;break;case 4:u=s*(c-4),o[2]+=s,o[0]+=u;break;case 5:u=s*(6-c),o[2]+=u,o[0]+=s;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function od(t,e){if(e===0)return t;var r=Z5(J5(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Ef(eO(r))}var Dk=6,tO=15,rO=1,On=Dk;function Tf(t){return Math.floor((t+Math.round(128/On)/256)*On)}function Sf(t){return Math.floor((t-5)/On*100+.5)/100}function ld(t){return Math.round((t*On+5)/On*256)/256}function Mm(t){return ld(Sf(Tf(t)))}function lx(t){var e=Math.abs(t-Mm(t)),r=On;if(e>.005)for(On=rO;On<tO;++On)Math.abs(t-Mm(t))<=e&&(e=Math.abs(t-Mm(t)),r=On);On=r}function xo(t){t.width?(t.wpx=Tf(t.width),t.wch=Sf(t.wpx),t.MDW=On):t.wpx?(t.wch=Sf(t.wpx),t.width=ld(t.wch),t.MDW=On):typeof t.wch=="number"&&(t.width=ld(t.wch),t.wpx=Tf(t.width),t.MDW=On),t.customWidth&&delete t.customWidth}var nO=96,Pk=nO;function kf(t){return t*96/Pk}function Pc(t){return t*Pk/96}var sO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function iO(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(jn)||[]).forEach(function(o){var c=lt(o);switch(Hi(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},c.diagonalUp&&(s.diagonalUp=ir(c.diagonalUp)),c.diagonalDown&&(s.diagonalDown=ir(c.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function aO(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(jn)||[]).forEach(function(o){var c=lt(o);switch(Hi(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":c.patternType&&(s.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),c.indexed&&(s.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(s.bgColor.theme=parseInt(c.theme,10)),c.tint&&(s.bgColor.tint=parseFloat(c.tint)),c.rgb&&(s.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),c.theme&&(s.fgColor.theme=parseInt(c.theme,10)),c.tint&&(s.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(s.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function oO(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(jn)||[]).forEach(function(o){var c=lt(o);switch(Hi(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":c.val&&(s.name=Qt(c.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=c.val?ir(c.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=c.val?ir(c.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(c.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=c.val?ir(c.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=c.val?ir(c.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=c.val?ir(c.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=c.val?ir(c.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=c.val?ir(c.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":c.val&&(s.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(s.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(s.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(s.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=L1[parseInt(c.val,10)];break;case"<color":if(s.color||(s.color={}),c.auto&&(s.color.auto=ir(c.auto)),c.rgb)s.color.rgb=c.rgb.slice(-6);else if(c.indexed){s.color.index=parseInt(c.indexed,10);var u=tl[s.color.index];s.color.index==81&&(u=tl[1]),u||(u=tl[1]),s.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(s.color.theme=parseInt(c.theme,10),c.tint&&(s.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=od(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function lO(t,e,r){e.NumberFmt=[];for(var n=kr(nt),s=0;s<n.length;++s)e.NumberFmt[n[s]]=nt[n[s]];var i=t[0].match(jn);if(i)for(s=0;s<i.length;++s){var o=lt(i[s]);switch(Hi(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Pt(Qt(o.formatCode)),u=parseInt(o.numFmtId,10);if(e.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&e.NumberFmt[u]!=null;--u);e.NumberFmt[u]=c}xa(c,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function cO(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ve("numFmt",null,{numFmtId:n,formatCode:Yt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ve("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var m0=["numFmtId","fillId","fontId","borderId","xfId"],g0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function uO(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(jn)||[]).forEach(function(i){var o=lt(i),c=0;switch(Hi(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],c=0;c<m0.length;++c)n[m0[c]]&&(n[m0[c]]=parseInt(n[m0[c]],10));for(c=0;c<g0.length;++c)n[g0[c]]&&(n[g0[c]]=ir(n[g0[c]]));if(e.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[c]){n.numFmtId=c;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=ir(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function fO(t){var e=[];return e[e.length]=Ve("cellXfs",null),t.forEach(function(r){e[e.length]=Ve("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ve("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var hO=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,h){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=c.match(e))&&lO(g,d,h),(g=c.match(s))&&oO(g,d,u,h),(g=c.match(n))&&aO(g,d,u,h),(g=c.match(i))&&iO(g,d,u,h),(g=c.match(r))&&uO(g,d,h),d}})();function Ok(t,e){var r=[Rr,Ve("styleSheet",null,{xmlns:yl[0],"xmlns:vt":Xr.vt})],n;return t.SSF&&(n=cO(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=fO(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function dO(t,e){var r=t.read_shift(2),n=Mn(t);return[r,n]}function pO(t,e,r){r||(r=me(6+4*e.length)),r.write_shift(2,t),on(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function mO(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=YD(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var c=t.read_shift(1);c>0&&(n.family=c);var u=t.read_shift(1);switch(u>0&&(n.charset=u),t.l++,n.color=XD(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Mn(t),n}function gO(t,e){e||(e=me(153)),e.write_shift(2,t.sz*20),QD(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),sd(t.color,e);var n=0;return n=2,e.write_shift(1,n),on(t.name,e),e.length>e.l?e.slice(0,e.l):e}var xO=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Bm,vO=Vn;function hw(t,e){e||(e=me(84)),Bm||(Bm=Pd(xO));var r=Bm[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(sd({auto:1},e),sd({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function _O(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function Lk(t,e,r){r||(r=me(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Nu(t,e){return e||(e=me(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var yO=Vn;function wO(t,e){return e||(e=me(51)),e.write_shift(1,0),Nu(null,e),Nu(null,e),Nu(null,e),Nu(null,e),Nu(null,e),e.length>e.l?e.slice(0,e.l):e}function EO(t,e){return e||(e=me(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),nd(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function TO(t,e,r){var n=me(2052);return n.write_shift(4,t),nd(e,n),nd(r,n),n.length>n.l?n.slice(0,n.l):n}function SO(t,e,r){var n={};n.NumberFmt=[];for(var s in nt)n.NumberFmt[s]=nt[s];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Aa(t,function(u,h,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],xa(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(u.color.rgb=od(e.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d),o=!0;break;case 38:i.pop(),o=!1;break;default:if(h.T>0)i.push(d);else if(h.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function kO(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(Ie(t,615,ci(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Ie(t,44,pO(s,e[s]))}),Ie(t,616))}}function AO(t){var e=1;Ie(t,611,ci(e)),Ie(t,43,gO({sz:12,color:{theme:1},name:"Calibri",family:2})),Ie(t,612)}function CO(t){var e=2;Ie(t,603,ci(e)),Ie(t,45,hw({patternType:"none"})),Ie(t,45,hw({patternType:"gray125"})),Ie(t,604)}function IO(t){var e=1;Ie(t,613,ci(e)),Ie(t,46,wO()),Ie(t,614)}function FO(t){var e=1;Ie(t,626,ci(e)),Ie(t,47,Lk({numFmtId:0},65535)),Ie(t,627)}function bO(t,e){Ie(t,617,ci(e.length)),e.forEach(function(r){Ie(t,47,Lk(r,0))}),Ie(t,618)}function NO(t){var e=1;Ie(t,619,ci(e)),Ie(t,48,EO({xfId:0,name:"Normal"})),Ie(t,620)}function RO(t){var e=0;Ie(t,505,ci(e)),Ie(t,506)}function DO(t){var e=0;Ie(t,508,TO(e,"TableStyleMedium9","PivotStyleMedium4")),Ie(t,509)}function PO(t,e){var r=ls();return Ie(r,278),kO(r,t.SSF),AO(r),CO(r),IO(r),FO(r),bO(r,e.cellXfs),NO(r),RO(r),DO(r),Ie(r,279),r.end()}var OO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function LO(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(jn)||[]).forEach(function(s){var i=lt(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[OO.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function MO(){}function BO(){}var VO=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,jO=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,UO=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function zO(t,e,r){e.themeElements={};var n;[["clrScheme",VO,LO],["fontScheme",jO,MO],["fmtScheme",UO,BO]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var WO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Mk(t,e){(!t||t.length===0)&&(t=cx());var r,n={};if(!(r=t.match(WO)))throw new Error("themeElements not found in theme");return zO(r[0],n,e),n.raw=t,n}function cx(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Rr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function HO(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var o;try{o=FS(i,{type:"array"})}catch{return}var c=Es(o,"theme/theme/theme1.xml",!0);if(c)return Mk(c,r)}}function $O(t){return t.read_shift(4)}function GO(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=KO(t,4);break;case 2:e.xclrValue=gk(t);break;case 3:e.xclrValue=$O(t);break;case 4:t.l+=4;break}return t.l+=8,e}function KO(t,e){return Vn(t,e)}function qO(t,e){return Vn(t,e)}function XO(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=GO(t);break;case 6:n[1]=qO(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function YO(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(XO(t,r-t.l));return{ixfe:n,ext:i}}function QO(t,e){e.forEach(function(r){r[0]})}function JO(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Mn(t)}}function ZO(t){var e=me(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),on(t.name,e),e.slice(0,e.l)}function eL(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function tL(t){var e=me(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function rL(t,e){var r=me(8+2*e.length);return r.write_shift(4,t),on(e,r),r.slice(0,r.l)}function nL(t){return t.l+=4,t.read_shift(4)!=0}function sL(t,e){var r=me(8);return r.write_shift(4,t),r.write_shift(4,1),r}function iL(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,c=2;return Aa(t,function(u,h,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(g){c==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):c==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:i.push(d),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!h.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function aL(){var t=ls();return Ie(t,332),Ie(t,334,ci(1)),Ie(t,335,ZO({name:"XLDAPR",version:12e4,flags:3496657072})),Ie(t,336),Ie(t,339,rL(1,"XLDAPR")),Ie(t,52),Ie(t,35,ci(514)),Ie(t,4096,ci(0)),Ie(t,4097,zs(1)),Ie(t,36),Ie(t,53),Ie(t,340),Ie(t,337,sL(1)),Ie(t,51,tL([[1,0]])),Ie(t,338),Ie(t,333),t.end()}function oL(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,o;return t.replace(jn,function(c){var u=lt(c);switch(Hi(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==u.name&&(o=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):i==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),n}function Bk(){var t=[Rr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function lL(t){var e=[];if(!t)return e;var r=1;return(t.match(jn)||[]).forEach(function(n){var s=lt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function cL(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=it(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function uL(t,e,r){var n=[];return Aa(t,function(i,o,c){switch(c){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function fL(t,e,r,n){if(!t)return t;var s=n||{},i=!1;Aa(t,function(c,u,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},s)}function hL(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var dc=1024;function Vk(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Ve("xml",null,{"xmlns:v":_s.v,"xmlns:o":_s.o,"xmlns:x":_s.x,"xmlns:mv":_s.mv}).replace(/\/>/,">"),Ve("o:shapelayout",Ve("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ve("v:shapetype",[Ve("v:stroke",null,{joinstyle:"miter"}),Ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];dc<t*1e3;)dc+=1e3;return e.forEach(function(i){var o=vr(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var u=c.type=="gradient"?Ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ve("v:fill",u,c),d={on:"t",obscured:"t"};++dc,s=s.concat(["<v:shape"+_f({id:"_x0000_s"+dc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ve("v:shadow",null,d),Ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",vn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),vn("x:AutoFill","False"),vn("x:Row",String(o.r)),vn("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function dw(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(o){var c=vr(o.ref);if(s?(t[c.r]||(t[c.r]=[]),i=t[c.r][c.c]):i=t[o.ref],!i){i={t:"z"},s?t[c.r][c.c]=i:t[o.ref]=i;var u=Ot(t["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var h=xt(u);h!==t["!ref"]&&(t["!ref"]=h)}i.c||(i.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var g=i.c.length-1;g>=0;--g){if(!r&&i.c[g].T)return;r&&!i.c[g].T&&i.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(d.a==n[g].id){d.a=n[g].name||d.a;break}}i.c.push(d)})}function dL(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=lt(c[0]),h={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=vr(u.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!g&&!!g[1]&&ax(g[1])||{r:"",t:"",h:""};h.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),h.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=x.h),n.push(h)}}}}),n}function jk(t){var e=[Rr,Ve("comments",null,{xmlns:yl[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var i=Yt(s.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(u){u.a&&(s=r.indexOf(Yt(u.a))),i.push(u.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)e.push(vn("t",Yt(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)o+=`Reply:
    `+i[c]+`
`;e.push(vn("t",Yt(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function pL(t,e){var r=[],n=!1,s={},i=0;return t.replace(jn,function(c,u){var h=lt(c);switch(Hi(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=u+c.length;break;case"</text>":s.t=t.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),r}function mL(t,e,r){var n=[Rr,Ve("ThreadedComments",null,{xmlns:Xr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var u={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=u.id:u.parentId=i,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Ve("threadedComment",vn("text",o.t||""),u))})}),n.push("</ThreadedComments>"),n.join("")}function gL(t,e){var r=[],n=!1;return t.replace(jn,function(i){var o=lt(i);switch(Hi(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function xL(t){var e=[Rr,Ve("personList",null,{xmlns:Xr.TCMNT,"xmlns:x":yl[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ve("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function vL(t){var e={};e.iauthor=t.read_shift(4);var r=Sl(t);return e.rfx=r.s,e.ref=it(r.s),t.l+=16,e}function _L(t,e){return e==null&&(e=me(36)),e.write_shift(4,t[1].iauthor),Kc(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var yL=Mn;function wL(t){return on(t.slice(0,54))}function EL(t,e){var r=[],n=[],s={},i=!1;return Aa(t,function(c,u,h){switch(h){case 632:n.push(c);break;case 635:s=c;break;case 637:s.t=c.t,s.h=c.h,s.r=c.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function TL(t){var e=ls(),r=[];return Ie(e,628),Ie(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Ie(e,632,wL(s.a)))})}),Ie(e,631),Ie(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:vr(n[0]),e:vr(n[0])};Ie(e,635,_L([i,s])),s.t&&s.t.length>0&&Ie(e,637,$D(s)),Ie(e,636),delete s.iauthor})}),Ie(e,634),Ie(e,629),e.end()}var SL="application/vnd.ms-office.vbaProject";function kL(t){var e=Ze.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ze.utils.cfb_add(e,s,t.FileIndex[n].content)}}),Ze.write(e)}function AL(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ze.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var Uk=["xlsb","xlsm","xlam","biff8","xla"];function CL(){return{"!type":"dialog"}}function IL(){return{"!type":"dialog"}}function FL(){return{"!type":"macro"}}function bL(){return{"!type":"macro"}}var wc=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,o){var c=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var h=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return c?d+=e.c:--d,u?h+=e.r:--h,s+(c?"":"$")+xr(d)+(u?"":"$")+Nr(h)}return function(s,i){return e=i,s.replace(t,r)}})(),ux=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,fx=(function(){return function(e,r){return e.replace(ux,function(n,s,i,o,c,u){var h=Q1(o)-(i?0:r.c),d=Y1(u)-(c?0:r.r),g=d==0?"":c?d+1:"["+d+"]",x=h==0?"":i?h+1:"["+h+"]";return s+"R"+g+"C"+x})}})();function zk(t,e){return t.replace(ux,function(r,n,s,i,o,c){return n+(s=="$"?s+i:xr(Q1(i)+e.c))+(o=="$"?o+c:Nr(Y1(c)+e.r))})}function NL(t,e,r){var n=cs(e),s=n.s,i=vr(r),o={r:i.r-s.r,c:i.c-s.c};return zk(t,o)}function RL(t){return t.length!=1}function pw(t){return t.replace(/_xlfn\./g,"")}function Mr(t){t.l+=1}function vo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Wk(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Hk(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),o=vo(t),c=vo(t);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function Hk(t){var e=vo(t),r=vo(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function DL(t,e,r){if(r.biff<8)return Hk(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=vo(t),o=vo(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function $k(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return PL(t);var n=t.read_shift(r&&r.biff==12?4:2),s=vo(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function PL(t){var e=vo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function OL(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function LL(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return ML(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:c}}function ML(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function BL(t,e,r){var n=(t[t.l++]&96)>>5,s=Wk(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function VL(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=Wk(t,i,r);return[n,s,o]}function jL(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function UL(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function zL(t,e,r){var n=(t[t.l++]&96)>>5,s=DL(t,e-1,r);return[n,s]}function WL(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function mw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function HL(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function $L(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function GL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function KL(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function qL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Gk(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function XL(t){return t.read_shift(2),Gk(t)}function YL(t){return t.read_shift(2),Gk(t)}function QL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=$k(t,0,r);return[n,s]}function JL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=LL(t,0,r);return[n,s]}function ZL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=$k(t,0,r);return[n,s,i]}function eM(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[n9[s],Xk[s],n]}function tM(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:rM(t);return[s,(i[0]===0?Xk:r9)[i[1]]]}function rM(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function nM(t,e,r){t.l+=r&&r.biff==2?3:4}function sM(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function iM(t){return t.l++,Ca[t.read_shift(1)]}function aM(t){return t.l++,t.read_shift(2)}function oM(t){return t.l++,t.read_shift(1)!==0}function lM(t){return t.l++,Ln(t)}function cM(t,e,r){return t.l++,Kf(t,e-1,r)}function uM(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Fr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ca[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ln(t);break;case 2:r[1]=kl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function fM(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Sl:Md)(t));return s}function hM(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var c=0;c!=s;++c)o[i][c]=uM(t,r.biff);return o}function dM(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function pM(t,e,r){if(r.biff==5)return mM(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function mM(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function gM(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function xM(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function vM(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function _M(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var yM=Vn,wM=Vn,EM=Vn;function Xf(t,e,r){return t.l+=2,[OL(t)]}function hx(t){return t.l+=6,[]}var TM=Xf,SM=hx,kM=hx,AM=Xf;function Kk(t){return t.l+=2,[jr(t),t.read_shift(2)&1]}var CM=Xf,IM=Kk,FM=hx,bM=Xf,NM=Xf,RM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function DM(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),o=RM[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:s,C:i}}function PM(t){return t.l+=2,[t.read_shift(4)]}function OM(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function LM(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function MM(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function BM(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function VM(t){return t.l+=4,[0,0]}var gw={1:{n:"PtgExp",f:sM},2:{n:"PtgTbl",f:EM},3:{n:"PtgAdd",f:Mr},4:{n:"PtgSub",f:Mr},5:{n:"PtgMul",f:Mr},6:{n:"PtgDiv",f:Mr},7:{n:"PtgPower",f:Mr},8:{n:"PtgConcat",f:Mr},9:{n:"PtgLt",f:Mr},10:{n:"PtgLe",f:Mr},11:{n:"PtgEq",f:Mr},12:{n:"PtgGe",f:Mr},13:{n:"PtgGt",f:Mr},14:{n:"PtgNe",f:Mr},15:{n:"PtgIsect",f:Mr},16:{n:"PtgUnion",f:Mr},17:{n:"PtgRange",f:Mr},18:{n:"PtgUplus",f:Mr},19:{n:"PtgUminus",f:Mr},20:{n:"PtgPercent",f:Mr},21:{n:"PtgParen",f:Mr},22:{n:"PtgMissArg",f:Mr},23:{n:"PtgStr",f:cM},26:{n:"PtgSheet",f:OM},27:{n:"PtgEndSheet",f:LM},28:{n:"PtgErr",f:iM},29:{n:"PtgBool",f:oM},30:{n:"PtgInt",f:aM},31:{n:"PtgNum",f:lM},32:{n:"PtgArray",f:WL},33:{n:"PtgFunc",f:eM},34:{n:"PtgFuncVar",f:tM},35:{n:"PtgName",f:dM},36:{n:"PtgRef",f:QL},37:{n:"PtgArea",f:BL},38:{n:"PtgMemArea",f:gM},39:{n:"PtgMemErr",f:yM},40:{n:"PtgMemNoMem",f:wM},41:{n:"PtgMemFunc",f:xM},42:{n:"PtgRefErr",f:vM},43:{n:"PtgAreaErr",f:jL},44:{n:"PtgRefN",f:JL},45:{n:"PtgAreaN",f:zL},46:{n:"PtgMemAreaN",f:MM},47:{n:"PtgMemNoMemN",f:BM},57:{n:"PtgNameX",f:pM},58:{n:"PtgRef3d",f:ZL},59:{n:"PtgArea3d",f:VL},60:{n:"PtgRefErr3d",f:_M},61:{n:"PtgAreaErr3d",f:UL},255:{}},jM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},UM={1:{n:"PtgElfLel",f:Kk},2:{n:"PtgElfRw",f:bM},3:{n:"PtgElfCol",f:TM},6:{n:"PtgElfRwV",f:NM},7:{n:"PtgElfColV",f:AM},10:{n:"PtgElfRadical",f:CM},11:{n:"PtgElfRadicalS",f:FM},13:{n:"PtgElfColS",f:SM},15:{n:"PtgElfColSV",f:kM},16:{n:"PtgElfRadicalLel",f:IM},25:{n:"PtgList",f:DM},29:{n:"PtgSxName",f:PM},255:{}},zM={0:{n:"PtgAttrNoop",f:VM},1:{n:"PtgAttrSemi",f:qL},2:{n:"PtgAttrIf",f:GL},4:{n:"PtgAttrChoose",f:HL},8:{n:"PtgAttrGoto",f:$L},16:{n:"PtgAttrSum",f:nM},32:{n:"PtgAttrBaxcel",f:mw},33:{n:"PtgAttrBaxcel",f:mw},64:{n:"PtgAttrSpace",f:XL},65:{n:"PtgAttrSpaceSemi",f:YL},128:{n:"PtgAttrIfError",f:KL},255:{}};function Yf(t,e,r,n){if(n.biff<8)return Vn(t,e);for(var s=t.l+e,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=hM(t,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=fM(t,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=s-t.l,e!==0&&i.push(Vn(t,e)),i}function Qf(t,e,r){for(var n=t.l+e,s,i,o=[];n!=t.l;)e=n-t.l,i=t[t.l],s=gw[i]||gw[jM[i]],(i===24||i===25)&&(s=(i===24?UM:zM)[t[t.l+1]]),!s||!s.f?Vn(t,e):o.push([s.n,s.f(t,e,r)]);return o}function WM(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var HM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $M(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function qk(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function xw(t,e,r){var n=qk(t,e,r);return n=="#REF"?n:$M(n,r)}function Dn(t,e,r,n,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},c=[],u,h,d,g=0,x=0,y,k="";if(!t[0]||!t[0][0])return"";for(var w=-1,S="",N=0,B=t[0].length;N<B;++N){var b=t[0][N];switch(b[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),h=c.pop(),w>=0){switch(t[0][w][1][0]){case 0:S=wr(" ",t[0][w][1][1]);break;case 1:S=wr("\r",t[0][w][1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}h=h+S,w=-1}c.push(h+HM[b[0]]+u);break;case"PtgIsect":u=c.pop(),h=c.pop(),c.push(h+" "+u);break;case"PtgUnion":u=c.pop(),h=c.pop(),c.push(h+","+u);break;case"PtgRange":u=c.pop(),h=c.pop(),c.push(h+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=qu(b[1][1],o,s),c.push(Xu(d,i));break;case"PtgRefN":d=r?qu(b[1][1],r,s):b[1][1],c.push(Xu(d,i));break;case"PtgRef3d":g=b[1][1],d=qu(b[1][2],o,s),k=xw(n,g,s),c.push(k+"!"+Xu(d,i));break;case"PtgFunc":case"PtgFuncVar":var j=b[1][0],X=b[1][1];j||(j=0),j&=127;var G=j==0?[]:c.slice(-j);c.length-=j,X==="User"&&(X=G.shift()),c.push(X+"("+G.join(",")+")");break;case"PtgBool":c.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(b[1]);break;case"PtgNum":c.push(String(b[1]));break;case"PtgStr":c.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(b[1]);break;case"PtgAreaN":y=Gy(b[1][1],r?{s:r}:o,s),c.push(Pm(y,s));break;case"PtgArea":y=Gy(b[1][1],o,s),c.push(Pm(y,s));break;case"PtgArea3d":g=b[1][1],y=b[1][2],k=xw(n,g,s),c.push(k+"!"+Pm(y,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=b[1][2];var A=(n.names||[])[x-1]||(n[0]||[])[x],C=A?A.Name:"SH33TJSNAME"+String(x);C&&C.slice(0,6)=="_xlfn."&&!s.xlfn&&(C=C.slice(6)),c.push(C);break;case"PtgNameX":var F=b[1][1];x=b[1][2];var V;if(s.biff<=5)F<0&&(F=-F),n[F]&&(V=n[F][x]);else{var M="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][x]&&n[F][x].itab>0&&(M=n.SheetNames[n[F][x].itab-1]+"!"):M=n.SheetNames[x-1]+"!"),n[F]&&n[F][x])M+=n[F][x].Name;else if(n[0]&&n[0][x])M+=n[0][x].Name;else{var D=(qk(n,F,s)||"").split(";;");D[x-1]?M=D[x-1]:M+="SH33TJSERRX"}c.push(M);break}V||(V={Name:"SH33TJSERRY"}),c.push(V.Name);break;case"PtgParen":var L="(",ke=")";if(w>=0){switch(S="",t[0][w][1][0]){case 2:L=wr(" ",t[0][w][1][1])+L;break;case 3:L=wr("\r",t[0][w][1][1])+L;break;case 4:ke=wr(" ",t[0][w][1][1])+ke;break;case 5:ke=wr("\r",t[0][w][1][1])+ke;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}w=-1}c.push(L+c.pop()+ke);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var Se={c:r.c,r:r.r};if(n.sharedf[it(d)]){var De=n.sharedf[it(d)];c.push(Dn(De,o,Se,n,s))}else{var Ne=!1;for(u=0;u!=n.arrayf.length;++u)if(h=n.arrayf[u],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){c.push(Dn(h[1],o,Se,n,s)),Ne=!0;break}Ne||c.push(b[1])}break;case"PtgArray":c.push("{"+WM(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var Ce=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&w>=0&&Ce.indexOf(t[0][N][0])==-1){b=t[0][w];var ne=!0;switch(b[1][0]){case 4:ne=!1;case 0:S=wr(" ",b[1][1]);break;case 5:ne=!1;case 1:S=wr("\r",b[1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}c.push((ne?S:"")+c.pop()+(ne?"":S)),w=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function GM(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,o=t.read_shift(s);if(o==65535)return[[],Vn(t,e-2)];var c=Qf(t,o,r);return e!==o+s&&(i=Yf(t,e-o-s,c,r)),t.l=n,[c,i]}function KM(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,o=t.read_shift(s);if(o==65535)return[[],Vn(t,e-2)];var c=Qf(t,o,r);return e!==o+s&&(i=Yf(t,e-o-s,c,r)),t.l=n,[c,i]}function qM(t,e,r,n){var s=t.l+e,i=Qf(t,n,r),o;return s!==t.l&&(o=Yf(t,s-t.l,i,r)),[i,o]}function XM(t,e,r){var n=t.l+e,s,i=t.read_shift(2),o=Qf(t,i,r);return i==65535?[[],Vn(t,e-2)]:(e!==i+2&&(s=Yf(t,n-i-2,o,r)),[o,s])}function YM(t){var e;if(pa(t,t.l+6)!==65535)return[Ln(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function QM(t){if(t==null){var e=me(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return dl(t);return dl(0)}function Vm(t,e,r){var n=t.l+e,s=$i(t);r.biff==2&&++t.l;var i=YM(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var c=KM(t,n-t.l,r);return{cell:s,val:i[0],formula:c,shared:o>>3&1,tt:i[1]}}function JM(t,e,r,n,s){var i=ml(e,r,s),o=QM(t.v),c=me(6),u=33;c.write_shift(2,u),c.write_shift(4,0);for(var h=me(t.bf.length),d=0;d<t.bf.length;++d)h[d]=t.bf[d];var g=an([i,o,c,h]);return g}function Bd(t,e,r){var n=t.read_shift(4),s=Qf(t,n,r),i=t.read_shift(4),o=i>0?Yf(t,i,s,r):null;return[s,o]}var ZM=Bd,Vd=Bd,e9=Bd,t9=Bd,r9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Xk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},n9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function vw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function s9(t){var e="of:="+t.replace(ux,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function jm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function i9(t){return t.replace(/\./,"!")}var Qu={},Ec={},Ju=typeof Map<"u";function dx(t,e,r){var n=0,s=t.length;if(r){if(Ju?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=Ju?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(Ju?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function jd(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(On=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Sf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=ld(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function sl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ko(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,i=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){xa(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=i;++s)if(t[s].numFmtId===n)return s;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Yk(t,e,r,n,s,i){try{n.cellNF&&(t.z=nt[e])}catch(c){if(n.WTF)throw c}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=or(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(nt[e]==null&&xa(rD[e]||"General",e),t.t==="e")t.w=t.w||Ca[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=xf(t.v);else if(t.t==="d"){var o=Qr(t.v);(o|0)===o?t.w=o.toString(10):t.w=xf(o)}else{if(t.v===void 0)return"";t.w=fl(t.v,Ec)}else t.t==="d"?t.w=$s(e,Qr(t.v),Ec):t.w=$s(e,t.v,Ec)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=od(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=od(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function a9(t,e,r){if(t&&t["!ref"]){var n=Ot(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function o9(t,e){var r=Ot(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=xt(r))}var l9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,c9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,u9=/<(?:\w:)?hyperlink [^>]*>/mg,f9=/"(\w*:\w*)"/,h9=/<(?:\w:)?col\b[^>]*[\/]?>/g,d9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,p9=/<(?:\w:)?pageMargins[^>]*\/>/g,Qk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,m9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,g9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function x9(t,e,r,n,s,i,o){if(!t)return t;n||(n={"!id":{}});var c=e.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",d="",g=t.match(c9);g?(h=t.slice(0,g.index),d=t.slice(g.index+g[0].length)):h=d=t;var x=h.match(Qk);x?px(x[0],c,s,r):(x=h.match(m9))&&_9(x[0],x[1]||"",c,s,r);var y=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var k=h.slice(y,y+50).match(f9);k&&o9(c,k[1])}var w=h.match(g9);w&&w[1]&&R9(w[1],s);var S=[];if(e.cellStyles){var N=h.match(h9);N&&C9(S,N)}g&&O9(g[1],c,e,u,i,o);var B=d.match(d9);B&&(c["!autofilter"]=F9(B[0]));var b=[],j=d.match(l9);if(j)for(y=0;y!=j.length;++y)b[y]=Ot(j[y].slice(j[y].indexOf('"')+1));var X=d.match(u9);X&&S9(c,X,n);var G=d.match(p9);if(G&&(c["!margins"]=k9(lt(G[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=xt(u)),e.sheetRows>0&&c["!ref"]){var A=Ot(c["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>u.e.r&&(A.e.r=u.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>u.e.c&&(A.e.c=u.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),c["!fullref"]=c["!ref"],c["!ref"]=xt(A))}return S.length>0&&(c["!cols"]=S),b.length>0&&(c["!merges"]=b),c}function v9(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+xt(t[r])+'"/>';return e+"</mergeCells>"}function px(t,e,r,n){var s=lt(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Pt(Qt(s.codeName)))}function _9(t,e,r,n,s){px(t.slice(0,t.indexOf(">")),r,n,s)}function y9(t,e,r,n,s){var i=!1,o={},c=null;if(n.bookType!=="xlsx"&&e.vbaraw){var u=e.SheetNames[r];try{e.Workbook&&(u=e.Workbook.Sheets[r].CodeName||u)}catch{}i=!0,o.codeName=Oi(Yt(u))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),c=(c||"")+Ve("outlinePr",null,h)}!i&&!c||(s[s.length]=Ve("sheetPr",c,o))}var w9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],E9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function T9(t){var e={sheet:1};return w9.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),E9.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=ox(t.password).toString(16).toUpperCase()),Ve("sheetProtection",null,e)}function S9(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=lt(Qt(e[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Pt(i.location))):(i.Target="#"+Pt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=Ot(i.ref),u=c.s.r;u<=c.e.r;++u)for(var h=c.s.c;h<=c.e.c;++h){var d=it({c:h,r:u});n?(t[u]||(t[u]=[]),t[u][h]||(t[u][h]={t:"z",v:void 0}),t[u][h].l=i):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=i)}}}function k9(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function A9(t){return sl(t),Ve("pageMargins",null,t)}function C9(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=lt(e[n],!0);s.hidden&&(s.hidden=ir(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,lx(s.width)),xo(s);i<=o;)t[i++]=lr(s)}}function I9(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=Ve("col",null,jd(s,n)));return r[r.length]="</cols>",r.join("")}function F9(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function b9(t,e,r,n){var s=typeof t.ref=="string"?t.ref:xt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=cs(s);o.s.r==o.e.r&&(o.e.r=cs(e["!ref"]).e.r,s=xt(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Ve("autoFilter",null,{ref:s})}var N9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function R9(t,e){e.Views||(e.Views=[{}]),(t.match(N9)||[]).forEach(function(r,n){var s=lt(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),ir(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function D9(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ve("sheetViews",Ve("sheetView",null,s),{})}function P9(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=Ca[t.v];break;case"d":n&&n.cellDates?s=or(t.v,-1).toISOString():(t=lr(t),t.t="n",s=""+(t.v=Qr(or(t.v)))),typeof t.z>"u"&&(t.z=nt[14]);break;default:s=t.v;break}var c=vn("v",Yt(s)),u={r:e},h=ko(n.cellXfs,t,n);switch(h!==0&&(u.s=h),t.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=vn("v",""+dx(n.Strings,t.v,n.revStrings)),u.t="s";break}u.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;c=Ve("f",Yt(t.f),d)+(t.v!=null?c:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(u.cm=1),Ve("c",c,u)}var O9=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=vf("v"),o=vf("f");return function(u,h,d,g,x,y){for(var k=0,w="",S=[],N=[],B=0,b=0,j=0,X="",G,A,C=0,F=0,V,M,D=0,L=0,ke=Array.isArray(y.CellXf),Se,De=[],Ne=[],Ce=Array.isArray(h),ne=[],ye={},ee=!1,O=!!d.sheetStubs,te=u.split(e),J=0,Z=te.length;J!=Z;++J){w=te[J].trim();var oe=w.length;if(oe!==0){var _e=0;e:for(k=0;k<oe;++k)switch(w[k]){case">":if(w[k-1]!="/"){++k;break e}if(d&&d.cellStyles){if(A=lt(w.slice(_e,k),!0),C=A.r!=null?parseInt(A.r,10):C+1,F=-1,d.sheetRows&&d.sheetRows<C)continue;ye={},ee=!1,A.ht&&(ee=!0,ye.hpt=parseFloat(A.ht),ye.hpx=Pc(ye.hpt)),A.hidden=="1"&&(ee=!0,ye.hidden=!0),A.outlineLevel!=null&&(ee=!0,ye.level=+A.outlineLevel),ee&&(ne[C-1]=ye)}break;case"<":_e=k;break}if(_e>=k)break;if(A=lt(w.slice(_e,k),!0),C=A.r!=null?parseInt(A.r,10):C+1,F=-1,!(d.sheetRows&&d.sheetRows<C)){g.s.r>C-1&&(g.s.r=C-1),g.e.r<C-1&&(g.e.r=C-1),d&&d.cellStyles&&(ye={},ee=!1,A.ht&&(ee=!0,ye.hpt=parseFloat(A.ht),ye.hpx=Pc(ye.hpt)),A.hidden=="1"&&(ee=!0,ye.hidden=!0),A.outlineLevel!=null&&(ee=!0,ye.level=+A.outlineLevel),ee&&(ne[C-1]=ye)),S=w.slice(k).split(t);for(var ve=0;ve!=S.length&&S[ve].trim().charAt(0)=="<";++ve);for(S=S.slice(ve),k=0;k!=S.length;++k)if(w=S[k].trim(),w.length!==0){if(N=w.match(r),B=k,b=0,j=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,N!=null&&N.length===2){for(B=0,X=N[1],b=0;b!=X.length&&!((j=X.charCodeAt(b)-64)<1||j>26);++b)B=26*B+j;--B,F=B}else++F;for(b=0;b!=w.length&&w.charCodeAt(b)!==62;++b);if(++b,A=lt(w.slice(0,b),!0),A.r||(A.r=it({r:C-1,c:F})),X=w.slice(b),G={t:""},(N=X.match(i))!=null&&N[1]!==""&&(G.v=Pt(N[1])),d.cellFormula){if((N=X.match(o))!=null&&N[1]!==""){if(G.f=Pt(Qt(N[1])).replace(/\r\n/g,`
`),d.xlfn||(G.f=pw(G.f)),N[0].indexOf('t="array"')>-1)G.F=(X.match(s)||[])[1],G.F.indexOf(":")>-1&&De.push([Ot(G.F),G.F]);else if(N[0].indexOf('t="shared"')>-1){M=lt(N[0]);var xe=Pt(Qt(N[1]));d.xlfn||(xe=pw(xe)),Ne[parseInt(M.si,10)]=[M,xe,A.r]}}else(N=X.match(/<f[^>]*\/>/))&&(M=lt(N[0]),Ne[M.si]&&(G.f=NL(Ne[M.si][1],Ne[M.si][2],A.r)));var Ee=vr(A.r);for(b=0;b<De.length;++b)Ee.r>=De[b][0].s.r&&Ee.r<=De[b][0].e.r&&Ee.c>=De[b][0].s.c&&Ee.c<=De[b][0].e.c&&(G.F=De[b][1])}if(A.t==null&&G.v===void 0)if(G.f||G.F)G.v=0,G.t="n";else if(O)G.t="z";else continue;else G.t=A.t||"n";switch(g.s.c>F&&(g.s.c=F),g.e.c<F&&(g.e.c=F),G.t){case"n":if(G.v==""||G.v==null){if(!O)continue;G.t="z"}else G.v=parseFloat(G.v);break;case"s":if(typeof G.v>"u"){if(!O)continue;G.t="z"}else V=Qu[parseInt(G.v,10)],G.v=V.t,G.r=V.r,d.cellHTML&&(G.h=V.h);break;case"str":G.t="s",G.v=G.v!=null?Qt(G.v):"",d.cellHTML&&(G.h=G1(G.v));break;case"inlineStr":N=X.match(n),G.t="s",N!=null&&(V=ax(N[1]))?(G.v=V.t,d.cellHTML&&(G.h=V.h)):G.v="";break;case"b":G.v=ir(G.v);break;case"d":d.cellDates?G.v=or(G.v,1):(G.v=Qr(or(G.v,1)),G.t="n");break;case"e":(!d||d.cellText!==!1)&&(G.w=G.v),G.v=ZS[G.v];break}if(D=L=0,Se=null,ke&&A.s!==void 0&&(Se=y.CellXf[A.s],Se!=null&&(Se.numFmtId!=null&&(D=Se.numFmtId),d.cellStyles&&Se.fillId!=null&&(L=Se.fillId))),Yk(G,D,L,d,x,y),d.cellDates&&ke&&G.t=="n"&&Hc(nt[D])&&(G.t="d",G.v=Ld(G.v)),A.cm&&d.xlmeta){var st=(d.xlmeta.Cell||[])[+A.cm-1];st&&st.type=="XLDAPR"&&(G.D=!0)}if(Ce){var Y=vr(A.r);h[Y.r]||(h[Y.r]=[]),h[Y.r][Y.c]=G}else h[A.r]=G}}}}ne.length>0&&(h["!rows"]=ne)}})();function L9(t,e,r,n){var s=[],i=[],o=Ot(t["!ref"]),c="",u,h="",d=[],g=0,x=0,y=t["!rows"],k=Array.isArray(t),w={r:h},S,N=-1;for(x=o.s.c;x<=o.e.c;++x)d[x]=xr(x);for(g=o.s.r;g<=o.e.r;++g){for(i=[],h=Nr(g),x=o.s.c;x<=o.e.c;++x){u=d[x]+h;var B=k?(t[g]||[])[x]:t[u];B!==void 0&&(c=P9(B,u,t,e))!=null&&i.push(c)}(i.length>0||y&&y[g])&&(w={r:h},y&&y[g]&&(S=y[g],S.hidden&&(w.hidden=1),N=-1,S.hpx?N=kf(S.hpx):S.hpt&&(N=S.hpt),N>-1&&(w.ht=N,w.customHeight=1),S.level&&(w.outlineLevel=S.level)),s[s.length]=Ve("row",i.join(""),w))}if(y)for(;g<y.length;++g)y&&y[g]&&(w={r:g+1},S=y[g],S.hidden&&(w.hidden=1),N=-1,S.hpx?N=kf(S.hpx):S.hpt&&(N=S.hpt),N>-1&&(w.ht=N,w.customHeight=1),S.level&&(w.outlineLevel=S.level),s[s.length]=Ve("row","",w));return s.join("")}function Jk(t,e,r,n){var s=[Rr,Ve("worksheet",null,{xmlns:yl[0],"xmlns:r":Xr.r})],i=r.SheetNames[t],o=0,c="",u=r.Sheets[i];u==null&&(u={});var h=u["!ref"]||"A1",d=Ot(h);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),h=xt(d)}n||(n={}),u["!comments"]=[];var g=[];y9(u,r,t,e,s),s[s.length]=Ve("dimension",null,{ref:h}),s[s.length]=D9(u,e,t,r),e.sheetFormat&&(s[s.length]=Ve("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(s[s.length]=I9(u,u["!cols"])),s[o=s.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(c=L9(u,e),c.length>0&&(s[s.length]=c)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),u["!protect"]&&(s[s.length]=T9(u["!protect"])),u["!autofilter"]!=null&&(s[s.length]=b9(u["!autofilter"],u,r,t)),u["!merges"]!=null&&u["!merges"].length>0&&(s[s.length]=v9(u["!merges"]));var x=-1,y,k=-1;return u["!links"].length>0&&(s[s.length]="<hyperlinks>",u["!links"].forEach(function(w){w[1].Target&&(y={ref:w[0]},w[1].Target.charAt(0)!="#"&&(k=Xt(n,-1,Yt(w[1].Target).replace(/#.*$/,""),wt.HLINK),y["r:id"]="rId"+k),(x=w[1].Target.indexOf("#"))>-1&&(y.location=Yt(w[1].Target.slice(x+1))),w[1].Tooltip&&(y.tooltip=Yt(w[1].Tooltip)),s[s.length]=Ve("hyperlink",null,y))}),s[s.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(s[s.length]=A9(u["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=vn("ignoredErrors",Ve("ignoredError",null,{numberStoredAsText:1,sqref:h}))),g.length>0&&(k=Xt(n,-1,"../drawings/drawing"+(t+1)+".xml",wt.DRAW),s[s.length]=Ve("drawing",null,{"r:id":"rId"+k}),u["!drawing"]=g),u["!comments"].length>0&&(k=Xt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",wt.VML),s[s.length]=Ve("legacyDrawing",null,{"r:id":"rId"+k}),u["!legacy"]=k),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function M9(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function B9(t,e,r){var n=me(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;s.hpx?i=kf(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var c=0,u=n.l;n.l+=4;for(var h={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var g=-1,x=-1,y=d<<10;y<d+1<<10;++y){h.c=y;var k=Array.isArray(r)?(r[h.r]||[])[h.c]:r[it(h)];k&&(g<0&&(g=y),x=y)}g<0||(++c,n.write_shift(4,g),n.write_shift(4,x))}var w=n.l;return n.l=u,n.write_shift(4,c),n.l=w,n.length>n.l?n.slice(0,n.l):n}function V9(t,e,r,n){var s=B9(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&Ie(t,0,s)}var j9=Sl,U9=Kc;function z9(){}function W9(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=GD(t),r}function H9(t,e,r){r==null&&(r=me(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return sd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),qS(t,r),r.slice(0,r.l)}function $9(t){var e=Gs(t);return[e]}function G9(t,e,r){return r==null&&(r=me(8)),wl(e,r)}function K9(t){var e=El(t);return[e]}function q9(t,e,r){return r==null&&(r=me(4)),Tl(e,r)}function X9(t){var e=Gs(t),r=t.read_shift(1);return[e,r,"b"]}function Y9(t,e,r){return r==null&&(r=me(9)),wl(e,r),r.write_shift(1,t.v?1:0),r}function Q9(t){var e=El(t),r=t.read_shift(1);return[e,r,"b"]}function J9(t,e,r){return r==null&&(r=me(5)),Tl(e,r),r.write_shift(1,t.v?1:0),r}function Z9(t){var e=Gs(t),r=t.read_shift(1);return[e,r,"e"]}function e7(t,e,r){return r==null&&(r=me(9)),wl(e,r),r.write_shift(1,t.v),r}function t7(t){var e=El(t),r=t.read_shift(1);return[e,r,"e"]}function r7(t,e,r){return r==null&&(r=me(8)),Tl(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function n7(t){var e=Gs(t),r=t.read_shift(4);return[e,r,"s"]}function s7(t,e,r){return r==null&&(r=me(12)),wl(e,r),r.write_shift(4,e.v),r}function i7(t){var e=El(t),r=t.read_shift(4);return[e,r,"s"]}function a7(t,e,r){return r==null&&(r=me(8)),Tl(e,r),r.write_shift(4,e.v),r}function o7(t){var e=Gs(t),r=Ln(t);return[e,r,"n"]}function l7(t,e,r){return r==null&&(r=me(16)),wl(e,r),dl(t.v,r),r}function Zk(t){var e=El(t),r=Ln(t);return[e,r,"n"]}function c7(t,e,r){return r==null&&(r=me(12)),Tl(e,r),dl(t.v,r),r}function u7(t){var e=Gs(t),r=tx(t);return[e,r,"n"]}function f7(t,e,r){return r==null&&(r=me(12)),wl(e,r),XS(t.v,r),r}function h7(t){var e=El(t),r=tx(t);return[e,r,"n"]}function d7(t,e,r){return r==null&&(r=me(8)),Tl(e,r),XS(t.v,r),r}function p7(t){var e=Gs(t),r=J1(t);return[e,r,"is"]}function m7(t){var e=Gs(t),r=Mn(t);return[e,r,"str"]}function g7(t,e,r){return r==null&&(r=me(12+4*t.v.length)),wl(e,r),on(t.v,r),r.length>r.l?r.slice(0,r.l):r}function x7(t){var e=El(t),r=Mn(t);return[e,r,"str"]}function v7(t,e,r){return r==null&&(r=me(8+4*t.v.length)),Tl(e,r),on(t.v,r),r.length>r.l?r.slice(0,r.l):r}function _7(t,e,r){var n=t.l+e,s=Gs(t);s.r=r["!row"];var i=t.read_shift(1),o=[s,i,"b"];if(r.cellFormula){t.l+=2;var c=Vd(t,n-t.l,r);o[3]=Dn(c,null,s,r.supbooks,r)}else t.l=n;return o}function y7(t,e,r){var n=t.l+e,s=Gs(t);s.r=r["!row"];var i=t.read_shift(1),o=[s,i,"e"];if(r.cellFormula){t.l+=2;var c=Vd(t,n-t.l,r);o[3]=Dn(c,null,s,r.supbooks,r)}else t.l=n;return o}function w7(t,e,r){var n=t.l+e,s=Gs(t);s.r=r["!row"];var i=Ln(t),o=[s,i,"n"];if(r.cellFormula){t.l+=2;var c=Vd(t,n-t.l,r);o[3]=Dn(c,null,s,r.supbooks,r)}else t.l=n;return o}function E7(t,e,r){var n=t.l+e,s=Gs(t);s.r=r["!row"];var i=Mn(t),o=[s,i,"str"];if(r.cellFormula){t.l+=2;var c=Vd(t,n-t.l,r);o[3]=Dn(c,null,s,r.supbooks,r)}else t.l=n;return o}var T7=Sl,S7=Kc;function k7(t,e){return e==null&&(e=me(4)),e.write_shift(4,t),e}function A7(t,e){var r=t.l+e,n=Sl(t),s=Z1(t),i=Mn(t),o=Mn(t),c=Mn(t);t.l=r;var u={rfx:n,relId:s,loc:i,display:c};return o&&(u.Tooltip=o),u}function C7(t,e){var r=me(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Kc({s:vr(t[0]),e:vr(t[0])},r),ex("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return on(s||"",r),on(t[1].Tooltip||"",r),on("",r),r.slice(0,r.l)}function I7(){}function F7(t,e,r){var n=t.l+e,s=YS(t),i=t.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var c=ZM(t,n-t.l,r);o[1]=c}else t.l=n;return o}function b7(t,e,r){var n=t.l+e,s=Sl(t),i=[s];if(r.cellFormula){var o=t9(t,n-t.l,r);i[1]=o,t.l=n}else t.l=n;return i}function N7(t,e,r){r==null&&(r=me(18));var n=jd(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var e4=["left","right","top","bottom","header","footer"];function R7(t){var e={};return e4.forEach(function(r){e[r]=Ln(t)}),e}function D7(t,e){return e==null&&(e=me(48)),sl(t),e4.forEach(function(r){dl(t[r],e)}),e}function P7(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function O7(t,e,r){r==null&&(r=me(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function L7(t){var e=me(24);return e.write_shift(4,4),e.write_shift(4,1),Kc(t,e),e}function M7(t,e){return e==null&&(e=me(66)),e.write_shift(2,t.password?ox(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function B7(){}function V7(){}function j7(t,e,r,n,s,i,o){if(!t)return t;var c=e||{};n||(n={"!id":{}});var u=c.dense?[]:{},h,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,x=!1,y,k,w,S,N,B,b,j,X,G=[];c.biff=12,c["!row"]=0;var A=0,C=!1,F=[],V={},M=c.supbooks||s.supbooks||[[]];if(M.sharedf=V,M.arrayf=F,M.SheetNames=s.SheetNames||s.Sheets.map(function(Ce){return Ce.name}),!c.supbooks&&(c.supbooks=M,s.Names))for(var D=0;D<s.Names.length;++D)M[0][D+1]=s.Names[D];var L=[],ke=[],Se=!1;Af[16]={n:"BrtShortReal",f:Zk};var De;if(Aa(t,function(ne,ye,ee){if(!x)switch(ee){case 148:h=ne;break;case 0:y=ne,c.sheetRows&&c.sheetRows<=y.r&&(x=!0),j=Nr(S=y.r),c["!row"]=y.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=Pc(ne.hpt)),ke[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:ne[2]},ne[2]){case"n":k.v=ne[1];break;case"s":b=Qu[ne[1]],k.v=b.t,k.r=b.r;break;case"b":k.v=!!ne[1];break;case"e":k.v=ne[1],c.cellText!==!1&&(k.w=Ca[k.v]);break;case"str":k.t="s",k.v=ne[1];break;case"is":k.t="s",k.v=ne[1].t;break}if((w=o.CellXf[ne[0].iStyleRef])&&Yk(k,w.numFmtId,null,c,i,o),N=ne[0].c==-1?N+1:ne[0].c,c.dense?(u[S]||(u[S]=[]),u[S][N]=k):u[xr(N)+j]=k,c.cellFormula){for(C=!1,A=0;A<F.length;++A){var O=F[A];y.r>=O[0].s.r&&y.r<=O[0].e.r&&N>=O[0].s.c&&N<=O[0].e.c&&(k.F=xt(O[0]),C=!0)}!C&&ne.length>3&&(k.f=ne[3])}if(d.s.r>y.r&&(d.s.r=y.r),d.s.c>N&&(d.s.c=N),d.e.r<y.r&&(d.e.r=y.r),d.e.c<N&&(d.e.c=N),c.cellDates&&w&&k.t=="n"&&Hc(nt[w.numFmtId])){var te=Yo(k.v);te&&(k.t="d",k.v=new Date(te.y,te.m-1,te.d,te.H,te.M,te.S,te.u))}De&&(De.type=="XLDAPR"&&(k.D=!0),De=void 0);break;case 1:case 12:if(!c.sheetStubs||g)break;k={t:"z",v:void 0},N=ne[0].c==-1?N+1:ne[0].c,c.dense?(u[S]||(u[S]=[]),u[S][N]=k):u[xr(N)+j]=k,d.s.r>y.r&&(d.s.r=y.r),d.s.c>N&&(d.s.c=N),d.e.r<y.r&&(d.e.r=y.r),d.e.c<N&&(d.e.c=N),De&&(De.type=="XLDAPR"&&(k.D=!0),De=void 0);break;case 176:G.push(ne);break;case 49:De=((c.xlmeta||{}).Cell||[])[ne-1];break;case 494:var J=n["!id"][ne.relId];for(J?(ne.Target=J.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=J):ne.relId==""&&(ne.Target="#"+ne.loc),S=ne.rfx.s.r;S<=ne.rfx.e.r;++S)for(N=ne.rfx.s.c;N<=ne.rfx.e.c;++N)c.dense?(u[S]||(u[S]=[]),u[S][N]||(u[S][N]={t:"z",v:void 0}),u[S][N].l=ne):(B=it({c:N,r:S}),u[B]||(u[B]={t:"z",v:void 0}),u[B].l=ne);break;case 426:if(!c.cellFormula)break;F.push(ne),X=c.dense?u[S][N]:u[xr(N)+j],X.f=Dn(ne[1],d,{r:y.r,c:N},M,c),X.F=xt(ne[0]);break;case 427:if(!c.cellFormula)break;V[it(ne[0].s)]=ne[1],X=c.dense?u[S][N]:u[xr(N)+j],X.f=Dn(ne[1],d,{r:y.r,c:N},M,c);break;case 60:if(!c.cellStyles)break;for(;ne.e>=ne.s;)L[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},Se||(Se=!0,lx(ne.w/256)),xo(L[ne.e+1]);break;case 161:u["!autofilter"]={ref:xt(ne)};break;case 476:u["!margins"]=ne;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),ne.name&&(s.Sheets[r].CodeName=ne.name),(ne.above||ne.left)&&(u["!outline"]={above:ne.above,left:ne.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),ne.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!ye.T){if(!g||c.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(d.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(u["!ref"]=xt(h||d)),c.sheetRows&&u["!ref"]){var Ne=Ot(u["!ref"]);c.sheetRows<=+Ne.e.r&&(Ne.e.r=c.sheetRows-1,Ne.e.r>d.e.r&&(Ne.e.r=d.e.r),Ne.e.r<Ne.s.r&&(Ne.s.r=Ne.e.r),Ne.e.c>d.e.c&&(Ne.e.c=d.e.c),Ne.e.c<Ne.s.c&&(Ne.s.c=Ne.e.c),u["!fullref"]=u["!ref"],u["!ref"]=xt(Ne))}return G.length>0&&(u["!merges"]=G),L.length>0&&(u["!cols"]=L),ke.length>0&&(u["!rows"]=ke),u}function U7(t,e,r,n,s,i,o){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=lr(e),e.z=e.z||nt[14],e.v=Qr(or(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var u={r,c:n};switch(u.s=ko(s.cellXfs,e,s),e.l&&i["!links"].push([it(u),e.l]),e.c&&i["!comments"].push([it(u),e.c]),e.t){case"s":case"str":return s.bookSST?(c=dx(s.Strings,e.v,s.revStrings),u.t="s",u.v=c,o?Ie(t,18,a7(e,u)):Ie(t,7,s7(e,u))):(u.t="str",o?Ie(t,17,v7(e,u)):Ie(t,6,g7(e,u))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Ie(t,13,d7(e,u)):Ie(t,2,f7(e,u)):o?Ie(t,16,c7(e,u)):Ie(t,5,l7(e,u)),!0;case"b":return u.t="b",o?Ie(t,15,J9(e,u)):Ie(t,4,Y9(e,u)),!0;case"e":return u.t="e",o?Ie(t,14,r7(e,u)):Ie(t,3,e7(e,u)),!0}return o?Ie(t,12,q9(e,u)):Ie(t,1,G9(e,u)),!0}function z7(t,e,r,n){var s=Ot(e["!ref"]||"A1"),i,o="",c=[];Ie(t,145);var u=Array.isArray(e),h=s.e.r;e["!rows"]&&(h=Math.max(s.e.r,e["!rows"].length-1));for(var d=s.s.r;d<=h;++d){o=Nr(d),V9(t,e,s,d);var g=!1;if(d<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){d===s.s.r&&(c[x]=xr(x)),i=c[x]+o;var y=u?(e[d]||[])[x]:e[i];if(!y){g=!1;continue}g=U7(t,y,d,x,n,e,g)}}Ie(t,146)}function W7(t,e){!e||!e["!merges"]||(Ie(t,177,k7(e["!merges"].length)),e["!merges"].forEach(function(r){Ie(t,176,S7(r))}),Ie(t,178))}function H7(t,e){!e||!e["!cols"]||(Ie(t,390),e["!cols"].forEach(function(r,n){r&&Ie(t,60,N7(n,r))}),Ie(t,391))}function $7(t,e){!e||!e["!ref"]||(Ie(t,648),Ie(t,649,L7(Ot(e["!ref"]))),Ie(t,650))}function G7(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=Xt(r,-1,n[1].Target.replace(/#.*$/,""),wt.HLINK);Ie(t,494,C7(n,s))}}),delete e["!links"]}function K7(t,e,r,n){if(e["!comments"].length>0){var s=Xt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",wt.VML);Ie(t,551,ex("rId"+s)),e["!legacy"]=s}}function q7(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],i=typeof s.ref=="string"?s.ref:xt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,c=cs(i);c.s.r==c.e.r&&(c.e.r=cs(e["!ref"]).e.r,i=xt(c));for(var u=0;u<o.length;++u){var h=o[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+i;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ie(t,161,Kc(Ot(i))),Ie(t,162)}}function X7(t,e,r){Ie(t,133),Ie(t,137,O7(e,r)),Ie(t,138),Ie(t,134)}function Y7(t,e){e["!protect"]&&Ie(t,535,M7(e["!protect"]))}function Q7(t,e,r,n){var s=ls(),i=r.SheetNames[t],o=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}var u=Ot(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ie(s,129),(r.vbaraw||o["!outline"])&&Ie(s,147,H9(c,o["!outline"])),Ie(s,148,U9(u)),X7(s,o,r.Workbook),H7(s,o),z7(s,o,t,e),Y7(s,o),q7(s,o,r,t),W7(s,o),G7(s,o,n),o["!margins"]&&Ie(s,476,D7(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&$7(s,o),K7(s,o,t,n),Ie(s,130),s.end()}function J7(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var s=Pt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function Z7(t,e,r,n,s,i){var o=i||{"!type":"chart"};if(!t)return i;var c=0,u=0,h="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var x=J7(g);d.s.r=d.s.c=0,d.e.c=c,h=xr(c),x[0].forEach(function(y,k){o[h+Nr(k)]={t:"n",v:y,z:x[1]},u=k}),d.e.r<u&&(d.e.r=u),++c}),c>0&&(o["!ref"]=xt(d)),o}function eB(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,c=t.match(Qk);return c&&px(c[0],i,s,r),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function tB(t,e){t.l+=10;var r=Mn(t);return{name:r}}function rB(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Aa(t,function(u,h,d){switch(d){case 550:i["!rel"]=u;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),u.name&&(s.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var mx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],nB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],sB=[],iB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function _w(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=ir(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function yw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=ir(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function t4(t){yw(t.WBProps,mx),yw(t.CalcPr,iB),_w(t.WBView,nB),_w(t.Sheets,sB),Ec.date1904=ir(t.WBProps.date1904)}function aB(t){return!t.Workbook||!t.Workbook.WBProps?"false":ir(t.Workbook.WBProps.date1904)?"true":"false"}var oB="][*?/\\".split("");function r4(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return oB.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function lB(t,e,r){t.forEach(function(n,s){r4(n);for(var i=0;i<s;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[s]&&e[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function cB(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];lB(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)a9(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var uB=/<\w+:workbook/;function fB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},o=0;if(t.replace(jn,function(u,h){var d=lt(u);switch(Hi(d[0])){case"<?xml":break;case"<workbook":u.match(uB)&&(s="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":mx.forEach(function(g){if(d[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=ir(d[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(d[g[0]],10);break;default:r.WBProps[g[0]]=d[g[0]]}}),d.codeName&&(r.WBProps.CodeName=Qt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Pt(Qt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Qt(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),ir(d.hidden||"0")&&(i.Hidden=!0),o=h+u.length;break;case"</definedName>":i.Ref=Pt(Qt(t.slice(o,h))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),yl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return t4(r),r}function n4(t){var e=[Rr];e[e.length]=Ve("workbook",null,{xmlns:yl[0],"xmlns:r":Xr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(mx.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ve("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:Yt(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Ve("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var u={name:c.Name};c.Comment&&(u.comment=c.Comment),c.Sheet!=null&&(u.localSheetId=""+c.Sheet),c.Hidden&&(u.hidden="1"),c.Ref&&(e[e.length]=Ve("definedName",Yt(c.Ref),u))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function hB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Sg(t),r.name=Mn(t),r}function dB(t,e){return e||(e=me(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),ex(t.strRelID,e),on(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function pB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Mn(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function mB(t,e){e||(e=me(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),qS(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function gB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function xB(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=KD(t),o=e9(t,0,r),c=Z1(t);t.l=n;var u={Name:i,Ptg:o};return s<268435455&&(u.Sheet=s),c&&(u.Comment=c),u}function vB(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Af[16]={n:"BrtFRTArchID$",f:gB},Aa(t,function(u,h,d){switch(d){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(e.SID=u.Sheet),u.Ref=Dn(u.Ptg,null,null,o,e),delete e.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,u]):o[0]=[d,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!h.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),t4(r),r.Names=i,r.supbooks=o,r}function _B(t,e){Ie(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Ie(t,156,dB(s))}Ie(t,144)}function yB(t,e){e||(e=me(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return on("SheetJS",e),on(Q0.version,e),on(Q0.version,e),on("7262",e),e.length>e.l?e.slice(0,e.l):e}function wB(t,e){e||(e=me(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function EB(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(Ie(t,135),Ie(t,158,wB(s)),Ie(t,136))}}function TB(t,e){var r=ls();return Ie(r,131),Ie(r,128,yB()),Ie(r,153,mB(t.Workbook&&t.Workbook.WBProps||null)),EB(r,t),_B(r,t),Ie(r,132),r.end()}function SB(t,e,r){return e.slice(-4)===".bin"?vB(t,r):fB(t,r)}function kB(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?j7(t,n,r,s,i,o,c):x9(t,n,r,s,i,o,c)}function AB(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?rB(t,n,r,s,i):eB(t,n,r,s,i)}function CB(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?FL():bL()}function IB(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?CL():IL()}function FB(t,e,r,n){return e.slice(-4)===".bin"?SO(t,r,n):hO(t,r,n)}function bB(t,e,r){return Mk(t,r)}function NB(t,e,r){return e.slice(-4)===".bin"?N5(t,r):I5(t,r)}function RB(t,e,r){return e.slice(-4)===".bin"?EL(t,r):dL(t,r)}function DB(t,e,r){return e.slice(-4)===".bin"?uL(t):lL(t)}function PB(t,e,r,n){return r.slice(-4)===".bin"?fL(t,e,r,n):void 0}function OB(t,e,r){return e.slice(-4)===".bin"?iL(t,e,r):oL(t,e,r)}function LB(t,e,r){return(e.slice(-4)===".bin"?TB:n4)(t)}function MB(t,e,r,n,s){return(e.slice(-4)===".bin"?Q7:Jk)(t,r,n,s)}function BB(t,e,r){return(e.slice(-4)===".bin"?PO:Ok)(t,r)}function VB(t,e,r){return(e.slice(-4)===".bin"?P5:Ck)(t,r)}function jB(t,e,r){return(e.slice(-4)===".bin"?TL:jk)(t)}function UB(t){return(t.slice(-4)===".bin"?aL:Bk)()}var s4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,i4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ri(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(s4),i,o,c,u;if(s)for(u=0;u!=s.length;++u)i=s[u].match(i4),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),n[c]=i[2].slice(1,i[2].length-1));return n}function zB(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(s4),s,i,o,c;if(n)for(c=0;c!=n.length;++c)s=n[c].match(i4),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var Zu;function WB(t,e){var r=Zu[t]||Pt(t);return r==="General"?fl(e):$s(r,e)}function HB(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=ir(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=or(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Pt(e)]=s}function $B(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ca[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=xf(t.v):t.w=fl(t.v):t.w=WB(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=Zu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Hc(n)){var s=Yo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function GB(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=sO[n.Pattern]||n.Pattern)}t[e.ID]=e}function KB(t,e,r,n,s,i,o,c,u,h){var d="General",g=n.StyleID,x={};h=h||{};var y=[],k=0;for(g===void 0&&c&&(g=c.StyleID),g===void 0&&o&&(g=o.StyleID);i[g]!==void 0&&(i[g].nf&&(d=i[g].nf),i[g].Interior&&y.push(i[g].Interior),!!i[g].Parent);)g=i[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ir(t);break;case"String":n.t="s",n.r=My(Pt(t)),n.v=t.indexOf("<")>-1?Pt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(or(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Pt(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=ZS[t],h.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=My(e||t));break}if($B(n,d,h),h.cellFormula!==!1)if(n.Formula){var w=Pt(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=wc(w,s),delete n.Formula,n.ArrayRange=="RC"?n.F=wc("RC:RC",s):n.ArrayRange&&(n.F=wc(n.ArrayRange,s),u.push([Ot(n.F),n.F]))}else for(k=0;k<u.length;++k)s.r>=u[k][0].s.r&&s.r<=u[k][0].e.r&&s.c>=u[k][0].s.c&&s.c<=u[k][0].e.c&&(n.F=u[k][1]);h.cellStyles&&(y.forEach(function(S){!x.patternType&&S.patternType&&(x.patternType=S.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function qB(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Um(t,e){var r=e||{};$c();var n=Mu(K1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Qt(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=lr(r);return o.type="string",Dc.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ht){s.indexOf("<"+Ht)>=0&&(i=!0)}),i)return DV(n,r);Zu={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],h,d={},g=[],x=r.dense?[]:{},y="",k={},w={},S=ri('<Data ss:Type="String">'),N=0,B=0,b=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},X={},G={},A="",C=0,F=[],V={},M={},D=0,L=[],ke=[],Se={},De=[],Ne,Ce=!1,ne=[],ye=[],ee={},O=0,te=0,J={Sheets:[],WBProps:{date1904:!1}},Z={};yf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";c=yf.exec(n);)switch(c[3]=(oe=c[3]).toLowerCase()){case"data":if(oe=="data"){if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?KB(n.slice(N,c.index),A,S,u[u.length-1][0]=="comment"?Se:k,{c:B,r:b},X,De[B],w,ne,r):(A="",S=ri(c[0]),N=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(ke.length>0&&(k.c=ke),(!r.sheetRows||r.sheetRows>b)&&k.v!==void 0&&(r.dense?(x[b]||(x[b]=[]),x[b][B]=k):x[xr(B)+Nr(b)]=k),k.HRef&&(k.l={Target:Pt(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(O=B+(parseInt(k.MergeAcross,10)|0),te=b+(parseInt(k.MergeDown,10)|0),F.push({s:{c:B,r:b},e:{c:O,r:te}})),!r.sheetStubs)k.MergeAcross?B=O+1:++B;else if(k.MergeAcross||k.MergeDown){for(var _e=B;_e<=O;++_e)for(var ve=b;ve<=te;++ve)(_e>B||ve>b)&&(r.dense?(x[ve]||(x[ve]=[]),x[ve][_e]={t:"z"}):x[xr(_e)+Nr(ve)]={t:"z"});B=O+1}else++B;else k=zB(c[0]),k.Index&&(B=+k.Index-1),B<j.s.c&&(j.s.c=B),B>j.e.c&&(j.e.c=B),c[0].slice(-2)==="/>"&&++B,ke=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(b<j.s.r&&(j.s.r=b),b>j.e.r&&(j.e.r=b),c[0].slice(-2)==="/>"&&(w=ri(c[0]),w.Index&&(b=+w.Index-1)),B=0,++b):(w=ri(c[0]),w.Index&&(b=+w.Index-1),ee={},(w.AutoFitHeight=="0"||w.Height)&&(ee.hpx=parseInt(w.Height,10),ee.hpt=kf(ee.hpx),ye[b]=ee),w.Hidden=="1"&&(ee.hidden=!0,ye[b]=ee));break;case"worksheet":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));g.push(y),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(x["!ref"]=xt(j),r.sheetRows&&r.sheetRows<=j.e.r&&(x["!fullref"]=x["!ref"],j.e.r=r.sheetRows-1,x["!ref"]=xt(j))),F.length&&(x["!merges"]=F),De.length>0&&(x["!cols"]=De),ye.length>0&&(x["!rows"]=ye),d[y]=x}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=B=0,u.push([c[3],!1]),h=ri(c[0]),y=Pt(h.Name),x=r.dense?[]:{},F=[],ne=[],ye=[],Z={name:y,Hidden:0},J.Sheets.push(Z);break;case"table":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),De=[],Ce=!1}break;case"style":c[1]==="/"?GB(X,G,r):G=ri(c[0]);break;case"numberformat":G.nf=Pt(ri(c[0]).Format||"General"),Zu[G.nf]&&(G.nf=Zu[G.nf]);for(var xe=0;xe!=392&&nt[xe]!=G.nf;++xe);if(xe==392){for(xe=57;xe!=392;++xe)if(nt[xe]==null){xa(G.nf,xe);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Ne=ri(c[0]),Ne.Hidden&&(Ne.hidden=!0,delete Ne.Hidden),Ne.Width&&(Ne.wpx=parseInt(Ne.Width,10)),!Ce&&Ne.wpx>10){Ce=!0,On=Dk;for(var Ee=0;Ee<De.length;++Ee)De[Ee]&&xo(De[Ee])}Ce&&xo(Ne),De[Ne.Index-1||De.length]=Ne;for(var st=0;st<+Ne.Span;++st)De[De.length]=lr(Ne);break;case"namedrange":if(c[1]==="/")break;J.Names||(J.Names=[]);var Y=lt(c[0]),Et={Name:Y.Name,Ref:wc(Y.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(Et.Sheet=J.Sheets.length-1),J.Names.push(Et);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?A+=n.slice(C,c.index):C=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;G.Interior=ri(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?vP(V,oe,n.slice(D,c.index)):D=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));qB(Se),ke.push(Se)}else u.push([c[3],!1]),h=ri(c[0]),Se={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var gt=ri(c[0]);x["!autofilter"]={ref:wc(gt.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return kw(n,r);var It=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:It=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:It=!1}break;case"excelworkbook":switch(c[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:It=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:It=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(D,c.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else D=c.index+c[0].length;break;case"header":x["!margins"]||sl(x["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(x["!margins"].header=+lt(c[0]).Margin);break;case"footer":x["!margins"]||sl(x["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(x["!margins"].footer=+lt(c[0]).Margin);break;case"pagemargins":var ht=lt(c[0]);x["!margins"]||sl(x["!margins"]={},"xlml"),isNaN(+ht.Top)||(x["!margins"].top=+ht.Top),isNaN(+ht.Left)||(x["!margins"].left=+ht.Left),isNaN(+ht.Right)||(x["!margins"].right=+ht.Right),isNaN(+ht.Bottom)||(x["!margins"].bottom=+ht.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:It=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:It=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:It=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:It=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:It=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:It=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:It=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:It=!1}break;case"smarttags":break;default:It=!1;break}if(It||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?HB(M,oe,L,n.slice(D,c.index)):(L=c,D=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var je={};return!r.bookSheets&&!r.bookProps&&(je.Sheets=d),je.SheetNames=g,je.Workbook=J,je.SSF=lr(nt),je.Props=V,je.Custprops=M,je}function Ng(t,e){switch(xx(e=e||{}),e.type||"base64"){case"base64":return Um(ks(t),e);case"binary":case"buffer":case"file":return Um(t,e);case"array":return Um(To(t),e)}}function XB(t,e){var r=[];return t.Props&&r.push(_P(t.Props,e)),t.Custprops&&r.push(yP(t.Props,t.Custprops)),r.join("")}function YB(){return""}function QB(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var i=[];i.push(Ve("NumberFormat",null,{"ss:Format":Yt(nt[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Ve("Style",i.join(""),o))}),Ve("Styles",r.join(""))}function a4(t){return Ve("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+fx(t.Ref,{r:0,c:0})})}function JB(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(a4(s)))}return Ve("Names",r.join(""))}function ZB(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],o=0;o<s.length;++o){var c=s[o];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(a4(c)))}return i.join("")}function eV(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(Ve("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(Ve("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(Ve("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Ve("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(vn("ProtectContents","True")),t["!protect"].objects&&s.push(vn("ProtectObjects","True")),t["!protect"].scenarios&&s.push(vn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(vn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(vn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Ve("WorksheetOptions",s.join(""),{xmlns:_s.x})}function tV(t){return t.map(function(e){var r=ED(e.t||""),n=Ve("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ve("Comment",n,{"ss:Author":e.a})}).join("")}function rV(t,e,r,n,s,i,o){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+Yt(fx(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var u=vr(t.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=Yt(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=Yt(t.l.Tooltip))),r["!merges"])for(var h=r["!merges"],d=0;d!=h.length;++d)h[d].s.c!=o.c||h[d].s.r!=o.r||(h[d].e.c>h[d].s.c&&(c["ss:MergeAcross"]=h[d].e.c-h[d].s.c),h[d].e.r>h[d].s.r&&(c["ss:MergeDown"]=h[d].e.r-h[d].s.r));var g="",x="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",x=String(t.v);break;case"b":g="Boolean",x=t.v?"1":"0";break;case"e":g="Error",x=Ca[t.v];break;case"d":g="DateTime",x=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||nt[14]);break;case"s":g="String",x=wD(t.v||"");break}var y=ko(n.cellXfs,t,n);c["ss:StyleID"]="s"+(21+y),c["ss:Index"]=o.c+1;var k=t.v!=null?x:"",w=t.t=="z"?"":'<Data ss:Type="'+g+'">'+k+"</Data>";return(t.c||[]).length>0&&(w+=tV(t.c)),Ve("Cell",w,c)}function nV(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Pc(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function sV(t,e,r,n){if(!t["!ref"])return"";var s=Ot(t["!ref"]),i=t["!merges"]||[],o=0,c=[];t["!cols"]&&t["!cols"].forEach(function(S,N){xo(S);var B=!!S.width,b=jd(N,S),j={"ss:Index":N+1};B&&(j["ss:Width"]=Tf(b.width)),S.hidden&&(j["ss:Hidden"]="1"),c.push(Ve("Column",null,j))});for(var u=Array.isArray(t),h=s.s.r;h<=s.e.r;++h){for(var d=[nV(h,(t["!rows"]||[])[h])],g=s.s.c;g<=s.e.c;++g){var x=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>g)&&!(i[o].s.r>h)&&!(i[o].e.c<g)&&!(i[o].e.r<h)){(i[o].s.c!=g||i[o].s.r!=h)&&(x=!0);break}if(!x){var y={r:h,c:g},k=it(y),w=u?(t[h]||[])[g]:t[k];d.push(rV(w,k,t,e,r,n,y))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function iV(t,e,r){var n=[],s=r.SheetNames[t],i=r.Sheets[s],o=i?ZB(i,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?sV(i,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(eV(i,e,t,r)),n.join("")}function aV(t,e){e||(e={}),t.SSF||(t.SSF=lr(nt)),t.SSF&&($c(),Dd(t.SSF),e.revssf=Od(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],ko(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(XB(t,e)),r.push(YB()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ve("Worksheet",iV(n,e,t),{"ss:Name":Yt(t.SheetNames[n])}));return r[2]=QB(t,e),r[3]=JB(t),Rr+Ve("Workbook",r.join(""),{xmlns:_s.ss,"xmlns:o":_s.o,"xmlns:x":_s.x,"xmlns:ss":_s.ss,"xmlns:dt":_s.dt,"xmlns:html":_s.html})}function oV(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=JD(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=ZD(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var lV=[60,1084,2066,2165,2175];function cV(t,e,r,n,s){var i=n,o=[],c=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(c)}o.push(c),r.l+=i;for(var u=pa(r,r.l),h=Rg[u],d=0;h!=null&&lV.indexOf(u)>-1;)i=pa(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),c=r.slice(d,r.l+4+i),o.push(c),r.l+=4+i,h=Rg[u=pa(r,r.l)];var g=an(o);gn(g,0);var x=0;g.lens=[];for(var y=0;y<o.length;++y)g.lens.push(x),x+=o[y].length;if(g.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+g.length+" < "+n;return e.f(g,g.length,s)}function bi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=nt[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ca[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=xf(t.v):t.w=fl(t.v):t.w=$s(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Hc(nt[n]||String(n))){var s=Yo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function x0(t,e,r){return{v:t,ixfe:e,t:r}}function uV(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},o={},c=null,u=[],h="",d={},g,x="",y,k,w,S,N={},B=[],b,j,X=[],G=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},F=function(ot){return ot<8?tl[ot]:ot<64&&G[ot-8]||tl[ot]},V=function(ot,Rt,Gr){var jt=Rt.XF.data;if(!(!jt||!jt.patternType||!Gr||!Gr.cellStyles)){Rt.s={},Rt.s.patternType=jt.patternType;var wn;(wn=Ef(F(jt.icvFore)))&&(Rt.s.fgColor={rgb:wn}),(wn=Ef(F(jt.icvBack)))&&(Rt.s.bgColor={rgb:wn})}},M=function(ot,Rt,Gr){if(!(ee>1)&&!(Gr.sheetRows&&ot.r>=Gr.sheetRows)){if(Gr.cellStyles&&Rt.XF&&Rt.XF.data&&V(ot,Rt,Gr),delete Rt.ixfe,delete Rt.XF,g=ot,x=it(ot),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<o.s.r&&(o.s.r=ot.r),ot.c<o.s.c&&(o.s.c=ot.c),ot.r+1>o.e.r&&(o.e.r=ot.r+1),ot.c+1>o.e.c&&(o.e.c=ot.c+1),Gr.cellFormula&&Rt.f){for(var jt=0;jt<B.length;++jt)if(!(B[jt][0].s.c>ot.c||B[jt][0].s.r>ot.r)&&!(B[jt][0].e.c<ot.c||B[jt][0].e.r<ot.r)){Rt.F=xt(B[jt][0]),(B[jt][0].s.c!=ot.c||B[jt][0].s.r!=ot.r)&&delete Rt.f,Rt.f&&(Rt.f=""+Dn(B[jt][1],o,ot,ne,D));break}}Gr.dense?(s[ot.r]||(s[ot.r]=[]),s[ot.r][ot.c]=Rt):s[x]=Rt}},D={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:B,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var L,ke=[],Se=[],De=[],Ne=[],Ce=!1,ne=[];ne.SheetNames=D.snames,ne.sharedf=D.sharedf,ne.arrayf=D.arrayf,ne.names=[],ne.XTI=[];var ye=0,ee=0,O=0,te=[],J=[],Z;D.codepage=1200,ii(1200);for(var oe=!1;t.l<t.length-1;){var _e=t.l,ve=t.read_shift(2);if(ve===0&&ye===10)break;var xe=t.l===t.length?0:t.read_shift(2),Ee=Rg[ve];if(Ee&&Ee.f){if(e.bookSheets&&ye===133&&ve!==133)break;if(ye=ve,Ee.r===2||Ee.r==12){var st=t.read_shift(2);if(xe-=2,!D.enc&&st!==ve&&((st&255)<<8|st>>8)!==ve)throw new Error("rt mismatch: "+st+"!="+ve);Ee.r==12&&(t.l+=10,xe-=10)}var Y={};if(ve===10?Y=Ee.f(t,xe,D):Y=cV(ve,Ee,t,xe,D),ee==0&&[9,521,1033,2057].indexOf(ye)===-1)continue;switch(ve){case 34:r.opts.Date1904=A.WBProps.date1904=Y;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=Y,!e.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=Y;break;case 66:var Et=Number(Y);switch(Et){case 21010:Et=1200;break;case 32768:Et=1e4;break;case 32769:Et=1252;break}ii(D.codepage=Et),oe=!0;break;case 317:D.rrtabid=Y;break;case 25:D.winlocked=Y;break;case 439:r.opts.RefreshAll=Y;break;case 12:r.opts.CalcCount=Y;break;case 16:r.opts.CalcDelta=Y;break;case 17:r.opts.CalcIter=Y;break;case 13:r.opts.CalcMode=Y;break;case 14:r.opts.CalcPrecision=Y;break;case 95:r.opts.CalcSaveRecalc=Y;break;case 15:D.CalcRefMode=Y;break;case 2211:r.opts.FullCalc=Y;break;case 129:Y.fDialog&&(s["!type"]="dialog"),Y.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Y.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:X.push(Y);break;case 430:ne.push([Y]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(Y);break;case 24:case 536:Z={Name:Y.Name,Ref:Dn(Y.rgce,o,null,ne,D)},Y.itab>0&&(Z.Sheet=Y.itab-1),ne.names.push(Z),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(J[Y.itab-1]={ref:xt(Y.rgce[0][0][1][2])});break;case 22:D.ExternCount=Y;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(Y),ne.XTI=ne.XTI.concat(Y);break;case 2196:if(D.biff<8)break;Z!=null&&(Z.Comment=Y[1]);break;case 18:s["!protect"]=Y;break;case 19:Y!==0&&D.WTF&&console.error("Password verifier: "+Y);break;case 133:i[Y.pos]=Y,D.snames.push(Y.name);break;case 10:{if(--ee)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=xt(o),e.sheetRows&&e.sheetRows<=o.e.r){var gt=o.e.r;o.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=xt(o),o.e.r=gt}o.e.r++,o.e.c++}ke.length>0&&(s["!merges"]=ke),Se.length>0&&(s["!objects"]=Se),De.length>0&&(s["!cols"]=De),Ne.length>0&&(s["!rows"]=Ne),A.Sheets.push(C)}h===""?d=s:n[h]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),D.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(D.biff=5,oe=!0,ii(D.codepage=28591)),D.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(D.biff=2),ee++)break;if(s=e.dense?[]:{},D.biff<8&&!oe&&(oe=!0,ii(D.codepage=e.codepage||1252)),D.biff<5||Y.BIFFVer==0&&Y.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var It={pos:t.l-xe,name:h};i[It.pos]=It,D.snames.push(h)}else h=(i[_e]||{name:""}).name;Y.dt==32&&(s["!type"]="chart"),Y.dt==64&&(s["!type"]="macro"),ke=[],Se=[],D.arrayf=B=[],De=[],Ne=[],Ce=!1,C={Hidden:(i[_e]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[Y.r]||[])[Y.c]:s[it({c:Y.c,r:Y.r})])&&++Y.c,b={ixfe:Y.ixfe,XF:X[Y.ixfe]||{},v:Y.val,t:"n"},O>0&&(b.z=te[b.ixfe>>8&63]),bi(b,e,r.opts.Date1904),M({c:Y.c,r:Y.r},b,e);break;case 5:case 517:b={ixfe:Y.ixfe,XF:X[Y.ixfe],v:Y.val,t:Y.t},O>0&&(b.z=te[b.ixfe>>8&63]),bi(b,e,r.opts.Date1904),M({c:Y.c,r:Y.r},b,e);break;case 638:b={ixfe:Y.ixfe,XF:X[Y.ixfe],v:Y.rknum,t:"n"},O>0&&(b.z=te[b.ixfe>>8&63]),bi(b,e,r.opts.Date1904),M({c:Y.c,r:Y.r},b,e);break;case 189:for(var ht=Y.c;ht<=Y.C;++ht){var je=Y.rkrec[ht-Y.c][0];b={ixfe:je,XF:X[je],v:Y.rkrec[ht-Y.c][1],t:"n"},O>0&&(b.z=te[b.ixfe>>8&63]),bi(b,e,r.opts.Date1904),M({c:ht,r:Y.r},b,e)}break;case 6:case 518:case 1030:{if(Y.val=="String"){c=Y;break}if(b=x0(Y.val,Y.cell.ixfe,Y.tt),b.XF=X[b.ixfe],e.cellFormula){var Ht=Y.formula;if(Ht&&Ht[0]&&Ht[0][0]&&Ht[0][0][0]=="PtgExp"){var St=Ht[0][0][1][0],Tt=Ht[0][0][1][1],fr=it({r:St,c:Tt});N[fr]?b.f=""+Dn(Y.formula,o,Y.cell,ne,D):b.F=((e.dense?(s[St]||[])[Tt]:s[fr])||{}).F}else b.f=""+Dn(Y.formula,o,Y.cell,ne,D)}O>0&&(b.z=te[b.ixfe>>8&63]),bi(b,e,r.opts.Date1904),M(Y.cell,b,e),c=Y}break;case 7:case 519:if(c)c.val=Y,b=x0(Y,c.cell.ixfe,"s"),b.XF=X[b.ixfe],e.cellFormula&&(b.f=""+Dn(c.formula,o,c.cell,ne,D)),O>0&&(b.z=te[b.ixfe>>8&63]),bi(b,e,r.opts.Date1904),M(c.cell,b,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{B.push(Y);var Xn=it(Y[0].s);if(y=e.dense?(s[Y[0].s.r]||[])[Y[0].s.c]:s[Xn],e.cellFormula&&y){if(!c||!Xn||!y)break;y.f=""+Dn(Y[1],o,Y[0],ne,D),y.F=xt(Y[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!c)break;N[it(c.cell)]=Y[0],y=e.dense?(s[c.cell.r]||[])[c.cell.c]:s[it(c.cell)],(y||{}).f=""+Dn(Y[0],o,g,ne,D)}}break;case 253:b=x0(u[Y.isst].t,Y.ixfe,"s"),u[Y.isst].h&&(b.h=u[Y.isst].h),b.XF=X[b.ixfe],O>0&&(b.z=te[b.ixfe>>8&63]),bi(b,e,r.opts.Date1904),M({c:Y.c,r:Y.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:Y.ixfe,XF:X[Y.ixfe],t:"z"},O>0&&(b.z=te[b.ixfe>>8&63]),bi(b,e,r.opts.Date1904),M({c:Y.c,r:Y.r},b,e));break;case 190:if(e.sheetStubs)for(var ln=Y.c;ln<=Y.C;++ln){var $r=Y.ixfe[ln-Y.c];b={ixfe:$r,XF:X[$r],t:"z"},O>0&&(b.z=te[b.ixfe>>8&63]),bi(b,e,r.opts.Date1904),M({c:ln,r:Y.r},b,e)}break;case 214:case 516:case 4:b=x0(Y.val,Y.ixfe,"s"),b.XF=X[b.ixfe],O>0&&(b.z=te[b.ixfe>>8&63]),bi(b,e,r.opts.Date1904),M({c:Y.c,r:Y.r},b,e);break;case 0:case 512:ee===1&&(o=Y);break;case 252:u=Y;break;case 1054:if(D.biff==4){te[O++]=Y[1];for(var Dr=0;Dr<O+163&&nt[Dr]!=Y[1];++Dr);Dr>=163&&xa(Y[1],O+163)}else xa(Y[1],Y[0]);break;case 30:{te[O++]=Y;for(var yn=0;yn<O+163&&nt[yn]!=Y;++yn);yn>=163&&xa(Y,O+163)}break;case 229:ke=ke.concat(Y);break;case 93:Se[Y.cmo[0]]=D.lastobj=Y;break;case 438:D.lastobj.TxO=Y;break;case 127:D.lastobj.ImData=Y;break;case 440:for(S=Y[0].s.r;S<=Y[0].e.r;++S)for(w=Y[0].s.c;w<=Y[0].e.c;++w)y=e.dense?(s[S]||[])[w]:s[it({c:w,r:S})],y&&(y.l=Y[1]);break;case 2048:for(S=Y[0].s.r;S<=Y[0].e.r;++S)for(w=Y[0].s.c;w<=Y[0].e.c;++w)y=e.dense?(s[S]||[])[w]:s[it({c:w,r:S})],y&&y.l&&(y.l.Tooltip=Y[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;y=e.dense?(s[Y[0].r]||[])[Y[0].c]:s[it(Y[0])];var Un=Se[Y[2]];y||(e.dense?(s[Y[0].r]||(s[Y[0].r]=[]),y=s[Y[0].r][Y[0].c]={t:"z"}):y=s[it(Y[0])]={t:"z"},o.e.r=Math.max(o.e.r,Y[0].r),o.s.r=Math.min(o.s.r,Y[0].r),o.e.c=Math.max(o.e.c,Y[0].c),o.s.c=Math.min(o.s.c,Y[0].c)),y.c||(y.c=[]),k={a:Y[1],t:Un.TxO.t},y.c.push(k)}break;case 2173:QO(X[Y.ixfe],Y.ext);break;case 125:{if(!D.cellStyles)break;for(;Y.e>=Y.s;)De[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},Ce||(Ce=!0,lx(Y.w/256)),xo(De[Y.e+1])}break;case 520:{var $t={};Y.level!=null&&(Ne[Y.r]=$t,$t.level=Y.level),Y.hidden&&(Ne[Y.r]=$t,$t.hidden=!0),Y.hpt&&(Ne[Y.r]=$t,$t.hpt=Y.hpt,$t.hpx=Pc(Y.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||sl(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=Y;break;case 161:s["!margins"]||sl(s["!margins"]={}),s["!margins"].header=Y.header,s["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(A.Views[0].RTL=!0);break;case 146:G=Y;break;case 2198:L=Y;break;case 140:j=Y;break;case 442:h?C.CodeName=Y||C.name:A.WBProps.CodeName=Y||"ThisWorkbook";break}}else Ee||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),t.l+=xe}return r.SheetNames=kr(i).sort(function(Jr,ot){return Number(Jr)-Number(ot)}).map(function(Jr){return i[Jr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&J.forEach(function(Jr,ot){r.Sheets[r.SheetNames[ot]]["!autofilter"]=Jr}),r.Strings=u,r.SSF=lr(nt),D.enc&&(r.Encryption=D.enc),L&&(r.Themes=L),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),ne.names.length>0&&(A.Names=ne.names),r.Workbook=A,r}var ef={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function fV(t,e,r){var n=Ze.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=tw(n,kg,ef.DSI);for(var i in s)e[i]=s[i]}catch(h){if(r.WTF)throw h}var o=Ze.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var c=tw(o,Ag,ef.SI);for(var u in c)e[u]==null&&(e[u]=c[u])}catch(h){if(r.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(ik(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function hV(t,e){var r=[],n=[],s=[],i=0,o,c=Ny(kg,"n"),u=Ny(Ag,"n");if(t.Props)for(o=kr(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(u,o[i])?n:s).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=kr(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(u,o[i])?n:s).push([o[i],t.Custprops[o[i]]]);var h=[];for(i=0;i<s.length;++i)hk.indexOf(s[i][0])>-1||sk.indexOf(s[i][0])>-1||s[i][1]!=null&&h.push(s[i]);n.length&&Ze.utils.cfb_add(e,"/SummaryInformation",rw(n,ef.SI,u,Ag)),(r.length||h.length)&&Ze.utils.cfb_add(e,"/DocumentSummaryInformation",rw(r,ef.DSI,c,kg,h.length?h:null,ef.UDI))}function o4(t,e){e||(e={}),xx(e),B1(),e.codepage&&M1(e.codepage);var r,n;if(t.FullPaths){if(Ze.find(t,"/encryption"))throw new Error("File is password-protected");r=Ze.find(t,"!CompObj"),n=Ze.find(t,"/Workbook")||Ze.find(t,"/Book")}else{switch(e.type){case"base64":t=ws(ks(t));break;case"binary":t=ws(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}gn(t,0),n={content:t}}var s,i;if(r&&oV(r),e.bookProps&&!e.bookSheets)s={};else{var o=_t?"buffer":"array";if(n&&n.content)s=uV(n.content,e);else if((i=Ze.find(t,"PerfectOffice_MAIN"))&&i.content)s=nl.to_workbook(i.content,(e.type=o,e));else if((i=Ze.find(t,"NativeContent_MAIN"))&&i.content)s=nl.to_workbook(i.content,(e.type=o,e));else throw(i=Ze.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Ze.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=kL(t))}var c={};return t.FullPaths&&fV(t,c,e),s.Props=s.Custprops=c,e.bookFiles&&(s.cfb=t),s}function dV(t,e){var r=e||{},n=Ze.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ze.utils.cfb_add(n,s,l4(t,r)),r.biff==8&&(t.Props||t.Custprops)&&hV(t,n),r.biff==8&&t.vbaraw&&AL(n,Ze.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Af={0:{f:M9},1:{f:$9},2:{f:u7},3:{f:Z9},4:{f:X9},5:{f:o7},6:{f:m7},7:{f:n7},8:{f:E7},9:{f:w7},10:{f:_7},11:{f:y7},12:{f:K9},13:{f:h7},14:{f:t7},15:{f:Q9},16:{f:Zk},17:{f:x7},18:{f:i7},19:{f:J1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:xB},40:{},42:{},43:{f:mO},44:{f:dO},45:{f:vO},46:{f:yO},47:{f:_O},48:{},49:{f:jD},50:{},51:{f:eL},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Tk},62:{f:p7},63:{f:cL},64:{f:B7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:P7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:W9},148:{f:j9,p:16},151:{f:I7},152:{},153:{f:pB},154:{},155:{},156:{f:hB},157:{},158:{},159:{T:1,f:b5},160:{T:-1},161:{T:1,f:Sl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:T7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:JO},336:{T:-1},337:{f:nL,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Sg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ek},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:F7},427:{f:b7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:R7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:z9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:A7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Sg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yL},633:{T:1},634:{T:-1},635:{T:1,f:vL},636:{T:-1},637:{f:HD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:tB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:V7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Rg={6:{f:Vm},10:{f:Qa},12:{f:jr},13:{f:jr},14:{f:Fr},15:{f:Fr},16:{f:Ln},17:{f:Fr},18:{f:Fr},19:{f:jr},20:{f:lw},21:{f:lw},23:{f:Ek},24:{f:uw},25:{f:Fr},26:{},27:{},28:{f:V8},29:{},34:{f:Fr},35:{f:cw},38:{f:Ln},39:{f:Ln},40:{f:Ln},41:{f:Ln},42:{f:Fr},43:{f:Fr},47:{f:Q5},49:{f:h8},51:{f:jr},60:{},61:{f:o8},64:{f:Fr},65:{f:f8},66:{f:jr},77:{},80:{},81:{},82:{},85:{f:jr},89:{},90:{},91:{},92:{f:YP},93:{f:z8},94:{},95:{f:Fr},96:{},97:{},99:{f:Fr},125:{f:Tk},128:{f:C8},129:{f:JP},130:{f:jr},131:{f:Fr},132:{f:Fr},133:{f:ZP},134:{},140:{f:Y8},141:{f:jr},144:{},146:{f:Z8},151:{},152:{},153:{},154:{},155:{},156:{f:jr},157:{},158:{},160:{f:a5},161:{f:r5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:T8},190:{f:S8},193:{f:Qa},197:{},198:{},199:{},200:{},201:{},202:{f:Fr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:jr},220:{},221:{f:Fr},222:{},224:{f:A8},225:{f:XP},226:{f:Qa},227:{},229:{f:j8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:t8},253:{f:p8},255:{f:n8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:dk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Fr},353:{f:Qa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:R8},431:{f:Fr},432:{},433:{},434:{},437:{},438:{f:$8},439:{f:Fr},440:{f:G8},441:{},442:{f:qf},443:{},444:{f:jr},445:{},446:{},448:{f:Qa},449:{f:a8,r:2},450:{f:Qa},512:{f:iw},513:{f:i5},515:{f:b8},516:{f:g8},517:{f:ow},519:{f:o5},520:{f:s8},523:{},545:{f:fw},549:{f:sw},566:{},574:{f:c8},638:{f:E8},659:{},1048:{},1054:{f:v8},1084:{},1212:{f:L8},2048:{f:q8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:p0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:e5,r:12},2173:{f:YO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Fr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:O8,r:12},2197:{},2198:{f:HO,r:12},2199:{},2200:{},2201:{},2202:{f:M8,r:12},2203:{f:Qa},2204:{},2205:{},2206:{},2207:{},2211:{f:i8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:jr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:n5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:J8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:iw},1:{},2:{f:h5},3:{f:u5},4:{f:c5},5:{f:ow},7:{f:p5},8:{},9:{f:p0},11:{},22:{f:jr},30:{f:y8},31:{},32:{},33:{f:fw},36:{},37:{f:sw},50:{f:m5},62:{},52:{},67:{},68:{f:jr},69:{},86:{},126:{},127:{f:l5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:g5},223:{},234:{},354:{},421:{},518:{f:Vm},521:{f:p0},536:{f:uw},547:{f:cw},561:{},579:{},1030:{f:Vm},1033:{f:p0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ue(t,e,r,n){var s=e;if(!isNaN(s)){var i=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&X1(r)&&t.push(r)}}function pV(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return Ue(t,e,r,s);var i=e;if(!isNaN(i)){for(var o=r.parts||[],c=0,u=0,h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;var d=t.next(4);for(d.write_shift(2,i),d.write_shift(2,h),t.push(r.slice(u,u+h)),u+=h;u<s;){for(d=t.next(4),d.write_shift(2,60),h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;d.write_shift(2,h),t.push(r.slice(u,u+h)),u+=h}}}function Jf(t,e,r){return t||(t=me(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function mV(t,e,r,n){var s=me(9);return Jf(s,t,e),pk(r,n||"b",s),s}function gV(t,e,r){var n=me(8+2*r.length);return Jf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function xV(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?Qr(or(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Ue(t,2,d5(r,n,s)):Ue(t,3,f5(r,n,s));return;case"b":case"e":Ue(t,5,mV(r,n,e.v,e.t));return;case"s":case"str":Ue(t,4,gV(r,n,(e.v||"").slice(0,255)));return}Ue(t,1,Jf(null,r,n))}function vV(t,e,r,n){var s=Array.isArray(e),i=Ot(e["!ref"]||"A1"),o,c="",u=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=xt(i)}for(var h=i.s.r;h<=i.e.r;++h){c=Nr(h);for(var d=i.s.c;d<=i.e.c;++d){h===i.s.r&&(u[d]=xr(d)),o=u[d]+c;var g=s?(e[h]||[])[d]:e[o];g&&xV(t,g,h,d)}}}function _V(t,e){for(var r=e||{},n=ls(),s=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ue(n,r.biff==4?1033:r.biff==3?521:9,ix(t,16,r)),vV(n,t.Sheets[t.SheetNames[s]],s,r),Ue(n,10),n.end()}function yV(t,e,r){Ue(t,49,d8({sz:12,name:"Arial"},r))}function wV(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Ue(t,1054,_8(s,e[s],r))})}function EV(t,e){var r=me(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ue(t,2151,r),r=me(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),_k(Ot(e["!ref"]||"A1"),r),r.write_shift(4,4),Ue(t,2152,r)}function TV(t,e){for(var r=0;r<16;++r)Ue(t,224,aw({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ue(t,224,aw(n,0,e))})}function SV(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ue(t,440,K8(n)),n[1].Tooltip&&Ue(t,2048,X8(n))}delete e["!links"]}function kV(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&Ue(t,125,t5(jd(s,n),s))})}}function AV(t,e,r,n,s){var i=16+ko(s.cellXfs,e,s);if(e.v==null&&!e.bf){Ue(t,513,ml(r,n,i));return}if(e.bf)Ue(t,6,JM(e,r,n,s,i));else switch(e.t){case"d":case"n":var o=e.t=="d"?Qr(or(e.v)):e.v;Ue(t,515,N8(r,n,o,i));break;case"b":case"e":Ue(t,517,F8(r,n,e.v,i,s,e.t));break;case"s":case"str":if(s.bookSST){var c=dx(s.Strings,e.v,s.revStrings);Ue(t,253,m8(r,n,c,i))}else Ue(t,516,x8(r,n,(e.v||"").slice(0,255),i,s));break;default:Ue(t,513,ml(r,n,i))}}function CV(t,e,r){var n=ls(),s=r.SheetNames[t],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},c=(o.Sheets||[])[t]||{},u=Array.isArray(i),h=e.biff==8,d,g="",x=[],y=Ot(i["!ref"]||"A1"),k=h?65536:16384;if(y.e.c>255||y.e.r>=k){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,k-1)}Ue(n,2057,ix(r,16,e)),Ue(n,13,zs(1)),Ue(n,12,zs(100)),Ue(n,15,$n(!0)),Ue(n,17,$n(!1)),Ue(n,16,dl(.001)),Ue(n,95,$n(!0)),Ue(n,42,$n(!1)),Ue(n,43,$n(!1)),Ue(n,130,zs(1)),Ue(n,128,I8()),Ue(n,131,$n(!1)),Ue(n,132,$n(!1)),h&&kV(n,i["!cols"]),Ue(n,512,w8(y,e)),h&&(i["!links"]=[]);for(var w=y.s.r;w<=y.e.r;++w){g=Nr(w);for(var S=y.s.c;S<=y.e.c;++S){w===y.s.r&&(x[S]=xr(S)),d=x[S]+g;var N=u?(i[w]||[])[S]:i[d];N&&(AV(n,N,w,S,e),h&&N.l&&i["!links"].push([d,N.l]))}}var B=c.CodeName||c.name||s;return h&&Ue(n,574,u8((o.Views||[])[0])),h&&(i["!merges"]||[]).length&&Ue(n,229,U8(i["!merges"])),h&&SV(n,i),Ue(n,442,mk(B)),h&&EV(n,i),Ue(n,10),n.end()}function IV(t,e,r){var n=ls(),s=(t||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},c=r.biff==8,u=r.biff==5;if(Ue(n,2057,ix(t,5,r)),r.bookType=="xla"&&Ue(n,135),Ue(n,225,c?zs(1200):null),Ue(n,193,FP(2)),u&&Ue(n,191),u&&Ue(n,192),Ue(n,226),Ue(n,92,QP("SheetJS",r)),Ue(n,66,zs(c?1200:1252)),c&&Ue(n,353,zs(0)),c&&Ue(n,448),Ue(n,317,s5(t.SheetNames.length)),c&&t.vbaraw&&Ue(n,211),c&&t.vbaraw){var h=o.CodeName||"ThisWorkbook";Ue(n,442,mk(h))}Ue(n,156,zs(17)),Ue(n,25,$n(!1)),Ue(n,18,$n(!1)),Ue(n,19,zs(0)),c&&Ue(n,431,$n(!1)),c&&Ue(n,444,zs(0)),Ue(n,61,l8()),Ue(n,64,$n(!1)),Ue(n,141,zs(0)),Ue(n,34,$n(aB(t)=="true")),Ue(n,14,$n(!0)),c&&Ue(n,439,$n(!1)),Ue(n,218,zs(0)),yV(n,t,r),wV(n,t.SSF,r),TV(n,r),c&&Ue(n,352,$n(!1));var d=n.end(),g=ls();c&&Ue(g,140,Q8()),c&&r.Strings&&pV(g,252,r8(r.Strings)),Ue(g,10);var x=g.end(),y=ls(),k=0,w=0;for(w=0;w<t.SheetNames.length;++w)k+=(c?12:11)+(c?2:1)*t.SheetNames[w].length;var S=d.length+k+x.length;for(w=0;w<t.SheetNames.length;++w){var N=i[w]||{};Ue(y,133,e8({pos:S,hs:N.Hidden||0,dt:0,name:t.SheetNames[w]},r)),S+=e[w].length}var B=y.end();if(k!=B.length)throw new Error("BS8 "+k+" != "+B.length);var b=[];return d.length&&b.push(d),B.length&&b.push(B),x.length&&b.push(x),an(b)}function FV(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=lr(nt)),t&&t.SSF&&($c(),Dd(t.SSF),r.revssf=Od(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,vx(r),r.cellXfs=[],ko(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=CV(s,r,t);return n.unshift(IV(t,n,r)),an(n)}function l4(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=cs(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return FV(t,e);case 4:case 3:case 2:return _V(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function ww(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),o=s.index,c=i&&i.index||t.length,u=dD(t.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,d=0,g=0,x=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(o=0;o<u.length;++o){var w=u[o].trim(),S=w.slice(0,3).toLowerCase();if(S=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}d=0;continue}if(!(S!="<td"&&S!="<th")){var N=w.split(/<\/t[dh]>/i);for(c=0;c<N.length;++c){var B=N[c].trim();if(B.match(/<t[dh]/i)){for(var b=B,j=0;b.charAt(0)=="<"&&(j=b.indexOf(">"))>-1;)b=b.slice(j+1);for(var X=0;X<k.length;++X){var G=k[X];G.s.c==d&&G.s.r<h&&h<=G.e.r&&(d=G.e.c+1,X=-1)}var A=lt(B.slice(0,B.indexOf(">")));x=A.colspan?+A.colspan:1,((g=+A.rowspan)>1||x>1)&&k.push({s:{r:h,c:d},e:{r:h+(g||1)-1,c:d+x-1}});var C=A.t||A["data-t"]||"";if(!b.length){d+=x;continue}if(b=RS(b),y.s.r>h&&(y.s.r=h),y.e.r<h&&(y.e.r=h),y.s.c>d&&(y.s.c=d),y.e.c<d&&(y.e.c=d),!b.length){d+=x;continue}var F={t:"s",v:b};r.raw||!b.trim().length||C=="s"||(b==="TRUE"?F={t:"b",v:!0}:b==="FALSE"?F={t:"b",v:!1}:isNaN(li(b))?isNaN(Rc(b).getDate())||(F={t:"d",v:or(b)},r.cellDates||(F={t:"n",v:Qr(F.v)}),F.z=r.dateNF||nt[14]):F={t:"n",v:li(b)}),r.dense?(n[h]||(n[h]=[]),n[h][d]=F):n[it({r:h,c:d})]=F,d+=x}}}}return n["!ref"]=xt(y),k.length&&(n["!merges"]=k),n}function bV(t,e,r,n){for(var s=t["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var c=0,u=0,h=0;h<s.length;++h)if(!(s[h].s.r>r||s[h].s.c>o)&&!(s[h].e.r<r||s[h].e.c<o)){if(s[h].s.r<r||s[h].s.c<o){c=-1;break}c=s[h].e.r-s[h].s.r+1,u=s[h].e.c-s[h].s.c+1;break}if(!(c<0)){var d=it({r,c:o}),g=n.dense?(t[r]||[])[o]:t[d],x=g&&g.v!=null&&(g.h||G1(g.w||(Ta(g),g.w)||""))||"",y={};c>1&&(y.rowspan=c),u>1&&(y.colspan=u),n.editable?x='<span contenteditable="true">'+x+"</span>":g&&(y["data-t"]=g&&g.t||"z",g.v!=null&&(y["data-v"]=g.v),g.z!=null&&(y["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+g.l.Target+'">'+x+"</a>")),y.id=(n.id||"sjs")+"-"+d,i.push(Ve("td",x,y))}}var k="<tr>";return k+i.join("")+"</tr>"}var NV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',RV="</body></html>";function DV(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return So(ww(r[0],e),e);var n=Ex();return r.forEach(function(s,i){Tx(n,ww(s,e),"Sheet"+(i+1))}),n}function PV(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function c4(t,e){var r=e||{},n=r.header!=null?r.header:NV,s=r.footer!=null?r.footer:RV,i=[n],o=cs(t["!ref"]);r.dense=Array.isArray(t),i.push(PV(t,o,r));for(var c=o.s.r;c<=o.e.r;++c)i.push(bV(t,o,c,r));return i.push("</table>"+s),i.join("")}function u4(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?vr(n.origin):n.origin;s=o.r,i=o.c}var c=e.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var d=cs(t["!ref"]);h.s.r=Math.min(h.s.r,d.s.r),h.s.c=Math.min(h.s.c,d.s.c),h.e.r=Math.max(h.e.r,d.e.r),h.e.c=Math.max(h.e.c,d.e.c),s==-1&&(h.e.r=s=d.e.r+1)}var g=[],x=0,y=t["!rows"]||(t["!rows"]=[]),k=0,w=0,S=0,N=0,B=0,b=0;for(t["!cols"]||(t["!cols"]=[]);k<c.length&&w<u;++k){var j=c[k];if(Ew(j)){if(n.display)continue;y[w]={hidden:!0}}var X=j.children;for(S=N=0;S<X.length;++S){var G=X[S];if(!(n.display&&Ew(G))){var A=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):RS(G.innerHTML),C=G.getAttribute("data-z")||G.getAttribute("z");for(x=0;x<g.length;++x){var F=g[x];F.s.c==N+i&&F.s.r<w+s&&w+s<=F.e.r&&(N=F.e.c+1-i,x=-1)}b=+G.getAttribute("colspan")||1,((B=+G.getAttribute("rowspan")||1)>1||b>1)&&g.push({s:{r:w+s,c:N+i},e:{r:w+s+(B||1)-1,c:N+i+(b||1)-1}});var V={t:"s",v:A},M=G.getAttribute("data-t")||G.getAttribute("t")||"";A!=null&&(A.length==0?V.t=M||"z":n.raw||A.trim().length==0||M=="s"||(A==="TRUE"?V={t:"b",v:!0}:A==="FALSE"?V={t:"b",v:!1}:isNaN(li(A))?isNaN(Rc(A).getDate())||(V={t:"d",v:or(A)},n.cellDates||(V={t:"n",v:Qr(V.v)}),V.z=n.dateNF||nt[14]):V={t:"n",v:li(A)})),V.z===void 0&&C!=null&&(V.z=C);var D="",L=G.getElementsByTagName("A");if(L&&L.length)for(var ke=0;ke<L.length&&!(L[ke].hasAttribute("href")&&(D=L[ke].getAttribute("href"),D.charAt(0)!="#"));++ke);D&&D.charAt(0)!="#"&&(V.l={Target:D}),n.dense?(t[w+s]||(t[w+s]=[]),t[w+s][N+i]=V):t[it({c:N+i,r:w+s})]=V,h.e.c<N+i&&(h.e.c=N+i),N+=b}}++w}return g.length&&(t["!merges"]=(t["!merges"]||[]).concat(g)),h.e.r=Math.max(h.e.r,w-1+s),t["!ref"]=xt(h),w>=u&&(t["!fullref"]=xt((h.e.r=c.length-k+w-1+s,h))),t}function f4(t,e){var r=e||{},n=r.dense?[]:{};return u4(n,t,e)}function OV(t,e){return So(f4(t,e),e)}function Ew(t){var e="",r=LV(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function LV(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function MV(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Pt(e.replace(/<[^>]*>/g,""));return[r]}var Tw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function h4(t,e){var r=e||{},n=K1(t),s=[],i,o,c={name:""},u="",h=0,d,g,x={},y=[],k=r.dense?[]:{},w,S,N={value:""},B="",b=0,j=[],X=-1,G=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,F={},V=[],M={},D=0,L=0,ke=[],Se=1,De=1,Ne=[],Ce={Names:[]},ne={},ye=["",""],ee=[],O={},te="",J=0,Z=!1,oe=!1,_e=0;for(yf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=yf.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?k["!ref"]=xt(A):k["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(k["!fullref"]=k["!ref"],A.e.r=r.sheetRows-1,k["!ref"]=xt(A)),V.length&&(k["!merges"]=V),ke.length&&(k["!rows"]=ke),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),y.push(d.name),x[d.name]=k,oe=!1):w[0].charAt(w[0].length-2)!=="/"&&(d=lt(w[0],!1),X=G=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,k=r.dense?[]:{},V=[],ke=[],oe=!0);break;case"table-row-group":w[1]==="/"?--C:++C;break;case"table-row":case"":if(w[1]==="/"){X+=Se,Se=1;break}if(g=lt(w[0],!1),g.?X=g.-1:X==-1&&(X=0),Se=+g["number-rows-repeated"]||1,Se<10)for(_e=0;_e<Se;++_e)C>0&&(ke[X+_e]={level:C});G=-1;break;case"covered-table-cell":w[1]!=="/"&&++G,r.sheetStubs&&(r.dense?(k[X]||(k[X]=[]),k[X][G]={t:"z"}):k[it({r:X,c:G})]={t:"z"}),B="",j=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++G,N=lt(w[0],!1),De=parseInt(N["number-columns-repeated"]||"1",10),S={t:"z",v:null},N.formula&&r.cellFormula!=!1&&(S.f=vw(Pt(N.formula))),(N.||N["value-type"])=="string"&&(S.t="s",S.v=Pt(N["string-value"]||""),r.dense?(k[X]||(k[X]=[]),k[X][G]=S):k[it({r:X,c:G})]=S),G+=De-1;else if(w[1]!=="/"){++G,B="",b=0,j=[],De=1;var ve=Se?X+Se-1:X;if(G>A.e.c&&(A.e.c=G),G<A.s.c&&(A.s.c=G),X<A.s.r&&(A.s.r=X),ve>A.e.r&&(A.e.r=ve),N=lt(w[0],!1),ee=[],O={},S={t:N.||N["value-type"],v:null},r.cellFormula)if(N.formula&&(N.formula=Pt(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(D=parseInt(N["number-matrix-rows-spanned"],10)||0,L=parseInt(N["number-matrix-columns-spanned"],10)||0,M={s:{r:X,c:G},e:{r:X+D-1,c:G+L-1}},S.F=xt(M),Ne.push([M,S.F])),N.formula)S.f=vw(N.formula);else for(_e=0;_e<Ne.length;++_e)X>=Ne[_e][0].s.r&&X<=Ne[_e][0].e.r&&G>=Ne[_e][0].s.c&&G<=Ne[_e][0].e.c&&(S.F=Ne[_e][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(D=parseInt(N["number-rows-spanned"],10)||0,L=parseInt(N["number-columns-spanned"],10)||0,M={s:{r:X,c:G},e:{r:X+D-1,c:G+L-1}},V.push(M)),N["number-columns-repeated"]&&(De=parseInt(N["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=ir(N["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(N.value);break;case"percentage":S.t="n",S.v=parseFloat(N.value);break;case"currency":S.t="n",S.v=parseFloat(N.value);break;case"date":S.t="d",S.v=or(N["date-value"]),r.cellDates||(S.t="n",S.v=Qr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=uD(N["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Ld(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(N.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",N["string-value"]!=null&&(B=Pt(N["string-value"]),j=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(Z=!1,S.t==="s"&&(S.v=B||"",j.length&&(S.R=j),Z=b==0),ne.Target&&(S.l=ne),ee.length>0&&(S.c=ee,ee=[]),B&&r.cellText!==!1&&(S.w=B),Z&&(S.t="z",delete S.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=X))for(var xe=0;xe<Se;++xe){if(De=parseInt(N["number-columns-repeated"]||"1",10),r.dense)for(k[X+xe]||(k[X+xe]=[]),k[X+xe][G]=xe==0?S:lr(S);--De>0;)k[X+xe][G+De]=lr(S);else for(k[it({r:X+xe,c:G})]=S;--De>0;)k[it({r:X+xe,c:G+De})]=lr(S);A.e.c<=G&&(A.e.c=G)}De=parseInt(N["number-columns-repeated"]||"1",10),G+=De-1,De=0,S={},B="",j=[]}ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((i=s.pop())[0]!==w[3])throw"Bad state: "+i}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((i=s.pop())[0]!==w[3])throw"Bad state: "+i;O.t=B,j.length&&(O.R=j),O.a=te,ee.push(O)}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);te="",J=0,B="",b=0,j=[];break;case"creator":w[1]==="/"?te=n.slice(J,w.index):J=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((i=s.pop())[0]!==w[3])throw"Bad state: "+i}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);B="",b=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(F[c.name]=u,(i=s.pop())[0]!==w[3])throw"Bad state: "+i}else w[0].charAt(w[0].length-2)!=="/"&&(u="",c=lt(w[0],!1),s.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=lt(w[0],!1),u+=Tw[w[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=lt(w[0],!1),u+=Tw[w[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(h,w.index);break}else h=w.index+w[0].length;break;case"named-range":o=lt(w[0],!1),ye=jm(o["cell-range-address"]);var Ee={Name:o.name,Ref:ye[0]+"!"+ye[1]};oe&&(Ee.Sheet=y.length),Ce.Names.push(Ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(w[1]==="/"&&(!N||!N["string-value"])){var st=MV(n.slice(b,w.index));B=(B.length>0?B+`
`:"")+st[0]}else lt(w[0],!1),b=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{ye=jm(lt(w[0])["target-range-address"]),x[ye[0]]["!autofilter"]={ref:ye[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(ne=lt(w[0],!1),!ne.href)break;ne.Target=Pt(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(ye=jm(ne.Target.slice(1)),ne.Target="#"+ye[0]+"!"+ye[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var Y={Sheets:x,SheetNames:y,Workbook:Ce};return r.bookSheets&&delete Y.Sheets,Y}function Sw(t,e){e=e||{},Us(t,"META-INF/manifest.xml")&&uP(Vr(t,"META-INF/manifest.xml"),e);var r=Es(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=h4(Qt(r),e);return Us(t,"meta.xml")&&(n.Props=rk(Vr(t,"meta.xml"))),n}function kw(t,e){return h4(t,e)}var BV=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+_f({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Rr+e}})(),Aw=(function(){var t=function(i){return Yt(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,c){var u=[];u.push('      <table:table table:name="'+Yt(o.SheetNames[c])+`" table:style-name="ta1">
`);var h=0,d=0,g=cs(i["!ref"]||"A1"),x=i["!merges"]||[],y=0,k=Array.isArray(i);if(i["!cols"])for(d=0;d<=g.e.c;++d)u.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var w="",S=i["!rows"]||[];for(h=0;h<g.s.r;++h)w=S[h]?' table:style-name="ro'+S[h].ods+'"':"",u.push("        <table:table-row"+w+`></table:table-row>
`);for(;h<=g.e.r;++h){for(w=S[h]?' table:style-name="ro'+S[h].ods+'"':"",u.push("        <table:table-row"+w+`>
`),d=0;d<g.s.c;++d)u.push(e);for(;d<=g.e.c;++d){var N=!1,B={},b="";for(y=0;y!=x.length;++y)if(!(x[y].s.c>d)&&!(x[y].s.r>h)&&!(x[y].e.c<d)&&!(x[y].e.r<h)){(x[y].s.c!=d||x[y].s.r!=h)&&(N=!0),B["table:number-columns-spanned"]=x[y].e.c-x[y].s.c+1,B["table:number-rows-spanned"]=x[y].e.r-x[y].s.r+1;break}if(N){u.push(r);continue}var j=it({r:h,c:d}),X=k?(i[h]||[])[d]:i[j];if(X&&X.f&&(B["table:formula"]=Yt(s9(X.f)),X.F&&X.F.slice(0,j.length)==j)){var G=cs(X.F);B["table:number-matrix-columns-spanned"]=G.e.c-G.s.c+1,B["table:number-matrix-rows-spanned"]=G.e.r-G.s.r+1}if(!X){u.push(e);continue}switch(X.t){case"b":b=X.v?"TRUE":"FALSE",B["office:value-type"]="boolean",B["office:boolean-value"]=X.v?"true":"false";break;case"n":b=X.w||String(X.v||0),B["office:value-type"]="float",B["office:value"]=X.v||0;break;case"s":case"str":b=X.v==null?"":X.v,B["office:value-type"]="string";break;case"d":b=X.w||or(X.v).toISOString(),B["office:value-type"]="date",B["office:date-value"]=or(X.v).toISOString(),B["table:style-name"]="ce1";break;default:u.push(e);continue}var A=t(b);if(X.l&&X.l.Target){var C=X.l.Target;C=C.charAt(0)=="#"?"#"+i9(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),A=Ve("text:a",A,{"xlink:href":C.replace(/&/g,"&amp;")})}u.push("          "+Ve("table:table-cell",Ve("text:p",A,{}),B)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var d=0;d<h["!cols"].length;++d)if(h["!cols"][d]){var g=h["!cols"][d];if(g.width==null&&g.wpx==null&&g.wch==null)continue;xo(g),g.ods=c;var x=h["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),i.push(`  </style:style>
`),++c}}});var u=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var d=0;d<h["!rows"].length;++d)if(h["!rows"][d]){h["!rows"][d].ods=u;var g=h["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),i.push(`  </style:style>
`),++u}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,c){var u=[Rr],h=_f({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=_f({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(u.push("<office:document"+h+d+`>
`),u.push(tk().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+h+`>
`),s(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)u.push(n(o.Sheets[o.SheetNames[g]],o,g));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),c.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function d4(t,e){if(e.bookType=="fods")return Aw(t,e);var r=W1(),n="",s=[],i=[];return n="mimetype",vt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",vt(r,n,Aw(t,e)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",vt(r,n,BV(t,e)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",vt(r,n,Rr+tk()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",vt(r,n,dP(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",vt(r,n,fP(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function gl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Dg(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Qt(To(t))}function VV(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):ws(Oi(t))}function jV(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function _o(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function Cw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function UV(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function zV(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)t[e+i]=s&255;t[e+15]|=r>=0?0:128}function Cf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function qt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Sr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Mt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Cf(t,r),i=s&7;s=Math.floor(s/8);var o=0,c;if(s==0)break;switch(i){case 0:{for(var u=r[0];t[r[0]++]>=128;);c=t.slice(u,r[0])}break;case 5:o=4,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Cf(t,r),c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var h={data:c,type:i};e[s]==null?e[s]=[h]:e[s].push(h)}return e}function pn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(qt(n*8+s.type)),s.type==2&&e.push(qt(s.data.length)),e.push(s.data))})}),_o(e)}function gx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Vs(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Cf(t,n),i=Mt(t.slice(n[0],n[0]+s));n[0]+=s;var o={id:Sr(i[1][0].data),messages:[]};i[2].forEach(function(c){var u=Mt(c.data),h=Sr(u[3][0].data);o.messages.push({meta:u,data:t.slice(n[0],n[0]+h)}),n[0]+=h}),(e=i[3])!=null&&e[0]&&(o.merge=Sr(i[3][0].data)>>>0>0),r.push(o)}return r}function ic(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:qt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:qt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:qt(o.data.length)}],n[2].push({data:pn(o.meta),type:2})});var i=pn(n);e.push(qt(i.length)),e.push(i),s.forEach(function(o){return e.push(o)})}),_o(e)}function WV(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Cf(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=e[r[0]],c>1&&(o|=e[r[0]+1]<<8),c>2&&(o|=e[r[0]+2]<<16),c>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}s.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,h=0;if(i==1?(h=(e[r[0]]>>2&7)+4,u=(e[r[0]++]&224)<<3,u|=e[r[0]++]):(h=(e[r[0]++]>>2)+1,i==2?(u=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(u=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[_o(s)],u==0)throw new Error("Invalid offset 0");if(u>s[0].length)throw new Error("Invalid offset beyond length");if(h>=u)for(s.push(s[0].slice(-u)),h-=u;h>=s[s.length-1].length;)s.push(s[s.length-1]),h-=s[s.length-1].length;s.push(s[0].slice(-u,-u+h))}}var d=_o(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function js(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(WV(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return _o(e)}function ac(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var i=qt(n),o=i.length;e.push(i),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return _o(e)}function HV(t,e,r,n){var s=gl(t),i=s.getUint32(4,!0),o=(n>1?12:8)+Cw(i&(n>1?3470:398))*4,c=-1,u=-1,h=NaN,d=new Date(2001,0,1);i&512&&(c=s.getUint32(o,!0),o+=4),o+=Cw(i&(n>1?12288:4096))*4,i&16&&(u=s.getUint32(o,!0),o+=4),i&32&&(h=s.getFloat64(o,!0),o+=8),i&64&&(d.setTime(d.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var g;switch(t[2]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:e[u]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(c>-1)g={t:"s",v:r[c]};else if(u>-1)g={t:"s",v:e[u]};else if(!isNaN(h))g={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return g}function $V(t,e,r){var n=gl(t),s=n.getUint32(8,!0),i=12,o=-1,c=-1,u=NaN,h=NaN,d=new Date(2001,0,1);s&1&&(u=UV(t,i),i+=16),s&2&&(h=n.getFloat64(i,!0),i+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(c=n.getUint32(i,!0),i+=4),s&16&&(o=n.getUint32(i,!0),i+=4);var g;switch(t[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:e[c]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return g}function zm(t,e){var r=new Uint8Array(32),n=gl(r),s=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,zV(r,s,t.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),i|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,s)}function Wm(t,e){var r=new Uint8Array(32),n=gl(r),s=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),i|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,s)}function GV(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return HV(t,e,r,t[0]);case 5:return $V(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Rn(t){var e=Mt(t);return Cf(e[1][0].data)}function Iw(t,e){var r=Mt(e.data),n=Sr(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var c=Mt(o.data),u=Sr(c[1][0].data)>>>0;switch(n){case 1:i[u]=Dg(c[3][0].data);break;case 8:{var h=t[Rn(c[9][0].data)][0],d=Mt(h.data),g=t[Rn(d[1][0].data)][0],x=Sr(g.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var y=Mt(g.data);i[u]=y[3].map(function(k){return Dg(k.data)}).join("")}break}}),i}function KV(t,e){var r,n,s,i,o,c,u,h,d,g,x,y,k,w,S=Mt(t),N=Sr(S[1][0].data)>>>0,B=Sr(S[2][0].data)>>>0,b=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&Sr(S[8][0].data)>0||!1,j,X;if((i=(s=S[7])==null?void 0:s[0])!=null&&i.data&&e!=0)j=(c=(o=S[7])==null?void 0:o[0])==null?void 0:c.data,X=(h=(u=S[6])==null?void 0:u[0])==null?void 0:h.data;else if((g=(d=S[4])==null?void 0:d[0])!=null&&g.data&&e!=1)j=(y=(x=S[4])==null?void 0:x[0])==null?void 0:y.data,X=(w=(k=S[3])==null?void 0:k[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var G=b?4:1,A=gl(j),C=[],F=0;F<j.length/2;++F){var V=A.getUint16(F*2,!0);V<65535&&C.push([F,V])}if(C.length!=B)throw"Expected ".concat(B," cells, found ").concat(C.length);var M=[];for(F=0;F<C.length-1;++F)M[C[F][0]]=X.subarray(C[F][1]*G,C[F+1][1]*G);return C.length>=1&&(M[C[C.length-1][0]]=X.subarray(C[C.length-1][1]*G)),{R:N,cells:M}}function qV(t,e){var r,n=Mt(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Sr(n[7][0].data)>>>0>0?1:0:-1,i=gx(n[5],function(o){return KV(o,s)});return{nrows:Sr(n[4][0].data)>>>0,data:i.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(u,h){if(o[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));o[c.R][h]=u}),o},[])}}function XV(t,e,r){var n,s=Mt(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Sr(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Sr(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=xt(i);var o=Mt(s[4][0].data),c=Iw(t,t[Rn(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?Iw(t,t[Rn(o[17][0].data)][0]):[],h=Mt(o[3][0].data),d=0;h[1].forEach(function(g){var x=Mt(g.data),y=t[Rn(x[2][0].data)][0],k=Sr(y.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var w=qV(t,y);w.data.forEach(function(S,N){S.forEach(function(B,b){var j=it({r:d+N,c:b}),X=GV(B,c,u);X&&(r[j]=X)})}),d+=w.nrows})}function YV(t,e){var r=Mt(e.data),n={"!ref":"A1"},s=t[Rn(r[2][0].data)],i=Sr(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return XV(t,s[0],n),n}function QV(t,e){var r,n=Mt(e.data),s={name:(r=n[1])!=null&&r[0]?Dg(n[1][0].data):"",sheets:[]},i=gx(n[2],Rn);return i.forEach(function(o){t[o].forEach(function(c){var u=Sr(c.meta[1][0].data);u==6e3&&s.sheets.push(YV(t,c))})}),s}function JV(t,e){var r=Ex(),n=Mt(e.data),s=gx(n[1],Rn);if(s.forEach(function(i){t[i].forEach(function(o){var c=Sr(o.meta[1][0].data);if(c==2){var u=QV(t,o);u.sheets.forEach(function(h,d){Tx(r,h,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Hm(t){var e,r,n,s,i={},o=[];if(t.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var h;try{h=js(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var d;try{d=Vs(h)}catch(g){return console.log("## "+(g.message||g))}d.forEach(function(g){i[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var c=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Sr(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||o.forEach(function(u){i[u].forEach(function(h){var d=Sr(h.meta[1][0].data)>>>0;if(d==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return JV(i,c)}function ZV(t,e,r){var n,s,i,o;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&Sr(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var u=0,h=gl(t[7][0].data),d=0,g=[],x=gl(t[4][0].data),y=0,k=[],w=0;w<e.length;++w){if(e[w]==null){h.setUint16(w*2,65535,!0),x.setUint16(w*2,65535);continue}h.setUint16(w*2,d,!0),x.setUint16(w*2,y,!0);var S,N;switch(typeof e[w]){case"string":S=zm({t:"s",v:e[w]},r),N=Wm({t:"s",v:e[w]},r);break;case"number":S=zm({t:"n",v:e[w]},r),N=Wm({t:"n",v:e[w]},r);break;case"boolean":S=zm({t:"b",v:e[w]},r),N=Wm({t:"b",v:e[w]},r);break;default:throw new Error("Unsupported value "+e[w])}g.push(S),d+=S.length,k.push(N),y+=N.length,++u}for(t[2][0].data=qt(u);w<t[7][0].data.length/2;++w)h.setUint16(w*2,65535,!0),x.setUint16(w*2,65535,!0);return t[6][0].data=_o(g),t[3][0].data=_o(k),u}function ej(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=cs(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(xt(n)));var i=cd(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(te){return te.forEach(function(J){typeof J=="string"&&o.push(J)})});var c={},u=[],h=Ze.read(e.numbers,{type:"base64"});h.FileIndex.map(function(te,J){return[te,h.FullPaths[J]]}).forEach(function(te){var J=te[0],Z=te[1];if(J.type==2&&J.name.match(/\.iwa/)){var oe=J.content,_e=js(oe),ve=Vs(_e);ve.forEach(function(xe){u.push(xe.id),c[xe.id]={deps:[],location:Z,type:Sr(xe.messages[0].meta[1][0].data)}})}}),u.sort(function(te,J){return te-J});var d=u.filter(function(te){return te>1}).map(function(te){return[te,qt(te)]});h.FileIndex.map(function(te,J){return[te,h.FullPaths[J]]}).forEach(function(te){var J=te[0];if(te[1],!!J.name.match(/\.iwa/)){var Z=Vs(js(J.content));Z.forEach(function(oe){oe.messages.forEach(function(_e){d.forEach(function(ve){oe.messages.some(function(xe){return Sr(xe.meta[1][0].data)!=11006&&jV(xe.data,ve[1])})&&c[ve[0]].deps.push(oe.id)})})})}});for(var g=Ze.find(h,c[1].location),x=Vs(js(g.content)),y,k=0;k<x.length;++k){var w=x[k];w.id==1&&(y=w)}var S=Rn(Mt(y.messages[0].data)[1][0].data);for(g=Ze.find(h,c[S].location),x=Vs(js(g.content)),k=0;k<x.length;++k)w=x[k],w.id==S&&(y=w);for(S=Rn(Mt(y.messages[0].data)[2][0].data),g=Ze.find(h,c[S].location),x=Vs(js(g.content)),k=0;k<x.length;++k)w=x[k],w.id==S&&(y=w);for(S=Rn(Mt(y.messages[0].data)[2][0].data),g=Ze.find(h,c[S].location),x=Vs(js(g.content)),k=0;k<x.length;++k)w=x[k],w.id==S&&(y=w);var N=Mt(y.messages[0].data);{N[6][0].data=qt(n.e.r+1),N[7][0].data=qt(n.e.c+1);var B=Rn(N[46][0].data),b=Ze.find(h,c[B].location),j=Vs(js(b.content));{for(var X=0;X<j.length&&j[X].id!=B;++X);if(j[X].id!=B)throw"Bad ColumnRowUIDMapArchive";var G=Mt(j[X].messages[0].data);G[1]=[],G[2]=[],G[3]=[];for(var A=0;A<=n.e.c;++A){var C=[];C[1]=C[2]=[{type:0,data:qt(A+420690)}],G[1].push({type:2,data:pn(C)}),G[2].push({type:0,data:qt(A)}),G[3].push({type:0,data:qt(A)})}G[4]=[],G[5]=[],G[6]=[];for(var F=0;F<=n.e.r;++F)C=[],C[1]=C[2]=[{type:0,data:qt(F+726270)}],G[4].push({type:2,data:pn(C)}),G[5].push({type:0,data:qt(F)}),G[6].push({type:0,data:qt(F)});j[X].messages[0].data=pn(G)}b.content=ac(ic(j)),b.size=b.content.length,delete N[46];var V=Mt(N[4][0].data);{V[7][0].data=qt(n.e.r+1);var M=Mt(V[1][0].data),D=Rn(M[2][0].data);b=Ze.find(h,c[D].location),j=Vs(js(b.content));{if(j[0].id!=D)throw"Bad HeaderStorageBucket";var L=Mt(j[0].messages[0].data);for(F=0;F<i.length;++F){var ke=Mt(L[2][0].data);ke[1][0].data=qt(F),ke[4][0].data=qt(i[F].length),L[2][F]={type:L[2][0].type,data:pn(ke)}}j[0].messages[0].data=pn(L)}b.content=ac(ic(j)),b.size=b.content.length;var Se=Rn(V[2][0].data);b=Ze.find(h,c[Se].location),j=Vs(js(b.content));{if(j[0].id!=Se)throw"Bad HeaderStorageBucket";for(L=Mt(j[0].messages[0].data),A=0;A<=n.e.c;++A)ke=Mt(L[2][0].data),ke[1][0].data=qt(A),ke[4][0].data=qt(n.e.r+1),L[2][A]={type:L[2][0].type,data:pn(ke)};j[0].messages[0].data=pn(L)}b.content=ac(ic(j)),b.size=b.content.length;var De=Rn(V[4][0].data);(function(){for(var te=Ze.find(h,c[De].location),J=Vs(js(te.content)),Z,oe=0;oe<J.length;++oe){var _e=J[oe];_e.id==De&&(Z=_e)}var ve=Mt(Z.messages[0].data);{ve[3]=[];var xe=[];o.forEach(function(Y,Et){xe[1]=[{type:0,data:qt(Et)}],xe[2]=[{type:0,data:qt(1)}],xe[3]=[{type:2,data:VV(Y)}],ve[3].push({type:2,data:pn(xe)})})}Z.messages[0].data=pn(ve);var Ee=ic(J),st=ac(Ee);te.content=st,te.size=te.content.length})();var Ne=Mt(V[3][0].data);{var Ce=Ne[1][0];delete Ne[2];var ne=Mt(Ce.data);{var ye=Rn(ne[2][0].data);(function(){for(var te=Ze.find(h,c[ye].location),J=Vs(js(te.content)),Z,oe=0;oe<J.length;++oe){var _e=J[oe];_e.id==ye&&(Z=_e)}var ve=Mt(Z.messages[0].data);{delete ve[6],delete Ne[7];var xe=new Uint8Array(ve[5][0].data);ve[5]=[];for(var Ee=0,st=0;st<=n.e.r;++st){var Y=Mt(xe);Ee+=ZV(Y,i[st],o),Y[1][0].data=qt(st),ve[5].push({data:pn(Y),type:2})}ve[1]=[{type:0,data:qt(n.e.c+1)}],ve[2]=[{type:0,data:qt(n.e.r+1)}],ve[3]=[{type:0,data:qt(Ee)}],ve[4]=[{type:0,data:qt(n.e.r+1)}]}Z.messages[0].data=pn(ve);var Et=ic(J),gt=ac(Et);te.content=gt,te.size=te.content.length})()}Ce.data=pn(ne)}V[3][0].data=pn(Ne)}N[4][0].data=pn(V)}y.messages[0].data=pn(N);var ee=ic(x),O=ac(ee);return g.content=O,g.size=g.content.length,h}function p4(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function xx(t){p4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function vx(t){p4([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function tj(t){return wt.WS.indexOf(t)>-1?"sheet":t==wt.CS?"chart":t==wt.DS?"dialog":t==wt.MS?"macro":t&&t.length?t:"sheet"}function rj(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,tj(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function nj(t,e,r,n,s,i,o,c,u,h,d,g){try{i[n]=Yu(Es(t,r,!0),e);var x=Vr(t,e),y;switch(c){case"sheet":y=kB(x,e,s,u,i[n],h,d,g);break;case"chart":if(y=AB(x,e,s,u,i[n],h,d,g),!y||!y["!drawel"])break;var k=Vu(y["!drawel"].Target,e),w=wf(k),S=hL(Es(t,k,!0),Yu(Es(t,w,!0),k)),N=Vu(S,k),B=wf(N);y=Z7(Es(t,N,!0),N,u,Yu(Es(t,B,!0),N),h,y);break;case"macro":y=CB(x,e,s,u,i[n],h,d,g);break;case"dialog":y=IB(x,e,s,u,i[n],h,d,g);break;default:throw new Error("Unrecognized sheet type "+c)}o[n]=y;var b=[];i&&i[n]&&kr(i[n]).forEach(function(j){var X="";if(i[n][j].Type==wt.CMNT){X=Vu(i[n][j].Target,e);var G=RB(Vr(t,X,!0),X,u);if(!G||!G.length)return;dw(y,G,!1)}i[n][j].Type==wt.TCMNT&&(X=Vu(i[n][j].Target,e),b=b.concat(pL(Vr(t,X,!0),u)))}),b&&b.length&&dw(y,b,!0,u.people||[])}catch(j){if(u.WTF)throw j}}function Ms(t){return t.charAt(0)=="/"?t.slice(1):t}function sj(t,e){if($c(),e=e||{},xx(e),Us(t,"META-INF/manifest.xml")||Us(t,"objectdata.xml"))return Sw(t,e);if(Us(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hm<"u"){if(t.FileIndex)return Hm(t);var r=Ze.utils.cfb_new();return Py(t).forEach(function(ke){vt(r,ke,mD(t,ke))}),Hm(r)}throw new Error("Unsupported NUMBERS file")}if(!Us(t,"[Content_Types].xml"))throw Us(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Us(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Py(t),s=lP(Es(t,"[Content_Types].xml")),i=!1,o,c;if(s.workbooks.length===0&&(c="xl/workbook.xml",Vr(t,c,!0)&&s.workbooks.push(c)),s.workbooks.length===0){if(c="xl/workbook.bin",!Vr(t,c,!0))throw new Error("Could not find workbook");s.workbooks.push(c),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},h={};if(!e.bookSheets&&!e.bookProps){if(Qu=[],s.sst)try{Qu=NB(Vr(t,Ms(s.sst)),s.sst,e)}catch(ke){if(e.WTF)throw ke}e.cellStyles&&s.themes.length&&(u=bB(Es(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(h=FB(Vr(t,Ms(s.style)),s.style,u,e))}s.links.map(function(ke){try{var Se=Yu(Es(t,wf(Ms(ke))),ke);return PB(Vr(t,Ms(ke)),Se,ke,e)}catch{}});var d=SB(Vr(t,Ms(s.workbooks[0])),s.workbooks[0],e),g={},x="";s.coreprops.length&&(x=Vr(t,Ms(s.coreprops[0]),!0),x&&(g=rk(x)),s.extprops.length!==0&&(x=Vr(t,Ms(s.extprops[0]),!0),x&&mP(x,g,e)));var y={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(x=Es(t,Ms(s.custprops[0]),!0),x&&(y=xP(x,e)));var k={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(Se){return Se.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),e.bookProps&&(k.Props=g,k.Custprops=y),e.bookSheets&&typeof o<"u"&&(k.SheetNames=o),e.bookSheets?k.SheetNames:e.bookProps))return k;o={};var w={};e.bookDeps&&s.calcchain&&(w=DB(Vr(t,Ms(s.calcchain)),s.calcchain));var S=0,N={},B,b;{var j=d.Sheets;g.Worksheets=j.length,g.SheetNames=[];for(var X=0;X!=j.length;++X)g.SheetNames[X]=j[X].name}var G=i?"bin":"xml",A=s.workbooks[0].lastIndexOf("/"),C=(s.workbooks[0].slice(0,A+1)+"_rels/"+s.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Us(t,C)||(C="xl/_rels/workbook."+G+".rels");var F=Yu(Es(t,C,!0),C.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=OB(Vr(t,Ms(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=gL(Vr(t,Ms(s.people[0])),e)),F&&(F=rj(F,d.Sheets));var V=Vr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=g.Worksheets;++S){var M="sheet";if(F&&F[S]?(B="xl/"+F[S][1].replace(/[\/]?xl\//,""),Us(t,B)||(B=F[S][1]),Us(t,B)||(B=C.replace(/_rels\/.*$/,"")+F[S][1]),M=F[S][2]):(B="xl/worksheets/sheet"+(S+1-V)+"."+G,B=B.replace(/sheet0\./,"sheet.")),b=B.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(g.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,L=0;L!=e.sheets.length;++L)typeof e.sheets[L]=="number"&&e.sheets[L]==S&&(D=1),typeof e.sheets[L]=="string"&&e.sheets[L].toLowerCase()==g.SheetNames[S].toLowerCase()&&(D=1);if(!D)continue e}}nj(t,B,b,g.SheetNames[S],S,N,o,M,e,d,u,h)}return k={Directory:s,Workbook:d,Props:g,Custprops:y,Deps:w,Sheets:o,SheetNames:g.SheetNames,Strings:Qu,Styles:h,Themes:u,SSF:lr(nt)},e&&e.bookFiles&&(t.files?(k.keys=n,k.files=t.files):(k.keys=[],k.files={},t.FullPaths.forEach(function(ke,Se){ke=ke.replace(/^Root Entry[\/]/,""),k.keys.push(ke),k.files[ke]=t.FileIndex[Se]}))),e&&e.bookVBA&&(s.vba.length>0?k.vbaraw=Vr(t,Ms(s.vba[0]),!0):s.defaults&&s.defaults.bin===SL&&(k.vbaraw=Vr(t,"xl/vbaProject.bin",!0))),k}function ij(t,e){var r=e||{},n="Workbook",s=Ze.find(t,n);try{if(n="/!DataSpaces/Version",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(O5(s.content),n="/!DataSpaces/DataSpaceMap",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=M5(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=B5(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);j5(s.content)}catch{}if(n="/EncryptionInfo",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=U5(s.content);if(n="/EncryptedPackage",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],s.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function aj(t,e){return e.bookType=="ods"?d4(t,e):e.bookType=="numbers"?ej(t,e):e.bookType=="xlsb"?oj(t,e):lj(t,e)}function oj(t,e){dc=1024,t&&!t.SSF&&(t.SSF=lr(nt)),t&&t.SSF&&($c(),Dd(t.SSF),e.revssf=Od(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ju?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Uk.indexOf(e.bookType)>-1,s=nx();vx(e=e||{});var i=W1(),o="",c=0;if(e.cellXfs=[],ko(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",vt(i,o,nk(t.Props,e)),s.coreprops.push(o),Xt(e.rels,2,o,wt.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(t.SheetNames[h]);t.Props.SheetNames=u}for(t.Props.Worksheets=t.Props.SheetNames.length,vt(i,o,ak(t.Props)),s.extprops.push(o),Xt(e.rels,3,o,wt.EXT_PROPS),t.Custprops!==t.Props&&kr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",vt(i,o,ok(t.Custprops)),s.custprops.push(o),Xt(e.rels,4,o,wt.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var d={"!id":{}},g=t.Sheets[t.SheetNames[c-1]],x=(g||{})["!type"]||"sheet";switch(x){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,vt(i,o,MB(c-1,o,e,t,d)),s.sheets.push(o),Xt(e.wbrels,-1,"worksheets/sheet"+c+"."+r,wt.WS[0])}if(g){var y=g["!comments"],k=!1,w="";y&&y.length>0&&(w="xl/comments"+c+"."+r,vt(i,w,jB(y,w)),s.comments.push(w),Xt(d,-1,"../comments"+c+"."+r,wt.CMNT),k=!0),g["!legacy"]&&k&&vt(i,"xl/drawings/vmlDrawing"+c+".vml",Vk(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}d["!id"].rId1&&vt(i,wf(o),yc(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,vt(i,o,VB(e.Strings,o,e)),s.strs.push(o),Xt(e.wbrels,-1,"sharedStrings."+r,wt.SST)),o="xl/workbook."+r,vt(i,o,LB(t,o)),s.workbooks.push(o),Xt(e.rels,1,o,wt.WB),o="xl/theme/theme1.xml",vt(i,o,cx(t.Themes,e)),s.themes.push(o),Xt(e.wbrels,-1,"theme/theme1.xml",wt.THEME),o="xl/styles."+r,vt(i,o,BB(t,o,e)),s.styles.push(o),Xt(e.wbrels,-1,"styles."+r,wt.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",vt(i,o,t.vbaraw),s.vba.push(o),Xt(e.wbrels,-1,"vbaProject.bin",wt.VBA)),o="xl/metadata."+r,vt(i,o,UB(o)),s.metadata.push(o),Xt(e.wbrels,-1,"metadata."+r,wt.XLMETA),vt(i,"[Content_Types].xml",ek(s,e)),vt(i,"_rels/.rels",yc(e.rels)),vt(i,"xl/_rels/workbook."+r+".rels",yc(e.wbrels)),delete e.revssf,delete e.ssf,i}function lj(t,e){dc=1024,t&&!t.SSF&&(t.SSF=lr(nt)),t&&t.SSF&&($c(),Dd(t.SSF),e.revssf=Od(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ju?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Uk.indexOf(e.bookType)>-1,s=nx();vx(e=e||{});var i=W1(),o="",c=0;if(e.cellXfs=[],ko(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",vt(i,o,nk(t.Props,e)),s.coreprops.push(o),Xt(e.rels,2,o,wt.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(t.SheetNames[h]);t.Props.SheetNames=u}t.Props.Worksheets=t.Props.SheetNames.length,vt(i,o,ak(t.Props)),s.extprops.push(o),Xt(e.rels,3,o,wt.EXT_PROPS),t.Custprops!==t.Props&&kr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",vt(i,o,ok(t.Custprops)),s.custprops.push(o),Xt(e.rels,4,o,wt.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,c=1;c<=t.SheetNames.length;++c){var g={"!id":{}},x=t.Sheets[t.SheetNames[c-1]],y=(x||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,vt(i,o,Jk(c-1,e,t,g)),s.sheets.push(o),Xt(e.wbrels,-1,"worksheets/sheet"+c+"."+r,wt.WS[0])}if(x){var k=x["!comments"],w=!1,S="";if(k&&k.length>0){var N=!1;k.forEach(function(B){B[1].forEach(function(b){b.T==!0&&(N=!0)})}),N&&(S="xl/threadedComments/threadedComment"+c+"."+r,vt(i,S,mL(k,d,e)),s.threadedcomments.push(S),Xt(g,-1,"../threadedComments/threadedComment"+c+"."+r,wt.TCMNT)),S="xl/comments"+c+"."+r,vt(i,S,jk(k)),s.comments.push(S),Xt(g,-1,"../comments"+c+"."+r,wt.CMNT),w=!0}x["!legacy"]&&w&&vt(i,"xl/drawings/vmlDrawing"+c+".vml",Vk(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&vt(i,wf(o),yc(g))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,vt(i,o,Ck(e.Strings,e)),s.strs.push(o),Xt(e.wbrels,-1,"sharedStrings."+r,wt.SST)),o="xl/workbook."+r,vt(i,o,n4(t)),s.workbooks.push(o),Xt(e.rels,1,o,wt.WB),o="xl/theme/theme1.xml",vt(i,o,cx(t.Themes,e)),s.themes.push(o),Xt(e.wbrels,-1,"theme/theme1.xml",wt.THEME),o="xl/styles."+r,vt(i,o,Ok(t,e)),s.styles.push(o),Xt(e.wbrels,-1,"styles."+r,wt.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",vt(i,o,t.vbaraw),s.vba.push(o),Xt(e.wbrels,-1,"vbaProject.bin",wt.VBA)),o="xl/metadata."+r,vt(i,o,Bk()),s.metadata.push(o),Xt(e.wbrels,-1,"metadata."+r,wt.XLMETA),d.length>1&&(o="xl/persons/person.xml",vt(i,o,xL(d)),s.people.push(o),Xt(e.wbrels,-1,"persons/person.xml",wt.PEOPLE)),vt(i,"[Content_Types].xml",ek(s,e)),vt(i,"_rels/.rels",yc(e.rels)),vt(i,"xl/_rels/workbook."+r+".rels",yc(e.wbrels)),delete e.revssf,delete e.ssf,i}function _x(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ks(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function cj(t,e){return Ze.find(t,"EncryptedPackage")?ij(t,e):o4(t,e)}function uj(t,e){var r,n=t,s=e||{};return s.type||(s.type=_t&&Buffer.isBuffer(t)?"buffer":"base64"),r=FS(n,s),sj(r,s)}function m4(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ng(t.slice(r),e);default:break e}return Dc.to_workbook(t,e)}function fj(t,e){var r="",n=_x(t,e);switch(e.type){case"base64":r=ks(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=hl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Qt(r)),e.type="binary",m4(r,e)}function hj(t,e){var r=t;return e.type=="base64"&&(r=ks(r)),r=mf.utils.decode(1200,r.slice(2),"str"),e.type="binary",m4(r,e)}function dj(t){return t.match(/[^\x00-\x7F]/)?Oi(t):t}function $m(t,e,r,n){return n?(r.type="string",Dc.to_workbook(t,r)):Dc.to_workbook(e,r)}function Pg(t,e){B1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Pg(new Uint8Array(t),(r=lr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ec={},r.dateNF&&(Ec.dateNF=r.dateNF),r.type||(r.type=_t&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=_t?"buffer":"binary",n=oD(t),typeof Uint8Array<"u"&&!_t&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=dj(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=lr(r),r.type="array",Pg(V1(n),r)}switch((s=_x(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return cj(Ze.read(n,r),r);break;case 9:if(s[1]<=8)return o4(n,r);break;case 60:return Ng(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return v5(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return kk.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?uj(n,r):$m(t,n,r,i);case 239:return s[3]===60?Ng(n,r):$m(t,n,r,i);case 255:if(s[1]===254)return hj(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return nl.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return nl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return bg.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Rk.to_workbook(n,r);break;case 10:case 13:case 32:return fj(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return x5.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?bg.to_workbook(n,r):$m(t,n,r,i)}function g4(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return $f(e.file,Ze.write(t,{type:_t?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Ze.write(t,e)}function pj(t,e){var r=lr(e||{}),n=aj(t,r);return mj(n,r)}function mj(t,e){var r={},n=_t?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?Ze.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(Rd(s))}return e.password&&typeof encrypt_agile<"u"?g4(encrypt_agile(s,e.password),e):e.type==="file"?$f(e.file,s):e.type=="string"?Qt(s):s}function gj(t,e){var r=e||{},n=dV(t,r);return g4(n,r)}function Ri(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return gf(Oi(n));case"binary":return Oi(n);case"string":return t;case"file":return $f(e.file,n,"utf8");case"buffer":return _t?ka(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ri(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function xj(t,e){switch(e.type){case"base64":return gf(t);case"binary":return t;case"string":return t;case"file":return $f(e.file,t,"binary");case"buffer":return _t?ka(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function v0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?gf(r):e.type=="string"?Qt(r):r;case"file":return $f(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function yx(t,e){B1(),cB(t);var r=lr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=yx(t,r);return r.type="array",Rd(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ri(aV(t,r),r);case"slk":case"sylk":return Ri(Sk.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return Ri(c4(t.Sheets[t.SheetNames[s]],r),r);case"txt":return xj(x4(t.Sheets[t.SheetNames[s]],r),r);case"csv":return Ri(wx(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return Ri(kk.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return v0(bg.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return Ri(Dc.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return Ri(Rk.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return Ri(Ak.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return Ri(d4(t,r),r);case"wk1":return v0(nl.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return v0(nl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),v0(l4(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),gj(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return pj(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function vj(t,e,r,n,s,i,o,c){var u=Nr(r),h=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!o||t[r])for(var y=e.s.c;y<=e.e.c;++y){var k=o?t[r][y]:t[n[y]+u];if(k===void 0||k.t===void 0){if(h===void 0)continue;i[y]!=null&&(x[i[y]]=h);continue}var w=k.v;switch(k.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(i[y]!=null){if(w==null)if(k.t=="e"&&w===null)x[i[y]]=null;else if(h!==void 0)x[i[y]]=h;else if(d&&w===null)x[i[y]]=null;else continue;else x[i[y]]=d&&(k.t!=="n"||k.t==="n"&&c.rawNumbers!==!1)?w:Ta(k,w,c);w!=null&&(g=!1)}}return{row:x,isempty:g}}function cd(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},d=h.range!=null?h.range:t["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof d){case"string":u=Ot(d);break;case"number":u=Ot(t["!ref"]),u.s.r=d;break;default:u=d}n>0&&(s=0);var g=Nr(u.s.r),x=[],y=[],k=0,w=0,S=Array.isArray(t),N=u.s.r,B=0,b={};S&&!t[N]&&(t[N]=[]);var j=h.skipHidden&&t["!cols"]||[],X=h.skipHidden&&t["!rows"]||[];for(B=u.s.c;B<=u.e.c;++B)if(!(j[B]||{}).hidden)switch(x[B]=xr(B),r=S?t[N][B]:t[x[B]+g],n){case 1:i[B]=B-u.s.c;break;case 2:i[B]=x[B];break;case 3:i[B]=h.header[B-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=Ta(r,null,h),w=b[o]||0,!w)b[o]=1;else{do c=o+"_"+w++;while(b[c]);b[o]=w,b[c]=1}i[B]=c}for(N=u.s.r+s;N<=u.e.r;++N)if(!(X[N]||{}).hidden){var G=vj(t,u,N,x,n,i,S,h);(G.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(y[k++]=G.row)}return y.length=k,y}var Fw=/"/g;function _j(t,e,r,n,s,i,o,c){for(var u=!0,h=[],d="",g=Nr(r),x=e.s.c;x<=e.e.c;++x)if(n[x]){var y=c.dense?(t[r]||[])[x]:t[n[x]+g];if(y==null)d="";else if(y.v!=null){u=!1,d=""+(c.rawNumbers&&y.t=="n"?y.v:Ta(y,null,c));for(var k=0,w=0;k!==d.length;++k)if((w=d.charCodeAt(k))===s||w===i||w===34||c.forceQuotes){d='"'+d.replace(Fw,'""')+'"';break}d=="ID"&&(d='"ID"')}else y.f!=null&&!y.F?(u=!1,d="="+y.f,d.indexOf(",")>=0&&(d='"'+d.replace(Fw,'""')+'"')):d="";h.push(d)}return c.blankrows===!1&&u?null:h.join(o)}function wx(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Ot(t["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,u=c.charCodeAt(0),h=new RegExp((i=="|"?"\\|":i)+"+$"),d="",g=[];n.dense=Array.isArray(t);for(var x=n.skipHidden&&t["!cols"]||[],y=n.skipHidden&&t["!rows"]||[],k=s.s.c;k<=s.e.c;++k)(x[k]||{}).hidden||(g[k]=xr(k));for(var w=0,S=s.s.r;S<=s.e.r;++S)(y[S]||{}).hidden||(d=_j(t,s,S,g,o,u,i,n),d!=null&&(n.strip&&(d=d.replace(h,"")),(d||n.blankrows!==!1)&&r.push((w++?c:"")+d)));return delete n.dense,r.join("")}function x4(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=wx(t,e);return r}function yj(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Ot(t["!ref"]),i="",o=[],c,u=[],h=Array.isArray(t);for(c=s.s.c;c<=s.e.c;++c)o[c]=xr(c);for(var d=s.s.r;d<=s.e.r;++d)for(i=Nr(d),c=s.s.c;c<=s.e.c;++c)if(e=o[c]+i,r=h?(t[d]||[])[c]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=e+"="+n}return u}function v4(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},o=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?vr(n.origin):n.origin;o=u.r,c=u.c}var h,d={s:{c:0,r:0},e:{c,r:o+e.length-1+s}};if(i["!ref"]){var g=Ot(i["!ref"]);d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),o==-1&&(o=g.e.r+1,d.e.r=o+e.length-1+s)}else o==-1&&(o=0,d.e.r=e.length-1+s);var x=n.header||[],y=0;e.forEach(function(w,S){kr(w).forEach(function(N){(y=x.indexOf(N))==-1&&(x[y=x.length]=N);var B=w[N],b="z",j="",X=it({c:c+y,r:o+S+s});h=If(i,X),B&&typeof B=="object"&&!(B instanceof Date)?i[X]=B:(typeof B=="number"?b="n":typeof B=="boolean"?b="b":typeof B=="string"?b="s":B instanceof Date?(b="d",n.cellDates||(b="n",B=Qr(B)),j=n.dateNF||nt[14]):B===null&&n.nullError&&(b="e",B=0),h?(h.t=b,h.v=B,delete h.w,delete h.R,j&&(h.z=j)):i[X]=h={t:b,v:B},j&&(h.z=j))})}),d.e.c=Math.max(d.e.c,c+x.length-1);var k=Nr(o);if(s)for(y=0;y<x.length;++y)i[xr(y+c)+k]={t:"s",v:x[y]};return i["!ref"]=xt(d),i}function wj(t,e){return v4(null,t,e)}function If(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=vr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?If(t,it(e)):If(t,it({r:e,c:r||0}))}function Ej(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Ex(){return{SheetNames:[],Sheets:{}}}function Tx(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=o+s)!=-1;++s);}if(r4(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Tj(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Ej(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Sj(t,e){return t.z=e,t}function _4(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function kj(t,e,r){return _4(t,"#"+e,r)}function Aj(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Cj(t,e,r,n){for(var s=typeof e!="string"?e:Ot(e),i=typeof e=="string"?e:xt(e),o=s.s.r;o<=s.e.r;++o)for(var c=s.s.c;c<=s.e.c;++c){var u=If(t,o,c);u.t="n",u.F=i,delete u.v,o==s.s.r&&c==s.s.c&&(u.f=r,n&&(u.D=!0))}return t}var il={encode_col:xr,encode_row:Nr,encode_cell:it,encode_range:xt,decode_col:Q1,decode_row:Y1,split_cell:VD,decode_cell:vr,decode_range:cs,format_cell:Ta,sheet_add_aoa:KS,sheet_add_json:v4,sheet_add_dom:u4,aoa_to_sheet:Gc,json_to_sheet:wj,table_to_sheet:f4,table_to_book:OV,sheet_to_csv:wx,sheet_to_txt:x4,sheet_to_json:cd,sheet_to_html:c4,sheet_to_formulae:yj,sheet_to_row_object_array:cd,sheet_get_cell:If,book_new:Ex,book_append_sheet:Tx,book_set_sheet_visibility:Tj,cell_set_number_format:Sj,cell_set_hyperlink:_4,cell_set_internal_link:kj,cell_add_comment:Aj,sheet_set_array_formula:Cj,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},b0={exports:{}},Ij=b0.exports,bw;function Fj(){return bw||(bw=1,(function(t,e){(function(r,n){n()})(Ij,function(){function r(h,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function n(h,d,g){var x=new XMLHttpRequest;x.open("GET",h),x.responseType="blob",x.onload=function(){u(x.response,d,g)},x.onerror=function(){console.error("could not download file")},x.send()}function s(h){var d=new XMLHttpRequest;d.open("HEAD",h,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function i(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(d)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof e0=="object"&&e0.global===e0?e0:void 0,c=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(h,d,g){var x=o.URL||o.webkitURL,y=document.createElement("a");d=d||h.name||"download",y.download=d,y.rel="noopener",typeof h=="string"?(y.href=h,y.origin===location.origin?i(y):s(y.href)?n(h,d,g):i(y,y.target="_blank")):(y.href=x.createObjectURL(h),setTimeout(function(){x.revokeObjectURL(y.href)},4e4),setTimeout(function(){i(y)},0))}:"msSaveOrOpenBlob"in navigator?function(h,d,g){if(d=d||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(r(h,g),d);else if(s(h))n(h,d,g);else{var x=document.createElement("a");x.href=h,x.target="_blank",setTimeout(function(){i(x)})}}:function(h,d,g,x){if(x=x||open("","_blank"),x&&(x.document.title=x.document.body.innerText="downloading..."),typeof h=="string")return n(h,d,g);var y=h.type==="application/octet-stream",k=/constructor/i.test(o.HTMLElement)||o.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||y&&k||c)&&typeof FileReader<"u"){var S=new FileReader;S.onloadend=function(){var b=S.result;b=w?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),x?x.location.href=b:location=b,x=null},S.readAsDataURL(h)}else{var N=o.URL||o.webkitURL,B=N.createObjectURL(h);x?x.location=B:location.href=B,x=null,setTimeout(function(){N.revokeObjectURL(B)},4e4)}});o.saveAs=u.saveAs=u,t.exports=u})})(b0)),b0.exports}var y4=Fj();const bj=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=s=>{try{const i=new Uint8Array(s.target.result),o=Pg(i,{type:"array"}),c=o.SheetNames[0],u=o.Sheets[c],h=il.sheet_to_json(u,{header:1});if(h.length<2){r(new Error(""));return}const d=h[0],g=h.slice(1).filter(x=>x.some(y=>y));e({headers:d,rows:g,sheetName:c})}catch{r(new Error(" Excel "))}},n.onerror=()=>{r(new Error(""))},n.readAsArrayBuffer(t)}),Nj=t=>{const e={number:-1,name:-1,traits:-1,comment:-1},r={number:["","","","no","number",""],name:["","","","name",""],traits:["","","","","traits",""],comment:["","","","comment",""]};return t.forEach((n,s)=>{if(!n)return;const i=String(n).toLowerCase().trim();for(const[o,c]of Object.entries(r))c.some(u=>i.includes(u))&&(e[o]=s)}),e},Rj=(t,e={})=>{const{includeNumber:r=!0,includeName:n=!0,includeTraits:s=!0,includeComment:i=!0,includeManualTraits:o=!1}=e,c=[],u=[];r&&u.push(""),n&&u.push(""),s&&u.push(""),o&&u.push(""),i&&u.push(""),c.push(u),t.forEach((g,x)=>{const y=[];r&&y.push(g.number||x+1),n&&y.push(g.name||""),s&&y.push((g.selectedTags||[]).join("")),o&&y.push(g.manualTraits||""),i&&y.push(g.comment||""),c.push(y)});const h=il.aoa_to_sheet(c);h["!cols"]=[{wch:6},{wch:10},{wch:30},{wch:20},{wch:60}];const d=il.book_new();return il.book_append_sheet(d,h,""),yx(d,{bookType:"xlsx",type:"array"})},Dj=(t,e="",r={})=>{const n=Rj(t,r),s=new Blob([n],{type:"application/octet-stream"});y4.saveAs(s,`${e}.xlsx`)},Pj=()=>{const t=[["","","",""],[1,"","",""],[2,"","",""],[3,"","",""]],e=il.aoa_to_sheet(t);e["!cols"]=[{wch:6},{wch:10},{wch:30},{wch:20}];const r=il.book_new();il.book_append_sheet(r,e,"");const n=yx(r,{bookType:"xlsx",type:"array"}),s=new Blob([n],{type:"application/octet-stream"});y4.saveAs(s,".xlsx")},Oj=({isOpen:t,onClose:e,students:r,onImport:n,currentClassName:s=""})=>{const{toast:i}=zw(),o=Te.useRef(null),[c,u]=Te.useState("export"),[h,d]=Te.useState(!1),[g,x]=Te.useState({includeNumber:!0,includeName:!0,includeTraits:!0,includeManualTraits:!0,includeComment:!0}),[y,k]=Te.useState(null),[w,S]=Te.useState({}),[N,B]=Te.useState("append"),[b,j]=Te.useState(!1),X=async D=>{if(!D)return;if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(D.type)&&!D.name.match(/\.(xlsx|xls|csv)$/i)){i.error(" Excel  CSV ");return}d(!0);try{const{headers:ke,rows:Se,sheetName:De}=await bj(D),Ne=Nj(ke);k({headers:ke,rows:Se,sheetName:De,fileName:D.name}),S(Ne),i.success(` ${Se.length} `)}catch(ke){i.error(ke.message),k(null)}d(!1)},G=Te.useCallback(D=>{D.preventDefault(),j(!0)},[]),A=Te.useCallback(D=>{D.preventDefault(),j(!1)},[]),C=Te.useCallback(D=>{D.preventDefault(),j(!1);const L=D.dataTransfer.files[0];L&&X(L)},[]),F=()=>{if(!y||w.name<0){i.error("");return}const D=y.rows.map((L,ke)=>{const Se=L[w.name]||"";return Se?{id:`import_${Date.now()}_${ke}`,number:w.number>=0?L[w.number]:ke+1,name:String(Se).trim(),traits:"",selectedTags:w.traits>=0?String(L[w.traits]||"").split(/[,]/).filter(Boolean):[],manualTraits:"",comment:w.comment>=0?String(L[w.comment]||""):""}:null}).filter(Boolean);if(D.length===0){i.error("");return}n(D,N),i.success(` ${D.length} `),k(null),S({}),e()},V=()=>{if(r.length===0){i.warning("");return}const D=`${s}_${new Date().toLocaleDateString("zh-TW").replace(/\//g,"-")}`;Dj(r,D,g),i.success(` ${r.length} `)},M=()=>{Pj(),i.info("")};return t?v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-2 sm:p-4",children:v.jsxs("div",{className:"card-pop w-full max-w-2xl max-h-[90vh] flex flex-col animate-in bg-[#FFF9E6]",children:[v.jsxs("div",{className:"p-3 sm:p-5 bg-[#54A0FF] border-b-3 border-[#2D3436] flex items-center justify-between",children:[v.jsxs("h3",{className:"font-black text-white flex items-center gap-2 text-lg sm:text-xl",children:[v.jsx(Ow,{size:24}),"Excel /"]}),v.jsx("button",{onClick:e,className:"btn-pop p-2 bg-white text-[#2D3436]",children:v.jsx(Ss,{size:20})})]}),v.jsxs("div",{className:"flex border-b-2 border-[#2D3436]",children:[v.jsxs("button",{onClick:()=>u("export"),className:`flex-1 py-3 px-4 font-bold flex items-center justify-center gap-2 transition-colors
                            ${c==="export"?"bg-[#1DD1A1] text-white":"bg-[#E8DCC8] text-[#636E72] hover:bg-[#FECA57]/30"}`,children:[v.jsx(rf,{size:18}),""]}),v.jsxs("button",{onClick:()=>u("import"),className:`flex-1 py-3 px-4 font-bold flex items-center justify-center gap-2 transition-colors
                            ${c==="import"?"bg-[#FF6B9D] text-white":"bg-[#E8DCC8] text-[#636E72] hover:bg-[#FECA57]/30"}`,children:[v.jsx(gm,{size:18}),""]})]}),v.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:c==="export"?v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg p-4",children:[v.jsx("h4",{className:"font-bold text-[#2D3436] mb-3",children:""}),v.jsx("div",{className:"space-y-2",children:[{key:"includeNumber",label:""},{key:"includeName",label:""},{key:"includeTraits",label:""},{key:"includeManualTraits",label:""},{key:"includeComment",label:""}].map(({key:D,label:L})=>v.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[v.jsx("input",{type:"checkbox",checked:g[D],onChange:ke=>x(Se=>({...Se,[D]:ke.target.checked})),className:"w-5 h-5 rounded border-2 border-[#2D3436] accent-[#1DD1A1]"}),v.jsx("span",{className:"font-medium text-[#2D3436]",children:L})]},D))})]}),v.jsxs("div",{className:"bg-[#1DD1A1]/20 border-2 border-[#1DD1A1] rounded-lg p-4 text-sm text-[#2D3436]",children:[v.jsx("p",{className:"font-bold mb-1",children:" "}),v.jsxs("p",{children:[" ",v.jsx("strong",{children:r.length})," "]}),v.jsxs("p",{children:["",v.jsx("strong",{children:s})]})]}),v.jsxs("button",{onClick:V,disabled:r.length===0,className:"btn-pop w-full py-4 bg-[#1DD1A1] text-white font-bold text-lg flex items-center justify-center gap-2 disabled:opacity-50",children:[v.jsx(rf,{size:20})," Excel"]})]}):v.jsx("div",{className:"space-y-4",children:y?v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"bg-[#54A0FF]/20 border-2 border-[#54A0FF] rounded-lg p-3 text-sm",children:[v.jsxs("p",{className:"font-bold text-[#2D3436]",children:[" ",y.fileName]}),v.jsxs("p",{className:"text-[#636E72]",children:[" ",y.rows.length," "]})]}),v.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg p-4",children:[v.jsx("h4",{className:"font-bold text-[#2D3436] mb-3",children:""}),v.jsx("div",{className:"space-y-3",children:[{key:"number",label:"",required:!1},{key:"name",label:"",required:!0},{key:"traits",label:"",required:!1},{key:"comment",label:"",required:!1}].map(({key:D,label:L,required:ke})=>v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsxs("span",{className:"w-20 font-medium text-[#2D3436]",children:[L,ke&&v.jsx("span",{className:"text-[#FF6B6B]",children:"*"})]}),v.jsxs("select",{value:w[D]??-1,onChange:Se=>S(De=>({...De,[D]:parseInt(Se.target.value)})),className:"flex-1 p-2 border-2 border-[#2D3436] rounded-lg font-medium",children:[v.jsx("option",{value:-1,children:"--  --"}),y.headers.map((Se,De)=>v.jsx("option",{value:De,children:Se||` ${De+1}`},De))]}),w[D]>=0&&v.jsx(ca,{size:18,className:"text-[#1DD1A1]"})]},D))})]}),v.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg p-4",children:[v.jsx("h4",{className:"font-bold text-[#2D3436] mb-3",children:""}),v.jsxs("div",{className:"flex gap-3",children:[v.jsxs("label",{className:"flex-1",children:[v.jsx("input",{type:"radio",name:"importMode",value:"append",checked:N==="append",onChange:D=>B(D.target.value),className:"sr-only"}),v.jsxs("div",{className:`p-3 border-2 rounded-lg cursor-pointer transition-all
                                                    ${N==="append"?"border-[#1DD1A1] bg-[#1DD1A1]/20":"border-[#636E72]"}`,children:[v.jsx("p",{className:"font-bold text-[#2D3436]",children:""}),v.jsx("p",{className:"text-xs text-[#636E72]",children:""})]})]}),v.jsxs("label",{className:"flex-1",children:[v.jsx("input",{type:"radio",name:"importMode",value:"replace",checked:N==="replace",onChange:D=>B(D.target.value),className:"sr-only"}),v.jsxs("div",{className:`p-3 border-2 rounded-lg cursor-pointer transition-all
                                                    ${N==="replace"?"border-[#FF6B6B] bg-[#FF6B6B]/20":"border-[#636E72]"}`,children:[v.jsx("p",{className:"font-bold text-[#2D3436]",children:""}),v.jsx("p",{className:"text-xs text-[#636E72]",children:""})]})]})]})]}),w.name<0&&v.jsxs("div",{className:"bg-[#FF6B6B]/20 border-2 border-[#FF6B6B] rounded-lg p-3 flex items-center gap-2 text-sm text-[#FF6B6B]",children:[v.jsx(N0,{size:18}),""]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{onClick:()=>{k(null),S({})},className:"btn-pop flex-1 py-3 bg-[#636E72] text-white font-bold",children:""}),v.jsxs("button",{onClick:F,disabled:w.name<0,className:"btn-pop flex-1 py-3 bg-[#FF6B9D] text-white font-bold flex items-center justify-center gap-2 disabled:opacity-50",children:[v.jsx(gm,{size:18}),""]})]})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{onDragOver:G,onDragLeave:A,onDrop:C,onClick:()=>{var D;return(D=o.current)==null?void 0:D.click()},className:`border-3 border-dashed rounded-lg p-8 text-center cursor-pointer transition-all
                                            ${b?"border-[#FF6B9D] bg-[#FF6B9D]/10":"border-[#636E72] hover:border-[#FF6B9D] hover:bg-[#FECA57]/10"}`,children:[v.jsx("input",{ref:o,type:"file",accept:".xlsx,.xls,.csv",onChange:D=>X(D.target.files[0]),className:"hidden"}),h?v.jsx(pc,{size:48,className:"mx-auto text-[#FF6B9D] animate-spin"}):v.jsx(gm,{size:48,className:"mx-auto text-[#636E72] mb-3"}),v.jsx("p",{className:"font-bold text-[#2D3436] mb-1",children:b?"":" Excel "}),v.jsx("p",{className:"text-sm text-[#636E72]",children:" .xlsx.xls.csv "})]}),v.jsxs("button",{onClick:M,className:"btn-pop w-full py-3 bg-[#54A0FF] text-white font-bold flex items-center justify-center gap-2",children:[v.jsx(KA,{size:18}),""]})]})})})]})}):null},Lj=({currentUser:t,onLogout:e,isAdmin:r})=>{const{toast:n}=zw(),{dialog:s,closeDialog:i,showConfirm:o,showAlert:c}=c3(),[u,h]=Te.useState(!1),{students:d,setStudents:g,selectedIds:x,isLoading:y,generateStudents:k,updateStudent:w,deleteStudent:S,deleteSelected:N,resetStudents:B,toggleSelection:b,toggleAllSelection:j,addTagToStudents:X,removeTag:G,syncComment:A}=uR(t==null?void 0:t.uid),[C,F]=Te.useState(`

`),[V,M]=Te.useState(30),[D,L]=Te.useState(!1),[ke,Se]=Te.useState(!1),[De,Ne]=Te.useState(null),[Ce,ne]=Te.useState({current:0,total:0}),[ye,ee]=Te.useState(!1),[O,te]=Te.useState(["qualitative"]),[J,Z]=Te.useState(!1),[oe,_e]=Te.useState(!1),[ve,xe]=Te.useState(U_()),[Ee,st]=Te.useState({tone:"normal",wordCount:80}),[Y,Et]=Te.useState(null),[gt,It]=Te.useState(!1),[ht,je]=Te.useState(0),[Ht,St]=Te.useState(!1),[Tt,fr]=Te.useState(null),[Xn,ln]=Te.useState(""),[$r,Dr]=Te.useState([]),[yn,Un]=Te.useState(!1),[$t,Jr]=Te.useState(null),[ot,Rt]=Te.useState(!1);Te.useEffect(()=>{if(!t)return;const Qe=Lu.subscribe(Je=>{Je!=null&&Je.apiKey&&(localStorage.setItem("gemini_api_key",Je.apiKey),xe(!0))});return()=>Qe()},[t]),Te.useEffect(()=>{const Qe=Gu.subscribe(Je=>{je(Je.length)});return()=>Qe()},[]),Te.useEffect(()=>{const Qe=ha.subscribe(Je=>{if(Dr(Je),Tt){const Ut=Je.find(rr=>rr.id===Tt);ln(Ut?Ut.name:"")}});return()=>Qe()},[Tt]);const[Gr,jt]=Te.useState({" ()":!0," ()":!0});Te.useEffect(()=>{const Qe=()=>ee(window.innerWidth<768);return Qe(),window.addEventListener("resize",Qe),()=>window.removeEventListener("resize",Qe)},[]);const wn=()=>{C.trim()&&(k(C),F(""))},hi=()=>{if(V<1)return;const Qe=[];for(let Ut=1;Ut<=V;Ut++){const rr=Ut<10?`0${Ut}`:`${Ut}`;Qe.push(`${rr}`)}const Je=Qe.join(`
`);F(Ut=>Ut?`${Ut}
${Je}`:Je)},En=()=>{o("","",()=>{B(),i()})},di=()=>{x.size!==0&&o("",` ${x.size} `,()=>{N(),i()})},us=Qe=>{let Je=[];if(x.size>0?Je=Array.from(x):De&&(Je=[De]),Je.length===0){c("");return}X(Je,Qe)},Ks=Qe=>{jt(Je=>({...Je,[Qe]:!Je[Qe]}))},Yn=Qe=>{te(Je=>Je.includes(Qe)?Je.filter(rr=>rr!==Qe):Je.length>=2?Je:[...Je,Qe])},Qn=async(Qe=!1)=>{Se(!0);const Je=d.filter(rr=>Qe?x.has(rr.id):!0),Ut=Je.length;if(Ut===0){Se(!1);return}ne({current:0,total:Ut});for(let rr=0;rr<Ut;rr++){const hr=Je[rr];g(cn=>cn.map(Pr=>Pr.id===hr.id?{...Pr,comment:""}:Pr));const Zr=[...hr.selectedTags,hr.manualTraits].filter(Boolean).join(""),Gi=await z_(hr.name,Zr,O,Ee);g(cn=>cn.map(Pr=>Pr.id===hr.id?{...Pr,comment:Gi}:Pr)),await A(hr.id,Gi),ne(cn=>({...cn,current:rr+1}))}Se(!1),ne({current:0,total:0}),n.success(`  ${Ut} `)},Zt=Qe=>{l3(d,Qe)},As=async Qe=>{const Je=d.find(hr=>hr.id===Qe);if(!Je)return;if(Et(Qe),Je.comment&&!Je.comment.includes(""))try{await wg.add(Qe,Je.comment,O)}catch(hr){console.error(":",hr)}const Ut=[...Je.selectedTags,Je.manualTraits].filter(Boolean).join(""),rr=await z_(Je.name,Ut,O,Ee);g(hr=>hr.map(Zr=>Zr.id===Qe?{...Zr,comment:rr}:Zr)),await A(Qe,rr),Et(null),n.success(` ${Je.name} `)},Cs=async Qe=>{try{await Gu.add({content:Qe.comment,studentName:Qe.name,tags:Qe.selectedTags,styles:O}),n.success(" ")}catch(Je){console.error(":",Je),n.error("")}},Is=Qe=>{De&&(w(De,"comment",Qe),A(De,Qe))},Ia=async(Qe,Je)=>{Je==="replace"&&await clearAllStudents();for(const Ut of Qe)await addStudent(Ut.name,Ut.selectedTags,Ut.comment)};return v.jsxs("div",{className:"min-h-screen text-[#2D3436] font-sans flex flex-col relative",children:[y&&v.jsx(ER,{}),v.jsx(dR,{dialog:s,closeDialog:i}),ke&&v.jsx(pR,{progress:Ce}),v.jsx(mR,{isOpen:J,onClose:()=>Z(!1),globalStyles:O,toggleGlobalStyle:Yn}),v.jsx(TR,{isOpen:oe,onClose:()=>{_e(!1),xe(U_())},currentUser:t}),v.jsx(SR,{isOpen:gt,onClose:()=>It(!1),onApplyTemplate:Is}),v.jsx(AR,{isOpen:Ht,onClose:()=>St(!1),currentClassId:Tt,onSelectClass:Qe=>{fr(Qe),Qe||ln("")}}),v.jsx(CR,{isOpen:yn,onClose:()=>{Un(!1),Jr(null)},student:$t,onRestore:Qe=>{$t&&(w($t.id,"comment",Qe),A($t.id,Qe))}}),v.jsx(IR,{isOpen:u,onClose:()=>h(!1),currentUser:t}),v.jsx(Oj,{isOpen:ot,onClose:()=>Rt(!1),students:d,onImport:Ia,currentClassName:Xn}),v.jsx(fR,{isSidebarOpen:D,setIsSidebarOpen:L,onOpenSettings:()=>_e(!0),onOpenTemplates:()=>It(!0),onOpenClasses:()=>St(!0),onOpenAdmin:()=>h(!0),onOpenImportExport:()=>Rt(!0),onLogout:e,hasApiKey:ve,templateCount:ht,currentClassName:Xn,currentUser:t,isAdmin:r}),v.jsxs("div",{className:"flex flex-col flex-1 w-full mx-auto relative",children:[v.jsxs("div",{className:"p-3 sm:p-6 bg-[#FFFDF5] border-b-4 border-[#2D3436] flex flex-col lg:flex-row gap-4 sm:gap-6 items-stretch",children:[v.jsx(gR,{rawInput:C,setRawInput:F,numberCount:V,setNumberCount:M,onGenerateStudents:wn,onGenerateNumbers:hi,onResetList:En,isGenerating:ke}),v.jsx(xR,{students:d,selectedIds:x,isGenerating:ke,extraSettings:Ee,setExtraSettings:st,onGenerateSelected:()=>Qn(!0),onGenerateAll:()=>Qn(!1),onDownload:Zt,onDeleteSelected:di,onResetList:En})]}),v.jsxs("div",{className:"flex-1 p-3 sm:p-6",children:[v.jsx(vR,{globalStyles:O,onOpenStyleModal:()=>Z(!0),isGenerating:ke}),v.jsx(yR,{students:d,selectedIds:x,focusedStudentId:De,isGenerating:ke,isGeneratingSingle:Y,onToggleSelection:b,onToggleAllSelection:j,onFocusStudent:Ne,onOpenSidebar:()=>L(!0),onRemoveTag:G,onUpdateStudent:w,onDeleteStudent:S,onGenerateSingle:As,onSaveTemplate:Cs,onOpenHistory:Qe=>{Jr(Qe),Un(!0)}})]}),v.jsx(wR,{isOpen:D,onClose:()=>L(!1),selectedIds:x,expandedCategories:Gr,onToggleCategory:Ks,onIdiomClick:us})]}),v.jsx(hR,{}),v.jsx(kR,{})]})},Mj=({onLogin:t})=>{const[e,r]=tf.useState(!1),[n,s]=tf.useState(null),i=async()=>{r(!0),s(null);const o=await Eg.signInWithGoogle();o.success||s(o.error),r(!1)};return v.jsx("div",{className:"min-h-screen bg-[#FFF9E6] flex items-center justify-center p-4",children:v.jsxs("div",{className:"card-pop w-full max-w-md p-8 text-center",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("div",{className:"inline-block bg-[#FECA57] text-[#2D3436] p-4 border-3 border-[#2D3436] shadow-[4px_4px_0_#2D3436] transform rotate-[-3deg] rounded-lg mb-4",children:v.jsx("span",{className:"text-5xl",children:""})}),v.jsx("h1",{className:"text-3xl font-black text-[#2D3436]",children:v.jsxs("span",{className:"relative",children:[v.jsx("span",{className:"relative z-10",children:""}),v.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-3 bg-[#FF6B9D] -z-0 transform -rotate-1"})]})}),v.jsx("p",{className:"text-[#636E72] font-bold mt-2",children:"AI "})]}),v.jsx("div",{className:"bg-[#54A0FF]/20 border-2 border-dashed border-[#54A0FF] rounded-lg p-4 mb-6 text-left",children:v.jsx("p",{className:"text-sm text-[#2D3436] font-medium",children:"  Google "})}),n&&v.jsxs("div",{className:"bg-[#FF6B6B]/20 border-2 border-[#FF6B6B] rounded-lg p-3 mb-4 text-sm text-[#FF6B6B] font-bold",children:[" ",n]}),v.jsx("button",{onClick:i,disabled:e,className:"btn-pop w-full py-4 bg-white text-[#2D3436] font-bold flex items-center justify-center gap-3 text-lg disabled:opacity-50",children:e?v.jsx("span",{className:"animate-spin text-2xl",children:""}):v.jsxs(v.Fragment,{children:[v.jsxs("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",children:[v.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),v.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),v.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),v.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})," Google "]})}),v.jsx("p",{className:"text-xs text-[#636E72]/50 mt-6",children:" 2026 "})]})})},Bj=({user:t,onLogout:e})=>v.jsx("div",{className:"min-h-screen bg-[#FFF9E6] flex items-center justify-center p-4",children:v.jsxs("div",{className:"card-pop w-full max-w-md p-8 text-center",children:[v.jsx("div",{className:"mb-6",children:t!=null&&t.photoURL?v.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-20 h-20 rounded-full border-3 border-[#2D3436] shadow-[3px_3px_0_#2D3436] mx-auto"}):v.jsx("div",{className:"w-20 h-20 bg-[#FECA57] rounded-full border-3 border-[#2D3436] shadow-[3px_3px_0_#2D3436] mx-auto flex items-center justify-center",children:v.jsx("span",{className:"text-4xl",children:""})})}),v.jsxs("h2",{className:"text-2xl font-black text-[#2D3436] mb-2",children:["",(t==null?void 0:t.displayName)||"",""]}),v.jsx("p",{className:"text-[#636E72] text-sm mb-6",children:t==null?void 0:t.email}),v.jsxs("div",{className:"bg-[#FECA57]/30 border-3 border-[#FECA57] rounded-lg p-6 mb-6",children:[v.jsx("div",{className:"text-4xl mb-3 animate-bounce",children:v.jsx(Tc,{size:48,className:"mx-auto text-[#FF9F43]"})}),v.jsx("h3",{className:"text-xl font-black text-[#2D3436] mb-2",children:" "}),v.jsxs("p",{className:"text-sm text-[#636E72] font-medium",children:["",v.jsx("br",{}),""]})]}),v.jsx("div",{className:"bg-[#54A0FF]/10 border-2 border-dashed border-[#54A0FF] rounded-lg p-4 mb-6 text-left",children:v.jsxs("p",{className:"text-xs text-[#636E72]",children:[" ",v.jsx("strong",{children:""})," (cagooo@gmail.com) "]})}),v.jsx("button",{onClick:e,className:"btn-pop px-6 py-3 bg-[#636E72] text-white font-bold",children:""})]})}),Vj=({children:t})=>{var g;const[e,r]=Te.useState(null),[n,s]=Te.useState(!0),[i,o]=Te.useState([]),[c,u]=Te.useState([]);Te.useEffect(()=>{const x=Eg.onAuthStateChange(y=>{r(y),s(!1)});return()=>x()},[]),Te.useEffect(()=>{if(!e||!da.isApproved(e))return;const x=F0.subscribe(k=>{o(k)}),y=ha.subscribe(k=>{u(k)});return()=>{x(),y()}},[e]);const h=e?{...e,schoolName:e.schoolId?(g=i.find(x=>x.id===e.schoolId))==null?void 0:g.name:null,assignedClassNames:(e.assignedClasses||[]).map(x=>{var y;return(y=c.find(k=>k.id===x))==null?void 0:y.name}).filter(Boolean)}:null,d=async()=>{await Eg.signOut(),r(null)};return n?v.jsx("div",{className:"min-h-screen bg-[#FFF9E6] flex items-center justify-center",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"text-6xl animate-bounce mb-4",children:""}),v.jsx("p",{className:"font-bold text-[#2D3436]",children:"..."})]})}):e?da.isApproved(e)?tf.cloneElement(t,{currentUser:h,onLogout:d,isAdmin:da.isAdmin(e)}):v.jsx(Bj,{user:e,onLogout:d}):v.jsx(Mj,{})};class jj extends tf.Component{constructor(r){super(r);cm(this,"handleReload",()=>{window.location.reload()});cm(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){this.setState({errorInfo:n}),console.error(" ErrorBoundary :",r,n)}render(){return this.state.hasError?v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-[#FFF9E6] to-[#FFE4E1] p-4",children:v.jsxs("div",{className:"card-pop max-w-md w-full p-8 bg-white text-center",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-[#FF6B6B]/20 rounded-full mb-4",children:v.jsx(jw,{size:40,className:"text-[#FF6B6B]"})}),v.jsx("div",{className:"text-4xl",children:""})]}),v.jsx("h1",{className:"text-2xl font-black text-[#2D3436] mb-2",children:""}),v.jsx("p",{className:"text-[#636E72] mb-6",children:""}),!1,v.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[v.jsx("button",{onClick:this.handleReset,className:"btn-pop flex-1 py-3 px-4 bg-[#636E72] text-white font-bold flex items-center justify-center gap-2",children:""}),v.jsxs("button",{onClick:this.handleReload,className:"btn-pop flex-1 py-3 px-4 bg-[#FF6B9D] text-white font-bold flex items-center justify-center gap-2",children:[v.jsx(Bw,{size:18}),""]})]}),v.jsx("p",{className:"mt-6 text-xs text-[#636E72]",children:""})]})}):this.props.children}}BA.createRoot(document.getElementById("root")).render(v.jsx(tf.StrictMode,{children:v.jsx(jj,{children:v.jsx(o3,{children:v.jsx(Vj,{children:v.jsx(Lj,{})})})})}));
