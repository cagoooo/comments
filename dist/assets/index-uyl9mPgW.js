const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AdminPanel-BvaILyQP.js","assets/file-text-Cou1lwIe.js","assets/ImportExportModal-BQWD408T.js","assets/file-down-EZ92qYj4.js","assets/PrintModal-B0FJCx7k.js","assets/DashboardModal-DWUNL89m.js"])))=>i.map(i=>d[i]);
var y4=Object.defineProperty;var w4=(t,e,r)=>e in t?y4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Zp=(t,e,r)=>w4(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Gh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var em={exports:{}},Au={},tm={exports:{}},yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S_;function E4(){if(S_)return yt;S_=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function x(ee){return ee===null||typeof ee!="object"?null:(ee=g&&ee[g]||ee["@@iterator"],typeof ee=="function"?ee:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,y={};function T(ee,b,te){this.props=ee,this.context=b,this.refs=y,this.updater=te||_}T.prototype.isReactComponent={},T.prototype.setState=function(ee,b){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,b,"setState")},T.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function R(){}R.prototype=T.prototype;function O(ee,b,te){this.props=ee,this.context=b,this.refs=y,this.updater=te||_}var N=O.prototype=new R;N.constructor=O,S(N,T.prototype),N.isPureReactComponent=!0;var U=Array.isArray,X=Object.prototype.hasOwnProperty,G={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function F(ee,b,te){var J,Z={},oe=null,_e=null;if(b!=null)for(J in b.ref!==void 0&&(_e=b.ref),b.key!==void 0&&(oe=""+b.key),b)X.call(b,J)&&!k.hasOwnProperty(J)&&(Z[J]=b[J]);var ve=arguments.length-2;if(ve===1)Z.children=te;else if(1<ve){for(var xe=Array(ve),Ee=0;Ee<ve;Ee++)xe[Ee]=arguments[Ee+2];Z.children=xe}if(ee&&ee.defaultProps)for(J in ve=ee.defaultProps,ve)Z[J]===void 0&&(Z[J]=ve[J]);return{$$typeof:t,type:ee,key:oe,ref:_e,props:Z,_owner:G.current}}function I(ee,b){return{$$typeof:t,type:ee.type,key:b,ref:ee.ref,props:ee.props,_owner:ee._owner}}function B(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===t}function L(ee){var b={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(te){return b[te]})}var M=/\/+/g;function V(ee,b){return typeof ee=="object"&&ee!==null&&ee.key!=null?L(""+ee.key):b.toString(36)}function Fe(ee,b,te,J,Z){var oe=typeof ee;(oe==="undefined"||oe==="boolean")&&(ee=null);var _e=!1;if(ee===null)_e=!0;else switch(oe){case"string":case"number":_e=!0;break;case"object":switch(ee.$$typeof){case t:case e:_e=!0}}if(_e)return _e=ee,Z=Z(_e),ee=J===""?"."+V(_e,0):J,U(Z)?(te="",ee!=null&&(te=ee.replace(M,"$&/")+"/"),Fe(Z,b,te,"",function(Ee){return Ee})):Z!=null&&(B(Z)&&(Z=I(Z,te+(!Z.key||_e&&_e.key===Z.key?"":(""+Z.key).replace(M,"$&/")+"/")+ee)),b.push(Z)),1;if(_e=0,J=J===""?".":J+":",U(ee))for(var ve=0;ve<ee.length;ve++){oe=ee[ve];var xe=J+V(oe,ve);_e+=Fe(oe,b,te,xe,Z)}else if(xe=x(ee),typeof xe=="function")for(ee=xe.call(ee),ve=0;!(oe=ee.next()).done;)oe=oe.value,xe=J+V(oe,ve++),_e+=Fe(oe,b,te,xe,Z);else if(oe==="object")throw b=String(ee),Error("Objects are not valid as a React child (found: "+(b==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":b)+"). If you meant to render a collection of children, use an array instead.");return _e}function Ce(ee,b,te){if(ee==null)return ee;var J=[],Z=0;return Fe(ee,J,"","",function(oe){return b.call(te,oe,Z++)}),J}function Le(ee){if(ee._status===-1){var b=ee._result;b=b(),b.then(function(te){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=te)},function(te){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=te)}),ee._status===-1&&(ee._status=0,ee._result=b)}if(ee._status===1)return ee._result.default;throw ee._result}var Ne={current:null},Se={transition:null},ne={ReactCurrentDispatcher:Ne,ReactCurrentBatchConfig:Se,ReactCurrentOwner:G};function ye(){throw Error("act(...) is not supported in production builds of React.")}return yt.Children={map:Ce,forEach:function(ee,b,te){Ce(ee,function(){b.apply(this,arguments)},te)},count:function(ee){var b=0;return Ce(ee,function(){b++}),b},toArray:function(ee){return Ce(ee,function(b){return b})||[]},only:function(ee){if(!B(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}},yt.Component=T,yt.Fragment=r,yt.Profiler=s,yt.PureComponent=O,yt.StrictMode=n,yt.Suspense=f,yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,yt.act=ye,yt.cloneElement=function(ee,b,te){if(ee==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ee+".");var J=S({},ee.props),Z=ee.key,oe=ee.ref,_e=ee._owner;if(b!=null){if(b.ref!==void 0&&(oe=b.ref,_e=G.current),b.key!==void 0&&(Z=""+b.key),ee.type&&ee.type.defaultProps)var ve=ee.type.defaultProps;for(xe in b)X.call(b,xe)&&!k.hasOwnProperty(xe)&&(J[xe]=b[xe]===void 0&&ve!==void 0?ve[xe]:b[xe])}var xe=arguments.length-2;if(xe===1)J.children=te;else if(1<xe){ve=Array(xe);for(var Ee=0;Ee<xe;Ee++)ve[Ee]=arguments[Ee+2];J.children=ve}return{$$typeof:t,type:ee.type,key:Z,ref:oe,props:J,_owner:_e}},yt.createContext=function(ee){return ee={$$typeof:o,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ee.Provider={$$typeof:i,_context:ee},ee.Consumer=ee},yt.createElement=F,yt.createFactory=function(ee){var b=F.bind(null,ee);return b.type=ee,b},yt.createRef=function(){return{current:null}},yt.forwardRef=function(ee){return{$$typeof:c,render:ee}},yt.isValidElement=B,yt.lazy=function(ee){return{$$typeof:d,_payload:{_status:-1,_result:ee},_init:Le}},yt.memo=function(ee,b){return{$$typeof:h,type:ee,compare:b===void 0?null:b}},yt.startTransition=function(ee){var b=Se.transition;Se.transition={};try{ee()}finally{Se.transition=b}},yt.unstable_act=ye,yt.useCallback=function(ee,b){return Ne.current.useCallback(ee,b)},yt.useContext=function(ee){return Ne.current.useContext(ee)},yt.useDebugValue=function(){},yt.useDeferredValue=function(ee){return Ne.current.useDeferredValue(ee)},yt.useEffect=function(ee,b){return Ne.current.useEffect(ee,b)},yt.useId=function(){return Ne.current.useId()},yt.useImperativeHandle=function(ee,b,te){return Ne.current.useImperativeHandle(ee,b,te)},yt.useInsertionEffect=function(ee,b){return Ne.current.useInsertionEffect(ee,b)},yt.useLayoutEffect=function(ee,b){return Ne.current.useLayoutEffect(ee,b)},yt.useMemo=function(ee,b){return Ne.current.useMemo(ee,b)},yt.useReducer=function(ee,b,te){return Ne.current.useReducer(ee,b,te)},yt.useRef=function(ee){return Ne.current.useRef(ee)},yt.useState=function(ee){return Ne.current.useState(ee)},yt.useSyncExternalStore=function(ee,b,te){return Ne.current.useSyncExternalStore(ee,b,te)},yt.useTransition=function(){return Ne.current.useTransition()},yt.version="18.3.1",yt}var k_;function S1(){return k_||(k_=1,tm.exports=E4()),tm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A_;function T4(){if(A_)return Au;A_=1;var t=S1(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(c,f,h){var d,g={},x=null,_=null;h!==void 0&&(x=""+h),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(_=f.ref);for(d in f)n.call(f,d)&&!i.hasOwnProperty(d)&&(g[d]=f[d]);if(c&&c.defaultProps)for(d in f=c.defaultProps,f)g[d]===void 0&&(g[d]=f[d]);return{$$typeof:e,type:c,key:x,ref:_,props:g,_owner:s.current}}return Au.Fragment=r,Au.jsx=o,Au.jsxs=o,Au}var C_;function S4(){return C_||(C_=1,em.exports=T4()),em.exports}var C=S4(),Oe=S1();const Xu=kw(Oe);var qh={},rm={exports:{}},es={},nm={exports:{}},sm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I_;function k4(){return I_||(I_=1,(function(t){function e(Se,ne){var ye=Se.length;Se.push(ne);e:for(;0<ye;){var ee=ye-1>>>1,b=Se[ee];if(0<s(b,ne))Se[ee]=ne,Se[ye]=b,ye=ee;else break e}}function r(Se){return Se.length===0?null:Se[0]}function n(Se){if(Se.length===0)return null;var ne=Se[0],ye=Se.pop();if(ye!==ne){Se[0]=ye;e:for(var ee=0,b=Se.length,te=b>>>1;ee<te;){var J=2*(ee+1)-1,Z=Se[J],oe=J+1,_e=Se[oe];if(0>s(Z,ye))oe<b&&0>s(_e,Z)?(Se[ee]=_e,Se[oe]=ye,ee=oe):(Se[ee]=Z,Se[J]=ye,ee=J);else if(oe<b&&0>s(_e,ye))Se[ee]=_e,Se[oe]=ye,ee=oe;else break e}}return ne}function s(Se,ne){var ye=Se.sortIndex-ne.sortIndex;return ye!==0?ye:Se.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var f=[],h=[],d=1,g=null,x=3,_=!1,S=!1,y=!1,T=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Se){for(var ne=r(h);ne!==null;){if(ne.callback===null)n(h);else if(ne.startTime<=Se)n(h),ne.sortIndex=ne.expirationTime,e(f,ne);else break;ne=r(h)}}function U(Se){if(y=!1,N(Se),!S)if(r(f)!==null)S=!0,Le(X);else{var ne=r(h);ne!==null&&Ne(U,ne.startTime-Se)}}function X(Se,ne){S=!1,y&&(y=!1,R(F),F=-1),_=!0;var ye=x;try{for(N(ne),g=r(f);g!==null&&(!(g.expirationTime>ne)||Se&&!L());){var ee=g.callback;if(typeof ee=="function"){g.callback=null,x=g.priorityLevel;var b=ee(g.expirationTime<=ne);ne=t.unstable_now(),typeof b=="function"?g.callback=b:g===r(f)&&n(f),N(ne)}else n(f);g=r(f)}if(g!==null)var te=!0;else{var J=r(h);J!==null&&Ne(U,J.startTime-ne),te=!1}return te}finally{g=null,x=ye,_=!1}}var G=!1,k=null,F=-1,I=5,B=-1;function L(){return!(t.unstable_now()-B<I)}function M(){if(k!==null){var Se=t.unstable_now();B=Se;var ne=!0;try{ne=k(!0,Se)}finally{ne?V():(G=!1,k=null)}}else G=!1}var V;if(typeof O=="function")V=function(){O(M)};else if(typeof MessageChannel<"u"){var Fe=new MessageChannel,Ce=Fe.port2;Fe.port1.onmessage=M,V=function(){Ce.postMessage(null)}}else V=function(){T(M,0)};function Le(Se){k=Se,G||(G=!0,V())}function Ne(Se,ne){F=T(function(){Se(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Se){Se.callback=null},t.unstable_continueExecution=function(){S||_||(S=!0,Le(X))},t.unstable_forceFrameRate=function(Se){0>Se||125<Se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Se?Math.floor(1e3/Se):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return r(f)},t.unstable_next=function(Se){switch(x){case 1:case 2:case 3:var ne=3;break;default:ne=x}var ye=x;x=ne;try{return Se()}finally{x=ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Se,ne){switch(Se){case 1:case 2:case 3:case 4:case 5:break;default:Se=3}var ye=x;x=Se;try{return ne()}finally{x=ye}},t.unstable_scheduleCallback=function(Se,ne,ye){var ee=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?ee+ye:ee):ye=ee,Se){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=ye+b,Se={id:d++,callback:ne,priorityLevel:Se,startTime:ye,expirationTime:b,sortIndex:-1},ye>ee?(Se.sortIndex=ye,e(h,Se),r(f)===null&&Se===r(h)&&(y?(R(F),F=-1):y=!0,Ne(U,ye-ee))):(Se.sortIndex=b,e(f,Se),S||_||(S=!0,Le(X))),Se},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(Se){var ne=x;return function(){var ye=x;x=ne;try{return Se.apply(this,arguments)}finally{x=ye}}}})(sm)),sm}var F_;function A4(){return F_||(F_=1,nm.exports=k4()),nm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R_;function C4(){if(R_)return es;R_=1;var t=S1(),e=A4();function r(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,u=1;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function i(a,l){o(a,l),o(a+"Capture",l)}function o(a,l){for(s[a]=l,a=0;a<l.length;a++)n.add(l[a])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},g={};function x(a){return f.call(g,a)?!0:f.call(d,a)?!1:h.test(a)?g[a]=!0:(d[a]=!0,!1)}function _(a,l,u,m){if(u!==null&&u.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return m?!1:u!==null?!u.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function S(a,l,u,m){if(l===null||typeof l>"u"||_(a,l,u,m))return!0;if(m)return!1;if(u!==null)switch(u.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function y(a,l,u,m,v,w,D){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=u,this.propertyName=a,this.type=l,this.sanitizeURL=w,this.removeEmptyString=D}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){T[a]=new y(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var l=a[0];T[l]=new y(l,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){T[a]=new y(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){T[a]=new y(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){T[a]=new y(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){T[a]=new y(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){T[a]=new y(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){T[a]=new y(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){T[a]=new y(a,5,!1,a.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function O(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var l=a.replace(R,O);T[l]=new y(l,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var l=a.replace(R,O);T[l]=new y(l,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var l=a.replace(R,O);T[l]=new y(l,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){T[a]=new y(a,1,!1,a.toLowerCase(),null,!1,!1)}),T.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){T[a]=new y(a,1,!1,a.toLowerCase(),null,!0,!0)});function N(a,l,u,m){var v=T.hasOwnProperty(l)?T[l]:null;(v!==null?v.type!==0:m||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(S(l,u,v,m)&&(u=null),m||v===null?x(l)&&(u===null?a.removeAttribute(l):a.setAttribute(l,""+u)):v.mustUseProperty?a[v.propertyName]=u===null?v.type===3?!1:"":u:(l=v.attributeName,m=v.attributeNamespace,u===null?a.removeAttribute(l):(v=v.type,u=v===3||v===4&&u===!0?"":""+u,m?a.setAttributeNS(m,l,u):a.setAttribute(l,u))))}var U=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,X=Symbol.for("react.element"),G=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),L=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),Fe=Symbol.for("react.suspense_list"),Ce=Symbol.for("react.memo"),Le=Symbol.for("react.lazy"),Ne=Symbol.for("react.offscreen"),Se=Symbol.iterator;function ne(a){return a===null||typeof a!="object"?null:(a=Se&&a[Se]||a["@@iterator"],typeof a=="function"?a:null)}var ye=Object.assign,ee;function b(a){if(ee===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);ee=l&&l[1]||""}return`
`+ee+a}var te=!1;function J(a,l){if(!a||te)return"";te=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(de){var m=de}Reflect.construct(a,[],l)}else{try{l.call()}catch(de){m=de}a.call(l.prototype)}else{try{throw Error()}catch(de){m=de}a()}}catch(de){if(de&&m&&typeof de.stack=="string"){for(var v=de.stack.split(`
`),w=m.stack.split(`
`),D=v.length-1,Q=w.length-1;1<=D&&0<=Q&&v[D]!==w[Q];)Q--;for(;1<=D&&0<=Q;D--,Q--)if(v[D]!==w[Q]){if(D!==1||Q!==1)do if(D--,Q--,0>Q||v[D]!==w[Q]){var re=`
`+v[D].replace(" at new "," at ");return a.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",a.displayName)),re}while(1<=D&&0<=Q);break}}}finally{te=!1,Error.prepareStackTrace=u}return(a=a?a.displayName||a.name:"")?b(a):""}function Z(a){switch(a.tag){case 5:return b(a.type);case 16:return b("Lazy");case 13:return b("Suspense");case 19:return b("SuspenseList");case 0:case 2:case 15:return a=J(a.type,!1),a;case 11:return a=J(a.type.render,!1),a;case 1:return a=J(a.type,!0),a;default:return""}}function oe(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case k:return"Fragment";case G:return"Portal";case I:return"Profiler";case F:return"StrictMode";case V:return"Suspense";case Fe:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case L:return(a.displayName||"Context")+".Consumer";case B:return(a._context.displayName||"Context")+".Provider";case M:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Ce:return l=a.displayName||null,l!==null?l:oe(a.type)||"Memo";case Le:l=a._payload,a=a._init;try{return oe(a(l))}catch{}}return null}function _e(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oe(l);case 8:return l===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ve(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function xe(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ee(a){var l=xe(a)?"checked":"value",u=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),m=""+a[l];if(!a.hasOwnProperty(l)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var v=u.get,w=u.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return v.call(this)},set:function(D){m=""+D,w.call(this,D)}}),Object.defineProperty(a,l,{enumerable:u.enumerable}),{getValue:function(){return m},setValue:function(D){m=""+D},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function st(a){a._valueTracker||(a._valueTracker=Ee(a))}function Y(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var u=l.getValue(),m="";return a&&(m=xe(a)?a.checked?"true":"false":a.value),a=m,a!==u?(l.setValue(a),!0):!1}function Et(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function gt(a,l){var u=l.checked;return ye({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??a._wrapperState.initialChecked})}function It(a,l){var u=l.defaultValue==null?"":l.defaultValue,m=l.checked!=null?l.checked:l.defaultChecked;u=ve(l.value!=null?l.value:u),a._wrapperState={initialChecked:m,initialValue:u,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function ht(a,l){l=l.checked,l!=null&&N(a,"checked",l,!1)}function Ue(a,l){ht(a,l);var u=ve(l.value),m=l.type;if(u!=null)m==="number"?(u===0&&a.value===""||a.value!=u)&&(a.value=""+u):a.value!==""+u&&(a.value=""+u);else if(m==="submit"||m==="reset"){a.removeAttribute("value");return}l.hasOwnProperty("value")?St(a,l.type,u):l.hasOwnProperty("defaultValue")&&St(a,l.type,ve(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(a.defaultChecked=!!l.defaultChecked)}function Ht(a,l,u){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var m=l.type;if(!(m!=="submit"&&m!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+a._wrapperState.initialValue,u||l===a.value||(a.value=l),a.defaultValue=l}u=a.name,u!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,u!==""&&(a.name=u)}function St(a,l,u){(l!=="number"||Et(a.ownerDocument)!==a)&&(u==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+u&&(a.defaultValue=""+u))}var Tt=Array.isArray;function dr(a,l,u,m){if(a=a.options,l){l={};for(var v=0;v<u.length;v++)l["$"+u[v]]=!0;for(u=0;u<a.length;u++)v=l.hasOwnProperty("$"+a[u].value),a[u].selected!==v&&(a[u].selected=v),v&&m&&(a[u].defaultSelected=!0)}else{for(u=""+ve(u),l=null,v=0;v<a.length;v++){if(a[v].value===u){a[v].selected=!0,m&&(a[v].defaultSelected=!0);return}l!==null||a[v].disabled||(l=a[v])}l!==null&&(l.selected=!0)}}function gn(a,l){if(l.dangerouslySetInnerHTML!=null)throw Error(r(91));return ye({},l,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function sn(a,l){var u=l.value;if(u==null){if(u=l.children,l=l.defaultValue,u!=null){if(l!=null)throw Error(r(92));if(Tt(u)){if(1<u.length)throw Error(r(93));u=u[0]}l=u}l==null&&(l=""),u=l}a._wrapperState={initialValue:ve(u)}}function Wr(a,l){var u=ve(l.value),m=ve(l.defaultValue);u!=null&&(u=""+u,u!==a.value&&(a.value=u),l.defaultValue==null&&a.defaultValue!==u&&(a.defaultValue=u)),m!=null&&(a.defaultValue=""+m)}function Pr(a){var l=a.textContent;l===a._wrapperState.initialValue&&l!==""&&l!==null&&(a.value=l)}function xn(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vn(a,l){return a==null||a==="http://www.w3.org/1999/xhtml"?xn(l):a==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var $t,Yr=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,u,m,v){MSApp.execUnsafeLocalFunction(function(){return a(l,u,m,v)})}:a})(function(a,l){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=l;else{for($t=$t||document.createElement("div"),$t.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=$t.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}});function ot(a,l){if(l){var u=a.firstChild;if(u&&u===a.lastChild&&u.nodeType===3){u.nodeValue=l;return}}a.textContent=l}var Nt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Hr=["Webkit","ms","Moz","O"];Object.keys(Nt).forEach(function(a){Hr.forEach(function(l){l=l+a.charAt(0).toUpperCase()+a.substring(1),Nt[l]=Nt[a]})});function Mt(a,l,u){return l==null||typeof l=="boolean"||l===""?"":u||typeof l!="number"||l===0||Nt.hasOwnProperty(a)&&Nt[a]?(""+l).trim():l+"px"}function vn(a,l){a=a.style;for(var u in l)if(l.hasOwnProperty(u)){var m=u.indexOf("--")===0,v=Mt(u,l[u],m);u==="float"&&(u="cssFloat"),m?a.setProperty(u,v):a[u]=v}}var Ws=ye({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bn(a,l){if(l){if(Ws[a]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(r(137,a));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(r(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(r(61))}if(l.style!=null&&typeof l.style!="object")throw Error(r(62))}}function fi(a,l){if(a.indexOf("-")===-1)return typeof l.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var as=null;function Hs(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Un=null,os=null,er=null;function Ts(a){if(a=fu(a)){if(typeof Un!="function")throw Error(r(280));var l=a.stateNode;l&&(l=oh(l),Un(a.stateNode,a.type,l))}}function Ss(a){os?er?er.push(a):er=[a]:os=a}function ls(){if(os){var a=os,l=er;if(er=os=null,Ts(a),l)for(a=0;a<l.length;a++)Ts(l[a])}}function Ta(a,l){return a(l)}function Sa(){}var Kn=!1;function ka(a,l,u){if(Kn)return a(l,u);Kn=!0;try{return Ta(a,l,u)}finally{Kn=!1,(os!==null||er!==null)&&(Sa(),ls())}}function $s(a,l){var u=a.stateNode;if(u===null)return null;var m=oh(u);if(m===null)return null;u=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(u&&typeof u!="function")throw Error(r(231,l,typeof u));return u}var Qe=!1;if(c)try{var Je={};Object.defineProperty(Je,"passive",{get:function(){Qe=!0}}),window.addEventListener("test",Je,Je),window.removeEventListener("test",Je,Je)}catch{Qe=!1}function jt(a,l,u,m,v,w,D,Q,re){var de=Array.prototype.slice.call(arguments,3);try{l.apply(u,de)}catch(Ie){this.onError(Ie)}}var Jt=!1,nr=null,P=!1,H=null,j={onError:function(a){Jt=!0,nr=a}};function W(a,l,u,m,v,w,D,Q,re){Jt=!1,nr=null,jt.apply(j,arguments)}function q(a,l,u,m,v,w,D,Q,re){if(W.apply(this,arguments),Jt){if(Jt){var de=nr;Jt=!1,nr=null}else throw Error(r(198));P||(P=!0,H=de)}}function K(a){var l=a,u=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(u=l.return),a=l.return;while(a)}return l.tag===3?u:null}function ce(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function ge(a){if(K(a)!==a)throw Error(r(188))}function le(a){var l=a.alternate;if(!l){if(l=K(a),l===null)throw Error(r(188));return l!==a?null:a}for(var u=a,m=l;;){var v=u.return;if(v===null)break;var w=v.alternate;if(w===null){if(m=v.return,m!==null){u=m;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===u)return ge(v),a;if(w===m)return ge(v),l;w=w.sibling}throw Error(r(188))}if(u.return!==m.return)u=v,m=w;else{for(var D=!1,Q=v.child;Q;){if(Q===u){D=!0,u=v,m=w;break}if(Q===m){D=!0,m=v,u=w;break}Q=Q.sibling}if(!D){for(Q=w.child;Q;){if(Q===u){D=!0,u=w,m=v;break}if(Q===m){D=!0,m=w,u=v;break}Q=Q.sibling}if(!D)throw Error(r(189))}}if(u.alternate!==m)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?a:l}function fe(a){return a=le(a),a!==null?he(a):null}function he(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=he(a);if(l!==null)return l;a=a.sibling}return null}var Re=e.unstable_scheduleCallback,Ve=e.unstable_cancelCallback,We=e.unstable_shouldYield,De=e.unstable_requestPaint,Pe=e.unstable_now,ct=e.unstable_getCurrentPriorityLevel,zt=e.unstable_ImmediatePriority,Gt=e.unstable_UserBlockingPriority,fr=e.unstable_NormalPriority,Gs=e.unstable_LowPriority,ks=e.unstable_IdlePriority,cs=null,Ar=null;function Aa(a){if(Ar&&typeof Ar.onCommitFiberRoot=="function")try{Ar.onCommitFiberRoot(cs,a,void 0,(a.current.flags&128)===128)}catch{}}var pr=Math.clz32?Math.clz32:So,hi=Math.log,As=Math.LN2;function So(a){return a>>>=0,a===0?32:31-(hi(a)/As|0)|0}var di=64,Ca=4194304;function Vt(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Hi(a,l){var u=a.pendingLanes;if(u===0)return 0;var m=0,v=a.suspendedLanes,w=a.pingedLanes,D=u&268435455;if(D!==0){var Q=D&~v;Q!==0?m=Vt(Q):(w&=D,w!==0&&(m=Vt(w)))}else D=u&~v,D!==0?m=Vt(D):w!==0&&(m=Vt(w));if(m===0)return 0;if(l!==0&&l!==m&&(l&v)===0&&(v=m&-m,w=l&-l,v>=w||v===16&&(w&4194240)!==0))return l;if((m&4)!==0&&(m|=u&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=m;0<l;)u=31-pr(l),v=1<<u,m|=a[u],l&=~v;return m}function ko(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ao(a,l){for(var u=a.suspendedLanes,m=a.pingedLanes,v=a.expirationTimes,w=a.pendingLanes;0<w;){var D=31-pr(w),Q=1<<D,re=v[D];re===-1?((Q&u)===0||(Q&m)!==0)&&(v[D]=ko(Q,l)):re<=l&&(a.expiredLanes|=Q),w&=~Q}}function Hc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function $c(){var a=di;return di<<=1,(di&4194240)===0&&(di=64),a}function Gc(a){for(var l=[],u=0;31>u;u++)l.push(a);return l}function Co(a,l,u){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-pr(l),a[l]=u}function Nd(a,l){var u=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var m=a.eventTimes;for(a=a.expirationTimes;0<u;){var v=31-pr(u),w=1<<v;l[v]=0,m[v]=-1,a[v]=-1,u&=~w}}function qc(a,l){var u=a.entangledLanes|=l;for(a=a.entanglements;u;){var m=31-pr(u),v=1<<m;v&l|a[m]&l&&(a[m]|=l),u&=~v}}var Ft=0;function pi(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Kc,kl,Xc,Yc,Qc,mi=!1,Al=[],gi=null,xi=null,an=null,Io=new Map,$i=new Map,us=[],$f="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ia(a,l){switch(a){case"focusin":case"focusout":gi=null;break;case"dragenter":case"dragleave":xi=null;break;case"mouseover":case"mouseout":an=null;break;case"pointerover":case"pointerout":Io.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":$i.delete(l.pointerId)}}function qs(a,l,u,m,v,w){return a===null||a.nativeEvent!==w?(a={blockedOn:l,domEventName:u,eventSystemFlags:m,nativeEvent:w,targetContainers:[v]},l!==null&&(l=fu(l),l!==null&&kl(l)),a):(a.eventSystemFlags|=m,l=a.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),a)}function Gf(a,l,u,m,v){switch(l){case"focusin":return gi=qs(gi,a,l,u,m,v),!0;case"dragenter":return xi=qs(xi,a,l,u,m,v),!0;case"mouseover":return an=qs(an,a,l,u,m,v),!0;case"pointerover":var w=v.pointerId;return Io.set(w,qs(Io.get(w)||null,a,l,u,m,v)),!0;case"gotpointercapture":return w=v.pointerId,$i.set(w,qs($i.get(w)||null,a,l,u,m,v)),!0}return!1}function Cl(a){var l=Do(a.target);if(l!==null){var u=K(l);if(u!==null){if(l=u.tag,l===13){if(l=ce(u),l!==null){a.blockedOn=l,Qc(a.priority,function(){Xc(u)});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){a.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Zt(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var u=Il(a.domEventName,a.eventSystemFlags,l[0],a.nativeEvent);if(u===null){u=a.nativeEvent;var m=new u.constructor(u.type,u);as=m,u.target.dispatchEvent(m),as=null}else return l=fu(u),l!==null&&kl(l),a.blockedOn=u,!1;l.shift()}return!0}function qf(a,l,u){Zt(a)&&u.delete(l)}function Dd(){mi=!1,gi!==null&&Zt(gi)&&(gi=null),xi!==null&&Zt(xi)&&(xi=null),an!==null&&Zt(an)&&(an=null),Io.forEach(qf),$i.forEach(qf)}function Fa(a,l){a.blockedOn===l&&(a.blockedOn=null,mi||(mi=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Dd)))}function Ra(a){function l(v){return Fa(v,a)}if(0<Al.length){Fa(Al[0],a);for(var u=1;u<Al.length;u++){var m=Al[u];m.blockedOn===a&&(m.blockedOn=null)}}for(gi!==null&&Fa(gi,a),xi!==null&&Fa(xi,a),an!==null&&Fa(an,a),Io.forEach(l),$i.forEach(l),u=0;u<us.length;u++)m=us[u],m.blockedOn===a&&(m.blockedOn=null);for(;0<us.length&&(u=us[0],u.blockedOn===null);)Cl(u),u.blockedOn===null&&us.shift()}var Gi=U.ReactCurrentBatchConfig,qi=!0;function vi(a,l,u,m){var v=Ft,w=Gi.transition;Gi.transition=null;try{Ft=1,Jc(a,l,u,m)}finally{Ft=v,Gi.transition=w}}function Kf(a,l,u,m){var v=Ft,w=Gi.transition;Gi.transition=null;try{Ft=4,Jc(a,l,u,m)}finally{Ft=v,Gi.transition=w}}function Jc(a,l,u,m){if(qi){var v=Il(a,l,u,m);if(v===null)Wd(a,l,m,_i,u),Ia(a,m);else if(Gf(v,a,l,u,m))m.stopPropagation();else if(Ia(a,m),l&4&&-1<$f.indexOf(a)){for(;v!==null;){var w=fu(v);if(w!==null&&Kc(w),w=Il(a,l,u,m),w===null&&Wd(a,l,m,_i,u),w===v)break;v=w}v!==null&&m.stopPropagation()}else Wd(a,l,m,null,u)}}var _i=null;function Il(a,l,u,m){if(_i=null,a=Hs(m),a=Do(a),a!==null)if(l=K(a),l===null)a=null;else if(u=l.tag,u===13){if(a=ce(l),a!==null)return a;a=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null);return _i=a,null}function Fl(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ct()){case zt:return 1;case Gt:return 4;case fr:case Gs:return 16;case ks:return 536870912;default:return 16}default:return 16}}var fs=null,Rl=null,Ki=null;function Xf(){if(Ki)return Ki;var a,l=Rl,u=l.length,m,v="value"in fs?fs.value:fs.textContent,w=v.length;for(a=0;a<u&&l[a]===v[a];a++);var D=u-a;for(m=1;m<=D&&l[u-m]===v[w-m];m++);return Ki=v.slice(a,1<m?1-m:void 0)}function Fo(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function yi(){return!0}function Zc(){return!1}function _n(a){function l(u,m,v,w,D){this._reactName=u,this._targetInst=v,this.type=m,this.nativeEvent=w,this.target=D,this.currentTarget=null;for(var Q in a)a.hasOwnProperty(Q)&&(u=a[Q],this[Q]=u?u(w):w[Q]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?yi:Zc,this.isPropagationStopped=Zc,this}return ye(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=yi)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=yi)},persist:function(){},isPersistent:yi}),l}var wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ro=_n(wi),Na=ye({},wi,{view:0,detail:0}),Nl=_n(Na),Dl,Pl,hs,No=ye({},Na,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pt,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==hs&&(hs&&a.type==="mousemove"?(Dl=a.screenX-hs.screenX,Pl=a.screenY-hs.screenY):Pl=Dl=0,hs=a),Dl)},movementY:function(a){return"movementY"in a?a.movementY:Pl}}),eu=_n(No),Yf=ye({},No,{dataTransfer:0}),Qf=_n(Yf),bl=ye({},Na,{relatedTarget:0}),on=_n(bl),Jf=ye({},wi,{animationName:0,elapsedTime:0,pseudoElement:0}),Zf=_n(Jf),Da=ye({},wi,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),p=_n(Da),E=ye({},wi,{data:0}),A=_n(E),z={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ae={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ze(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=pe[a])?!!l[a]:!1}function pt(){return ze}var Cr=ye({},Na,{key:function(a){if(a.key){var l=z[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Fo(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?ae[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pt,charCode:function(a){return a.type==="keypress"?Fo(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Fo(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),qt=_n(Cr),br=ye({},No,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ds=_n(br),Xi=ye({},Na,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pt}),Ei=_n(Xi),Ti=ye({},wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ol=_n(Ti),tu=ye({},No,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),pA=_n(tu),mA=[9,13,27,32],Pd=c&&"CompositionEvent"in window,ru=null;c&&"documentMode"in document&&(ru=document.documentMode);var gA=c&&"TextEvent"in window&&!ru,gx=c&&(!Pd||ru&&8<ru&&11>=ru),xx=" ",vx=!1;function _x(a,l){switch(a){case"keyup":return mA.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yx(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ll=!1;function xA(a,l){switch(a){case"compositionend":return yx(l);case"keypress":return l.which!==32?null:(vx=!0,xx);case"textInput":return a=l.data,a===xx&&vx?null:a;default:return null}}function vA(a,l){if(Ll)return a==="compositionend"||!Pd&&_x(a,l)?(a=Xf(),Ki=Rl=fs=null,Ll=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return gx&&l.locale!=="ko"?null:l.data;default:return null}}var _A={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wx(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!_A[a.type]:l==="textarea"}function Ex(a,l,u,m){Ss(m),l=sh(l,"onChange"),0<l.length&&(u=new Ro("onChange","change",null,u,m),a.push({event:u,listeners:l}))}var nu=null,su=null;function yA(a){Ux(a,0)}function eh(a){var l=jl(a);if(Y(l))return a}function wA(a,l){if(a==="change")return l}var Tx=!1;if(c){var bd;if(c){var Od="oninput"in document;if(!Od){var Sx=document.createElement("div");Sx.setAttribute("oninput","return;"),Od=typeof Sx.oninput=="function"}bd=Od}else bd=!1;Tx=bd&&(!document.documentMode||9<document.documentMode)}function kx(){nu&&(nu.detachEvent("onpropertychange",Ax),su=nu=null)}function Ax(a){if(a.propertyName==="value"&&eh(su)){var l=[];Ex(l,su,a,Hs(a)),ka(yA,l)}}function EA(a,l,u){a==="focusin"?(kx(),nu=l,su=u,nu.attachEvent("onpropertychange",Ax)):a==="focusout"&&kx()}function TA(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return eh(su)}function SA(a,l){if(a==="click")return eh(l)}function kA(a,l){if(a==="input"||a==="change")return eh(l)}function AA(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Ks=typeof Object.is=="function"?Object.is:AA;function iu(a,l){if(Ks(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var u=Object.keys(a),m=Object.keys(l);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++){var v=u[m];if(!f.call(l,v)||!Ks(a[v],l[v]))return!1}return!0}function Cx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Ix(a,l){var u=Cx(a);a=0;for(var m;u;){if(u.nodeType===3){if(m=a+u.textContent.length,a<=l&&m>=l)return{node:u,offset:l-a};a=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Cx(u)}}function Fx(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Fx(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function Rx(){for(var a=window,l=Et();l instanceof a.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)a=l.contentWindow;else break;l=Et(a.document)}return l}function Ld(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function CA(a){var l=Rx(),u=a.focusedElem,m=a.selectionRange;if(l!==u&&u&&u.ownerDocument&&Fx(u.ownerDocument.documentElement,u)){if(m!==null&&Ld(u)){if(l=m.start,a=m.end,a===void 0&&(a=l),"selectionStart"in u)u.selectionStart=l,u.selectionEnd=Math.min(a,u.value.length);else if(a=(l=u.ownerDocument||document)&&l.defaultView||window,a.getSelection){a=a.getSelection();var v=u.textContent.length,w=Math.min(m.start,v);m=m.end===void 0?w:Math.min(m.end,v),!a.extend&&w>m&&(v=m,m=w,w=v),v=Ix(u,w);var D=Ix(u,m);v&&D&&(a.rangeCount!==1||a.anchorNode!==v.node||a.anchorOffset!==v.offset||a.focusNode!==D.node||a.focusOffset!==D.offset)&&(l=l.createRange(),l.setStart(v.node,v.offset),a.removeAllRanges(),w>m?(a.addRange(l),a.extend(D.node,D.offset)):(l.setEnd(D.node,D.offset),a.addRange(l)))}}for(l=[],a=u;a=a.parentNode;)a.nodeType===1&&l.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<l.length;u++)a=l[u],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var IA=c&&"documentMode"in document&&11>=document.documentMode,Ml=null,Md=null,au=null,Vd=!1;function Nx(a,l,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Vd||Ml==null||Ml!==Et(m)||(m=Ml,"selectionStart"in m&&Ld(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),au&&iu(au,m)||(au=m,m=sh(Md,"onSelect"),0<m.length&&(l=new Ro("onSelect","select",null,l,u),a.push({event:l,listeners:m}),l.target=Ml)))}function th(a,l){var u={};return u[a.toLowerCase()]=l.toLowerCase(),u["Webkit"+a]="webkit"+l,u["Moz"+a]="moz"+l,u}var Vl={animationend:th("Animation","AnimationEnd"),animationiteration:th("Animation","AnimationIteration"),animationstart:th("Animation","AnimationStart"),transitionend:th("Transition","TransitionEnd")},Bd={},Dx={};c&&(Dx=document.createElement("div").style,"AnimationEvent"in window||(delete Vl.animationend.animation,delete Vl.animationiteration.animation,delete Vl.animationstart.animation),"TransitionEvent"in window||delete Vl.transitionend.transition);function rh(a){if(Bd[a])return Bd[a];if(!Vl[a])return a;var l=Vl[a],u;for(u in l)if(l.hasOwnProperty(u)&&u in Dx)return Bd[a]=l[u];return a}var Px=rh("animationend"),bx=rh("animationiteration"),Ox=rh("animationstart"),Lx=rh("transitionend"),Mx=new Map,Vx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pa(a,l){Mx.set(a,l),i(l,[a])}for(var Ud=0;Ud<Vx.length;Ud++){var jd=Vx[Ud],FA=jd.toLowerCase(),RA=jd[0].toUpperCase()+jd.slice(1);Pa(FA,"on"+RA)}Pa(Px,"onAnimationEnd"),Pa(bx,"onAnimationIteration"),Pa(Ox,"onAnimationStart"),Pa("dblclick","onDoubleClick"),Pa("focusin","onFocus"),Pa("focusout","onBlur"),Pa(Lx,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ou="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NA=new Set("cancel close invalid load scroll toggle".split(" ").concat(ou));function Bx(a,l,u){var m=a.type||"unknown-event";a.currentTarget=u,q(m,l,void 0,a),a.currentTarget=null}function Ux(a,l){l=(l&4)!==0;for(var u=0;u<a.length;u++){var m=a[u],v=m.event;m=m.listeners;e:{var w=void 0;if(l)for(var D=m.length-1;0<=D;D--){var Q=m[D],re=Q.instance,de=Q.currentTarget;if(Q=Q.listener,re!==w&&v.isPropagationStopped())break e;Bx(v,Q,de),w=re}else for(D=0;D<m.length;D++){if(Q=m[D],re=Q.instance,de=Q.currentTarget,Q=Q.listener,re!==w&&v.isPropagationStopped())break e;Bx(v,Q,de),w=re}}}if(P)throw a=H,P=!1,H=null,a}function sr(a,l){var u=l[Xd];u===void 0&&(u=l[Xd]=new Set);var m=a+"__bubble";u.has(m)||(jx(l,a,2,!1),u.add(m))}function zd(a,l,u){var m=0;l&&(m|=4),jx(u,a,m,l)}var nh="_reactListening"+Math.random().toString(36).slice(2);function lu(a){if(!a[nh]){a[nh]=!0,n.forEach(function(u){u!=="selectionchange"&&(NA.has(u)||zd(u,!1,a),zd(u,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[nh]||(l[nh]=!0,zd("selectionchange",!1,l))}}function jx(a,l,u,m){switch(Fl(l)){case 1:var v=vi;break;case 4:v=Kf;break;default:v=Jc}u=v.bind(null,l,u,a),v=void 0,!Qe||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),m?v!==void 0?a.addEventListener(l,u,{capture:!0,passive:v}):a.addEventListener(l,u,!0):v!==void 0?a.addEventListener(l,u,{passive:v}):a.addEventListener(l,u,!1)}function Wd(a,l,u,m,v){var w=m;if((l&1)===0&&(l&2)===0&&m!==null)e:for(;;){if(m===null)return;var D=m.tag;if(D===3||D===4){var Q=m.stateNode.containerInfo;if(Q===v||Q.nodeType===8&&Q.parentNode===v)break;if(D===4)for(D=m.return;D!==null;){var re=D.tag;if((re===3||re===4)&&(re=D.stateNode.containerInfo,re===v||re.nodeType===8&&re.parentNode===v))return;D=D.return}for(;Q!==null;){if(D=Do(Q),D===null)return;if(re=D.tag,re===5||re===6){m=w=D;continue e}Q=Q.parentNode}}m=m.return}ka(function(){var de=w,Ie=Hs(u),be=[];e:{var Ae=Mx.get(a);if(Ae!==void 0){var $e=Ro,Ke=a;switch(a){case"keypress":if(Fo(u)===0)break e;case"keydown":case"keyup":$e=qt;break;case"focusin":Ke="focus",$e=on;break;case"focusout":Ke="blur",$e=on;break;case"beforeblur":case"afterblur":$e=on;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$e=eu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$e=Qf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$e=Ei;break;case Px:case bx:case Ox:$e=Zf;break;case Lx:$e=Ol;break;case"scroll":$e=Nl;break;case"wheel":$e=pA;break;case"copy":case"cut":case"paste":$e=p;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$e=ds}var Xe=(l&4)!==0,Ir=!Xe&&a==="scroll",ie=Xe?Ae!==null?Ae+"Capture":null:Ae;Xe=[];for(var se=de,ue;se!==null;){ue=se;var Me=ue.stateNode;if(ue.tag===5&&Me!==null&&(ue=Me,ie!==null&&(Me=$s(se,ie),Me!=null&&Xe.push(cu(se,Me,ue)))),Ir)break;se=se.return}0<Xe.length&&(Ae=new $e(Ae,Ke,null,u,Ie),be.push({event:Ae,listeners:Xe}))}}if((l&7)===0){e:{if(Ae=a==="mouseover"||a==="pointerover",$e=a==="mouseout"||a==="pointerout",Ae&&u!==as&&(Ke=u.relatedTarget||u.fromElement)&&(Do(Ke)||Ke[Yi]))break e;if(($e||Ae)&&(Ae=Ie.window===Ie?Ie:(Ae=Ie.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,$e?(Ke=u.relatedTarget||u.toElement,$e=de,Ke=Ke?Do(Ke):null,Ke!==null&&(Ir=K(Ke),Ke!==Ir||Ke.tag!==5&&Ke.tag!==6)&&(Ke=null)):($e=null,Ke=de),$e!==Ke)){if(Xe=eu,Me="onMouseLeave",ie="onMouseEnter",se="mouse",(a==="pointerout"||a==="pointerover")&&(Xe=ds,Me="onPointerLeave",ie="onPointerEnter",se="pointer"),Ir=$e==null?Ae:jl($e),ue=Ke==null?Ae:jl(Ke),Ae=new Xe(Me,se+"leave",$e,u,Ie),Ae.target=Ir,Ae.relatedTarget=ue,Me=null,Do(Ie)===de&&(Xe=new Xe(ie,se+"enter",Ke,u,Ie),Xe.target=ue,Xe.relatedTarget=Ir,Me=Xe),Ir=Me,$e&&Ke)t:{for(Xe=$e,ie=Ke,se=0,ue=Xe;ue;ue=Bl(ue))se++;for(ue=0,Me=ie;Me;Me=Bl(Me))ue++;for(;0<se-ue;)Xe=Bl(Xe),se--;for(;0<ue-se;)ie=Bl(ie),ue--;for(;se--;){if(Xe===ie||ie!==null&&Xe===ie.alternate)break t;Xe=Bl(Xe),ie=Bl(ie)}Xe=null}else Xe=null;$e!==null&&zx(be,Ae,$e,Xe,!1),Ke!==null&&Ir!==null&&zx(be,Ir,Ke,Xe,!0)}}e:{if(Ae=de?jl(de):window,$e=Ae.nodeName&&Ae.nodeName.toLowerCase(),$e==="select"||$e==="input"&&Ae.type==="file")var Ye=wA;else if(wx(Ae))if(Tx)Ye=kA;else{Ye=TA;var tt=EA}else($e=Ae.nodeName)&&$e.toLowerCase()==="input"&&(Ae.type==="checkbox"||Ae.type==="radio")&&(Ye=SA);if(Ye&&(Ye=Ye(a,de))){Ex(be,Ye,u,Ie);break e}tt&&tt(a,Ae,de),a==="focusout"&&(tt=Ae._wrapperState)&&tt.controlled&&Ae.type==="number"&&St(Ae,"number",Ae.value)}switch(tt=de?jl(de):window,a){case"focusin":(wx(tt)||tt.contentEditable==="true")&&(Ml=tt,Md=de,au=null);break;case"focusout":au=Md=Ml=null;break;case"mousedown":Vd=!0;break;case"contextmenu":case"mouseup":case"dragend":Vd=!1,Nx(be,u,Ie);break;case"selectionchange":if(IA)break;case"keydown":case"keyup":Nx(be,u,Ie)}var rt;if(Pd)e:{switch(a){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else Ll?_x(a,u)&&(ut="onCompositionEnd"):a==="keydown"&&u.keyCode===229&&(ut="onCompositionStart");ut&&(gx&&u.locale!=="ko"&&(Ll||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&Ll&&(rt=Xf()):(fs=Ie,Rl="value"in fs?fs.value:fs.textContent,Ll=!0)),tt=sh(de,ut),0<tt.length&&(ut=new A(ut,a,null,u,Ie),be.push({event:ut,listeners:tt}),rt?ut.data=rt:(rt=yx(u),rt!==null&&(ut.data=rt)))),(rt=gA?xA(a,u):vA(a,u))&&(de=sh(de,"onBeforeInput"),0<de.length&&(Ie=new A("onBeforeInput","beforeinput",null,u,Ie),be.push({event:Ie,listeners:de}),Ie.data=rt))}Ux(be,l)})}function cu(a,l,u){return{instance:a,listener:l,currentTarget:u}}function sh(a,l){for(var u=l+"Capture",m=[];a!==null;){var v=a,w=v.stateNode;v.tag===5&&w!==null&&(v=w,w=$s(a,u),w!=null&&m.unshift(cu(a,w,v)),w=$s(a,l),w!=null&&m.push(cu(a,w,v))),a=a.return}return m}function Bl(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function zx(a,l,u,m,v){for(var w=l._reactName,D=[];u!==null&&u!==m;){var Q=u,re=Q.alternate,de=Q.stateNode;if(re!==null&&re===m)break;Q.tag===5&&de!==null&&(Q=de,v?(re=$s(u,w),re!=null&&D.unshift(cu(u,re,Q))):v||(re=$s(u,w),re!=null&&D.push(cu(u,re,Q)))),u=u.return}D.length!==0&&a.push({event:l,listeners:D})}var DA=/\r\n?/g,PA=/\u0000|\uFFFD/g;function Wx(a){return(typeof a=="string"?a:""+a).replace(DA,`
`).replace(PA,"")}function ih(a,l,u){if(l=Wx(l),Wx(a)!==l&&u)throw Error(r(425))}function ah(){}var Hd=null,$d=null;function Gd(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var qd=typeof setTimeout=="function"?setTimeout:void 0,bA=typeof clearTimeout=="function"?clearTimeout:void 0,Hx=typeof Promise=="function"?Promise:void 0,OA=typeof queueMicrotask=="function"?queueMicrotask:typeof Hx<"u"?function(a){return Hx.resolve(null).then(a).catch(LA)}:qd;function LA(a){setTimeout(function(){throw a})}function Kd(a,l){var u=l,m=0;do{var v=u.nextSibling;if(a.removeChild(u),v&&v.nodeType===8)if(u=v.data,u==="/$"){if(m===0){a.removeChild(v),Ra(l);return}m--}else u!=="$"&&u!=="$?"&&u!=="$!"||m++;u=v}while(u);Ra(l)}function ba(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return a}function $x(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var u=a.data;if(u==="$"||u==="$!"||u==="$?"){if(l===0)return a;l--}else u==="/$"&&l++}a=a.previousSibling}return null}var Ul=Math.random().toString(36).slice(2),Si="__reactFiber$"+Ul,uu="__reactProps$"+Ul,Yi="__reactContainer$"+Ul,Xd="__reactEvents$"+Ul,MA="__reactListeners$"+Ul,VA="__reactHandles$"+Ul;function Do(a){var l=a[Si];if(l)return l;for(var u=a.parentNode;u;){if(l=u[Yi]||u[Si]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(a=$x(a);a!==null;){if(u=a[Si])return u;a=$x(a)}return l}a=u,u=a.parentNode}return null}function fu(a){return a=a[Si]||a[Yi],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function jl(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(r(33))}function oh(a){return a[uu]||null}var Yd=[],zl=-1;function Oa(a){return{current:a}}function ir(a){0>zl||(a.current=Yd[zl],Yd[zl]=null,zl--)}function tr(a,l){zl++,Yd[zl]=a.current,a.current=l}var La={},yn=Oa(La),Xn=Oa(!1),Po=La;function Wl(a,l){var u=a.type.contextTypes;if(!u)return La;var m=a.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===l)return m.__reactInternalMemoizedMaskedChildContext;var v={},w;for(w in u)v[w]=l[w];return m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=v),v}function Yn(a){return a=a.childContextTypes,a!=null}function lh(){ir(Xn),ir(yn)}function Gx(a,l,u){if(yn.current!==La)throw Error(r(168));tr(yn,l),tr(Xn,u)}function qx(a,l,u){var m=a.stateNode;if(l=l.childContextTypes,typeof m.getChildContext!="function")return u;m=m.getChildContext();for(var v in m)if(!(v in l))throw Error(r(108,_e(a)||"Unknown",v));return ye({},u,m)}function ch(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||La,Po=yn.current,tr(yn,a),tr(Xn,Xn.current),!0}function Kx(a,l,u){var m=a.stateNode;if(!m)throw Error(r(169));u?(a=qx(a,l,Po),m.__reactInternalMemoizedMergedChildContext=a,ir(Xn),ir(yn),tr(yn,a)):ir(Xn),tr(Xn,u)}var Qi=null,uh=!1,Qd=!1;function Xx(a){Qi===null?Qi=[a]:Qi.push(a)}function BA(a){uh=!0,Xx(a)}function Ma(){if(!Qd&&Qi!==null){Qd=!0;var a=0,l=Ft;try{var u=Qi;for(Ft=1;a<u.length;a++){var m=u[a];do m=m(!0);while(m!==null)}Qi=null,uh=!1}catch(v){throw Qi!==null&&(Qi=Qi.slice(a+1)),Re(zt,Ma),v}finally{Ft=l,Qd=!1}}return null}var Hl=[],$l=0,fh=null,hh=0,Cs=[],Is=0,bo=null,Ji=1,Zi="";function Oo(a,l){Hl[$l++]=hh,Hl[$l++]=fh,fh=a,hh=l}function Yx(a,l,u){Cs[Is++]=Ji,Cs[Is++]=Zi,Cs[Is++]=bo,bo=a;var m=Ji;a=Zi;var v=32-pr(m)-1;m&=~(1<<v),u+=1;var w=32-pr(l)+v;if(30<w){var D=v-v%5;w=(m&(1<<D)-1).toString(32),m>>=D,v-=D,Ji=1<<32-pr(l)+v|u<<v|m,Zi=w+a}else Ji=1<<w|u<<v|m,Zi=a}function Jd(a){a.return!==null&&(Oo(a,1),Yx(a,1,0))}function Zd(a){for(;a===fh;)fh=Hl[--$l],Hl[$l]=null,hh=Hl[--$l],Hl[$l]=null;for(;a===bo;)bo=Cs[--Is],Cs[Is]=null,Zi=Cs[--Is],Cs[Is]=null,Ji=Cs[--Is],Cs[Is]=null}var ps=null,ms=null,hr=!1,Xs=null;function Qx(a,l){var u=Ds(5,null,null,0);u.elementType="DELETED",u.stateNode=l,u.return=a,l=a.deletions,l===null?(a.deletions=[u],a.flags|=16):l.push(u)}function Jx(a,l){switch(a.tag){case 5:var u=a.type;return l=l.nodeType!==1||u.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(a.stateNode=l,ps=a,ms=ba(l.firstChild),!0):!1;case 6:return l=a.pendingProps===""||l.nodeType!==3?null:l,l!==null?(a.stateNode=l,ps=a,ms=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(u=bo!==null?{id:Ji,overflow:Zi}:null,a.memoizedState={dehydrated:l,treeContext:u,retryLane:1073741824},u=Ds(18,null,null,0),u.stateNode=l,u.return=a,a.child=u,ps=a,ms=null,!0):!1;default:return!1}}function ep(a){return(a.mode&1)!==0&&(a.flags&128)===0}function tp(a){if(hr){var l=ms;if(l){var u=l;if(!Jx(a,l)){if(ep(a))throw Error(r(418));l=ba(u.nextSibling);var m=ps;l&&Jx(a,l)?Qx(m,u):(a.flags=a.flags&-4097|2,hr=!1,ps=a)}}else{if(ep(a))throw Error(r(418));a.flags=a.flags&-4097|2,hr=!1,ps=a}}}function Zx(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;ps=a}function dh(a){if(a!==ps)return!1;if(!hr)return Zx(a),hr=!0,!1;var l;if((l=a.tag!==3)&&!(l=a.tag!==5)&&(l=a.type,l=l!=="head"&&l!=="body"&&!Gd(a.type,a.memoizedProps)),l&&(l=ms)){if(ep(a))throw ev(),Error(r(418));for(;l;)Qx(a,l),l=ba(l.nextSibling)}if(Zx(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8){var u=a.data;if(u==="/$"){if(l===0){ms=ba(a.nextSibling);break e}l--}else u!=="$"&&u!=="$!"&&u!=="$?"||l++}a=a.nextSibling}ms=null}}else ms=ps?ba(a.stateNode.nextSibling):null;return!0}function ev(){for(var a=ms;a;)a=ba(a.nextSibling)}function Gl(){ms=ps=null,hr=!1}function rp(a){Xs===null?Xs=[a]:Xs.push(a)}var UA=U.ReactCurrentBatchConfig;function hu(a,l,u){if(a=u.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(r(309));var m=u.stateNode}if(!m)throw Error(r(147,a));var v=m,w=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===w?l.ref:(l=function(D){var Q=v.refs;D===null?delete Q[w]:Q[w]=D},l._stringRef=w,l)}if(typeof a!="string")throw Error(r(284));if(!u._owner)throw Error(r(290,a))}return a}function ph(a,l){throw a=Object.prototype.toString.call(l),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function tv(a){var l=a._init;return l(a._payload)}function rv(a){function l(ie,se){if(a){var ue=ie.deletions;ue===null?(ie.deletions=[se],ie.flags|=16):ue.push(se)}}function u(ie,se){if(!a)return null;for(;se!==null;)l(ie,se),se=se.sibling;return null}function m(ie,se){for(ie=new Map;se!==null;)se.key!==null?ie.set(se.key,se):ie.set(se.index,se),se=se.sibling;return ie}function v(ie,se){return ie=$a(ie,se),ie.index=0,ie.sibling=null,ie}function w(ie,se,ue){return ie.index=ue,a?(ue=ie.alternate,ue!==null?(ue=ue.index,ue<se?(ie.flags|=2,se):ue):(ie.flags|=2,se)):(ie.flags|=1048576,se)}function D(ie){return a&&ie.alternate===null&&(ie.flags|=2),ie}function Q(ie,se,ue,Me){return se===null||se.tag!==6?(se=qp(ue,ie.mode,Me),se.return=ie,se):(se=v(se,ue),se.return=ie,se)}function re(ie,se,ue,Me){var Ye=ue.type;return Ye===k?Ie(ie,se,ue.props.children,Me,ue.key):se!==null&&(se.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===Le&&tv(Ye)===se.type)?(Me=v(se,ue.props),Me.ref=hu(ie,se,ue),Me.return=ie,Me):(Me=Vh(ue.type,ue.key,ue.props,null,ie.mode,Me),Me.ref=hu(ie,se,ue),Me.return=ie,Me)}function de(ie,se,ue,Me){return se===null||se.tag!==4||se.stateNode.containerInfo!==ue.containerInfo||se.stateNode.implementation!==ue.implementation?(se=Kp(ue,ie.mode,Me),se.return=ie,se):(se=v(se,ue.children||[]),se.return=ie,se)}function Ie(ie,se,ue,Me,Ye){return se===null||se.tag!==7?(se=Wo(ue,ie.mode,Me,Ye),se.return=ie,se):(se=v(se,ue),se.return=ie,se)}function be(ie,se,ue){if(typeof se=="string"&&se!==""||typeof se=="number")return se=qp(""+se,ie.mode,ue),se.return=ie,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case X:return ue=Vh(se.type,se.key,se.props,null,ie.mode,ue),ue.ref=hu(ie,null,se),ue.return=ie,ue;case G:return se=Kp(se,ie.mode,ue),se.return=ie,se;case Le:var Me=se._init;return be(ie,Me(se._payload),ue)}if(Tt(se)||ne(se))return se=Wo(se,ie.mode,ue,null),se.return=ie,se;ph(ie,se)}return null}function Ae(ie,se,ue,Me){var Ye=se!==null?se.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return Ye!==null?null:Q(ie,se,""+ue,Me);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case X:return ue.key===Ye?re(ie,se,ue,Me):null;case G:return ue.key===Ye?de(ie,se,ue,Me):null;case Le:return Ye=ue._init,Ae(ie,se,Ye(ue._payload),Me)}if(Tt(ue)||ne(ue))return Ye!==null?null:Ie(ie,se,ue,Me,null);ph(ie,ue)}return null}function $e(ie,se,ue,Me,Ye){if(typeof Me=="string"&&Me!==""||typeof Me=="number")return ie=ie.get(ue)||null,Q(se,ie,""+Me,Ye);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case X:return ie=ie.get(Me.key===null?ue:Me.key)||null,re(se,ie,Me,Ye);case G:return ie=ie.get(Me.key===null?ue:Me.key)||null,de(se,ie,Me,Ye);case Le:var tt=Me._init;return $e(ie,se,ue,tt(Me._payload),Ye)}if(Tt(Me)||ne(Me))return ie=ie.get(ue)||null,Ie(se,ie,Me,Ye,null);ph(se,Me)}return null}function Ke(ie,se,ue,Me){for(var Ye=null,tt=null,rt=se,ut=se=0,Zr=null;rt!==null&&ut<ue.length;ut++){rt.index>ut?(Zr=rt,rt=null):Zr=rt.sibling;var Ot=Ae(ie,rt,ue[ut],Me);if(Ot===null){rt===null&&(rt=Zr);break}a&&rt&&Ot.alternate===null&&l(ie,rt),se=w(Ot,se,ut),tt===null?Ye=Ot:tt.sibling=Ot,tt=Ot,rt=Zr}if(ut===ue.length)return u(ie,rt),hr&&Oo(ie,ut),Ye;if(rt===null){for(;ut<ue.length;ut++)rt=be(ie,ue[ut],Me),rt!==null&&(se=w(rt,se,ut),tt===null?Ye=rt:tt.sibling=rt,tt=rt);return hr&&Oo(ie,ut),Ye}for(rt=m(ie,rt);ut<ue.length;ut++)Zr=$e(rt,ie,ut,ue[ut],Me),Zr!==null&&(a&&Zr.alternate!==null&&rt.delete(Zr.key===null?ut:Zr.key),se=w(Zr,se,ut),tt===null?Ye=Zr:tt.sibling=Zr,tt=Zr);return a&&rt.forEach(function(Ga){return l(ie,Ga)}),hr&&Oo(ie,ut),Ye}function Xe(ie,se,ue,Me){var Ye=ne(ue);if(typeof Ye!="function")throw Error(r(150));if(ue=Ye.call(ue),ue==null)throw Error(r(151));for(var tt=Ye=null,rt=se,ut=se=0,Zr=null,Ot=ue.next();rt!==null&&!Ot.done;ut++,Ot=ue.next()){rt.index>ut?(Zr=rt,rt=null):Zr=rt.sibling;var Ga=Ae(ie,rt,Ot.value,Me);if(Ga===null){rt===null&&(rt=Zr);break}a&&rt&&Ga.alternate===null&&l(ie,rt),se=w(Ga,se,ut),tt===null?Ye=Ga:tt.sibling=Ga,tt=Ga,rt=Zr}if(Ot.done)return u(ie,rt),hr&&Oo(ie,ut),Ye;if(rt===null){for(;!Ot.done;ut++,Ot=ue.next())Ot=be(ie,Ot.value,Me),Ot!==null&&(se=w(Ot,se,ut),tt===null?Ye=Ot:tt.sibling=Ot,tt=Ot);return hr&&Oo(ie,ut),Ye}for(rt=m(ie,rt);!Ot.done;ut++,Ot=ue.next())Ot=$e(rt,ie,ut,Ot.value,Me),Ot!==null&&(a&&Ot.alternate!==null&&rt.delete(Ot.key===null?ut:Ot.key),se=w(Ot,se,ut),tt===null?Ye=Ot:tt.sibling=Ot,tt=Ot);return a&&rt.forEach(function(_4){return l(ie,_4)}),hr&&Oo(ie,ut),Ye}function Ir(ie,se,ue,Me){if(typeof ue=="object"&&ue!==null&&ue.type===k&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case X:e:{for(var Ye=ue.key,tt=se;tt!==null;){if(tt.key===Ye){if(Ye=ue.type,Ye===k){if(tt.tag===7){u(ie,tt.sibling),se=v(tt,ue.props.children),se.return=ie,ie=se;break e}}else if(tt.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===Le&&tv(Ye)===tt.type){u(ie,tt.sibling),se=v(tt,ue.props),se.ref=hu(ie,tt,ue),se.return=ie,ie=se;break e}u(ie,tt);break}else l(ie,tt);tt=tt.sibling}ue.type===k?(se=Wo(ue.props.children,ie.mode,Me,ue.key),se.return=ie,ie=se):(Me=Vh(ue.type,ue.key,ue.props,null,ie.mode,Me),Me.ref=hu(ie,se,ue),Me.return=ie,ie=Me)}return D(ie);case G:e:{for(tt=ue.key;se!==null;){if(se.key===tt)if(se.tag===4&&se.stateNode.containerInfo===ue.containerInfo&&se.stateNode.implementation===ue.implementation){u(ie,se.sibling),se=v(se,ue.children||[]),se.return=ie,ie=se;break e}else{u(ie,se);break}else l(ie,se);se=se.sibling}se=Kp(ue,ie.mode,Me),se.return=ie,ie=se}return D(ie);case Le:return tt=ue._init,Ir(ie,se,tt(ue._payload),Me)}if(Tt(ue))return Ke(ie,se,ue,Me);if(ne(ue))return Xe(ie,se,ue,Me);ph(ie,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,se!==null&&se.tag===6?(u(ie,se.sibling),se=v(se,ue),se.return=ie,ie=se):(u(ie,se),se=qp(ue,ie.mode,Me),se.return=ie,ie=se),D(ie)):u(ie,se)}return Ir}var ql=rv(!0),nv=rv(!1),mh=Oa(null),gh=null,Kl=null,np=null;function sp(){np=Kl=gh=null}function ip(a){var l=mh.current;ir(mh),a._currentValue=l}function ap(a,l,u){for(;a!==null;){var m=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),a===u)break;a=a.return}}function Xl(a,l){gh=a,np=Kl=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&l)!==0&&(Qn=!0),a.firstContext=null)}function Fs(a){var l=a._currentValue;if(np!==a)if(a={context:a,memoizedValue:l,next:null},Kl===null){if(gh===null)throw Error(r(308));Kl=a,gh.dependencies={lanes:0,firstContext:a}}else Kl=Kl.next=a;return l}var Lo=null;function op(a){Lo===null?Lo=[a]:Lo.push(a)}function sv(a,l,u,m){var v=l.interleaved;return v===null?(u.next=u,op(l)):(u.next=v.next,v.next=u),l.interleaved=u,ea(a,m)}function ea(a,l){a.lanes|=l;var u=a.alternate;for(u!==null&&(u.lanes|=l),u=a,a=a.return;a!==null;)a.childLanes|=l,u=a.alternate,u!==null&&(u.childLanes|=l),u=a,a=a.return;return u.tag===3?u.stateNode:null}var Va=!1;function lp(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function iv(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ta(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function Ba(a,l,u){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(Dt&2)!==0){var v=m.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),m.pending=l,ea(a,u)}return v=m.interleaved,v===null?(l.next=l,op(m)):(l.next=v.next,v.next=l),m.interleaved=l,ea(a,u)}function xh(a,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194240)!==0)){var m=l.lanes;m&=a.pendingLanes,u|=m,l.lanes=u,qc(a,u)}}function av(a,l){var u=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var v=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var D={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};w===null?v=w=D:w=w.next=D,u=u.next}while(u!==null);w===null?v=w=l:w=w.next=l}else v=w=l;u={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:m.shared,effects:m.effects},a.updateQueue=u;return}a=u.lastBaseUpdate,a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=l}function vh(a,l,u,m){var v=a.updateQueue;Va=!1;var w=v.firstBaseUpdate,D=v.lastBaseUpdate,Q=v.shared.pending;if(Q!==null){v.shared.pending=null;var re=Q,de=re.next;re.next=null,D===null?w=de:D.next=de,D=re;var Ie=a.alternate;Ie!==null&&(Ie=Ie.updateQueue,Q=Ie.lastBaseUpdate,Q!==D&&(Q===null?Ie.firstBaseUpdate=de:Q.next=de,Ie.lastBaseUpdate=re))}if(w!==null){var be=v.baseState;D=0,Ie=de=re=null,Q=w;do{var Ae=Q.lane,$e=Q.eventTime;if((m&Ae)===Ae){Ie!==null&&(Ie=Ie.next={eventTime:$e,lane:0,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null});e:{var Ke=a,Xe=Q;switch(Ae=l,$e=u,Xe.tag){case 1:if(Ke=Xe.payload,typeof Ke=="function"){be=Ke.call($e,be,Ae);break e}be=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=Xe.payload,Ae=typeof Ke=="function"?Ke.call($e,be,Ae):Ke,Ae==null)break e;be=ye({},be,Ae);break e;case 2:Va=!0}}Q.callback!==null&&Q.lane!==0&&(a.flags|=64,Ae=v.effects,Ae===null?v.effects=[Q]:Ae.push(Q))}else $e={eventTime:$e,lane:Ae,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},Ie===null?(de=Ie=$e,re=be):Ie=Ie.next=$e,D|=Ae;if(Q=Q.next,Q===null){if(Q=v.shared.pending,Q===null)break;Ae=Q,Q=Ae.next,Ae.next=null,v.lastBaseUpdate=Ae,v.shared.pending=null}}while(!0);if(Ie===null&&(re=be),v.baseState=re,v.firstBaseUpdate=de,v.lastBaseUpdate=Ie,l=v.shared.interleaved,l!==null){v=l;do D|=v.lane,v=v.next;while(v!==l)}else w===null&&(v.shared.lanes=0);Bo|=D,a.lanes=D,a.memoizedState=be}}function ov(a,l,u){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var m=a[l],v=m.callback;if(v!==null){if(m.callback=null,m=u,typeof v!="function")throw Error(r(191,v));v.call(m)}}}var du={},ki=Oa(du),pu=Oa(du),mu=Oa(du);function Mo(a){if(a===du)throw Error(r(174));return a}function cp(a,l){switch(tr(mu,l),tr(pu,a),tr(ki,du),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:Vn(null,"");break;default:a=a===8?l.parentNode:l,l=a.namespaceURI||null,a=a.tagName,l=Vn(l,a)}ir(ki),tr(ki,l)}function Yl(){ir(ki),ir(pu),ir(mu)}function lv(a){Mo(mu.current);var l=Mo(ki.current),u=Vn(l,a.type);l!==u&&(tr(pu,a),tr(ki,u))}function up(a){pu.current===a&&(ir(ki),ir(pu))}var mr=Oa(0);function _h(a){for(var l=a;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var fp=[];function hp(){for(var a=0;a<fp.length;a++)fp[a]._workInProgressVersionPrimary=null;fp.length=0}var yh=U.ReactCurrentDispatcher,dp=U.ReactCurrentBatchConfig,Vo=0,gr=null,$r=null,Qr=null,wh=!1,gu=!1,xu=0,jA=0;function wn(){throw Error(r(321))}function pp(a,l){if(l===null)return!1;for(var u=0;u<l.length&&u<a.length;u++)if(!Ks(a[u],l[u]))return!1;return!0}function mp(a,l,u,m,v,w){if(Vo=w,gr=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,yh.current=a===null||a.memoizedState===null?$A:GA,a=u(m,v),gu){w=0;do{if(gu=!1,xu=0,25<=w)throw Error(r(301));w+=1,Qr=$r=null,l.updateQueue=null,yh.current=qA,a=u(m,v)}while(gu)}if(yh.current=Sh,l=$r!==null&&$r.next!==null,Vo=0,Qr=$r=gr=null,wh=!1,l)throw Error(r(300));return a}function gp(){var a=xu!==0;return xu=0,a}function Ai(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qr===null?gr.memoizedState=Qr=a:Qr=Qr.next=a,Qr}function Rs(){if($r===null){var a=gr.alternate;a=a!==null?a.memoizedState:null}else a=$r.next;var l=Qr===null?gr.memoizedState:Qr.next;if(l!==null)Qr=l,$r=a;else{if(a===null)throw Error(r(310));$r=a,a={memoizedState:$r.memoizedState,baseState:$r.baseState,baseQueue:$r.baseQueue,queue:$r.queue,next:null},Qr===null?gr.memoizedState=Qr=a:Qr=Qr.next=a}return Qr}function vu(a,l){return typeof l=="function"?l(a):l}function xp(a){var l=Rs(),u=l.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=a;var m=$r,v=m.baseQueue,w=u.pending;if(w!==null){if(v!==null){var D=v.next;v.next=w.next,w.next=D}m.baseQueue=v=w,u.pending=null}if(v!==null){w=v.next,m=m.baseState;var Q=D=null,re=null,de=w;do{var Ie=de.lane;if((Vo&Ie)===Ie)re!==null&&(re=re.next={lane:0,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),m=de.hasEagerState?de.eagerState:a(m,de.action);else{var be={lane:Ie,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null};re===null?(Q=re=be,D=m):re=re.next=be,gr.lanes|=Ie,Bo|=Ie}de=de.next}while(de!==null&&de!==w);re===null?D=m:re.next=Q,Ks(m,l.memoizedState)||(Qn=!0),l.memoizedState=m,l.baseState=D,l.baseQueue=re,u.lastRenderedState=m}if(a=u.interleaved,a!==null){v=a;do w=v.lane,gr.lanes|=w,Bo|=w,v=v.next;while(v!==a)}else v===null&&(u.lanes=0);return[l.memoizedState,u.dispatch]}function vp(a){var l=Rs(),u=l.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=a;var m=u.dispatch,v=u.pending,w=l.memoizedState;if(v!==null){u.pending=null;var D=v=v.next;do w=a(w,D.action),D=D.next;while(D!==v);Ks(w,l.memoizedState)||(Qn=!0),l.memoizedState=w,l.baseQueue===null&&(l.baseState=w),u.lastRenderedState=w}return[w,m]}function cv(){}function uv(a,l){var u=gr,m=Rs(),v=l(),w=!Ks(m.memoizedState,v);if(w&&(m.memoizedState=v,Qn=!0),m=m.queue,_p(dv.bind(null,u,m,a),[a]),m.getSnapshot!==l||w||Qr!==null&&Qr.memoizedState.tag&1){if(u.flags|=2048,_u(9,hv.bind(null,u,m,v,l),void 0,null),Jr===null)throw Error(r(349));(Vo&30)!==0||fv(u,l,v)}return v}function fv(a,l,u){a.flags|=16384,a={getSnapshot:l,value:u},l=gr.updateQueue,l===null?(l={lastEffect:null,stores:null},gr.updateQueue=l,l.stores=[a]):(u=l.stores,u===null?l.stores=[a]:u.push(a))}function hv(a,l,u,m){l.value=u,l.getSnapshot=m,pv(l)&&mv(a)}function dv(a,l,u){return u(function(){pv(l)&&mv(a)})}function pv(a){var l=a.getSnapshot;a=a.value;try{var u=l();return!Ks(a,u)}catch{return!0}}function mv(a){var l=ea(a,1);l!==null&&Zs(l,a,1,-1)}function gv(a){var l=Ai();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vu,lastRenderedState:a},l.queue=a,a=a.dispatch=HA.bind(null,gr,a),[l.memoizedState,a]}function _u(a,l,u,m){return a={tag:a,create:l,destroy:u,deps:m,next:null},l=gr.updateQueue,l===null?(l={lastEffect:null,stores:null},gr.updateQueue=l,l.lastEffect=a.next=a):(u=l.lastEffect,u===null?l.lastEffect=a.next=a:(m=u.next,u.next=a,a.next=m,l.lastEffect=a)),a}function xv(){return Rs().memoizedState}function Eh(a,l,u,m){var v=Ai();gr.flags|=a,v.memoizedState=_u(1|l,u,void 0,m===void 0?null:m)}function Th(a,l,u,m){var v=Rs();m=m===void 0?null:m;var w=void 0;if($r!==null){var D=$r.memoizedState;if(w=D.destroy,m!==null&&pp(m,D.deps)){v.memoizedState=_u(l,u,w,m);return}}gr.flags|=a,v.memoizedState=_u(1|l,u,w,m)}function vv(a,l){return Eh(8390656,8,a,l)}function _p(a,l){return Th(2048,8,a,l)}function _v(a,l){return Th(4,2,a,l)}function yv(a,l){return Th(4,4,a,l)}function wv(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function Ev(a,l,u){return u=u!=null?u.concat([a]):null,Th(4,4,wv.bind(null,l,a),u)}function yp(){}function Tv(a,l){var u=Rs();l=l===void 0?null:l;var m=u.memoizedState;return m!==null&&l!==null&&pp(l,m[1])?m[0]:(u.memoizedState=[a,l],a)}function Sv(a,l){var u=Rs();l=l===void 0?null:l;var m=u.memoizedState;return m!==null&&l!==null&&pp(l,m[1])?m[0]:(a=a(),u.memoizedState=[a,l],a)}function kv(a,l,u){return(Vo&21)===0?(a.baseState&&(a.baseState=!1,Qn=!0),a.memoizedState=u):(Ks(u,l)||(u=$c(),gr.lanes|=u,Bo|=u,a.baseState=!0),l)}function zA(a,l){var u=Ft;Ft=u!==0&&4>u?u:4,a(!0);var m=dp.transition;dp.transition={};try{a(!1),l()}finally{Ft=u,dp.transition=m}}function Av(){return Rs().memoizedState}function WA(a,l,u){var m=Wa(a);if(u={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null},Cv(a))Iv(l,u);else if(u=sv(a,l,u,m),u!==null){var v=zn();Zs(u,a,m,v),Fv(u,l,m)}}function HA(a,l,u){var m=Wa(a),v={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null};if(Cv(a))Iv(l,v);else{var w=a.alternate;if(a.lanes===0&&(w===null||w.lanes===0)&&(w=l.lastRenderedReducer,w!==null))try{var D=l.lastRenderedState,Q=w(D,u);if(v.hasEagerState=!0,v.eagerState=Q,Ks(Q,D)){var re=l.interleaved;re===null?(v.next=v,op(l)):(v.next=re.next,re.next=v),l.interleaved=v;return}}catch{}finally{}u=sv(a,l,v,m),u!==null&&(v=zn(),Zs(u,a,m,v),Fv(u,l,m))}}function Cv(a){var l=a.alternate;return a===gr||l!==null&&l===gr}function Iv(a,l){gu=wh=!0;var u=a.pending;u===null?l.next=l:(l.next=u.next,u.next=l),a.pending=l}function Fv(a,l,u){if((u&4194240)!==0){var m=l.lanes;m&=a.pendingLanes,u|=m,l.lanes=u,qc(a,u)}}var Sh={readContext:Fs,useCallback:wn,useContext:wn,useEffect:wn,useImperativeHandle:wn,useInsertionEffect:wn,useLayoutEffect:wn,useMemo:wn,useReducer:wn,useRef:wn,useState:wn,useDebugValue:wn,useDeferredValue:wn,useTransition:wn,useMutableSource:wn,useSyncExternalStore:wn,useId:wn,unstable_isNewReconciler:!1},$A={readContext:Fs,useCallback:function(a,l){return Ai().memoizedState=[a,l===void 0?null:l],a},useContext:Fs,useEffect:vv,useImperativeHandle:function(a,l,u){return u=u!=null?u.concat([a]):null,Eh(4194308,4,wv.bind(null,l,a),u)},useLayoutEffect:function(a,l){return Eh(4194308,4,a,l)},useInsertionEffect:function(a,l){return Eh(4,2,a,l)},useMemo:function(a,l){var u=Ai();return l=l===void 0?null:l,a=a(),u.memoizedState=[a,l],a},useReducer:function(a,l,u){var m=Ai();return l=u!==void 0?u(l):l,m.memoizedState=m.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},m.queue=a,a=a.dispatch=WA.bind(null,gr,a),[m.memoizedState,a]},useRef:function(a){var l=Ai();return a={current:a},l.memoizedState=a},useState:gv,useDebugValue:yp,useDeferredValue:function(a){return Ai().memoizedState=a},useTransition:function(){var a=gv(!1),l=a[0];return a=zA.bind(null,a[1]),Ai().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,u){var m=gr,v=Ai();if(hr){if(u===void 0)throw Error(r(407));u=u()}else{if(u=l(),Jr===null)throw Error(r(349));(Vo&30)!==0||fv(m,l,u)}v.memoizedState=u;var w={value:u,getSnapshot:l};return v.queue=w,vv(dv.bind(null,m,w,a),[a]),m.flags|=2048,_u(9,hv.bind(null,m,w,u,l),void 0,null),u},useId:function(){var a=Ai(),l=Jr.identifierPrefix;if(hr){var u=Zi,m=Ji;u=(m&~(1<<32-pr(m)-1)).toString(32)+u,l=":"+l+"R"+u,u=xu++,0<u&&(l+="H"+u.toString(32)),l+=":"}else u=jA++,l=":"+l+"r"+u.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},GA={readContext:Fs,useCallback:Tv,useContext:Fs,useEffect:_p,useImperativeHandle:Ev,useInsertionEffect:_v,useLayoutEffect:yv,useMemo:Sv,useReducer:xp,useRef:xv,useState:function(){return xp(vu)},useDebugValue:yp,useDeferredValue:function(a){var l=Rs();return kv(l,$r.memoizedState,a)},useTransition:function(){var a=xp(vu)[0],l=Rs().memoizedState;return[a,l]},useMutableSource:cv,useSyncExternalStore:uv,useId:Av,unstable_isNewReconciler:!1},qA={readContext:Fs,useCallback:Tv,useContext:Fs,useEffect:_p,useImperativeHandle:Ev,useInsertionEffect:_v,useLayoutEffect:yv,useMemo:Sv,useReducer:vp,useRef:xv,useState:function(){return vp(vu)},useDebugValue:yp,useDeferredValue:function(a){var l=Rs();return $r===null?l.memoizedState=a:kv(l,$r.memoizedState,a)},useTransition:function(){var a=vp(vu)[0],l=Rs().memoizedState;return[a,l]},useMutableSource:cv,useSyncExternalStore:uv,useId:Av,unstable_isNewReconciler:!1};function Ys(a,l){if(a&&a.defaultProps){l=ye({},l),a=a.defaultProps;for(var u in a)l[u]===void 0&&(l[u]=a[u]);return l}return l}function wp(a,l,u,m){l=a.memoizedState,u=u(m,l),u=u==null?l:ye({},l,u),a.memoizedState=u,a.lanes===0&&(a.updateQueue.baseState=u)}var kh={isMounted:function(a){return(a=a._reactInternals)?K(a)===a:!1},enqueueSetState:function(a,l,u){a=a._reactInternals;var m=zn(),v=Wa(a),w=ta(m,v);w.payload=l,u!=null&&(w.callback=u),l=Ba(a,w,v),l!==null&&(Zs(l,a,v,m),xh(l,a,v))},enqueueReplaceState:function(a,l,u){a=a._reactInternals;var m=zn(),v=Wa(a),w=ta(m,v);w.tag=1,w.payload=l,u!=null&&(w.callback=u),l=Ba(a,w,v),l!==null&&(Zs(l,a,v,m),xh(l,a,v))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var u=zn(),m=Wa(a),v=ta(u,m);v.tag=2,l!=null&&(v.callback=l),l=Ba(a,v,m),l!==null&&(Zs(l,a,m,u),xh(l,a,m))}};function Rv(a,l,u,m,v,w,D){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,w,D):l.prototype&&l.prototype.isPureReactComponent?!iu(u,m)||!iu(v,w):!0}function Nv(a,l,u){var m=!1,v=La,w=l.contextType;return typeof w=="object"&&w!==null?w=Fs(w):(v=Yn(l)?Po:yn.current,m=l.contextTypes,w=(m=m!=null)?Wl(a,v):La),l=new l(u,w),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=kh,a.stateNode=l,l._reactInternals=a,m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=w),l}function Dv(a,l,u,m){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,m),l.state!==a&&kh.enqueueReplaceState(l,l.state,null)}function Ep(a,l,u,m){var v=a.stateNode;v.props=u,v.state=a.memoizedState,v.refs={},lp(a);var w=l.contextType;typeof w=="object"&&w!==null?v.context=Fs(w):(w=Yn(l)?Po:yn.current,v.context=Wl(a,w)),v.state=a.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(wp(a,l,w,u),v.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(l=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),l!==v.state&&kh.enqueueReplaceState(v,v.state,null),vh(a,u,v,m),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function Ql(a,l){try{var u="",m=l;do u+=Z(m),m=m.return;while(m);var v=u}catch(w){v=`
Error generating stack: `+w.message+`
`+w.stack}return{value:a,source:l,stack:v,digest:null}}function Tp(a,l,u){return{value:a,source:null,stack:u??null,digest:l??null}}function Sp(a,l){try{console.error(l.value)}catch(u){setTimeout(function(){throw u})}}var KA=typeof WeakMap=="function"?WeakMap:Map;function Pv(a,l,u){u=ta(-1,u),u.tag=3,u.payload={element:null};var m=l.value;return u.callback=function(){Dh||(Dh=!0,Bp=m),Sp(a,l)},u}function bv(a,l,u){u=ta(-1,u),u.tag=3;var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var v=l.value;u.payload=function(){return m(v)},u.callback=function(){Sp(a,l)}}var w=a.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(u.callback=function(){Sp(a,l),typeof m!="function"&&(ja===null?ja=new Set([this]):ja.add(this));var D=l.stack;this.componentDidCatch(l.value,{componentStack:D!==null?D:""})}),u}function Ov(a,l,u){var m=a.pingCache;if(m===null){m=a.pingCache=new KA;var v=new Set;m.set(l,v)}else v=m.get(l),v===void 0&&(v=new Set,m.set(l,v));v.has(u)||(v.add(u),a=l4.bind(null,a,l,u),l.then(a,a))}function Lv(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function Mv(a,l,u,m,v){return(a.mode&1)===0?(a===l?a.flags|=65536:(a.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(l=ta(-1,1),l.tag=2,Ba(u,l,1))),u.lanes|=1),a):(a.flags|=65536,a.lanes=v,a)}var XA=U.ReactCurrentOwner,Qn=!1;function jn(a,l,u,m){l.child=a===null?nv(l,null,u,m):ql(l,a.child,u,m)}function Vv(a,l,u,m,v){u=u.render;var w=l.ref;return Xl(l,v),m=mp(a,l,u,m,w,v),u=gp(),a!==null&&!Qn?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~v,ra(a,l,v)):(hr&&u&&Jd(l),l.flags|=1,jn(a,l,m,v),l.child)}function Bv(a,l,u,m,v){if(a===null){var w=u.type;return typeof w=="function"&&!Gp(w)&&w.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(l.tag=15,l.type=w,Uv(a,l,w,m,v)):(a=Vh(u.type,null,m,l,l.mode,v),a.ref=l.ref,a.return=l,l.child=a)}if(w=a.child,(a.lanes&v)===0){var D=w.memoizedProps;if(u=u.compare,u=u!==null?u:iu,u(D,m)&&a.ref===l.ref)return ra(a,l,v)}return l.flags|=1,a=$a(w,m),a.ref=l.ref,a.return=l,l.child=a}function Uv(a,l,u,m,v){if(a!==null){var w=a.memoizedProps;if(iu(w,m)&&a.ref===l.ref)if(Qn=!1,l.pendingProps=m=w,(a.lanes&v)!==0)(a.flags&131072)!==0&&(Qn=!0);else return l.lanes=a.lanes,ra(a,l,v)}return kp(a,l,u,m,v)}function jv(a,l,u){var m=l.pendingProps,v=m.children,w=a!==null?a.memoizedState:null;if(m.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},tr(Zl,gs),gs|=u;else{if((u&1073741824)===0)return a=w!==null?w.baseLanes|u:u,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,tr(Zl,gs),gs|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=w!==null?w.baseLanes:u,tr(Zl,gs),gs|=m}else w!==null?(m=w.baseLanes|u,l.memoizedState=null):m=u,tr(Zl,gs),gs|=m;return jn(a,l,v,u),l.child}function zv(a,l){var u=l.ref;(a===null&&u!==null||a!==null&&a.ref!==u)&&(l.flags|=512,l.flags|=2097152)}function kp(a,l,u,m,v){var w=Yn(u)?Po:yn.current;return w=Wl(l,w),Xl(l,v),u=mp(a,l,u,m,w,v),m=gp(),a!==null&&!Qn?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~v,ra(a,l,v)):(hr&&m&&Jd(l),l.flags|=1,jn(a,l,u,v),l.child)}function Wv(a,l,u,m,v){if(Yn(u)){var w=!0;ch(l)}else w=!1;if(Xl(l,v),l.stateNode===null)Ch(a,l),Nv(l,u,m),Ep(l,u,m,v),m=!0;else if(a===null){var D=l.stateNode,Q=l.memoizedProps;D.props=Q;var re=D.context,de=u.contextType;typeof de=="object"&&de!==null?de=Fs(de):(de=Yn(u)?Po:yn.current,de=Wl(l,de));var Ie=u.getDerivedStateFromProps,be=typeof Ie=="function"||typeof D.getSnapshotBeforeUpdate=="function";be||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(Q!==m||re!==de)&&Dv(l,D,m,de),Va=!1;var Ae=l.memoizedState;D.state=Ae,vh(l,m,D,v),re=l.memoizedState,Q!==m||Ae!==re||Xn.current||Va?(typeof Ie=="function"&&(wp(l,u,Ie,m),re=l.memoizedState),(Q=Va||Rv(l,u,Q,m,Ae,re,de))?(be||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(l.flags|=4194308)):(typeof D.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=re),D.props=m,D.state=re,D.context=de,m=Q):(typeof D.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{D=l.stateNode,iv(a,l),Q=l.memoizedProps,de=l.type===l.elementType?Q:Ys(l.type,Q),D.props=de,be=l.pendingProps,Ae=D.context,re=u.contextType,typeof re=="object"&&re!==null?re=Fs(re):(re=Yn(u)?Po:yn.current,re=Wl(l,re));var $e=u.getDerivedStateFromProps;(Ie=typeof $e=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(Q!==be||Ae!==re)&&Dv(l,D,m,re),Va=!1,Ae=l.memoizedState,D.state=Ae,vh(l,m,D,v);var Ke=l.memoizedState;Q!==be||Ae!==Ke||Xn.current||Va?(typeof $e=="function"&&(wp(l,u,$e,m),Ke=l.memoizedState),(de=Va||Rv(l,u,de,m,Ae,Ke,re)||!1)?(Ie||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(m,Ke,re),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(m,Ke,re)),typeof D.componentDidUpdate=="function"&&(l.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof D.componentDidUpdate!="function"||Q===a.memoizedProps&&Ae===a.memoizedState||(l.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||Q===a.memoizedProps&&Ae===a.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=Ke),D.props=m,D.state=Ke,D.context=re,m=de):(typeof D.componentDidUpdate!="function"||Q===a.memoizedProps&&Ae===a.memoizedState||(l.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||Q===a.memoizedProps&&Ae===a.memoizedState||(l.flags|=1024),m=!1)}return Ap(a,l,u,m,w,v)}function Ap(a,l,u,m,v,w){zv(a,l);var D=(l.flags&128)!==0;if(!m&&!D)return v&&Kx(l,u,!1),ra(a,l,w);m=l.stateNode,XA.current=l;var Q=D&&typeof u.getDerivedStateFromError!="function"?null:m.render();return l.flags|=1,a!==null&&D?(l.child=ql(l,a.child,null,w),l.child=ql(l,null,Q,w)):jn(a,l,Q,w),l.memoizedState=m.state,v&&Kx(l,u,!0),l.child}function Hv(a){var l=a.stateNode;l.pendingContext?Gx(a,l.pendingContext,l.pendingContext!==l.context):l.context&&Gx(a,l.context,!1),cp(a,l.containerInfo)}function $v(a,l,u,m,v){return Gl(),rp(v),l.flags|=256,jn(a,l,u,m),l.child}var Cp={dehydrated:null,treeContext:null,retryLane:0};function Ip(a){return{baseLanes:a,cachePool:null,transitions:null}}function Gv(a,l,u){var m=l.pendingProps,v=mr.current,w=!1,D=(l.flags&128)!==0,Q;if((Q=D)||(Q=a!==null&&a.memoizedState===null?!1:(v&2)!==0),Q?(w=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),tr(mr,v&1),a===null)return tp(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((l.mode&1)===0?l.lanes=1:a.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(D=m.children,a=m.fallback,w?(m=l.mode,w=l.child,D={mode:"hidden",children:D},(m&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=D):w=Bh(D,m,0,null),a=Wo(a,m,u,null),w.return=l,a.return=l,w.sibling=a,l.child=w,l.child.memoizedState=Ip(u),l.memoizedState=Cp,a):Fp(l,D));if(v=a.memoizedState,v!==null&&(Q=v.dehydrated,Q!==null))return YA(a,l,D,m,Q,v,u);if(w){w=m.fallback,D=l.mode,v=a.child,Q=v.sibling;var re={mode:"hidden",children:m.children};return(D&1)===0&&l.child!==v?(m=l.child,m.childLanes=0,m.pendingProps=re,l.deletions=null):(m=$a(v,re),m.subtreeFlags=v.subtreeFlags&14680064),Q!==null?w=$a(Q,w):(w=Wo(w,D,u,null),w.flags|=2),w.return=l,m.return=l,m.sibling=w,l.child=m,m=w,w=l.child,D=a.child.memoizedState,D=D===null?Ip(u):{baseLanes:D.baseLanes|u,cachePool:null,transitions:D.transitions},w.memoizedState=D,w.childLanes=a.childLanes&~u,l.memoizedState=Cp,m}return w=a.child,a=w.sibling,m=$a(w,{mode:"visible",children:m.children}),(l.mode&1)===0&&(m.lanes=u),m.return=l,m.sibling=null,a!==null&&(u=l.deletions,u===null?(l.deletions=[a],l.flags|=16):u.push(a)),l.child=m,l.memoizedState=null,m}function Fp(a,l){return l=Bh({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function Ah(a,l,u,m){return m!==null&&rp(m),ql(l,a.child,null,u),a=Fp(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function YA(a,l,u,m,v,w,D){if(u)return l.flags&256?(l.flags&=-257,m=Tp(Error(r(422))),Ah(a,l,D,m)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(w=m.fallback,v=l.mode,m=Bh({mode:"visible",children:m.children},v,0,null),w=Wo(w,v,D,null),w.flags|=2,m.return=l,w.return=l,m.sibling=w,l.child=m,(l.mode&1)!==0&&ql(l,a.child,null,D),l.child.memoizedState=Ip(D),l.memoizedState=Cp,w);if((l.mode&1)===0)return Ah(a,l,D,null);if(v.data==="$!"){if(m=v.nextSibling&&v.nextSibling.dataset,m)var Q=m.dgst;return m=Q,w=Error(r(419)),m=Tp(w,m,void 0),Ah(a,l,D,m)}if(Q=(D&a.childLanes)!==0,Qn||Q){if(m=Jr,m!==null){switch(D&-D){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(m.suspendedLanes|D))!==0?0:v,v!==0&&v!==w.retryLane&&(w.retryLane=v,ea(a,v),Zs(m,a,v,-1))}return $p(),m=Tp(Error(r(421))),Ah(a,l,D,m)}return v.data==="$?"?(l.flags|=128,l.child=a.child,l=c4.bind(null,a),v._reactRetry=l,null):(a=w.treeContext,ms=ba(v.nextSibling),ps=l,hr=!0,Xs=null,a!==null&&(Cs[Is++]=Ji,Cs[Is++]=Zi,Cs[Is++]=bo,Ji=a.id,Zi=a.overflow,bo=l),l=Fp(l,m.children),l.flags|=4096,l)}function qv(a,l,u){a.lanes|=l;var m=a.alternate;m!==null&&(m.lanes|=l),ap(a.return,l,u)}function Rp(a,l,u,m,v){var w=a.memoizedState;w===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:v}:(w.isBackwards=l,w.rendering=null,w.renderingStartTime=0,w.last=m,w.tail=u,w.tailMode=v)}function Kv(a,l,u){var m=l.pendingProps,v=m.revealOrder,w=m.tail;if(jn(a,l,m.children,u),m=mr.current,(m&2)!==0)m=m&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&qv(a,u,l);else if(a.tag===19)qv(a,u,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}if(tr(mr,m),(l.mode&1)===0)l.memoizedState=null;else switch(v){case"forwards":for(u=l.child,v=null;u!==null;)a=u.alternate,a!==null&&_h(a)===null&&(v=u),u=u.sibling;u=v,u===null?(v=l.child,l.child=null):(v=u.sibling,u.sibling=null),Rp(l,!1,v,u,w);break;case"backwards":for(u=null,v=l.child,l.child=null;v!==null;){if(a=v.alternate,a!==null&&_h(a)===null){l.child=v;break}a=v.sibling,v.sibling=u,u=v,v=a}Rp(l,!0,u,null,w);break;case"together":Rp(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Ch(a,l){(l.mode&1)===0&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function ra(a,l,u){if(a!==null&&(l.dependencies=a.dependencies),Bo|=l.lanes,(u&l.childLanes)===0)return null;if(a!==null&&l.child!==a.child)throw Error(r(153));if(l.child!==null){for(a=l.child,u=$a(a,a.pendingProps),l.child=u,u.return=l;a.sibling!==null;)a=a.sibling,u=u.sibling=$a(a,a.pendingProps),u.return=l;u.sibling=null}return l.child}function QA(a,l,u){switch(l.tag){case 3:Hv(l),Gl();break;case 5:lv(l);break;case 1:Yn(l.type)&&ch(l);break;case 4:cp(l,l.stateNode.containerInfo);break;case 10:var m=l.type._context,v=l.memoizedProps.value;tr(mh,m._currentValue),m._currentValue=v;break;case 13:if(m=l.memoizedState,m!==null)return m.dehydrated!==null?(tr(mr,mr.current&1),l.flags|=128,null):(u&l.child.childLanes)!==0?Gv(a,l,u):(tr(mr,mr.current&1),a=ra(a,l,u),a!==null?a.sibling:null);tr(mr,mr.current&1);break;case 19:if(m=(u&l.childLanes)!==0,(a.flags&128)!==0){if(m)return Kv(a,l,u);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),tr(mr,mr.current),m)break;return null;case 22:case 23:return l.lanes=0,jv(a,l,u)}return ra(a,l,u)}var Xv,Np,Yv,Qv;Xv=function(a,l){for(var u=l.child;u!==null;){if(u.tag===5||u.tag===6)a.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},Np=function(){},Yv=function(a,l,u,m){var v=a.memoizedProps;if(v!==m){a=l.stateNode,Mo(ki.current);var w=null;switch(u){case"input":v=gt(a,v),m=gt(a,m),w=[];break;case"select":v=ye({},v,{value:void 0}),m=ye({},m,{value:void 0}),w=[];break;case"textarea":v=gn(a,v),m=gn(a,m),w=[];break;default:typeof v.onClick!="function"&&typeof m.onClick=="function"&&(a.onclick=ah)}Bn(u,m);var D;u=null;for(de in v)if(!m.hasOwnProperty(de)&&v.hasOwnProperty(de)&&v[de]!=null)if(de==="style"){var Q=v[de];for(D in Q)Q.hasOwnProperty(D)&&(u||(u={}),u[D]="")}else de!=="dangerouslySetInnerHTML"&&de!=="children"&&de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&de!=="autoFocus"&&(s.hasOwnProperty(de)?w||(w=[]):(w=w||[]).push(de,null));for(de in m){var re=m[de];if(Q=v!=null?v[de]:void 0,m.hasOwnProperty(de)&&re!==Q&&(re!=null||Q!=null))if(de==="style")if(Q){for(D in Q)!Q.hasOwnProperty(D)||re&&re.hasOwnProperty(D)||(u||(u={}),u[D]="");for(D in re)re.hasOwnProperty(D)&&Q[D]!==re[D]&&(u||(u={}),u[D]=re[D])}else u||(w||(w=[]),w.push(de,u)),u=re;else de==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,Q=Q?Q.__html:void 0,re!=null&&Q!==re&&(w=w||[]).push(de,re)):de==="children"?typeof re!="string"&&typeof re!="number"||(w=w||[]).push(de,""+re):de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&(s.hasOwnProperty(de)?(re!=null&&de==="onScroll"&&sr("scroll",a),w||Q===re||(w=[])):(w=w||[]).push(de,re))}u&&(w=w||[]).push("style",u);var de=w;(l.updateQueue=de)&&(l.flags|=4)}},Qv=function(a,l,u,m){u!==m&&(l.flags|=4)};function yu(a,l){if(!hr)switch(a.tailMode){case"hidden":l=a.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a.tail=null:u.sibling=null;break;case"collapsed":u=a.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function En(a){var l=a.alternate!==null&&a.alternate.child===a.child,u=0,m=0;if(l)for(var v=a.child;v!==null;)u|=v.lanes|v.childLanes,m|=v.subtreeFlags&14680064,m|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)u|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=m,a.childLanes=u,l}function JA(a,l,u){var m=l.pendingProps;switch(Zd(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return En(l),null;case 1:return Yn(l.type)&&lh(),En(l),null;case 3:return m=l.stateNode,Yl(),ir(Xn),ir(yn),hp(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(dh(l)?l.flags|=4:a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Xs!==null&&(zp(Xs),Xs=null))),Np(a,l),En(l),null;case 5:up(l);var v=Mo(mu.current);if(u=l.type,a!==null&&l.stateNode!=null)Yv(a,l,u,m,v),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!m){if(l.stateNode===null)throw Error(r(166));return En(l),null}if(a=Mo(ki.current),dh(l)){m=l.stateNode,u=l.type;var w=l.memoizedProps;switch(m[Si]=l,m[uu]=w,a=(l.mode&1)!==0,u){case"dialog":sr("cancel",m),sr("close",m);break;case"iframe":case"object":case"embed":sr("load",m);break;case"video":case"audio":for(v=0;v<ou.length;v++)sr(ou[v],m);break;case"source":sr("error",m);break;case"img":case"image":case"link":sr("error",m),sr("load",m);break;case"details":sr("toggle",m);break;case"input":It(m,w),sr("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!w.multiple},sr("invalid",m);break;case"textarea":sn(m,w),sr("invalid",m)}Bn(u,w),v=null;for(var D in w)if(w.hasOwnProperty(D)){var Q=w[D];D==="children"?typeof Q=="string"?m.textContent!==Q&&(w.suppressHydrationWarning!==!0&&ih(m.textContent,Q,a),v=["children",Q]):typeof Q=="number"&&m.textContent!==""+Q&&(w.suppressHydrationWarning!==!0&&ih(m.textContent,Q,a),v=["children",""+Q]):s.hasOwnProperty(D)&&Q!=null&&D==="onScroll"&&sr("scroll",m)}switch(u){case"input":st(m),Ht(m,w,!0);break;case"textarea":st(m),Pr(m);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(m.onclick=ah)}m=v,l.updateQueue=m,m!==null&&(l.flags|=4)}else{D=v.nodeType===9?v:v.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=xn(u)),a==="http://www.w3.org/1999/xhtml"?u==="script"?(a=D.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof m.is=="string"?a=D.createElement(u,{is:m.is}):(a=D.createElement(u),u==="select"&&(D=a,m.multiple?D.multiple=!0:m.size&&(D.size=m.size))):a=D.createElementNS(a,u),a[Si]=l,a[uu]=m,Xv(a,l,!1,!1),l.stateNode=a;e:{switch(D=fi(u,m),u){case"dialog":sr("cancel",a),sr("close",a),v=m;break;case"iframe":case"object":case"embed":sr("load",a),v=m;break;case"video":case"audio":for(v=0;v<ou.length;v++)sr(ou[v],a);v=m;break;case"source":sr("error",a),v=m;break;case"img":case"image":case"link":sr("error",a),sr("load",a),v=m;break;case"details":sr("toggle",a),v=m;break;case"input":It(a,m),v=gt(a,m),sr("invalid",a);break;case"option":v=m;break;case"select":a._wrapperState={wasMultiple:!!m.multiple},v=ye({},m,{value:void 0}),sr("invalid",a);break;case"textarea":sn(a,m),v=gn(a,m),sr("invalid",a);break;default:v=m}Bn(u,v),Q=v;for(w in Q)if(Q.hasOwnProperty(w)){var re=Q[w];w==="style"?vn(a,re):w==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,re!=null&&Yr(a,re)):w==="children"?typeof re=="string"?(u!=="textarea"||re!=="")&&ot(a,re):typeof re=="number"&&ot(a,""+re):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(s.hasOwnProperty(w)?re!=null&&w==="onScroll"&&sr("scroll",a):re!=null&&N(a,w,re,D))}switch(u){case"input":st(a),Ht(a,m,!1);break;case"textarea":st(a),Pr(a);break;case"option":m.value!=null&&a.setAttribute("value",""+ve(m.value));break;case"select":a.multiple=!!m.multiple,w=m.value,w!=null?dr(a,!!m.multiple,w,!1):m.defaultValue!=null&&dr(a,!!m.multiple,m.defaultValue,!0);break;default:typeof v.onClick=="function"&&(a.onclick=ah)}switch(u){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return En(l),null;case 6:if(a&&l.stateNode!=null)Qv(a,l,a.memoizedProps,m);else{if(typeof m!="string"&&l.stateNode===null)throw Error(r(166));if(u=Mo(mu.current),Mo(ki.current),dh(l)){if(m=l.stateNode,u=l.memoizedProps,m[Si]=l,(w=m.nodeValue!==u)&&(a=ps,a!==null))switch(a.tag){case 3:ih(m.nodeValue,u,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&ih(m.nodeValue,u,(a.mode&1)!==0)}w&&(l.flags|=4)}else m=(u.nodeType===9?u:u.ownerDocument).createTextNode(m),m[Si]=l,l.stateNode=m}return En(l),null;case 13:if(ir(mr),m=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(hr&&ms!==null&&(l.mode&1)!==0&&(l.flags&128)===0)ev(),Gl(),l.flags|=98560,w=!1;else if(w=dh(l),m!==null&&m.dehydrated!==null){if(a===null){if(!w)throw Error(r(318));if(w=l.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(r(317));w[Si]=l}else Gl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;En(l),w=!1}else Xs!==null&&(zp(Xs),Xs=null),w=!0;if(!w)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=u,l):(m=m!==null,m!==(a!==null&&a.memoizedState!==null)&&m&&(l.child.flags|=8192,(l.mode&1)!==0&&(a===null||(mr.current&1)!==0?Gr===0&&(Gr=3):$p())),l.updateQueue!==null&&(l.flags|=4),En(l),null);case 4:return Yl(),Np(a,l),a===null&&lu(l.stateNode.containerInfo),En(l),null;case 10:return ip(l.type._context),En(l),null;case 17:return Yn(l.type)&&lh(),En(l),null;case 19:if(ir(mr),w=l.memoizedState,w===null)return En(l),null;if(m=(l.flags&128)!==0,D=w.rendering,D===null)if(m)yu(w,!1);else{if(Gr!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(D=_h(a),D!==null){for(l.flags|=128,yu(w,!1),m=D.updateQueue,m!==null&&(l.updateQueue=m,l.flags|=4),l.subtreeFlags=0,m=u,u=l.child;u!==null;)w=u,a=m,w.flags&=14680066,D=w.alternate,D===null?(w.childLanes=0,w.lanes=a,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=D.childLanes,w.lanes=D.lanes,w.child=D.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=D.memoizedProps,w.memoizedState=D.memoizedState,w.updateQueue=D.updateQueue,w.type=D.type,a=D.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),u=u.sibling;return tr(mr,mr.current&1|2),l.child}a=a.sibling}w.tail!==null&&Pe()>ec&&(l.flags|=128,m=!0,yu(w,!1),l.lanes=4194304)}else{if(!m)if(a=_h(D),a!==null){if(l.flags|=128,m=!0,u=a.updateQueue,u!==null&&(l.updateQueue=u,l.flags|=4),yu(w,!0),w.tail===null&&w.tailMode==="hidden"&&!D.alternate&&!hr)return En(l),null}else 2*Pe()-w.renderingStartTime>ec&&u!==1073741824&&(l.flags|=128,m=!0,yu(w,!1),l.lanes=4194304);w.isBackwards?(D.sibling=l.child,l.child=D):(u=w.last,u!==null?u.sibling=D:l.child=D,w.last=D)}return w.tail!==null?(l=w.tail,w.rendering=l,w.tail=l.sibling,w.renderingStartTime=Pe(),l.sibling=null,u=mr.current,tr(mr,m?u&1|2:u&1),l):(En(l),null);case 22:case 23:return Hp(),m=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==m&&(l.flags|=8192),m&&(l.mode&1)!==0?(gs&1073741824)!==0&&(En(l),l.subtreeFlags&6&&(l.flags|=8192)):En(l),null;case 24:return null;case 25:return null}throw Error(r(156,l.tag))}function ZA(a,l){switch(Zd(l),l.tag){case 1:return Yn(l.type)&&lh(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Yl(),ir(Xn),ir(yn),hp(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 5:return up(l),null;case 13:if(ir(mr),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Gl()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return ir(mr),null;case 4:return Yl(),null;case 10:return ip(l.type._context),null;case 22:case 23:return Hp(),null;case 24:return null;default:return null}}var Ih=!1,Tn=!1,e4=typeof WeakSet=="function"?WeakSet:Set,qe=null;function Jl(a,l){var u=a.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(m){wr(a,l,m)}else u.current=null}function Dp(a,l,u){try{u()}catch(m){wr(a,l,m)}}var Jv=!1;function t4(a,l){if(Hd=qi,a=Rx(),Ld(a)){if("selectionStart"in a)var u={start:a.selectionStart,end:a.selectionEnd};else e:{u=(u=a.ownerDocument)&&u.defaultView||window;var m=u.getSelection&&u.getSelection();if(m&&m.rangeCount!==0){u=m.anchorNode;var v=m.anchorOffset,w=m.focusNode;m=m.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var D=0,Q=-1,re=-1,de=0,Ie=0,be=a,Ae=null;t:for(;;){for(var $e;be!==u||v!==0&&be.nodeType!==3||(Q=D+v),be!==w||m!==0&&be.nodeType!==3||(re=D+m),be.nodeType===3&&(D+=be.nodeValue.length),($e=be.firstChild)!==null;)Ae=be,be=$e;for(;;){if(be===a)break t;if(Ae===u&&++de===v&&(Q=D),Ae===w&&++Ie===m&&(re=D),($e=be.nextSibling)!==null)break;be=Ae,Ae=be.parentNode}be=$e}u=Q===-1||re===-1?null:{start:Q,end:re}}else u=null}u=u||{start:0,end:0}}else u=null;for($d={focusedElem:a,selectionRange:u},qi=!1,qe=l;qe!==null;)if(l=qe,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,qe=a;else for(;qe!==null;){l=qe;try{var Ke=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Ke!==null){var Xe=Ke.memoizedProps,Ir=Ke.memoizedState,ie=l.stateNode,se=ie.getSnapshotBeforeUpdate(l.elementType===l.type?Xe:Ys(l.type,Xe),Ir);ie.__reactInternalSnapshotBeforeUpdate=se}break;case 3:var ue=l.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Me){wr(l,l.return,Me)}if(a=l.sibling,a!==null){a.return=l.return,qe=a;break}qe=l.return}return Ke=Jv,Jv=!1,Ke}function wu(a,l,u){var m=l.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var v=m=m.next;do{if((v.tag&a)===a){var w=v.destroy;v.destroy=void 0,w!==void 0&&Dp(l,u,w)}v=v.next}while(v!==m)}}function Fh(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&a)===a){var m=u.create;u.destroy=m()}u=u.next}while(u!==l)}}function Pp(a){var l=a.ref;if(l!==null){var u=a.stateNode;switch(a.tag){case 5:a=u;break;default:a=u}typeof l=="function"?l(a):l.current=a}}function Zv(a){var l=a.alternate;l!==null&&(a.alternate=null,Zv(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&(delete l[Si],delete l[uu],delete l[Xd],delete l[MA],delete l[VA])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function e_(a){return a.tag===5||a.tag===3||a.tag===4}function t_(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||e_(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function bp(a,l,u){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?u.nodeType===8?u.parentNode.insertBefore(a,l):u.insertBefore(a,l):(u.nodeType===8?(l=u.parentNode,l.insertBefore(a,u)):(l=u,l.appendChild(a)),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=ah));else if(m!==4&&(a=a.child,a!==null))for(bp(a,l,u),a=a.sibling;a!==null;)bp(a,l,u),a=a.sibling}function Op(a,l,u){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?u.insertBefore(a,l):u.appendChild(a);else if(m!==4&&(a=a.child,a!==null))for(Op(a,l,u),a=a.sibling;a!==null;)Op(a,l,u),a=a.sibling}var ln=null,Qs=!1;function Ua(a,l,u){for(u=u.child;u!==null;)r_(a,l,u),u=u.sibling}function r_(a,l,u){if(Ar&&typeof Ar.onCommitFiberUnmount=="function")try{Ar.onCommitFiberUnmount(cs,u)}catch{}switch(u.tag){case 5:Tn||Jl(u,l);case 6:var m=ln,v=Qs;ln=null,Ua(a,l,u),ln=m,Qs=v,ln!==null&&(Qs?(a=ln,u=u.stateNode,a.nodeType===8?a.parentNode.removeChild(u):a.removeChild(u)):ln.removeChild(u.stateNode));break;case 18:ln!==null&&(Qs?(a=ln,u=u.stateNode,a.nodeType===8?Kd(a.parentNode,u):a.nodeType===1&&Kd(a,u),Ra(a)):Kd(ln,u.stateNode));break;case 4:m=ln,v=Qs,ln=u.stateNode.containerInfo,Qs=!0,Ua(a,l,u),ln=m,Qs=v;break;case 0:case 11:case 14:case 15:if(!Tn&&(m=u.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){v=m=m.next;do{var w=v,D=w.destroy;w=w.tag,D!==void 0&&((w&2)!==0||(w&4)!==0)&&Dp(u,l,D),v=v.next}while(v!==m)}Ua(a,l,u);break;case 1:if(!Tn&&(Jl(u,l),m=u.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=u.memoizedProps,m.state=u.memoizedState,m.componentWillUnmount()}catch(Q){wr(u,l,Q)}Ua(a,l,u);break;case 21:Ua(a,l,u);break;case 22:u.mode&1?(Tn=(m=Tn)||u.memoizedState!==null,Ua(a,l,u),Tn=m):Ua(a,l,u);break;default:Ua(a,l,u)}}function n_(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var u=a.stateNode;u===null&&(u=a.stateNode=new e4),l.forEach(function(m){var v=u4.bind(null,a,m);u.has(m)||(u.add(m),m.then(v,v))})}}function Js(a,l){var u=l.deletions;if(u!==null)for(var m=0;m<u.length;m++){var v=u[m];try{var w=a,D=l,Q=D;e:for(;Q!==null;){switch(Q.tag){case 5:ln=Q.stateNode,Qs=!1;break e;case 3:ln=Q.stateNode.containerInfo,Qs=!0;break e;case 4:ln=Q.stateNode.containerInfo,Qs=!0;break e}Q=Q.return}if(ln===null)throw Error(r(160));r_(w,D,v),ln=null,Qs=!1;var re=v.alternate;re!==null&&(re.return=null),v.return=null}catch(de){wr(v,l,de)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)s_(l,a),l=l.sibling}function s_(a,l){var u=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Js(l,a),Ci(a),m&4){try{wu(3,a,a.return),Fh(3,a)}catch(Xe){wr(a,a.return,Xe)}try{wu(5,a,a.return)}catch(Xe){wr(a,a.return,Xe)}}break;case 1:Js(l,a),Ci(a),m&512&&u!==null&&Jl(u,u.return);break;case 5:if(Js(l,a),Ci(a),m&512&&u!==null&&Jl(u,u.return),a.flags&32){var v=a.stateNode;try{ot(v,"")}catch(Xe){wr(a,a.return,Xe)}}if(m&4&&(v=a.stateNode,v!=null)){var w=a.memoizedProps,D=u!==null?u.memoizedProps:w,Q=a.type,re=a.updateQueue;if(a.updateQueue=null,re!==null)try{Q==="input"&&w.type==="radio"&&w.name!=null&&ht(v,w),fi(Q,D);var de=fi(Q,w);for(D=0;D<re.length;D+=2){var Ie=re[D],be=re[D+1];Ie==="style"?vn(v,be):Ie==="dangerouslySetInnerHTML"?Yr(v,be):Ie==="children"?ot(v,be):N(v,Ie,be,de)}switch(Q){case"input":Ue(v,w);break;case"textarea":Wr(v,w);break;case"select":var Ae=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!w.multiple;var $e=w.value;$e!=null?dr(v,!!w.multiple,$e,!1):Ae!==!!w.multiple&&(w.defaultValue!=null?dr(v,!!w.multiple,w.defaultValue,!0):dr(v,!!w.multiple,w.multiple?[]:"",!1))}v[uu]=w}catch(Xe){wr(a,a.return,Xe)}}break;case 6:if(Js(l,a),Ci(a),m&4){if(a.stateNode===null)throw Error(r(162));v=a.stateNode,w=a.memoizedProps;try{v.nodeValue=w}catch(Xe){wr(a,a.return,Xe)}}break;case 3:if(Js(l,a),Ci(a),m&4&&u!==null&&u.memoizedState.isDehydrated)try{Ra(l.containerInfo)}catch(Xe){wr(a,a.return,Xe)}break;case 4:Js(l,a),Ci(a);break;case 13:Js(l,a),Ci(a),v=a.child,v.flags&8192&&(w=v.memoizedState!==null,v.stateNode.isHidden=w,!w||v.alternate!==null&&v.alternate.memoizedState!==null||(Vp=Pe())),m&4&&n_(a);break;case 22:if(Ie=u!==null&&u.memoizedState!==null,a.mode&1?(Tn=(de=Tn)||Ie,Js(l,a),Tn=de):Js(l,a),Ci(a),m&8192){if(de=a.memoizedState!==null,(a.stateNode.isHidden=de)&&!Ie&&(a.mode&1)!==0)for(qe=a,Ie=a.child;Ie!==null;){for(be=qe=Ie;qe!==null;){switch(Ae=qe,$e=Ae.child,Ae.tag){case 0:case 11:case 14:case 15:wu(4,Ae,Ae.return);break;case 1:Jl(Ae,Ae.return);var Ke=Ae.stateNode;if(typeof Ke.componentWillUnmount=="function"){m=Ae,u=Ae.return;try{l=m,Ke.props=l.memoizedProps,Ke.state=l.memoizedState,Ke.componentWillUnmount()}catch(Xe){wr(m,u,Xe)}}break;case 5:Jl(Ae,Ae.return);break;case 22:if(Ae.memoizedState!==null){o_(be);continue}}$e!==null?($e.return=Ae,qe=$e):o_(be)}Ie=Ie.sibling}e:for(Ie=null,be=a;;){if(be.tag===5){if(Ie===null){Ie=be;try{v=be.stateNode,de?(w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(Q=be.stateNode,re=be.memoizedProps.style,D=re!=null&&re.hasOwnProperty("display")?re.display:null,Q.style.display=Mt("display",D))}catch(Xe){wr(a,a.return,Xe)}}}else if(be.tag===6){if(Ie===null)try{be.stateNode.nodeValue=de?"":be.memoizedProps}catch(Xe){wr(a,a.return,Xe)}}else if((be.tag!==22&&be.tag!==23||be.memoizedState===null||be===a)&&be.child!==null){be.child.return=be,be=be.child;continue}if(be===a)break e;for(;be.sibling===null;){if(be.return===null||be.return===a)break e;Ie===be&&(Ie=null),be=be.return}Ie===be&&(Ie=null),be.sibling.return=be.return,be=be.sibling}}break;case 19:Js(l,a),Ci(a),m&4&&n_(a);break;case 21:break;default:Js(l,a),Ci(a)}}function Ci(a){var l=a.flags;if(l&2){try{e:{for(var u=a.return;u!==null;){if(e_(u)){var m=u;break e}u=u.return}throw Error(r(160))}switch(m.tag){case 5:var v=m.stateNode;m.flags&32&&(ot(v,""),m.flags&=-33);var w=t_(a);Op(a,w,v);break;case 3:case 4:var D=m.stateNode.containerInfo,Q=t_(a);bp(a,Q,D);break;default:throw Error(r(161))}}catch(re){wr(a,a.return,re)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function r4(a,l,u){qe=a,i_(a)}function i_(a,l,u){for(var m=(a.mode&1)!==0;qe!==null;){var v=qe,w=v.child;if(v.tag===22&&m){var D=v.memoizedState!==null||Ih;if(!D){var Q=v.alternate,re=Q!==null&&Q.memoizedState!==null||Tn;Q=Ih;var de=Tn;if(Ih=D,(Tn=re)&&!de)for(qe=v;qe!==null;)D=qe,re=D.child,D.tag===22&&D.memoizedState!==null?l_(v):re!==null?(re.return=D,qe=re):l_(v);for(;w!==null;)qe=w,i_(w),w=w.sibling;qe=v,Ih=Q,Tn=de}a_(a)}else(v.subtreeFlags&8772)!==0&&w!==null?(w.return=v,qe=w):a_(a)}}function a_(a){for(;qe!==null;){var l=qe;if((l.flags&8772)!==0){var u=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Tn||Fh(5,l);break;case 1:var m=l.stateNode;if(l.flags&4&&!Tn)if(u===null)m.componentDidMount();else{var v=l.elementType===l.type?u.memoizedProps:Ys(l.type,u.memoizedProps);m.componentDidUpdate(v,u.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var w=l.updateQueue;w!==null&&ov(l,w,m);break;case 3:var D=l.updateQueue;if(D!==null){if(u=null,l.child!==null)switch(l.child.tag){case 5:u=l.child.stateNode;break;case 1:u=l.child.stateNode}ov(l,D,u)}break;case 5:var Q=l.stateNode;if(u===null&&l.flags&4){u=Q;var re=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":re.autoFocus&&u.focus();break;case"img":re.src&&(u.src=re.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var de=l.alternate;if(de!==null){var Ie=de.memoizedState;if(Ie!==null){var be=Ie.dehydrated;be!==null&&Ra(be)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Tn||l.flags&512&&Pp(l)}catch(Ae){wr(l,l.return,Ae)}}if(l===a){qe=null;break}if(u=l.sibling,u!==null){u.return=l.return,qe=u;break}qe=l.return}}function o_(a){for(;qe!==null;){var l=qe;if(l===a){qe=null;break}var u=l.sibling;if(u!==null){u.return=l.return,qe=u;break}qe=l.return}}function l_(a){for(;qe!==null;){var l=qe;try{switch(l.tag){case 0:case 11:case 15:var u=l.return;try{Fh(4,l)}catch(re){wr(l,u,re)}break;case 1:var m=l.stateNode;if(typeof m.componentDidMount=="function"){var v=l.return;try{m.componentDidMount()}catch(re){wr(l,v,re)}}var w=l.return;try{Pp(l)}catch(re){wr(l,w,re)}break;case 5:var D=l.return;try{Pp(l)}catch(re){wr(l,D,re)}}}catch(re){wr(l,l.return,re)}if(l===a){qe=null;break}var Q=l.sibling;if(Q!==null){Q.return=l.return,qe=Q;break}qe=l.return}}var n4=Math.ceil,Rh=U.ReactCurrentDispatcher,Lp=U.ReactCurrentOwner,Ns=U.ReactCurrentBatchConfig,Dt=0,Jr=null,Or=null,cn=0,gs=0,Zl=Oa(0),Gr=0,Eu=null,Bo=0,Nh=0,Mp=0,Tu=null,Jn=null,Vp=0,ec=1/0,na=null,Dh=!1,Bp=null,ja=null,Ph=!1,za=null,bh=0,Su=0,Up=null,Oh=-1,Lh=0;function zn(){return(Dt&6)!==0?Pe():Oh!==-1?Oh:Oh=Pe()}function Wa(a){return(a.mode&1)===0?1:(Dt&2)!==0&&cn!==0?cn&-cn:UA.transition!==null?(Lh===0&&(Lh=$c()),Lh):(a=Ft,a!==0||(a=window.event,a=a===void 0?16:Fl(a.type)),a)}function Zs(a,l,u,m){if(50<Su)throw Su=0,Up=null,Error(r(185));Co(a,u,m),((Dt&2)===0||a!==Jr)&&(a===Jr&&((Dt&2)===0&&(Nh|=u),Gr===4&&Ha(a,cn)),Zn(a,m),u===1&&Dt===0&&(l.mode&1)===0&&(ec=Pe()+500,uh&&Ma()))}function Zn(a,l){var u=a.callbackNode;Ao(a,l);var m=Hi(a,a===Jr?cn:0);if(m===0)u!==null&&Ve(u),a.callbackNode=null,a.callbackPriority=0;else if(l=m&-m,a.callbackPriority!==l){if(u!=null&&Ve(u),l===1)a.tag===0?BA(u_.bind(null,a)):Xx(u_.bind(null,a)),OA(function(){(Dt&6)===0&&Ma()}),u=null;else{switch(pi(m)){case 1:u=zt;break;case 4:u=Gt;break;case 16:u=fr;break;case 536870912:u=ks;break;default:u=fr}u=v_(u,c_.bind(null,a))}a.callbackPriority=l,a.callbackNode=u}}function c_(a,l){if(Oh=-1,Lh=0,(Dt&6)!==0)throw Error(r(327));var u=a.callbackNode;if(tc()&&a.callbackNode!==u)return null;var m=Hi(a,a===Jr?cn:0);if(m===0)return null;if((m&30)!==0||(m&a.expiredLanes)!==0||l)l=Mh(a,m);else{l=m;var v=Dt;Dt|=2;var w=h_();(Jr!==a||cn!==l)&&(na=null,ec=Pe()+500,jo(a,l));do try{a4();break}catch(Q){f_(a,Q)}while(!0);sp(),Rh.current=w,Dt=v,Or!==null?l=0:(Jr=null,cn=0,l=Gr)}if(l!==0){if(l===2&&(v=Hc(a),v!==0&&(m=v,l=jp(a,v))),l===1)throw u=Eu,jo(a,0),Ha(a,m),Zn(a,Pe()),u;if(l===6)Ha(a,m);else{if(v=a.current.alternate,(m&30)===0&&!s4(v)&&(l=Mh(a,m),l===2&&(w=Hc(a),w!==0&&(m=w,l=jp(a,w))),l===1))throw u=Eu,jo(a,0),Ha(a,m),Zn(a,Pe()),u;switch(a.finishedWork=v,a.finishedLanes=m,l){case 0:case 1:throw Error(r(345));case 2:zo(a,Jn,na);break;case 3:if(Ha(a,m),(m&130023424)===m&&(l=Vp+500-Pe(),10<l)){if(Hi(a,0)!==0)break;if(v=a.suspendedLanes,(v&m)!==m){zn(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=qd(zo.bind(null,a,Jn,na),l);break}zo(a,Jn,na);break;case 4:if(Ha(a,m),(m&4194240)===m)break;for(l=a.eventTimes,v=-1;0<m;){var D=31-pr(m);w=1<<D,D=l[D],D>v&&(v=D),m&=~w}if(m=v,m=Pe()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*n4(m/1960))-m,10<m){a.timeoutHandle=qd(zo.bind(null,a,Jn,na),m);break}zo(a,Jn,na);break;case 5:zo(a,Jn,na);break;default:throw Error(r(329))}}}return Zn(a,Pe()),a.callbackNode===u?c_.bind(null,a):null}function jp(a,l){var u=Tu;return a.current.memoizedState.isDehydrated&&(jo(a,l).flags|=256),a=Mh(a,l),a!==2&&(l=Jn,Jn=u,l!==null&&zp(l)),a}function zp(a){Jn===null?Jn=a:Jn.push.apply(Jn,a)}function s4(a){for(var l=a;;){if(l.flags&16384){var u=l.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var m=0;m<u.length;m++){var v=u[m],w=v.getSnapshot;v=v.value;try{if(!Ks(w(),v))return!1}catch{return!1}}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ha(a,l){for(l&=~Mp,l&=~Nh,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var u=31-pr(l),m=1<<u;a[u]=-1,l&=~m}}function u_(a){if((Dt&6)!==0)throw Error(r(327));tc();var l=Hi(a,0);if((l&1)===0)return Zn(a,Pe()),null;var u=Mh(a,l);if(a.tag!==0&&u===2){var m=Hc(a);m!==0&&(l=m,u=jp(a,m))}if(u===1)throw u=Eu,jo(a,0),Ha(a,l),Zn(a,Pe()),u;if(u===6)throw Error(r(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,zo(a,Jn,na),Zn(a,Pe()),null}function Wp(a,l){var u=Dt;Dt|=1;try{return a(l)}finally{Dt=u,Dt===0&&(ec=Pe()+500,uh&&Ma())}}function Uo(a){za!==null&&za.tag===0&&(Dt&6)===0&&tc();var l=Dt;Dt|=1;var u=Ns.transition,m=Ft;try{if(Ns.transition=null,Ft=1,a)return a()}finally{Ft=m,Ns.transition=u,Dt=l,(Dt&6)===0&&Ma()}}function Hp(){gs=Zl.current,ir(Zl)}function jo(a,l){a.finishedWork=null,a.finishedLanes=0;var u=a.timeoutHandle;if(u!==-1&&(a.timeoutHandle=-1,bA(u)),Or!==null)for(u=Or.return;u!==null;){var m=u;switch(Zd(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&lh();break;case 3:Yl(),ir(Xn),ir(yn),hp();break;case 5:up(m);break;case 4:Yl();break;case 13:ir(mr);break;case 19:ir(mr);break;case 10:ip(m.type._context);break;case 22:case 23:Hp()}u=u.return}if(Jr=a,Or=a=$a(a.current,null),cn=gs=l,Gr=0,Eu=null,Mp=Nh=Bo=0,Jn=Tu=null,Lo!==null){for(l=0;l<Lo.length;l++)if(u=Lo[l],m=u.interleaved,m!==null){u.interleaved=null;var v=m.next,w=u.pending;if(w!==null){var D=w.next;w.next=v,m.next=D}u.pending=m}Lo=null}return a}function f_(a,l){do{var u=Or;try{if(sp(),yh.current=Sh,wh){for(var m=gr.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}wh=!1}if(Vo=0,Qr=$r=gr=null,gu=!1,xu=0,Lp.current=null,u===null||u.return===null){Gr=1,Eu=l,Or=null;break}e:{var w=a,D=u.return,Q=u,re=l;if(l=cn,Q.flags|=32768,re!==null&&typeof re=="object"&&typeof re.then=="function"){var de=re,Ie=Q,be=Ie.tag;if((Ie.mode&1)===0&&(be===0||be===11||be===15)){var Ae=Ie.alternate;Ae?(Ie.updateQueue=Ae.updateQueue,Ie.memoizedState=Ae.memoizedState,Ie.lanes=Ae.lanes):(Ie.updateQueue=null,Ie.memoizedState=null)}var $e=Lv(D);if($e!==null){$e.flags&=-257,Mv($e,D,Q,w,l),$e.mode&1&&Ov(w,de,l),l=$e,re=de;var Ke=l.updateQueue;if(Ke===null){var Xe=new Set;Xe.add(re),l.updateQueue=Xe}else Ke.add(re);break e}else{if((l&1)===0){Ov(w,de,l),$p();break e}re=Error(r(426))}}else if(hr&&Q.mode&1){var Ir=Lv(D);if(Ir!==null){(Ir.flags&65536)===0&&(Ir.flags|=256),Mv(Ir,D,Q,w,l),rp(Ql(re,Q));break e}}w=re=Ql(re,Q),Gr!==4&&(Gr=2),Tu===null?Tu=[w]:Tu.push(w),w=D;do{switch(w.tag){case 3:w.flags|=65536,l&=-l,w.lanes|=l;var ie=Pv(w,re,l);av(w,ie);break e;case 1:Q=re;var se=w.type,ue=w.stateNode;if((w.flags&128)===0&&(typeof se.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(ja===null||!ja.has(ue)))){w.flags|=65536,l&=-l,w.lanes|=l;var Me=bv(w,Q,l);av(w,Me);break e}}w=w.return}while(w!==null)}p_(u)}catch(Ye){l=Ye,Or===u&&u!==null&&(Or=u=u.return);continue}break}while(!0)}function h_(){var a=Rh.current;return Rh.current=Sh,a===null?Sh:a}function $p(){(Gr===0||Gr===3||Gr===2)&&(Gr=4),Jr===null||(Bo&268435455)===0&&(Nh&268435455)===0||Ha(Jr,cn)}function Mh(a,l){var u=Dt;Dt|=2;var m=h_();(Jr!==a||cn!==l)&&(na=null,jo(a,l));do try{i4();break}catch(v){f_(a,v)}while(!0);if(sp(),Dt=u,Rh.current=m,Or!==null)throw Error(r(261));return Jr=null,cn=0,Gr}function i4(){for(;Or!==null;)d_(Or)}function a4(){for(;Or!==null&&!We();)d_(Or)}function d_(a){var l=x_(a.alternate,a,gs);a.memoizedProps=a.pendingProps,l===null?p_(a):Or=l,Lp.current=null}function p_(a){var l=a;do{var u=l.alternate;if(a=l.return,(l.flags&32768)===0){if(u=JA(u,l,gs),u!==null){Or=u;return}}else{if(u=ZA(u,l),u!==null){u.flags&=32767,Or=u;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Gr=6,Or=null;return}}if(l=l.sibling,l!==null){Or=l;return}Or=l=a}while(l!==null);Gr===0&&(Gr=5)}function zo(a,l,u){var m=Ft,v=Ns.transition;try{Ns.transition=null,Ft=1,o4(a,l,u,m)}finally{Ns.transition=v,Ft=m}return null}function o4(a,l,u,m){do tc();while(za!==null);if((Dt&6)!==0)throw Error(r(327));u=a.finishedWork;var v=a.finishedLanes;if(u===null)return null;if(a.finishedWork=null,a.finishedLanes=0,u===a.current)throw Error(r(177));a.callbackNode=null,a.callbackPriority=0;var w=u.lanes|u.childLanes;if(Nd(a,w),a===Jr&&(Or=Jr=null,cn=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||Ph||(Ph=!0,v_(fr,function(){return tc(),null})),w=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||w){w=Ns.transition,Ns.transition=null;var D=Ft;Ft=1;var Q=Dt;Dt|=4,Lp.current=null,t4(a,u),s_(u,a),CA($d),qi=!!Hd,$d=Hd=null,a.current=u,r4(u),De(),Dt=Q,Ft=D,Ns.transition=w}else a.current=u;if(Ph&&(Ph=!1,za=a,bh=v),w=a.pendingLanes,w===0&&(ja=null),Aa(u.stateNode),Zn(a,Pe()),l!==null)for(m=a.onRecoverableError,u=0;u<l.length;u++)v=l[u],m(v.value,{componentStack:v.stack,digest:v.digest});if(Dh)throw Dh=!1,a=Bp,Bp=null,a;return(bh&1)!==0&&a.tag!==0&&tc(),w=a.pendingLanes,(w&1)!==0?a===Up?Su++:(Su=0,Up=a):Su=0,Ma(),null}function tc(){if(za!==null){var a=pi(bh),l=Ns.transition,u=Ft;try{if(Ns.transition=null,Ft=16>a?16:a,za===null)var m=!1;else{if(a=za,za=null,bh=0,(Dt&6)!==0)throw Error(r(331));var v=Dt;for(Dt|=4,qe=a.current;qe!==null;){var w=qe,D=w.child;if((qe.flags&16)!==0){var Q=w.deletions;if(Q!==null){for(var re=0;re<Q.length;re++){var de=Q[re];for(qe=de;qe!==null;){var Ie=qe;switch(Ie.tag){case 0:case 11:case 15:wu(8,Ie,w)}var be=Ie.child;if(be!==null)be.return=Ie,qe=be;else for(;qe!==null;){Ie=qe;var Ae=Ie.sibling,$e=Ie.return;if(Zv(Ie),Ie===de){qe=null;break}if(Ae!==null){Ae.return=$e,qe=Ae;break}qe=$e}}}var Ke=w.alternate;if(Ke!==null){var Xe=Ke.child;if(Xe!==null){Ke.child=null;do{var Ir=Xe.sibling;Xe.sibling=null,Xe=Ir}while(Xe!==null)}}qe=w}}if((w.subtreeFlags&2064)!==0&&D!==null)D.return=w,qe=D;else e:for(;qe!==null;){if(w=qe,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:wu(9,w,w.return)}var ie=w.sibling;if(ie!==null){ie.return=w.return,qe=ie;break e}qe=w.return}}var se=a.current;for(qe=se;qe!==null;){D=qe;var ue=D.child;if((D.subtreeFlags&2064)!==0&&ue!==null)ue.return=D,qe=ue;else e:for(D=se;qe!==null;){if(Q=qe,(Q.flags&2048)!==0)try{switch(Q.tag){case 0:case 11:case 15:Fh(9,Q)}}catch(Ye){wr(Q,Q.return,Ye)}if(Q===D){qe=null;break e}var Me=Q.sibling;if(Me!==null){Me.return=Q.return,qe=Me;break e}qe=Q.return}}if(Dt=v,Ma(),Ar&&typeof Ar.onPostCommitFiberRoot=="function")try{Ar.onPostCommitFiberRoot(cs,a)}catch{}m=!0}return m}finally{Ft=u,Ns.transition=l}}return!1}function m_(a,l,u){l=Ql(u,l),l=Pv(a,l,1),a=Ba(a,l,1),l=zn(),a!==null&&(Co(a,1,l),Zn(a,l))}function wr(a,l,u){if(a.tag===3)m_(a,a,u);else for(;l!==null;){if(l.tag===3){m_(l,a,u);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(ja===null||!ja.has(m))){a=Ql(u,a),a=bv(l,a,1),l=Ba(l,a,1),a=zn(),l!==null&&(Co(l,1,a),Zn(l,a));break}}l=l.return}}function l4(a,l,u){var m=a.pingCache;m!==null&&m.delete(l),l=zn(),a.pingedLanes|=a.suspendedLanes&u,Jr===a&&(cn&u)===u&&(Gr===4||Gr===3&&(cn&130023424)===cn&&500>Pe()-Vp?jo(a,0):Mp|=u),Zn(a,l)}function g_(a,l){l===0&&((a.mode&1)===0?l=1:(l=Ca,Ca<<=1,(Ca&130023424)===0&&(Ca=4194304)));var u=zn();a=ea(a,l),a!==null&&(Co(a,l,u),Zn(a,u))}function c4(a){var l=a.memoizedState,u=0;l!==null&&(u=l.retryLane),g_(a,u)}function u4(a,l){var u=0;switch(a.tag){case 13:var m=a.stateNode,v=a.memoizedState;v!==null&&(u=v.retryLane);break;case 19:m=a.stateNode;break;default:throw Error(r(314))}m!==null&&m.delete(l),g_(a,u)}var x_;x_=function(a,l,u){if(a!==null)if(a.memoizedProps!==l.pendingProps||Xn.current)Qn=!0;else{if((a.lanes&u)===0&&(l.flags&128)===0)return Qn=!1,QA(a,l,u);Qn=(a.flags&131072)!==0}else Qn=!1,hr&&(l.flags&1048576)!==0&&Yx(l,hh,l.index);switch(l.lanes=0,l.tag){case 2:var m=l.type;Ch(a,l),a=l.pendingProps;var v=Wl(l,yn.current);Xl(l,u),v=mp(null,l,m,a,v,u);var w=gp();return l.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Yn(m)?(w=!0,ch(l)):w=!1,l.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,lp(l),v.updater=kh,l.stateNode=v,v._reactInternals=l,Ep(l,m,a,u),l=Ap(null,l,m,!0,w,u)):(l.tag=0,hr&&w&&Jd(l),jn(null,l,v,u),l=l.child),l;case 16:m=l.elementType;e:{switch(Ch(a,l),a=l.pendingProps,v=m._init,m=v(m._payload),l.type=m,v=l.tag=h4(m),a=Ys(m,a),v){case 0:l=kp(null,l,m,a,u);break e;case 1:l=Wv(null,l,m,a,u);break e;case 11:l=Vv(null,l,m,a,u);break e;case 14:l=Bv(null,l,m,Ys(m.type,a),u);break e}throw Error(r(306,m,""))}return l;case 0:return m=l.type,v=l.pendingProps,v=l.elementType===m?v:Ys(m,v),kp(a,l,m,v,u);case 1:return m=l.type,v=l.pendingProps,v=l.elementType===m?v:Ys(m,v),Wv(a,l,m,v,u);case 3:e:{if(Hv(l),a===null)throw Error(r(387));m=l.pendingProps,w=l.memoizedState,v=w.element,iv(a,l),vh(l,m,null,u);var D=l.memoizedState;if(m=D.element,w.isDehydrated)if(w={element:m,isDehydrated:!1,cache:D.cache,pendingSuspenseBoundaries:D.pendingSuspenseBoundaries,transitions:D.transitions},l.updateQueue.baseState=w,l.memoizedState=w,l.flags&256){v=Ql(Error(r(423)),l),l=$v(a,l,m,u,v);break e}else if(m!==v){v=Ql(Error(r(424)),l),l=$v(a,l,m,u,v);break e}else for(ms=ba(l.stateNode.containerInfo.firstChild),ps=l,hr=!0,Xs=null,u=nv(l,null,m,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Gl(),m===v){l=ra(a,l,u);break e}jn(a,l,m,u)}l=l.child}return l;case 5:return lv(l),a===null&&tp(l),m=l.type,v=l.pendingProps,w=a!==null?a.memoizedProps:null,D=v.children,Gd(m,v)?D=null:w!==null&&Gd(m,w)&&(l.flags|=32),zv(a,l),jn(a,l,D,u),l.child;case 6:return a===null&&tp(l),null;case 13:return Gv(a,l,u);case 4:return cp(l,l.stateNode.containerInfo),m=l.pendingProps,a===null?l.child=ql(l,null,m,u):jn(a,l,m,u),l.child;case 11:return m=l.type,v=l.pendingProps,v=l.elementType===m?v:Ys(m,v),Vv(a,l,m,v,u);case 7:return jn(a,l,l.pendingProps,u),l.child;case 8:return jn(a,l,l.pendingProps.children,u),l.child;case 12:return jn(a,l,l.pendingProps.children,u),l.child;case 10:e:{if(m=l.type._context,v=l.pendingProps,w=l.memoizedProps,D=v.value,tr(mh,m._currentValue),m._currentValue=D,w!==null)if(Ks(w.value,D)){if(w.children===v.children&&!Xn.current){l=ra(a,l,u);break e}}else for(w=l.child,w!==null&&(w.return=l);w!==null;){var Q=w.dependencies;if(Q!==null){D=w.child;for(var re=Q.firstContext;re!==null;){if(re.context===m){if(w.tag===1){re=ta(-1,u&-u),re.tag=2;var de=w.updateQueue;if(de!==null){de=de.shared;var Ie=de.pending;Ie===null?re.next=re:(re.next=Ie.next,Ie.next=re),de.pending=re}}w.lanes|=u,re=w.alternate,re!==null&&(re.lanes|=u),ap(w.return,u,l),Q.lanes|=u;break}re=re.next}}else if(w.tag===10)D=w.type===l.type?null:w.child;else if(w.tag===18){if(D=w.return,D===null)throw Error(r(341));D.lanes|=u,Q=D.alternate,Q!==null&&(Q.lanes|=u),ap(D,u,l),D=w.sibling}else D=w.child;if(D!==null)D.return=w;else for(D=w;D!==null;){if(D===l){D=null;break}if(w=D.sibling,w!==null){w.return=D.return,D=w;break}D=D.return}w=D}jn(a,l,v.children,u),l=l.child}return l;case 9:return v=l.type,m=l.pendingProps.children,Xl(l,u),v=Fs(v),m=m(v),l.flags|=1,jn(a,l,m,u),l.child;case 14:return m=l.type,v=Ys(m,l.pendingProps),v=Ys(m.type,v),Bv(a,l,m,v,u);case 15:return Uv(a,l,l.type,l.pendingProps,u);case 17:return m=l.type,v=l.pendingProps,v=l.elementType===m?v:Ys(m,v),Ch(a,l),l.tag=1,Yn(m)?(a=!0,ch(l)):a=!1,Xl(l,u),Nv(l,m,v),Ep(l,m,v,u),Ap(null,l,m,!0,a,u);case 19:return Kv(a,l,u);case 22:return jv(a,l,u)}throw Error(r(156,l.tag))};function v_(a,l){return Re(a,l)}function f4(a,l,u,m){this.tag=a,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ds(a,l,u,m){return new f4(a,l,u,m)}function Gp(a){return a=a.prototype,!(!a||!a.isReactComponent)}function h4(a){if(typeof a=="function")return Gp(a)?1:0;if(a!=null){if(a=a.$$typeof,a===M)return 11;if(a===Ce)return 14}return 2}function $a(a,l){var u=a.alternate;return u===null?(u=Ds(a.tag,l,a.key,a.mode),u.elementType=a.elementType,u.type=a.type,u.stateNode=a.stateNode,u.alternate=a,a.alternate=u):(u.pendingProps=l,u.type=a.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=a.flags&14680064,u.childLanes=a.childLanes,u.lanes=a.lanes,u.child=a.child,u.memoizedProps=a.memoizedProps,u.memoizedState=a.memoizedState,u.updateQueue=a.updateQueue,l=a.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=a.sibling,u.index=a.index,u.ref=a.ref,u}function Vh(a,l,u,m,v,w){var D=2;if(m=a,typeof a=="function")Gp(a)&&(D=1);else if(typeof a=="string")D=5;else e:switch(a){case k:return Wo(u.children,v,w,l);case F:D=8,v|=8;break;case I:return a=Ds(12,u,l,v|2),a.elementType=I,a.lanes=w,a;case V:return a=Ds(13,u,l,v),a.elementType=V,a.lanes=w,a;case Fe:return a=Ds(19,u,l,v),a.elementType=Fe,a.lanes=w,a;case Ne:return Bh(u,v,w,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case B:D=10;break e;case L:D=9;break e;case M:D=11;break e;case Ce:D=14;break e;case Le:D=16,m=null;break e}throw Error(r(130,a==null?a:typeof a,""))}return l=Ds(D,u,l,v),l.elementType=a,l.type=m,l.lanes=w,l}function Wo(a,l,u,m){return a=Ds(7,a,m,l),a.lanes=u,a}function Bh(a,l,u,m){return a=Ds(22,a,m,l),a.elementType=Ne,a.lanes=u,a.stateNode={isHidden:!1},a}function qp(a,l,u){return a=Ds(6,a,null,l),a.lanes=u,a}function Kp(a,l,u){return l=Ds(4,a.children!==null?a.children:[],a.key,l),l.lanes=u,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function d4(a,l,u,m,v){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gc(0),this.expirationTimes=Gc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gc(0),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function Xp(a,l,u,m,v,w,D,Q,re){return a=new d4(a,l,u,Q,re),l===1?(l=1,w===!0&&(l|=8)):l=0,w=Ds(3,null,null,l),a.current=w,w.stateNode=a,w.memoizedState={element:m,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},lp(w),a}function p4(a,l,u){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:m==null?null:""+m,children:a,containerInfo:l,implementation:u}}function __(a){if(!a)return La;a=a._reactInternals;e:{if(K(a)!==a||a.tag!==1)throw Error(r(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Yn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(r(171))}if(a.tag===1){var u=a.type;if(Yn(u))return qx(a,u,l)}return l}function y_(a,l,u,m,v,w,D,Q,re){return a=Xp(u,m,!0,a,v,w,D,Q,re),a.context=__(null),u=a.current,m=zn(),v=Wa(u),w=ta(m,v),w.callback=l??null,Ba(u,w,v),a.current.lanes=v,Co(a,v,m),Zn(a,m),a}function Uh(a,l,u,m){var v=l.current,w=zn(),D=Wa(v);return u=__(u),l.context===null?l.context=u:l.pendingContext=u,l=ta(w,D),l.payload={element:a},m=m===void 0?null:m,m!==null&&(l.callback=m),a=Ba(v,l,D),a!==null&&(Zs(a,v,D,w),xh(a,v,D)),D}function jh(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function w_(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var u=a.retryLane;a.retryLane=u!==0&&u<l?u:l}}function Yp(a,l){w_(a,l),(a=a.alternate)&&w_(a,l)}function m4(){return null}var E_=typeof reportError=="function"?reportError:function(a){console.error(a)};function Qp(a){this._internalRoot=a}zh.prototype.render=Qp.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(r(409));Uh(a,l,null,null)},zh.prototype.unmount=Qp.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;Uo(function(){Uh(null,a,null,null)}),l[Yi]=null}};function zh(a){this._internalRoot=a}zh.prototype.unstable_scheduleHydration=function(a){if(a){var l=Yc();a={blockedOn:null,target:a,priority:l};for(var u=0;u<us.length&&l!==0&&l<us[u].priority;u++);us.splice(u,0,a),u===0&&Cl(a)}};function Jp(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Wh(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function T_(){}function g4(a,l,u,m,v){if(v){if(typeof m=="function"){var w=m;m=function(){var de=jh(D);w.call(de)}}var D=y_(l,m,a,0,null,!1,!1,"",T_);return a._reactRootContainer=D,a[Yi]=D.current,lu(a.nodeType===8?a.parentNode:a),Uo(),D}for(;v=a.lastChild;)a.removeChild(v);if(typeof m=="function"){var Q=m;m=function(){var de=jh(re);Q.call(de)}}var re=Xp(a,0,!1,null,null,!1,!1,"",T_);return a._reactRootContainer=re,a[Yi]=re.current,lu(a.nodeType===8?a.parentNode:a),Uo(function(){Uh(l,re,u,m)}),re}function Hh(a,l,u,m,v){var w=u._reactRootContainer;if(w){var D=w;if(typeof v=="function"){var Q=v;v=function(){var re=jh(D);Q.call(re)}}Uh(l,D,a,v)}else D=g4(u,l,a,v,m);return jh(D)}Kc=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var u=Vt(l.pendingLanes);u!==0&&(qc(l,u|1),Zn(l,Pe()),(Dt&6)===0&&(ec=Pe()+500,Ma()))}break;case 13:Uo(function(){var m=ea(a,1);if(m!==null){var v=zn();Zs(m,a,1,v)}}),Yp(a,1)}},kl=function(a){if(a.tag===13){var l=ea(a,134217728);if(l!==null){var u=zn();Zs(l,a,134217728,u)}Yp(a,134217728)}},Xc=function(a){if(a.tag===13){var l=Wa(a),u=ea(a,l);if(u!==null){var m=zn();Zs(u,a,l,m)}Yp(a,l)}},Yc=function(){return Ft},Qc=function(a,l){var u=Ft;try{return Ft=a,l()}finally{Ft=u}},Un=function(a,l,u){switch(l){case"input":if(Ue(a,u),l=u.name,u.type==="radio"&&l!=null){for(u=a;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<u.length;l++){var m=u[l];if(m!==a&&m.form===a.form){var v=oh(m);if(!v)throw Error(r(90));Y(m),Ue(m,v)}}}break;case"textarea":Wr(a,u);break;case"select":l=u.value,l!=null&&dr(a,!!u.multiple,l,!1)}},Ta=Wp,Sa=Uo;var x4={usingClientEntryPoint:!1,Events:[fu,jl,oh,Ss,ls,Wp]},ku={findFiberByHostInstance:Do,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},v4={bundleType:ku.bundleType,version:ku.version,rendererPackageName:ku.rendererPackageName,rendererConfig:ku.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:U.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=fe(a),a===null?null:a.stateNode},findFiberByHostInstance:ku.findFiberByHostInstance||m4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$h.isDisabled&&$h.supportsFiber)try{cs=$h.inject(v4),Ar=$h}catch{}}return es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x4,es.createPortal=function(a,l){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jp(l))throw Error(r(200));return p4(a,l,null,u)},es.createRoot=function(a,l){if(!Jp(a))throw Error(r(299));var u=!1,m="",v=E_;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onRecoverableError!==void 0&&(v=l.onRecoverableError)),l=Xp(a,1,!1,null,null,u,!1,m,v),a[Yi]=l.current,lu(a.nodeType===8?a.parentNode:a),new Qp(l)},es.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=fe(l),a=a===null?null:a.stateNode,a},es.flushSync=function(a){return Uo(a)},es.hydrate=function(a,l,u){if(!Wh(l))throw Error(r(200));return Hh(null,a,l,!0,u)},es.hydrateRoot=function(a,l,u){if(!Jp(a))throw Error(r(405));var m=u!=null&&u.hydratedSources||null,v=!1,w="",D=E_;if(u!=null&&(u.unstable_strictMode===!0&&(v=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onRecoverableError!==void 0&&(D=u.onRecoverableError)),l=y_(l,null,a,1,u??null,v,!1,w,D),a[Yi]=l.current,lu(a),m)for(a=0;a<m.length;a++)u=m[a],v=u._getVersion,v=v(u._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[u,v]:l.mutableSourceEagerHydrationData.push(u,v);return new zh(l)},es.render=function(a,l,u){if(!Wh(l))throw Error(r(200));return Hh(null,a,l,!1,u)},es.unmountComponentAtNode=function(a){if(!Wh(a))throw Error(r(40));return a._reactRootContainer?(Uo(function(){Hh(null,null,a,!1,function(){a._reactRootContainer=null,a[Yi]=null})}),!0):!1},es.unstable_batchedUpdates=Wp,es.unstable_renderSubtreeIntoContainer=function(a,l,u,m){if(!Wh(u))throw Error(r(200));if(a==null||a._reactInternals===void 0)throw Error(r(38));return Hh(a,l,u,!1,m)},es.version="18.3.1-next-f1338f8080-20240426",es}var N_;function I4(){if(N_)return rm.exports;N_=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),rm.exports=C4(),rm.exports}var D_;function F4(){if(D_)return qh;D_=1;var t=I4();return qh.createRoot=t.createRoot,qh.hydrateRoot=t.hydrateRoot,qh}var R4=F4();const N4=kw(R4),D4="modulepreload",P4=function(t){return"/"+t},P_={},va=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){let o=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=o(r.map(h=>{if(h=P4(h),h in P_)return;P_[h]=!0;const d=h.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const x=document.createElement("link");if(x.rel=d?"stylesheet":D4,d||(x.as="script"),x.crossOrigin="",x.href=h,f&&x.setAttribute("nonce",f),document.head.appendChild(x),d)return new Promise((_,S)=>{x.addEventListener("load",_),x.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},im={" ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],:["","","","","","","","","","","","","","","","","",""],:["","","","","",""]},Aw=[{id:"qualitative",name:"",desc:""},{id:"emotional",name:"",desc:""},{id:"friendly",name:"",desc:""},{id:"humorous",name:"",desc:""},{id:"internal",name:"",desc:""},{id:"philosophical",name:"",desc:""},{id:"practical",name:"",desc:""},{id:"resonance",name:"",desc:""},{id:"blessing",name:"",desc:""},{id:"scenario",name:"",desc:""},{id:"milestone",name:"",desc:""},{id:"journey",name:"",desc:""}],Cw=()=>localStorage.getItem("gemini_api_key")||"",b_=()=>!!Cw(),O_=async(t,e,r=[],n)=>{var S,y,T,R,O;const s=Cw();if(!s)return"  API Key Gemini API Key";const i=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${s}`;let o="";r.length>0?o=r.map(N=>{const U=Aw.find(X=>X.id===N);return U?`${U.name}${U.desc}`:""}).join(`
`):o="";const f=`${{normal:"",casual:"",formal:""}[n.tone]||""}`,h=` ${n.wordCount||80} `,d=`""

${t}
${e||""}

****
1. ${f}
2. ${h}

 ${r.length||1} 
${o}

****
1. 
2. 
3. ** Markdown ** ******# 
4. ****
5. 
6. 

...
()

...
`;let g=0;const x=5,_=[1e3,2e3,4e3,8e3,16e3];for(;g<=x;)try{const N=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:d}]}]})});if(!N.ok){if(N.status===400||N.status===401||N.status===403)return" API Key ";throw new Error(`API Error: ${N.status}`)}return((O=(R=(T=(y=(S=(await N.json()).candidates)==null?void 0:S[0])==null?void 0:y.content)==null?void 0:T.parts)==null?void 0:R[0])==null?void 0:O.text)||""}catch(N){if(g===x)return console.error("Gemini API Failed:",N),"";await new Promise(U=>setTimeout(U,_[g])),g++}};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b4=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Iw=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var O4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=Oe.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:o,...c},f)=>Oe.createElement("svg",{ref:f,...O4,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:Iw("lucide",s),...c},[...o.map(([h,d])=>Oe.createElement(h,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=(t,e)=>{const r=Oe.forwardRef(({className:n,...s},i)=>Oe.createElement(L4,{ref:i,iconNode:e,className:Iw(`lucide-${b4(t)}`,n),...s}));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M4=Ut("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=Ut("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V4=Ut("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B4=Ut("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=Ut("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j4=Ut("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z4=Ut("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k1=Ut("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bm=Ut("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=Ut("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Om=Ut("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H4=Ut("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=Ut("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fw=Ut("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C1=Ut("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=Ut("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G4=Ut("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q4=Ut("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=Ut("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=Ut("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=Ut("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lm=Ut("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K4=Ut("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X4=Ut("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=Ut("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y4=Ut("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q4=Ut("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I1=Ut("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=Ut("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J4=Ut("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=Ut("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Pw=Oe.createContext(null),B_={success:{bg:"bg-[#1DD1A1]",icon:j4,iconColor:"text-white"},error:{bg:"bg-[#FF6B6B]",icon:z4,iconColor:"text-white"},warning:{bg:"bg-[#FECA57]",icon:U4,iconColor:"text-[#2D3436]"},info:{bg:"bg-[#54A0FF]",icon:Fw,iconColor:"text-white"}},Z4=({id:t,message:e,type:r,onRemove:n})=>{const s=B_[r]||B_.info,i=s.icon;return C.jsxs("div",{className:`${s.bg} text-white px-4 py-3 rounded-lg shadow-lg border-2 border-[#2D3436] 
                       flex items-center gap-3 min-w-[280px] max-w-[400px] animate-in 
                       slide-in-from-right-5 duration-300`,role:"alert",children:[C.jsx(i,{size:20,className:s.iconColor}),C.jsx("span",{className:"flex-1 font-medium text-sm",children:e}),C.jsx("button",{onClick:()=>n(t),className:"p-1 hover:bg-white/20 rounded transition-colors",children:C.jsx(wf,{size:16})})]})},eC=({toasts:t,onRemove:e})=>t.length===0?null:C.jsx("div",{className:"fixed top-4 right-4 z-[100] flex flex-col gap-2",children:t.map(r=>C.jsx(Z4,{...r,onRemove:e},r.id))}),tC=({children:t})=>{const[e,r]=Oe.useState([]),n=Oe.useCallback(o=>{r(c=>c.filter(f=>f.id!==o))},[]),s=Oe.useCallback((o,c="info",f=3e3)=>{const h=Date.now()+Math.random();return r(d=>[...d,{id:h,message:o,type:c}]),f>0&&setTimeout(()=>n(h),f),h},[n]),i={success:(o,c)=>s(o,"success",c),error:(o,c)=>s(o,"error",c??5e3),warning:(o,c)=>s(o,"warning",c),info:(o,c)=>s(o,"info",c)};return C.jsxs(Pw.Provider,{value:{showToast:s,toast:i,removeToast:n},children:[t,C.jsx(eC,{toasts:e,onRemove:n})]})},bw=()=>{const t=Oe.useContext(Pw);if(!t)throw new Error("useToast  ToastProvider ");return t},rC=(t,e)=>{let r="";e==="csv"?(r=`\uFEFF,,
`,t.forEach(o=>{const f=[...o.selectedTags,o.manualTraits].filter(Boolean).join("").replace(/,/g,""),h=o.comment.replace(/,/g,"").replace(/\n/g," ");r+=`${o.name},"${f}","${h}"
`})):t.forEach(o=>{const c=[...o.selectedTags,o.manualTraits].filter(Boolean).join("");r+=`${o.name}
${c||""}

${o.comment}
-------------------
`});const n=new Blob([r],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download=`_${new Date().toLocaleDateString()}.${e}`,i.click(),URL.revokeObjectURL(s)},nC=()=>{const[t,e]=Oe.useState({isOpen:!1,type:"info",title:"",message:"",onConfirm:null}),r=Oe.useCallback(()=>{e(i=>({...i,isOpen:!1}))},[]),n=Oe.useCallback((i,o,c)=>{e({isOpen:!0,type:"confirm",title:i,message:o,onConfirm:c})},[]),s=Oe.useCallback(i=>{e({isOpen:!0,type:"info",title:"",message:i,onConfirm:null})},[]);return{dialog:t,closeDialog:r,showConfirm:n,showAlert:s}},sC=()=>{};var U_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},iC=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],o=t[r++],c=t[r++],f=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Lw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,f=s+2<t.length,h=f?t[s+2]:0,d=i>>2,g=(i&3)<<4|c>>4;let x=(c&15)<<2|h>>6,_=h&63;f||(_=64,o||(x=64)),n.push(r[d],r[g],r[x],r[_])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ow(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):iC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],c=s<t.length?r[t.charAt(s)]:0;++s;const h=s<t.length?r[t.charAt(s)]:64;++s;const g=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||c==null||h==null||g==null)throw new aC;const x=i<<2|c>>4;if(n.push(x),h!==64){const _=c<<4&240|h>>2;if(n.push(_),g!==64){const S=h<<6&192|g;n.push(S)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class aC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const oC=function(t){const e=Ow(t);return Lw.encodeByteArray(e,!0)},T0=function(t){return oC(t).replace(/\./g,"")},Mw=function(t){try{return Lw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC=()=>lC().__FIREBASE_DEFAULTS__,uC=()=>{if(typeof process>"u"||typeof U_>"u")return;const t=U_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},fC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Mw(t[1]);return e&&JSON.parse(e)},td=()=>{try{return sC()||cC()||uC()||fC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Vw=t=>{var e,r;return(r=(e=td())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},hC=t=>{const e=Vw(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Bw=()=>{var t;return(t=td())==null?void 0:t.config},Uw=t=>{var e;return(e=td())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function jw(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[T0(JSON.stringify(r)),T0(JSON.stringify(o)),""].join(".")}const Ou={};function mC(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ou))Ou[e]?t.emulator.push(e):t.prod.push(e);return t}function gC(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let j_=!1;function zw(t,e){if(typeof window>"u"||typeof document>"u"||!Nc(window.location.host)||Ou[t]===e||Ou[t]||j_)return;Ou[t]=e;function r(x){return`__firebase__banner__${x}`}const n="__firebase__banner",i=mC().prod.length>0;function o(){const x=document.getElementById(n);x&&x.remove()}function c(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function f(x,_){x.setAttribute("width","24"),x.setAttribute("id",_),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function h(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{j_=!0,o()},x}function d(x,_){x.setAttribute("id",_),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function g(){const x=gC(n),_=r("text"),S=document.getElementById(_)||document.createElement("span"),y=r("learnmore"),T=document.getElementById(y)||document.createElement("a"),R=r("preprendIcon"),O=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const N=x.element;c(N),d(T,y);const U=h();f(O,R),N.append(O,S,T,U),document.body.appendChild(N)}i?(S.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function On(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(On())}function vC(){var e;const t=(e=td())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _C(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function yC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function wC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function EC(){const t=On();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function TC(){return!vC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SC(){try{return typeof indexedDB=="object"}catch{return!1}}function kC(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC="FirebaseError";class _a extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=AC,Object.setPrototypeOf(this,_a.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ef.prototype.create)}}class Ef{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?CC(i,n):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new _a(s,c,n)}}function CC(t,e){return t.replace(IC,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const IC=/\{\$([^}]+)}/g;function FC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function il(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],o=e[s];if(z_(i)&&z_(o)){if(!il(i,o))return!1}else if(i!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function z_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function RC(t,e){const r=new NC(t,e);return r.subscribe.bind(r)}class NC{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");DC(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=am),s.error===void 0&&(s.error=am),s.complete===void 0&&(s.complete=am);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function DC(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function am(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(t){return t&&t._delegate?t._delegate:t}class al{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new dC;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(OC(e))try{this.getOrInitializeService({instanceIdentifier:Ho})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Ho){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ho){return this.instances.has(e)}getOptions(e=Ho){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);n===c&&o.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:bC(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ho){return this.component?this.component.multipleInstances?e:Ho:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bC(t){return t===Ho?void 0:t}function OC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new PC(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(kt||(kt={}));const MC={debug:kt.DEBUG,verbose:kt.VERBOSE,info:kt.INFO,warn:kt.WARN,error:kt.ERROR,silent:kt.SILENT},VC=kt.INFO,BC={[kt.DEBUG]:"log",[kt.VERBOSE]:"log",[kt.INFO]:"info",[kt.WARN]:"warn",[kt.ERROR]:"error"},UC=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=BC[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class F1{constructor(e){this.name=e,this._logLevel=VC,this._logHandler=UC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in kt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?MC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,kt.DEBUG,...e),this._logHandler(this,kt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,kt.VERBOSE,...e),this._logHandler(this,kt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,kt.INFO,...e),this._logHandler(this,kt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,kt.WARN,...e),this._logHandler(this,kt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,kt.ERROR,...e),this._logHandler(this,kt.ERROR,...e)}}const jC=(t,e)=>e.some(r=>t instanceof r);let W_,H_;function zC(){return W_||(W_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function WC(){return H_||(H_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ww=new WeakMap,Mm=new WeakMap,Hw=new WeakMap,om=new WeakMap,R1=new WeakMap;function HC(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(ro(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&Ww.set(r,t)}).catch(()=>{}),R1.set(e,t),e}function $C(t){if(Mm.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Mm.set(t,e)}let Vm={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Mm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Hw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ro(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function GC(t){Vm=t(Vm)}function qC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(lm(this),e,...r);return Hw.set(n,e.sort?e.sort():[e]),ro(n)}:WC().includes(t)?function(...e){return t.apply(lm(this),e),ro(Ww.get(this))}:function(...e){return ro(t.apply(lm(this),e))}}function KC(t){return typeof t=="function"?qC(t):(t instanceof IDBTransaction&&$C(t),jC(t,zC())?new Proxy(t,Vm):t)}function ro(t){if(t instanceof IDBRequest)return HC(t);if(om.has(t))return om.get(t);const e=KC(t);return e!==t&&(om.set(t,e),R1.set(e,t)),e}const lm=t=>R1.get(t);function XC(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=ro(o);return n&&o.addEventListener("upgradeneeded",f=>{n(ro(o.result),f.oldVersion,f.newVersion,ro(o.transaction),f)}),r&&o.addEventListener("blocked",f=>r(f.oldVersion,f.newVersion,f)),c.then(f=>{i&&f.addEventListener("close",()=>i()),s&&f.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const YC=["get","getKey","getAll","getAllKeys","count"],QC=["put","add","delete","clear"],cm=new Map;function $_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(cm.get(e))return cm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=QC.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||YC.includes(r)))return;const i=async function(o,...c){const f=this.transaction(o,s?"readwrite":"readonly");let h=f.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),s&&f.done]))[0]};return cm.set(e,i),i}GC(t=>({...t,get:(e,r,n)=>$_(e,r)||t.get(e,r,n),has:(e,r)=>!!$_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(ZC(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function ZC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Bm="@firebase/app",G_="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const da=new F1("@firebase/app"),eI="@firebase/app-compat",tI="@firebase/analytics-compat",rI="@firebase/analytics",nI="@firebase/app-check-compat",sI="@firebase/app-check",iI="@firebase/auth",aI="@firebase/auth-compat",oI="@firebase/database",lI="@firebase/data-connect",cI="@firebase/database-compat",uI="@firebase/functions",fI="@firebase/functions-compat",hI="@firebase/installations",dI="@firebase/installations-compat",pI="@firebase/messaging",mI="@firebase/messaging-compat",gI="@firebase/performance",xI="@firebase/performance-compat",vI="@firebase/remote-config",_I="@firebase/remote-config-compat",yI="@firebase/storage",wI="@firebase/storage-compat",EI="@firebase/firestore",TI="@firebase/ai",SI="@firebase/firestore-compat",kI="firebase",AI="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um="[DEFAULT]",CI={[Bm]:"fire-core",[eI]:"fire-core-compat",[rI]:"fire-analytics",[tI]:"fire-analytics-compat",[sI]:"fire-app-check",[nI]:"fire-app-check-compat",[iI]:"fire-auth",[aI]:"fire-auth-compat",[oI]:"fire-rtdb",[lI]:"fire-data-connect",[cI]:"fire-rtdb-compat",[uI]:"fire-fn",[fI]:"fire-fn-compat",[hI]:"fire-iid",[dI]:"fire-iid-compat",[pI]:"fire-fcm",[mI]:"fire-fcm-compat",[gI]:"fire-perf",[xI]:"fire-perf-compat",[vI]:"fire-rc",[_I]:"fire-rc-compat",[yI]:"fire-gcs",[wI]:"fire-gcs-compat",[EI]:"fire-fst",[SI]:"fire-fst-compat",[TI]:"fire-vertex","fire-js":"fire-js",[kI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0=new Map,II=new Map,jm=new Map;function q_(t,e){try{t.container.addComponent(e)}catch(r){da.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function yc(t){const e=t.name;if(jm.has(e))return da.debug(`There were multiple attempts to register component ${e}.`),!1;jm.set(e,t);for(const r of S0.values())q_(r,t);for(const r of II.values())q_(r,t);return!0}function N1(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ri(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},no=new Ef("app","Firebase",FI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new al("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw no.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dc=AI;function $w(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Um,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw no.create("bad-app-name",{appName:String(s)});if(r||(r=Bw()),!r)throw no.create("no-options");const i=S0.get(s);if(i){if(il(r,i.options)&&il(n,i.config))return i;throw no.create("duplicate-app",{appName:s})}const o=new LC(s);for(const f of jm.values())o.addComponent(f);const c=new RI(r,n,o);return S0.set(s,c),c}function Gw(t=Um){const e=S0.get(t);if(!e&&t===Um&&Bw())return $w();if(!e)throw no.create("no-app",{appName:t});return e}function so(t,e,r){let n=CI[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${n}" with version "${e}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),da.warn(o.join(" "));return}yc(new al(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI="firebase-heartbeat-database",DI=1,Yu="firebase-heartbeat-store";let um=null;function qw(){return um||(um=XC(NI,DI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yu)}catch(r){console.warn(r)}}}}).catch(t=>{throw no.create("idb-open",{originalErrorMessage:t.message})})),um}async function PI(t){try{const r=(await qw()).transaction(Yu),n=await r.objectStore(Yu).get(Kw(t));return await r.done,n}catch(e){if(e instanceof _a)da.warn(e.message);else{const r=no.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});da.warn(r.message)}}}async function K_(t,e){try{const n=(await qw()).transaction(Yu,"readwrite");await n.objectStore(Yu).put(e,Kw(t)),await n.done}catch(r){if(r instanceof _a)da.warn(r.message);else{const n=no.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});da.warn(n.message)}}}function Kw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI=1024,OI=30;class LI{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new VI(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=X_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>OI){const o=BI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){da.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=X_(),{heartbeatsToSend:n,unsentEntries:s}=MI(this._heartbeatsCache.heartbeats),i=T0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return da.warn(r),""}}}function X_(){return new Date().toISOString().substring(0,10)}function MI(t,e=bI){const r=[];let n=t.slice();for(const s of t){const i=r.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Y_(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),Y_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class VI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return SC()?kC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await PI(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return K_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return K_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Y_(t){return T0(JSON.stringify({version:2,heartbeats:t})).length}function BI(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UI(t){yc(new al("platform-logger",e=>new JC(e),"PRIVATE")),yc(new al("heartbeat",e=>new LI(e),"PRIVATE")),so(Bm,G_,t),so(Bm,G_,"esm2020"),so("fire-js","")}UI("");var jI="firebase",zI="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */so(jI,zI,"app");var Q_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var io,Xw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,F){function I(){}I.prototype=F.prototype,k.F=F.prototype,k.prototype=new I,k.prototype.constructor=k,k.D=function(B,L,M){for(var V=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)V[Fe-2]=arguments[Fe];return F.prototype[L].apply(B,V)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(k,F,I){I||(I=0);const B=Array(16);if(typeof F=="string")for(var L=0;L<16;++L)B[L]=F.charCodeAt(I++)|F.charCodeAt(I++)<<8|F.charCodeAt(I++)<<16|F.charCodeAt(I++)<<24;else for(L=0;L<16;++L)B[L]=F[I++]|F[I++]<<8|F[I++]<<16|F[I++]<<24;F=k.g[0],I=k.g[1],L=k.g[2];let M=k.g[3],V;V=F+(M^I&(L^M))+B[0]+3614090360&4294967295,F=I+(V<<7&4294967295|V>>>25),V=M+(L^F&(I^L))+B[1]+3905402710&4294967295,M=F+(V<<12&4294967295|V>>>20),V=L+(I^M&(F^I))+B[2]+606105819&4294967295,L=M+(V<<17&4294967295|V>>>15),V=I+(F^L&(M^F))+B[3]+3250441966&4294967295,I=L+(V<<22&4294967295|V>>>10),V=F+(M^I&(L^M))+B[4]+4118548399&4294967295,F=I+(V<<7&4294967295|V>>>25),V=M+(L^F&(I^L))+B[5]+1200080426&4294967295,M=F+(V<<12&4294967295|V>>>20),V=L+(I^M&(F^I))+B[6]+2821735955&4294967295,L=M+(V<<17&4294967295|V>>>15),V=I+(F^L&(M^F))+B[7]+4249261313&4294967295,I=L+(V<<22&4294967295|V>>>10),V=F+(M^I&(L^M))+B[8]+1770035416&4294967295,F=I+(V<<7&4294967295|V>>>25),V=M+(L^F&(I^L))+B[9]+2336552879&4294967295,M=F+(V<<12&4294967295|V>>>20),V=L+(I^M&(F^I))+B[10]+4294925233&4294967295,L=M+(V<<17&4294967295|V>>>15),V=I+(F^L&(M^F))+B[11]+2304563134&4294967295,I=L+(V<<22&4294967295|V>>>10),V=F+(M^I&(L^M))+B[12]+1804603682&4294967295,F=I+(V<<7&4294967295|V>>>25),V=M+(L^F&(I^L))+B[13]+4254626195&4294967295,M=F+(V<<12&4294967295|V>>>20),V=L+(I^M&(F^I))+B[14]+2792965006&4294967295,L=M+(V<<17&4294967295|V>>>15),V=I+(F^L&(M^F))+B[15]+1236535329&4294967295,I=L+(V<<22&4294967295|V>>>10),V=F+(L^M&(I^L))+B[1]+4129170786&4294967295,F=I+(V<<5&4294967295|V>>>27),V=M+(I^L&(F^I))+B[6]+3225465664&4294967295,M=F+(V<<9&4294967295|V>>>23),V=L+(F^I&(M^F))+B[11]+643717713&4294967295,L=M+(V<<14&4294967295|V>>>18),V=I+(M^F&(L^M))+B[0]+3921069994&4294967295,I=L+(V<<20&4294967295|V>>>12),V=F+(L^M&(I^L))+B[5]+3593408605&4294967295,F=I+(V<<5&4294967295|V>>>27),V=M+(I^L&(F^I))+B[10]+38016083&4294967295,M=F+(V<<9&4294967295|V>>>23),V=L+(F^I&(M^F))+B[15]+3634488961&4294967295,L=M+(V<<14&4294967295|V>>>18),V=I+(M^F&(L^M))+B[4]+3889429448&4294967295,I=L+(V<<20&4294967295|V>>>12),V=F+(L^M&(I^L))+B[9]+568446438&4294967295,F=I+(V<<5&4294967295|V>>>27),V=M+(I^L&(F^I))+B[14]+3275163606&4294967295,M=F+(V<<9&4294967295|V>>>23),V=L+(F^I&(M^F))+B[3]+4107603335&4294967295,L=M+(V<<14&4294967295|V>>>18),V=I+(M^F&(L^M))+B[8]+1163531501&4294967295,I=L+(V<<20&4294967295|V>>>12),V=F+(L^M&(I^L))+B[13]+2850285829&4294967295,F=I+(V<<5&4294967295|V>>>27),V=M+(I^L&(F^I))+B[2]+4243563512&4294967295,M=F+(V<<9&4294967295|V>>>23),V=L+(F^I&(M^F))+B[7]+1735328473&4294967295,L=M+(V<<14&4294967295|V>>>18),V=I+(M^F&(L^M))+B[12]+2368359562&4294967295,I=L+(V<<20&4294967295|V>>>12),V=F+(I^L^M)+B[5]+4294588738&4294967295,F=I+(V<<4&4294967295|V>>>28),V=M+(F^I^L)+B[8]+2272392833&4294967295,M=F+(V<<11&4294967295|V>>>21),V=L+(M^F^I)+B[11]+1839030562&4294967295,L=M+(V<<16&4294967295|V>>>16),V=I+(L^M^F)+B[14]+4259657740&4294967295,I=L+(V<<23&4294967295|V>>>9),V=F+(I^L^M)+B[1]+2763975236&4294967295,F=I+(V<<4&4294967295|V>>>28),V=M+(F^I^L)+B[4]+1272893353&4294967295,M=F+(V<<11&4294967295|V>>>21),V=L+(M^F^I)+B[7]+4139469664&4294967295,L=M+(V<<16&4294967295|V>>>16),V=I+(L^M^F)+B[10]+3200236656&4294967295,I=L+(V<<23&4294967295|V>>>9),V=F+(I^L^M)+B[13]+681279174&4294967295,F=I+(V<<4&4294967295|V>>>28),V=M+(F^I^L)+B[0]+3936430074&4294967295,M=F+(V<<11&4294967295|V>>>21),V=L+(M^F^I)+B[3]+3572445317&4294967295,L=M+(V<<16&4294967295|V>>>16),V=I+(L^M^F)+B[6]+76029189&4294967295,I=L+(V<<23&4294967295|V>>>9),V=F+(I^L^M)+B[9]+3654602809&4294967295,F=I+(V<<4&4294967295|V>>>28),V=M+(F^I^L)+B[12]+3873151461&4294967295,M=F+(V<<11&4294967295|V>>>21),V=L+(M^F^I)+B[15]+530742520&4294967295,L=M+(V<<16&4294967295|V>>>16),V=I+(L^M^F)+B[2]+3299628645&4294967295,I=L+(V<<23&4294967295|V>>>9),V=F+(L^(I|~M))+B[0]+4096336452&4294967295,F=I+(V<<6&4294967295|V>>>26),V=M+(I^(F|~L))+B[7]+1126891415&4294967295,M=F+(V<<10&4294967295|V>>>22),V=L+(F^(M|~I))+B[14]+2878612391&4294967295,L=M+(V<<15&4294967295|V>>>17),V=I+(M^(L|~F))+B[5]+4237533241&4294967295,I=L+(V<<21&4294967295|V>>>11),V=F+(L^(I|~M))+B[12]+1700485571&4294967295,F=I+(V<<6&4294967295|V>>>26),V=M+(I^(F|~L))+B[3]+2399980690&4294967295,M=F+(V<<10&4294967295|V>>>22),V=L+(F^(M|~I))+B[10]+4293915773&4294967295,L=M+(V<<15&4294967295|V>>>17),V=I+(M^(L|~F))+B[1]+2240044497&4294967295,I=L+(V<<21&4294967295|V>>>11),V=F+(L^(I|~M))+B[8]+1873313359&4294967295,F=I+(V<<6&4294967295|V>>>26),V=M+(I^(F|~L))+B[15]+4264355552&4294967295,M=F+(V<<10&4294967295|V>>>22),V=L+(F^(M|~I))+B[6]+2734768916&4294967295,L=M+(V<<15&4294967295|V>>>17),V=I+(M^(L|~F))+B[13]+1309151649&4294967295,I=L+(V<<21&4294967295|V>>>11),V=F+(L^(I|~M))+B[4]+4149444226&4294967295,F=I+(V<<6&4294967295|V>>>26),V=M+(I^(F|~L))+B[11]+3174756917&4294967295,M=F+(V<<10&4294967295|V>>>22),V=L+(F^(M|~I))+B[2]+718787259&4294967295,L=M+(V<<15&4294967295|V>>>17),V=I+(M^(L|~F))+B[9]+3951481745&4294967295,k.g[0]=k.g[0]+F&4294967295,k.g[1]=k.g[1]+(L+(V<<21&4294967295|V>>>11))&4294967295,k.g[2]=k.g[2]+L&4294967295,k.g[3]=k.g[3]+M&4294967295}n.prototype.v=function(k,F){F===void 0&&(F=k.length);const I=F-this.blockSize,B=this.C;let L=this.h,M=0;for(;M<F;){if(L==0)for(;M<=I;)s(this,k,M),M+=this.blockSize;if(typeof k=="string"){for(;M<F;)if(B[L++]=k.charCodeAt(M++),L==this.blockSize){s(this,B),L=0;break}}else for(;M<F;)if(B[L++]=k[M++],L==this.blockSize){s(this,B),L=0;break}}this.h=L,this.o+=F},n.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var F=1;F<k.length-8;++F)k[F]=0;F=this.o*8;for(var I=k.length-8;I<k.length;++I)k[I]=F&255,F/=256;for(this.v(k),k=Array(16),F=0,I=0;I<4;++I)for(let B=0;B<32;B+=8)k[F++]=this.g[I]>>>B&255;return k};function i(k,F){var I=c;return Object.prototype.hasOwnProperty.call(I,k)?I[k]:I[k]=F(k)}function o(k,F){this.h=F;const I=[];let B=!0;for(let L=k.length-1;L>=0;L--){const M=k[L]|0;B&&M==F||(I[L]=M,B=!1)}this.g=I}var c={};function f(k){return-128<=k&&k<128?i(k,function(F){return new o([F|0],F<0?-1:0)}):new o([k|0],k<0?-1:0)}function h(k){if(isNaN(k)||!isFinite(k))return g;if(k<0)return T(h(-k));const F=[];let I=1;for(let B=0;k>=I;B++)F[B]=k/I|0,I*=4294967296;return new o(F,0)}function d(k,F){if(k.length==0)throw Error("number format error: empty string");if(F=F||10,F<2||36<F)throw Error("radix out of range: "+F);if(k.charAt(0)=="-")return T(d(k.substring(1),F));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=h(Math.pow(F,8));let B=g;for(let M=0;M<k.length;M+=8){var L=Math.min(8,k.length-M);const V=parseInt(k.substring(M,M+L),F);L<8?(L=h(Math.pow(F,L)),B=B.j(L).add(h(V))):(B=B.j(I),B=B.add(h(V)))}return B}var g=f(0),x=f(1),_=f(16777216);t=o.prototype,t.m=function(){if(y(this))return-T(this).m();let k=0,F=1;for(let I=0;I<this.g.length;I++){const B=this.i(I);k+=(B>=0?B:4294967296+B)*F,F*=4294967296}return k},t.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(S(this))return"0";if(y(this))return"-"+T(this).toString(k);const F=h(Math.pow(k,6));var I=this;let B="";for(;;){const L=U(I,F).g;I=R(I,L.j(F));let M=((I.g.length>0?I.g[0]:I.h)>>>0).toString(k);if(I=L,S(I))return M+B;for(;M.length<6;)M="0"+M;B=M+B}},t.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function S(k){if(k.h!=0)return!1;for(let F=0;F<k.g.length;F++)if(k.g[F]!=0)return!1;return!0}function y(k){return k.h==-1}t.l=function(k){return k=R(this,k),y(k)?-1:S(k)?0:1};function T(k){const F=k.g.length,I=[];for(let B=0;B<F;B++)I[B]=~k.g[B];return new o(I,~k.h).add(x)}t.abs=function(){return y(this)?T(this):this},t.add=function(k){const F=Math.max(this.g.length,k.g.length),I=[];let B=0;for(let L=0;L<=F;L++){let M=B+(this.i(L)&65535)+(k.i(L)&65535),V=(M>>>16)+(this.i(L)>>>16)+(k.i(L)>>>16);B=V>>>16,M&=65535,V&=65535,I[L]=V<<16|M}return new o(I,I[I.length-1]&-2147483648?-1:0)};function R(k,F){return k.add(T(F))}t.j=function(k){if(S(this)||S(k))return g;if(y(this))return y(k)?T(this).j(T(k)):T(T(this).j(k));if(y(k))return T(this.j(T(k)));if(this.l(_)<0&&k.l(_)<0)return h(this.m()*k.m());const F=this.g.length+k.g.length,I=[];for(var B=0;B<2*F;B++)I[B]=0;for(B=0;B<this.g.length;B++)for(let L=0;L<k.g.length;L++){const M=this.i(B)>>>16,V=this.i(B)&65535,Fe=k.i(L)>>>16,Ce=k.i(L)&65535;I[2*B+2*L]+=V*Ce,O(I,2*B+2*L),I[2*B+2*L+1]+=M*Ce,O(I,2*B+2*L+1),I[2*B+2*L+1]+=V*Fe,O(I,2*B+2*L+1),I[2*B+2*L+2]+=M*Fe,O(I,2*B+2*L+2)}for(k=0;k<F;k++)I[k]=I[2*k+1]<<16|I[2*k];for(k=F;k<2*F;k++)I[k]=0;return new o(I,0)};function O(k,F){for(;(k[F]&65535)!=k[F];)k[F+1]+=k[F]>>>16,k[F]&=65535,F++}function N(k,F){this.g=k,this.h=F}function U(k,F){if(S(F))throw Error("division by zero");if(S(k))return new N(g,g);if(y(k))return F=U(T(k),F),new N(T(F.g),T(F.h));if(y(F))return F=U(k,T(F)),new N(T(F.g),F.h);if(k.g.length>30){if(y(k)||y(F))throw Error("slowDivide_ only works with positive integers.");for(var I=x,B=F;B.l(k)<=0;)I=X(I),B=X(B);var L=G(I,1),M=G(B,1);for(B=G(B,2),I=G(I,2);!S(B);){var V=M.add(B);V.l(k)<=0&&(L=L.add(I),M=V),B=G(B,1),I=G(I,1)}return F=R(k,L.j(F)),new N(L,F)}for(L=g;k.l(F)>=0;){for(I=Math.max(1,Math.floor(k.m()/F.m())),B=Math.ceil(Math.log(I)/Math.LN2),B=B<=48?1:Math.pow(2,B-48),M=h(I),V=M.j(F);y(V)||V.l(k)>0;)I-=B,M=h(I),V=M.j(F);S(M)&&(M=x),L=L.add(M),k=R(k,V)}return new N(L,k)}t.B=function(k){return U(this,k).h},t.and=function(k){const F=Math.max(this.g.length,k.g.length),I=[];for(let B=0;B<F;B++)I[B]=this.i(B)&k.i(B);return new o(I,this.h&k.h)},t.or=function(k){const F=Math.max(this.g.length,k.g.length),I=[];for(let B=0;B<F;B++)I[B]=this.i(B)|k.i(B);return new o(I,this.h|k.h)},t.xor=function(k){const F=Math.max(this.g.length,k.g.length),I=[];for(let B=0;B<F;B++)I[B]=this.i(B)^k.i(B);return new o(I,this.h^k.h)};function X(k){const F=k.g.length+1,I=[];for(let B=0;B<F;B++)I[B]=k.i(B)<<1|k.i(B-1)>>>31;return new o(I,k.h)}function G(k,F){const I=F>>5;F%=32;const B=k.g.length-I,L=[];for(let M=0;M<B;M++)L[M]=F>0?k.i(M+I)>>>F|k.i(M+I+1)<<32-F:k.i(M+I);return new o(L,k.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,Xw=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,io=o}).apply(typeof Q_<"u"?Q_:typeof self<"u"?self:typeof window<"u"?window:{});var Kh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Yw,Iu,Qw,h0,zm,Jw,Zw,eE;(function(){var t,e=Object.defineProperty;function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Kh=="object"&&Kh];for(var E=0;E<p.length;++E){var A=p[E];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function s(p,E){if(E)e:{var A=n;p=p.split(".");for(var z=0;z<p.length-1;z++){var ae=p[z];if(!(ae in A))break e;A=A[ae]}p=p[p.length-1],z=A[p],E=E(z),E!=z&&E!=null&&e(A,p,{configurable:!0,writable:!0,value:E})}}s("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(p){return p||function(E){var A=[],z;for(z in E)Object.prototype.hasOwnProperty.call(E,z)&&A.push([z,E[z]]);return A}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function c(p){var E=typeof p;return E=="object"&&p!=null||E=="function"}function f(p,E,A){return p.call.apply(p.bind,arguments)}function h(p,E,A){return h=f,h.apply(null,arguments)}function d(p,E){var A=Array.prototype.slice.call(arguments,1);return function(){var z=A.slice();return z.push.apply(z,arguments),p.apply(this,z)}}function g(p,E){function A(){}A.prototype=E.prototype,p.Z=E.prototype,p.prototype=new A,p.prototype.constructor=p,p.Ob=function(z,ae,pe){for(var ze=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)ze[pt-2]=arguments[pt];return E.prototype[ae].apply(z,ze)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function _(p){const E=p.length;if(E>0){const A=Array(E);for(let z=0;z<E;z++)A[z]=p[z];return A}return[]}function S(p,E){for(let z=1;z<arguments.length;z++){const ae=arguments[z];var A=typeof ae;if(A=A!="object"?A:ae?Array.isArray(ae)?"array":A:"null",A=="array"||A=="object"&&typeof ae.length=="number"){A=p.length||0;const pe=ae.length||0;p.length=A+pe;for(let ze=0;ze<pe;ze++)p[A+ze]=ae[ze]}else p.push(ae)}}class y{constructor(E,A){this.i=E,this.j=A,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function T(p){o.setTimeout(()=>{throw p},0)}function R(){var p=k;let E=null;return p.g&&(E=p.g,p.g=p.g.next,p.g||(p.h=null),E.next=null),E}class O{constructor(){this.h=this.g=null}add(E,A){const z=N.get();z.set(E,A),this.h?this.h.next=z:this.g=z,this.h=z}}var N=new y(()=>new U,p=>p.reset());class U{constructor(){this.next=this.g=this.h=null}set(E,A){this.h=E,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let X,G=!1,k=new O,F=()=>{const p=Promise.resolve(void 0);X=()=>{p.then(I)}};function I(){for(var p;p=R();){try{p.h.call(p.g)}catch(A){T(A)}var E=N;E.j(p),E.h<100&&(E.h++,p.next=E.g,E.g=p)}G=!1}function B(){this.u=this.u,this.C=this.C}B.prototype.u=!1,B.prototype.dispose=function(){this.u||(this.u=!0,this.N())},B.prototype[Symbol.dispose]=function(){this.dispose()},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(p,E){this.type=p,this.g=this.target=E,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,E=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const A=()=>{};o.addEventListener("test",A,E),o.removeEventListener("test",A,E)}catch{}return p})();function V(p){return/^[\s\xa0]*$/.test(p)}function Fe(p,E){L.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,E)}g(Fe,L),Fe.prototype.init=function(p,E){const A=this.type=p.type,z=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=E,E=p.relatedTarget,E||(A=="mouseover"?E=p.fromElement:A=="mouseout"&&(E=p.toElement)),this.relatedTarget=E,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&Fe.Z.h.call(this)},Fe.prototype.h=function(){Fe.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Ce="closure_listenable_"+(Math.random()*1e6|0),Le=0;function Ne(p,E,A,z,ae){this.listener=p,this.proxy=null,this.src=E,this.type=A,this.capture=!!z,this.ha=ae,this.key=++Le,this.da=this.fa=!1}function Se(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ne(p,E,A){for(const z in p)E.call(A,p[z],z,p)}function ye(p,E){for(const A in p)E.call(void 0,p[A],A,p)}function ee(p){const E={};for(const A in p)E[A]=p[A];return E}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function te(p,E){let A,z;for(let ae=1;ae<arguments.length;ae++){z=arguments[ae];for(A in z)p[A]=z[A];for(let pe=0;pe<b.length;pe++)A=b[pe],Object.prototype.hasOwnProperty.call(z,A)&&(p[A]=z[A])}}function J(p){this.src=p,this.g={},this.h=0}J.prototype.add=function(p,E,A,z,ae){const pe=p.toString();p=this.g[pe],p||(p=this.g[pe]=[],this.h++);const ze=oe(p,E,z,ae);return ze>-1?(E=p[ze],A||(E.fa=!1)):(E=new Ne(E,this.src,pe,!!z,ae),E.fa=A,p.push(E)),E};function Z(p,E){const A=E.type;if(A in p.g){var z=p.g[A],ae=Array.prototype.indexOf.call(z,E,void 0),pe;(pe=ae>=0)&&Array.prototype.splice.call(z,ae,1),pe&&(Se(E),p.g[A].length==0&&(delete p.g[A],p.h--))}}function oe(p,E,A,z){for(let ae=0;ae<p.length;++ae){const pe=p[ae];if(!pe.da&&pe.listener==E&&pe.capture==!!A&&pe.ha==z)return ae}return-1}var _e="closure_lm_"+(Math.random()*1e6|0),ve={};function xe(p,E,A,z,ae){if(Array.isArray(E)){for(let pe=0;pe<E.length;pe++)xe(p,E[pe],A,z,ae);return null}return A=Ht(A),p&&p[Ce]?p.J(E,A,c(z)?!!z.capture:!1,ae):Ee(p,E,A,!1,z,ae)}function Ee(p,E,A,z,ae,pe){if(!E)throw Error("Invalid event type");const ze=c(ae)?!!ae.capture:!!ae;let pt=ht(p);if(pt||(p[_e]=pt=new J(p)),A=pt.add(E,A,z,ze,pe),A.proxy)return A;if(z=st(),A.proxy=z,z.src=p,z.listener=A,p.addEventListener)M||(ae=ze),ae===void 0&&(ae=!1),p.addEventListener(E.toString(),z,ae);else if(p.attachEvent)p.attachEvent(gt(E.toString()),z);else if(p.addListener&&p.removeListener)p.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return A}function st(){function p(A){return E.call(p.src,p.listener,A)}const E=It;return p}function Y(p,E,A,z,ae){if(Array.isArray(E))for(var pe=0;pe<E.length;pe++)Y(p,E[pe],A,z,ae);else z=c(z)?!!z.capture:!!z,A=Ht(A),p&&p[Ce]?(p=p.i,pe=String(E).toString(),pe in p.g&&(E=p.g[pe],A=oe(E,A,z,ae),A>-1&&(Se(E[A]),Array.prototype.splice.call(E,A,1),E.length==0&&(delete p.g[pe],p.h--)))):p&&(p=ht(p))&&(E=p.g[E.toString()],p=-1,E&&(p=oe(E,A,z,ae)),(A=p>-1?E[p]:null)&&Et(A))}function Et(p){if(typeof p!="number"&&p&&!p.da){var E=p.src;if(E&&E[Ce])Z(E.i,p);else{var A=p.type,z=p.proxy;E.removeEventListener?E.removeEventListener(A,z,p.capture):E.detachEvent?E.detachEvent(gt(A),z):E.addListener&&E.removeListener&&E.removeListener(z),(A=ht(E))?(Z(A,p),A.h==0&&(A.src=null,E[_e]=null)):Se(p)}}}function gt(p){return p in ve?ve[p]:ve[p]="on"+p}function It(p,E){if(p.da)p=!0;else{E=new Fe(E,this);const A=p.listener,z=p.ha||p.src;p.fa&&Et(p),p=A.call(z,E)}return p}function ht(p){return p=p[_e],p instanceof J?p:null}var Ue="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ht(p){return typeof p=="function"?p:(p[Ue]||(p[Ue]=function(E){return p.handleEvent(E)}),p[Ue])}function St(){B.call(this),this.i=new J(this),this.M=this,this.G=null}g(St,B),St.prototype[Ce]=!0,St.prototype.removeEventListener=function(p,E,A,z){Y(this,p,E,A,z)};function Tt(p,E){var A,z=p.G;if(z)for(A=[];z;z=z.G)A.push(z);if(p=p.M,z=E.type||E,typeof E=="string")E=new L(E,p);else if(E instanceof L)E.target=E.target||p;else{var ae=E;E=new L(z,p),te(E,ae)}ae=!0;let pe,ze;if(A)for(ze=A.length-1;ze>=0;ze--)pe=E.g=A[ze],ae=dr(pe,z,!0,E)&&ae;if(pe=E.g=p,ae=dr(pe,z,!0,E)&&ae,ae=dr(pe,z,!1,E)&&ae,A)for(ze=0;ze<A.length;ze++)pe=E.g=A[ze],ae=dr(pe,z,!1,E)&&ae}St.prototype.N=function(){if(St.Z.N.call(this),this.i){var p=this.i;for(const E in p.g){const A=p.g[E];for(let z=0;z<A.length;z++)Se(A[z]);delete p.g[E],p.h--}}this.G=null},St.prototype.J=function(p,E,A,z){return this.i.add(String(p),E,!1,A,z)},St.prototype.K=function(p,E,A,z){return this.i.add(String(p),E,!0,A,z)};function dr(p,E,A,z){if(E=p.i.g[String(E)],!E)return!0;E=E.concat();let ae=!0;for(let pe=0;pe<E.length;++pe){const ze=E[pe];if(ze&&!ze.da&&ze.capture==A){const pt=ze.listener,Cr=ze.ha||ze.src;ze.fa&&Z(p.i,ze),ae=pt.call(Cr,z)!==!1&&ae}}return ae&&!z.defaultPrevented}function gn(p,E){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:o.setTimeout(p,E||0)}function sn(p){p.g=gn(()=>{p.g=null,p.i&&(p.i=!1,sn(p))},p.l);const E=p.h;p.h=null,p.m.apply(null,E)}class Wr extends B{constructor(E,A){super(),this.m=E,this.l=A,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:sn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pr(p){B.call(this),this.h=p,this.g={}}g(Pr,B);var xn=[];function Vn(p){ne(p.g,function(E,A){this.g.hasOwnProperty(A)&&Et(E)},p),p.g={}}Pr.prototype.N=function(){Pr.Z.N.call(this),Vn(this)},Pr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var $t=o.JSON.stringify,Yr=o.JSON.parse,ot=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function Nt(){}function Hr(){}var Mt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function vn(){L.call(this,"d")}g(vn,L);function Ws(){L.call(this,"c")}g(Ws,L);var Bn={},fi=null;function as(){return fi=fi||new St}Bn.Ia="serverreachability";function Hs(p){L.call(this,Bn.Ia,p)}g(Hs,L);function Un(p){const E=as();Tt(E,new Hs(E))}Bn.STAT_EVENT="statevent";function os(p,E){L.call(this,Bn.STAT_EVENT,p),this.stat=E}g(os,L);function er(p){const E=as();Tt(E,new os(E,p))}Bn.Ja="timingevent";function Ts(p,E){L.call(this,Bn.Ja,p),this.size=E}g(Ts,L);function Ss(p,E){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},E)}function ls(){this.g=!0}ls.prototype.ua=function(){this.g=!1};function Ta(p,E,A,z,ae,pe){p.info(function(){if(p.g)if(pe){var ze="",pt=pe.split("&");for(let qt=0;qt<pt.length;qt++){var Cr=pt[qt].split("=");if(Cr.length>1){const br=Cr[0];Cr=Cr[1];const ds=br.split("_");ze=ds.length>=2&&ds[1]=="type"?ze+(br+"="+Cr+"&"):ze+(br+"=redacted&")}}}else ze=null;else ze=pe;return"XMLHTTP REQ ("+z+") [attempt "+ae+"]: "+E+`
`+A+`
`+ze})}function Sa(p,E,A,z,ae,pe,ze){p.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+ae+"]: "+E+`
`+A+`
`+pe+" "+ze})}function Kn(p,E,A,z){p.info(function(){return"XMLHTTP TEXT ("+E+"): "+$s(p,A)+(z?" "+z:"")})}function ka(p,E){p.info(function(){return"TIMEOUT: "+E})}ls.prototype.info=function(){};function $s(p,E){if(!p.g)return E;if(!E)return null;try{const pe=JSON.parse(E);if(pe){for(p=0;p<pe.length;p++)if(Array.isArray(pe[p])){var A=pe[p];if(!(A.length<2)){var z=A[1];if(Array.isArray(z)&&!(z.length<1)){var ae=z[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(let ze=1;ze<z.length;ze++)z[ze]=""}}}}return $t(pe)}catch{return E}}var Qe={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Je={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},jt;function Jt(){}g(Jt,Nt),Jt.prototype.g=function(){return new XMLHttpRequest},jt=new Jt;function nr(p){return encodeURIComponent(String(p))}function P(p){var E=1;p=p.split(":");const A=[];for(;E>0&&p.length;)A.push(p.shift()),E--;return p.length&&A.push(p.join(":")),A}function H(p,E,A,z){this.j=p,this.i=E,this.l=A,this.S=z||1,this.V=new Pr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new j}function j(){this.i=null,this.g="",this.h=!1}var W={},q={};function K(p,E,A){p.M=1,p.A=Hi(As(E)),p.u=A,p.R=!0,ce(p,null)}function ce(p,E){p.F=Date.now(),he(p),p.B=As(p.A);var A=p.B,z=p.S;Array.isArray(z)||(z=[String(z)]),Yc(A.i,"t",z),p.C=0,A=p.j.L,p.h=new j,p.g=Yf(p.j,A?E:null,!p.u),p.P>0&&(p.O=new Wr(h(p.Y,p,p.g),p.P)),E=p.V,A=p.g,z=p.ba;var ae="readystatechange";Array.isArray(ae)||(ae&&(xn[0]=ae.toString()),ae=xn);for(let pe=0;pe<ae.length;pe++){const ze=xe(A,ae[pe],z||E.handleEvent,!1,E.h||E);if(!ze)break;E.g[ze.key]=ze}E=p.J?ee(p.J):{},p.u?(p.v||(p.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,E)):(p.v="GET",p.g.ea(p.B,p.v,null,E)),Un(),Ta(p.i,p.v,p.B,p.l,p.S,p.u)}H.prototype.ba=function(p){p=p.target;const E=this.O;E&&vi(p)==3?E.j():this.Y(p)},H.prototype.Y=function(p){try{if(p==this.g)e:{const pt=vi(this.g),Cr=this.g.ya(),qt=this.g.ca();if(!(pt<3)&&(pt!=3||this.g&&(this.h.h||this.g.la()||Kf(this.g)))){this.K||pt!=4||Cr==7||(Cr==8||qt<=0?Un(3):Un(2)),Ve(this);var E=this.g.ca();this.X=E;var A=ge(this);if(this.o=E==200,Sa(this.i,this.v,this.B,this.l,this.S,pt,E),this.o){if(this.U&&!this.L){t:{if(this.g){var z,ae=this.g;if((z=ae.g?ae.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(z)){var pe=z;break t}}pe=null}if(p=pe)Kn(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Pe(this,p);else{this.o=!1,this.m=3,er(12),De(this),We(this);break e}}if(this.R){p=!0;let br;for(;!this.K&&this.C<A.length;)if(br=fe(this,A),br==q){pt==4&&(this.m=4,er(14),p=!1),Kn(this.i,this.l,null,"[Incomplete Response]");break}else if(br==W){this.m=4,er(15),Kn(this.i,this.l,A,"[Invalid Chunk]"),p=!1;break}else Kn(this.i,this.l,br,null),Pe(this,br);if(le(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pt!=4||A.length!=0||this.h.h||(this.m=1,er(16),p=!1),this.o=this.o&&p,!p)Kn(this.i,this.l,A,"[Invalid Chunked Response]"),De(this),We(this);else if(A.length>0&&!this.W){this.W=!0;var ze=this.j;ze.g==this&&ze.aa&&!ze.P&&(ze.j.info("Great, no buffering proxy detected. Bytes received: "+A.length),Ro(ze),ze.P=!0,er(11))}}else Kn(this.i,this.l,A,null),Pe(this,A);pt==4&&De(this),this.o&&!this.K&&(pt==4?Dl(this.j,this):(this.o=!1,he(this)))}else Jc(this.g),E==400&&A.indexOf("Unknown SID")>0?(this.m=3,er(12)):(this.m=0,er(13)),De(this),We(this)}}}catch{}finally{}};function ge(p){if(!le(p))return p.g.la();const E=Kf(p.g);if(E==="")return"";let A="";const z=E.length,ae=vi(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return De(p),We(p),"";p.h.i=new o.TextDecoder}for(let pe=0;pe<z;pe++)p.h.h=!0,A+=p.h.i.decode(E[pe],{stream:!(ae&&pe==z-1)});return E.length=0,p.h.g+=A,p.C=0,p.h.g}function le(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function fe(p,E){var A=p.C,z=E.indexOf(`
`,A);return z==-1?q:(A=Number(E.substring(A,z)),isNaN(A)?W:(z+=1,z+A>E.length?q:(E=E.slice(z,z+A),p.C=z+A,E)))}H.prototype.cancel=function(){this.K=!0,De(this)};function he(p){p.T=Date.now()+p.H,Re(p,p.H)}function Re(p,E){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Ss(h(p.aa,p),E)}function Ve(p){p.D&&(o.clearTimeout(p.D),p.D=null)}H.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(ka(this.i,this.B),this.M!=2&&(Un(),er(17)),De(this),this.m=2,We(this)):Re(this,this.T-p)};function We(p){p.j.I==0||p.K||Dl(p.j,p)}function De(p){Ve(p);var E=p.O;E&&typeof E.dispose=="function"&&E.dispose(),p.O=null,Vn(p.V),p.g&&(E=p.g,p.g=null,E.abort(),E.dispose())}function Pe(p,E){try{var A=p.j;if(A.I!=0&&(A.g==p||Gs(A.h,p))){if(!p.L&&Gs(A.h,p)&&A.I==3){try{var z=A.Ba.g.parse(E)}catch{z=null}if(Array.isArray(z)&&z.length==3){var ae=z;if(ae[0]==0){e:if(!A.v){if(A.g)if(A.g.F+3e3<p.F)Nl(A),fs(A);else break e;wi(A),er(18)}}else A.xa=ae[1],0<A.xa-A.K&&ae[2]<37500&&A.F&&A.A==0&&!A.C&&(A.C=Ss(h(A.Va,A),6e3));fr(A.h)<=1&&A.ta&&(A.ta=void 0)}else hs(A,11)}else if((p.L||A.g==p)&&Nl(A),!V(E))for(ae=A.Ba.g.parse(E),E=0;E<ae.length;E++){let qt=ae[E];const br=qt[0];if(!(br<=A.K))if(A.K=br,qt=qt[1],A.I==2)if(qt[0]=="c"){A.M=qt[1],A.ba=qt[2];const ds=qt[3];ds!=null&&(A.ka=ds,A.j.info("VER="+A.ka));const Xi=qt[4];Xi!=null&&(A.za=Xi,A.j.info("SVER="+A.za));const Ei=qt[5];Ei!=null&&typeof Ei=="number"&&Ei>0&&(z=1.5*Ei,A.O=z,A.j.info("backChannelRequestTimeoutMs_="+z)),z=A;const Ti=p.g;if(Ti){const Ol=Ti.g?Ti.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ol){var pe=z.h;pe.g||Ol.indexOf("spdy")==-1&&Ol.indexOf("quic")==-1&&Ol.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(ks(pe,pe.h),pe.h=null))}if(z.G){const tu=Ti.g?Ti.g.getResponseHeader("X-HTTP-Session-Id"):null;tu&&(z.wa=tu,Vt(z.J,z.G,tu))}}A.I=3,A.l&&A.l.ra(),A.aa&&(A.T=Date.now()-p.F,A.j.info("Handshake RTT: "+A.T+"ms")),z=A;var ze=p;if(z.na=eu(z,z.L?z.ba:null,z.W),ze.L){cs(z.h,ze);var pt=ze,Cr=z.O;Cr&&(pt.H=Cr),pt.D&&(Ve(pt),he(pt)),z.g=ze}else _n(z);A.i.length>0&&Ki(A)}else qt[0]!="stop"&&qt[0]!="close"||hs(A,7);else A.I==3&&(qt[0]=="stop"||qt[0]=="close"?qt[0]=="stop"?hs(A,7):Fl(A):qt[0]!="noop"&&A.l&&A.l.qa(qt),A.A=0)}}Un(4)}catch{}}var ct=class{constructor(p,E){this.g=p,this.map=E}};function zt(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Gt(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function fr(p){return p.h?1:p.g?p.g.size:0}function Gs(p,E){return p.h?p.h==E:p.g?p.g.has(E):!1}function ks(p,E){p.g?p.g.add(E):p.h=E}function cs(p,E){p.h&&p.h==E?p.h=null:p.g&&p.g.has(E)&&p.g.delete(E)}zt.prototype.cancel=function(){if(this.i=Ar(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Ar(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let E=p.i;for(const A of p.g.values())E=E.concat(A.G);return E}return _(p.i)}var Aa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pr(p,E){if(p){p=p.split("&");for(let A=0;A<p.length;A++){const z=p[A].indexOf("=");let ae,pe=null;z>=0?(ae=p[A].substring(0,z),pe=p[A].substring(z+1)):ae=p[A],E(ae,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function hi(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;p instanceof hi?(this.l=p.l,So(this,p.j),this.o=p.o,this.g=p.g,di(this,p.u),this.h=p.h,Ca(this,Qc(p.i)),this.m=p.m):p&&(E=String(p).match(Aa))?(this.l=!1,So(this,E[1]||"",!0),this.o=ko(E[2]||""),this.g=ko(E[3]||"",!0),di(this,E[4]),this.h=ko(E[5]||"",!0),Ca(this,E[6]||"",!0),this.m=ko(E[7]||"")):(this.l=!1,this.i=new Ft(null,this.l))}hi.prototype.toString=function(){const p=[];var E=this.j;E&&p.push(Ao(E,$c,!0),":");var A=this.g;return(A||E=="file")&&(p.push("//"),(E=this.o)&&p.push(Ao(E,$c,!0),"@"),p.push(nr(A).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.u,A!=null&&p.push(":",String(A))),(A=this.h)&&(this.g&&A.charAt(0)!="/"&&p.push("/"),p.push(Ao(A,A.charAt(0)=="/"?Co:Gc,!0))),(A=this.i.toString())&&p.push("?",A),(A=this.m)&&p.push("#",Ao(A,qc)),p.join("")},hi.prototype.resolve=function(p){const E=As(this);let A=!!p.j;A?So(E,p.j):A=!!p.o,A?E.o=p.o:A=!!p.g,A?E.g=p.g:A=p.u!=null;var z=p.h;if(A)di(E,p.u);else if(A=!!p.h){if(z.charAt(0)!="/")if(this.g&&!this.h)z="/"+z;else{var ae=E.h.lastIndexOf("/");ae!=-1&&(z=E.h.slice(0,ae+1)+z)}if(ae=z,ae==".."||ae==".")z="";else if(ae.indexOf("./")!=-1||ae.indexOf("/.")!=-1){z=ae.lastIndexOf("/",0)==0,ae=ae.split("/");const pe=[];for(let ze=0;ze<ae.length;){const pt=ae[ze++];pt=="."?z&&ze==ae.length&&pe.push(""):pt==".."?((pe.length>1||pe.length==1&&pe[0]!="")&&pe.pop(),z&&ze==ae.length&&pe.push("")):(pe.push(pt),z=!0)}z=pe.join("/")}else z=ae}return A?E.h=z:A=p.i.toString()!=="",A?Ca(E,Qc(p.i)):A=!!p.m,A&&(E.m=p.m),E};function As(p){return new hi(p)}function So(p,E,A){p.j=A?ko(E,!0):E,p.j&&(p.j=p.j.replace(/:$/,""))}function di(p,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);p.u=E}else p.u=null}function Ca(p,E,A){E instanceof Ft?(p.i=E,Al(p.i,p.l)):(A||(E=Ao(E,Nd)),p.i=new Ft(E,p.l))}function Vt(p,E,A){p.i.set(E,A)}function Hi(p){return Vt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function ko(p,E){return p?E?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Ao(p,E,A){return typeof p=="string"?(p=encodeURI(p).replace(E,Hc),A&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Hc(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var $c=/[#\/\?@]/g,Gc=/[#\?:]/g,Co=/[#\?]/g,Nd=/[#\?@]/g,qc=/#/g;function Ft(p,E){this.h=this.g=null,this.i=p||null,this.j=!!E}function pi(p){p.g||(p.g=new Map,p.h=0,p.i&&pr(p.i,function(E,A){p.add(decodeURIComponent(E.replace(/\+/g," ")),A)}))}t=Ft.prototype,t.add=function(p,E){pi(this),this.i=null,p=mi(this,p);let A=this.g.get(p);return A||this.g.set(p,A=[]),A.push(E),this.h+=1,this};function Kc(p,E){pi(p),E=mi(p,E),p.g.has(E)&&(p.i=null,p.h-=p.g.get(E).length,p.g.delete(E))}function kl(p,E){return pi(p),E=mi(p,E),p.g.has(E)}t.forEach=function(p,E){pi(this),this.g.forEach(function(A,z){A.forEach(function(ae){p.call(E,ae,z,this)},this)},this)};function Xc(p,E){pi(p);let A=[];if(typeof E=="string")kl(p,E)&&(A=A.concat(p.g.get(mi(p,E))));else for(p=Array.from(p.g.values()),E=0;E<p.length;E++)A=A.concat(p[E]);return A}t.set=function(p,E){return pi(this),this.i=null,p=mi(this,p),kl(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[E]),this.h+=1,this},t.get=function(p,E){return p?(p=Xc(this,p),p.length>0?String(p[0]):E):E};function Yc(p,E,A){Kc(p,E),A.length>0&&(p.i=null,p.g.set(mi(p,E),_(A)),p.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],E=Array.from(this.g.keys());for(let z=0;z<E.length;z++){var A=E[z];const ae=nr(A);A=Xc(this,A);for(let pe=0;pe<A.length;pe++){let ze=ae;A[pe]!==""&&(ze+="="+nr(A[pe])),p.push(ze)}}return this.i=p.join("&")};function Qc(p){const E=new Ft;return E.i=p.i,p.g&&(E.g=new Map(p.g),E.h=p.h),E}function mi(p,E){return E=String(E),p.j&&(E=E.toLowerCase()),E}function Al(p,E){E&&!p.j&&(pi(p),p.i=null,p.g.forEach(function(A,z){const ae=z.toLowerCase();z!=ae&&(Kc(this,z),Yc(this,ae,A))},p)),p.j=E}function gi(p,E){const A=new ls;if(o.Image){const z=new Image;z.onload=d(an,A,"TestLoadImage: loaded",!0,E,z),z.onerror=d(an,A,"TestLoadImage: error",!1,E,z),z.onabort=d(an,A,"TestLoadImage: abort",!1,E,z),z.ontimeout=d(an,A,"TestLoadImage: timeout",!1,E,z),o.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=p}else E(!1)}function xi(p,E){const A=new ls,z=new AbortController,ae=setTimeout(()=>{z.abort(),an(A,"TestPingServer: timeout",!1,E)},1e4);fetch(p,{signal:z.signal}).then(pe=>{clearTimeout(ae),pe.ok?an(A,"TestPingServer: ok",!0,E):an(A,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(ae),an(A,"TestPingServer: error",!1,E)})}function an(p,E,A,z,ae){try{ae&&(ae.onload=null,ae.onerror=null,ae.onabort=null,ae.ontimeout=null),z(A)}catch{}}function Io(){this.g=new ot}function $i(p){this.i=p.Sb||null,this.h=p.ab||!1}g($i,Nt),$i.prototype.g=function(){return new us(this.i,this.h)};function us(p,E){St.call(this),this.H=p,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(us,St),t=us.prototype,t.open=function(p,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=E,this.readyState=1,qs(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(E.body=p),(this.H||o).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ia(this)),this.readyState=0},t.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,qs(this)),this.g&&(this.readyState=3,qs(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;$f(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function $f(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}t.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var E=p.value?p.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!p.done}))&&(this.response=this.responseText+=E)}p.done?Ia(this):qs(this),this.readyState==3&&$f(this)}},t.Oa=function(p){this.g&&(this.response=this.responseText=p,Ia(this))},t.Na=function(p){this.g&&(this.response=p,Ia(this))},t.ga=function(){this.g&&Ia(this)};function Ia(p){p.readyState=4,p.l=null,p.j=null,p.B=null,qs(p)}t.setRequestHeader=function(p,E){this.A.append(p,E)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],E=this.h.entries();for(var A=E.next();!A.done;)A=A.value,p.push(A[0]+": "+A[1]),A=E.next();return p.join(`\r
`)};function qs(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(us.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Gf(p){let E="";return ne(p,function(A,z){E+=z,E+=":",E+=A,E+=`\r
`}),E}function Cl(p,E,A){e:{for(z in A){var z=!1;break e}z=!0}z||(A=Gf(A),typeof p=="string"?A!=null&&nr(A):Vt(p,E,A))}function Zt(p){St.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(Zt,St);var qf=/^https?$/i,Dd=["POST","PUT"];t=Zt.prototype,t.Fa=function(p){this.H=p},t.ea=function(p,E,A,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);E=E?E.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():jt.g(),this.g.onreadystatechange=x(h(this.Ca,this));try{this.B=!0,this.g.open(E,String(p),!0),this.B=!1}catch(pe){Fa(this,pe);return}if(p=A||"",A=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var ae in z)A.set(ae,z[ae]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const pe of z.keys())A.set(pe,z.get(pe));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(A.keys()).find(pe=>pe.toLowerCase()=="content-type"),ae=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(Dd,E,void 0)>=0)||z||ae||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,ze]of A)this.g.setRequestHeader(pe,ze);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(pe){Fa(this,pe)}};function Fa(p,E){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=E,p.o=5,Ra(p),qi(p)}function Ra(p){p.A||(p.A=!0,Tt(p,"complete"),Tt(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Tt(this,"complete"),Tt(this,"abort"),qi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qi(this,!0)),Zt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Gi(this):this.Xa())},t.Xa=function(){Gi(this)};function Gi(p){if(p.h&&typeof i<"u"){if(p.v&&vi(p)==4)setTimeout(p.Ca.bind(p),0);else if(Tt(p,"readystatechange"),vi(p)==4){p.h=!1;try{const pe=p.ca();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var A;if(!(A=E)){var z;if(z=pe===0){let ze=String(p.D).match(Aa)[1]||null;!ze&&o.self&&o.self.location&&(ze=o.self.location.protocol.slice(0,-1)),z=!qf.test(ze?ze.toLowerCase():"")}A=z}if(A)Tt(p,"complete"),Tt(p,"success");else{p.o=6;try{var ae=vi(p)>2?p.g.statusText:""}catch{ae=""}p.l=ae+" ["+p.ca()+"]",Ra(p)}}finally{qi(p)}}}}function qi(p,E){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const A=p.g;p.g=null,E||Tt(p,"ready");try{A.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function vi(p){return p.g?p.g.readyState:0}t.ca=function(){try{return vi(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(p){if(this.g){var E=this.g.responseText;return p&&E.indexOf(p)==0&&(E=E.substring(p.length)),Yr(E)}};function Kf(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Jc(p){const E={};p=(p.g&&vi(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<p.length;z++){if(V(p[z]))continue;var A=P(p[z]);const ae=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const pe=E[ae]||[];E[ae]=pe,pe.push(A)}ye(E,function(z){return z.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function _i(p,E,A){return A&&A.internalChannelParams&&A.internalChannelParams[p]||E}function Il(p){this.za=0,this.i=[],this.j=new ls,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=_i("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=_i("baseRetryDelayMs",5e3,p),this.Za=_i("retryDelaySeedMs",1e4,p),this.Ta=_i("forwardChannelMaxRetries",2,p),this.va=_i("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new zt(p&&p.concurrentRequestLimit),this.Ba=new Io,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Il.prototype,t.ka=8,t.I=1,t.connect=function(p,E,A,z){er(0),this.W=p,this.H=E||{},A&&z!==void 0&&(this.H.OSID=A,this.H.OAID=z),this.F=this.X,this.J=eu(this,null,this.W),Ki(this)};function Fl(p){if(Rl(p),p.I==3){var E=p.V++,A=As(p.J);if(Vt(A,"SID",p.M),Vt(A,"RID",E),Vt(A,"TYPE","terminate"),yi(p,A),E=new H(p,p.j,E),E.M=2,E.A=Hi(As(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(E.A.toString(),"")}catch{}!A&&o.Image&&(new Image().src=E.A,A=!0),A||(E.g=Yf(E.j,null),E.g.ea(E.A)),E.F=Date.now(),he(E)}No(p)}function fs(p){p.g&&(Ro(p),p.g.cancel(),p.g=null)}function Rl(p){fs(p),p.v&&(o.clearTimeout(p.v),p.v=null),Nl(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function Ki(p){if(!Gt(p.h)&&!p.m){p.m=!0;var E=p.Ea;X||F(),G||(X(),G=!0),k.add(E,p),p.D=0}}function Xf(p,E){return fr(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=E.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Ss(h(p.Ea,p,E),Pl(p,p.D)),p.D++,!0)}t.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const ae=new H(this,this.j,p);let pe=this.o;if(this.U&&(pe?(pe=ee(pe),te(pe,this.U)):pe=this.U),this.u!==null||this.R||(ae.J=pe,pe=null),this.S)e:{for(var E=0,A=0;A<this.i.length;A++){t:{var z=this.i[A];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(E+=z,E>4096){E=A;break e}if(E===4096||A===this.i.length-1){E=A+1;break e}}E=1e3}else E=1e3;E=Zc(this,ae,E),A=As(this.J),Vt(A,"RID",p),Vt(A,"CVER",22),this.G&&Vt(A,"X-HTTP-Session-Id",this.G),yi(this,A),pe&&(this.R?E="headers="+nr(Gf(pe))+"&"+E:this.u&&Cl(A,this.u,pe)),ks(this.h,ae),this.Ra&&Vt(A,"TYPE","init"),this.S?(Vt(A,"$req",E),Vt(A,"SID","null"),ae.U=!0,K(ae,A,null)):K(ae,A,E),this.I=2}}else this.I==3&&(p?Fo(this,p):this.i.length==0||Gt(this.h)||Fo(this))};function Fo(p,E){var A;E?A=E.l:A=p.V++;const z=As(p.J);Vt(z,"SID",p.M),Vt(z,"RID",A),Vt(z,"AID",p.K),yi(p,z),p.u&&p.o&&Cl(z,p.u,p.o),A=new H(p,p.j,A,p.D+1),p.u===null&&(A.J=p.o),E&&(p.i=E.G.concat(p.i)),E=Zc(p,A,1e3),A.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),ks(p.h,A),K(A,z,E)}function yi(p,E){p.H&&ne(p.H,function(A,z){Vt(E,z,A)}),p.l&&ne({},function(A,z){Vt(E,z,A)})}function Zc(p,E,A){A=Math.min(p.i.length,A);const z=p.l?h(p.l.Ka,p.l,p):null;e:{var ae=p.i;let pt=-1;for(;;){const Cr=["count="+A];pt==-1?A>0?(pt=ae[0].g,Cr.push("ofs="+pt)):pt=0:Cr.push("ofs="+pt);let qt=!0;for(let br=0;br<A;br++){var pe=ae[br].g;const ds=ae[br].map;if(pe-=pt,pe<0)pt=Math.max(0,ae[br].g-100),qt=!1;else try{pe="req"+pe+"_"||"";try{var ze=ds instanceof Map?ds:Object.entries(ds);for(const[Xi,Ei]of ze){let Ti=Ei;c(Ei)&&(Ti=$t(Ei)),Cr.push(pe+Xi+"="+encodeURIComponent(Ti))}}catch(Xi){throw Cr.push(pe+"type="+encodeURIComponent("_badmap")),Xi}}catch{z&&z(ds)}}if(qt){ze=Cr.join("&");break e}}ze=void 0}return p=p.i.splice(0,A),E.G=p,ze}function _n(p){if(!p.g&&!p.v){p.Y=1;var E=p.Da;X||F(),G||(X(),G=!0),k.add(E,p),p.A=0}}function wi(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Ss(h(p.Da,p),Pl(p,p.A)),p.A++,!0)}t.Da=function(){if(this.v=null,Na(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Ss(h(this.Wa,this),p)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,er(10),fs(this),Na(this))};function Ro(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function Na(p){p.g=new H(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var E=As(p.na);Vt(E,"RID","rpc"),Vt(E,"SID",p.M),Vt(E,"AID",p.K),Vt(E,"CI",p.F?"0":"1"),!p.F&&p.ia&&Vt(E,"TO",p.ia),Vt(E,"TYPE","xmlhttp"),yi(p,E),p.u&&p.o&&Cl(E,p.u,p.o),p.O&&(p.g.H=p.O);var A=p.g;p=p.ba,A.M=1,A.A=Hi(As(E)),A.u=null,A.R=!0,ce(A,p)}t.Va=function(){this.C!=null&&(this.C=null,fs(this),wi(this),er(19))};function Nl(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function Dl(p,E){var A=null;if(p.g==E){Nl(p),Ro(p),p.g=null;var z=2}else if(Gs(p.h,E))A=E.G,cs(p.h,E),z=1;else return;if(p.I!=0){if(E.o)if(z==1){A=E.u?E.u.length:0,E=Date.now()-E.F;var ae=p.D;z=as(),Tt(z,new Ts(z,A)),Ki(p)}else _n(p);else if(ae=E.m,ae==3||ae==0&&E.X>0||!(z==1&&Xf(p,E)||z==2&&wi(p)))switch(A&&A.length>0&&(E=p.h,E.i=E.i.concat(A)),ae){case 1:hs(p,5);break;case 4:hs(p,10);break;case 3:hs(p,6);break;default:hs(p,2)}}}function Pl(p,E){let A=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(A*=2),A*E}function hs(p,E){if(p.j.info("Error code "+E),E==2){var A=h(p.bb,p),z=p.Ua;const ae=!z;z=new hi(z||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||So(z,"https"),Hi(z),ae?gi(z.toString(),A):xi(z.toString(),A)}else er(2);p.I=0,p.l&&p.l.pa(E),No(p),Rl(p)}t.bb=function(p){p?(this.j.info("Successfully pinged google.com"),er(2)):(this.j.info("Failed to ping google.com"),er(1))};function No(p){if(p.I=0,p.ja=[],p.l){const E=Ar(p.h);(E.length!=0||p.i.length!=0)&&(S(p.ja,E),S(p.ja,p.i),p.h.i.length=0,_(p.i),p.i.length=0),p.l.oa()}}function eu(p,E,A){var z=A instanceof hi?As(A):new hi(A);if(z.g!="")E&&(z.g=E+"."+z.g),di(z,z.u);else{var ae=o.location;z=ae.protocol,E=E?E+"."+ae.hostname:ae.hostname,ae=+ae.port;const pe=new hi(null);z&&So(pe,z),E&&(pe.g=E),ae&&di(pe,ae),A&&(pe.h=A),z=pe}return A=p.G,E=p.wa,A&&E&&Vt(z,A,E),Vt(z,"VER",p.ka),yi(p,z),z}function Yf(p,E,A){if(E&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=p.Aa&&!p.ma?new Zt(new $i({ab:A})):new Zt(p.ma),E.Fa(p.L),E}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qf(){}t=Qf.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function bl(){}bl.prototype.g=function(p,E){return new on(p,E)};function on(p,E){St.call(this),this.g=new Il(E),this.l=p,this.h=E&&E.messageUrlParams||null,p=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(p?p["X-WebChannel-Content-Type"]=E.messageContentType:p={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(p?p["X-WebChannel-Client-Profile"]=E.sa:p={"X-WebChannel-Client-Profile":E.sa}),this.g.U=p,(p=E&&E.Qb)&&!V(p)&&(this.g.u=p),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!V(E)&&(this.g.G=E,p=this.h,p!==null&&E in p&&(p=this.h,E in p&&delete p[E])),this.j=new Da(this)}g(on,St),on.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},on.prototype.close=function(){Fl(this.g)},on.prototype.o=function(p){var E=this.g;if(typeof p=="string"){var A={};A.__data__=p,p=A}else this.v&&(A={},A.__data__=$t(p),p=A);E.i.push(new ct(E.Ya++,p)),E.I==3&&Ki(E)},on.prototype.N=function(){this.g.l=null,delete this.j,Fl(this.g),delete this.g,on.Z.N.call(this)};function Jf(p){vn.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var E=p.__sm__;if(E){e:{for(const A in E){p=A;break e}p=void 0}(this.i=p)&&(p=this.i,E=E!==null&&p in E?E[p]:void 0),this.data=E}else this.data=p}g(Jf,vn);function Zf(){Ws.call(this),this.status=1}g(Zf,Ws);function Da(p){this.g=p}g(Da,Qf),Da.prototype.ra=function(){Tt(this.g,"a")},Da.prototype.qa=function(p){Tt(this.g,new Jf(p))},Da.prototype.pa=function(p){Tt(this.g,new Zf)},Da.prototype.oa=function(){Tt(this.g,"b")},bl.prototype.createWebChannel=bl.prototype.g,on.prototype.send=on.prototype.o,on.prototype.open=on.prototype.m,on.prototype.close=on.prototype.close,eE=function(){return new bl},Zw=function(){return as()},Jw=Bn,zm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Qe.NO_ERROR=0,Qe.TIMEOUT=8,Qe.HTTP_ERROR=6,h0=Qe,Je.COMPLETE="complete",Qw=Je,Hr.EventType=Mt,Mt.OPEN="a",Mt.CLOSE="b",Mt.ERROR="c",Mt.MESSAGE="d",St.prototype.listen=St.prototype.J,Iu=Hr,Zt.prototype.listenOnce=Zt.prototype.K,Zt.prototype.getLastError=Zt.prototype.Ha,Zt.prototype.getLastErrorCode=Zt.prototype.ya,Zt.prototype.getStatus=Zt.prototype.ca,Zt.prototype.getResponseJson=Zt.prototype.La,Zt.prototype.getResponseText=Zt.prototype.la,Zt.prototype.send=Zt.prototype.ea,Zt.prototype.setWithCredentials=Zt.prototype.Fa,Yw=Zt}).apply(typeof Kh<"u"?Kh:typeof self<"u"?self:typeof window<"u"?window:{});const J_="@firebase/firestore",Z_="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}An.UNAUTHENTICATED=new An(null),An.GOOGLE_CREDENTIALS=new An("google-credentials-uid"),An.FIRST_PARTY=new An("first-party-uid"),An.MOCK_USER=new An("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pc="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ol=new F1("@firebase/firestore");function ic(){return ol.logLevel}function Ge(t,...e){if(ol.logLevel<=kt.DEBUG){const r=e.map(D1);ol.debug(`Firestore (${Pc}): ${t}`,...r)}}function pa(t,...e){if(ol.logLevel<=kt.ERROR){const r=e.map(D1);ol.error(`Firestore (${Pc}): ${t}`,...r)}}function wc(t,...e){if(ol.logLevel<=kt.WARN){const r=e.map(D1);ol.warn(`Firestore (${Pc}): ${t}`,...r)}}function D1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(r){return JSON.stringify(r)})(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function at(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,tE(t,n,r)}function tE(t,e,r){let n=`FIRESTORE (${Pc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw pa(n),new Error(n)}function Wt(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||tE(e,s,n)}function mt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const we={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class He extends _a{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class WI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(An.UNAUTHENTICATED)))}shutdown(){}}class HI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class $I{constructor(e){this.t=e,this.currentUser=An.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Wt(this.o===void 0,42304);let n=this.i;const s=f=>this.i!==n?(n=this.i,r(f)):Promise.resolve();let i=new ca;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ca,e.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const f=i;e.enqueueRetryable((async()=>{await f.promise,await s(this.currentUser)}))},c=f=>{Ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((f=>c(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?c(f):(Ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ca)}}),0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(Ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Wt(typeof n.accessToken=="string",31837,{l:n}),new rE(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Wt(e===null||typeof e=="string",2055,{h:e}),new An(e)}}class GI{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=An.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class qI{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new GI(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(An.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ey{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class KI{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ri(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Wt(this.o===void 0,3512);const n=i=>{i.error!=null&&Ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Ge("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>n(i)))};const s=i=>{Ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new ey(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Wt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new ey(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XI(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=XI(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%62))}return n}}function At(t,e){return t<e?-1:t>e?1:0}function Wm(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),i=e.charAt(n);if(s!==i)return fm(s)===fm(i)?At(s,i):fm(s)?1:-1}return At(t.length,e.length)}const YI=55296,QI=57343;function fm(t){const e=t.charCodeAt(0);return e>=YI&&e<=QI}function Ec(t,e,r){return t.length===e.length&&t.every(((n,s)=>r(n,e[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="__name__";class Ni{constructor(e,r,n){r===void 0?r=0:r>e.length&&at(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&at(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ni.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ni?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=Ni.compareSegments(e.get(s),r.get(s));if(i!==0)return i}return At(e.length,r.length)}static compareSegments(e,r){const n=Ni.isNumericId(e),s=Ni.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?Ni.extractNumericId(e).compare(Ni.extractNumericId(r)):Wm(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return io.fromString(e.substring(4,e.length-2))}}class rr extends Ni{construct(e,r,n){return new rr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new He(we.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((s=>s.length>0)))}return new rr(r)}static emptyPath(){return new rr([])}}const JI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dn extends Ni{construct(e,r,n){return new dn(e,r,n)}static isValidIdentifier(e){return JI.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ty}static keyField(){return new dn([ty])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new He(we.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new He(we.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new He(we.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(n+=c,s++):(i(),s++)}if(i(),o)throw new He(we.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dn(r)}static emptyPath(){return new dn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e){this.path=e}static fromPath(e){return new et(rr.fromString(e))}static fromName(e){return new et(rr.fromString(e).popFirst(5))}static empty(){return new et(rr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&rr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return rr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new et(new rr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(t,e,r){if(!r)throw new He(we.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ZI(t,e,r,n){if(e===!0&&n===!0)throw new He(we.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function ry(t){if(!et.isDocumentKey(t))throw new He(we.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ny(t){if(et.isDocumentKey(t))throw new He(we.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function sE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function rd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":at(12329,{type:typeof t})}function $n(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new He(we.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=rd(t);throw new He(we.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jr(t,e){const r={typeString:t};return e&&(r.value=e),r}function Sf(t,e){if(!sE(t))throw new He(we.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(s&&typeof o!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new He(we.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sy=-62135596800,iy=1e6;class lr{static now(){return lr.fromMillis(Date.now())}static fromDate(e){return lr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*iy);return new lr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new He(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new He(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<sy)throw new He(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new He(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/iy}_compareTo(e){return this.seconds===e.seconds?At(this.nanoseconds,e.nanoseconds):At(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:lr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Sf(e,lr._jsonSchema))return new lr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-sy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}lr._jsonSchemaVersion="firestore/timestamp/1.0",lr._jsonSchema={type:jr("string",lr._jsonSchemaVersion),seconds:jr("number"),nanoseconds:jr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{static fromTimestamp(e){return new dt(e)}static min(){return new dt(new lr(0,0))}static max(){return new dt(new lr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu=-1;function e3(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=dt.fromTimestamp(n===1e9?new lr(r+1,0):new lr(r,n));return new oo(s,et.empty(),e)}function t3(t){return new oo(t.readTime,t.key,Qu)}class oo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new oo(dt.min(),et.empty(),Qu)}static max(){return new oo(dt.max(),et.empty(),Qu)}}function r3(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=et.comparator(t.documentKey,e.documentKey),r!==0?r:At(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class s3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bc(t){if(t.code!==we.FAILED_PRECONDITION||t.message!==n3)throw t;Ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&at(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Te(((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof Te?r:Te.resolve(r)}catch(r){return Te.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):Te.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):Te.reject(r)}static resolve(e){return new Te(((r,n)=>{r(e)}))}static reject(e){return new Te(((r,n)=>{n(e)}))}static waitFor(e){return new Te(((r,n)=>{let s=0,i=0,o=!1;e.forEach((c=>{++s,c.next((()=>{++i,o&&i===s&&r()}),(f=>n(f)))})),o=!0,i===s&&r()}))}static or(e){let r=Te.resolve(!1);for(const n of e)r=r.next((s=>s?Te.resolve(s):n()));return r}static forEach(e,r){const n=[];return e.forEach(((s,i)=>{n.push(r.call(this,s,i))})),this.waitFor(n)}static mapArray(e,r){return new Te(((n,s)=>{const i=e.length,o=new Array(i);let c=0;for(let f=0;f<i;f++){const h=f;r(e[h]).next((d=>{o[h]=d,++c,c===i&&n(o)}),(d=>s(d)))}}))}static doWhile(e,r){return new Te(((n,s)=>{const i=()=>{e()===!0?r().next((()=>{i()}),s):n()};i()}))}}function i3(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Oc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}nd.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1=-1;function sd(t){return t==null}function k0(t){return t===0&&1/t==-1/0}function a3(t){return typeof t=="number"&&Number.isInteger(t)&&!k0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE="";function o3(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=ay(e)),e=l3(t.get(r),e);return ay(e)}function l3(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case iE:r+="";break;default:r+=i}}return r}function ay(t){return t+iE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function vo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function aE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,r){this.comparator=e,this.root=r||fn.EMPTY}insert(e,r){return new yr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,fn.BLACK,null,null))}remove(e){return new yr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Xh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Xh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Xh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Xh(this.root,e,this.comparator,!0)}}class Xh{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class fn{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??fn.RED,this.left=s??fn.EMPTY,this.right=i??fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new fn(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return fn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return fn.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw at(43730,{key:this.key,value:this.value});if(this.right.isRed())throw at(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw at(27949);return e+(this.isRed()?0:1)}}fn.EMPTY=null,fn.RED=!0,fn.BLACK=!1;fn.EMPTY=new class{constructor(){this.size=0}get key(){throw at(57766)}get value(){throw at(16141)}get color(){throw at(16727)}get left(){throw at(29726)}get right(){throw at(36894)}copy(e,r,n,s,i){return this}insert(e,r,n){return new fn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e){this.comparator=e,this.data=new yr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new ly(this.data.getIterator())}getIteratorFrom(e){return new ly(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof Kr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new Kr(this.comparator);return r.data=e,r}}class ly{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this.fields=e,e.sort(dn.comparator)}static empty(){return new ws([])}unionWith(e){let r=new Kr(dn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new ws(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Ec(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new oE("Invalid base64 string: "+i):i}})(e);return new mn(r)}static fromUint8Array(e){const r=(function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i})(e);return new mn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return At(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mn.EMPTY_BYTE_STRING=new mn("");const c3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(t){if(Wt(!!t,39018),typeof t=="string"){let e=0;const r=c3.exec(t);if(Wt(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Rr(t.seconds),nanos:Rr(t.nanos)}}function Rr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function co(t){return typeof t=="string"?mn.fromBase64String(t):mn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lE="server_timestamp",cE="__type__",uE="__previous_value__",fE="__local_write_time__";function O1(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[cE])==null?void 0:n.stringValue)===lE}function id(t){const e=t.mapValue.fields[uE];return O1(e)?id(e):e}function Ju(t){const e=lo(t.mapValue.fields[fE].timestampValue);return new lr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e,r,n,s,i,o,c,f,h,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=f,this.useFetchStreams=h,this.isUsingEmulator=d}}const A0="(default)";class Zu{constructor(e,r){this.projectId=e,this.database=r||A0}static empty(){return new Zu("","")}get isDefaultDatabase(){return this.database===A0}isEqual(e){return e instanceof Zu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hE="__type__",f3="__max__",Yh={mapValue:{}},dE="__vector__",C0="value";function uo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?O1(t)?4:d3(t)?9007199254740991:h3(t)?10:11:at(28295,{value:t})}function Bi(t,e){if(t===e)return!0;const r=uo(t);if(r!==uo(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ju(t).isEqual(Ju(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=lo(s.timestampValue),c=lo(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(s,i){return co(s.bytesValue).isEqual(co(i.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(s,i){return Rr(s.geoPointValue.latitude)===Rr(i.geoPointValue.latitude)&&Rr(s.geoPointValue.longitude)===Rr(i.geoPointValue.longitude)})(t,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return Rr(s.integerValue)===Rr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Rr(s.doubleValue),c=Rr(i.doubleValue);return o===c?k0(o)===k0(c):isNaN(o)&&isNaN(c)}return!1})(t,e);case 9:return Ec(t.arrayValue.values||[],e.arrayValue.values||[],Bi);case 10:case 11:return(function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(oy(o)!==oy(c))return!1;for(const f in o)if(o.hasOwnProperty(f)&&(c[f]===void 0||!Bi(o[f],c[f])))return!1;return!0})(t,e);default:return at(52216,{left:t})}}function ef(t,e){return(t.values||[]).find((r=>Bi(r,e)))!==void 0}function Tc(t,e){if(t===e)return 0;const r=uo(t),n=uo(e);if(r!==n)return At(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return At(t.booleanValue,e.booleanValue);case 2:return(function(i,o){const c=Rr(i.integerValue||i.doubleValue),f=Rr(o.integerValue||o.doubleValue);return c<f?-1:c>f?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1})(t,e);case 3:return cy(t.timestampValue,e.timestampValue);case 4:return cy(Ju(t),Ju(e));case 5:return Wm(t.stringValue,e.stringValue);case 6:return(function(i,o){const c=co(i),f=co(o);return c.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(i,o){const c=i.split("/"),f=o.split("/");for(let h=0;h<c.length&&h<f.length;h++){const d=At(c[h],f[h]);if(d!==0)return d}return At(c.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(i,o){const c=At(Rr(i.latitude),Rr(o.latitude));return c!==0?c:At(Rr(i.longitude),Rr(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return uy(t.arrayValue,e.arrayValue);case 10:return(function(i,o){var x,_,S,y;const c=i.fields||{},f=o.fields||{},h=(x=c[C0])==null?void 0:x.arrayValue,d=(_=f[C0])==null?void 0:_.arrayValue,g=At(((S=h==null?void 0:h.values)==null?void 0:S.length)||0,((y=d==null?void 0:d.values)==null?void 0:y.length)||0);return g!==0?g:uy(h,d)})(t.mapValue,e.mapValue);case 11:return(function(i,o){if(i===Yh.mapValue&&o===Yh.mapValue)return 0;if(i===Yh.mapValue)return 1;if(o===Yh.mapValue)return-1;const c=i.fields||{},f=Object.keys(c),h=o.fields||{},d=Object.keys(h);f.sort(),d.sort();for(let g=0;g<f.length&&g<d.length;++g){const x=Wm(f[g],d[g]);if(x!==0)return x;const _=Tc(c[f[g]],h[d[g]]);if(_!==0)return _}return At(f.length,d.length)})(t.mapValue,e.mapValue);default:throw at(23264,{he:r})}}function cy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return At(t,e);const r=lo(t),n=lo(e),s=At(r.seconds,n.seconds);return s!==0?s:At(r.nanos,n.nanos)}function uy(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Tc(r[s],n[s]);if(i)return i}return At(r.length,n.length)}function Sc(t){return Hm(t)}function Hm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=lo(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return co(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return et.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=Hm(i);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const o of n)i?i=!1:s+=",",s+=`${o}:${Hm(r.fields[o])}`;return s+"}"})(t.mapValue):at(61005,{value:t})}function d0(t){switch(uo(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=id(t);return e?16+d0(e):16;case 5:return 2*t.stringValue.length;case 6:return co(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,i)=>s+d0(i)),0)})(t.arrayValue);case 10:case 11:return(function(n){let s=0;return vo(n.fields,((i,o)=>{s+=i.length+d0(o)})),s})(t.mapValue);default:throw at(13486,{value:t})}}function fy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function $m(t){return!!t&&"integerValue"in t}function L1(t){return!!t&&"arrayValue"in t}function hy(t){return!!t&&"nullValue"in t}function dy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function p0(t){return!!t&&"mapValue"in t}function h3(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[hE])==null?void 0:n.stringValue)===dE}function Lu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return vo(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=Lu(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Lu(t.arrayValue.values[r]);return e}return{...t}}function d3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===f3}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this.value=e}static empty(){return new ns({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!p0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lu(r)}setAll(e){let r=dn.emptyPath(),n={},s=[];e.forEach(((o,c)=>{if(!r.isImmediateParentOf(c)){const f=this.getFieldsMap(r);this.applyChanges(f,n,s),n={},s=[],r=c.popLast()}o?n[c.lastSegment()]=Lu(o):s.push(c.lastSegment())}));const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());p0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Bi(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];p0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){vo(r,((s,i)=>e[s]=i));for(const s of n)delete e[s]}clone(){return new ns(Lu(this.value))}}function pE(t){const e=[];return vo(t.fields,((r,n)=>{const s=new dn([r]);if(p0(n)){const i=pE(n.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)})),new ws(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,r,n,s,i,o,c){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Nn(e,0,dt.min(),dt.min(),dt.min(),ns.empty(),0)}static newFoundDocument(e,r,n,s){return new Nn(e,1,r,dt.min(),n,s,0)}static newNoDocument(e,r){return new Nn(e,2,r,dt.min(),dt.min(),ns.empty(),0)}static newUnknownDocument(e,r){return new Nn(e,3,r,dt.min(),dt.min(),ns.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ns.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ns.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=dt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e,r){this.position=e,this.inclusive=r}}function py(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?n=et.comparator(et.fromName(o.referenceValue),r.key):n=Tc(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function my(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Bi(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,r="asc"){this.field=e,this.dir=r}}function p3(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE{}class Ur extends mE{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new g3(e,r,n):r==="array-contains"?new _3(e,n):r==="in"?new y3(e,n):r==="not-in"?new w3(e,n):r==="array-contains-any"?new E3(e,n):new Ur(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new x3(e,n):new v3(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Tc(r,this.value)):r!==null&&uo(this.value)===uo(r)&&this.matchesComparison(Tc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return at(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ci extends mE{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new ci(e,r)}matches(e){return gE(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function gE(t){return t.op==="and"}function xE(t){return m3(t)&&gE(t)}function m3(t){for(const e of t.filters)if(e instanceof ci)return!1;return!0}function Gm(t){if(t instanceof Ur)return t.field.canonicalString()+t.op.toString()+Sc(t.value);if(xE(t))return t.filters.map((e=>Gm(e))).join(",");{const e=t.filters.map((r=>Gm(r))).join(",");return`${t.op}(${e})`}}function vE(t,e){return t instanceof Ur?(function(n,s){return s instanceof Ur&&n.op===s.op&&n.field.isEqual(s.field)&&Bi(n.value,s.value)})(t,e):t instanceof ci?(function(n,s){return s instanceof ci&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((i,o,c)=>i&&vE(o,s.filters[c])),!0):!1})(t,e):void at(19439)}function _E(t){return t instanceof Ur?(function(r){return`${r.field.canonicalString()} ${r.op} ${Sc(r.value)}`})(t):t instanceof ci?(function(r){return r.op.toString()+" {"+r.getFilters().map(_E).join(" ,")+"}"})(t):"Filter"}class g3 extends Ur{constructor(e,r,n){super(e,r,n),this.key=et.fromName(n.referenceValue)}matches(e){const r=et.comparator(e.key,this.key);return this.matchesComparison(r)}}class x3 extends Ur{constructor(e,r){super(e,"in",r),this.keys=yE("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class v3 extends Ur{constructor(e,r){super(e,"not-in",r),this.keys=yE("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function yE(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map((n=>et.fromName(n.referenceValue)))}class _3 extends Ur{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return L1(r)&&ef(r.arrayValue,this.value)}}class y3 extends Ur{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&ef(this.value.arrayValue,r)}}class w3 extends Ur{constructor(e,r){super(e,"not-in",r)}matches(e){if(ef(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!ef(this.value.arrayValue,r)}}class E3 extends Ur{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!L1(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>ef(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T3{constructor(e,r=null,n=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.Te=null}}function gy(t,e=null,r=[],n=[],s=null,i=null,o=null){return new T3(t,e,r,n,s,i,o)}function M1(t){const e=mt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>Gm(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(i){return i.field.canonicalString()+i.dir})(n))).join(","),sd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>Sc(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>Sc(n))).join(",")),e.Te=r}return e.Te}function V1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!p3(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!vE(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!my(t.startAt,e.startAt)&&my(t.endAt,e.endAt)}function qm(t){return et.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(e,r=null,n=[],s=[],i=null,o="F",c=null,f=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function S3(t,e,r,n,s,i,o,c){return new Lc(t,e,r,n,s,i,o,c)}function ad(t){return new Lc(t)}function xy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function wE(t){return t.collectionGroup!==null}function Mu(t){const e=mt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Kr(dn.comparator);return o.filters.forEach((f=>{f.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new tf(i,n))})),r.has(dn.keyField().canonicalString())||e.Ie.push(new tf(dn.keyField(),n))}return e.Ie}function bi(t){const e=mt(t);return e.Ee||(e.Ee=k3(e,Mu(t))),e.Ee}function k3(t,e){if(t.limitType==="F")return gy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new tf(s.field,i)}));const r=t.endAt?new I0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new I0(t.startAt.position,t.startAt.inclusive):null;return gy(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Km(t,e){const r=t.filters.concat([e]);return new Lc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Xm(t,e,r){return new Lc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function od(t,e){return V1(bi(t),bi(e))&&t.limitType===e.limitType}function EE(t){return`${M1(bi(t))}|lt:${t.limitType}`}function ac(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((s=>_E(s))).join(", ")}]`),sd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((s=>Sc(s))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((s=>Sc(s))).join(",")),`Target(${n})`})(bi(t))}; limitType=${t.limitType})`}function ld(t,e){return e.isFoundDocument()&&(function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):et.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)})(t,e)&&(function(n,s){for(const i of Mu(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(t,e)&&(function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0})(t,e)&&(function(n,s){return!(n.startAt&&!(function(o,c,f){const h=py(o,c,f);return o.inclusive?h<=0:h<0})(n.startAt,Mu(n),s)||n.endAt&&!(function(o,c,f){const h=py(o,c,f);return o.inclusive?h>=0:h>0})(n.endAt,Mu(n),s))})(t,e)}function A3(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function TE(t){return(e,r)=>{let n=!1;for(const s of Mu(t)){const i=C3(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function C3(t,e,r){const n=t.field.isKeyField()?et.comparator(e.key,r.key):(function(i,o,c){const f=o.data.field(i),h=c.data.field(i);return f!==null&&h!==null?Tc(f,h):at(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return at(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){vo(this.inner,((r,n)=>{for(const[s,i]of n)e(s,i)}))}isEmpty(){return aE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I3=new yr(et.comparator);function ma(){return I3}const SE=new yr(et.comparator);function Fu(...t){let e=SE;for(const r of t)e=e.insert(r.key,r);return e}function kE(t){let e=SE;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function qo(){return Vu()}function AE(){return Vu()}function Vu(){return new gl((t=>t.toString()),((t,e)=>t.isEqual(e)))}const F3=new yr(et.comparator),R3=new Kr(et.comparator);function Ct(...t){let e=R3;for(const r of t)e=e.add(r);return e}const N3=new Kr(At);function D3(){return N3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:k0(e)?"-0":e}}function CE(t){return{integerValue:""+t}}function P3(t,e){return a3(e)?CE(e):B1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(){this._=void 0}}function b3(t,e,r){return t instanceof rf?(function(s,i){const o={fields:{[cE]:{stringValue:lE},[fE]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&O1(i)&&(i=id(i)),i&&(o.fields[uE]=i),{mapValue:o}})(r,e):t instanceof nf?FE(t,e):t instanceof sf?RE(t,e):(function(s,i){const o=IE(s,i),c=vy(o)+vy(s.Ae);return $m(o)&&$m(s.Ae)?CE(c):B1(s.serializer,c)})(t,e)}function O3(t,e,r){return t instanceof nf?FE(t,e):t instanceof sf?RE(t,e):r}function IE(t,e){return t instanceof F0?(function(n){return $m(n)||(function(i){return!!i&&"doubleValue"in i})(n)})(e)?e:{integerValue:0}:null}class rf extends cd{}class nf extends cd{constructor(e){super(),this.elements=e}}function FE(t,e){const r=NE(e);for(const n of t.elements)r.some((s=>Bi(s,n)))||r.push(n);return{arrayValue:{values:r}}}class sf extends cd{constructor(e){super(),this.elements=e}}function RE(t,e){let r=NE(e);for(const n of t.elements)r=r.filter((s=>!Bi(s,n)));return{arrayValue:{values:r}}}class F0 extends cd{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function vy(t){return Rr(t.integerValue||t.doubleValue)}function NE(t){return L1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e,r){this.field=e,this.transform=r}}function M3(t,e){return t.field.isEqual(e.field)&&(function(n,s){return n instanceof nf&&s instanceof nf||n instanceof sf&&s instanceof sf?Ec(n.elements,s.elements,Bi):n instanceof F0&&s instanceof F0?Bi(n.Ae,s.Ae):n instanceof rf&&s instanceof rf})(t.transform,e.transform)}class V3{constructor(e,r){this.version=e,this.transformResults=r}}class Gn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Gn}static exists(e){return new Gn(void 0,e)}static updateTime(e){return new Gn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function m0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ud{}function DE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new fd(t.key,Gn.none()):new kf(t.key,t.data,Gn.none());{const r=t.data,n=ns.empty();let s=new Kr(dn.comparator);for(let i of e.fields)if(!s.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),s=s.add(i)}return new _o(t.key,n,new ws(s.toArray()),Gn.none())}}function B3(t,e,r){t instanceof kf?(function(s,i,o){const c=s.value.clone(),f=yy(s.fieldTransforms,i,o.transformResults);c.setAll(f),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(t,e,r):t instanceof _o?(function(s,i,o){if(!m0(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=yy(s.fieldTransforms,i,o.transformResults),f=i.data;f.setAll(PE(s)),f.setAll(c),i.convertToFoundDocument(o.version,f).setHasCommittedMutations()})(t,e,r):(function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,r)}function Bu(t,e,r,n){return t instanceof kf?(function(i,o,c,f){if(!m0(i.precondition,o))return c;const h=i.value.clone(),d=wy(i.fieldTransforms,f,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(t,e,r,n):t instanceof _o?(function(i,o,c,f){if(!m0(i.precondition,o))return c;const h=wy(i.fieldTransforms,f,o),d=o.data;return d.setAll(PE(i)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((g=>g.field)))})(t,e,r,n):(function(i,o,c){return m0(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(t,e,r)}function U3(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=IE(n.transform,s||null);i!=null&&(r===null&&(r=ns.empty()),r.set(n.field,i))}return r||null}function _y(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Ec(n,s,((i,o)=>M3(i,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class kf extends ud{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class _o extends ud{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function PE(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function yy(t,e,r){const n=new Map;Wt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);n.set(i.field,O3(o,c,r[s]))}return n}function wy(t,e,r){const n=new Map;for(const s of t){const i=s.transform,o=r.data.field(s.field);n.set(s.field,b3(i,o,e))}return n}class fd extends ud{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class j3 extends ud{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&B3(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Bu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Bu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=AE();return this.mutations.forEach((s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=r.has(s.key)?null:c;const f=DE(o,c);f!==null&&n.set(s.key,f),o.isValidDocument()||o.convertToNoDocument(dt.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Ct())}isEqual(e){return this.batchId===e.batchId&&Ec(this.mutations,e.mutations,((r,n)=>_y(r,n)))&&Ec(this.baseMutations,e.baseMutations,((r,n)=>_y(r,n)))}}class U1{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){Wt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=(function(){return F3})();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,n[o].version);return new U1(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mr,Rt;function $3(t){switch(t){case we.OK:return at(64938);case we.CANCELLED:case we.UNKNOWN:case we.DEADLINE_EXCEEDED:case we.RESOURCE_EXHAUSTED:case we.INTERNAL:case we.UNAVAILABLE:case we.UNAUTHENTICATED:return!1;case we.INVALID_ARGUMENT:case we.NOT_FOUND:case we.ALREADY_EXISTS:case we.PERMISSION_DENIED:case we.FAILED_PRECONDITION:case we.ABORTED:case we.OUT_OF_RANGE:case we.UNIMPLEMENTED:case we.DATA_LOSS:return!0;default:return at(15467,{code:t})}}function bE(t){if(t===void 0)return pa("GRPC error has no .code"),we.UNKNOWN;switch(t){case Mr.OK:return we.OK;case Mr.CANCELLED:return we.CANCELLED;case Mr.UNKNOWN:return we.UNKNOWN;case Mr.DEADLINE_EXCEEDED:return we.DEADLINE_EXCEEDED;case Mr.RESOURCE_EXHAUSTED:return we.RESOURCE_EXHAUSTED;case Mr.INTERNAL:return we.INTERNAL;case Mr.UNAVAILABLE:return we.UNAVAILABLE;case Mr.UNAUTHENTICATED:return we.UNAUTHENTICATED;case Mr.INVALID_ARGUMENT:return we.INVALID_ARGUMENT;case Mr.NOT_FOUND:return we.NOT_FOUND;case Mr.ALREADY_EXISTS:return we.ALREADY_EXISTS;case Mr.PERMISSION_DENIED:return we.PERMISSION_DENIED;case Mr.FAILED_PRECONDITION:return we.FAILED_PRECONDITION;case Mr.ABORTED:return we.ABORTED;case Mr.OUT_OF_RANGE:return we.OUT_OF_RANGE;case Mr.UNIMPLEMENTED:return we.UNIMPLEMENTED;case Mr.DATA_LOSS:return we.DATA_LOSS;default:return at(39323,{code:t})}}(Rt=Mr||(Mr={}))[Rt.OK=0]="OK",Rt[Rt.CANCELLED=1]="CANCELLED",Rt[Rt.UNKNOWN=2]="UNKNOWN",Rt[Rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rt[Rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rt[Rt.NOT_FOUND=5]="NOT_FOUND",Rt[Rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rt[Rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rt[Rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rt[Rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rt[Rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rt[Rt.ABORTED=10]="ABORTED",Rt[Rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rt[Rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rt[Rt.INTERNAL=13]="INTERNAL",Rt[Rt.UNAVAILABLE=14]="UNAVAILABLE",Rt[Rt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G3(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3=new io([4294967295,4294967295],0);function Ey(t){const e=G3().encode(t),r=new Xw;return r.update(e),new Uint8Array(r.digest())}function Ty(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new io([r,n],0),new io([s,i],0)]}class j1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Ru(`Invalid padding: ${r}`);if(n<0)throw new Ru(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ru(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Ru(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=io.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(io.fromNumber(n)));return s.compare(q3)===1&&(s=new io([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Ey(e),[n,s]=Ty(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,s,i);if(!this.we(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new j1(i,s,r);return n.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const r=Ey(e),[n,s]=Ty(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,s,i);this.Se(o)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Ru extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Af.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new hd(dt.min(),s,new yr(At),ma(),Ct())}}class Af{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Af(n,r,Ct(),Ct(),Ct())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class OE{constructor(e,r){this.targetId=e,this.Ce=r}}class LE{constructor(e,r,n=mn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class Sy{constructor(){this.ve=0,this.Fe=ky(),this.Me=mn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ct(),r=Ct(),n=Ct();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:at(38017,{changeType:i})}})),new Af(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=ky()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Wt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class K3{constructor(e){this.Ge=e,this.ze=new Map,this.je=ma(),this.Je=Qh(),this.He=Qh(),this.Ye=new yr(At)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:at(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,s)=>{this.rt(s)&&r(s)}))}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const i=s.target;if(qm(i))if(n===0){const o=new et(i.path);this.et(r,o,Nn.newNoDocument(o,dt.min()))}else Wt(n===1,20013,{expectedCount:n});else{const o=this._t(r);if(o!==n){const c=this.ut(e),f=c?this.ct(c,e,o):1;if(f!==0){this.it(r);const h=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let o,c;try{o=co(n).toUint8Array()}catch(f){if(f instanceof oE)return wc("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{c=new j1(o,s,i)}catch(f){return wc(f instanceof Ru?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach((i=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(r,i,null),s++)})),s}Tt(e){const r=new Map;this.ze.forEach(((i,o)=>{const c=this.ot(o);if(c){if(i.current&&qm(c.target)){const f=new et(c.target.path);this.It(f).has(o)||this.Et(o,f)||this.et(o,f,Nn.newNoDocument(f,e))}i.Be&&(r.set(o,i.ke()),i.qe())}}));let n=Ct();this.He.forEach(((i,o)=>{let c=!0;o.forEachWhile((f=>{const h=this.ot(f);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(n=n.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const s=new hd(e,r,this.Ye,this.je,n);return this.je=ma(),this.Je=Qh(),this.He=Qh(),this.Ye=new yr(At),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Sy,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Kr(At),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Kr(At),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ge("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Sy),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Qh(){return new yr(et.comparator)}function ky(){return new yr(et.comparator)}const X3={asc:"ASCENDING",desc:"DESCENDING"},Y3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Q3={and:"AND",or:"OR"};class J3{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Ym(t,e){return t.useProto3Json||sd(e)?e:{value:e}}function R0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ME(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Z3(t,e){return R0(t,e.toTimestamp())}function Oi(t){return Wt(!!t,49232),dt.fromTimestamp((function(r){const n=lo(r);return new lr(n.seconds,n.nanos)})(t))}function z1(t,e){return Qm(t,e).canonicalString()}function Qm(t,e){const r=(function(s){return new rr(["projects",s.projectId,"databases",s.database])})(t).child("documents");return e===void 0?r:r.child(e)}function VE(t){const e=rr.fromString(t);return Wt(WE(e),10190,{key:e.toString()}),e}function Jm(t,e){return z1(t.databaseId,e.path)}function hm(t,e){const r=VE(e);if(r.get(1)!==t.databaseId.projectId)throw new He(we.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new He(we.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new et(UE(r))}function BE(t,e){return z1(t.databaseId,e)}function eF(t){const e=VE(t);return e.length===4?rr.emptyPath():UE(e)}function Zm(t){return new rr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function UE(t){return Wt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Ay(t,e,r){return{name:Jm(t,e),fields:r.value.mapValue.fields}}function tF(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:at(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(Wt(d===void 0||typeof d=="string",58123),mn.fromBase64String(d||"")):(Wt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),mn.fromUint8Array(d||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(h){const d=h.code===void 0?we.UNKNOWN:bE(h.code);return new He(d,h.message||"")})(o);r=new LE(n,s,i,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=hm(t,n.document.name),i=Oi(n.document.updateTime),o=n.document.createTime?Oi(n.document.createTime):dt.min(),c=new ns({mapValue:{fields:n.document.fields}}),f=Nn.newFoundDocument(s,i,o,c),h=n.targetIds||[],d=n.removedTargetIds||[];r=new g0(h,d,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=hm(t,n.document),i=n.readTime?Oi(n.readTime):dt.min(),o=Nn.newNoDocument(s,i),c=n.removedTargetIds||[];r=new g0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=hm(t,n.document),i=n.removedTargetIds||[];r=new g0([],i,s,null)}else{if(!("filter"in e))return at(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,o=new H3(s,i),c=n.targetId;r=new OE(c,o)}}return r}function rF(t,e){let r;if(e instanceof kf)r={update:Ay(t,e.key,e.value)};else if(e instanceof fd)r={delete:Jm(t,e.key)};else if(e instanceof _o)r={update:Ay(t,e.key,e.data),updateMask:fF(e.fieldMask)};else{if(!(e instanceof j3))return at(16599,{Vt:e.type});r={verify:Jm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(i,o){const c=o.transform;if(c instanceof rf)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof nf)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof sf)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof F0)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw at(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:Z3(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:at(27497)})(t,e.precondition)),r}function nF(t,e){return t&&t.length>0?(Wt(e!==void 0,14353),t.map((r=>(function(s,i){let o=s.updateTime?Oi(s.updateTime):Oi(i);return o.isEqual(dt.min())&&(o=Oi(i)),new V3(o,s.transformResults||[])})(r,e)))):[]}function sF(t,e){return{documents:[BE(t,e.path)]}}function iF(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=BE(t,s);const i=(function(h){if(h.length!==0)return zE(ci.create(h,"and"))})(e.filters);i&&(r.structuredQuery.where=i);const o=(function(h){if(h.length!==0)return h.map((d=>(function(x){return{field:oc(x.field),direction:lF(x.dir)}})(d)))})(e.orderBy);o&&(r.structuredQuery.orderBy=o);const c=Ym(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:r,parent:s}}function aF(t){let e=eF(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Wt(n===1,65062);const d=r.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];r.where&&(i=(function(g){const x=jE(g);return x instanceof ci&&xE(x)?x.getFilters():[x]})(r.where));let o=[];r.orderBy&&(o=(function(g){return g.map((x=>(function(S){return new tf(lc(S.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(x)))})(r.orderBy));let c=null;r.limit&&(c=(function(g){let x;return x=typeof g=="object"?g.value:g,sd(x)?null:x})(r.limit));let f=null;r.startAt&&(f=(function(g){const x=!!g.before,_=g.values||[];return new I0(_,x)})(r.startAt));let h=null;return r.endAt&&(h=(function(g){const x=!g.before,_=g.values||[];return new I0(_,x)})(r.endAt)),S3(e,s,o,i,c,"F",f,h)}function oF(t,e){const r=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return at(28987,{purpose:s})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function jE(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=lc(r.unaryFilter.field);return Ur.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=lc(r.unaryFilter.field);return Ur.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=lc(r.unaryFilter.field);return Ur.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=lc(r.unaryFilter.field);return Ur.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return at(61313);default:return at(60726)}})(t):t.fieldFilter!==void 0?(function(r){return Ur.create(lc(r.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return at(58110);default:return at(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return ci.create(r.compositeFilter.filters.map((n=>jE(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return at(1026)}})(r.compositeFilter.op))})(t):at(30097,{filter:t})}function lF(t){return X3[t]}function cF(t){return Y3[t]}function uF(t){return Q3[t]}function oc(t){return{fieldPath:t.canonicalString()}}function lc(t){return dn.fromServerFormat(t.fieldPath)}function zE(t){return t instanceof Ur?(function(r){if(r.op==="=="){if(dy(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NAN"}};if(hy(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(dy(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NOT_NAN"}};if(hy(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oc(r.field),op:cF(r.op),value:r.value}}})(t):t instanceof ci?(function(r){const n=r.getFilters().map((s=>zE(s)));return n.length===1?n[0]:{compositeFilter:{op:uF(r.op),filters:n}}})(t):at(54877,{filter:t})}function fF(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function WE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,r,n,s,i=dt.min(),o=dt.min(),c=mn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=f}withSequenceNumber(e){return new Za(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Za(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Za(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Za(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(e){this.yt=e}}function dF(t){const e=aF({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Xm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{constructor(){this.Cn=new mF}addToCollectionParentIndex(e,r){return this.Cn.add(r),Te.resolve()}getCollectionParents(e,r){return Te.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Te.resolve()}deleteFieldIndex(e,r){return Te.resolve()}deleteAllFieldIndexes(e){return Te.resolve()}createTargetIndexes(e,r){return Te.resolve()}getDocumentsMatchingTarget(e,r){return Te.resolve(null)}getIndexType(e,r){return Te.resolve(0)}getFieldIndexes(e,r){return Te.resolve([])}getNextCollectionGroupToUpdate(e){return Te.resolve(null)}getMinOffset(e,r){return Te.resolve(oo.min())}getMinOffsetFromCollectionGroup(e,r){return Te.resolve(oo.min())}updateCollectionGroup(e,r,n){return Te.resolve()}updateIndexEntries(e,r){return Te.resolve()}}class mF{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Kr(rr.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Kr(rr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},HE=41943040;class rs{static withCacheSize(e){return new rs(e,rs.DEFAULT_COLLECTION_PERCENTILE,rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rs.DEFAULT_COLLECTION_PERCENTILE=10,rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rs.DEFAULT=new rs(HE,rs.DEFAULT_COLLECTION_PERCENTILE,rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rs.DISABLED=new rs(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new kc(0)}static cr(){return new kc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iy="LruGarbageCollector",gF=1048576;function Fy([t,e],[r,n]){const s=At(t,r);return s===0?At(e,n):s}class xF{constructor(e){this.Ir=e,this.buffer=new Kr(Fy),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Fy(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class vF{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ge(Iy,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Oc(r)?Ge(Iy,"Ignoring IndexedDB error during garbage collection: ",r):await bc(r)}await this.Vr(3e5)}))}}class _F{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return Te.resolve(nd.ce);const n=new xF(r);return this.mr.forEachTarget(e,(s=>n.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>n.Ar(s))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ge("LruGarbageCollector","Garbage collection skipped; disabled"),Te.resolve(Cy)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Cy):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,i,o,c,f,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(Ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),s=this.params.maximumSequenceNumbersToCollect):s=g,o=Date.now(),this.nthSequenceNumber(e,s)))).next((g=>(n=g,c=Date.now(),this.removeTargets(e,n,r)))).next((g=>(i=g,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((g=>(h=Date.now(),ic()<=kt.DEBUG&&Ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(f-c)+`ms
	Removed ${g} documents in `+(h-f)+`ms
Total Duration: ${h-d}ms`),Te.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:g}))))}}function yF(t,e){return new _F(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wF{constructor(){this.changes=new gl((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Nn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Te.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EF{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TF{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,r)))).next((s=>(n!==null&&Bu(n.mutation,s,ws.empty(),lr.now()),s)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Ct()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Ct()){const s=qo();return this.populateOverlays(e,s,r).next((()=>this.computeViews(e,r,s,n).next((i=>{let o=Fu();return i.forEach(((c,f)=>{o=o.insert(c,f.overlayedDocument)})),o}))))}getOverlayedDocuments(e,r){const n=qo();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Ct())))}populateOverlays(e,r,n){const s=[];return n.forEach((i=>{r.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((o,c)=>{r.set(o,c)}))}))}computeViews(e,r,n,s){let i=ma();const o=Vu(),c=(function(){return Vu()})();return r.forEach(((f,h)=>{const d=n.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof _o)?i=i.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),Bu(d.mutation,h,d.mutation.getFieldMask(),lr.now())):o.set(h.key,ws.empty())})),this.recalculateAndSaveOverlays(e,i).next((f=>(f.forEach(((h,d)=>o.set(h,d))),r.forEach(((h,d)=>c.set(h,new EF(d,o.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,r){const n=Vu();let s=new yr(((o,c)=>o-c)),i=Ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((o=>{for(const c of o)c.keys().forEach((f=>{const h=r.get(f);if(h===null)return;let d=n.get(f)||ws.empty();d=c.applyToLocalView(h,d),n.set(f,d);const g=(s.get(c.batchId)||Ct()).add(f);s=s.insert(c.batchId,g)}))})).next((()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const f=c.getNext(),h=f.key,d=f.value,g=AE();d.forEach((x=>{if(!i.has(x)){const _=DE(r.get(x),n.get(x));_!==null&&g.set(x,_),i=i.add(x)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return Te.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,s){return(function(o){return et.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):wE(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next((i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):Te.resolve(qo());let c=Qu,f=i;return o.next((h=>Te.forEach(h,((d,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(d)?Te.resolve():this.remoteDocumentCache.getEntry(e,d).next((x=>{f=f.insert(d,x)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,f,h,Ct()))).next((d=>({batchId:c,changes:kE(d)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new et(r)).next((n=>{let s=Fu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let o=Fu();return this.indexManager.getCollectionParents(e,i).next((c=>Te.forEach(c,(f=>{const h=(function(g,x){return new Lc(x,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(r,f.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,n,s).next((d=>{d.forEach(((g,x)=>{o=o.insert(g,x)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s)))).next((o=>{i.forEach(((f,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Nn.newInvalidDocument(d)))}));let c=Fu();return o.forEach(((f,h)=>{const d=i.get(f);d!==void 0&&Bu(d.mutation,h,ws.empty(),lr.now()),ld(r,h)&&(c=c.insert(f,h))})),c}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SF{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Te.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(s){return{id:s.id,version:s.version,createTime:Oi(s.createTime)}})(r)),Te.resolve()}getNamedQuery(e,r){return Te.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(s){return{name:s.name,query:dF(s.bundledQuery),readTime:Oi(s.readTime)}})(r)),Te.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{constructor(){this.overlays=new yr(et.comparator),this.qr=new Map}getOverlay(e,r){return Te.resolve(this.overlays.get(r))}getOverlays(e,r){const n=qo();return Te.forEach(r,(s=>this.getOverlay(e,s).next((i=>{i!==null&&n.set(s,i)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((s,i)=>{this.St(e,r,i)})),Te.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(n)),Te.resolve()}getOverlaysForCollection(e,r,n){const s=qo(),i=r.length+1,o=new et(r.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const f=c.getNext().value,h=f.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===i&&f.largestBatchId>n&&s.set(f.getKey(),f)}return Te.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new yr(((h,d)=>h-d));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let d=i.get(h.largestBatchId);d===null&&(d=qo(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=qo(),f=i.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((h,d)=>c.set(h,d))),!(c.size()>=s)););return Te.resolve(c)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new W3(r,n));let i=this.qr.get(r);i===void 0&&(i=Ct(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AF{constructor(){this.sessionToken=mn.EMPTY_BYTE_STRING}getSessionToken(e){return Te.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Te.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(){this.Qr=new Kr(en.$r),this.Ur=new Kr(en.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new en(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new en(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new et(new rr([])),n=new en(r,e),s=new en(r,e+1),i=[];return this.Ur.forEachInRange([n,s],(o=>{this.Gr(o),i.push(o.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new et(new rr([])),n=new en(r,e),s=new en(r,e+1);let i=Ct();return this.Ur.forEachInRange([n,s],(o=>{i=i.add(o.key)})),i}containsKey(e){const r=new en(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class en{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return et.comparator(e.key,r.key)||At(e.Yr,r.Yr)}static Kr(e,r){return At(e.Yr,r.Yr)||et.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Kr(en.$r)}checkEmpty(e){return Te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new z3(i,r,n,s);this.mutationQueue.push(o);for(const c of s)this.Zr=this.Zr.add(new en(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Te.resolve(o)}lookupMutationBatch(e,r){return Te.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),i=s<0?0:s;return Te.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Te.resolve(this.mutationQueue.length===0?b1:this.tr-1)}getAllMutationBatches(e){return Te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new en(r,0),s=new en(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],(o=>{const c=this.Xr(o.Yr);i.push(c)})),Te.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Kr(At);return r.forEach((s=>{const i=new en(s,0),o=new en(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],(c=>{n=n.add(c.Yr)}))})),Te.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;et.isDocumentKey(i)||(i=i.child(""));const o=new en(new et(i),0);let c=new Kr(At);return this.Zr.forEachWhile((f=>{const h=f.key.path;return!!n.isPrefixOf(h)&&(h.length===s&&(c=c.add(f.Yr)),!0)}),o),Te.resolve(this.ti(c))}ti(e){const r=[];return e.forEach((n=>{const s=this.Xr(n);s!==null&&r.push(s)})),r}removeMutationBatch(e,r){Wt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Te.forEach(r.mutations,(s=>{const i=new en(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new en(r,0),s=this.Zr.firstAfterOrEqual(n);return Te.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Te.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(e){this.ri=e,this.docs=(function(){return new yr(et.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,o=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Te.resolve(n?n.document.mutableCopy():Nn.newInvalidDocument(r))}getEntries(e,r){let n=ma();return r.forEach((s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Nn.newInvalidDocument(s))})),Te.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=ma();const o=r.path,c=new et(o.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(c);for(;f.hasNext();){const{key:h,value:{document:d}}=f.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||r3(t3(d),n)<=0||(s.has(d.key)||ld(r,d))&&(i=i.insert(d.key,d.mutableCopy()))}return Te.resolve(i)}getAllFromCollectionGroup(e,r,n,s){at(9500)}ii(e,r){return Te.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new FF(this)}getSize(e){return Te.resolve(this.size)}}class FF extends wF{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)})),Te.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(e){this.persistence=e,this.si=new gl((r=>M1(r)),V1),this.lastRemoteSnapshotVersion=dt.min(),this.highestTargetId=0,this.oi=0,this._i=new W1,this.targetCount=0,this.ai=kc.ur()}forEachTarget(e,r){return this.si.forEach(((n,s)=>r(s))),Te.resolve()}getLastRemoteSnapshotVersion(e){return Te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Te.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Te.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Te.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new kc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Te.resolve()}updateTargetData(e,r){return this.Pr(r),Te.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Te.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),Te.waitFor(i).next((()=>s))}getTargetCount(e){return Te.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Te.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Te.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach((o=>{i.push(s.markPotentiallyOrphaned(e,o))})),Te.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Te.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Te.resolve(n)}containsKey(e,r){return Te.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e,r){this.ui={},this.overlays={},this.ci=new nd(0),this.li=!1,this.li=!0,this.hi=new AF,this.referenceDelegate=e(this),this.Pi=new RF(this),this.indexManager=new pF,this.remoteDocumentCache=(function(s){return new IF(s)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new hF(r),this.Ii=new SF(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new kF,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new CF(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ge("MemoryPersistence","Starting transaction:",e);const s=new NF(this.ci.next());return this.referenceDelegate.Ei(),n(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,r){return Te.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class NF extends s3{constructor(e){super(),this.currentSequenceNumber=e}}class H1{constructor(e){this.persistence=e,this.Ri=new W1,this.Vi=null}static mi(e){return new H1(e)}get fi(){if(this.Vi)return this.Vi;throw at(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Te.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Te.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Te.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((s=>this.fi.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Te.forEach(this.fi,(n=>{const s=et.fromPath(n);return this.gi(e,s).next((i=>{i||r.removeEntry(s,dt.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return Te.or([()=>Te.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class N0{constructor(e,r){this.persistence=e,this.pi=new gl((n=>o3(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=yF(this,r)}static mi(e,r){return new N0(e,r)}Ei(){}di(e){return Te.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((s=>n+s))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return Te.forEach(this.pi,((n,s)=>this.br(e,n,s).next((i=>i?Te.resolve():r(s)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(o=>this.br(e,o,r).next((c=>{c||(n++,i.removeEntry(o,dt.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Te.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Te.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Te.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Te.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=d0(e.data.value)),r}br(e,r,n){return Te.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return Te.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=Ct(),s=Ct();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new $1(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PF{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return TC()?8:i3(On())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.ys(e,r).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ws(e,r,s,n).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new DF;return this.Ss(e,r,o).next((c=>{if(i.result=c,this.Vs)return this.bs(e,r,o,c.size)}))})).next((()=>i.result))}bs(e,r,n,s){return n.documentReadCount<this.fs?(ic()<=kt.DEBUG&&Ge("QueryEngine","SDK will not create cache indexes for query:",ac(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Te.resolve()):(ic()<=kt.DEBUG&&Ge("QueryEngine","Query:",ac(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(ic()<=kt.DEBUG&&Ge("QueryEngine","The SDK decides to create cache indexes for query:",ac(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,bi(r))):Te.resolve())}ys(e,r){if(xy(r))return Te.resolve(null);let n=bi(r);return this.indexManager.getIndexType(e,n).next((s=>s===0?null:(r.limit!==null&&s===1&&(r=Xm(r,null,"F"),n=bi(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const o=Ct(...i);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,n).next((f=>{const h=this.Ds(r,c);return this.Cs(r,h,o,f.readTime)?this.ys(e,Xm(r,null,"F")):this.vs(e,h,r,f)}))))})))))}ws(e,r,n,s){return xy(r)||s.isEqual(dt.min())?Te.resolve(null):this.ps.getDocuments(e,n).next((i=>{const o=this.Ds(r,i);return this.Cs(r,o,n,s)?Te.resolve(null):(ic()<=kt.DEBUG&&Ge("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ac(r)),this.vs(e,o,r,e3(s,Qu)).next((c=>c)))}))}Ds(e,r){let n=new Kr(TE(e));return r.forEach(((s,i)=>{ld(e,i)&&(n=n.add(i))})),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,r,n){return ic()<=kt.DEBUG&&Ge("QueryEngine","Using full collection scan to execute query:",ac(r)),this.ps.getDocumentsMatchingQuery(e,r,oo.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next((i=>(r.forEach((o=>{i=i.insert(o.key,o)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1="LocalStore",bF=3e8;class OF{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new yr(At),this.xs=new gl((i=>M1(i)),V1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new TF(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function LF(t,e,r,n){return new OF(t,e,r,n)}async function GE(t,e){const r=mt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next((i=>(s=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((i=>{const o=[],c=[];let f=Ct();for(const h of s){o.push(h.batchId);for(const d of h.mutations)f=f.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)f=f.add(d.key)}return r.localDocuments.getDocuments(n,f).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:c})))}))}))}function MF(t,e){const r=mt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,f,h,d){const g=h.batch,x=g.keys();let _=Te.resolve();return x.forEach((S=>{_=_.next((()=>d.getEntry(f,S))).next((y=>{const T=h.docVersions.get(S);Wt(T!==null,48541),y.version.compareTo(T)<0&&(g.applyToRemoteDocument(y,h),y.isValidDocument()&&(y.setReadTime(h.commitVersion),d.addEntry(y)))}))})),_.next((()=>c.mutationQueue.removeMutationBatch(f,g)))})(r,n,e,i).next((()=>i.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(c){let f=Ct();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(f=f.add(c.batch.mutations[h].key));return f})(e)))).next((()=>r.localDocuments.getDocuments(n,s)))}))}function qE(t){const e=mt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function VF(t,e){const r=mt(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const c=[];e.targetChanges.forEach(((d,g)=>{const x=s.get(g);if(!x)return;c.push(r.Pi.removeMatchingKeys(i,d.removedDocuments,g).next((()=>r.Pi.addMatchingKeys(i,d.addedDocuments,g))));let _=x.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?_=_.withResumeToken(mn.EMPTY_BYTE_STRING,dt.min()).withLastLimboFreeSnapshotVersion(dt.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,n)),s=s.insert(g,_),(function(y,T,R){return y.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=bF?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0})(x,_,d)&&c.push(r.Pi.updateTargetData(i,_))}));let f=ma(),h=Ct();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(i,d))})),c.push(BF(i,o,e.documentUpdates).next((d=>{f=d.ks,h=d.qs}))),!n.isEqual(dt.min())){const d=r.Pi.getLastRemoteSnapshotVersion(i).next((g=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n)));c.push(d)}return Te.waitFor(c).next((()=>o.apply(i))).next((()=>r.localDocuments.getLocalViewOfDocuments(i,f,h))).next((()=>f))})).then((i=>(r.Ms=s,i)))}function BF(t,e,r){let n=Ct(),s=Ct();return r.forEach((i=>n=n.add(i))),e.getEntries(t,n).next((i=>{let o=ma();return r.forEach(((c,f)=>{const h=i.get(c);f.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),f.isNoDocument()&&f.version.isEqual(dt.min())?(e.removeEntry(c,f.readTime),o=o.insert(c,f)):!h.isValidDocument()||f.version.compareTo(h.version)>0||f.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(f),o=o.insert(c,f)):Ge(G1,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",f.version)})),{ks:o,qs:s}}))}function UF(t,e){const r=mt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=b1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function jF(t,e){const r=mt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return r.Pi.getTargetData(n,e).next((i=>i?(s=i,Te.resolve(s)):r.Pi.allocateTargetId(n).next((o=>(s=new Za(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function e1(t,e,r){const n=mt(t),s=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,(o=>n.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!Oc(o))throw o;Ge(G1,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function Ry(t,e,r){const n=mt(t);let s=dt.min(),i=Ct();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(f,h,d){const g=mt(f),x=g.xs.get(d);return x!==void 0?Te.resolve(g.Ms.get(x)):g.Pi.getTargetData(h,d)})(n,o,bi(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,c.targetId).next((f=>{i=f}))})).next((()=>n.Fs.getDocumentsMatchingQuery(o,e,r?s:dt.min(),r?i:Ct()))).next((c=>(zF(n,A3(e),c),{documents:c,Qs:i})))))}function zF(t,e,r){let n=t.Os.get(e)||dt.min();r.forEach(((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)})),t.Os.set(e,n)}class Ny{constructor(){this.activeTargetIds=D3()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class WF{constructor(){this.Mo=new Ny,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ny,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dy="ConnectivityMonitor";class Py{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ge(Dy,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ge(Dy,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jh=null;function t1(){return Jh===null?Jh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Jh++,"0x"+Jh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dm="RestConnection",$F={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class GF{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===A0?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,i){const o=t1(),c=this.zo(e,r.toUriEncodedString());Ge(dm,`Sending RPC '${e}' ${o}:`,c,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,s,i);const{host:h}=new URL(c),d=Nc(h);return this.Jo(e,c,f,n,d).then((g=>(Ge(dm,`Received RPC '${e}' ${o}: `,g),g)),(g=>{throw wc(dm,`RPC '${e}' ${o} failed with error: `,g,"url: ",c,"request:",n),g}))}Ho(e,r,n,s,i,o){return this.Go(e,r,n,s,i)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Pc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((s,i)=>e[i]=s)),n&&n.headers.forEach(((s,i)=>e[i]=s))}zo(e,r){const n=$F[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sn="WebChannelConnection";class KF extends GF{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,i){const o=t1();return new Promise(((c,f)=>{const h=new Yw;h.setWithCredentials(!0),h.listenOnce(Qw.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case h0.NO_ERROR:const g=h.getResponseJson();Ge(Sn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),c(g);break;case h0.TIMEOUT:Ge(Sn,`RPC '${e}' ${o} timed out`),f(new He(we.DEADLINE_EXCEEDED,"Request time out"));break;case h0.HTTP_ERROR:const x=h.getStatus();if(Ge(Sn,`RPC '${e}' ${o} failed with status:`,x,"response text:",h.getResponseText()),x>0){let _=h.getResponseJson();Array.isArray(_)&&(_=_[0]);const S=_==null?void 0:_.error;if(S&&S.status&&S.message){const y=(function(R){const O=R.toLowerCase().replace(/_/g,"-");return Object.values(we).indexOf(O)>=0?O:we.UNKNOWN})(S.status);f(new He(y,S.message))}else f(new He(we.UNKNOWN,"Server responded with status "+h.getStatus()))}else f(new He(we.UNAVAILABLE,"Connection failed."));break;default:at(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Ge(Sn,`RPC '${e}' ${o} completed.`)}}));const d=JSON.stringify(s);Ge(Sn,`RPC '${e}' ${o} sending request:`,s),h.send(r,"POST",d,n,15)}))}T_(e,r,n){const s=t1(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=eE(),c=Zw(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(f.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,r,n),f.encodeInitMessageHeaders=!0;const d=i.join("");Ge(Sn,`Creating RPC '${e}' stream ${s}: ${d}`,f);const g=o.createWebChannel(d,f);this.I_(g);let x=!1,_=!1;const S=new qF({Yo:T=>{_?Ge(Sn,`Not sending because RPC '${e}' stream ${s} is closed:`,T):(x||(Ge(Sn,`Opening RPC '${e}' stream ${s} transport.`),g.open(),x=!0),Ge(Sn,`RPC '${e}' stream ${s} sending:`,T),g.send(T))},Zo:()=>g.close()}),y=(T,R,O)=>{T.listen(R,(N=>{try{O(N)}catch(U){setTimeout((()=>{throw U}),0)}}))};return y(g,Iu.EventType.OPEN,(()=>{_||(Ge(Sn,`RPC '${e}' stream ${s} transport opened.`),S.o_())})),y(g,Iu.EventType.CLOSE,(()=>{_||(_=!0,Ge(Sn,`RPC '${e}' stream ${s} transport closed`),S.a_(),this.E_(g))})),y(g,Iu.EventType.ERROR,(T=>{_||(_=!0,wc(Sn,`RPC '${e}' stream ${s} transport errored. Name:`,T.name,"Message:",T.message),S.a_(new He(we.UNAVAILABLE,"The operation could not be completed")))})),y(g,Iu.EventType.MESSAGE,(T=>{var R;if(!_){const O=T.data[0];Wt(!!O,16349);const N=O,U=(N==null?void 0:N.error)||((R=N[0])==null?void 0:R.error);if(U){Ge(Sn,`RPC '${e}' stream ${s} received error:`,U);const X=U.status;let G=(function(I){const B=Mr[I];if(B!==void 0)return bE(B)})(X),k=U.message;G===void 0&&(G=we.INTERNAL,k="Unknown error status: "+X+" with message "+U.message),_=!0,S.a_(new He(G,k)),g.close()}else Ge(Sn,`RPC '${e}' stream ${s} received:`,O),S.u_(O)}})),y(c,Jw.STAT_EVENT,(T=>{T.stat===zm.PROXY?Ge(Sn,`RPC '${e}' stream ${s} detected buffering proxy`):T.stat===zm.NOPROXY&&Ge(Sn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function pm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dd(t){return new J3(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(e,r,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&Ge("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by="PersistentStream";class XE{constructor(e,r,n,s,i,o,c,f){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new KE(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===we.RESOURCE_EXHAUSTED?(pa(r.toString()),pa("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===we.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===r&&this.G_(n,s)}),(n=>{e((()=>{const s=new He(we.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ge(by,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(Ge(by,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class XF extends XE{constructor(e,r,n,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=tF(this.serializer,e),n=(function(i){if(!("targetChange"in i))return dt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?dt.min():o.readTime?Oi(o.readTime):dt.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=Zm(this.serializer),r.addTarget=(function(i,o){let c;const f=o.target;if(c=qm(f)?{documents:sF(i,f)}:{query:iF(i,f).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=ME(i,o.resumeToken);const h=Ym(i,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(dt.min())>0){c.readTime=R0(i,o.snapshotVersion.toTimestamp());const h=Ym(i,o.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const n=oF(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=Zm(this.serializer),r.removeTarget=e,this.q_(r)}}class YF extends XE{constructor(e,r,n,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Wt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Wt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Wt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=nF(e.writeResults,e.commitTime),n=Oi(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=Zm(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>rF(this.serializer,n)))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{}class JF extends QF{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new He(we.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Go(e,Qm(r,n),s,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new He(we.UNKNOWN,i.toString())}))}Ho(e,r,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,Qm(r,n),s,o,c,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new He(we.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class ZF{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(pa(r),this.aa=!1):Ge("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ll="RemoteStore";class eR{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((o=>{n.enqueueAndForget((async()=>{xl(this)&&(Ge(ll,"Restarting streams for network reachability change."),await(async function(f){const h=mt(f);h.Ea.add(4),await Cf(h),h.Ra.set("Unknown"),h.Ea.delete(4),await pd(h)})(this))}))})),this.Ra=new ZF(n,s)}}async function pd(t){if(xl(t))for(const e of t.da)await e(!0)}async function Cf(t){for(const e of t.da)await e(!1)}function YE(t,e){const r=mt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Y1(r)?X1(r):Mc(r).O_()&&K1(r,e))}function q1(t,e){const r=mt(t),n=Mc(r);r.Ia.delete(e),n.O_()&&QE(r,e),r.Ia.size===0&&(n.O_()?n.L_():xl(r)&&r.Ra.set("Unknown"))}function K1(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(dt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Mc(t).Y_(e)}function QE(t,e){t.Va.Ue(e),Mc(t).Z_(e)}function X1(t){t.Va=new K3({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Mc(t).start(),t.Ra.ua()}function Y1(t){return xl(t)&&!Mc(t).x_()&&t.Ia.size>0}function xl(t){return mt(t).Ea.size===0}function JE(t){t.Va=void 0}async function tR(t){t.Ra.set("Online")}async function rR(t){t.Ia.forEach(((e,r)=>{K1(t,e)}))}async function nR(t,e){JE(t),Y1(t)?(t.Ra.ha(e),X1(t)):t.Ra.set("Unknown")}async function sR(t,e,r){if(t.Ra.set("Online"),e instanceof LE&&e.state===2&&e.cause)try{await(async function(s,i){const o=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.Va.removeTarget(c))})(t,e)}catch(n){Ge(ll,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await D0(t,n)}else if(e instanceof g0?t.Va.Ze(e):e instanceof OE?t.Va.st(e):t.Va.tt(e),!r.isEqual(dt.min()))try{const n=await qE(t.localStore);r.compareTo(n)>=0&&await(function(i,o){const c=i.Va.Tt(o);return c.targetChanges.forEach(((f,h)=>{if(f.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(f.resumeToken,o))}})),c.targetMismatches.forEach(((f,h)=>{const d=i.Ia.get(f);if(!d)return;i.Ia.set(f,d.withResumeToken(mn.EMPTY_BYTE_STRING,d.snapshotVersion)),QE(i,f);const g=new Za(d.target,f,h,d.sequenceNumber);K1(i,g)})),i.remoteSyncer.applyRemoteEvent(c)})(t,r)}catch(n){Ge(ll,"Failed to raise snapshot:",n),await D0(t,n)}}async function D0(t,e,r){if(!Oc(e))throw e;t.Ea.add(1),await Cf(t),t.Ra.set("Offline"),r||(r=()=>qE(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ge(ll,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await pd(t)}))}function ZE(t,e){return e().catch((r=>D0(t,r,e)))}async function md(t){const e=mt(t),r=fo(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:b1;for(;iR(e);)try{const s=await UF(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,aR(e,s)}catch(s){await D0(e,s)}eT(e)&&tT(e)}function iR(t){return xl(t)&&t.Ta.length<10}function aR(t,e){t.Ta.push(e);const r=fo(t);r.O_()&&r.X_&&r.ea(e.mutations)}function eT(t){return xl(t)&&!fo(t).x_()&&t.Ta.length>0}function tT(t){fo(t).start()}async function oR(t){fo(t).ra()}async function lR(t){const e=fo(t);for(const r of t.Ta)e.ea(r.mutations)}async function cR(t,e,r){const n=t.Ta.shift(),s=U1.from(n,e,r);await ZE(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await md(t)}async function uR(t,e){e&&fo(t).X_&&await(async function(n,s){if((function(o){return $3(o)&&o!==we.ABORTED})(s.code)){const i=n.Ta.shift();fo(n).B_(),await ZE(n,(()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s))),await md(n)}})(t,e),eT(t)&&tT(t)}async function Oy(t,e){const r=mt(t);r.asyncQueue.verifyOperationInProgress(),Ge(ll,"RemoteStore received new credentials");const n=xl(r);r.Ea.add(3),await Cf(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await pd(r)}async function fR(t,e){const r=mt(t);e?(r.Ea.delete(2),await pd(r)):e||(r.Ea.add(2),await Cf(r),r.Ra.set("Unknown"))}function Mc(t){return t.ma||(t.ma=(function(r,n,s){const i=mt(r);return i.sa(),new XF(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(t.datastore,t.asyncQueue,{Xo:tR.bind(null,t),t_:rR.bind(null,t),r_:nR.bind(null,t),H_:sR.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Y1(t)?X1(t):t.Ra.set("Unknown")):(await t.ma.stop(),JE(t))}))),t.ma}function fo(t){return t.fa||(t.fa=(function(r,n,s){const i=mt(r);return i.sa(),new YF(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:oR.bind(null,t),r_:uR.bind(null,t),ta:lR.bind(null,t),na:cR.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await md(t)):(await t.fa.stop(),t.Ta.length>0&&(Ge(ll,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new ca,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const o=Date.now()+n,c=new Q1(e,r,o,s,i);return c.start(n),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new He(we.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function J1(t,e){if(pa("AsyncQueue",`${e}: ${t}`),Oc(t))return new He(we.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{static emptySet(e){return new hc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||et.comparator(r.key,n.key):(r,n)=>et.comparator(r.key,n.key),this.keyedMap=Fu(),this.sortedSet=new yr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof hc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new hc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(){this.ga=new yr(et.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):at(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class Ac{constructor(e,r,n,s,i,o,c,f,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=f,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,s,i){const o=[];return r.forEach((c=>{o.push({type:0,doc:c})})),new Ac(e,r,hc.emptySet(r),o,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&od(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class dR{constructor(){this.queries=My(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=mt(r),i=s.queries;s.queries=My(),i.forEach(((o,c)=>{for(const f of c.Sa)f.onError(n)}))})(this,new He(we.ABORTED,"Firestore shutting down"))}}function My(){return new gl((t=>EE(t)),od)}async function Z1(t,e){const r=mt(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new hR,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(s,!0);break;case 1:i.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const c=J1(o,`Initialization of query '${ac(e.query)}' failed`);return void e.onError(c)}r.queries.set(s,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&tg(r)}async function eg(t,e){const r=mt(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function pR(t,e){const r=mt(t);let n=!1;for(const s of e){const i=s.query,o=r.queries.get(i);if(o){for(const c of o.Sa)c.Fa(s)&&(n=!0);o.wa=s}}n&&tg(r)}function mR(t,e,r){const n=mt(t),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(r);n.queries.delete(e)}function tg(t){t.Ca.forEach((e=>{e.next()}))}var r1,Vy;(Vy=r1||(r1={})).Ma="default",Vy.Cache="cache";class rg{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Ac(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Ac.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==r1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(e){this.key=e}}class nT{constructor(e){this.key=e}}class gR{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ct(),this.mutatedKeys=Ct(),this.eu=TE(e),this.tu=new hc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Ly,s=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,o=s,c=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,g)=>{const x=s.get(d),_=ld(this.query,g)?g:null,S=!!x&&this.mutatedKeys.has(x.key),y=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let T=!1;x&&_?x.data.isEqual(_.data)?S!==y&&(n.track({type:3,doc:_}),T=!0):this.su(x,_)||(n.track({type:2,doc:_}),T=!0,(f&&this.eu(_,f)>0||h&&this.eu(_,h)<0)&&(c=!0)):!x&&_?(n.track({type:0,doc:_}),T=!0):x&&!_&&(n.track({type:1,doc:x}),T=!0,(f||h)&&(c=!0)),T&&(_?(o=o.add(_),i=y?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),n.track({type:1,doc:d})}return{tu:o,iu:n,Cs:c,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((d,g)=>(function(_,S){const y=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return at(20277,{Rt:T})}};return y(_)-y(S)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(n),s=s??!1;const c=r&&!s?this._u():[],f=this.Xa.size===0&&this.current&&!s?1:0,h=f!==this.Za;return this.Za=f,o.length!==0||h?{snapshot:new Ac(this.query,e.tu,i,o,e.mutatedKeys,f===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Ly,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ct(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new nT(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new rT(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=Ct();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Ac.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ng="SyncEngine";class xR{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class vR{constructor(e){this.key=e,this.hu=!1}}class _R{constructor(e,r,n,s,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new gl((c=>EE(c)),od),this.Iu=new Map,this.Eu=new Set,this.du=new yr(et.comparator),this.Au=new Map,this.Ru=new W1,this.Vu={},this.mu=new Map,this.fu=kc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function yR(t,e,r=!0){const n=cT(t);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await sT(n,e,r,!0),s}async function wR(t,e){const r=cT(t);await sT(r,e,!0,!1)}async function sT(t,e,r,n){const s=await jF(t.localStore,bi(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let c;return n&&(c=await ER(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&YE(t.remoteStore,s),c}async function ER(t,e,r,n,s){t.pu=(g,x,_)=>(async function(y,T,R,O){let N=T.view.ru(R);N.Cs&&(N=await Ry(y.localStore,T.query,!1).then((({documents:k})=>T.view.ru(k,N))));const U=O&&O.targetChanges.get(T.targetId),X=O&&O.targetMismatches.get(T.targetId)!=null,G=T.view.applyChanges(N,y.isPrimaryClient,U,X);return Uy(y,T.targetId,G.au),G.snapshot})(t,g,x,_);const i=await Ry(t.localStore,e,!0),o=new gR(e,i.Qs),c=o.ru(i.documents),f=Af.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),h=o.applyChanges(c,t.isPrimaryClient,f);Uy(t,r,h.au);const d=new xR(e,r,o);return t.Tu.set(e,d),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function TR(t,e,r){const n=mt(t),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter((o=>!od(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await e1(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),r&&q1(n.remoteStore,s.targetId),n1(n,s.targetId)})).catch(bc)):(n1(n,s.targetId),await e1(n.localStore,s.targetId,!0))}async function SR(t,e){const r=mt(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),q1(r.remoteStore,n.targetId))}async function kR(t,e,r){const n=DR(t);try{const s=await(function(o,c){const f=mt(o),h=lr.now(),d=c.reduce(((_,S)=>_.add(S.key)),Ct());let g,x;return f.persistence.runTransaction("Locally write mutations","readwrite",(_=>{let S=ma(),y=Ct();return f.Ns.getEntries(_,d).next((T=>{S=T,S.forEach(((R,O)=>{O.isValidDocument()||(y=y.add(R))}))})).next((()=>f.localDocuments.getOverlayedDocuments(_,S))).next((T=>{g=T;const R=[];for(const O of c){const N=U3(O,g.get(O.key).overlayedDocument);N!=null&&R.push(new _o(O.key,N,pE(N.value.mapValue),Gn.exists(!0)))}return f.mutationQueue.addMutationBatch(_,h,R,c)})).next((T=>{x=T;const R=T.applyToLocalDocumentSet(g,y);return f.documentOverlayCache.saveOverlays(_,T.batchId,R)}))})).then((()=>({batchId:x.batchId,changes:kE(g)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),(function(o,c,f){let h=o.Vu[o.currentUser.toKey()];h||(h=new yr(At)),h=h.insert(c,f),o.Vu[o.currentUser.toKey()]=h})(n,s.batchId,r),await If(n,s.changes),await md(n.remoteStore)}catch(s){const i=J1(s,"Failed to persist write");r.reject(i)}}async function iT(t,e){const r=mt(t);try{const n=await VF(r.localStore,e);e.targetChanges.forEach(((s,i)=>{const o=r.Au.get(i);o&&(Wt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Wt(o.hu,14607):s.removedDocuments.size>0&&(Wt(o.hu,42227),o.hu=!1))})),await If(r,n,e)}catch(n){await bc(n)}}function By(t,e,r){const n=mt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach(((i,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(o,c){const f=mt(o);f.onlineState=c;let h=!1;f.queries.forEach(((d,g)=>{for(const x of g.Sa)x.va(c)&&(h=!0)})),h&&tg(f)})(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function AR(t,e,r){const n=mt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),i=s&&s.key;if(i){let o=new yr(et.comparator);o=o.insert(i,Nn.newNoDocument(i,dt.min()));const c=Ct().add(i),f=new hd(dt.min(),new Map,new yr(At),o,c);await iT(n,f),n.du=n.du.remove(i),n.Au.delete(e),sg(n)}else await e1(n.localStore,e,!1).then((()=>n1(n,e,r))).catch(bc)}async function CR(t,e){const r=mt(t),n=e.batch.batchId;try{const s=await MF(r.localStore,e);oT(r,n,null),aT(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await If(r,s)}catch(s){await bc(s)}}async function IR(t,e,r){const n=mt(t);try{const s=await(function(o,c){const f=mt(o);return f.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return f.mutationQueue.lookupMutationBatch(h,c).next((g=>(Wt(g!==null,37113),d=g.keys(),f.mutationQueue.removeMutationBatch(h,g)))).next((()=>f.mutationQueue.performConsistencyCheck(h))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(h,d,c))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>f.localDocuments.getDocuments(h,d)))}))})(n.localStore,e);oT(n,e,r),aT(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await If(n,s)}catch(s){await bc(s)}}function aT(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function oT(t,e,r){const n=mt(t);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function n1(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||lT(t,n)}))}function lT(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(q1(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),sg(t))}function Uy(t,e,r){for(const n of r)n instanceof rT?(t.Ru.addReference(n.key,e),FR(t,n)):n instanceof nT?(Ge(ng,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||lT(t,n.key)):at(19791,{wu:n})}function FR(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ge(ng,"New document in limbo: "+r),t.Eu.add(n),sg(t))}function sg(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new et(rr.fromString(e)),n=t.fu.next();t.Au.set(n,new vR(r)),t.du=t.du.insert(r,n),YE(t.remoteStore,new Za(bi(ad(r.path)),n,"TargetPurposeLimboResolution",nd.ce))}}async function If(t,e,r){const n=mt(t),s=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((c,f)=>{o.push(n.pu(f,e,r).then((h=>{var d;if((h||r)&&n.isPrimaryClient){const g=h?!h.fromCache:(d=r==null?void 0:r.targetChanges.get(f.targetId))==null?void 0:d.current;n.sharedClientState.updateQueryState(f.targetId,g?"current":"not-current")}if(h){s.push(h);const g=$1.As(f.targetId,h);i.push(g)}})))})),await Promise.all(o),n.Pu.H_(s),await(async function(f,h){const d=mt(f);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>Te.forEach(h,(x=>Te.forEach(x.Es,(_=>d.persistence.referenceDelegate.addReference(g,x.targetId,_))).next((()=>Te.forEach(x.ds,(_=>d.persistence.referenceDelegate.removeReference(g,x.targetId,_)))))))))}catch(g){if(!Oc(g))throw g;Ge(G1,"Failed to update sequence numbers: "+g)}for(const g of h){const x=g.targetId;if(!g.fromCache){const _=d.Ms.get(x),S=_.snapshotVersion,y=_.withLastLimboFreeSnapshotVersion(S);d.Ms=d.Ms.insert(x,y)}}})(n.localStore,i))}async function RR(t,e){const r=mt(t);if(!r.currentUser.isEqual(e)){Ge(ng,"User change. New user:",e.toKey());const n=await GE(r.localStore,e);r.currentUser=e,(function(i,o){i.mu.forEach((c=>{c.forEach((f=>{f.reject(new He(we.CANCELLED,o))}))})),i.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await If(r,n.Ls)}}function NR(t,e){const r=mt(t),n=r.Au.get(e);if(n&&n.hu)return Ct().add(n.key);{let s=Ct();const i=r.Iu.get(e);if(!i)return s;for(const o of i){const c=r.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function cT(t){const e=mt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=iT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=NR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=AR.bind(null,e),e.Pu.H_=pR.bind(null,e.eventManager),e.Pu.yu=mR.bind(null,e.eventManager),e}function DR(t){const e=mt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=CR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=IR.bind(null,e),e}class P0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=dd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return LF(this.persistence,new PF,e.initialUser,this.serializer)}Cu(e){return new $E(H1.mi,this.serializer)}Du(e){return new WF}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}P0.provider={build:()=>new P0};class PR extends P0{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Wt(this.persistence.referenceDelegate instanceof N0,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new vF(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?rs.withCacheSize(this.cacheSizeBytes):rs.DEFAULT;return new $E((n=>N0.mi(n,r)),this.serializer)}}class s1{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>By(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=RR.bind(null,this.syncEngine),await fR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new dR})()}createDatastore(e){const r=dd(e.databaseInfo.databaseId),n=(function(i){return new KF(i)})(e.databaseInfo);return(function(i,o,c,f){return new JF(i,o,c,f)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,s,i,o,c){return new eR(n,s,i,o,c)})(this.localStore,this.datastore,e.asyncQueue,(r=>By(this.syncEngine,r,0)),(function(){return Py.v()?new Py:new HF})())}createSyncEngine(e,r){return(function(s,i,o,c,f,h,d){const g=new _R(s,i,o,c,f,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await(async function(s){const i=mt(s);Ge(ll,"RemoteStore shutting down."),i.Ea.add(5),await Cf(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}s1.provider={build:()=>new s1};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):pa("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho="FirestoreClient";class bR{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=An.UNAUTHENTICATED,this.clientId=P1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async o=>{Ge(ho,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(Ge(ho,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ca;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=J1(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function mm(t,e){t.asyncQueue.verifyOperationInProgress(),Ge(ho,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async s=>{n.isEqual(s)||(await GE(e.localStore,s),n=s)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function jy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await OR(t);Ge(ho,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>Oy(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,s)=>Oy(e.remoteStore,s))),t._onlineComponents=e}async function OR(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ge(ho,"Using user provided OfflineComponentProvider");try{await mm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(s){return s.name==="FirebaseError"?s.code===we.FAILED_PRECONDITION||s.code===we.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(r))throw r;wc("Error using user provided cache. Falling back to memory cache: "+r),await mm(t,new P0)}}else Ge(ho,"Using default OfflineComponentProvider"),await mm(t,new PR(void 0));return t._offlineComponents}async function uT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ge(ho,"Using user provided OnlineComponentProvider"),await jy(t,t._uninitializedComponentsProvider._online)):(Ge(ho,"Using default OnlineComponentProvider"),await jy(t,new s1))),t._onlineComponents}function LR(t){return uT(t).then((e=>e.syncEngine))}async function b0(t){const e=await uT(t),r=e.eventManager;return r.onListen=yR.bind(null,e.syncEngine),r.onUnlisten=TR.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=wR.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=SR.bind(null,e.syncEngine),r}function MR(t,e,r={}){const n=new ca;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,c,f,h){const d=new ig({next:x=>{d.Nu(),o.enqueueAndForget((()=>eg(i,g)));const _=x.docs.has(c);!_&&x.fromCache?h.reject(new He(we.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&x.fromCache&&f&&f.source==="server"?h.reject(new He(we.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(x)},error:x=>h.reject(x)}),g=new rg(ad(c.path),d,{includeMetadataChanges:!0,qa:!0});return Z1(i,g)})(await b0(t),t.asyncQueue,e,r,n))),n.promise}function VR(t,e,r={}){const n=new ca;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,c,f,h){const d=new ig({next:x=>{d.Nu(),o.enqueueAndForget((()=>eg(i,g))),x.fromCache&&f.source==="server"?h.reject(new He(we.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(x)},error:x=>h.reject(x)}),g=new rg(c,d,{includeMetadataChanges:!0,qa:!0});return Z1(i,g)})(await b0(t),t.asyncQueue,e,r,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT="firestore.googleapis.com",Wy=!0;class Hy{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new He(we.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hT,this.ssl=Wy}else this.host=e.host,this.ssl=e.ssl??Wy;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=HE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<gF)throw new He(we.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ZI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fT(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new He(we.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new He(we.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new He(we.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gd{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Hy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new He(we.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new He(we.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Hy(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new WI;switch(n.type){case"firstParty":return new qI(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new He(we.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=zy.get(r);n&&(Ge("ComponentProvider","Removing Datastore"),zy.delete(r),n.terminate())})(this),Promise.resolve()}}function BR(t,e,r,n={}){var h;t=$n(t,gd);const s=Nc(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;s&&(jw(`https://${c}`),zw("Firestore",!0)),i.host!==hT&&i.host!==c&&wc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...i,host:c,ssl:s,emulatorOptions:n};if(!il(f,o)&&(t._setSettings(f),n.mockUserToken)){let d,g;if(typeof n.mockUserToken=="string")d=n.mockUserToken,g=An.MOCK_USER;else{d=pC(n.mockUserToken,(h=t._app)==null?void 0:h.options.projectId);const x=n.mockUserToken.sub||n.mockUserToken.user_id;if(!x)throw new He(we.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new An(x)}t._authCredentials=new HI(new rE(d,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new yo(this.firestore,e,this._query)}}class Tr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ao(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tr(this.firestore,e,this._key)}toJSON(){return{type:Tr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Sf(r,Tr._jsonSchema))return new Tr(e,n||null,new et(rr.fromString(r.referencePath)))}}Tr._jsonSchemaVersion="firestore/documentReference/1.0",Tr._jsonSchema={type:jr("string",Tr._jsonSchemaVersion),referencePath:jr("string")};class ao extends yo{constructor(e,r,n){super(e,r,ad(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tr(this.firestore,null,new et(e))}withConverter(e){return new ao(this.firestore,e,this._path)}}function Yo(t,e,...r){if(t=zr(t),nE("collection","path",e),t instanceof gd){const n=rr.fromString(e,...r);return ny(n),new ao(t,null,n)}{if(!(t instanceof Tr||t instanceof ao))throw new He(we.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(rr.fromString(e,...r));return ny(n),new ao(t.firestore,null,n)}}function Fn(t,e,...r){if(t=zr(t),arguments.length===1&&(e=P1.newId()),nE("doc","path",e),t instanceof gd){const n=rr.fromString(e,...r);return ry(n),new Tr(t,null,new et(n))}{if(!(t instanceof Tr||t instanceof ao))throw new He(we.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(rr.fromString(e,...r));return ry(n),new Tr(t.firestore,t instanceof ao?t.converter:null,new et(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y="AsyncQueue";class Gy{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new KE(this,"async_queue_retry"),this._c=()=>{const n=pm();n&&Ge($y,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=pm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=pm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new ca;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Oc(e))throw e;Ge($y,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,pa("INTERNAL UNHANDLED ERROR: ",qy(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=Q1.createAndSchedule(this,e,r,n,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&at(47125,{Pc:qy(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function qy(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ky(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1})(t,["next","error","complete"])}class Ui extends gd{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new Gy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Gy(e),this._firestoreClient=void 0,await e}}}function UR(t,e){const r=typeof t=="object"?t:Gw(),n=typeof t=="string"?t:A0,s=N1(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=hC("firestore");i&&BR(s,...i)}return s}function Ff(t){if(t._terminated)throw new He(we.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||jR(t),t._firestoreClient}function jR(t){var n,s,i;const e=t._freezeSettings(),r=(function(c,f,h,d){return new u3(c,f,h,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,fT(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)})(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new bR(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(c){const f=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(f),_online:f}})(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bs(mn.fromBase64String(e))}catch(r){throw new He(we.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Bs(mn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Bs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Sf(e,Bs._jsonSchema))return Bs.fromBase64String(e.bytes)}}Bs._jsonSchemaVersion="firestore/bytes/1.0",Bs._jsonSchema={type:jr("string",Bs._jsonSchemaVersion),bytes:jr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new He(we.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new He(we.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new He(we.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return At(this._lat,e._lat)||At(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Li._jsonSchemaVersion}}static fromJSON(e){if(Sf(e,Li._jsonSchema))return new Li(e.latitude,e.longitude)}}Li._jsonSchemaVersion="firestore/geoPoint/1.0",Li._jsonSchema={type:jr("string",Li._jsonSchemaVersion),latitude:jr("number"),longitude:jr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Mi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Sf(e,Mi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new Mi(e.vectorValues);throw new He(we.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Mi._jsonSchemaVersion="firestore/vectorValue/1.0",Mi._jsonSchema={type:jr("string",Mi._jsonSchemaVersion),vectorValues:jr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR=/^__.*__$/;class WR{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new _o(e,this.data,this.fieldMask,r,this.fieldTransforms):new kf(e,this.data,r,this.fieldTransforms)}}class dT{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new _o(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function pT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw at(40011,{Ac:t})}}class ag{constructor(e,r,n,s,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ag({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return O0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(pT(this.Ac)&&zR.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class HR{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||dd(e)}Cc(e,r,n,s=!1){return new ag({Ac:e,methodName:r,Dc:n,path:dn.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Nf(t){const e=t._freezeSettings(),r=dd(t._databaseId);return new HR(t._databaseId,!!e.ignoreUndefinedProperties,r)}function og(t,e,r,n,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,r,s);cg("Data must be an object, but it was:",o,n);const c=xT(n,o);let f,h;if(i.merge)f=new ws(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const g of i.mergeFields){const x=i1(e,g,r);if(!o.contains(x))throw new He(we.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);_T(d,x)||d.push(x)}f=new ws(d),h=o.fieldTransforms.filter((g=>f.covers(g.field)))}else f=null,h=o.fieldTransforms;return new WR(new ns(c),f,h)}class vd extends xd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof vd}}class lg extends xd{_toFieldTransform(e){return new L3(e.path,new rf)}isEqual(e){return e instanceof lg}}function mT(t,e,r,n){const s=t.Cc(1,e,r);cg("Data must be an object, but it was:",s,n);const i=[],o=ns.empty();vo(n,((f,h)=>{const d=ug(e,f,r);h=zr(h);const g=s.yc(d);if(h instanceof vd)i.push(d);else{const x=Df(h,g);x!=null&&(i.push(d),o.set(d,x))}}));const c=new ws(i);return new dT(o,c,s.fieldTransforms)}function gT(t,e,r,n,s,i){const o=t.Cc(1,e,r),c=[i1(e,n,r)],f=[s];if(i.length%2!=0)throw new He(we.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<i.length;x+=2)c.push(i1(e,i[x])),f.push(i[x+1]);const h=[],d=ns.empty();for(let x=c.length-1;x>=0;--x)if(!_T(h,c[x])){const _=c[x];let S=f[x];S=zr(S);const y=o.yc(_);if(S instanceof vd)h.push(_);else{const T=Df(S,y);T!=null&&(h.push(_),d.set(_,T))}}const g=new ws(h);return new dT(d,g,o.fieldTransforms)}function $R(t,e,r,n=!1){return Df(r,t.Cc(n?4:3,e))}function Df(t,e){if(vT(t=zr(t)))return cg("Unsupported field value:",e,t),xT(t,e);if(t instanceof xd)return(function(n,s){if(!pT(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,s){const i=[];let o=0;for(const c of n){let f=Df(c,s.wc(o));f==null&&(f={nullValue:"NULL_VALUE"}),i.push(f),o++}return{arrayValue:{values:i}}})(t,e)}return(function(n,s){if((n=zr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return P3(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=lr.fromDate(n);return{timestampValue:R0(s.serializer,i)}}if(n instanceof lr){const i=new lr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:R0(s.serializer,i)}}if(n instanceof Li)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Bs)return{bytesValue:ME(s.serializer,n._byteString)};if(n instanceof Tr){const i=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:z1(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Mi)return(function(o,c){return{mapValue:{fields:{[hE]:{stringValue:dE},[C0]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return B1(c.serializer,h)}))}}}}}})(n,s);throw s.Sc(`Unsupported field value: ${rd(n)}`)})(t,e)}function xT(t,e){const r={};return aE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vo(t,((n,s)=>{const i=Df(s,e.mc(n));i!=null&&(r[n]=i)})),{mapValue:{fields:r}}}function vT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof lr||t instanceof Li||t instanceof Bs||t instanceof Tr||t instanceof xd||t instanceof Mi)}function cg(t,e,r){if(!vT(r)||!sE(r)){const n=rd(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function i1(t,e,r){if((e=zr(e))instanceof Rf)return e._internalPath;if(typeof e=="string")return ug(t,e);throw O0("Field path arguments must be of type string or ",t,!1,void 0,r)}const GR=new RegExp("[~\\*/\\[\\]]");function ug(t,e,r){if(e.search(GR)>=0)throw O0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Rf(...e.split("."))._internalPath}catch{throw O0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function O0(t,e,r,n,s){const i=n&&!n.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let f="";return(i||o)&&(f+=" (found",i&&(f+=` in field ${n}`),o&&(f+=` in document ${s}`),f+=")"),new He(we.INVALID_ARGUMENT,c+t+f)}function _T(t,e){return t.some((r=>r.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Tr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new qR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(fg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class qR extends yT{data(){return super.data()}}function fg(t,e){return typeof e=="string"?ug(t,e):e instanceof Rf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new He(we.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hg{}class ET extends hg{}function KR(t,e,...r){let n=[];e instanceof hg&&n.push(e),n=n.concat(r),(function(i){const o=i.filter((f=>f instanceof pg)).length,c=i.filter((f=>f instanceof dg)).length;if(o>1||o>0&&c>0)throw new He(we.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const s of n)t=s._apply(t);return t}class dg extends ET{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new dg(e,r,n)}_apply(e){const r=this._parse(e);return TT(e._query,r),new yo(e.firestore,e.converter,Km(e._query,r))}_parse(e){const r=Nf(e.firestore);return(function(i,o,c,f,h,d,g){let x;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new He(we.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Yy(g,d);const S=[];for(const y of g)S.push(Xy(f,i,y));x={arrayValue:{values:S}}}else x=Xy(f,i,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Yy(g,d),x=$R(c,o,g,d==="in"||d==="not-in");return Ur.create(h,d,x)})(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class pg extends hg{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new pg(e,r)}_parse(e){const r=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return r.length===1?r[0]:ci.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:((function(s,i){let o=s;const c=i.getFlattenedFilters();for(const f of c)TT(o,f),o=Km(o,f)})(e._query,r),new yo(e.firestore,e.converter,Km(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class mg extends ET{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new mg(e,r)}_apply(e){const r=(function(s,i,o){if(s.startAt!==null)throw new He(we.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new He(we.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new tf(i,o)})(e._query,this._field,this._direction);return new yo(e.firestore,e.converter,(function(s,i){const o=s.explicitOrderBy.concat([i]);return new Lc(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,r))}}function XR(t,e="asc"){const r=e,n=fg("orderBy",t);return mg._create(n,r)}function Xy(t,e,r){if(typeof(r=zr(r))=="string"){if(r==="")throw new He(we.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wE(e)&&r.indexOf("/")!==-1)throw new He(we.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(rr.fromString(r));if(!et.isDocumentKey(n))throw new He(we.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return fy(t,new et(n))}if(r instanceof Tr)return fy(t,r._key);throw new He(we.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rd(r)}.`)}function Yy(t,e){if(!Array.isArray(t)||t.length===0)throw new He(we.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function TT(t,e){const r=(function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null})(t.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(r!==null)throw r===e.op?new He(we.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new He(we.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class YR{convertValue(e,r="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Rr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(co(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw at(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return vo(e,((s,i)=>{n[s]=this.convertValue(i,r)})),n}convertVectorValue(e){var n,s,i;const r=(i=(s=(n=e.fields)==null?void 0:n[C0].arrayValue)==null?void 0:s.values)==null?void 0:i.map((o=>Rr(o.doubleValue)));return new Mi(r)}convertGeoPoint(e){return new Li(Rr(e.latitude),Rr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=id(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Ju(e));default:return null}}convertTimestamp(e){const r=lo(e);return new lr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=rr.fromString(e);Wt(WE(n),9688,{name:e});const s=new Zu(n.get(1),n.get(3)),i=new et(n.popFirst(5));return s.isEqual(r)||pa(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Nu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qo extends yT{constructor(e,r,n,s,i,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new x0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(fg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new He(we.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Qo._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Qo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qo._jsonSchema={type:jr("string",Qo._jsonSchemaVersion),bundleSource:jr("string","DocumentSnapshot"),bundleName:jr("string"),bundle:jr("string")};class x0 extends Qo{data(e={}){return super.data(e)}}class Jo{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Nu(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new x0(this._firestore,this._userDataWriter,n.key,n,new Nu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new He(we.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((c=>{const f=new x0(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Nu(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:f,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const f=new x0(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Nu(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),d=o.indexOf(c.doc.key)),{type:QR(c.type),doc:f,oldIndex:h,newIndex:d}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new He(we.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Jo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=P1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function QR(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return at(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a1(t){t=$n(t,Tr);const e=$n(t.firestore,Ui);return MR(Ff(e),t._key).then((r=>kT(e,t,r)))}Jo._jsonSchemaVersion="firestore/querySnapshot/1.0",Jo._jsonSchema={type:jr("string",Jo._jsonSchemaVersion),bundleSource:jr("string","QuerySnapshot"),bundleName:jr("string"),bundle:jr("string")};class xg extends YR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bs(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Tr(this.firestore,null,r)}}function ST(t){t=$n(t,yo);const e=$n(t.firestore,Ui),r=Ff(e),n=new xg(e);return wT(t._query),VR(r,t._query).then((s=>new Jo(e,n,t,s)))}function ui(t,e,r){t=$n(t,Tr);const n=$n(t.firestore,Ui),s=gg(t.converter,e,r);return Pf(n,[og(Nf(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,Gn.none())])}function Zh(t,e,r,...n){t=$n(t,Tr);const s=$n(t.firestore,Ui),i=Nf(s);let o;return o=typeof(e=zr(e))=="string"||e instanceof Rf?gT(i,"updateDoc",t._key,e,r,n):mT(i,"updateDoc",t._key,e),Pf(s,[o.toMutation(t._key,Gn.exists(!0))])}function Vc(t){return Pf($n(t.firestore,Ui),[new fd(t._key,Gn.none())])}function JR(t,e){const r=$n(t.firestore,Ui),n=Fn(t),s=gg(t.converter,e);return Pf(r,[og(Nf(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Gn.exists(!1))]).then((()=>n))}function vl(t,...e){var f,h,d;t=zr(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||Ky(e[n])||(r=e[n++]);const s={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(Ky(e[n])){const g=e[n];e[n]=(f=g.next)==null?void 0:f.bind(g),e[n+1]=(h=g.error)==null?void 0:h.bind(g),e[n+2]=(d=g.complete)==null?void 0:d.bind(g)}let i,o,c;if(t instanceof Tr)o=$n(t.firestore,Ui),c=ad(t._key.path),i={next:g=>{e[n]&&e[n](kT(o,t,g))},error:e[n+1],complete:e[n+2]};else{const g=$n(t,yo);o=$n(g.firestore,Ui),c=g._query;const x=new xg(o);i={next:_=>{e[n]&&e[n](new Jo(o,x,g,_))},error:e[n+1],complete:e[n+2]},wT(t._query)}return(function(x,_,S,y){const T=new ig(y),R=new rg(_,T,S);return x.asyncQueue.enqueueAndForget((async()=>Z1(await b0(x),R))),()=>{T.Nu(),x.asyncQueue.enqueueAndForget((async()=>eg(await b0(x),R)))}})(Ff(o),c,s,i)}function Pf(t,e){return(function(n,s){const i=new ca;return n.asyncQueue.enqueueAndForget((async()=>kR(await LR(n),s,i))),i.promise})(Ff(t),e)}function kT(t,e,r){const n=r.docs.get(e._key),s=new xg(t);return new Qo(t,s,e._key,n,new Nu(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Nf(e)}set(e,r,n){this._verifyNotCommitted();const s=gm(e,this._firestore),i=gg(s.converter,r,n),o=og(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(o.toMutation(s._key,Gn.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=gm(e,this._firestore);let o;return o=typeof(r=zr(r))=="string"||r instanceof Rf?gT(this._dataReader,"WriteBatch.update",i._key,r,n,s):mT(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,Gn.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=gm(e,this._firestore);return this._mutations=this._mutations.concat(new fd(r._key,Gn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new He(we.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function gm(t,e){if((t=zr(t)).firestore!==e)throw new He(we.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function xr(){return new lg("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xm(t){return Ff(t=$n(t,Ui)),new ZR(t,(e=>Pf(t,e)))}(function(e,r=!0){(function(s){Pc=s})(Dc),yc(new al("firestore",((n,{instanceIdentifier:s,options:i})=>{const o=n.getProvider("app").getImmediate(),c=new Ui(new $I(n.getProvider("auth-internal")),new KI(o,n.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new He(we.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zu(h.options.projectId,d)})(o,s),o);return i={useFetchStreams:r,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),so(J_,Z_,e),so(J_,Z_,"esm2020")})();function AT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const e6=AT,CT=new Ef("auth","Firebase",AT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0=new F1("@firebase/auth");function t6(t,...e){L0.logLevel<=kt.WARN&&L0.warn(`Auth (${Dc}): ${t}`,...e)}function v0(t,...e){L0.logLevel<=kt.ERROR&&L0.error(`Auth (${Dc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ji(t,...e){throw _g(t,...e)}function ai(t,...e){return _g(t,...e)}function vg(t,e,r){const n={...e6(),[e]:r};return new Ef("auth","Firebase",n).create(e,{appName:t.name})}function Zo(t){return vg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function r6(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&ji(t,"argument-error"),vg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function _g(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return CT.create(t,...e)}function ft(t,e,...r){if(!t)throw _g(e,...r)}function aa(t){const e="INTERNAL ASSERTION FAILED: "+t;throw v0(e),new Error(e)}function ga(t,e){t||aa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o1(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function n6(){return Qy()==="http:"||Qy()==="https:"}function Qy(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(n6()||yC()||"connection"in navigator)?navigator.onLine:!0}function i6(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e,r){this.shortDelay=e,this.longDelay=r,ga(r>e,"Short delay should be less than long delay!"),this.isMobile=xC()||wC()}get(){return s6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(t,e){ga(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;aa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;aa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;aa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],l6=new bf(3e4,6e4);function wg(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Bc(t,e,r,n,s={}){return FT(t,s,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const c=Tf({key:t.config.apiKey,...o}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:f,...i};return _C()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&Nc(t.emulatorConfig.host)&&(h.credentials="include"),IT.fetch()(await RT(t,t.config.apiHost,r,c),h)})}async function FT(t,e,r){t._canInitEmulator=!1;const n={...a6,...e};try{const s=new u6(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw e0(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[f,h]=c.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw e0(t,"credential-already-in-use",o);if(f==="EMAIL_EXISTS")throw e0(t,"email-already-in-use",o);if(f==="USER_DISABLED")throw e0(t,"user-disabled",o);const d=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw vg(t,d,h);ji(t,d)}}catch(s){if(s instanceof _a)throw s;ji(t,"network-request-failed",{message:String(s)})}}async function c6(t,e,r,n,s={}){const i=await Bc(t,e,r,n,s);return"mfaPendingCredential"in i&&ji(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function RT(t,e,r,n){const s=`${e}${r}?${n}`,i=t,o=i.config.emulator?yg(t.config,s):`${t.config.apiScheme}://${s}`;return o6.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class u6{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ai(this.auth,"network-request-failed")),l6.get())})}}function e0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=ai(t,e,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f6(t,e){return Bc(t,"POST","/v1/accounts:delete",e)}async function M0(t,e){return Bc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function h6(t,e=!1){const r=zr(t),n=await r.getIdToken(e),s=Eg(n);ft(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Uu(vm(s.auth_time)),issuedAtTime:Uu(vm(s.iat)),expirationTime:Uu(vm(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function vm(t){return Number(t)*1e3}function Eg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return v0("JWT malformed, contained fewer than 3 sections"),null;try{const s=Mw(r);return s?JSON.parse(s):(v0("Failed to decode base64 JWT payload"),null)}catch(s){return v0("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Jy(t){const e=Eg(t);return ft(e,"internal-error"),ft(typeof e.exp<"u","internal-error"),ft(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function af(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof _a&&d6(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function d6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Uu(this.lastLoginAt),this.creationTime=Uu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V0(t){var g;const e=t.auth,r=await t.getIdToken(),n=await af(t,M0(e,{idToken:r}));ft(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const i=(g=s.providerUserInfo)!=null&&g.length?NT(s.providerUserInfo):[],o=g6(t.providerData,i),c=t.isAnonymous,f=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),h=c?f:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new l1(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,d)}async function m6(t){const e=zr(t);await V0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function g6(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function NT(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x6(t,e){const r=await FT(t,{},async()=>{const n=Tf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await RT(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:c,body:n};return t.emulatorConfig&&Nc(t.emulatorConfig.host)&&(f.credentials="include"),IT.fetch()(o,f)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function v6(t,e){return Bc(t,"POST","/v2/accounts:revokeToken",wg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ft(e.idToken,"internal-error"),ft(typeof e.idToken<"u","internal-error"),ft(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Jy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ft(e.length!==0,"internal-error");const r=Jy(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ft(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await x6(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,o=new dc;return n&&(ft(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(ft(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ft(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dc,this.toJSON())}_performRefresh(){return aa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qa(t,e){ft(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ni{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new p6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new l1(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await af(this,this.stsTokenManager.getToken(this.auth,e));return ft(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return h6(this,e)}reload(){return m6(this)}_assign(e){this!==e&&(ft(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ni({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await V0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ri(this.auth.app))return Promise.reject(Zo(this.auth));const e=await this.getIdToken();return await af(this,f6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,i=r.phoneNumber??void 0,o=r.photoURL??void 0,c=r.tenantId??void 0,f=r._redirectEventId??void 0,h=r.createdAt??void 0,d=r.lastLoginAt??void 0,{uid:g,emailVerified:x,isAnonymous:_,providerData:S,stsTokenManager:y}=r;ft(g&&y,e,"internal-error");const T=dc.fromJSON(this.name,y);ft(typeof g=="string",e,"internal-error"),qa(n,e.name),qa(s,e.name),ft(typeof x=="boolean",e,"internal-error"),ft(typeof _=="boolean",e,"internal-error"),qa(i,e.name),qa(o,e.name),qa(c,e.name),qa(f,e.name),qa(h,e.name),qa(d,e.name);const R=new ni({uid:g,auth:e,email:s,emailVerified:x,displayName:n,isAnonymous:_,photoURL:o,phoneNumber:i,tenantId:c,stsTokenManager:T,createdAt:h,lastLoginAt:d});return S&&Array.isArray(S)&&(R.providerData=S.map(O=>({...O}))),f&&(R._redirectEventId=f),R}static async _fromIdTokenResponse(e,r,n=!1){const s=new dc;s.updateFromServerResponse(r);const i=new ni({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await V0(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];ft(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?NT(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new dc;c.updateFromIdToken(n);const f=new ni({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new l1(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(f,h),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zy=new Map;function oa(t){ga(t instanceof Function,"Expected a class definition");let e=Zy.get(t);return e?(ga(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Zy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}DT.type="NONE";const e2=DT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(t,e,r){return`firebase:${t}:${e}:${r}`}class pc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=_0(this.userKey,s.apiKey,i),this.fullPersistenceKey=_0("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await M0(this.auth,{idToken:e}).catch(()=>{});return r?ni._fromGetAccountInfoResponse(this.auth,r,e):null}return ni._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new pc(oa(e2),e,n);const s=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||oa(e2);const o=_0(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const d=await h._get(o);if(d){let g;if(typeof d=="string"){const x=await M0(e,{idToken:d}).catch(()=>{});if(!x)break;g=await ni._fromGetAccountInfoResponse(e,x,d)}else g=ni._fromJSON(e,d);h!==i&&(c=g),i=h;break}}catch{}const f=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!f.length?new pc(i,e,n):(i=f[0],c&&await i._set(o,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new pc(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(LT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(PT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(VT(e))return"Blackberry";if(BT(e))return"Webos";if(bT(e))return"Safari";if((e.includes("chrome/")||OT(e))&&!e.includes("edge/"))return"Chrome";if(MT(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function PT(t=On()){return/firefox\//i.test(t)}function bT(t=On()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function OT(t=On()){return/crios\//i.test(t)}function LT(t=On()){return/iemobile/i.test(t)}function MT(t=On()){return/android/i.test(t)}function VT(t=On()){return/blackberry/i.test(t)}function BT(t=On()){return/webos/i.test(t)}function Tg(t=On()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function _6(t=On()){var e;return Tg(t)&&!!((e=window.navigator)!=null&&e.standalone)}function y6(){return EC()&&document.documentMode===10}function UT(t=On()){return Tg(t)||MT(t)||BT(t)||VT(t)||/windows phone/i.test(t)||LT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(t,e=[]){let r;switch(t){case"Browser":r=t2(On());break;case"Worker":r=`${t2(On())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Dc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,c)=>{try{const f=e(i);o(f)}catch(f){c(f)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E6(t,e={}){return Bc(t,"GET","/v2/passwordPolicy",wg(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T6=6;class S6{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??T6,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new r2(this),this.idTokenSubscription=new r2(this),this.beforeStateQueue=new w6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=CT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=oa(r)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await pc.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await M0(this,{idToken:e}),n=await ni._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(ri(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=n==null?void 0:n._redirectEventId,f=await this.tryRedirectSignIn(e);(!o||o===c)&&(f!=null&&f.user)&&(n=f.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await V0(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=i6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ri(this.app))return Promise.reject(Zo(this));const r=e?zr(e):null;return r&&ft(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ft(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ri(this.app)?Promise.reject(Zo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ri(this.app)?Promise.reject(Zo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(oa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await E6(this),r=new S6(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ef("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await v6(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&oa(e)||this._popupRedirectResolver;ft(r,this,"argument-error"),this.redirectPersistenceManager=await pc.create(this,[oa(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(ft(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const f=e.addObserver(r,n,s);return()=>{o=!0,f()}}else{const f=e.addObserver(r);return()=>{o=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(ri(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&t6(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function _d(t){return zr(t)}class r2{constructor(e){this.auth=e,this.observer=null,this.addObserver=RC(r=>this.observer=r)}get next(){return ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function A6(t){Sg=t}function C6(t){return Sg.loadJS(t)}function I6(){return Sg.gapiScript}function F6(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R6(t,e){const r=N1(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(il(i,e??{}))return s;ji(s,"already-initialized")}return r.initialize({options:e})}function N6(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(oa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function D6(t,e,r){const n=_d(t);ft(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=zT(e),{host:o,port:c}=P6(e),f=c===null?"":`:${c}`,h={url:`${i}//${o}${f}/`},d=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){ft(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ft(il(h,n.config.emulator)&&il(d,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=d,n.settings.appVerificationDisabledForTesting=!0,Nc(o)?(jw(`${i}//${o}${f}`),zw("Auth",!0)):b6()}function zT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function P6(t){const e=zT(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:n2(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:n2(o)}}}function n2(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function b6(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return aa("not implemented")}_getIdTokenResponse(e){return aa("not implemented")}_linkToIdToken(e,r){return aa("not implemented")}_getReauthenticationResolver(e){return aa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mc(t,e){return c6(t,"POST","/v1/accounts:signInWithIdp",wg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O6="http://localhost";class cl extends WT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new cl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ji("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=r;if(!n||!s)return null;const o=new cl(n,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return mc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,mc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,mc(e,r)}buildRequest(){const e={requestUri:O6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Tf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of extends kg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya extends Of{constructor(){super("facebook.com")}static credential(e){return cl._fromParams({providerId:Ya.PROVIDER_ID,signInMethod:Ya.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ya.credentialFromTaggedObject(e)}static credentialFromError(e){return Ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ya.credential(e.oauthAccessToken)}catch{return null}}}Ya.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ya.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia extends Of{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return cl._fromParams({providerId:ia.PROVIDER_ID,signInMethod:ia.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return ia.credentialFromTaggedObject(e)}static credentialFromError(e){return ia.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return ia.credential(r,n)}catch{return null}}}ia.GOOGLE_SIGN_IN_METHOD="google.com";ia.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa extends Of{constructor(){super("github.com")}static credential(e){return cl._fromParams({providerId:Qa.PROVIDER_ID,signInMethod:Qa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qa.credentialFromTaggedObject(e)}static credentialFromError(e){return Qa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qa.credential(e.oauthAccessToken)}catch{return null}}}Qa.GITHUB_SIGN_IN_METHOD="github.com";Qa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja extends Of{constructor(){super("twitter.com")}static credential(e,r){return cl._fromParams({providerId:Ja.PROVIDER_ID,signInMethod:Ja.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Ja.credentialFromTaggedObject(e)}static credentialFromError(e){return Ja.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Ja.credential(r,n)}catch{return null}}}Ja.TWITTER_SIGN_IN_METHOD="twitter.com";Ja.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await ni._fromIdTokenResponse(e,n,s),o=s2(n);return new Cc({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=s2(n);return new Cc({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function s2(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0 extends _a{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,B0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new B0(e,r,n,s)}}function HT(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?B0._fromErrorAndOperation(t,i,e,n):i})}async function L6(t,e,r=!1){const n=await af(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Cc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M6(t,e,r=!1){const{auth:n}=t;if(ri(n.app))return Promise.reject(Zo(n));const s="reauthenticate";try{const i=await af(t,HT(n,s,e,t),r);ft(i.idToken,n,"internal-error");const o=Eg(i.idToken);ft(o,n,"internal-error");const{sub:c}=o;return ft(t.uid===c,n,"user-mismatch"),Cc._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ji(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V6(t,e,r=!1){if(ri(t.app))return Promise.reject(Zo(t));const n="signIn",s=await HT(t,n,e),i=await Cc._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}function B6(t,e,r,n){return zr(t).onIdTokenChanged(e,r,n)}function U6(t,e,r){return zr(t).beforeAuthStateChanged(e,r)}function j6(t,e,r,n){return zr(t).onAuthStateChanged(e,r,n)}function z6(t){return zr(t).signOut()}const U0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(U0,"1"),this.storage.removeItem(U0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W6=1e3,H6=10;class GT extends $T{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=UT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,c,f)=>{this.notifyListeners(o,f)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);y6()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,H6):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},W6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}GT.type="LOCAL";const $6=GT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT extends $T{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}qT.type="SESSION";const KT=qT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G6(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new yd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(o).map(async h=>h(r.origin,i)),f=await G6(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:f})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}yd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ag(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,f)=>{const h=Ag("",20);s.port1.start();const d=setTimeout(()=>{f(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(g){const x=g;if(x.data.eventId===h)switch(x.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(x.data.response);break;default:clearTimeout(d),clearTimeout(i),f(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vi(){return window}function K6(t){Vi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XT(){return typeof Vi().WorkerGlobalScope<"u"&&typeof Vi().importScripts=="function"}async function X6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Y6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Q6(){return XT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT="firebaseLocalStorageDb",J6=1,j0="firebaseLocalStorage",QT="fbase_key";class Lf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function wd(t,e){return t.transaction([j0],e?"readwrite":"readonly").objectStore(j0)}function Z6(){const t=indexedDB.deleteDatabase(YT);return new Lf(t).toPromise()}function c1(){const t=indexedDB.open(YT,J6);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(j0,{keyPath:QT})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(j0)?e(n):(n.close(),await Z6(),e(await c1()))})})}async function i2(t,e,r){const n=wd(t,!0).put({[QT]:e,value:r});return new Lf(n).toPromise()}async function eN(t,e){const r=wd(t,!1).get(e),n=await new Lf(r).toPromise();return n===void 0?null:n.value}function a2(t,e){const r=wd(t,!0).delete(e);return new Lf(r).toPromise()}const tN=800,rN=3;class JT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await c1(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>rN)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return XT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yd._getInstance(Q6()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await X6(),!this.activeServiceWorker)return;this.sender=new q6(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Y6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await c1();return await i2(e,U0,"1"),await a2(e,U0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>i2(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>eN(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>a2(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=wd(s,!1).getAll();return new Lf(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),tN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}JT.type="LOCAL";const nN=JT;new bf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t,e){return e?oa(e):(ft(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg extends WT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return mc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return mc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function sN(t){return V6(t.auth,new Cg(t),t.bypassAuthState)}function iN(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),M6(r,new Cg(t),t.bypassAuthState)}async function aN(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),L6(r,new Cg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const f={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(f))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sN;case"linkViaPopup":case"linkViaRedirect":return aN;case"reauthViaPopup":case"reauthViaRedirect":return iN;default:ji(this.auth,"internal-error")}}resolve(e){ga(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ga(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oN=new bf(2e3,1e4);async function lN(t,e,r){if(ri(t.app))return Promise.reject(ai(t,"operation-not-supported-in-this-environment"));const n=_d(t);r6(t,e,kg);const s=ZT(n,r);return new Ko(n,"signInViaPopup",e,s).executeNotNull()}class Ko extends eS{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Ko.currentPopupAction&&Ko.currentPopupAction.cancel(),Ko.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ft(e,this.auth,"internal-error"),e}async onExecution(){ga(this.filter.length===1,"Popup operations only handle one event");const e=Ag();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ai(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(ai(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ko.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ai(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,oN.get())};e()}}Ko.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cN="pendingRedirect",y0=new Map;class uN extends eS{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=y0.get(this.auth._key());if(!e){try{const n=await fN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}y0.set(this.auth._key(),e)}return this.bypassAuthState||y0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function fN(t,e){const r=pN(e),n=dN(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function hN(t,e){y0.set(t._key(),e)}function dN(t){return oa(t._redirectPersistence)}function pN(t){return _0(cN,t.config.apiKey,t.name)}async function mN(t,e,r=!1){if(ri(t.app))return Promise.reject(Zo(t));const n=_d(t),s=ZT(n,e),o=await new uN(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gN=600*1e3;class xN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!vN(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!tS(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(ai(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=gN&&this.cachedEventUids.clear(),this.cachedEventUids.has(o2(e))}saveEventToCache(e){this.cachedEventUids.add(o2(e)),this.lastProcessedEventTime=Date.now()}}function o2(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function tS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function vN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return tS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _N(t,e={}){return Bc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wN=/^https?/;async function EN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await _N(t);for(const r of e)try{if(TN(r))return}catch{}ji(t,"unauthorized-domain")}function TN(t){const e=o1(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!wN.test(r))return!1;if(yN.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN=new bf(3e4,6e4);function l2(){const t=Vi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function kN(t){return new Promise((e,r)=>{var s,i,o;function n(){l2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{l2(),r(ai(t,"network-request-failed"))},timeout:SN.get()})}if((i=(s=Vi().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Vi().gapi)!=null&&o.load)n();else{const c=F6("iframefcb");return Vi()[c]=()=>{gapi.load?n():r(ai(t,"network-request-failed"))},C6(`${I6()}?onload=${c}`).catch(f=>r(f))}}).catch(e=>{throw w0=null,e})}let w0=null;function AN(t){return w0=w0||kN(t),w0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN=new bf(5e3,15e3),IN="__/auth/iframe",FN="emulator/auth/iframe",RN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},NN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function DN(t){const e=t.config;ft(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?yg(e,FN):`https://${t.config.authDomain}/${IN}`,n={apiKey:e.apiKey,appName:t.name,v:Dc},s=NN.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Tf(n).slice(1)}`}async function PN(t){const e=await AN(t),r=Vi().gapi;return ft(r,t,"internal-error"),e.open({where:document.body,url:DN(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:RN,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const o=ai(t,"network-request-failed"),c=Vi().setTimeout(()=>{i(o)},CN.get());function f(){Vi().clearTimeout(c),s(n)}n.ping(f).then(f,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ON=500,LN=600,MN="_blank",VN="http://localhost";class c2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function BN(t,e,r,n=ON,s=LN){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const f={...bN,width:n.toString(),height:s.toString(),top:i,left:o},h=On().toLowerCase();r&&(c=OT(h)?MN:r),PT(h)&&(e=e||VN,f.scrollbars="yes");const d=Object.entries(f).reduce((x,[_,S])=>`${x}${_}=${S},`,"");if(_6(h)&&c!=="_self")return UN(e||"",c),new c2(null);const g=window.open(e||"",c,d);ft(g,t,"popup-blocked");try{g.focus()}catch{}return new c2(g)}function UN(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jN="__/auth/handler",zN="emulator/auth/handler",WN=encodeURIComponent("fac");async function u2(t,e,r,n,s,i){ft(t.config.authDomain,t,"auth-domain-config-required"),ft(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Dc,eventId:s};if(e instanceof kg){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",FC(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(e instanceof Of){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const f=await t._getAppCheckToken(),h=f?`#${WN}=${encodeURIComponent(f)}`:"";return`${HN(t)}?${Tf(c).slice(1)}${h}`}function HN({config:t}){return t.emulator?yg(t,zN):`https://${t.authDomain}/${jN}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m="webStorageSupport";class $N{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=KT,this._completeRedirectFn=mN,this._overrideRedirectResult=hN}async _openPopup(e,r,n,s){var o;ga((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await u2(e,r,n,o1(),s);return BN(e,i,Ag())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await u2(e,r,n,o1(),s);return K6(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(ga(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await PN(e),n=new xN(e);return r.register("authEvent",s=>(ft(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(_m,{type:_m},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[_m];i!==void 0&&r(!!i),ji(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=EN(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return UT()||bT()||Tg()}}const GN=$N;var f2="@firebase/auth",h2="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KN(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function XN(t){yc(new al("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;ft(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jT(t)},h=new k6(n,s,i,f);return N6(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),yc(new al("auth-internal",e=>{const r=_d(e.getProvider("auth").getImmediate());return(n=>new qN(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),so(f2,h2,KN(t)),so(f2,h2,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YN=300,QN=Uw("authIdTokenMaxAge")||YN;let d2=null;const JN=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>QN)return;const s=r==null?void 0:r.token;d2!==s&&(d2=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function ZN(t=Gw()){const e=N1(t,"auth");if(e.isInitialized())return e.getImmediate();const r=R6(t,{popupRedirectResolver:GN,persistence:[nN,$6,KT]}),n=Uw("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=JN(i.toString());U6(r,o,()=>o(r.currentUser)),B6(r,c=>o(c))}}const s=Vw("auth");return s&&D6(r,`http://${s}`),r}function eD(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}A6({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=ai("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",eD().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});XN("Browser");const tD={apiKey:"AIzaSyBBfpg8D4bqcqOTTuO5ONIQRInRCPOZM5k",authDomain:"comments-67079.firebaseapp.com",projectId:"comments-67079",storageBucket:"comments-67079.firebasestorage.app",messagingSenderId:"36001866008",appId:"1:36001866008:web:448de13685ad843551be6d"},rS=$w(tD),ar=UR(rS),uc=ZN(rS),nS=new ia;nS.setCustomParameters({prompt:"select_account"});let Cn=null;const rD=t=>{Cn=t},Bt={USERS:"users",STUDENTS:"students",SETTINGS:"settings",TEMPLATES:"templates",CLASSES:"classes",SCHOOLS:"schools"},u1=t=>{if(!Cn)throw new Error(" ID  setCurrentUserId()");return Yo(ar,Bt.USERS,Cn,t)},Di=(t,e)=>{if(!Cn)throw new Error(" ID  setCurrentUserId()");return Fn(ar,Bt.USERS,Cn,t,e)},sa={subscribe:(t,e=null)=>{if(!Cn)return console.error(" ID "),t([]),()=>{};const r=u1(Bt.STUDENTS);return vl(r,n=>{let s=[];n.forEach(i=>{const o={id:i.id,...i.data()};(!e||o.classId===e)&&s.push(o)}),s.sort((i,o)=>{var c,f,h,d;return(((f=(c=i.createdAt)==null?void 0:c.toMillis)==null?void 0:f.call(c))||0)-(((d=(h=o.createdAt)==null?void 0:h.toMillis)==null?void 0:d.call(h))||0)}),t(s)},n=>{console.error("Firestore :",n),t([])})},add:async t=>{try{const e=Di(Bt.STUDENTS,t.id.toString());await ui(e,{...t,createdAt:xr(),updatedAt:xr()})}catch(e){throw console.error(":",e),e}},addBatch:async t=>{try{const e=xm(ar);t.forEach(r=>{const n=Di(Bt.STUDENTS,r.id.toString());e.set(n,{...r,createdAt:xr(),updatedAt:xr()})}),await e.commit()}catch(e){throw console.error(":",e),e}},update:async(t,e)=>{try{const r=Di(Bt.STUDENTS,t.toString());await ui(r,{...e,updatedAt:xr()},{merge:!0})}catch(r){throw console.error(":",r),r}},delete:async t=>{try{const e=Di(Bt.STUDENTS,t.toString());await Vc(e)}catch(e){throw console.error(":",e),e}},deleteBatch:async t=>{try{const e=xm(ar);t.forEach(r=>{const n=Di(Bt.STUDENTS,r.toString());e.delete(n)}),await e.commit()}catch(e){throw console.error(":",e),e}},deleteAll:async()=>{try{const t=u1(Bt.STUDENTS),e=await ST(t),r=xm(ar);e.forEach(n=>{r.delete(n.ref)}),await r.commit()}catch(t){throw console.error(":",t),t}}},nD={subscribe:t=>{if(!Cn)return console.error(" ID "),t({}),()=>{};const e=Di(Bt.SETTINGS,"user");return vl(e,r=>{r.exists()?t(r.data()):t({})},r=>{console.error(":",r),t({})})},save:async t=>{try{const e=Di(Bt.SETTINGS,"user");await ui(e,{...t,updatedAt:xr()},{merge:!0})}catch(e){throw console.error(":",e),e}}},p2={subscribe:t=>{if(!Cn)return console.error(" ID "),t([]),()=>{};const e=u1(Bt.TEMPLATES);return vl(e,r=>{const n=[];r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>{var o,c,f,h;return(((c=(o=i.createdAt)==null?void 0:o.toMillis)==null?void 0:c.call(o))||0)-(((h=(f=s.createdAt)==null?void 0:f.toMillis)==null?void 0:h.call(f))||0)}),t(n)},r=>{console.error(":",r),t([])})},add:async t=>{try{const e=Date.now().toString(),r=Di(Bt.TEMPLATES,e);return await ui(r,{...t,createdAt:xr(),usageCount:0}),e}catch(e){throw console.error(":",e),e}},delete:async t=>{try{const e=Di(Bt.TEMPLATES,t.toString());await Vc(e)}catch(e){throw console.error(":",e),e}},incrementUsage:async t=>{try{const e=Di(Bt.TEMPLATES,t.toString()),r=await a1(e);r.exists()&&await ui(e,{usageCount:(r.data().usageCount||0)+1,updatedAt:xr()},{merge:!0})}catch(e){console.error(":",e)}}},sS={subscribe:t=>{const e=Yo(ar,Bt.CLASSES);return vl(e,r=>{const n=[];r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>{var o,c,f,h;return(((c=(o=s.createdAt)==null?void 0:o.toMillis)==null?void 0:c.call(o))||0)-(((h=(f=i.createdAt)==null?void 0:f.toMillis)==null?void 0:h.call(f))||0)}),t(n)},r=>{console.error(":",r)})},add:async t=>{try{const e=Date.now().toString(),r=Fn(ar,Bt.CLASSES,e);return await ui(r,{...t,createdAt:xr(),updatedAt:xr()}),e}catch(e){throw console.error(":",e),e}},update:async(t,e)=>{try{const r=Fn(ar,Bt.CLASSES,t.toString());await ui(r,{...e,updatedAt:xr()},{merge:!0})}catch(r){throw console.error(":",r),r}},delete:async t=>{try{const e=Fn(ar,Bt.CLASSES,t.toString());await Vc(e)}catch(e){throw console.error(":",e),e}}},sD={subscribe:t=>{const e=Yo(ar,Bt.SCHOOLS);return vl(e,r=>{const n=[];r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>(s.name||"").localeCompare(i.name||"","zh-TW")),t(n)},r=>{console.error(":",r),t([])})},add:async t=>{try{const e=Date.now().toString(),r=Fn(ar,Bt.SCHOOLS,e);return await ui(r,{...t,createdAt:xr(),updatedAt:xr()}),e}catch(e){throw console.error(":",e),e}},update:async(t,e)=>{try{const r=Fn(ar,Bt.SCHOOLS,t.toString());await ui(r,{...e,updatedAt:xr()},{merge:!0})}catch(r){throw console.error(":",r),r}},delete:async t=>{try{const e=Fn(ar,Bt.SCHOOLS,t.toString());await Vc(e)}catch(e){throw console.error(":",e),e}}},iD={subscribe:(t,e)=>{if(!Cn)return console.error(" ID "),e([]),()=>{};const r=Yo(ar,Bt.USERS,Cn,Bt.STUDENTS,t.toString(),"history");return vl(r,n=>{const s=[];n.forEach(i=>{s.push({id:i.id,...i.data()})}),s.sort((i,o)=>{var c,f,h,d;return(((f=(c=o.createdAt)==null?void 0:c.toMillis)==null?void 0:f.call(c))||0)-(((d=(h=i.createdAt)==null?void 0:h.toMillis)==null?void 0:d.call(h))||0)}),e(s)},n=>{console.error(":",n),e([])})},add:async(t,e,r=[])=>{if(!Cn)throw new Error(" ID ");try{const n=Yo(ar,Bt.USERS,Cn,Bt.STUDENTS,t.toString(),"history");await JR(n,{comment:e,styles:r,createdAt:xr()})}catch(n){throw console.error(":",n),n}},getAll:async t=>{if(!Cn)return console.error(" ID "),[];try{const e=Yo(ar,Bt.USERS,Cn,Bt.STUDENTS,t.toString(),"history"),r=await ST(e),n=[];return r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>{var o,c,f,h;return(((c=(o=i.createdAt)==null?void 0:o.toMillis)==null?void 0:c.call(o))||0)-(((h=(f=s.createdAt)==null?void 0:f.toMillis)==null?void 0:h.call(f))||0)})}catch(e){return console.error(":",e),[]}},delete:async(t,e)=>{if(!Cn)throw new Error(" ID ");try{const r=Fn(ar,Bt.USERS,Cn,Bt.STUDENTS,t.toString(),"history",e);await Vc(r)}catch(r){throw console.error(":",r),r}}},aD="cagooo@gmail.com",Ka={USERS:"users"},ei={ADMIN:"admin",TEACHER:"teacher",PENDING:"pending",PENDING_INFO:"pending_info",PENDING_REVIEW:"pending_review"},f1={getCurrentUser:()=>uc.currentUser,onAuthStateChange:t=>j6(uc,async e=>{if(e){const r=await $o.getOrCreate(e);t({...e,...r})}else t(null)}),signInWithGoogle:async()=>{try{const e=(await lN(uc,nS)).user;return await $o.getOrCreate(e),{success:!0,user:e}}catch(t){return console.error("Google :",t),{success:!1,error:t.message}}},signOut:async()=>{try{return await z6(uc),{success:!0}}catch(t){return console.error(":",t),{success:!1,error:t.message}}}},$o={getOrCreate:async t=>{const e=Fn(ar,Ka.USERS,t.uid),r=await a1(e);if(r.exists())return await ui(e,{lastLoginAt:xr()},{merge:!0}),{id:r.id,...r.data()};const n=t.email===aD,s={uid:t.uid,email:t.email,displayName:t.displayName||"",photoURL:t.photoURL||null,role:n?ei.ADMIN:ei.PENDING_INFO,assignedClasses:[],requestedSchoolId:null,requestedClasses:[],createdAt:xr(),lastLoginAt:xr(),approvedAt:n?xr():null,approvedBy:n?"system":null};return await ui(e,s),{id:t.uid,...s}},get:async t=>{const e=Fn(ar,Ka.USERS,t),r=await a1(e);return r.exists()?{id:r.id,...r.data()}:null},subscribeAll:t=>{const e=Yo(ar,Ka.USERS),r=KR(e,XR("createdAt","desc"));return vl(r,n=>{const s=[];n.forEach(i=>{s.push({id:i.id,...i.data()})}),t(s)},n=>{console.error(":",n)})},approve:async(t,e=[],r=null)=>{var n;try{const s=Fn(ar,Ka.USERS,t),i={role:ei.TEACHER,assignedClasses:e,approvedAt:xr(),approvedBy:((n=uc.currentUser)==null?void 0:n.uid)||"unknown"};return r&&(i.schoolId=r),await Zh(s,i),{success:!0}}catch(s){return console.error(":",s),{success:!1,error:s.message}}},updateAssignedClasses:async(t,e,r=null)=>{try{const n=Fn(ar,Ka.USERS,t),s={assignedClasses:e,updatedAt:xr()};return r!==void 0&&(s.schoolId=r),await Zh(n,s),{success:!0}}catch(n){return console.error(":",n),{success:!1,error:n.message}}},reject:async t=>{var e;try{const r=Fn(ar,Ka.USERS,t);return await Zh(r,{role:ei.PENDING_INFO,assignedClasses:[],requestedSchoolId:null,requestedClasses:[],rejectedAt:xr(),rejectedBy:((e=uc.currentUser)==null?void 0:e.uid)||"unknown"}),{success:!0}}catch(r){return console.error(":",r),{success:!1,error:r.message}}},submitApplication:async(t,e,r)=>{try{const n=Fn(ar,Ka.USERS,t);return await Zh(n,{role:ei.PENDING_REVIEW,requestedSchoolId:e,requestedClasses:r,applicationSubmittedAt:xr()}),{success:!0}}catch(n){return console.error(":",n),{success:!1,error:n.message}}},delete:async t=>{try{const e=Fn(ar,Ka.USERS,t);return await Vc(e),{success:!0}}catch(e){return console.error(":",e),{success:!1,error:e.message}}},isAdmin:t=>(t==null?void 0:t.role)===ei.ADMIN,isApproved:t=>(t==null?void 0:t.role)===ei.ADMIN||(t==null?void 0:t.role)===ei.TEACHER,needsInfo:t=>(t==null?void 0:t.role)===ei.PENDING_INFO,isPendingReview:t=>(t==null?void 0:t.role)===ei.PENDING_REVIEW||(t==null?void 0:t.role)===ei.PENDING},oD=t=>{const[e,r]=Oe.useState([]),[n,s]=Oe.useState(new Set),[i,o]=Oe.useState(!0),[c,f]=Oe.useState(!1);Oe.useEffect(()=>{if(!t){r([]),o(!1);return}rD(t),o(!0);const U=sa.subscribe(X=>{const G=X.map(k=>({...k,id:parseInt(k.id)||k.id,selectedTags:k.selectedTags||[],manualTraits:k.manualTraits||"",comment:k.comment||""}));r(G),o(!1)});return()=>U()},[t]);const h=Oe.useCallback(async U=>{const X=U.split(`
`).map(k=>k.trim()).filter(k=>k!=="");if(X.length===0)return[];const G=X.map((k,F)=>({id:Date.now()+F,name:k,selectedTags:[],manualTraits:"",comment:""}));f(!0);try{await sa.addBatch(G)}catch(k){console.error(":",k)}return f(!1),G},[]),d=Oe.useCallback(async(U,X,G)=>{r(k=>k.map(F=>F.id===U?{...F,[X]:G}:F));try{const k=e.find(F=>F.id===U);k&&await sa.update(U,{...k,[X]:G})}catch(k){console.error(":",k)}},[e]),g=Oe.useCallback(async U=>{r(X=>X.filter(G=>G.id!==U)),s(X=>{const G=new Set(X);return G.delete(U),G});try{await sa.delete(U)}catch(X){console.error(":",X)}},[]),x=Oe.useCallback(async()=>{const U=Array.from(n);r(X=>X.filter(G=>!n.has(G.id))),s(new Set);try{await sa.deleteBatch(U)}catch(X){console.error(":",X)}},[n]),_=Oe.useCallback(async()=>{r([]),s(new Set);try{await sa.deleteAll()}catch(U){console.error(":",U)}},[]),S=Oe.useCallback(U=>{s(X=>{const G=new Set(X);return G.has(U)?G.delete(U):G.add(U),G})},[]),y=Oe.useCallback(()=>{if(n.size===e.length&&e.length>0)s(new Set);else{const U=new Set(e.map(X=>X.id));s(U)}},[n.size,e]),T=Oe.useCallback(async(U,X)=>{r(G=>G.map(k=>U.includes(k.id)?k.selectedTags.includes(X)?k:{...k,selectedTags:[...k.selectedTags,X]}:k));try{for(const G of U){const k=e.find(F=>F.id===G);k&&!k.selectedTags.includes(X)&&await sa.update(G,{selectedTags:[...k.selectedTags,X]})}}catch(G){console.error(":",G)}},[e]),R=Oe.useCallback(async(U,X)=>{r(G=>G.map(k=>k.id===U?{...k,selectedTags:k.selectedTags.filter(F=>F!==X)}:k));try{const G=e.find(k=>k.id===U);G&&await sa.update(U,{selectedTags:G.selectedTags.filter(k=>k!==X)})}catch(G){console.error(":",G)}},[e]),O=Oe.useCallback(U=>{r(X=>typeof U=="function"?U(X):U)},[]),N=Oe.useCallback(async(U,X)=>{try{await sa.update(U,{comment:X})}catch(G){console.error(":",G)}},[]);return{students:e,setStudents:O,selectedIds:n,isLoading:i,isSyncing:c,generateStudents:h,updateStudent:d,deleteStudent:g,deleteSelected:x,resetStudents:_,toggleSelection:S,toggleAllSelection:y,addTagToStudents:T,removeTag:R,syncComment:N}},lD=({isSidebarOpen:t,setIsSidebarOpen:e,onOpenSettings:r,onOpenTemplates:n,onOpenClasses:s,onOpenAdmin:i,onOpenImportExport:o,onOpenPrint:c,onOpenDashboard:f,onLogout:h,hasApiKey:d,templateCount:g=0,currentClassName:x="",currentUser:_,isAdmin:S})=>{const[y,T]=Oe.useState(!1),R=[{icon:Om,label:"Excel /",onClick:o,color:"text-[#54A0FF]"},{icon:M_,label:" PDF",onClick:c,color:"text-[#FF6B9D]"},{icon:L_,label:"",onClick:f,color:"text-[#6C5CE7]"},{icon:V_,label:d?"API  ":"API  ",onClick:r,color:d?"text-[#1DD1A1]":"text-[#FF6B6B]"}];return C.jsxs("header",{className:"bg-[#FFF9E6] border-b-4 border-[#2D3436] h-14 sm:h-16 md:h-20 flex items-center justify-between px-2 sm:px-4 md:px-6 shrink-0 z-20 sticky top-0 shadow-[0_4px_0_#2D3436]",children:[C.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-3",children:[C.jsx("div",{className:"bg-[#FECA57] text-[#2D3436] p-1.5 sm:p-2 md:p-3 border-2 sm:border-3 border-[#2D3436] shadow-[2px_2px_0_#2D3436] sm:shadow-[3px_3px_0_#2D3436] transform rotate-[-2deg] rounded-lg",children:C.jsx("span",{className:"text-lg sm:text-xl md:text-2xl",children:""})}),C.jsxs("div",{className:"min-w-0",children:[C.jsxs("h1",{className:"text-sm sm:text-lg md:text-2xl font-black text-[#2D3436] tracking-wide truncate",children:[C.jsxs("span",{className:"hidden md:inline relative",children:[C.jsx("span",{className:"relative z-10",children:""}),C.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-3 bg-[#FF6B9D] -z-0 transform -rotate-1"})]}),C.jsx("span",{className:"hidden md:inline ml-1",children:""}),C.jsx("span",{className:"hidden sm:inline md:hidden",children:""}),C.jsx("span",{className:"sm:hidden",children:""})]}),C.jsxs("button",{onClick:s,className:"text-[10px] sm:text-xs font-bold text-[#636E72] hover:text-[#A29BFE] transition-colors flex items-center gap-0.5 sm:gap-1 mt-0.5 max-w-[80px] sm:max-w-none",children:[C.jsx(Lm,{size:10,className:"shrink-0 hidden sm:block"}),C.jsx("span",{className:"truncate",children:x}),C.jsx(B4,{size:10,className:"shrink-0"})]})]})]}),C.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 md:gap-2",children:[S&&C.jsxs("button",{onClick:i,className:"btn-pop p-1.5 sm:p-2 bg-[#FF6B9D] text-white flex items-center gap-1 text-xs sm:text-sm",title:"",children:[C.jsx(Y4,{size:16,className:"sm:w-[18px] sm:h-[18px]"}),C.jsx("span",{className:"hidden md:inline",children:""})]}),C.jsxs("button",{onClick:n,className:"btn-pop p-1.5 sm:p-2 bg-[#A29BFE] text-white flex items-center gap-1 text-xs sm:text-sm relative",title:"",children:[C.jsx(A1,{size:16,className:"sm:w-[18px] sm:h-[18px]"}),C.jsx("span",{className:"hidden md:inline",children:""}),g>0&&C.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 sm:w-5 sm:h-5 bg-[#2D3436] text-white text-[10px] sm:text-xs font-bold rounded-full flex items-center justify-center",children:g>9?"9+":g})]}),C.jsxs("div",{className:"hidden lg:flex items-center gap-1.5",children:[C.jsxs("button",{onClick:o,className:"btn-pop p-2 bg-[#54A0FF] text-white flex items-center gap-1 text-sm",title:"Excel /",children:[C.jsx(Om,{size:18}),C.jsx("span",{children:"Excel"})]}),C.jsxs("button",{onClick:c,className:"btn-pop p-2 bg-[#FF6B9D] text-white flex items-center gap-1 text-sm",title:" PDF ",children:[C.jsx(M_,{size:18}),C.jsx("span",{children:""})]}),C.jsxs("button",{onClick:f,className:"btn-pop p-2 bg-[#6C5CE7] text-white flex items-center gap-1 text-sm",title:"",children:[C.jsx(L_,{size:18}),C.jsx("span",{children:""})]}),C.jsxs("button",{onClick:r,className:`btn-pop p-2 flex items-center gap-1 text-sm
                            ${d?"bg-[#1DD1A1] text-white":"bg-[#FF6B6B] text-white animate-pulse"}`,title:d?"API Key ":" API Key",children:[C.jsx(V_,{size:18}),C.jsx("span",{children:d?"":""})]})]}),C.jsxs("div",{className:"lg:hidden relative",children:[C.jsxs("button",{onClick:()=>T(!y),className:`btn-pop p-1.5 sm:p-2 flex items-center gap-1 text-xs sm:text-sm
                            ${d?"bg-[#636E72] text-white":"bg-[#FF6B6B] text-white animate-pulse"}`,title:"",children:[C.jsx(W4,{size:16,className:"sm:w-[18px] sm:h-[18px]"}),C.jsx("span",{className:"hidden sm:inline",children:""})]}),y&&C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>T(!1)}),C.jsx("div",{className:"absolute right-0 top-full mt-2 bg-white border-2 border-[#2D3436] rounded-lg shadow-[3px_3px_0_#2D3436] py-2 w-48 z-50",children:R.map((O,N)=>C.jsxs("button",{onClick:()=>{O.onClick(),T(!1)},className:"w-full px-4 py-2.5 flex items-center gap-3 hover:bg-[#FFF9E6] transition-colors text-left",children:[C.jsx(O.icon,{size:18,className:O.color}),C.jsx("span",{className:"text-sm font-medium text-[#2D3436]",children:O.label})]},N))})]})]}),C.jsxs("button",{onClick:()=>e(!t),className:`btn-pop p-1.5 sm:p-2 md:px-3 flex items-center gap-1 text-xs sm:text-sm
                        ${t?"bg-[#FF6B9D] text-white":"bg-[#54A0FF] text-white"}`,children:[t?C.jsx(wf,{size:16,className:"sm:w-[18px] sm:h-[18px]"}):C.jsx(G4,{size:16,className:"sm:w-[18px] sm:h-[18px]"}),C.jsx("span",{className:"hidden sm:inline",children:t?"":""}),C.jsx("span",{className:"sm:hidden",children:""})]}),C.jsxs("div",{className:"relative group",children:[_!=null&&_.photoURL?C.jsx("img",{src:_.photoURL,alt:_.displayName,className:"w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 rounded-full border-2 border-[#2D3436] cursor-pointer hover:ring-2 hover:ring-[#FECA57] transition-all"}):C.jsx("div",{className:"w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-[#FECA57] rounded-full border-2 border-[#2D3436] flex items-center justify-center cursor-pointer",children:C.jsx("span",{className:"text-sm sm:text-lg",children:""})}),C.jsxs("div",{className:"absolute right-0 top-10 sm:top-12 bg-white border-2 border-[#2D3436] rounded-lg shadow-[3px_3px_0_#2D3436] p-3 w-48 sm:w-56 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[C.jsx("div",{className:"text-sm font-bold text-[#2D3436] truncate",children:_==null?void 0:_.displayName}),C.jsx("div",{className:"text-xs text-[#636E72] truncate",children:_==null?void 0:_.email}),(_==null?void 0:_.schoolName)&&C.jsx("div",{className:"mt-2 pt-2 border-t border-dashed border-[#E8DCC8]",children:C.jsxs("div",{className:"text-xs text-[#636E72] flex items-center gap-1",children:[" ",C.jsx("span",{className:"font-bold text-[#A29BFE]",children:_.schoolName})]})}),(_==null?void 0:_.assignedClassNames)&&_.assignedClassNames.length>0&&C.jsx("div",{className:`${_!=null&&_.schoolName?"mt-1":"mt-2 pt-2 border-t border-dashed border-[#E8DCC8]"}`,children:C.jsxs("div",{className:"text-xs text-[#636E72] flex items-start gap-1",children:[C.jsx(Lm,{size:12,className:"mt-0.5 shrink-0"}),C.jsx("span",{className:"font-bold text-[#54A0FF]",children:_.assignedClassNames.join("")})]})}),C.jsxs("button",{onClick:h,className:"w-full btn-pop px-3 py-2 bg-[#636E72] text-white text-xs font-bold flex items-center justify-center gap-2 mt-3",children:[C.jsx($4,{size:14}),""]})]})]})]})]})},cD=()=>C.jsx("footer",{className:"bg-[#FECA57] text-[#2D3436] text-xs sm:text-sm py-3 sm:py-4 text-center border-t-4 border-[#2D3436] shrink-0 font-bold",children:C.jsxs("p",{className:"flex items-center justify-center gap-2",children:[C.jsx("span",{children:""}),C.jsx("span",{children:" "}),C.jsx("span",{children:""})]})}),uD=({dialog:t,closeDialog:e})=>t.isOpen?C.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",children:C.jsxs("div",{className:"card-pop w-full max-w-sm overflow-hidden animate-in",children:[C.jsx("div",{className:"p-4 sm:p-5 bg-[#FF6B9D] border-b-3 border-[#2D3436]",children:C.jsxs("h3",{className:"font-black text-lg sm:text-xl text-white flex items-center gap-2",children:[t.type==="confirm"?C.jsx(Dw,{size:24}):C.jsx(Fw,{size:24}),t.title]})}),C.jsx("div",{className:"p-4 sm:p-6 bg-[#FFFDF5] text-[#2D3436] font-bold text-base sm:text-lg",children:t.message}),C.jsx("div",{className:"p-3 sm:p-4 bg-[#FFF9E6] flex justify-end gap-2 sm:gap-3 border-t-2 border-dashed border-[#E8DCC8]",children:t.type==="confirm"?C.jsxs(C.Fragment,{children:[C.jsx("button",{onClick:e,className:"btn-pop px-4 sm:px-6 py-2 bg-white text-[#2D3436] text-sm sm:text-base",children:" "}),C.jsx("button",{onClick:t.onConfirm,className:"btn-pop px-4 sm:px-6 py-2 bg-[#FF6B6B] text-white text-sm sm:text-base",children:" "})]}):C.jsx("button",{onClick:e,className:"btn-pop px-4 sm:px-6 py-2 bg-[#1DD1A1] text-white text-sm sm:text-base",children:" "})})]})}):null,fD=({progress:t})=>{const e=t.total>0?t.current/t.total*100:0;return C.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-[#2D3436]/70 backdrop-blur-md p-4",children:C.jsxs("div",{className:"card-pop w-[95%] sm:w-[90%] max-w-2xl flex flex-col items-center justify-center p-6 sm:p-10 text-center animate-in bg-[#FFF9E6]",children:[C.jsx("div",{className:"mb-4 sm:mb-6 text-6xl sm:text-8xl animate-bounce-soft",children:""}),C.jsxs("h2",{className:"text-2xl sm:text-4xl md:text-5xl font-black text-[#2D3436] mb-4 sm:mb-6",children:[C.jsxs("span",{className:"relative inline-block",children:["",C.jsx("span",{className:"absolute bottom-1 left-0 right-0 h-3 bg-[#FECA57] -z-10 transform rotate-1"})]}),C.jsx("span",{className:"animate-pulse",children:"..."})]}),C.jsx("div",{className:"w-full max-w-md bg-white border-3 border-[#2D3436] h-8 sm:h-10 mb-3 sm:mb-4 overflow-hidden rounded-full shadow-[4px_4px_0_#2D3436]",children:C.jsx("div",{className:"h-full transition-all duration-300 ease-out bg-gradient-to-r from-[#FF6B9D] via-[#FECA57] to-[#1DD1A1]",style:{width:`${e}%`}})}),C.jsxs("p",{className:"text-lg sm:text-2xl text-[#2D3436] font-bold mb-4 sm:mb-6",children:[" ",t.current," / ",t.total," "]}),C.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl text-[#FF6B9D] font-black",children:" "})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var z0={};z0.version="0.18.5";var iS=1252,hD=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ig={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Fg=function(t){hD.indexOf(t)!=-1&&(iS=Ig[0]=t)};function dD(){Fg(1252)}var si=function(t){Fg(t)};function Rg(){si(1200),dD()}function m2(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function pD(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function aS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Du=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?pD(t.slice(2)):e==254&&r==255?aS(t.slice(2)):e==65279?t.slice(1):t},t0=function(e){return String.fromCharCode(e)},g2=function(e){return String.fromCharCode(e)},of,eo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function lf(t){for(var e="",r=0,n=0,s=0,i=0,o=0,c=0,f=0,h=0;h<t.length;)r=t.charCodeAt(h++),i=r>>2,n=t.charCodeAt(h++),o=(r&3)<<4|n>>4,s=t.charCodeAt(h++),c=(n&15)<<2|s>>6,f=s&63,isNaN(n)?c=f=64:isNaN(s)&&(f=64),e+=eo.charAt(i)+eo.charAt(o)+eo.charAt(c)+eo.charAt(f);return e}function Es(t){var e="",r=0,n=0,s=0,i=0,o=0,c=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)i=eo.indexOf(t.charAt(h++)),o=eo.indexOf(t.charAt(h++)),r=i<<2|o>>4,e+=String.fromCharCode(r),c=eo.indexOf(t.charAt(h++)),n=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(n)),f=eo.indexOf(t.charAt(h++)),s=(c&3)<<6|f,f!==64&&(e+=String.fromCharCode(s));return e}var _t=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ya=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function po(t){return _t?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function x2(t){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var _s=function(e){return _t?ya(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Ed(t){if(typeof ArrayBuffer>"u")return _s(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function wo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function mD(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Ng(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Ng(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var rn=_t?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ya(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function gD(t){for(var e=[],r=0,n=t.length+250,s=po(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=t.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|c>>6&15|(o&3)<<4,s[r++]=128|c&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(e.push(s.slice(0,r)),r=0,s=po(65535),n=65530)}return e.push(s.slice(0,r)),rn(e)}var qn=/\u0000/g,Pu=/[\u0001-\u0006]/g;function gc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ii(t,e){var r=""+t;return r.length>=e?r:Er("0",e-r.length)+r}function Dg(t,e){var r=""+t;return r.length>=e?r:Er(" ",e-r.length)+r}function W0(t,e){var r=""+t;return r.length>=e?r:r+Er(" ",e-r.length)}function xD(t,e){var r=""+Math.round(t);return r.length>=e?r:Er("0",e-r.length)+r}function vD(t,e){var r=""+t;return r.length>=e?r:Er("0",e-r.length)+r}var v2=Math.pow(2,32);function rc(t,e){if(t>v2||t<-v2)return xD(t,e);var r=Math.round(t);return vD(r,e)}function H0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var _2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ym=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function _D(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},y2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},yD={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $0(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,o=1,c=0,f=1,h=0,d=0,g=Math.floor(s);h<e&&(g=Math.floor(s),c=g*o+i,d=g*h+f,!(s-g<5e-8));)s=1/(s-g),i=o,o=c,f=h,h=d;if(d>e&&(h>e?(d=f,c=i):(d=h,c=o)),!r)return[0,n*c,d];var x=Math.floor(n*c/d);return[x,n*c-x*d,d]}function Xo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,o=[],c={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++n,++c.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=AD(f,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=i,c}var oS=new Date(1899,11,31,0,0,0),wD=oS.getTime(),ED=new Date(1900,2,1,0,0,0);function lS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=ED&&(r+=1440*60*1e3),(r-(wD+(t.getTimezoneOffset()-oS.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Pg(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function TD(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SD(t){var e=t<0?12:11,r=Pg(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function kD(t){var e=Pg(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function cf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=SD(t):e===10?r=t.toFixed(10).substr(0,12):r=kD(t),Pg(TD(r.toUpperCase()))}function ul(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):cf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return js(14,lS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function AD(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function CD(t,e,r,n){var s="",i=0,o=0,c=r.y,f,h=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:f=c%100,h=2;break;default:f=c%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:f=r.m,h=e.length;break;case 3:return ym[r.m-1][1];case 5:return ym[r.m-1][0];default:return ym[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,h=e.length;break;case 3:return _2[r.q][0];default:return _2[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ii(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(s=ii(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:f=c,h=1;break}var d=h>0?ii(f,h):"";return d}function to(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var cS=/%/g;function ID(t,e,r){var n=e.replace(cS,""),s=e.length-n.length;return ua(t,n,r*Math.pow(10,2*s))+Er("%",s)}function FD(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ua(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function uS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+uS(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,d){return f+h+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var fS=/# (\?+)( ?)\/( ?)(\d+)/;function RD(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),o=s-i*n,c=n;return r+(i===0?"":""+i)+" "+(o===0?Er(" ",t[1].length+1+t[4].length):Dg(o,t[1].length)+t[2]+"/"+t[3]+ii(c,t[4].length))}function ND(t,e,r){return r+(e===0?"":""+e)+Er(" ",t[1].length+2+t[4].length)}var hS=/^#*0*\.([0#]+)/,dS=/\).*[0#]/,pS=/\(###\) ###\\?-####/;function Wn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function w2(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function E2(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function DD(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function PD(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function bs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(dS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?bs("n",n,r):"("+bs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return FD(t,e,r);if(e.indexOf("%")!==-1)return ID(t,e,r);if(e.indexOf("E")!==-1)return uS(e,r);if(e.charCodeAt(0)===36)return"$"+bs(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,o,c,f=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+rc(f,e.length);if(e.match(/^[#?]+$/))return s=rc(r,0),s==="0"&&(s=""),s.length>e.length?s:Wn(e.substr(0,e.length-s.length))+s;if(i=e.match(fS))return RD(i,f,h);if(e.match(/^#+0+$/))return h+rc(f,e.length-e.indexOf("0"));if(i=e.match(hS))return s=w2(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Wn(i[1])).replace(/\.$/,"."+Wn(i[1])).replace(/\.(\d*)$/,function(S,y){return"."+y+Er("0",Wn(i[1]).length-y.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+w2(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+to(rc(f,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+bs(t,e,-r):to(""+(Math.floor(r)+DD(r,i[1].length)))+"."+ii(E2(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return bs(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=gc(bs(t,e.replace(/[\\-]/g,""),r)),o=0,gc(gc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return o<s.length?s.charAt(o++):S==="0"?"0":""}));if(e.match(pS))return s=bs(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=$0(f,Math.pow(10,o)-1,!1),s=""+h,d=ua("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=W0(c[2],o),d.length<i[4].length&&(d=Wn(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=$0(f,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Dg(c[1],o)+i[2]+"/"+i[3]+W0(c[2],o):Er(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=rc(r,0),e.length<=s.length?s:Wn(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=e.indexOf(".")-o,x=e.length-s.length-g;return Wn(e.substr(0,g)+s+e.substr(e.length-x))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=E2(r,i[1].length),r<0?"-"+bs(t,e,-r):to(PD(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ii(0,3-S.length):"")+S})+"."+ii(o,i[1].length);switch(e){case"###,##0.00":return bs(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=to(rc(f,0));return _!=="0"?h+_:"";case"###,###.00":return bs(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return bs(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function bD(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ua(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function OD(t,e,r){var n=e.replace(cS,""),s=e.length-n.length;return ua(t,n,r*Math.pow(10,2*s))+Er("%",s)}function mS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+mS(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,d){return f+h+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Fi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(dS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fi("n",n,r):"("+Fi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return bD(t,e,r);if(e.indexOf("%")!==-1)return OD(t,e,r);if(e.indexOf("E")!==-1)return mS(e,r);if(e.charCodeAt(0)===36)return"$"+Fi(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,o,c,f=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+ii(f,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Wn(e.substr(0,e.length-s.length))+s;if(i=e.match(fS))return ND(i,f,h);if(e.match(/^#+0+$/))return h+ii(f,e.length-e.indexOf("0"));if(i=e.match(hS))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Wn(i[1])).replace(/\.$/,"."+Wn(i[1])),s=s.replace(/\.(\d*)$/,function(S,y){return"."+y+Er("0",Wn(i[1]).length-y.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+to(""+f);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fi(t,e,-r):to(""+r)+"."+Er("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Fi(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=gc(Fi(t,e.replace(/[\\-]/g,""),r)),o=0,gc(gc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return o<s.length?s.charAt(o++):S==="0"?"0":""}));if(e.match(pS))return s=Fi(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=$0(f,Math.pow(10,o)-1,!1),s=""+h,d=ua("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=W0(c[2],o),d.length<i[4].length&&(d=Wn(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=$0(f,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Dg(c[1],o)+i[2]+"/"+i[3]+W0(c[2],o):Er(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Wn(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=e.indexOf(".")-o,x=e.length-s.length-g;return Wn(e.substr(0,g)+s+e.substr(e.length-x))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Fi(t,e,-r):to(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ii(0,3-S.length):"")+S})+"."+ii(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var _=to(""+f);return _!=="0"?h+_:"";default:if(e.match(/\.[0#?]*$/))return Fi(t,e.slice(0,e.lastIndexOf(".")),r)+Wn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ua(t,e,r){return(r|0)===r?Fi(t,e,r):bs(t,e,r)}function LD(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var gS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Uc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":H0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(gS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function MD(t,e,r,n){for(var s=[],i="",o=0,c="",f="t",h,d,g,x="H";o<t.length;)switch(c=t.charAt(o)){case"G":if(!H0(t,o))throw new Error("unrecognized character "+c+" in "+t);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(g=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(g);s[s.length]={t:"t",v:i},++o;break;case"\\":var _=t.charAt(++o),S=_==="("||_===")"?_:"t";s[s.length]={t:S,v:_},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(h==null&&(h=Xo(e,r,t.charAt(o+1)==="2"),h==null))return"";s[s.length]={t:"X",v:t.substr(o,2)},f=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=Xo(e,r),h==null))return"";for(i=c;++o<t.length&&t.charAt(o).toLowerCase()===c;)i+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),s[s.length]={t:c,v:i},f=c;break;case"A":case"a":case"":var y={t:c,v:c};if(h==null&&(h=Xo(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(y.v=h.H>=12?"P":"A"),y.t="T",x="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(y.v=h.H>=12?"PM":"AM"),y.t="T",o+=5,x="h"):t.substr(o,5).toUpperCase()==="/"?(h!=null&&(y.v=h.H>=12?"":""),y.t="T",o+=5,x="h"):(y.t="t",++o),h==null&&y.t==="T")return"";s[s.length]=y,f=c;break;case"[":for(i=c;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(gS)){if(h==null&&(h=Xo(e,r),h==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Uc(t)||(s[s.length]={t:"t",v:i}));break;case".":if(h!=null){for(i=c;++o<t.length&&(c=t.charAt(o))==="0";)i+=c;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++o<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(o))>-1;)i+=c;s[s.length]={t:"n",v:i};break;case"?":for(i=c;t.charAt(++o)===c;)i+=c;s[s.length]={t:c,v:i},f=c;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:c,v:c},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);s[s.length]={t:"t",v:c},++o;break}var T=0,R=0,O;for(o=s.length-1,f="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=x,f="h",T<1&&(T=1);break;case"s":(O=s[o].v.match(/\.0+$/))&&(R=Math.max(R,O[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":f=s[o].t;break;case"m":f==="s"&&(s[o].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&s[o].v.match(/[Hh]/)&&(T=1),T<2&&s[o].v.match(/[Mm]/)&&(T=2),T<3&&s[o].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var N="",U;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=CD(s[o].t.charCodeAt(0),s[o].v,h,R),s[o].t="t";break;case"n":case"?":for(U=o+1;s[U]!=null&&((c=s[U].t)==="?"||c==="D"||(c===" "||c==="t")&&s[U+1]!=null&&(s[U+1].t==="?"||s[U+1].t==="t"&&s[U+1].v==="/")||s[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[U].v==="/"||s[U].v===" "&&s[U+1]!=null&&s[U+1].t=="?"));)s[o].v+=s[U].v,s[U]={v:"",t:";"},++U;N+=s[o].v,o=U-1;break;case"G":s[o].t="t",s[o].v=ul(e,r);break}var X="",G,k;if(N.length>0){N.charCodeAt(0)==40?(G=e<0&&N.charCodeAt(0)===45?-e:e,k=ua("n",N,G)):(G=e<0&&n>1?-e:e,k=ua("n",N,G),G<0&&s[0]&&s[0].t=="t"&&(k=k.substr(1),s[0].v="-"+s[0].v)),U=k.length-1;var F=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){F=o;break}var I=s.length;if(F===s.length&&k.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(U>=s[o].v.length-1?(U-=s[o].v.length,s[o].v=k.substr(U+1,s[o].v.length)):U<0?s[o].v="":(s[o].v=k.substr(0,U+1),U=-1),s[o].t="t",I=o);U>=0&&I<s.length&&(s[I].v=k.substr(0,U+1)+s[I].v)}else if(F!==s.length&&k.indexOf("E")===-1){for(U=k.indexOf(".")-1,o=F;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(d=s[o].v.indexOf(".")>-1&&o===F?s[o].v.indexOf(".")-1:s[o].v.length-1,X=s[o].v.substr(d+1);d>=0;--d)U>=0&&(s[o].v.charAt(d)==="0"||s[o].v.charAt(d)==="#")&&(X=k.charAt(U--)+X);s[o].v=X,s[o].t="t",I=o}for(U>=0&&I<s.length&&(s[I].v=k.substr(0,U+1)+s[I].v),U=k.indexOf(".")+1,o=F;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==F)){for(d=s[o].v.indexOf(".")>-1&&o===F?s[o].v.indexOf(".")+1:0,X=s[o].v.substr(0,d);d<s[o].v.length;++d)U<k.length&&(X+=k.charAt(U++));s[o].v=X,s[o].t="t",I=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(G=n>1&&e<0&&o>0&&s[o-1].v==="-"?-e:e,s[o].v=ua(s[o].t,s[o].v,G),s[o].t="t");var B="";for(o=0;o!==s.length;++o)s[o]!=null&&(B+=s[o].v);return B}var T2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function S2(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function VD(t,e){var r=LD(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(T2),c=r[1].match(T2);return S2(e,o)?[n,r[0]]:S2(e,c)?[n,r[1]]:[n,r[o!=null&&c!=null?2:1]]}return[n,i]}function js(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:nt)[t],n==null&&(n=r.table&&r.table[y2[t]]||nt[y2[t]]),n==null&&(n=yD[t]||"General");break}if(H0(n,0))return ul(e,r);e instanceof Date&&(e=lS(e,r.date1904));var s=VD(n,e);if(H0(s[1]))return ul(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return MD(s[1],e,r,s[0])}function fa(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(nt[r]==null){e<0&&(e=r);continue}if(nt[r]==t){e=r;break}}e<0&&(e=391)}return nt[e]=t,e}function Td(t){for(var e=0;e!=392;++e)t[e]!==void 0&&fa(t[e],e)}function jc(){nt=_D()}var BD={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},xS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function UD(t){var e=typeof t=="number"?nt[t]:t;return e=e.replace(xS,"(\\d+)"),new RegExp("^"+e+"$")}function jD(t,e,r){var n=-1,s=-1,i=-1,o=-1,c=-1,f=-1;(e.match(xS)||[]).forEach(function(g,x){var _=parseInt(r[x+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=_;break;case"d":i=_;break;case"h":o=_;break;case"s":f=_;break;case"m":o>=0?c=_:s=_;break}}),f>=0&&c==-1&&s>=0&&(c=s,s=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&c==-1&&f==-1?h:n==-1&&s==-1&&i==-1?d:h+"T"+d}var zD=(function(){var t={};t.version="1.2.0";function e(){for(var k=0,F=new Array(256),I=0;I!=256;++I)k=I,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,F[I]=k;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(k){var F=0,I=0,B=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)L[B]=k[B];for(B=0;B!=256;++B)for(I=k[B],F=256+B;F<4096;F+=256)I=L[F]=I>>>8^k[I&255];var M=[];for(B=1;B!=16;++B)M[B-1]=typeof Int32Array<"u"?L.subarray(B*256,B*256+256):L.slice(B*256,B*256+256);return M}var s=n(r),i=s[0],o=s[1],c=s[2],f=s[3],h=s[4],d=s[5],g=s[6],x=s[7],_=s[8],S=s[9],y=s[10],T=s[11],R=s[12],O=s[13],N=s[14];function U(k,F){for(var I=F^-1,B=0,L=k.length;B<L;)I=I>>>8^r[(I^k.charCodeAt(B++))&255];return~I}function X(k,F){for(var I=F^-1,B=k.length-15,L=0;L<B;)I=N[k[L++]^I&255]^O[k[L++]^I>>8&255]^R[k[L++]^I>>16&255]^T[k[L++]^I>>>24]^y[k[L++]]^S[k[L++]]^_[k[L++]]^x[k[L++]]^g[k[L++]]^d[k[L++]]^h[k[L++]]^f[k[L++]]^c[k[L++]]^o[k[L++]]^i[k[L++]]^r[k[L++]];for(B+=15;L<B;)I=I>>>8^r[(I^k[L++])&255];return~I}function G(k,F){for(var I=F^-1,B=0,L=k.length,M=0,V=0;B<L;)M=k.charCodeAt(B++),M<128?I=I>>>8^r[(I^M)&255]:M<2048?(I=I>>>8^r[(I^(192|M>>6&31))&255],I=I>>>8^r[(I^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,V=k.charCodeAt(B++)&1023,I=I>>>8^r[(I^(240|M>>8&7))&255],I=I>>>8^r[(I^(128|M>>2&63))&255],I=I>>>8^r[(I^(128|V>>6&15|(M&3)<<4))&255],I=I>>>8^r[(I^(128|V&63))&255]):(I=I>>>8^r[(I^(224|M>>12&15))&255],I=I>>>8^r[(I^(128|M>>6&63))&255],I=I>>>8^r[(I^(128|M&63))&255]);return~I}return t.table=r,t.bstr=U,t.buf=X,t.str=G,t})(),Ze=(function(){var e={};e.version="1.2.1";function r(P,H){for(var j=P.split("/"),W=H.split("/"),q=0,K=0,ce=Math.min(j.length,W.length);q<ce;++q){if(K=j[q].length-W[q].length)return K;if(j[q]!=W[q])return j[q]<W[q]?-1:1}return j.length-W.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var H=P.lastIndexOf("/");return H===-1?P:P.slice(0,H+1)}function s(P){if(P.charAt(P.length-1)=="/")return s(P.slice(0,-1));var H=P.lastIndexOf("/");return H===-1?P:P.slice(H+1)}function i(P,H){typeof H=="string"&&(H=new Date(H));var j=H.getHours();j=j<<6|H.getMinutes(),j=j<<5|H.getSeconds()>>>1,P.write_shift(2,j);var W=H.getFullYear()-1980;W=W<<4|H.getMonth()+1,W=W<<5|H.getDate(),P.write_shift(2,W)}function o(P){var H=P.read_shift(2)&65535,j=P.read_shift(2)&65535,W=new Date,q=j&31;j>>>=5;var K=j&15;j>>>=4,W.setMilliseconds(0),W.setFullYear(j+1980),W.setMonth(K-1),W.setDate(q);var ce=H&31;H>>>=5;var ge=H&63;return H>>>=6,W.setHours(H),W.setMinutes(ge),W.setSeconds(ce<<1),W}function c(P){hn(P,0);for(var H={},j=0;P.l<=P.length-4;){var W=P.read_shift(2),q=P.read_shift(2),K=P.l+q,ce={};switch(W){case 21589:j=P.read_shift(1),j&1&&(ce.mtime=P.read_shift(4)),q>5&&(j&2&&(ce.atime=P.read_shift(4)),j&4&&(ce.ctime=P.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}P.l=K,H[W]=ce}return H}var f;function h(){return f||(f={})}function d(P,H){if(P[0]==80&&P[1]==75)return Un(P,H);if((P[0]|32)==109&&(P[1]|32)==105)return ka(P,H);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var j=3,W=512,q=0,K=0,ce=0,ge=0,le=0,fe=[],he=P.slice(0,512);hn(he,0);var Re=g(he);switch(j=Re[0],j){case 3:W=512;break;case 4:W=4096;break;case 0:if(Re[1]==0)return Un(P,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}W!==512&&(he=P.slice(0,W),hn(he,28));var Ve=P.slice(0,W);x(he,j);var We=he.read_shift(4,"i");if(j===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);he.l+=4,ce=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),ge=he.read_shift(4,"i"),q=he.read_shift(4,"i"),le=he.read_shift(4,"i"),K=he.read_shift(4,"i");for(var De=-1,Pe=0;Pe<109&&(De=he.read_shift(4,"i"),!(De<0));++Pe)fe[Pe]=De;var ct=_(P,W);T(le,K,ct,W,fe);var zt=O(ct,ce,fe,W);zt[ce].name="!Directory",q>0&&ge!==V&&(zt[ge].name="!MiniFAT"),zt[fe[0]].name="!FAT",zt.fat_addrs=fe,zt.ssz=W;var Gt={},fr=[],Gs=[],ks=[];N(ce,zt,ct,fr,q,Gt,Gs,ge),S(Gs,ks,fr),fr.shift();var cs={FileIndex:Gs,FullPaths:ks};return H&&H.raw&&(cs.raw={header:Ve,sectors:ct}),cs}function g(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(Fe,"Header Signature: "),P.l+=16;var H=P.read_shift(2,"u");return[P.read_shift(2,"u"),H]}function x(P,H){var j=9;switch(P.l+=2,j=P.read_shift(2)){case 9:if(H!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(H!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function _(P,H){for(var j=Math.ceil(P.length/H)-1,W=[],q=1;q<j;++q)W[q-1]=P.slice(q*H,(q+1)*H);return W[j-1]=P.slice(j*H),W}function S(P,H,j){for(var W=0,q=0,K=0,ce=0,ge=0,le=j.length,fe=[],he=[];W<le;++W)fe[W]=he[W]=W,H[W]=j[W];for(;ge<he.length;++ge)W=he[ge],q=P[W].L,K=P[W].R,ce=P[W].C,fe[W]===W&&(q!==-1&&fe[q]!==q&&(fe[W]=fe[q]),K!==-1&&fe[K]!==K&&(fe[W]=fe[K])),ce!==-1&&(fe[ce]=W),q!==-1&&W!=fe[W]&&(fe[q]=fe[W],he.lastIndexOf(q)<ge&&he.push(q)),K!==-1&&W!=fe[W]&&(fe[K]=fe[W],he.lastIndexOf(K)<ge&&he.push(K));for(W=1;W<le;++W)fe[W]===W&&(K!==-1&&fe[K]!==K?fe[W]=fe[K]:q!==-1&&fe[q]!==q&&(fe[W]=fe[q]));for(W=1;W<le;++W)if(P[W].type!==0){if(ge=W,ge!=fe[ge])do ge=fe[ge],H[W]=H[ge]+"/"+H[W];while(ge!==0&&fe[ge]!==-1&&ge!=fe[ge]);fe[W]=-1}for(H[0]+="/",W=1;W<le;++W)P[W].type!==2&&(H[W]+="/")}function y(P,H,j){for(var W=P.start,q=P.size,K=[],ce=W;j&&q>0&&ce>=0;)K.push(H.slice(ce*M,ce*M+M)),q-=M,ce=Go(j,ce*4);return K.length===0?me(0):rn(K).slice(0,P.size)}function T(P,H,j,W,q){var K=V;if(P===V){if(H!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var ce=j[P],ge=(W>>>2)-1;if(!ce)return;for(var le=0;le<ge&&(K=Go(ce,le*4))!==V;++le)q.push(K);T(Go(ce,W-4),H-1,j,W,q)}}function R(P,H,j,W,q){var K=[],ce=[];q||(q=[]);var ge=W-1,le=0,fe=0;for(le=H;le>=0;){q[le]=!0,K[K.length]=le,ce.push(P[le]);var he=j[Math.floor(le*4/W)];if(fe=le*4&ge,W<4+fe)throw new Error("FAT boundary crossed: "+le+" 4 "+W);if(!P[he])break;le=Go(P[he],fe)}return{nodes:K,data:L2([ce])}}function O(P,H,j,W){var q=P.length,K=[],ce=[],ge=[],le=[],fe=W-1,he=0,Re=0,Ve=0,We=0;for(he=0;he<q;++he)if(ge=[],Ve=he+H,Ve>=q&&(Ve-=q),!ce[Ve]){le=[];var De=[];for(Re=Ve;Re>=0;){De[Re]=!0,ce[Re]=!0,ge[ge.length]=Re,le.push(P[Re]);var Pe=j[Math.floor(Re*4/W)];if(We=Re*4&fe,W<4+We)throw new Error("FAT boundary crossed: "+Re+" 4 "+W);if(!P[Pe]||(Re=Go(P[Pe],We),De[Re]))break}K[Ve]={nodes:ge,data:L2([le])}}return K}function N(P,H,j,W,q,K,ce,ge){for(var le=0,fe=W.length?2:0,he=H[P].data,Re=0,Ve=0,We;Re<he.length;Re+=128){var De=he.slice(Re,Re+128);hn(De,64),Ve=De.read_shift(2),We=Ug(De,0,Ve-fe),W.push(We);var Pe={name:We,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},ct=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);ct!==0&&(Pe.ct=U(De,De.l-8));var zt=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);zt!==0&&(Pe.mt=U(De,De.l-8)),Pe.start=De.read_shift(4,"i"),Pe.size=De.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=V,Pe.name=""),Pe.type===5?(le=Pe.start,q>0&&le!==V&&(H[le].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",H[Pe.start]===void 0&&(H[Pe.start]=R(j,Pe.start,H.fat_addrs,H.ssz)),H[Pe.start].name=Pe.name,Pe.content=H[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:le!==V&&Pe.start!==V&&H[le]&&(Pe.content=y(Pe,H[le].data,(H[ge]||{}).data))),Pe.content&&hn(Pe.content,0),K[We]=Pe,ce.push(Pe)}}function U(P,H){return new Date((vs(P,H+4)/1e7*Math.pow(2,32)+vs(P,H)/1e7-11644473600)*1e3)}function X(P,H){return h(),d(f.readFileSync(P),H)}function G(P,H){var j=H&&H.type;switch(j||_t&&Buffer.isBuffer(P)&&(j="buffer"),j||"base64"){case"file":return X(P,H);case"base64":return d(_s(Es(P)),H);case"binary":return d(_s(P),H)}return d(P,H)}function k(P,H){var j=H||{},W=j.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=W+"/",P.FileIndex[0]={name:W,type:5}),j.CLSID&&(P.FileIndex[0].clsid=j.CLSID),F(P)}function F(P){var H="Sh33tJ5";if(!Ze.find(P,"/"+H)){var j=me(4);j[0]=55,j[1]=j[3]=50,j[2]=54,P.FileIndex.push({name:H,type:2,content:j,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+H),I(P)}}function I(P,H){k(P);for(var j=!1,W=!1,q=P.FullPaths.length-1;q>=0;--q){var K=P.FileIndex[q];switch(K.type){case 0:W?j=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(K.R*K.L*K.C)&&(j=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!H)){var ce=new Date(1987,1,19),ge=0,le=Object.create?Object.create(null):{},fe=[];for(q=0;q<P.FullPaths.length;++q)le[P.FullPaths[q]]=!0,P.FileIndex[q].type!==0&&fe.push([P.FullPaths[q],P.FileIndex[q]]);for(q=0;q<fe.length;++q){var he=n(fe[q][0]);W=le[he],W||(fe.push([he,{name:s(he).replace("/",""),type:1,clsid:Le,ct:ce,mt:ce,content:null}]),le[he]=!0)}for(fe.sort(function(We,De){return r(We[0],De[0])}),P.FullPaths=[],P.FileIndex=[],q=0;q<fe.length;++q)P.FullPaths[q]=fe[q][0],P.FileIndex[q]=fe[q][1];for(q=0;q<fe.length;++q){var Re=P.FileIndex[q],Ve=P.FullPaths[q];if(Re.name=s(Ve).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||Le,q===0)Re.C=fe.length>1?1:-1,Re.size=0,Re.type=5;else if(Ve.slice(-1)=="/"){for(ge=q+1;ge<fe.length&&n(P.FullPaths[ge])!=Ve;++ge);for(Re.C=ge>=fe.length?-1:ge,ge=q+1;ge<fe.length&&n(P.FullPaths[ge])!=n(Ve);++ge);Re.R=ge>=fe.length?-1:ge,Re.type=1}else n(P.FullPaths[q+1]||"")==n(Ve)&&(Re.R=q+1),Re.type=2}}}function B(P,H){var j=H||{};if(j.fileType=="mad")return $s(P,j);switch(I(P),j.fileType){case"zip":return er(P,j)}var W=(function(We){for(var De=0,Pe=0,ct=0;ct<We.FileIndex.length;++ct){var zt=We.FileIndex[ct];if(zt.content){var Gt=zt.content.length;Gt>0&&(Gt<4096?De+=Gt+63>>6:Pe+=Gt+511>>9)}}for(var fr=We.FullPaths.length+3>>2,Gs=De+7>>3,ks=De+127>>7,cs=Gs+Pe+fr+ks,Ar=cs+127>>7,Aa=Ar<=109?0:Math.ceil((Ar-109)/127);cs+Ar+Aa+127>>7>Ar;)Aa=++Ar<=109?0:Math.ceil((Ar-109)/127);var pr=[1,Aa,Ar,ks,fr,Pe,De,0];return We.FileIndex[0].size=De<<6,pr[7]=(We.FileIndex[0].start=pr[0]+pr[1]+pr[2]+pr[3]+pr[4]+pr[5])+(pr[6]+7>>3),pr})(P),q=me(W[7]<<9),K=0,ce=0;{for(K=0;K<8;++K)q.write_shift(1,Ce[K]);for(K=0;K<8;++K)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),K=0;K<3;++K)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,W[2]),q.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:V),q.write_shift(4,W[3]),q.write_shift(-4,W[1]?W[0]-1:V),q.write_shift(4,W[1]),K=0;K<109;++K)q.write_shift(-4,K<W[2]?W[1]+K:-1)}if(W[1])for(ce=0;ce<W[1];++ce){for(;K<236+ce*127;++K)q.write_shift(-4,K<W[2]?W[1]+K:-1);q.write_shift(-4,ce===W[1]-1?V:ce+1)}var ge=function(We){for(ce+=We;K<ce-1;++K)q.write_shift(-4,K+1);We&&(++K,q.write_shift(-4,V))};for(ce=K=0,ce+=W[1];K<ce;++K)q.write_shift(-4,Ne.DIFSECT);for(ce+=W[2];K<ce;++K)q.write_shift(-4,Ne.FATSECT);ge(W[3]),ge(W[4]);for(var le=0,fe=0,he=P.FileIndex[0];le<P.FileIndex.length;++le)he=P.FileIndex[le],he.content&&(fe=he.content.length,!(fe<4096)&&(he.start=ce,ge(fe+511>>9)));for(ge(W[6]+7>>3);q.l&511;)q.write_shift(-4,Ne.ENDOFCHAIN);for(ce=K=0,le=0;le<P.FileIndex.length;++le)he=P.FileIndex[le],he.content&&(fe=he.content.length,!(!fe||fe>=4096)&&(he.start=ce,ge(fe+63>>6)));for(;q.l&511;)q.write_shift(-4,Ne.ENDOFCHAIN);for(K=0;K<W[4]<<2;++K){var Re=P.FullPaths[K];if(!Re||Re.length===0){for(le=0;le<17;++le)q.write_shift(4,0);for(le=0;le<3;++le)q.write_shift(4,-1);for(le=0;le<12;++le)q.write_shift(4,0);continue}he=P.FileIndex[K],K===0&&(he.start=he.size?he.start-1:V);var Ve=K===0&&j.root||he.name;if(fe=2*(Ve.length+1),q.write_shift(64,Ve,"utf16le"),q.write_shift(2,fe),q.write_shift(1,he.type),q.write_shift(1,he.color),q.write_shift(-4,he.L),q.write_shift(-4,he.R),q.write_shift(-4,he.C),he.clsid)q.write_shift(16,he.clsid,"hex");else for(le=0;le<4;++le)q.write_shift(4,0);q.write_shift(4,he.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,he.start),q.write_shift(4,he.size),q.write_shift(4,0)}for(K=1;K<P.FileIndex.length;++K)if(he=P.FileIndex[K],he.size>=4096)if(q.l=he.start+1<<9,_t&&Buffer.isBuffer(he.content))he.content.copy(q,q.l,0,he.size),q.l+=he.size+511&-512;else{for(le=0;le<he.size;++le)q.write_shift(1,he.content[le]);for(;le&511;++le)q.write_shift(1,0)}for(K=1;K<P.FileIndex.length;++K)if(he=P.FileIndex[K],he.size>0&&he.size<4096)if(_t&&Buffer.isBuffer(he.content))he.content.copy(q,q.l,0,he.size),q.l+=he.size+63&-64;else{for(le=0;le<he.size;++le)q.write_shift(1,he.content[le]);for(;le&63;++le)q.write_shift(1,0)}if(_t)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function L(P,H){var j=P.FullPaths.map(function(le){return le.toUpperCase()}),W=j.map(function(le){var fe=le.split("/");return fe[fe.length-(le.slice(-1)=="/"?2:1)]}),q=!1;H.charCodeAt(0)===47?(q=!0,H=j[0].slice(0,-1)+H):q=H.indexOf("/")!==-1;var K=H.toUpperCase(),ce=q===!0?j.indexOf(K):W.indexOf(K);if(ce!==-1)return P.FileIndex[ce];var ge=!K.match(Pu);for(K=K.replace(qn,""),ge&&(K=K.replace(Pu,"!")),ce=0;ce<j.length;++ce)if((ge?j[ce].replace(Pu,"!"):j[ce]).replace(qn,"")==K||(ge?W[ce].replace(Pu,"!"):W[ce]).replace(qn,"")==K)return P.FileIndex[ce];return null}var M=64,V=-2,Fe="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],Le="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:Fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Le,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Se(P,H,j){h();var W=B(P,j);f.writeFileSync(H,W)}function ne(P){for(var H=new Array(P.length),j=0;j<P.length;++j)H[j]=String.fromCharCode(P[j]);return H.join("")}function ye(P,H){var j=B(P,H);switch(H&&H.type||"buffer"){case"file":return h(),f.writeFileSync(H.filename,j),j;case"binary":return typeof j=="string"?j:ne(j);case"base64":return lf(typeof j=="string"?j:ne(j));case"buffer":if(_t)return Buffer.isBuffer(j)?j:ya(j);case"array":return typeof j=="string"?_s(j):j}return j}var ee;function b(P){try{var H=P.InflateRaw,j=new H;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)ee=P;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function te(P,H){if(!ee)return as(P,H);var j=ee.InflateRaw,W=new j,q=W._processChunk(P.slice(P.l),W._finishFlushFlag);return P.l+=W.bytesRead,q}function J(P){return ee?ee.deflateRawSync(P):ot(P)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(P){var H=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(H>>16|H>>8|H)&255}for(var xe=typeof Uint8Array<"u",Ee=xe?new Uint8Array(256):[],st=0;st<256;++st)Ee[st]=ve(st);function Y(P,H){var j=Ee[P&255];return H<=8?j>>>8-H:(j=j<<8|Ee[P>>8&255],H<=16?j>>>16-H:(j=j<<8|Ee[P>>16&255],j>>>24-H))}function Et(P,H){var j=H&7,W=H>>>3;return(P[W]|(j<=6?0:P[W+1]<<8))>>>j&3}function gt(P,H){var j=H&7,W=H>>>3;return(P[W]|(j<=5?0:P[W+1]<<8))>>>j&7}function It(P,H){var j=H&7,W=H>>>3;return(P[W]|(j<=4?0:P[W+1]<<8))>>>j&15}function ht(P,H){var j=H&7,W=H>>>3;return(P[W]|(j<=3?0:P[W+1]<<8))>>>j&31}function Ue(P,H){var j=H&7,W=H>>>3;return(P[W]|(j<=1?0:P[W+1]<<8))>>>j&127}function Ht(P,H,j){var W=H&7,q=H>>>3,K=(1<<j)-1,ce=P[q]>>>W;return j<8-W||(ce|=P[q+1]<<8-W,j<16-W)||(ce|=P[q+2]<<16-W,j<24-W)||(ce|=P[q+3]<<24-W),ce&K}function St(P,H,j){var W=H&7,q=H>>>3;return W<=5?P[q]|=(j&7)<<W:(P[q]|=j<<W&255,P[q+1]=(j&7)>>8-W),H+3}function Tt(P,H,j){var W=H&7,q=H>>>3;return j=(j&1)<<W,P[q]|=j,H+1}function dr(P,H,j){var W=H&7,q=H>>>3;return j<<=W,P[q]|=j&255,j>>>=8,P[q+1]=j,H+8}function gn(P,H,j){var W=H&7,q=H>>>3;return j<<=W,P[q]|=j&255,j>>>=8,P[q+1]=j&255,P[q+2]=j>>>8,H+16}function sn(P,H){var j=P.length,W=2*j>H?2*j:H+5,q=0;if(j>=H)return P;if(_t){var K=x2(W);if(P.copy)P.copy(K);else for(;q<P.length;++q)K[q]=P[q];return K}else if(xe){var ce=new Uint8Array(W);if(ce.set)ce.set(P);else for(;q<j;++q)ce[q]=P[q];return ce}return P.length=W,P}function Wr(P){for(var H=new Array(P),j=0;j<P;++j)H[j]=0;return H}function Pr(P,H,j){var W=1,q=0,K=0,ce=0,ge=0,le=P.length,fe=xe?new Uint16Array(32):Wr(32);for(K=0;K<32;++K)fe[K]=0;for(K=le;K<j;++K)P[K]=0;le=P.length;var he=xe?new Uint16Array(le):Wr(le);for(K=0;K<le;++K)fe[q=P[K]]++,W<q&&(W=q),he[K]=0;for(fe[0]=0,K=1;K<=W;++K)fe[K+16]=ge=ge+fe[K-1]<<1;for(K=0;K<le;++K)ge=P[K],ge!=0&&(he[K]=fe[ge+16]++);var Re=0;for(K=0;K<le;++K)if(Re=P[K],Re!=0)for(ge=Y(he[K],W)>>W-Re,ce=(1<<W+4-Re)-1;ce>=0;--ce)H[ge|ce<<Re]=Re&15|K<<4;return W}var xn=xe?new Uint16Array(512):Wr(512),Vn=xe?new Uint16Array(32):Wr(32);if(!xe){for(var $t=0;$t<512;++$t)xn[$t]=0;for($t=0;$t<32;++$t)Vn[$t]=0}(function(){for(var P=[],H=0;H<32;H++)P.push(5);Pr(P,Vn,32);var j=[];for(H=0;H<=143;H++)j.push(8);for(;H<=255;H++)j.push(9);for(;H<=279;H++)j.push(7);for(;H<=287;H++)j.push(8);Pr(j,xn,288)})();var Yr=(function(){for(var H=xe?new Uint8Array(32768):[],j=0,W=0;j<_e.length-1;++j)for(;W<_e[j+1];++W)H[W]=j;for(;W<32768;++W)H[W]=29;var q=xe?new Uint8Array(259):[];for(j=0,W=0;j<oe.length-1;++j)for(;W<oe[j+1];++W)q[W]=j;function K(ge,le){for(var fe=0;fe<ge.length;){var he=Math.min(65535,ge.length-fe),Re=fe+he==ge.length;for(le.write_shift(1,+Re),le.write_shift(2,he),le.write_shift(2,~he&65535);he-- >0;)le[le.l++]=ge[fe++]}return le.l}function ce(ge,le){for(var fe=0,he=0,Re=xe?new Uint16Array(32768):[];he<ge.length;){var Ve=Math.min(65535,ge.length-he);if(Ve<10){for(fe=St(le,fe,+(he+Ve==ge.length)),fe&7&&(fe+=8-(fe&7)),le.l=fe/8|0,le.write_shift(2,Ve),le.write_shift(2,~Ve&65535);Ve-- >0;)le[le.l++]=ge[he++];fe=le.l*8;continue}fe=St(le,fe,+(he+Ve==ge.length)+2);for(var We=0;Ve-- >0;){var De=ge[he];We=(We<<5^De)&32767;var Pe=-1,ct=0;if((Pe=Re[We])&&(Pe|=he&-32768,Pe>he&&(Pe-=32768),Pe<he))for(;ge[Pe+ct]==ge[he+ct]&&ct<250;)++ct;if(ct>2){De=q[ct],De<=22?fe=dr(le,fe,Ee[De+1]>>1)-1:(dr(le,fe,3),fe+=5,dr(le,fe,Ee[De-23]>>5),fe+=3);var zt=De<8?0:De-4>>2;zt>0&&(gn(le,fe,ct-oe[De]),fe+=zt),De=H[he-Pe],fe=dr(le,fe,Ee[De]>>3),fe-=3;var Gt=De<4?0:De-2>>1;Gt>0&&(gn(le,fe,he-Pe-_e[De]),fe+=Gt);for(var fr=0;fr<ct;++fr)Re[We]=he&32767,We=(We<<5^ge[he])&32767,++he;Ve-=ct-1}else De<=143?De=De+48:fe=Tt(le,fe,1),fe=dr(le,fe,Ee[De]),Re[We]=he&32767,++he}fe=dr(le,fe,0)-1}return le.l=(fe+7)/8|0,le.l}return function(le,fe){return le.length<8?K(le,fe):ce(le,fe)}})();function ot(P){var H=me(50+Math.floor(P.length*1.1)),j=Yr(P,H);return H.slice(0,j)}var Nt=xe?new Uint16Array(32768):Wr(32768),Hr=xe?new Uint16Array(32768):Wr(32768),Mt=xe?new Uint16Array(128):Wr(128),vn=1,Ws=1;function Bn(P,H){var j=ht(P,H)+257;H+=5;var W=ht(P,H)+1;H+=5;var q=It(P,H)+4;H+=4;for(var K=0,ce=xe?new Uint8Array(19):Wr(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,fe=xe?new Uint8Array(8):Wr(8),he=xe?new Uint8Array(8):Wr(8),Re=ce.length,Ve=0;Ve<q;++Ve)ce[Z[Ve]]=K=gt(P,H),le<K&&(le=K),fe[K]++,H+=3;var We=0;for(fe[0]=0,Ve=1;Ve<=le;++Ve)he[Ve]=We=We+fe[Ve-1]<<1;for(Ve=0;Ve<Re;++Ve)(We=ce[Ve])!=0&&(ge[Ve]=he[We]++);var De=0;for(Ve=0;Ve<Re;++Ve)if(De=ce[Ve],De!=0){We=Ee[ge[Ve]]>>8-De;for(var Pe=(1<<7-De)-1;Pe>=0;--Pe)Mt[We|Pe<<De]=De&7|Ve<<3}var ct=[];for(le=1;ct.length<j+W;)switch(We=Mt[Ue(P,H)],H+=We&7,We>>>=3){case 16:for(K=3+Et(P,H),H+=2,We=ct[ct.length-1];K-- >0;)ct.push(We);break;case 17:for(K=3+gt(P,H),H+=3;K-- >0;)ct.push(0);break;case 18:for(K=11+Ue(P,H),H+=7;K-- >0;)ct.push(0);break;default:ct.push(We),le<We&&(le=We);break}var zt=ct.slice(0,j),Gt=ct.slice(j);for(Ve=j;Ve<286;++Ve)zt[Ve]=0;for(Ve=W;Ve<30;++Ve)Gt[Ve]=0;return vn=Pr(zt,Nt,286),Ws=Pr(Gt,Hr,30),H}function fi(P,H){if(P[0]==3&&!(P[1]&3))return[po(H),2];for(var j=0,W=0,q=x2(H||1<<18),K=0,ce=q.length>>>0,ge=0,le=0;(W&1)==0;){if(W=gt(P,j),j+=3,W>>>1)W>>1==1?(ge=9,le=5):(j=Bn(P,j),ge=vn,le=Ws);else{j&7&&(j+=8-(j&7));var fe=P[j>>>3]|P[(j>>>3)+1]<<8;if(j+=32,fe>0)for(!H&&ce<K+fe&&(q=sn(q,K+fe),ce=q.length);fe-- >0;)q[K++]=P[j>>>3],j+=8;continue}for(;;){!H&&ce<K+32767&&(q=sn(q,K+32767),ce=q.length);var he=Ht(P,j,ge),Re=W>>>1==1?xn[he]:Nt[he];if(j+=Re&15,Re>>>=4,(Re>>>8&255)===0)q[K++]=Re;else{if(Re==256)break;Re-=257;var Ve=Re<8?0:Re-4>>2;Ve>5&&(Ve=0);var We=K+oe[Re];Ve>0&&(We+=Ht(P,j,Ve),j+=Ve),he=Ht(P,j,le),Re=W>>>1==1?Vn[he]:Hr[he],j+=Re&15,Re>>>=4;var De=Re<4?0:Re-2>>1,Pe=_e[Re];for(De>0&&(Pe+=Ht(P,j,De),j+=De),!H&&ce<We&&(q=sn(q,We+100),ce=q.length);K<We;)q[K]=q[K-Pe],++K}}}return H?[q,j+7>>>3]:[q.slice(0,K),j+7>>>3]}function as(P,H){var j=P.slice(P.l||0),W=fi(j,H);return P.l+=W[1],W[0]}function Hs(P,H){if(P)typeof console<"u"&&console.error(H);else throw new Error(H)}function Un(P,H){var j=P;hn(j,0);var W=[],q=[],K={FileIndex:W,FullPaths:q};k(K,{root:H.root});for(var ce=j.length-4;(j[ce]!=80||j[ce+1]!=75||j[ce+2]!=5||j[ce+3]!=6)&&ce>=0;)--ce;j.l=ce+4,j.l+=4;var ge=j.read_shift(2);j.l+=6;var le=j.read_shift(4);for(j.l=le,ce=0;ce<ge;++ce){j.l+=20;var fe=j.read_shift(4),he=j.read_shift(4),Re=j.read_shift(2),Ve=j.read_shift(2),We=j.read_shift(2);j.l+=8;var De=j.read_shift(4),Pe=c(j.slice(j.l+Re,j.l+Re+Ve));j.l+=Re+Ve+We;var ct=j.l;j.l=De+4,os(j,fe,he,K,Pe),j.l=ct}return K}function os(P,H,j,W,q){P.l+=2;var K=P.read_shift(2),ce=P.read_shift(2),ge=o(P);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var le=P.read_shift(4),fe=P.read_shift(4),he=P.read_shift(4),Re=P.read_shift(2),Ve=P.read_shift(2),We="",De=0;De<Re;++De)We+=String.fromCharCode(P[P.l++]);if(Ve){var Pe=c(P.slice(P.l,P.l+Ve));(Pe[21589]||{}).mt&&(ge=Pe[21589].mt),((q||{})[21589]||{}).mt&&(ge=q[21589].mt)}P.l+=Ve;var ct=P.slice(P.l,P.l+fe);switch(ce){case 8:ct=te(P,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var zt=!1;K&8&&(le=P.read_shift(4),le==134695760&&(le=P.read_shift(4),zt=!0),fe=P.read_shift(4),he=P.read_shift(4)),fe!=H&&Hs(zt,"Bad compressed size: "+H+" != "+fe),he!=j&&Hs(zt,"Bad uncompressed size: "+j+" != "+he),Je(W,We,ct,{unsafe:!0,mt:ge})}function er(P,H){var j=H||{},W=[],q=[],K=me(1),ce=j.compression?8:0,ge=0,le=0,fe=0,he=0,Re=0,Ve=P.FullPaths[0],We=Ve,De=P.FileIndex[0],Pe=[],ct=0;for(le=1;le<P.FullPaths.length;++le)if(We=P.FullPaths[le].slice(Ve.length),De=P.FileIndex[le],!(!De.size||!De.content||We=="Sh33tJ5")){var zt=he,Gt=me(We.length);for(fe=0;fe<We.length;++fe)Gt.write_shift(1,We.charCodeAt(fe)&127);Gt=Gt.slice(0,Gt.l),Pe[Re]=zD.buf(De.content,0);var fr=De.content;ce==8&&(fr=J(fr)),K=me(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,ge),K.write_shift(2,ce),De.mt?i(K,De.mt):K.write_shift(4,0),K.write_shift(-4,Pe[Re]),K.write_shift(4,fr.length),K.write_shift(4,De.content.length),K.write_shift(2,Gt.length),K.write_shift(2,0),he+=K.length,W.push(K),he+=Gt.length,W.push(Gt),he+=fr.length,W.push(fr),K=me(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,ge),K.write_shift(2,ce),K.write_shift(4,0),K.write_shift(-4,Pe[Re]),K.write_shift(4,fr.length),K.write_shift(4,De.content.length),K.write_shift(2,Gt.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,zt),ct+=K.l,q.push(K),ct+=Gt.length,q.push(Gt),++Re}return K=me(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,Re),K.write_shift(2,Re),K.write_shift(4,ct),K.write_shift(4,he),K.write_shift(2,0),rn([rn(W),rn(q),K])}var Ts={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ss(P,H){if(P.ctype)return P.ctype;var j=P.name||"",W=j.match(/\.([^\.]+)$/);return W&&Ts[W[1]]||H&&(W=(j=H).match(/[\.\\]([^\.\\])+$/),W&&Ts[W[1]])?Ts[W[1]]:"application/octet-stream"}function ls(P){for(var H=lf(P),j=[],W=0;W<H.length;W+=76)j.push(H.slice(W,W+76));return j.join(`\r
`)+`\r
`}function Ta(P){var H=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var he=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});H=H.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),H.charAt(0)==`
`&&(H="=0D"+H.slice(1)),H=H.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],W=H.split(`\r
`),q=0;q<W.length;++q){var K=W[q];if(K.length==0){j.push("");continue}for(var ce=0;ce<K.length;){var ge=76,le=K.slice(ce,ce+ge);le.charAt(ge-1)=="="?ge--:le.charAt(ge-2)=="="?ge-=2:le.charAt(ge-3)=="="&&(ge-=3),le=K.slice(ce,ce+ge),ce+=ge,ce<K.length&&(le+="="),j.push(le)}}return j.join(`\r
`)}function Sa(P){for(var H=[],j=0;j<P.length;++j){for(var W=P[j];j<=P.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+P[++j];H.push(W)}for(var q=0;q<H.length;++q)H[q]=H[q].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return _s(H.join(`\r
`))}function Kn(P,H,j){for(var W="",q="",K="",ce,ge=0;ge<10;++ge){var le=H[ge];if(!le||le.match(/^\s*$/))break;var fe=le.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":W=fe[2].trim();break;case"content-type":K=fe[2].trim();break;case"content-transfer-encoding":q=fe[2].trim();break}}switch(++ge,q.toLowerCase()){case"base64":ce=_s(Es(H.slice(ge).join("")));break;case"quoted-printable":ce=Sa(H.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var he=Je(P,W.slice(j.length),ce,{unsafe:!0});K&&(he.ctype=K)}function ka(P,H){if(ne(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=H&&H.root||"",W=(_t&&Buffer.isBuffer(P)?P.toString("binary"):ne(P)).split(`\r
`),q=0,K="";for(q=0;q<W.length;++q)if(K=W[q],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),j||(j=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),K.slice(0,j.length)!=j););var ce=(W[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var ge="--"+(ce[1]||""),le=[],fe=[],he={FileIndex:le,FullPaths:fe};k(he);var Re,Ve=0;for(q=0;q<W.length;++q){var We=W[q];We!==ge&&We!==ge+"--"||(Ve++&&Kn(he,W.slice(Re,q),j),Re=q)}return he}function $s(P,H){var j=H||{},W=j.boundary||"SheetJS";W="------="+W;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],K=P.FullPaths[0],ce=K,ge=P.FileIndex[0],le=1;le<P.FullPaths.length;++le)if(ce=P.FullPaths[le].slice(K.length),ge=P.FileIndex[le],!(!ge.size||!ge.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ct){return"_x"+ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ct){return"_u"+ct.charCodeAt(0).toString(16)+"_"});for(var fe=ge.content,he=_t&&Buffer.isBuffer(fe)?fe.toString("binary"):ne(fe),Re=0,Ve=Math.min(1024,he.length),We=0,De=0;De<=Ve;++De)(We=he.charCodeAt(De))>=32&&We<128&&++Re;var Pe=Re>=Ve*4/5;q.push(W),q.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+ce),q.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),q.push("Content-Type: "+Ss(ge,ce)),q.push(""),q.push(Pe?Ta(he):ls(he))}return q.push(W+`--\r
`),q.join(`\r
`)}function Qe(P){var H={};return k(H,P),H}function Je(P,H,j,W){var q=W&&W.unsafe;q||k(P);var K=!q&&Ze.find(P,H);if(!K){var ce=P.FullPaths[0];H.slice(0,ce.length)==ce?ce=H:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+H).replace("//","/")),K={name:s(H),type:2},P.FileIndex.push(K),P.FullPaths.push(ce),q||Ze.utils.cfb_gc(P)}return K.content=j,K.size=j?j.length:0,W&&(W.CLSID&&(K.clsid=W.CLSID),W.mt&&(K.mt=W.mt),W.ct&&(K.ct=W.ct)),K}function jt(P,H){k(P);var j=Ze.find(P,H);if(j){for(var W=0;W<P.FileIndex.length;++W)if(P.FileIndex[W]==j)return P.FileIndex.splice(W,1),P.FullPaths.splice(W,1),!0}return!1}function Jt(P,H,j){k(P);var W=Ze.find(P,H);if(W){for(var q=0;q<P.FileIndex.length;++q)if(P.FileIndex[q]==W)return P.FileIndex[q].name=s(j),P.FullPaths[q]=j,!0}return!1}function nr(P){I(P,!0)}return e.find=L,e.read=G,e.parse=d,e.write=ye,e.writeFile=Se,e.utils={cfb_new:Qe,cfb_add:Je,cfb_del:jt,cfb_mov:Jt,cfb_gc:nr,ReadShift:ju,CheckField:BS,prep_blob:hn,bconcat:rn,use_zlib:b,_deflateRaw:ot,_inflateRaw:as,consts:Ne},e})();function WD(t){return typeof t=="string"?Ed(t):Array.isArray(t)?mD(t):t}function Mf(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Ed(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Pi(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([WD(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=wo(e)),c.write(e),c.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function HD(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function kr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function k2(t,e){for(var r=[],n=kr(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function Sd(t){for(var e=[],r=kr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function kd(t){for(var e=[],r=kr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function $D(t){for(var e=[],r=kr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var G0=new Date(1899,11,30,0,0,0);function Xr(t,e){var r=t.getTime(),n=G0.getTime()+(t.getTimezoneOffset()-G0.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var vS=new Date,GD=G0.getTime()+(vS.getTimezoneOffset()-G0.getTimezoneOffset())*6e4,A2=vS.getTimezoneOffset();function Ad(t){var e=new Date;return e.setTime(t*24*60*60*1e3+GD),e.getTimezoneOffset()!==A2&&e.setTime(e.getTime()+(e.getTimezoneOffset()-A2)*6e4),e}function qD(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var C2=new Date("2017-02-19T19:06:09.000Z"),_S=isNaN(C2.getFullYear())?new Date("2/19/17"):C2,KD=_S.getFullYear()==2017;function cr(t,e){var r=new Date(t);if(KD)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(_S.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function fl(t,e){if(_t&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Pi(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Pi(aS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Pi(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Pi(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function ur(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=ur(t[r]));return e}function Er(t,e){for(var r="";r.length<e;)r+=t;return r}function oi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var XD=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ic(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&XD.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var YD=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],c=1;c<i.length;++c)o.push(s),o.push(i[c]);return o}})();function yS(t){return t?t.content&&t.type?fl(t.content,!0):t.data?Du(t.data):t.asNodeBuffer&&_t?Du(t.asNodeBuffer().toString("binary")):t.asBinary?Du(t.asBinary()):t._data&&t._data.getContent?Du(fl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function wS(t){if(!t)return null;if(t.data)return m2(t.data);if(t.asNodeBuffer&&_t)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?m2(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function QD(t){return t&&t.name.slice(-4)===".bin"?wS(t):yS(t)}function Ms(t,e){for(var r=t.FullPaths||kr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function bg(t,e){var r=Ms(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Vr(t,e,r){if(!r)return QD(bg(t,e));if(!e)return null;try{return Vr(t,e)}catch{return null}}function ys(t,e,r){if(!r)return yS(bg(t,e));if(!e)return null;try{return ys(t,e)}catch{return null}}function JD(t,e,r){return wS(bg(t,e))}function I2(t){for(var e=t.FullPaths||kr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function vt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return _t?n=ya(r):n=gD(r),Ze.utils.cfb_add(t,e,n)}Ze.utils.cfb_add(t,e,r)}else t.file(e,r)}function Og(){return Ze.utils.cfb_new()}function ES(t,e){switch(e.type){case"base64":return Ze.read(t,{type:"base64"});case"binary":return Ze.read(t,{type:"binary"});case"buffer":case"array":return Ze.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function bu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Dr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ZD=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,F2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,eP=/<[^>]*>/g,Mn=Dr.match(F2)?F2:eP,tP=/<\w*:/,rP=/<(\/?)\w+:/;function lt(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var o=t.match(ZD),c=0,f="",h=0,d="",g="",x=1;if(o)for(h=0;h!=o.length;++h){for(g=o[h],i=0;i!=g.length&&g.charCodeAt(i)!==61;++i);for(d=g.slice(0,i).trim();g.charCodeAt(i+1)==32;)++i;for(x=(s=g.charCodeAt(i+1))==34||s==39?1:0,f=g.slice(i+1+x,g.length-x),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=f,n[d.toLowerCase()]=f;else{var _=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(n[_]&&d.slice(c-3,c)=="ext")continue;n[_]=f,n[_.toLowerCase()]=f}}return n}function zi(t){return t.replace(rP,"<$1")}var TS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Lg=Sd(TS),Pt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(c,f){return TS[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,f){return String.fromCharCode(parseInt(f,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}})(),Mg=/[&<>'"]/g,nP=/[\u0000-\u0008\u000b-\u001f]/g;function Yt(t){var e=t+"";return e.replace(Mg,function(r){return Lg[r]}).replace(nP,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function R2(t){return Yt(t).replace(/ /g,"_x0020_")}var SS=/[\u0000-\u001f]/g;function Vg(t){var e=t+"";return e.replace(Mg,function(r){return Lg[r]}).replace(/\n/g,"<br/>").replace(SS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function sP(t){var e=t+"";return e.replace(Mg,function(r){return Lg[r]}).replace(SS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var N2=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function iP(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function or(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function wm(t){for(var e="",r=0,n=0,s=0,i=0,o=0,c=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,e+=String.fromCharCode(o);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}o=t.charCodeAt(r++),c=((n&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function D2(t){var e=po(2*t.length),r,n,s=1,i=0,o=0,c;for(n=0;n<t.length;n+=s)s=1,(c=t.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(t.charCodeAt(n+1)&63),s=2):c<240?(r=(c&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(c&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function P2(t){return ya(t,"binary").toString("utf8")}var r0="foo bar baz",Qt=_t&&(P2(r0)==wm(r0)&&P2||D2(r0)==wm(r0)&&D2)||wm,Pi=_t?function(t){return ya(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},uf=(function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),kS=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}})(),aP=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),oP=/<\/?(?:vt:)?variant>/g,lP=/<(?:vt:)([^>]*)>([\s\S]*)</;function b2(t,e){var r=lt(t),n=t.match(aP(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var o=i.replace(oP,"").match(lP);o&&s.push({v:Qt(o[2]),t:o[1]})}),s}var AS=/(^\s|\s$|\n)/;function pn(t,e){return"<"+t+(e.match(AS)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function ff(t){return kr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Be(t,e,r){return"<"+t+(r!=null?ff(r):"")+(e!=null?(e.match(AS)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function h1(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function cP(t,e){switch(typeof t){case"string":var r=Be("vt:lpwstr",Yt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((t|0)==t?"vt:i4":"vt:r8",Yt(String(t)));case"boolean":return Be("vt:bool",t?"true":"false")}if(t instanceof Date)return Be("vt:filetime",h1(t));throw new Error("Unable to serialize "+t)}function Bg(t){if(_t&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Qt(wo(Ng(t)));throw new Error("Bad input format: expected Buffer or string")}var hf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,qr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_l=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],xs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function uP(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function fP(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,o=n?-e:e;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var c=0;c<=5;++c,i/=256)t[r+c]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var O2=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},L2=_t?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ya(e)})):O2(t)}:O2,M2=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(la(t,s)));return n.join("").replace(qn,"")},Ug=_t?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(qn,""):M2(t,e,r)}:M2,V2=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},CS=_t?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):V2(t,e,r)}:V2,B2=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(cc(t,s)));return n.join("")},Vf=_t?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):B2(e,r,n)}:B2,IS=function(t,e){var r=vs(t,e);return r>0?Vf(t,e+4,e+4+r-1):""},FS=IS,RS=function(t,e){var r=vs(t,e);return r>0?Vf(t,e+4,e+4+r-1):""},NS=RS,DS=function(t,e){var r=2*vs(t,e);return r>0?Vf(t,e+4,e+4+r-1):""},PS=DS,bS=function(e,r){var n=vs(e,r);return n>0?Ug(e,r+4,r+4+n):""},OS=bS,LS=function(t,e){var r=vs(t,e);return r>0?Vf(t,e+4,e+4+r):""},MS=LS,VS=function(t,e){return uP(t,e)},q0=VS,jg=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};_t&&(FS=function(e,r){if(!Buffer.isBuffer(e))return IS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},NS=function(e,r){if(!Buffer.isBuffer(e))return RS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},PS=function(e,r){if(!Buffer.isBuffer(e))return DS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},OS=function(e,r){if(!Buffer.isBuffer(e))return bS(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},MS=function(e,r){if(!Buffer.isBuffer(e))return LS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},q0=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):VS(e,r)},jg=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var cc=function(t,e){return t[e]},la=function(t,e){return t[e+1]*256+t[e]},hP=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},vs=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Go=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},dP=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function ju(t,e){var r="",n,s,i=[],o,c,f,h;switch(e){case"dbcs":if(h=this.l,_t&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(la(this,h)),h+=2;t*=2;break;case"utf8":r=Vf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Ug(this,this.l,this.l+t);break;case"wstr":return ju.call(this,t,"dbcs");case"lpstr-ansi":r=FS(this,this.l),t=4+vs(this,this.l);break;case"lpstr-cp":r=NS(this,this.l),t=4+vs(this,this.l);break;case"lpwstr":r=PS(this,this.l),t=4+2*vs(this,this.l);break;case"lpp4":t=4+vs(this,this.l),r=OS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+vs(this,this.l),r=MS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=cc(this,this.l+t++))!==0;)i.push(t0(o));r=i.join("");break;case"_wstr":for(t=0,r="";(o=la(this,this.l+t))!==0;)i.push(t0(o)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",h=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return o=cc(this,h),this.l=h+1,c=ju.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(t0(la(this,h))),h+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return o=cc(this,h),this.l=h+1,c=ju.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(t0(cc(this,h))),h+=1}r=i.join("");break;default:switch(t){case 1:return n=cc(this,this.l),this.l++,n;case 2:return n=(e==="i"?hP:la)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Go:dP)(this,this.l),this.l+=4,n):(s=vs(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=q0(this,this.l):s=q0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=CS(this,this.l,t);break}}return this.l+=t,r}var pP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},mP=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},gP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function xP(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)gP(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var o=e.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,pP(this,e,this.l);break;case 8:if(n=8,r==="f"){fP(this,e,this.l);break}case 16:break;case-4:n=4,mP(this,e,this.l);break}return this.l+=n,this}function BS(t,e){var r=CS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function hn(t,e){t.l=e,t.read_shift=ju,t.chk=BS,t.write_shift=xP}function Ln(t,e){t.l+=e}function me(t){var e=po(t);return hn(e,0),e}function wa(t,e,r){if(t){var n,s,i;hn(t,t.l||0);for(var o=t.length,c=0,f=0;t.l<o;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var h=vf[c]||vf[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;f=t.l+i;var d=h.f&&h.f(t,i,r);if(t.l=f,e(d,h,c))return}}}function ss(){var t=[],e=_t?256:2048,r=function(h){var d=me(h);return hn(d,0),d},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(h){return n&&h<n.length-n.l?n:(s(),n=r(Math.max(h+1,e)))},o=function(){return s(),rn(t)},c=function(h){s(),n=h,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:c,end:o,_bufs:t}}function ke(t,e,r,n){var s=+e,i;if(!isNaN(s)){n||(n=vf[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=t.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var c=0;c!=4;++c)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&jg(r)&&t.push(r)}}function zu(t,e,r){var n=ur(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function U2(t,e,r){var n=ur(t);return n.s=zu(n.s,e.s,r),n.e=zu(n.e,e.s,r),n}function Wu(t,e){if(t.cRel&&t.c<0)for(t=ur(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=ur(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=it(t);return!t.cRel&&t.cRel!=null&&(r=yP(r)),!t.rRel&&t.rRel!=null&&(r=vP(r)),r}function Em(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+vr(t.s.c)+":"+(t.e.cRel?"":"$")+vr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Nr(t.s.r)+":"+(t.e.rRel?"":"$")+Nr(t.e.r):Wu(t.s,e.biff)+":"+Wu(t.e,e.biff)}function zg(t){return parseInt(_P(t),10)-1}function Nr(t){return""+(t+1)}function vP(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function _P(t){return t.replace(/\$(\d+)$/,"$1")}function Wg(t){for(var e=wP(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function vr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function yP(t){return t.replace(/^([A-Z])/,"$$$1")}function wP(t){return t.replace(/^\$([A-Z])/,"$1")}function EP(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function _r(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function it(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function is(t){var e=t.indexOf(":");return e==-1?{s:_r(t),e:_r(t)}:{s:_r(t.slice(0,e)),e:_r(t.slice(e+1))}}function xt(t,e){return typeof e>"u"||typeof e=="number"?xt(t.s,t.e):(typeof t!="string"&&(t=it(t)),typeof e!="string"&&(e=it(e)),t==e?t:t+":"+e)}function bt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function j2(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=js(t.z,r?Xr(e):e)}catch{}try{return t.w=js((t.XF||{}).numFmtId||(r?14:0),r?Xr(e):e)}catch{return""+e}}function xa(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ea[t.v]||t.v:e==null?j2(t,t.v):j2(t,e))}function Eo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function US(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),o=0,c=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?_r(n.origin):n.origin;o=f.r,c=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=bt(i["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),o==-1&&(h.e.r=o=d.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[g].length;++x)if(!(typeof e[g][x]>"u")){var _={v:e[g][x]},S=o+g,y=c+x;if(h.s.r>S&&(h.s.r=S),h.s.c>y&&(h.s.c=y),h.e.r<S&&(h.e.r=S),h.e.c<y&&(h.e.c=y),e[g][x]&&typeof e[g][x]=="object"&&!Array.isArray(e[g][x])&&!(e[g][x]instanceof Date))_=e[g][x];else if(Array.isArray(_.v)&&(_.f=e[g][x][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||nt[14],n.cellDates?(_.t="d",_.w=js(_.z,Xr(_.v))):(_.t="n",_.v=Xr(_.v),_.w=js(_.z,_.v))):_.t="s";if(s)i[S]||(i[S]=[]),i[S][y]&&i[S][y].z&&(_.z=i[S][y].z),i[S][y]=_;else{var T=it({c:y,r:S});i[T]&&i[T].z&&(_.z=i[T].z),i[T]=_}}}return h.s.c<1e7&&(i["!ref"]=xt(h)),i}function zc(t,e){return US(null,t,e)}function TP(t){return t.read_shift(4,"i")}function li(t,e){return e||(e=me(4)),e.write_shift(4,t),e}function bn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function nn(t,e){var r=!1;return e==null&&(r=!0,e=me(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function SP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function kP(t,e){return e||(e=me(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Hg(t,e){var r=t.l,n=t.read_shift(1),s=bn(t),i=[],o={t:s,h:s};if((n&1)!==0){for(var c=t.read_shift(4),f=0;f!=c;++f)i.push(SP(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function AP(t,e){var r=!1;return e==null&&(r=!0,e=me(15+4*t.t.length)),e.write_shift(1,0),nn(t.t,e),r?e.slice(0,e.l):e}var CP=Hg;function IP(t,e){var r=!1;return e==null&&(r=!0,e=me(23+4*t.t.length)),e.write_shift(1,1),nn(t.t,e),e.write_shift(4,1),kP({},e),r?e.slice(0,e.l):e}function zs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function yl(t,e){return e==null&&(e=me(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function wl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function El(t,e){return e==null&&(e=me(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var FP=bn,jS=nn;function $g(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function K0(t,e){var r=!1;return e==null&&(r=!0,e=me(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var RP=bn,d1=$g,Gg=K0;function qg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?q0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Go(e,0)>>2;return r?s/100:s}function zS(t,e){e==null&&(e=me(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function WS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function NP(t,e){return e||(e=me(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Tl=WS,Wc=NP;function Pn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function hl(t,e){return(e||me(8)).write_shift(8,t,"f")}function DP(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),c=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var h=el[s];h&&(e.rgb=pf(h));break;case 2:e.rgb=pf([o,c,f]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function X0(t,e){if(e||(e=me(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function PP(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function bP(t,e){e||(e=me(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function HS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function OP(t){return HS(t,1)}function LP(t){return HS(t,2)}var Kg=2,ts=3,n0=11,z2=12,Y0=19,s0=64,MP=65,VP=71,BP=4108,UP=4126,tn=80,$S=81,jP=[tn,$S],p1={1:{n:"CodePage",t:Kg},2:{n:"Category",t:tn},3:{n:"PresentationFormat",t:tn},4:{n:"ByteCount",t:ts},5:{n:"LineCount",t:ts},6:{n:"ParagraphCount",t:ts},7:{n:"SlideCount",t:ts},8:{n:"NoteCount",t:ts},9:{n:"HiddenCount",t:ts},10:{n:"MultimediaClipCount",t:ts},11:{n:"ScaleCrop",t:n0},12:{n:"HeadingPairs",t:BP},13:{n:"TitlesOfParts",t:UP},14:{n:"Manager",t:tn},15:{n:"Company",t:tn},16:{n:"LinksUpToDate",t:n0},17:{n:"CharacterCount",t:ts},19:{n:"SharedDoc",t:n0},22:{n:"HyperlinksChanged",t:n0},23:{n:"AppVersion",t:ts,p:"version"},24:{n:"DigSig",t:MP},26:{n:"ContentType",t:tn},27:{n:"ContentStatus",t:tn},28:{n:"Language",t:tn},29:{n:"Version",t:tn},255:{},2147483648:{n:"Locale",t:Y0},2147483651:{n:"Behavior",t:Y0},1919054434:{}},m1={1:{n:"CodePage",t:Kg},2:{n:"Title",t:tn},3:{n:"Subject",t:tn},4:{n:"Author",t:tn},5:{n:"Keywords",t:tn},6:{n:"Comments",t:tn},7:{n:"Template",t:tn},8:{n:"LastAuthor",t:tn},9:{n:"RevNumber",t:tn},10:{n:"EditTime",t:s0},11:{n:"LastPrinted",t:s0},12:{n:"CreatedDate",t:s0},13:{n:"ModifiedDate",t:s0},14:{n:"PageCount",t:ts},15:{n:"WordCount",t:ts},16:{n:"CharCount",t:ts},17:{n:"Thumbnail",t:VP},18:{n:"Application",t:tn},19:{n:"DocSecurity",t:ts},255:{},2147483648:{n:"Locale",t:Y0},2147483651:{n:"Behavior",t:Y0},1919054434:{}},W2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function WP(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var HP=WP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),el=ur(HP),Ea={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},GS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},g1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},i0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Xg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function $P(t){var e=Xg();if(!t||!t.match)return e;var r={};if((t.match(Mn)||[]).forEach(function(n){var s=lt(n);switch(s[0].replace(tP,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[g1[s.ContentType]]!==void 0&&e[g1[s.ContentType]].push(s.PartName);break}}),e.xmlns!==qr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function qS(t,e){var r=$D(g1),n=[],s;n[n.length]=Dr,n[n.length]=Be("Types",null,{xmlns:qr.CT,"xmlns:xsd":qr.xsd,"xmlns:xsi":qr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Be("Default",null,{Extension:f[0],ContentType:f[1]})}));var i=function(f){t[f]&&t[f].length>0&&(s=t[f][0],n[n.length]=Be("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:i0[f][e.bookType]||i0[f].xlsx}))},o=function(f){(t[f]||[]).forEach(function(h){n[n.length]=Be("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:i0[f][e.bookType]||i0[f].xlsx})})},c=function(f){(t[f]||[]).forEach(function(h){n[n.length]=Be("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[f][0]})})};return i("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var wt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function df(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Hu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Mn)||[]).forEach(function(s){var i=lt(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:bu(i.Target,e);r[c]=o,n[i.Id]=o}}),r["!id"]=n,r}function xc(t){var e=[Dr,Be("Relationships",null,{xmlns:qr.RELS})];return kr(t["!id"]).forEach(function(r){e[e.length]=Be("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Xt(t,e,r,n,s,i){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[wt.HLINK,wt.XPATH,wt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var GP="application/vnd.oasis.opendocument.spreadsheet";function qP(t,e){for(var r=Bg(t),n,s;n=hf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=lt(n[0],!1),s.path=="/"&&s.type!==GP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function KP(t){var e=[Dr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function H2(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function XP(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function YP(t){var e=[Dr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(H2(t[r][0],t[r][1])),e.push(XP("",t[r][0]));return e.push(H2("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function KS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+z0.version+"</meta:generator></office:meta></office:document-meta>"}var Us=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],QP=(function(){for(var t=new Array(Us.length),e=0;e<Us.length;++e){var r=Us[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function XS(t){var e={};t=Qt(t);for(var r=0;r<Us.length;++r){var n=Us[r],s=t.match(QP[r]);s!=null&&s.length>0&&(e[n[1]]=Pt(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=cr(e[n[1]]))}return e}function Tm(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=Yt(e),n[n.length]=r?Be(t,e,r):pn(t,e))}function YS(t,e){var r=e||{},n=[Dr,Be("cp:coreProperties",null,{"xmlns:cp":qr.CORE_PROPS,"xmlns:dc":qr.dc,"xmlns:dcterms":qr.dcterms,"xmlns:dcmitype":qr.dcmitype,"xmlns:xsi":qr.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Tm("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:h1(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&Tm("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:h1(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=Us.length;++i){var o=Us[i],c=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Tm(o[0],c,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var tl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],QS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function JS(t,e,r,n){var s=[];if(typeof t=="string")s=b2(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(d){return{v:d}}));var o=typeof e=="string"?b2(e,n).map(function(d){return d.v}):e,c=0,f=0;if(o.length>0)for(var h=0;h!==s.length;h+=2){switch(f=+s[h+1].v,s[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=o.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=o.slice(c,c+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=o.slice(c,c+f);break}c+=f}}function JP(t,e,r){var n={};return e||(e={}),t=Qt(t),tl.forEach(function(s){var i=(t.match(uf(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=Pt(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var o=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&JS(n.HeadingPairs,n.TitlesOfParts,e,r),e}function ZS(t){var e=[],r=Be;return t||(t={}),t.Application="SheetJS",e[e.length]=Dr,e[e.length]=Be("Properties",null,{xmlns:qr.EXT_PROPS,"xmlns:vt":qr.vt}),tl.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Yt(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Yt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var ZP=/<[^>]+>[^<]*/g;function eb(t,e){var r={},n="",s=t.match(ZP);if(s)for(var i=0;i!=s.length;++i){var o=s[i],c=lt(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Pt(c.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var f=o.split(">"),h=f[0].slice(4),d=f[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[n]=Pt(d);break;case"bool":r[n]=or(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=cr(d);break;case"cy":case"error":r[n]=Pt(d);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,f)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function ek(t){var e=[Dr,Be("Properties",null,{xmlns:qr.CUST_PROPS,"xmlns:vt":qr.vt})];if(!t)return e.join("");var r=1;return kr(t).forEach(function(s){++r,e[e.length]=Be("property",cP(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Yt(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var x1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Sm;function tb(t,e,r){Sm||(Sm=Sd(x1)),e=Sm[e]||e,t[e]=r}function rb(t,e){var r=[];return kr(x1).map(function(n){for(var s=0;s<Us.length;++s)if(Us[s][1]==n)return Us[s];for(s=0;s<tl.length;++s)if(tl[s][1]==n)return tl[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(pn(x1[n[1]]||n[1],s))}}),Be("DocumentProperties",r.join(""),{xmlns:xs.o})}function nb(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&kr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<Us.length;++o)if(i==Us[o][1])return;for(o=0;o<tl.length;++o)if(i==tl[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var c=t[i],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c=String(c),s.push(Be(R2(i),c,{"dt:dt":f}))}}),e&&kr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Be(R2(i),o,{"dt:dt":c}))}}),"<"+n+' xmlns="'+xs.o+'">'+s.join("")+"</"+n+">"}function Yg(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function sb(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var o=me(8);return o.write_shift(4,n),o.write_shift(4,s),o}function tk(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function rk(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function nk(t,e,r){return e===31?rk(t):tk(t,e,r)}function v1(t,e,r){return nk(t,e,r===!1?0:4)}function ib(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return nk(t,e,0)}function ab(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(qn,""),t.l-s&2&&(t.l+=2)}return r}function ob(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(qn,"");return r}function lb(t){var e=t.l,r=Q0(t,$S);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Q0(t,ts);return[r,n]}function cb(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(lb(t));return r}function $2(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),o=t.read_shift(4);n[i]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(qn,"").replace(Pu,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function sk(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function ub(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Q0(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==z2&&n!==e&&jP.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===z2?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return tk(t,n,4).replace(qn,"");case 31:return rk(t);case 64:return Yg(t);case 65:return sk(t);case 71:return ub(t);case 80:return v1(t,n,!i.raw).replace(qn,"");case 81:return ib(t,n).replace(qn,"");case 4108:return cb(t);case 4126:case 4127:return n==4127?ab(t):ob(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function G2(t,e){var r=me(4),n=me(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=me(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=sb(e);break;case 31:case 80:for(n=me(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return rn([r,n])}function q2(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],o=0,c=0,f=-1,h={};for(o=0;o!=s;++o){var d=t.read_shift(4),g=t.read_shift(4);i[o]=[d,g+r]}i.sort(function(O,N){return O[1]-N[1]});var x={};for(o=0;o!=s;++o){if(t.l!==i[o][1]){var _=!0;if(o>0&&e)switch(e[i[o-1][0]].t){case 2:t.l+2===i[o][1]&&(t.l+=2,_=!1);break;case 80:t.l<=i[o][1]&&(t.l=i[o][1],_=!1);break;case 4108:t.l<=i[o][1]&&(t.l=i[o][1],_=!1);break}if((!e||o==0)&&t.l<=i[o][1]&&(_=!1,t.l=i[o][1]),_)throw new Error("Read Error: Expected address "+i[o][1]+" at "+t.l+" :"+o)}if(e){var S=e[i[o][0]];if(x[S.n]=Q0(t,S.t,{raw:!0}),S.p==="version"&&(x[S.n]=String(x[S.n]>>16)+"."+("0000"+String(x[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(x[S.n]){case 0:x[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:si(c=x[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[S.n])}}else if(i[o][0]===1){if(c=x.CodePage=Q0(t,Kg),si(c),f!==-1){var y=t.l;t.l=i[f][1],h=$2(t,c),t.l=y}}else if(i[o][0]===0){if(c===0){f=o,t.l=i[o+1][1];continue}h=$2(t,c)}else{var T=h[i[o][0]],R;switch(t[t.l]){case 65:t.l+=4,R=sk(t);break;case 30:t.l+=4,R=v1(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,R=v1(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,R=t.read_shift(4,"i");break;case 19:t.l+=4,R=t.read_shift(4);break;case 5:t.l+=4,R=t.read_shift(8,"f");break;case 11:t.l+=4,R=Fr(t,4);break;case 64:t.l+=4,R=cr(Yg(t));break;default:throw new Error("unparsed value: "+t[t.l])}x[T]=R}}return t.l=r+n,x}var ik=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function fb(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function K2(t,e,r){var n=me(8),s=[],i=[],o=8,c=0,f=me(8),h=me(8);if(f.write_shift(4,2),f.write_shift(4,1200),h.write_shift(4,1),i.push(f),s.push(h),o+=8+f.length,!e){h=me(8),h.write_shift(4,0),s.unshift(h);var d=[me(4)];for(d[0].write_shift(4,t.length),c=0;c<t.length;++c){var g=t[c][0];for(f=me(8+2*(g.length+1)+(g.length%2?0:2)),f.write_shift(4,c+2),f.write_shift(4,g.length+1),f.write_shift(0,g,"dbcs");f.l!=f.length;)f.write_shift(1,0);d.push(f)}f=rn(d),i.unshift(f),o+=8+f.length}for(c=0;c<t.length;++c)if(!(e&&!e[t[c][0]])&&!(ik.indexOf(t[c][0])>-1||QS.indexOf(t[c][0])>-1)&&t[c][1]!=null){var x=t[c][1],_=0;if(e){_=+e[t[c][0]];var S=r[_];if(S.p=="version"&&typeof x=="string"){var y=x.split(".");x=(+y[0]<<16)+(+y[1]||0)}f=G2(S.t,x)}else{var T=fb(x);T==-1&&(T=31,x=String(x)),f=G2(T,x)}i.push(f),h=me(8),h.write_shift(4,e?_:2+c),s.push(h),o+=8+f.length}var R=8*(i.length+1);for(c=0;c<i.length;++c)s[c].write_shift(4,R),R+=i[c].length;return n.write_shift(4,o),n.write_shift(4,i.length),rn([n].concat(s).concat(i))}function X2(t,e,r){var n=t.content;if(!n)return{};hn(n,0);var s,i,o,c,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),d=n.read_shift(16);if(d!==Ze.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),c=n.read_shift(4),s===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);s===2&&(o=n.read_shift(16),f=n.read_shift(4));var g=q2(n,e),x={SystemIdentifier:h};for(var _ in g)x[_]=g[_];if(x.FMTID=i,s===1)return x;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var S;try{S=q2(n,null)}catch{}for(_ in S)x[_]=S[_];return x.FMTID=[i,o],x}function Y2(t,e,r,n,s,i){var o=me(s?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ze.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,s?68:48);var f=K2(t,r,n);if(c.push(f),s){var h=K2(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+f.length),c.push(h)}return rn(c)}function Xa(t,e){return t.read_shift(e),null}function hb(t,e){e||(e=me(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function db(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Fr(t,e){return t.read_shift(e)===1}function Hn(t,e){return e||(e=me(2)),e.write_shift(2,+!!t),e}function Br(t){return t.read_shift(2,"u")}function Vs(t,e){return e||(e=me(2)),e.write_shift(2,t),e}function ak(t,e){return db(t,e,Br)}function pb(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function ok(t,e,r){return r||(r=me(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Bf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?t.read_shift(n,s):"";return o}function mb(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),o=0,c,f={};s&&(o=t.read_shift(2)),n&&(c=t.read_shift(4));var h=i==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,h);return s&&(t.l+=4*o),n&&(t.l+=c),f.t=d,s||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function gb(t){var e=t.t||"",r=me(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=me(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return rn(s)}function dl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Uf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):dl(t,n,r)}function Sl(t,e,r){if(r.biff>5)return Uf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function lk(t,e,r){return r||(r=me(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function xb(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function vb(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(qn,"");return n&&(t.l+=24),s}function _b(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(i>>1,"utf16le").replace(qn,"");return r+o}function yb(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return vb(t);case"0303000000000000c000000000000046":return _b(t);default:throw new Error("Unsupported Moniker "+r)}}function a0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(qn,""):"";return r}function Q2(t,e){e||(e=me(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function wb(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,o,c,f,h="",d,g;s&16&&(i=a0(t,r-t.l)),s&128&&(o=a0(t,r-t.l)),(s&257)===257&&(c=a0(t,r-t.l)),(s&257)===1&&(f=yb(t,r-t.l)),s&8&&(h=a0(t,r-t.l)),s&32&&(d=t.read_shift(16)),s&64&&(g=Yg(t)),t.l=r;var x=o||c||f||"";x&&h&&(x+="#"+h),x||(x="#"+h),s&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var _={Target:x};return d&&(_.guid=d),g&&(_.time=g),i&&(_.Tooltip=i),_}function Eb(t){var e=me(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(i==28)n=n.slice(1),Q2(n,e);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var c=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)e.write_shift(2,c.charCodeAt(r));e.write_shift(2,0),i&8&&Q2(s>-1?n.slice(s+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)e.write_shift(1,n.charCodeAt(r+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function ck(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function uk(t,e){var r=ck(t);return r[3]=0,r}function Wi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function pl(t,e,r,n){return n||(n=me(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function Tb(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function Sb(t,e,r){return e===0?"":Sl(t,e,r)}function kb(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[s,i,o]}function fk(t){var e=t.read_shift(2),r=qg(t);return[e,r]}function Ab(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Bf(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Cd(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function hk(t,e){return e||(e=me(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function dk(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var Cb=dk;function pk(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function Ib(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Fb(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function kn(t){t.l+=2,t.l+=t.read_shift(2)}var Rb={0:kn,4:kn,5:kn,6:kn,7:Fb,8:kn,9:kn,10:kn,11:kn,12:kn,13:Ib,14:kn,15:kn,16:kn,17:kn,18:kn,19:kn,20:kn,21:pk};function Nb(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(Rb[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function o0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Qg(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=me(s);return i.write_shift(2,n),i.write_shift(2,e),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Db(t,e){return e===0||t.read_shift(2),1200}function Pb(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Sl(t,0,r);return t.read_shift(e+n-t.l),s}function bb(t,e){var r=!e||e.biff==8,n=me(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Ob(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Lb(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=Bf(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:i,name:o}}function Mb(t,e){var r=!e||e.biff>=8?2:1,n=me(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function Vb(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],o=0;o!=s&&t.l<r;++o)i.push(mb(t));return i.Count=n,i.Unique=s,i}function Bb(t,e){var r=me(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=gb(t[s]);var i=rn([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function Ub(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function jb(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function zb(t){var e=Tb(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function Wb(t){return t.read_shift(2),t.read_shift(4)}function J2(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function Hb(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),f=t.read_shift(2),h=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:o,FirstTab:c,Selected:f,TabRatio:h}}function $b(){var t=me(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Gb(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function qb(t){var e=me(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Kb(){}function Xb(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Bf(t,0,r),n}function Yb(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,i=me(s);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function Qb(t){var e=Wi(t);return e.isst=t.read_shift(4),e}function Jb(t,e,r,n){var s=me(10);return pl(t,e,n,s),s.write_shift(4,r),s}function Zb(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Wi(t);r.biff==2&&t.l++;var i=Uf(t,n-t.l,r);return s.val=i,s}function e8(t,e,r,n,s){var i=!s||s.biff==8,o=me(8+ +i+(1+i)*r.length);return pl(t,e,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function t8(t,e,r){var n=t.read_shift(2),s=Sl(t,0,r);return[n,s]}function r8(t,e,r,n){var s=r&&r.biff==5;n||(n=me(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var n8=Sl;function Z2(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),o=t.read_shift(s),c=t.read_shift(2),f=t.read_shift(2);return t.l=n,{s:{r:i,c},e:{r:o,c:f}}}function s8(t,e){var r=e.biff==8||!e.biff?4:2,n=me(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function i8(t){var e=t.read_shift(2),r=t.read_shift(2),n=fk(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function a8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(fk(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:i}}function o8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:i}}function l8(t,e,r,n){var s={},i=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(4),f=t.read_shift(2);return s.patternType=zP[c>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=c&127,s.icvBottom=c>>7&127,s.icvDiag=c>>14&127,s.dgDiag=c>>21&15,s.icvFore=f&127,s.icvBack=f>>7&127,s.fsxButton=f>>14&1),s}function c8(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=l8(t,e,n.fStyle,r),n}function ew(t,e,r,n){var s=r&&r.biff==5;n||(n=me(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function u8(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function f8(t){var e=me(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function tw(t,e,r){var n=Wi(t);(r.biff==2||e==9)&&++t.l;var s=pb(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function h8(t,e,r,n,s,i){var o=me(8);return pl(t,e,n,o),ok(r,i,o),o}function d8(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Wi(t),s=Pn(t);return n.val=s,n}function p8(t,e,r,n){var s=me(14);return pl(t,e,n,s),hl(r,s),s}var rw=Sb;function m8(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=dl(t,i),c=[];n>t.l;)c.push(Uf(t));return[i,s,o,c]}function nw(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=Ab(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var g8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function sw(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),f=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var h=dl(t,o,r);s&32&&(h=g8[h.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var g=n==t.l||c===0||!(d>0)?[]:NM(t,d,r,c);return{chKey:i,Name:h,itab:f,rgce:g}}function mk(t,e,r){if(r.biff<8)return x8(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(kb(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function x8(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Bf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function v8(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=dl(t,n,r),o=dl(t,s,r);return[i,o]}function _8(t,e,r){var n=dk(t);t.l++;var s=t.read_shift(1);return e-=8,[DM(t,e,r),s,n]}function iw(t,e,r){var n=Cb(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,FM(t,e,r)]}function y8(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function w8(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=Sl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},c,o,i]}}function E8(t,e,r){return w8(t,e,r)}function T8(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Cd(t));return r}function S8(t){var e=me(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)hk(t[r],e);return e}function k8(t,e,r){if(r&&r.biff<8)return C8(t,e,r);var n=pk(t),s=Nb(t,e-22,n[1]);return{cmo:n,ft:s}}var A8={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function C8(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((A8[n]||Ln)(t,e,r)),{cmo:[s,n,i],ft:o}}function I8(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:o=xb(t,6,r);var c=t.read_shift(2);t.read_shift(2),Br(t,2);var f=t.read_shift(2);t.l+=f;for(var h=1;h<t.lens.length-1;++h){if(t.l-n!=t.lens[h])throw new Error("TxO: bad continue record");var d=t[t.l],g=dl(t,t.lens[h+1]-t.lens[h]-1);if(s+=g,s.length>=(d?c:2*c))break}if(s.length!==c&&s.length!==c*2)throw new Error("cchText: "+c+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function F8(t,e){var r=Cd(t);t.l+=16;var n=wb(t,e-24);return[r,n]}function R8(t){var e=me(24),r=_r(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return rn([e,Eb(t[1])])}function N8(t,e){t.read_shift(2);var r=Cd(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(qn,""),[r,n]}function D8(t){var e=t[1].Tooltip,r=me(10+2*(e.length+1));r.write_shift(2,2048);var n=_r(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function P8(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=W2[r]||r,r=t.read_shift(2),e[1]=W2[r]||r,e}function b8(t){return t||(t=me(4)),t.write_shift(2,1),t.write_shift(2,1),t}function O8(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(uk(t));return r}function L8(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(uk(t));return r}function M8(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function gk(t,e,r){if(!r.cellStyles)return Ln(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var h={s,e:i,w:o,ixfe:c,flags:f};return(r.biff>=5||!r.biff)&&(h.level=f>>8&7),h}function V8(t,e){var r=me(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function B8(t,e){var r={};return e<32||(t.l+=16,r.header=Pn(t),r.footer=Pn(t),t.l+=2),r}function U8(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function j8(t){for(var e=me(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var z8=Wi,W8=ak,H8=Uf;function $8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function G8(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Wi(t);++t.l;var s=Sl(t,e-7,r);return n.t="str",n.val=s,n}function q8(t){var e=Wi(t);++t.l;var r=Pn(t);return e.t="n",e.val=r,e}function K8(t,e,r){var n=me(15);return Hf(n,t,e),n.write_shift(8,r,"f"),n}function X8(t){var e=Wi(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Y8(t,e,r){var n=me(9);return Hf(n,t,e),n.write_shift(2,r),n}function Q8(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function J8(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function Z8(t,e,r){var n=t.l+e,s=Wi(t),i=t.read_shift(2),o=dl(t,i,r);return t.l=n,s.t="str",s.val=o,s}var eO=[2,3,48,49,131,139,140,245],_1=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Sd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,f){var h=[],d=po(1);switch(f.type){case"base64":d=_s(Es(c));break;case"binary":d=_s(c);break;case"buffer":case"array":d=c;break}hn(d,0);var g=d.read_shift(1),x=!!(g&136),_=!1,S=!1;switch(g){case 2:break;case 3:break;case 48:_=!0,x=!0;break;case 49:_=!0,x=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var y=0,T=521;g==2&&(y=d.read_shift(2)),d.l+=3,g!=2&&(y=d.read_shift(4)),y>1048576&&(y=1e6),g!=2&&(T=d.read_shift(2));var R=d.read_shift(2),O=f.codepage||1252;g!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(O=t[d[d.l]]),d.l+=1,d.l+=2),S&&(d.l+=36);for(var N=[],U={},X=Math.min(d.length,g==2?521:T-10-(_?264:0)),G=S?32:11;d.l<X&&d[d.l]!=13;)switch(U={},U.name=of.utils.decode(O,d.slice(d.l,d.l+G)).replace(/[\u0000\r\n].*$/g,""),d.l+=G,U.type=String.fromCharCode(d.read_shift(1)),g!=2&&!S&&(U.offset=d.read_shift(4)),U.len=d.read_shift(1),g==2&&(U.offset=d.read_shift(2)),U.dec=d.read_shift(1),U.name.length&&N.push(U),g!=2&&(d.l+=S?13:14),U.type){case"B":(!_||U.len!=8)&&f.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(d[d.l]!==13&&(d.l=T-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=T;var k=0,F=0;for(h[0]=[],F=0;F!=N.length;++F)h[0][F]=N[F].name;for(;y-- >0;){if(d[d.l]===42){d.l+=R;continue}for(++d.l,h[++k]=[],F=0,F=0;F!=N.length;++F){var I=d.slice(d.l,d.l+N[F].len);d.l+=N[F].len,hn(I,0);var B=of.utils.decode(O,I);switch(N[F].type){case"C":B.trim().length&&(h[k][F]=B.replace(/\s+$/,""));break;case"D":B.length===8?h[k][F]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):h[k][F]=B;break;case"F":h[k][F]=parseFloat(B.trim());break;case"+":case"I":h[k][F]=S?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":h[k][F]=!0;break;case"N":case"F":h[k][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));h[k][F]="##MEMO##"+(S?parseInt(B.trim(),10):I.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(h[k][F]=+B||0);break;case"@":h[k][F]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":h[k][F]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":h[k][F]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[k][F]=-I.read_shift(-8,"f");break;case"B":if(_&&N[F].len==8){h[k][F]=I.read_shift(8,"f");break}case"G":case"P":I.l+=N[F].len;break;case"0":if(N[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[F].type)}}}if(g!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=N,h}function n(c,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var d=zc(r(c,h),h);return d["!cols"]=h.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete h.DBF,d}function s(c,f){try{return Eo(n(c,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,f){var h=f||{};if(+h.codepage>=0&&si(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var d=ss(),g=ed(c,{header:1,raw:!0,cellDates:!0}),x=g[0],_=g.slice(1),S=c["!cols"]||[],y=0,T=0,R=0,O=1;for(y=0;y<x.length;++y){if(((S[y]||{}).DBF||{}).name){x[y]=S[y].DBF.name,++R;continue}if(x[y]!=null){if(++R,typeof x[y]=="number"&&(x[y]=x[y].toString(10)),typeof x[y]!="string")throw new Error("DBF Invalid column name "+x[y]+" |"+typeof x[y]+"|");if(x.indexOf(x[y])!==y){for(T=0;T<1024;++T)if(x.indexOf(x[y]+"_"+T)==-1){x[y]+="_"+T;break}}}}var N=bt(c["!ref"]),U=[],X=[],G=[];for(y=0;y<=N.e.c-N.s.c;++y){var k="",F="",I=0,B=[];for(T=0;T<_.length;++T)_[T][y]!=null&&B.push(_[T][y]);if(B.length==0||x[y]==null){U[y]="?";continue}for(T=0;T<B.length;++T){switch(typeof B[T]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=B[T]instanceof Date?"D":"C";break;default:F="C"}I=Math.max(I,String(B[T]).length),k=k&&k!=F?"C":F}I>250&&(I=250),F=((S[y]||{}).DBF||{}).type,F=="C"&&S[y].DBF.len>I&&(I=S[y].DBF.len),k=="B"&&F=="N"&&(k="N",G[y]=S[y].DBF.dec,I=S[y].DBF.len),X[y]=k=="C"||F=="N"?I:i[k]||0,O+=X[y],U[y]=k}var L=d.next(32);for(L.write_shift(4,318902576),L.write_shift(4,_.length),L.write_shift(2,296+32*R),L.write_shift(2,O),y=0;y<4;++y)L.write_shift(4,0);for(L.write_shift(4,0|(+e[iS]||3)<<8),y=0,T=0;y<x.length;++y)if(x[y]!=null){var M=d.next(32),V=(x[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,V,"sbcs"),M.write_shift(1,U[y]=="?"?"C":U[y],"sbcs"),M.write_shift(4,T),M.write_shift(1,X[y]||i[U[y]]||0),M.write_shift(1,G[y]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),T+=X[y]||i[U[y]]||0}var Fe=d.next(264);for(Fe.write_shift(4,13),y=0;y<65;++y)Fe.write_shift(4,0);for(y=0;y<_.length;++y){var Ce=d.next(O);for(Ce.write_shift(1,0),T=0;T<x.length;++T)if(x[T]!=null)switch(U[T]){case"L":Ce.write_shift(1,_[y][T]==null?63:_[y][T]?84:70);break;case"B":Ce.write_shift(8,_[y][T]||0,"f");break;case"N":var Le="0";for(typeof _[y][T]=="number"&&(Le=_[y][T].toFixed(G[T]||0)),R=0;R<X[T]-Le.length;++R)Ce.write_shift(1,32);Ce.write_shift(1,Le,"sbcs");break;case"D":_[y][T]?(Ce.write_shift(4,("0000"+_[y][T].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(_[y][T].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+_[y][T].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(_[y][T]!=null?_[y][T]:"").slice(0,X[T]);for(Ce.write_shift(1,Ne,"sbcs"),R=0;R<X[T]-Ne.length;++R)Ce.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}})(),xk=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+kr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,_){var S=t[_];return typeof S=="number"?g2(S):S},n=function(x,_,S){var y=_.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return y==59?x:g2(y)};t["|"]=254;function s(x,_){switch(_.type){case"base64":return i(Es(x),_);case"binary":return i(x,_);case"buffer":return i(_t&&Buffer.isBuffer(x)?x.toString("binary"):wo(x),_);case"array":return i(fl(x),_)}throw new Error("Unrecognized type "+_.type)}function i(x,_){var S=x.split(/[\n\r]+/),y=-1,T=-1,R=0,O=0,N=[],U=[],X=null,G={},k=[],F=[],I=[],B=0,L;for(+_.codepage>=0&&si(+_.codepage);R!==S.length;++R){B=0;var M=S[R].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),V=M.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),Fe=V[0],Ce;if(M.length>0)switch(Fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&U.push(M.slice(3).replace(/;;/g,";"));break;case"C":var Le=!1,Ne=!1,Se=!1,ne=!1,ye=-1,ee=-1;for(O=1;O<V.length;++O)switch(V[O].charAt(0)){case"A":break;case"X":T=parseInt(V[O].slice(1))-1,Ne=!0;break;case"Y":for(y=parseInt(V[O].slice(1))-1,Ne||(T=0),L=N.length;L<=y;++L)N[L]=[];break;case"K":Ce=V[O].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(oi(Ce))?isNaN(Ic(Ce).getDate())||(Ce=cr(Ce)):(Ce=oi(Ce),X!==null&&Uc(X)&&(Ce=Ad(Ce))),Le=!0;break;case"E":ne=!0;var b=vc(V[O].slice(1),{r:y,c:T});N[y][T]=[N[y][T],b];break;case"S":Se=!0,N[y][T]=[N[y][T],"S5S"];break;case"G":break;case"R":ye=parseInt(V[O].slice(1))-1;break;case"C":ee=parseInt(V[O].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+M)}if(Le&&(N[y][T]&&N[y][T].length==2?N[y][T][0]=Ce:N[y][T]=Ce,X=null),Se){if(ne)throw new Error("SYLK shared formula cannot have own formula");var te=ye>-1&&N[ye][ee];if(!te||!te[1])throw new Error("SYLK shared formula cannot find base");N[y][T][1]=Ok(te[1],{r:y-ye,c:T-ee})}break;case"F":var J=0;for(O=1;O<V.length;++O)switch(V[O].charAt(0)){case"X":T=parseInt(V[O].slice(1))-1,++J;break;case"Y":for(y=parseInt(V[O].slice(1))-1,L=N.length;L<=y;++L)N[L]=[];break;case"M":B=parseInt(V[O].slice(1))/20;break;case"F":break;case"G":break;case"P":X=U[parseInt(V[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=V[O].slice(1).split(" "),L=parseInt(I[0],10);L<=parseInt(I[1],10);++L)B=parseInt(I[2],10),F[L-1]=B===0?{hidden:!0}:{wch:B},mo(F[L-1]);break;case"C":T=parseInt(V[O].slice(1))-1,F[T]||(F[T]={});break;case"R":y=parseInt(V[O].slice(1))-1,k[y]||(k[y]={}),B>0?(k[y].hpt=B,k[y].hpx=Rc(B)):B===0&&(k[y].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+M)}J<1&&(X=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+M)}}return k.length>0&&(G["!rows"]=k),F.length>0&&(G["!cols"]=F),_&&_.sheetRows&&(N=N.slice(0,_.sheetRows)),[N,G]}function o(x,_){var S=s(x,_),y=S[0],T=S[1],R=zc(y,_);return kr(T).forEach(function(O){R[O]=T[O]}),R}function c(x,_){return Eo(o(x,_),_)}function f(x,_,S,y){var T="C;Y"+(S+1)+";X"+(y+1)+";K";switch(x.t){case"n":T+=x.v||0,x.f&&!x.F&&(T+=";E"+nx(x.f,{r:S,c:y}));break;case"b":T+=x.v?"TRUE":"FALSE";break;case"e":T+=x.w||x.v;break;case"d":T+='"'+(x.w||x.v)+'"';break;case"s":T+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function h(x,_){_.forEach(function(S,y){var T="F;W"+(y+1)+" "+(y+1)+" ";S.hidden?T+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=mf(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=gf(S.wpx)),typeof S.wch=="number"&&(T+=Math.round(S.wch))),T.charAt(T.length-1)!=" "&&x.push(T)})}function d(x,_){_.forEach(function(S,y){var T="F;";S.hidden?T+="M0;":S.hpt?T+="M"+20*S.hpt+";":S.hpx&&(T+="M"+20*xf(S.hpx)+";"),T.length>2&&x.push(T+"R"+(y+1))})}function g(x,_){var S=["ID;PWXL;N;E"],y=[],T=bt(x["!ref"]),R,O=Array.isArray(x),N=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),x["!cols"]&&h(S,x["!cols"]),x["!rows"]&&d(S,x["!rows"]),S.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var U=T.s.r;U<=T.e.r;++U)for(var X=T.s.c;X<=T.e.c;++X){var G=it({r:U,c:X});R=O?(x[U]||[])[X]:x[G],!(!R||R.v==null&&(!R.f||R.F))&&y.push(f(R,x,U,X))}return S.join(N)+N+y.join(N)+N+"E"+N}return{to_workbook:c,to_sheet:o,from_sheet:g}})(),vk=(function(){function t(i,o){switch(o.type){case"base64":return e(Es(i),o);case"binary":return e(i,o);case"buffer":return e(_t&&Buffer.isBuffer(i)?i.toString("binary"):wo(i),o);case"array":return e(fl(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var c=i.split(`
`),f=-1,h=-1,d=0,g=[];d!==c.length;++d){if(c[d].trim()==="BOT"){g[++f]=[],h=0;continue}if(!(f<0)){var x=c[d].trim().split(","),_=x[0],S=x[1];++d;for(var y=c[d]||"";(y.match(/["]/g)||[]).length&1&&d<c.length-1;)y+=`
`+c[++d];switch(y=y.trim(),+_){case-1:if(y==="BOT"){g[++f]=[],h=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?g[f][h]=!0:y==="FALSE"?g[f][h]=!1:isNaN(oi(S))?isNaN(Ic(S).getDate())?g[f][h]=S:g[f][h]=cr(S):g[f][h]=oi(S),++h;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),g[f][h++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(i,o){return zc(t(i,o),o)}function n(i,o){return Eo(r(i,o),o)}var s=(function(){var i=function(f,h,d,g,x){f.push(h),f.push(d+","+g),f.push('"'+x.replace(/"/g,'""')+'"')},o=function(f,h,d,g){f.push(h+","+d),f.push(h==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(f){var h=[],d=bt(f["!ref"]),g,x=Array.isArray(f);i(h,"TABLE",0,1,"sheetjs"),i(h,"VECTORS",0,d.e.r-d.s.r+1,""),i(h,"TUPLES",0,d.e.c-d.s.c+1,""),i(h,"DATA",0,0,"");for(var _=d.s.r;_<=d.e.r;++_){o(h,-1,0,"BOT");for(var S=d.s.c;S<=d.e.c;++S){var y=it({r:_,c:S});if(g=x?(f[_]||[])[S]:f[y],!g){o(h,1,0,"");continue}switch(g.t){case"n":var T=g.w;!T&&g.v!=null&&(T=g.v),T==null?g.f&&!g.F?o(h,1,0,"="+g.f):o(h,1,0,""):o(h,0,T,"V");break;case"b":o(h,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=js(g.z||nt[14],Xr(cr(g.v)))),o(h,0,g.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var R=`\r
`,O=h.join(R);return O}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),_k=(function(){function t(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,x){for(var _=g.split(`
`),S=-1,y=-1,T=0,R=[];T!==_.length;++T){var O=_[T].trim().split(":");if(O[0]==="cell"){var N=_r(O[1]);if(R.length<=N.r)for(S=R.length;S<=N.r;++S)R[S]||(R[S]=[]);switch(S=N.r,y=N.c,O[2]){case"t":R[S][y]=t(O[3]);break;case"v":R[S][y]=+O[3];break;case"vtf":var U=O[O.length-1];case"vtc":switch(O[3]){case"nl":R[S][y]=!!+O[4];break;default:R[S][y]=+O[4];break}O[2]=="vtf"&&(R[S][y]=[R[S][y],U])}}}return x&&x.sheetRows&&(R=R.slice(0,x.sheetRows)),R}function n(g,x){return zc(r(g,x),x)}function s(g,x){return Eo(n(g,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(g){if(!g||!g["!ref"])return"";for(var x=[],_=[],S,y="",T=is(g["!ref"]),R=Array.isArray(g),O=T.s.r;O<=T.e.r;++O)for(var N=T.s.c;N<=T.e.c;++N)if(y=it({r:O,c:N}),S=R?(g[O]||[])[N]:g[y],!(!S||S.v==null||S.t==="z")){switch(_=["cell",y,"t"],S.t){case"s":case"str":_.push(e(S.v));break;case"n":S.f?(_[2]="vtf",_[3]="n",_[4]=S.v,_[5]=e(S.f)):(_[2]="v",_[3]=S.v);break;case"b":_[2]="vt"+(S.f?"f":"c"),_[3]="nl",_[4]=S.v?"1":"0",_[5]=e(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var U=Xr(cr(S.v));_[2]="vtc",_[3]="nd",_[4]=""+U,_[5]=S.w||js(S.z||nt[14],U);break;case"e":continue}x.push(_.join(":"))}return x.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(g){return[i,o,c,o,h(g),f].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}})(),Fc=(function(){function t(d,g,x,_,S){S.raw?g[x][_]=d:d===""||(d==="TRUE"?g[x][_]=!0:d==="FALSE"?g[x][_]=!1:isNaN(oi(d))?isNaN(Ic(d).getDate())?g[x][_]=d:g[x][_]=cr(d):g[x][_]=oi(d))}function e(d,g){var x=g||{},_=[];if(!d||d.length===0)return _;for(var S=d.split(/[\r\n]/),y=S.length-1;y>=0&&S[y].length===0;)--y;for(var T=10,R=0,O=0;O<=y;++O)R=S[O].indexOf(" "),R==-1?R=S[O].length:R++,T=Math.max(T,R);for(O=0;O<=y;++O){_[O]=[];var N=0;for(t(S[O].slice(0,T).trim(),_,O,N,x),N=1;N<=(S[O].length-T)/10+1;++N)t(S[O].slice(T+(N-1)*10,T+N*10).trim(),_,O,N,x)}return x.sheetRows&&(_=_.slice(0,x.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var g={},x=!1,_=0,S=0;_<d.length;++_)(S=d.charCodeAt(_))==34?x=!x:!x&&S in r&&(g[S]=(g[S]||0)+1);S=[];for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&S.push([g[_],_]);if(!S.length){g=n;for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&S.push([g[_],_])}return S.sort(function(y,T){return y[0]-T[0]||n[y[1]]-n[T[1]]}),r[S.pop()[1]]||44}function i(d,g){var x=g||{},_="",S=x.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(_=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(_=d.charAt(4),d=d.slice(6)):_=s(d.slice(0,1024)):x&&x.FS?_=x.FS:_=s(d.slice(0,1024));var T=0,R=0,O=0,N=0,U=0,X=_.charCodeAt(0),G=!1,k=0,F=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var I=x.dateNF!=null?UD(x.dateNF):null;function B(){var L=d.slice(N,U),M={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)M.t="z";else if(x.raw)M.t="s",M.v=L;else if(L.trim().length===0)M.t="s",M.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(M.t="s",M.v=L.slice(2,-1).replace(/""/g,'"')):mL(L)?(M.t="n",M.f=L.slice(1)):(M.t="s",M.v=L);else if(L=="TRUE")M.t="b",M.v=!0;else if(L=="FALSE")M.t="b",M.v=!1;else if(!isNaN(O=oi(L)))M.t="n",x.cellText!==!1&&(M.w=L),M.v=O;else if(!isNaN(Ic(L).getDate())||I&&L.match(I)){M.z=x.dateNF||nt[14];var V=0;I&&L.match(I)&&(L=jD(L,x.dateNF,L.match(I)||[]),V=1),x.cellDates?(M.t="d",M.v=cr(L,V)):(M.t="n",M.v=Xr(cr(L,V))),x.cellText!==!1&&(M.w=js(M.z,M.v instanceof Date?Xr(M.v):M.v)),x.cellNF||delete M.z}else M.t="s",M.v=L;if(M.t=="z"||(x.dense?(S[T]||(S[T]=[]),S[T][R]=M):S[it({c:R,r:T})]=M),N=U+1,F=d.charCodeAt(N),y.e.c<R&&(y.e.c=R),y.e.r<T&&(y.e.r=T),k==X)++R;else if(R=0,++T,x.sheetRows&&x.sheetRows<=T)return!0}e:for(;U<d.length;++U)switch(k=d.charCodeAt(U)){case 34:F===34&&(G=!G);break;case X:case 10:case 13:if(!G&&B())break e;break}return U-N>0&&B(),S["!ref"]=xt(y),S}function o(d,g){return!(g&&g.PRN)||g.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,g):zc(e(d,g),g)}function c(d,g){var x="",_=g.type=="string"?[0,0,0,0]:fx(d,g);switch(g.type){case"base64":x=Es(d);break;case"binary":x=d;break;case"buffer":g.codepage==65001?x=d.toString("utf8"):g.codepage&&typeof of<"u"||(x=_t&&Buffer.isBuffer(d)?d.toString("binary"):wo(d));break;case"array":x=fl(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+g.type)}return _[0]==239&&_[1]==187&&_[2]==191?x=Qt(x.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?x=Qt(x):g.type=="binary"&&typeof of<"u",x.slice(0,19)=="socialcalc:version:"?_k.to_sheet(g.type=="string"?x:Qt(x),g):o(x,g)}function f(d,g){return Eo(c(d,g),g)}function h(d){for(var g=[],x=bt(d["!ref"]),_,S=Array.isArray(d),y=x.s.r;y<=x.e.r;++y){for(var T=[],R=x.s.c;R<=x.e.c;++R){var O=it({r:y,c:R});if(_=S?(d[y]||[])[R]:d[O],!_||_.v==null){T.push("          ");continue}for(var N=(_.w||(xa(_),_.w)||"").slice(0,10);N.length<10;)N+=" ";T.push(N+(R===0?" ":""))}g.push(T.join(""))}return g.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:h}})();function tO(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=xk.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Fc.to_workbook(t,e)}}var rl=(function(){function t(b,te,J){if(b){hn(b,b.l||0);for(var Z=J.Enum||ye;b.l<b.length;){var oe=b.read_shift(2),_e=Z[oe]||Z[65535],ve=b.read_shift(2),xe=b.l+ve,Ee=_e.f&&_e.f(b,ve,J);if(b.l=xe,te(Ee,_e,oe))return}}}function e(b,te){switch(te.type){case"base64":return r(_s(Es(b)),te);case"binary":return r(_s(b),te);case"buffer":case"array":return r(b,te)}throw"Unsupported type "+te.type}function r(b,te){if(!b)return b;var J=te||{},Z=J.dense?[]:{},oe="Sheet1",_e="",ve=0,xe={},Ee=[],st=[],Y={s:{r:0,c:0},e:{r:0,c:0}},Et=J.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)J.Enum=ye,t(b,function(Ue,Ht,St){switch(St){case 0:J.vers=Ue,Ue>=4096&&(J.qpro=!0);break;case 6:Y=Ue;break;case 204:Ue&&(_e=Ue);break;case 222:_e=Ue;break;case 15:case 51:J.qpro||(Ue[1].v=Ue[1].v.slice(1));case 13:case 14:case 16:St==14&&(Ue[2]&112)==112&&(Ue[2]&15)>1&&(Ue[2]&15)<15&&(Ue[1].z=J.dateNF||nt[14],J.cellDates&&(Ue[1].t="d",Ue[1].v=Ad(Ue[1].v))),J.qpro&&Ue[3]>ve&&(Z["!ref"]=xt(Y),xe[oe]=Z,Ee.push(oe),Z=J.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ve=Ue[3],oe=_e||"Sheet"+(ve+1),_e="");var Tt=J.dense?(Z[Ue[0].r]||[])[Ue[0].c]:Z[it(Ue[0])];if(Tt){Tt.t=Ue[1].t,Tt.v=Ue[1].v,Ue[1].z!=null&&(Tt.z=Ue[1].z),Ue[1].f!=null&&(Tt.f=Ue[1].f);break}J.dense?(Z[Ue[0].r]||(Z[Ue[0].r]=[]),Z[Ue[0].r][Ue[0].c]=Ue[1]):Z[it(Ue[0])]=Ue[1];break}},J);else if(b[2]==26||b[2]==14)J.Enum=ee,b[2]==14&&(J.qpro=!0,b.l=0),t(b,function(Ue,Ht,St){switch(St){case 204:oe=Ue;break;case 22:Ue[1].v=Ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ue[3]>ve&&(Z["!ref"]=xt(Y),xe[oe]=Z,Ee.push(oe),Z=J.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ve=Ue[3],oe="Sheet"+(ve+1)),Et>0&&Ue[0].r>=Et)break;J.dense?(Z[Ue[0].r]||(Z[Ue[0].r]=[]),Z[Ue[0].r][Ue[0].c]=Ue[1]):Z[it(Ue[0])]=Ue[1],Y.e.c<Ue[0].c&&(Y.e.c=Ue[0].c),Y.e.r<Ue[0].r&&(Y.e.r=Ue[0].r);break;case 27:Ue[14e3]&&(st[Ue[14e3][0]]=Ue[14e3][1]);break;case 1537:st[Ue[0]]=Ue[1],Ue[0]==ve&&(oe=Ue[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(Z["!ref"]=xt(Y),xe[_e||oe]=Z,Ee.push(_e||oe),!st.length)return{SheetNames:Ee,Sheets:xe};for(var gt={},It=[],ht=0;ht<st.length;++ht)xe[Ee[ht]]?(It.push(st[ht]||Ee[ht]),gt[st[ht]]=xe[st[ht]]||xe[Ee[ht]]):(It.push(st[ht]),gt[st[ht]]={"!ref":"A1"});return{SheetNames:It,Sheets:gt}}function n(b,te){var J=te||{};if(+J.codepage>=0&&si(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=ss(),oe=bt(b["!ref"]),_e=Array.isArray(b),ve=[];je(Z,0,i(1030)),je(Z,6,f(oe));for(var xe=Math.min(oe.e.r,8191),Ee=oe.s.r;Ee<=xe;++Ee)for(var st=Nr(Ee),Y=oe.s.c;Y<=oe.e.c;++Y){Ee===oe.s.r&&(ve[Y]=vr(Y));var Et=ve[Y]+st,gt=_e?(b[Ee]||[])[Y]:b[Et];if(!(!gt||gt.t=="z"))if(gt.t=="n")(gt.v|0)==gt.v&&gt.v>=-32768&&gt.v<=32767?je(Z,13,_(Ee,Y,gt.v)):je(Z,14,y(Ee,Y,gt.v));else{var It=xa(gt);je(Z,15,g(Ee,Y,It.slice(0,239)))}}return je(Z,1),Z.end()}function s(b,te){var J=te||{};if(+J.codepage>=0&&si(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=ss();je(Z,0,o(b));for(var oe=0,_e=0;oe<b.SheetNames.length;++oe)(b.Sheets[b.SheetNames[oe]]||{})["!ref"]&&je(Z,27,ne(b.SheetNames[oe],_e++));var ve=0;for(oe=0;oe<b.SheetNames.length;++oe){var xe=b.Sheets[b.SheetNames[oe]];if(!(!xe||!xe["!ref"])){for(var Ee=bt(xe["!ref"]),st=Array.isArray(xe),Y=[],Et=Math.min(Ee.e.r,8191),gt=Ee.s.r;gt<=Et;++gt)for(var It=Nr(gt),ht=Ee.s.c;ht<=Ee.e.c;++ht){gt===Ee.s.r&&(Y[ht]=vr(ht));var Ue=Y[ht]+It,Ht=st?(xe[gt]||[])[ht]:xe[Ue];if(!(!Ht||Ht.t=="z"))if(Ht.t=="n")je(Z,23,B(gt,ht,ve,Ht.v));else{var St=xa(Ht);je(Z,22,k(gt,ht,ve,St.slice(0,239)))}}++ve}}return je(Z,1),Z.end()}function i(b){var te=me(2);return te.write_shift(2,b),te}function o(b){var te=me(26);te.write_shift(2,4096),te.write_shift(2,4),te.write_shift(4,0);for(var J=0,Z=0,oe=0,_e=0;_e<b.SheetNames.length;++_e){var ve=b.SheetNames[_e],xe=b.Sheets[ve];if(!(!xe||!xe["!ref"])){++oe;var Ee=is(xe["!ref"]);J<Ee.e.r&&(J=Ee.e.r),Z<Ee.e.c&&(Z=Ee.e.c)}}return J>8191&&(J=8191),te.write_shift(2,J),te.write_shift(1,oe),te.write_shift(1,Z),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(1,1),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(4,0),te}function c(b,te,J){var Z={s:{c:0,r:0},e:{c:0,r:0}};return te==8&&J.qpro?(Z.s.c=b.read_shift(1),b.l++,Z.s.r=b.read_shift(2),Z.e.c=b.read_shift(1),b.l++,Z.e.r=b.read_shift(2),Z):(Z.s.c=b.read_shift(2),Z.s.r=b.read_shift(2),te==12&&J.qpro&&(b.l+=2),Z.e.c=b.read_shift(2),Z.e.r=b.read_shift(2),te==12&&J.qpro&&(b.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function f(b){var te=me(8);return te.write_shift(2,b.s.c),te.write_shift(2,b.s.r),te.write_shift(2,b.e.c),te.write_shift(2,b.e.r),te}function h(b,te,J){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(Z[0].c=b.read_shift(1),Z[3]=b.read_shift(1),Z[0].r=b.read_shift(2),b.l+=2):(Z[2]=b.read_shift(1),Z[0].c=b.read_shift(2),Z[0].r=b.read_shift(2)),Z}function d(b,te,J){var Z=b.l+te,oe=h(b,te,J);if(oe[1].t="s",J.vers==20768){b.l++;var _e=b.read_shift(1);return oe[1].v=b.read_shift(_e,"utf8"),oe}return J.qpro&&b.l++,oe[1].v=b.read_shift(Z-b.l,"cstr"),oe}function g(b,te,J){var Z=me(7+J.length);Z.write_shift(1,255),Z.write_shift(2,te),Z.write_shift(2,b),Z.write_shift(1,39);for(var oe=0;oe<Z.length;++oe){var _e=J.charCodeAt(oe);Z.write_shift(1,_e>=128?95:_e)}return Z.write_shift(1,0),Z}function x(b,te,J){var Z=h(b,te,J);return Z[1].v=b.read_shift(2,"i"),Z}function _(b,te,J){var Z=me(7);return Z.write_shift(1,255),Z.write_shift(2,te),Z.write_shift(2,b),Z.write_shift(2,J,"i"),Z}function S(b,te,J){var Z=h(b,te,J);return Z[1].v=b.read_shift(8,"f"),Z}function y(b,te,J){var Z=me(13);return Z.write_shift(1,255),Z.write_shift(2,te),Z.write_shift(2,b),Z.write_shift(8,J,"f"),Z}function T(b,te,J){var Z=b.l+te,oe=h(b,te,J);if(oe[1].v=b.read_shift(8,"f"),J.qpro)b.l=Z;else{var _e=b.read_shift(2);U(b.slice(b.l,b.l+_e),oe),b.l+=_e}return oe}function R(b,te,J){var Z=te&32768;return te&=-32769,te=(Z?b:0)+(te>=8192?te-16384:te),(Z?"":"$")+(J?vr(te):Nr(te))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(b,te){hn(b,0);for(var J=[],Z=0,oe="",_e="",ve="",xe="";b.l<b.length;){var Ee=b[b.l++];switch(Ee){case 0:J.push(b.read_shift(8,"f"));break;case 1:_e=R(te[0].c,b.read_shift(2),!0),oe=R(te[0].r,b.read_shift(2),!1),J.push(_e+oe);break;case 2:{var st=R(te[0].c,b.read_shift(2),!0),Y=R(te[0].r,b.read_shift(2),!1);_e=R(te[0].c,b.read_shift(2),!0),oe=R(te[0].r,b.read_shift(2),!1),J.push(st+Y+":"+_e+oe)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(b.read_shift(2));break;case 6:{for(var Et="";Ee=b[b.l++];)Et+=String.fromCharCode(Ee);J.push('"'+Et.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:xe=J.pop(),ve=J.pop(),J.push(["AND","OR"][Ee-20]+"("+ve+","+xe+")");break;default:if(Ee<32&&N[Ee])xe=J.pop(),ve=J.pop(),J.push(ve+N[Ee]+xe);else if(O[Ee]){if(Z=O[Ee][1],Z==69&&(Z=b[b.l++]),Z>J.length){console.error("WK1 bad formula parse 0x"+Ee.toString(16)+":|"+J.join("|")+"|");return}var gt=J.slice(-Z);J.length-=Z,J.push(O[Ee][0]+"("+gt.join(",")+")")}else return Ee<=7?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=24?console.error("WK1 unsupported op "+Ee.toString(16)):Ee<=30?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=115?console.error("WK1 unsupported function opcode "+Ee.toString(16)):console.error("WK1 unrecognized opcode "+Ee.toString(16))}}J.length==1?te[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function X(b){var te=[{c:0,r:0},{t:"n",v:0},0];return te[0].r=b.read_shift(2),te[3]=b[b.l++],te[0].c=b[b.l++],te}function G(b,te){var J=X(b);return J[1].t="s",J[1].v=b.read_shift(te-4,"cstr"),J}function k(b,te,J,Z){var oe=me(6+Z.length);oe.write_shift(2,b),oe.write_shift(1,J),oe.write_shift(1,te),oe.write_shift(1,39);for(var _e=0;_e<Z.length;++_e){var ve=Z.charCodeAt(_e);oe.write_shift(1,ve>=128?95:ve)}return oe.write_shift(1,0),oe}function F(b,te){var J=X(b);J[1].v=b.read_shift(2);var Z=J[1].v>>1;if(J[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return J[1].v=Z,J}function I(b,te){var J=X(b),Z=b.read_shift(4),oe=b.read_shift(4),_e=b.read_shift(2);if(_e==65535)return Z===0&&oe===3221225472?(J[1].t="e",J[1].v=15):Z===0&&oe===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var ve=_e&32768;return _e=(_e&32767)-16446,J[1].v=(1-ve*2)*(oe*Math.pow(2,_e+32)+Z*Math.pow(2,_e)),J}function B(b,te,J,Z){var oe=me(14);if(oe.write_shift(2,b),oe.write_shift(1,J),oe.write_shift(1,te),Z==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var _e=0,ve=0,xe=0,Ee=0;return Z<0&&(_e=1,Z=-Z),ve=Math.log2(Z)|0,Z/=Math.pow(2,ve-31),Ee=Z>>>0,(Ee&2147483648)==0&&(Z/=2,++ve,Ee=Z>>>0),Z-=Ee,Ee|=2147483648,Ee>>>=0,Z*=Math.pow(2,32),xe=Z>>>0,oe.write_shift(4,xe),oe.write_shift(4,Ee),ve+=16383+(_e?32768:0),oe.write_shift(2,ve),oe}function L(b,te){var J=I(b);return b.l+=te-14,J}function M(b,te){var J=X(b),Z=b.read_shift(4);return J[1].v=Z>>6,J}function V(b,te){var J=X(b),Z=b.read_shift(8,"f");return J[1].v=Z,J}function Fe(b,te){var J=V(b);return b.l+=te-10,J}function Ce(b,te){return b[b.l+te-1]==0?b.read_shift(te,"cstr"):""}function Le(b,te){var J=b[b.l++];J>te-1&&(J=te-1);for(var Z="";Z.length<J;)Z+=String.fromCharCode(b[b.l++]);return Z}function Ne(b,te,J){if(!(!J.qpro||te<21)){var Z=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var oe=b.read_shift(te-21,"cstr");return[Z,oe]}}function Se(b,te){for(var J={},Z=b.l+te;b.l<Z;){var oe=b.read_shift(2);if(oe==14e3){for(J[oe]=[0,""],J[oe][0]=b.read_shift(2);b[b.l];)J[oe][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return J}function ne(b,te){var J=me(5+b.length);J.write_shift(2,14e3),J.write_shift(2,te);for(var Z=0;Z<b.length;++Z){var oe=b.charCodeAt(Z);J[J.l++]=oe>127?95:oe}return J[J.l++]=0,J}var ye={0:{n:"BOF",f:Br},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:Le},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:Fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}})();function rO(t){var e={},r=t.match(Mn),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=lt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=Ig[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var nO=(function(){var t=uf("t"),e=uf("rPr");function r(i){var o=i.match(t);if(!o)return{t:"s",v:""};var c={t:"s",v:Pt(o[1])},f=i.match(e);return f&&(c.s=rO(f[1])),c}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(c){return c.v})}})(),sO=(function(){var e=/(\r\n|\n)/g;function r(s,i,o){var c=[];s.u&&c.push("text-decoration: underline;"),s.uval&&c.push("text-underline-style:"+s.uval+";"),s.sz&&c.push("font-size:"+s.sz+"pt;"),s.outline&&c.push("text-effect: outline;"),s.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var f=s.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),o.push("</"+f+">")),o.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),iO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,aO=/<(?:\w+:)?r>/,oO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Jg(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Pt(Qt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Qt(t),r&&(n.h=Vg(n.t))):t.match(aO)&&(n.r=Qt(t),n.t=Pt(Qt((t.replace(oO,"").match(iO)||[]).join("").replace(Mn,""))),r&&(n.h=sO(nO(n.r)))),n):{t:""}}var lO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,cO=/<(?:\w+:)?(?:si|sstItem)>/g,uO=/<\/(?:\w+:)?(?:si|sstItem)>/;function fO(t,e){var r=[],n="";if(!t)return r;var s=t.match(lO);if(s){n=s[2].replace(cO,"").split(uO);for(var i=0;i!=n.length;++i){var o=Jg(n[i].trim(),e);o!=null&&(r[r.length]=o)}s=lt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var hO=/^\s|\s$|[\t\n\r]/;function yk(t,e){if(!e.bookSST)return"";var r=[Dr];r[r.length]=Be("sst",null,{xmlns:_l[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(hO)&&(i+=' xml:space="preserve"'),i+=">"+Yt(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function dO(t){return[t.read_shift(4),t.read_shift(4)]}function pO(t,e){var r=[],n=!1;return wa(t,function(i,o,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function mO(t,e){return e||(e=me(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var gO=AP;function xO(t){var e=ss();ke(e,159,mO(t));for(var r=0;r<t.length;++r)ke(e,19,gO(t[r]));return ke(e,160),e.end()}function wk(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function ha(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function vO(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=ha(t,4),e.U=ha(t,4),e.W=ha(t,4),e}function _O(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function yO(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(_O(t));return e}function wO(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function EO(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=ha(t,4),e.U=ha(t,4),e.W=ha(t,4),e}function TO(t){var e=EO(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Ek(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Tk(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function SO(t){var e=ha(t);switch(e.Minor){case 2:return[e.Minor,kO(t)];case 3:return[e.Minor,AO()];case 4:return[e.Minor,CO(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function kO(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Ek(t,r),s=Tk(t,t.length-t.l);return{t:"Std",h:n,v:s}}function AO(){throw new Error("File is password-protected: ECMA-376 Extensible")}function CO(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Mn,function(i){var o=lt(i);switch(zi(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){n[c]=o[c]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function IO(t,e){var r={},n=r.EncryptionVersionInfo=ha(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=Ek(t,s),e-=s,r.EncryptionVerifier=Tk(t,e),r}function FO(t){var e={},r=e.EncryptionVersionInfo=ha(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Zg(t){var e=0,r,n=wk(t),s=n.length+1,i,o,c,f,h;for(r=po(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)o=r[i],c=(e&16384)===0?0:1,f=e<<1&32767,h=c|f,e=h^o;return e^52811}var Sk=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,c){return n(o^c)},i=function(o){for(var c=e[o.length-1],f=104,h=o.length-1;h>=0;--h)for(var d=o[h],g=0;g!=7;++g)d&64&&(c^=r[f]),d*=2,--f;return c};return function(o){for(var c=wk(o),f=i(c),h=c.length,d=po(16),g=0;g!=16;++g)d[g]=0;var x,_,S;for((h&1)===1&&(x=f>>8,d[h]=s(t[0],x),--h,x=f&255,_=c[c.length-1],d[h]=s(_,x));h>0;)--h,x=f>>8,d[h]=s(c[h],x),--h,x=f&255,d[h]=s(c[h],x);for(h=15,S=15-c.length;S>0;)x=f>>8,d[h]=s(t[S],x),--h,--S,x=f&255,d[h]=s(c[h],x),--h,--S;return d}})(),RO=function(t,e,r,n,s){s||(s=e),n||(n=Sk(t));var i,o;for(i=0;i!=e.length;++i)o=e[i],o^=n[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,n]},NO=function(t){var e=0,r=Sk(t);return function(n){var s=RO("",n,e,r);return e=s[1],s[0]}};function DO(t,e,r,n){var s={key:Br(t),verificationBytes:Br(t)};return r.password&&(s.verifier=Zg(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=NO(r.password)),s}function PO(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=FO(t):n.Data=IO(t,e),n}function bO(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?PO(t,e-2,n):DO(t,r.biff>=8?e:e-2,r,n),n}var kk=(function(){function t(s,i){switch(i.type){case"base64":return e(Es(s),i);case"binary":return e(s,i);case"buffer":return e(_t&&Buffer.isBuffer(s)?s.toString("binary"):wo(s),i);case"array":return e(fl(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var o=i||{},c=o.dense?[]:{},f=s.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(d,g){Array.isArray(c)&&(c[g]=[]);for(var x=/\\\w+\b/g,_=0,S,y=-1;S=x.exec(d);){switch(S[0]){case"\\cell":var T=d.slice(_,x.lastIndex-S[0].length);if(T[0]==" "&&(T=T.slice(1)),++y,T.length){var R={v:T,t:"s"};Array.isArray(c)?c[g][y]=R:c[it({r:g,c:y})]=R}break}_=x.lastIndex}y>h.e.c&&(h.e.c=y)}),c["!ref"]=xt(h),c}function r(s,i){return Eo(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],o=bt(s["!ref"]),c,f=Array.isArray(s),h=o.s.r;h<=o.e.r;++h){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var g=it({r:h,c:d});c=f?(s[h]||[])[d]:s[g],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(xa(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function OO(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function pf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function LO(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),o=s-i;if(o===0)return[0,0,e];var c=0,f=0,h=s+i;switch(f=o/(h>1?2-h:h),s){case e:c=((r-n)/o+6)%6;break;case r:c=(n-e)/o+2;break;case n:c=(e-r)/o+4;break}return[c/6,f,h/2]}function MO(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,o=[i,i,i],c=6*e,f;if(r!==0)switch(c|0){case 0:case 6:f=s*c,o[0]+=s,o[1]+=f;break;case 1:f=s*(2-c),o[0]+=f,o[1]+=s;break;case 2:f=s*(c-2),o[1]+=s,o[2]+=f;break;case 3:f=s*(4-c),o[1]+=f,o[2]+=s;break;case 4:f=s*(c-4),o[2]+=s,o[0]+=f;break;case 5:f=s*(6-c),o[2]+=f,o[0]+=s;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function J0(t,e){if(e===0)return t;var r=LO(OO(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),pf(MO(r))}var Ak=6,VO=15,BO=1,Dn=Ak;function mf(t){return Math.floor((t+Math.round(128/Dn)/256)*Dn)}function gf(t){return Math.floor((t-5)/Dn*100+.5)/100}function Z0(t){return Math.round((t*Dn+5)/Dn*256)/256}function km(t){return Z0(gf(mf(t)))}function ex(t){var e=Math.abs(t-km(t)),r=Dn;if(e>.005)for(Dn=BO;Dn<VO;++Dn)Math.abs(t-km(t))<=e&&(e=Math.abs(t-km(t)),r=Dn);Dn=r}function mo(t){t.width?(t.wpx=mf(t.width),t.wch=gf(t.wpx),t.MDW=Dn):t.wpx?(t.wch=gf(t.wpx),t.width=Z0(t.wch),t.MDW=Dn):typeof t.wch=="number"&&(t.width=Z0(t.wch),t.wpx=mf(t.width),t.MDW=Dn),t.customWidth&&delete t.customWidth}var UO=96,Ck=UO;function xf(t){return t*96/Ck}function Rc(t){return t*Ck/96}var jO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function zO(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(Mn)||[]).forEach(function(o){var c=lt(o);switch(zi(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},c.diagonalUp&&(s.diagonalUp=or(c.diagonalUp)),c.diagonalDown&&(s.diagonalDown=or(c.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function WO(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(Mn)||[]).forEach(function(o){var c=lt(o);switch(zi(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":c.patternType&&(s.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),c.indexed&&(s.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(s.bgColor.theme=parseInt(c.theme,10)),c.tint&&(s.bgColor.tint=parseFloat(c.tint)),c.rgb&&(s.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),c.theme&&(s.fgColor.theme=parseInt(c.theme,10)),c.tint&&(s.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(s.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function HO(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(Mn)||[]).forEach(function(o){var c=lt(o);switch(zi(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":c.val&&(s.name=Qt(c.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=c.val?or(c.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=c.val?or(c.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(c.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=c.val?or(c.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=c.val?or(c.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=c.val?or(c.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=c.val?or(c.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=c.val?or(c.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":c.val&&(s.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(s.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(s.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(s.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Ig[parseInt(c.val,10)];break;case"<color":if(s.color||(s.color={}),c.auto&&(s.color.auto=or(c.auto)),c.rgb)s.color.rgb=c.rgb.slice(-6);else if(c.indexed){s.color.index=parseInt(c.indexed,10);var f=el[s.color.index];s.color.index==81&&(f=el[1]),f||(f=el[1]),s.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(s.color.theme=parseInt(c.theme,10),c.tint&&(s.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=J0(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function $O(t,e,r){e.NumberFmt=[];for(var n=kr(nt),s=0;s<n.length;++s)e.NumberFmt[n[s]]=nt[n[s]];var i=t[0].match(Mn);if(i)for(s=0;s<i.length;++s){var o=lt(i[s]);switch(zi(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Pt(Qt(o.formatCode)),f=parseInt(o.numFmtId,10);if(e.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=c}fa(c,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function GO(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Be("numFmt",null,{numFmtId:n,formatCode:Yt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Be("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var l0=["numFmtId","fillId","fontId","borderId","xfId"],c0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function qO(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Mn)||[]).forEach(function(i){var o=lt(i),c=0;switch(zi(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],c=0;c<l0.length;++c)n[l0[c]]&&(n[l0[c]]=parseInt(n[l0[c]],10));for(c=0;c<c0.length;++c)n[c0[c]]&&(n[c0[c]]=or(n[c0[c]]));if(e.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[c]){n.numFmtId=c;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};o.vertical&&(f.vertical=o.vertical),o.horizontal&&(f.horizontal=o.horizontal),o.textRotation!=null&&(f.textRotation=o.textRotation),o.indent&&(f.indent=o.indent),o.wrapText&&(f.wrapText=or(o.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function KO(t){var e=[];return e[e.length]=Be("cellXfs",null),t.forEach(function(r){e[e.length]=Be("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Be("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var XO=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,h){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=c.match(e))&&$O(g,d,h),(g=c.match(s))&&HO(g,d,f,h),(g=c.match(n))&&WO(g,d,f,h),(g=c.match(i))&&zO(g,d,f,h),(g=c.match(r))&&qO(g,d,h),d}})();function Ik(t,e){var r=[Dr,Be("styleSheet",null,{xmlns:_l[0],"xmlns:vt":qr.vt})],n;return t.SSF&&(n=GO(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=KO(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function YO(t,e){var r=t.read_shift(2),n=bn(t);return[r,n]}function QO(t,e,r){r||(r=me(6+4*e.length)),r.write_shift(2,t),nn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function JO(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=PP(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var c=t.read_shift(1);c>0&&(n.family=c);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=DP(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=bn(t),n}function ZO(t,e){e||(e=me(153)),e.write_shift(2,t.sz*20),bP(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),X0(t.color,e);var n=0;return n=2,e.write_shift(1,n),nn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var e5=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Am,t5=Ln;function aw(t,e){e||(e=me(84)),Am||(Am=Sd(e5));var r=Am[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(X0({auto:1},e),X0({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function r5(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function Fk(t,e,r){r||(r=me(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Cu(t,e){return e||(e=me(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var n5=Ln;function s5(t,e){return e||(e=me(51)),e.write_shift(1,0),Cu(null,e),Cu(null,e),Cu(null,e),Cu(null,e),Cu(null,e),e.length>e.l?e.slice(0,e.l):e}function i5(t,e){return e||(e=me(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),K0(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function a5(t,e,r){var n=me(2052);return n.write_shift(4,t),K0(e,n),K0(r,n),n.length>n.l?n.slice(0,n.l):n}function o5(t,e,r){var n={};n.NumberFmt=[];for(var s in nt)n.NumberFmt[s]=nt[s];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return wa(t,function(f,h,d){switch(d){case 44:n.NumberFmt[f[0]]=f[1],fa(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=J0(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d),o=!0;break;case 38:i.pop(),o=!1;break;default:if(h.T>0)i.push(d);else if(h.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function l5(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(ke(t,615,li(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&ke(t,44,QO(s,e[s]))}),ke(t,616))}}function c5(t){var e=1;ke(t,611,li(e)),ke(t,43,ZO({sz:12,color:{theme:1},name:"Calibri",family:2})),ke(t,612)}function u5(t){var e=2;ke(t,603,li(e)),ke(t,45,aw({patternType:"none"})),ke(t,45,aw({patternType:"gray125"})),ke(t,604)}function f5(t){var e=1;ke(t,613,li(e)),ke(t,46,s5()),ke(t,614)}function h5(t){var e=1;ke(t,626,li(e)),ke(t,47,Fk({numFmtId:0},65535)),ke(t,627)}function d5(t,e){ke(t,617,li(e.length)),e.forEach(function(r){ke(t,47,Fk(r,0))}),ke(t,618)}function p5(t){var e=1;ke(t,619,li(e)),ke(t,48,i5({xfId:0,name:"Normal"})),ke(t,620)}function m5(t){var e=0;ke(t,505,li(e)),ke(t,506)}function g5(t){var e=0;ke(t,508,a5(e,"TableStyleMedium9","PivotStyleMedium4")),ke(t,509)}function x5(t,e){var r=ss();return ke(r,278),l5(r,t.SSF),c5(r),u5(r),f5(r),h5(r),d5(r,e.cellXfs),p5(r),m5(r),g5(r),ke(r,279),r.end()}var v5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function _5(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Mn)||[]).forEach(function(s){var i=lt(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[v5.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function y5(){}function w5(){}var E5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,T5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,S5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function k5(t,e,r){e.themeElements={};var n;[["clrScheme",E5,_5],["fontScheme",T5,y5],["fmtScheme",S5,w5]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var A5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Rk(t,e){(!t||t.length===0)&&(t=tx());var r,n={};if(!(r=t.match(A5)))throw new Error("themeElements not found in theme");return k5(r[0],n,e),n.raw=t,n}function tx(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Dr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function C5(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var o;try{o=ES(i,{type:"array"})}catch{return}var c=ys(o,"theme/theme/theme1.xml",!0);if(c)return Rk(c,r)}}function I5(t){return t.read_shift(4)}function F5(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=R5(t,4);break;case 2:e.xclrValue=ck(t);break;case 3:e.xclrValue=I5(t);break;case 4:t.l+=4;break}return t.l+=8,e}function R5(t,e){return Ln(t,e)}function N5(t,e){return Ln(t,e)}function D5(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=F5(t);break;case 6:n[1]=N5(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function P5(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(D5(t,r-t.l));return{ixfe:n,ext:i}}function b5(t,e){e.forEach(function(r){r[0]})}function O5(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:bn(t)}}function L5(t){var e=me(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),nn(t.name,e),e.slice(0,e.l)}function M5(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function V5(t){var e=me(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function B5(t,e){var r=me(8+2*e.length);return r.write_shift(4,t),nn(e,r),r.slice(0,r.l)}function U5(t){return t.l+=4,t.read_shift(4)!=0}function j5(t,e){var r=me(8);return r.write_shift(4,t),r.write_shift(4,1),r}function z5(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,c=2;return wa(t,function(f,h,d){switch(d){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(g){c==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):c==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:i.push(d),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!h.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function W5(){var t=ss();return ke(t,332),ke(t,334,li(1)),ke(t,335,L5({name:"XLDAPR",version:12e4,flags:3496657072})),ke(t,336),ke(t,339,B5(1,"XLDAPR")),ke(t,52),ke(t,35,li(514)),ke(t,4096,li(0)),ke(t,4097,Vs(1)),ke(t,36),ke(t,53),ke(t,340),ke(t,337,j5(1)),ke(t,51,V5([[1,0]])),ke(t,338),ke(t,333),t.end()}function H5(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,o;return t.replace(Mn,function(c){var f=lt(c);switch(zi(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==f.name&&(o=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):i==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+f.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),n}function Nk(){var t=[Dr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function $5(t){var e=[];if(!t)return e;var r=1;return(t.match(Mn)||[]).forEach(function(n){var s=lt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function G5(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=it(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function q5(t,e,r){var n=[];return wa(t,function(i,o,c){switch(c){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function K5(t,e,r,n){if(!t)return t;var s=n||{},i=!1;wa(t,function(c,f,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},s)}function X5(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var fc=1024;function Dk(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Be("xml",null,{"xmlns:v":xs.v,"xmlns:o":xs.o,"xmlns:x":xs.x,"xmlns:mv":xs.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];fc<t*1e3;)fc+=1e3;return e.forEach(function(i){var o=_r(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var f=c.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Be("v:fill",f,c),d={on:"t",obscured:"t"};++fc,s=s.concat(["<v:shape"+ff({id:"_x0000_s"+fc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Be("v:shadow",null,d),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",pn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),pn("x:AutoFill","False"),pn("x:Row",String(o.r)),pn("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function ow(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(o){var c=_r(o.ref);if(s?(t[c.r]||(t[c.r]=[]),i=t[c.r][c.c]):i=t[o.ref],!i){i={t:"z"},s?t[c.r][c.c]=i:t[o.ref]=i;var f=bt(t["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var h=xt(f);h!==t["!ref"]&&(t["!ref"]=h)}i.c||(i.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var g=i.c.length-1;g>=0;--g){if(!r&&i.c[g].T)return;r&&!i.c[g].T&&i.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(d.a==n[g].id){d.a=n[g].name||d.a;break}}i.c.push(d)})}function Y5(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=lt(c[0]),h={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},d=_r(f.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!g&&!!g[1]&&Jg(g[1])||{r:"",t:"",h:""};h.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),h.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=x.h),n.push(h)}}}}),n}function Pk(t){var e=[Dr,Be("comments",null,{xmlns:_l[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var i=Yt(s.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(s=r.indexOf(Yt(f.a))),i.push(f.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)e.push(pn("t",Yt(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)o+=`Reply:
    `+i[c]+`
`;e.push(pn("t",Yt(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Q5(t,e){var r=[],n=!1,s={},i=0;return t.replace(Mn,function(c,f){var h=lt(c);switch(zi(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=f+c.length;break;case"</text>":s.t=t.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),r}function J5(t,e,r){var n=[Dr,Be("ThreadedComments",null,{xmlns:qr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var f={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=f.id:f.parentId=i,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Be("threadedComment",pn("text",o.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function Z5(t,e){var r=[],n=!1;return t.replace(Mn,function(i){var o=lt(i);switch(zi(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function eL(t){var e=[Dr,Be("personList",null,{xmlns:qr.TCMNT,"xmlns:x":_l[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function tL(t){var e={};e.iauthor=t.read_shift(4);var r=Tl(t);return e.rfx=r.s,e.ref=it(r.s),t.l+=16,e}function rL(t,e){return e==null&&(e=me(36)),e.write_shift(4,t[1].iauthor),Wc(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var nL=bn;function sL(t){return nn(t.slice(0,54))}function iL(t,e){var r=[],n=[],s={},i=!1;return wa(t,function(c,f,h){switch(h){case 632:n.push(c);break;case 635:s=c;break;case 637:s.t=c.t,s.h=c.h,s.r=c.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function aL(t){var e=ss(),r=[];return ke(e,628),ke(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ke(e,632,sL(s.a)))})}),ke(e,631),ke(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:_r(n[0]),e:_r(n[0])};ke(e,635,rL([i,s])),s.t&&s.t.length>0&&ke(e,637,IP(s)),ke(e,636),delete s.iauthor})}),ke(e,634),ke(e,629),e.end()}var oL="application/vnd.ms-office.vbaProject";function lL(t){var e=Ze.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ze.utils.cfb_add(e,s,t.FileIndex[n].content)}}),Ze.write(e)}function cL(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ze.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var bk=["xlsb","xlsm","xlam","biff8","xla"];function uL(){return{"!type":"dialog"}}function fL(){return{"!type":"dialog"}}function hL(){return{"!type":"macro"}}function dL(){return{"!type":"macro"}}var vc=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,o){var c=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var h=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return c?d+=e.c:--d,f?h+=e.r:--h,s+(c?"":"$")+vr(d)+(f?"":"$")+Nr(h)}return function(s,i){return e=i,s.replace(t,r)}})(),rx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nx=(function(){return function(e,r){return e.replace(rx,function(n,s,i,o,c,f){var h=Wg(o)-(i?0:r.c),d=zg(f)-(c?0:r.r),g=d==0?"":c?d+1:"["+d+"]",x=h==0?"":i?h+1:"["+h+"]";return s+"R"+g+"C"+x})}})();function Ok(t,e){return t.replace(rx,function(r,n,s,i,o,c){return n+(s=="$"?s+i:vr(Wg(i)+e.c))+(o=="$"?o+c:Nr(zg(c)+e.r))})}function pL(t,e,r){var n=is(e),s=n.s,i=_r(r),o={r:i.r-s.r,c:i.c-s.c};return Ok(t,o)}function mL(t){return t.length!=1}function lw(t){return t.replace(/_xlfn\./g,"")}function Lr(t){t.l+=1}function go(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Lk(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Mk(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),o=go(t),c=go(t);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function Mk(t){var e=go(t),r=go(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function gL(t,e,r){if(r.biff<8)return Mk(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=go(t),o=go(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Vk(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return xL(t);var n=t.read_shift(r&&r.biff==12?4:2),s=go(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function xL(t){var e=go(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function vL(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function _L(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return yL(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:c}}function yL(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function wL(t,e,r){var n=(t[t.l++]&96)>>5,s=Lk(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function EL(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=Lk(t,i,r);return[n,s,o]}function TL(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function SL(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function kL(t,e,r){var n=(t[t.l++]&96)>>5,s=gL(t,e-1,r);return[n,s]}function AL(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function cw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function CL(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function IL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function FL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function RL(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function NL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Bk(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function DL(t){return t.read_shift(2),Bk(t)}function PL(t){return t.read_shift(2),Bk(t)}function bL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Vk(t,0,r);return[n,s]}function OL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=_L(t,0,r);return[n,s]}function LL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=Vk(t,0,r);return[n,s,i]}function ML(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[UM[s],zk[s],n]}function VL(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:BL(t);return[s,(i[0]===0?zk:BM)[i[1]]]}function BL(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function UL(t,e,r){t.l+=r&&r.biff==2?3:4}function jL(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function zL(t){return t.l++,Ea[t.read_shift(1)]}function WL(t){return t.l++,t.read_shift(2)}function HL(t){return t.l++,t.read_shift(1)!==0}function $L(t){return t.l++,Pn(t)}function GL(t,e,r){return t.l++,Bf(t,e-1,r)}function qL(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Fr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ea[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Pn(t);break;case 2:r[1]=Sl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function KL(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Tl:Cd)(t));return s}function XL(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var c=0;c!=s;++c)o[i][c]=qL(t,r.biff);return o}function YL(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function QL(t,e,r){if(r.biff==5)return JL(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function JL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function ZL(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function eM(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function tM(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function rM(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var nM=Ln,sM=Ln,iM=Ln;function jf(t,e,r){return t.l+=2,[vL(t)]}function sx(t){return t.l+=6,[]}var aM=jf,oM=sx,lM=sx,cM=jf;function Uk(t){return t.l+=2,[Br(t),t.read_shift(2)&1]}var uM=jf,fM=Uk,hM=sx,dM=jf,pM=jf,mM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function gM(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),o=mM[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:s,C:i}}function xM(t){return t.l+=2,[t.read_shift(4)]}function vM(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function _M(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function yM(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function wM(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function EM(t){return t.l+=4,[0,0]}var uw={1:{n:"PtgExp",f:jL},2:{n:"PtgTbl",f:iM},3:{n:"PtgAdd",f:Lr},4:{n:"PtgSub",f:Lr},5:{n:"PtgMul",f:Lr},6:{n:"PtgDiv",f:Lr},7:{n:"PtgPower",f:Lr},8:{n:"PtgConcat",f:Lr},9:{n:"PtgLt",f:Lr},10:{n:"PtgLe",f:Lr},11:{n:"PtgEq",f:Lr},12:{n:"PtgGe",f:Lr},13:{n:"PtgGt",f:Lr},14:{n:"PtgNe",f:Lr},15:{n:"PtgIsect",f:Lr},16:{n:"PtgUnion",f:Lr},17:{n:"PtgRange",f:Lr},18:{n:"PtgUplus",f:Lr},19:{n:"PtgUminus",f:Lr},20:{n:"PtgPercent",f:Lr},21:{n:"PtgParen",f:Lr},22:{n:"PtgMissArg",f:Lr},23:{n:"PtgStr",f:GL},26:{n:"PtgSheet",f:vM},27:{n:"PtgEndSheet",f:_M},28:{n:"PtgErr",f:zL},29:{n:"PtgBool",f:HL},30:{n:"PtgInt",f:WL},31:{n:"PtgNum",f:$L},32:{n:"PtgArray",f:AL},33:{n:"PtgFunc",f:ML},34:{n:"PtgFuncVar",f:VL},35:{n:"PtgName",f:YL},36:{n:"PtgRef",f:bL},37:{n:"PtgArea",f:wL},38:{n:"PtgMemArea",f:ZL},39:{n:"PtgMemErr",f:nM},40:{n:"PtgMemNoMem",f:sM},41:{n:"PtgMemFunc",f:eM},42:{n:"PtgRefErr",f:tM},43:{n:"PtgAreaErr",f:TL},44:{n:"PtgRefN",f:OL},45:{n:"PtgAreaN",f:kL},46:{n:"PtgMemAreaN",f:yM},47:{n:"PtgMemNoMemN",f:wM},57:{n:"PtgNameX",f:QL},58:{n:"PtgRef3d",f:LL},59:{n:"PtgArea3d",f:EL},60:{n:"PtgRefErr3d",f:rM},61:{n:"PtgAreaErr3d",f:SL},255:{}},TM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},SM={1:{n:"PtgElfLel",f:Uk},2:{n:"PtgElfRw",f:dM},3:{n:"PtgElfCol",f:aM},6:{n:"PtgElfRwV",f:pM},7:{n:"PtgElfColV",f:cM},10:{n:"PtgElfRadical",f:uM},11:{n:"PtgElfRadicalS",f:hM},13:{n:"PtgElfColS",f:oM},15:{n:"PtgElfColSV",f:lM},16:{n:"PtgElfRadicalLel",f:fM},25:{n:"PtgList",f:gM},29:{n:"PtgSxName",f:xM},255:{}},kM={0:{n:"PtgAttrNoop",f:EM},1:{n:"PtgAttrSemi",f:NL},2:{n:"PtgAttrIf",f:FL},4:{n:"PtgAttrChoose",f:CL},8:{n:"PtgAttrGoto",f:IL},16:{n:"PtgAttrSum",f:UL},32:{n:"PtgAttrBaxcel",f:cw},33:{n:"PtgAttrBaxcel",f:cw},64:{n:"PtgAttrSpace",f:DL},65:{n:"PtgAttrSpaceSemi",f:PL},128:{n:"PtgAttrIfError",f:RL},255:{}};function zf(t,e,r,n){if(n.biff<8)return Ln(t,e);for(var s=t.l+e,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=XL(t,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=KL(t,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=s-t.l,e!==0&&i.push(Ln(t,e)),i}function Wf(t,e,r){for(var n=t.l+e,s,i,o=[];n!=t.l;)e=n-t.l,i=t[t.l],s=uw[i]||uw[TM[i]],(i===24||i===25)&&(s=(i===24?SM:kM)[t[t.l+1]]),!s||!s.f?Ln(t,e):o.push([s.n,s.f(t,e,r)]);return o}function AM(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var CM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function IM(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function jk(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function fw(t,e,r){var n=jk(t,e,r);return n=="#REF"?n:IM(n,r)}function Rn(t,e,r,n,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},c=[],f,h,d,g=0,x=0,_,S="";if(!t[0]||!t[0][0])return"";for(var y=-1,T="",R=0,O=t[0].length;R<O;++R){var N=t[0][R];switch(N[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),h=c.pop(),y>=0){switch(t[0][y][1][0]){case 0:T=Er(" ",t[0][y][1][1]);break;case 1:T=Er("\r",t[0][y][1][1]);break;default:if(T="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}h=h+T,y=-1}c.push(h+CM[N[0]]+f);break;case"PtgIsect":f=c.pop(),h=c.pop(),c.push(h+" "+f);break;case"PtgUnion":f=c.pop(),h=c.pop(),c.push(h+","+f);break;case"PtgRange":f=c.pop(),h=c.pop(),c.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=zu(N[1][1],o,s),c.push(Wu(d,i));break;case"PtgRefN":d=r?zu(N[1][1],r,s):N[1][1],c.push(Wu(d,i));break;case"PtgRef3d":g=N[1][1],d=zu(N[1][2],o,s),S=fw(n,g,s),c.push(S+"!"+Wu(d,i));break;case"PtgFunc":case"PtgFuncVar":var U=N[1][0],X=N[1][1];U||(U=0),U&=127;var G=U==0?[]:c.slice(-U);c.length-=U,X==="User"&&(X=G.shift()),c.push(X+"("+G.join(",")+")");break;case"PtgBool":c.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(N[1]);break;case"PtgNum":c.push(String(N[1]));break;case"PtgStr":c.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(N[1]);break;case"PtgAreaN":_=U2(N[1][1],r?{s:r}:o,s),c.push(Em(_,s));break;case"PtgArea":_=U2(N[1][1],o,s),c.push(Em(_,s));break;case"PtgArea3d":g=N[1][1],_=N[1][2],S=fw(n,g,s),c.push(S+"!"+Em(_,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=N[1][2];var k=(n.names||[])[x-1]||(n[0]||[])[x],F=k?k.Name:"SH33TJSNAME"+String(x);F&&F.slice(0,6)=="_xlfn."&&!s.xlfn&&(F=F.slice(6)),c.push(F);break;case"PtgNameX":var I=N[1][1];x=N[1][2];var B;if(s.biff<=5)I<0&&(I=-I),n[I]&&(B=n[I][x]);else{var L="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][x]&&n[I][x].itab>0&&(L=n.SheetNames[n[I][x].itab-1]+"!"):L=n.SheetNames[x-1]+"!"),n[I]&&n[I][x])L+=n[I][x].Name;else if(n[0]&&n[0][x])L+=n[0][x].Name;else{var M=(jk(n,I,s)||"").split(";;");M[x-1]?L=M[x-1]:L+="SH33TJSERRX"}c.push(L);break}B||(B={Name:"SH33TJSERRY"}),c.push(B.Name);break;case"PtgParen":var V="(",Fe=")";if(y>=0){switch(T="",t[0][y][1][0]){case 2:V=Er(" ",t[0][y][1][1])+V;break;case 3:V=Er("\r",t[0][y][1][1])+V;break;case 4:Fe=Er(" ",t[0][y][1][1])+Fe;break;case 5:Fe=Er("\r",t[0][y][1][1])+Fe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}y=-1}c.push(V+c.pop()+Fe);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:N[1][1],r:N[1][0]};var Ce={c:r.c,r:r.r};if(n.sharedf[it(d)]){var Le=n.sharedf[it(d)];c.push(Rn(Le,o,Ce,n,s))}else{var Ne=!1;for(f=0;f!=n.arrayf.length;++f)if(h=n.arrayf[f],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){c.push(Rn(h[1],o,Ce,n,s)),Ne=!0;break}Ne||c.push(N[1])}break;case"PtgArray":c.push("{"+AM(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=R;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var Se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&Se.indexOf(t[0][R][0])==-1){N=t[0][y];var ne=!0;switch(N[1][0]){case 4:ne=!1;case 0:T=Er(" ",N[1][1]);break;case 5:ne=!1;case 1:T=Er("\r",N[1][1]);break;default:if(T="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}c.push((ne?T:"")+c.pop()+(ne?"":T)),y=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function FM(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,o=t.read_shift(s);if(o==65535)return[[],Ln(t,e-2)];var c=Wf(t,o,r);return e!==o+s&&(i=zf(t,e-o-s,c,r)),t.l=n,[c,i]}function RM(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,o=t.read_shift(s);if(o==65535)return[[],Ln(t,e-2)];var c=Wf(t,o,r);return e!==o+s&&(i=zf(t,e-o-s,c,r)),t.l=n,[c,i]}function NM(t,e,r,n){var s=t.l+e,i=Wf(t,n,r),o;return s!==t.l&&(o=zf(t,s-t.l,i,r)),[i,o]}function DM(t,e,r){var n=t.l+e,s,i=t.read_shift(2),o=Wf(t,i,r);return i==65535?[[],Ln(t,e-2)]:(e!==i+2&&(s=zf(t,n-i-2,o,r)),[o,s])}function PM(t){var e;if(la(t,t.l+6)!==65535)return[Pn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function bM(t){if(t==null){var e=me(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return hl(t);return hl(0)}function Cm(t,e,r){var n=t.l+e,s=Wi(t);r.biff==2&&++t.l;var i=PM(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var c=RM(t,n-t.l,r);return{cell:s,val:i[0],formula:c,shared:o>>3&1,tt:i[1]}}function OM(t,e,r,n,s){var i=pl(e,r,s),o=bM(t.v),c=me(6),f=33;c.write_shift(2,f),c.write_shift(4,0);for(var h=me(t.bf.length),d=0;d<t.bf.length;++d)h[d]=t.bf[d];var g=rn([i,o,c,h]);return g}function Id(t,e,r){var n=t.read_shift(4),s=Wf(t,n,r),i=t.read_shift(4),o=i>0?zf(t,i,s,r):null;return[s,o]}var LM=Id,Fd=Id,MM=Id,VM=Id,BM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},zk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},UM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function hw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function jM(t){var e="of:="+t.replace(rx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Im(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function zM(t){return t.replace(/\./,"!")}var $u={},_c={},Gu=typeof Map<"u";function ix(t,e,r){var n=0,s=t.length;if(r){if(Gu?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=Gu?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(Gu?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function Rd(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Dn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=gf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Z0(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function nl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function To(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,i=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){fa(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=i;++s)if(t[s].numFmtId===n)return s;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Wk(t,e,r,n,s,i){try{n.cellNF&&(t.z=nt[e])}catch(c){if(n.WTF)throw c}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=cr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(nt[e]==null&&fa(BD[e]||"General",e),t.t==="e")t.w=t.w||Ea[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=cf(t.v);else if(t.t==="d"){var o=Xr(t.v);(o|0)===o?t.w=o.toString(10):t.w=cf(o)}else{if(t.v===void 0)return"";t.w=ul(t.v,_c)}else t.t==="d"?t.w=js(e,Xr(t.v),_c):t.w=js(e,t.v,_c)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=J0(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=J0(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function WM(t,e,r){if(t&&t["!ref"]){var n=bt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function HM(t,e){var r=bt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=xt(r))}var $M=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,GM=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,qM=/<(?:\w:)?hyperlink [^>]*>/mg,KM=/"(\w*:\w*)"/,XM=/<(?:\w:)?col\b[^>]*[\/]?>/g,YM=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,QM=/<(?:\w:)?pageMargins[^>]*\/>/g,Hk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,JM=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ZM=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function e9(t,e,r,n,s,i,o){if(!t)return t;n||(n={"!id":{}});var c=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",d="",g=t.match(GM);g?(h=t.slice(0,g.index),d=t.slice(g.index+g[0].length)):h=d=t;var x=h.match(Hk);x?ax(x[0],c,s,r):(x=h.match(JM))&&r9(x[0],x[1]||"",c,s,r);var _=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var S=h.slice(_,_+50).match(KM);S&&HM(c,S[1])}var y=h.match(ZM);y&&y[1]&&m9(y[1],s);var T=[];if(e.cellStyles){var R=h.match(XM);R&&u9(T,R)}g&&v9(g[1],c,e,f,i,o);var O=d.match(YM);O&&(c["!autofilter"]=h9(O[0]));var N=[],U=d.match($M);if(U)for(_=0;_!=U.length;++_)N[_]=bt(U[_].slice(U[_].indexOf('"')+1));var X=d.match(qM);X&&o9(c,X,n);var G=d.match(QM);if(G&&(c["!margins"]=l9(lt(G[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=xt(f)),e.sheetRows>0&&c["!ref"]){var k=bt(c["!ref"]);e.sheetRows<=+k.e.r&&(k.e.r=e.sheetRows-1,k.e.r>f.e.r&&(k.e.r=f.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>f.e.c&&(k.e.c=f.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),c["!fullref"]=c["!ref"],c["!ref"]=xt(k))}return T.length>0&&(c["!cols"]=T),N.length>0&&(c["!merges"]=N),c}function t9(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+xt(t[r])+'"/>';return e+"</mergeCells>"}function ax(t,e,r,n){var s=lt(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Pt(Qt(s.codeName)))}function r9(t,e,r,n,s){ax(t.slice(0,t.indexOf(">")),r,n,s)}function n9(t,e,r,n,s){var i=!1,o={},c=null;if(n.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[r];try{e.Workbook&&(f=e.Workbook.Sheets[r].CodeName||f)}catch{}i=!0,o.codeName=Pi(Yt(f))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),c=(c||"")+Be("outlinePr",null,h)}!i&&!c||(s[s.length]=Be("sheetPr",c,o))}var s9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],i9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function a9(t){var e={sheet:1};return s9.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),i9.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Zg(t.password).toString(16).toUpperCase()),Be("sheetProtection",null,e)}function o9(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=lt(Qt(e[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Pt(i.location))):(i.Target="#"+Pt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=bt(i.ref),f=c.s.r;f<=c.e.r;++f)for(var h=c.s.c;h<=c.e.c;++h){var d=it({c:h,r:f});n?(t[f]||(t[f]=[]),t[f][h]||(t[f][h]={t:"z",v:void 0}),t[f][h].l=i):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=i)}}}function l9(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function c9(t){return nl(t),Be("pageMargins",null,t)}function u9(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=lt(e[n],!0);s.hidden&&(s.hidden=or(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,ex(s.width)),mo(s);i<=o;)t[i++]=ur(s)}}function f9(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=Be("col",null,Rd(s,n)));return r[r.length]="</cols>",r.join("")}function h9(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function d9(t,e,r,n){var s=typeof t.ref=="string"?t.ref:xt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=is(s);o.s.r==o.e.r&&(o.e.r=is(e["!ref"]).e.r,s=xt(o));for(var c=0;c<i.length;++c){var f=i[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Be("autoFilter",null,{ref:s})}var p9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function m9(t,e){e.Views||(e.Views=[{}]),(t.match(p9)||[]).forEach(function(r,n){var s=lt(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),or(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function g9(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,s),{})}function x9(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=Ea[t.v];break;case"d":n&&n.cellDates?s=cr(t.v,-1).toISOString():(t=ur(t),t.t="n",s=""+(t.v=Xr(cr(t.v)))),typeof t.z>"u"&&(t.z=nt[14]);break;default:s=t.v;break}var c=pn("v",Yt(s)),f={r:e},h=To(n.cellXfs,t,n);switch(h!==0&&(f.s=h),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=pn("v",""+ix(n.Strings,t.v,n.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;c=Be("f",Yt(t.f),d)+(t.v!=null?c:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(f.cm=1),Be("c",c,f)}var v9=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=uf("v"),o=uf("f");return function(f,h,d,g,x,_){for(var S=0,y="",T=[],R=[],O=0,N=0,U=0,X="",G,k,F=0,I=0,B,L,M=0,V=0,Fe=Array.isArray(_.CellXf),Ce,Le=[],Ne=[],Se=Array.isArray(h),ne=[],ye={},ee=!1,b=!!d.sheetStubs,te=f.split(e),J=0,Z=te.length;J!=Z;++J){y=te[J].trim();var oe=y.length;if(oe!==0){var _e=0;e:for(S=0;S<oe;++S)switch(y[S]){case">":if(y[S-1]!="/"){++S;break e}if(d&&d.cellStyles){if(k=lt(y.slice(_e,S),!0),F=k.r!=null?parseInt(k.r,10):F+1,I=-1,d.sheetRows&&d.sheetRows<F)continue;ye={},ee=!1,k.ht&&(ee=!0,ye.hpt=parseFloat(k.ht),ye.hpx=Rc(ye.hpt)),k.hidden=="1"&&(ee=!0,ye.hidden=!0),k.outlineLevel!=null&&(ee=!0,ye.level=+k.outlineLevel),ee&&(ne[F-1]=ye)}break;case"<":_e=S;break}if(_e>=S)break;if(k=lt(y.slice(_e,S),!0),F=k.r!=null?parseInt(k.r,10):F+1,I=-1,!(d.sheetRows&&d.sheetRows<F)){g.s.r>F-1&&(g.s.r=F-1),g.e.r<F-1&&(g.e.r=F-1),d&&d.cellStyles&&(ye={},ee=!1,k.ht&&(ee=!0,ye.hpt=parseFloat(k.ht),ye.hpx=Rc(ye.hpt)),k.hidden=="1"&&(ee=!0,ye.hidden=!0),k.outlineLevel!=null&&(ee=!0,ye.level=+k.outlineLevel),ee&&(ne[F-1]=ye)),T=y.slice(S).split(t);for(var ve=0;ve!=T.length&&T[ve].trim().charAt(0)=="<";++ve);for(T=T.slice(ve),S=0;S!=T.length;++S)if(y=T[S].trim(),y.length!==0){if(R=y.match(r),O=S,N=0,U=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,R!=null&&R.length===2){for(O=0,X=R[1],N=0;N!=X.length&&!((U=X.charCodeAt(N)-64)<1||U>26);++N)O=26*O+U;--O,I=O}else++I;for(N=0;N!=y.length&&y.charCodeAt(N)!==62;++N);if(++N,k=lt(y.slice(0,N),!0),k.r||(k.r=it({r:F-1,c:I})),X=y.slice(N),G={t:""},(R=X.match(i))!=null&&R[1]!==""&&(G.v=Pt(R[1])),d.cellFormula){if((R=X.match(o))!=null&&R[1]!==""){if(G.f=Pt(Qt(R[1])).replace(/\r\n/g,`
`),d.xlfn||(G.f=lw(G.f)),R[0].indexOf('t="array"')>-1)G.F=(X.match(s)||[])[1],G.F.indexOf(":")>-1&&Le.push([bt(G.F),G.F]);else if(R[0].indexOf('t="shared"')>-1){L=lt(R[0]);var xe=Pt(Qt(R[1]));d.xlfn||(xe=lw(xe)),Ne[parseInt(L.si,10)]=[L,xe,k.r]}}else(R=X.match(/<f[^>]*\/>/))&&(L=lt(R[0]),Ne[L.si]&&(G.f=pL(Ne[L.si][1],Ne[L.si][2],k.r)));var Ee=_r(k.r);for(N=0;N<Le.length;++N)Ee.r>=Le[N][0].s.r&&Ee.r<=Le[N][0].e.r&&Ee.c>=Le[N][0].s.c&&Ee.c<=Le[N][0].e.c&&(G.F=Le[N][1])}if(k.t==null&&G.v===void 0)if(G.f||G.F)G.v=0,G.t="n";else if(b)G.t="z";else continue;else G.t=k.t||"n";switch(g.s.c>I&&(g.s.c=I),g.e.c<I&&(g.e.c=I),G.t){case"n":if(G.v==""||G.v==null){if(!b)continue;G.t="z"}else G.v=parseFloat(G.v);break;case"s":if(typeof G.v>"u"){if(!b)continue;G.t="z"}else B=$u[parseInt(G.v,10)],G.v=B.t,G.r=B.r,d.cellHTML&&(G.h=B.h);break;case"str":G.t="s",G.v=G.v!=null?Qt(G.v):"",d.cellHTML&&(G.h=Vg(G.v));break;case"inlineStr":R=X.match(n),G.t="s",R!=null&&(B=Jg(R[1]))?(G.v=B.t,d.cellHTML&&(G.h=B.h)):G.v="";break;case"b":G.v=or(G.v);break;case"d":d.cellDates?G.v=cr(G.v,1):(G.v=Xr(cr(G.v,1)),G.t="n");break;case"e":(!d||d.cellText!==!1)&&(G.w=G.v),G.v=GS[G.v];break}if(M=V=0,Ce=null,Fe&&k.s!==void 0&&(Ce=_.CellXf[k.s],Ce!=null&&(Ce.numFmtId!=null&&(M=Ce.numFmtId),d.cellStyles&&Ce.fillId!=null&&(V=Ce.fillId))),Wk(G,M,V,d,x,_),d.cellDates&&Fe&&G.t=="n"&&Uc(nt[M])&&(G.t="d",G.v=Ad(G.v)),k.cm&&d.xlmeta){var st=(d.xlmeta.Cell||[])[+k.cm-1];st&&st.type=="XLDAPR"&&(G.D=!0)}if(Se){var Y=_r(k.r);h[Y.r]||(h[Y.r]=[]),h[Y.r][Y.c]=G}else h[k.r]=G}}}}ne.length>0&&(h["!rows"]=ne)}})();function _9(t,e,r,n){var s=[],i=[],o=bt(t["!ref"]),c="",f,h="",d=[],g=0,x=0,_=t["!rows"],S=Array.isArray(t),y={r:h},T,R=-1;for(x=o.s.c;x<=o.e.c;++x)d[x]=vr(x);for(g=o.s.r;g<=o.e.r;++g){for(i=[],h=Nr(g),x=o.s.c;x<=o.e.c;++x){f=d[x]+h;var O=S?(t[g]||[])[x]:t[f];O!==void 0&&(c=x9(O,f,t,e))!=null&&i.push(c)}(i.length>0||_&&_[g])&&(y={r:h},_&&_[g]&&(T=_[g],T.hidden&&(y.hidden=1),R=-1,T.hpx?R=xf(T.hpx):T.hpt&&(R=T.hpt),R>-1&&(y.ht=R,y.customHeight=1),T.level&&(y.outlineLevel=T.level)),s[s.length]=Be("row",i.join(""),y))}if(_)for(;g<_.length;++g)_&&_[g]&&(y={r:g+1},T=_[g],T.hidden&&(y.hidden=1),R=-1,T.hpx?R=xf(T.hpx):T.hpt&&(R=T.hpt),R>-1&&(y.ht=R,y.customHeight=1),T.level&&(y.outlineLevel=T.level),s[s.length]=Be("row","",y));return s.join("")}function $k(t,e,r,n){var s=[Dr,Be("worksheet",null,{xmlns:_l[0],"xmlns:r":qr.r})],i=r.SheetNames[t],o=0,c="",f=r.Sheets[i];f==null&&(f={});var h=f["!ref"]||"A1",d=bt(h);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),h=xt(d)}n||(n={}),f["!comments"]=[];var g=[];n9(f,r,t,e,s),s[s.length]=Be("dimension",null,{ref:h}),s[s.length]=g9(f,e,t,r),e.sheetFormat&&(s[s.length]=Be("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(s[s.length]=f9(f,f["!cols"])),s[o=s.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(c=_9(f,e),c.length>0&&(s[s.length]=c)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),f["!protect"]&&(s[s.length]=a9(f["!protect"])),f["!autofilter"]!=null&&(s[s.length]=d9(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(s[s.length]=t9(f["!merges"]));var x=-1,_,S=-1;return f["!links"].length>0&&(s[s.length]="<hyperlinks>",f["!links"].forEach(function(y){y[1].Target&&(_={ref:y[0]},y[1].Target.charAt(0)!="#"&&(S=Xt(n,-1,Yt(y[1].Target).replace(/#.*$/,""),wt.HLINK),_["r:id"]="rId"+S),(x=y[1].Target.indexOf("#"))>-1&&(_.location=Yt(y[1].Target.slice(x+1))),y[1].Tooltip&&(_.tooltip=Yt(y[1].Tooltip)),s[s.length]=Be("hyperlink",null,_))}),s[s.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(s[s.length]=c9(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=pn("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:h}))),g.length>0&&(S=Xt(n,-1,"../drawings/drawing"+(t+1)+".xml",wt.DRAW),s[s.length]=Be("drawing",null,{"r:id":"rId"+S}),f["!drawing"]=g),f["!comments"].length>0&&(S=Xt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",wt.VML),s[s.length]=Be("legacyDrawing",null,{"r:id":"rId"+S}),f["!legacy"]=S),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function y9(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function w9(t,e,r){var n=me(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;s.hpx?i=xf(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var c=0,f=n.l;n.l+=4;for(var h={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var g=-1,x=-1,_=d<<10;_<d+1<<10;++_){h.c=_;var S=Array.isArray(r)?(r[h.r]||[])[h.c]:r[it(h)];S&&(g<0&&(g=_),x=_)}g<0||(++c,n.write_shift(4,g),n.write_shift(4,x))}var y=n.l;return n.l=f,n.write_shift(4,c),n.l=y,n.length>n.l?n.slice(0,n.l):n}function E9(t,e,r,n){var s=w9(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&ke(t,0,s)}var T9=Tl,S9=Wc;function k9(){}function A9(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=FP(t),r}function C9(t,e,r){r==null&&(r=me(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return X0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),jS(t,r),r.slice(0,r.l)}function I9(t){var e=zs(t);return[e]}function F9(t,e,r){return r==null&&(r=me(8)),yl(e,r)}function R9(t){var e=wl(t);return[e]}function N9(t,e,r){return r==null&&(r=me(4)),El(e,r)}function D9(t){var e=zs(t),r=t.read_shift(1);return[e,r,"b"]}function P9(t,e,r){return r==null&&(r=me(9)),yl(e,r),r.write_shift(1,t.v?1:0),r}function b9(t){var e=wl(t),r=t.read_shift(1);return[e,r,"b"]}function O9(t,e,r){return r==null&&(r=me(5)),El(e,r),r.write_shift(1,t.v?1:0),r}function L9(t){var e=zs(t),r=t.read_shift(1);return[e,r,"e"]}function M9(t,e,r){return r==null&&(r=me(9)),yl(e,r),r.write_shift(1,t.v),r}function V9(t){var e=wl(t),r=t.read_shift(1);return[e,r,"e"]}function B9(t,e,r){return r==null&&(r=me(8)),El(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function U9(t){var e=zs(t),r=t.read_shift(4);return[e,r,"s"]}function j9(t,e,r){return r==null&&(r=me(12)),yl(e,r),r.write_shift(4,e.v),r}function z9(t){var e=wl(t),r=t.read_shift(4);return[e,r,"s"]}function W9(t,e,r){return r==null&&(r=me(8)),El(e,r),r.write_shift(4,e.v),r}function H9(t){var e=zs(t),r=Pn(t);return[e,r,"n"]}function $9(t,e,r){return r==null&&(r=me(16)),yl(e,r),hl(t.v,r),r}function Gk(t){var e=wl(t),r=Pn(t);return[e,r,"n"]}function G9(t,e,r){return r==null&&(r=me(12)),El(e,r),hl(t.v,r),r}function q9(t){var e=zs(t),r=qg(t);return[e,r,"n"]}function K9(t,e,r){return r==null&&(r=me(12)),yl(e,r),zS(t.v,r),r}function X9(t){var e=wl(t),r=qg(t);return[e,r,"n"]}function Y9(t,e,r){return r==null&&(r=me(8)),El(e,r),zS(t.v,r),r}function Q9(t){var e=zs(t),r=Hg(t);return[e,r,"is"]}function J9(t){var e=zs(t),r=bn(t);return[e,r,"str"]}function Z9(t,e,r){return r==null&&(r=me(12+4*t.v.length)),yl(e,r),nn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function e7(t){var e=wl(t),r=bn(t);return[e,r,"str"]}function t7(t,e,r){return r==null&&(r=me(8+4*t.v.length)),El(e,r),nn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function r7(t,e,r){var n=t.l+e,s=zs(t);s.r=r["!row"];var i=t.read_shift(1),o=[s,i,"b"];if(r.cellFormula){t.l+=2;var c=Fd(t,n-t.l,r);o[3]=Rn(c,null,s,r.supbooks,r)}else t.l=n;return o}function n7(t,e,r){var n=t.l+e,s=zs(t);s.r=r["!row"];var i=t.read_shift(1),o=[s,i,"e"];if(r.cellFormula){t.l+=2;var c=Fd(t,n-t.l,r);o[3]=Rn(c,null,s,r.supbooks,r)}else t.l=n;return o}function s7(t,e,r){var n=t.l+e,s=zs(t);s.r=r["!row"];var i=Pn(t),o=[s,i,"n"];if(r.cellFormula){t.l+=2;var c=Fd(t,n-t.l,r);o[3]=Rn(c,null,s,r.supbooks,r)}else t.l=n;return o}function i7(t,e,r){var n=t.l+e,s=zs(t);s.r=r["!row"];var i=bn(t),o=[s,i,"str"];if(r.cellFormula){t.l+=2;var c=Fd(t,n-t.l,r);o[3]=Rn(c,null,s,r.supbooks,r)}else t.l=n;return o}var a7=Tl,o7=Wc;function l7(t,e){return e==null&&(e=me(4)),e.write_shift(4,t),e}function c7(t,e){var r=t.l+e,n=Tl(t),s=$g(t),i=bn(t),o=bn(t),c=bn(t);t.l=r;var f={rfx:n,relId:s,loc:i,display:c};return o&&(f.Tooltip=o),f}function u7(t,e){var r=me(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Wc({s:_r(t[0]),e:_r(t[0])},r),Gg("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return nn(s||"",r),nn(t[1].Tooltip||"",r),nn("",r),r.slice(0,r.l)}function f7(){}function h7(t,e,r){var n=t.l+e,s=WS(t),i=t.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var c=LM(t,n-t.l,r);o[1]=c}else t.l=n;return o}function d7(t,e,r){var n=t.l+e,s=Tl(t),i=[s];if(r.cellFormula){var o=VM(t,n-t.l,r);i[1]=o,t.l=n}else t.l=n;return i}function p7(t,e,r){r==null&&(r=me(18));var n=Rd(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var qk=["left","right","top","bottom","header","footer"];function m7(t){var e={};return qk.forEach(function(r){e[r]=Pn(t)}),e}function g7(t,e){return e==null&&(e=me(48)),nl(t),qk.forEach(function(r){hl(t[r],e)}),e}function x7(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function v7(t,e,r){r==null&&(r=me(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function _7(t){var e=me(24);return e.write_shift(4,4),e.write_shift(4,1),Wc(t,e),e}function y7(t,e){return e==null&&(e=me(66)),e.write_shift(2,t.password?Zg(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function w7(){}function E7(){}function T7(t,e,r,n,s,i,o){if(!t)return t;var c=e||{};n||(n={"!id":{}});var f=c.dense?[]:{},h,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,x=!1,_,S,y,T,R,O,N,U,X,G=[];c.biff=12,c["!row"]=0;var k=0,F=!1,I=[],B={},L=c.supbooks||s.supbooks||[[]];if(L.sharedf=B,L.arrayf=I,L.SheetNames=s.SheetNames||s.Sheets.map(function(Se){return Se.name}),!c.supbooks&&(c.supbooks=L,s.Names))for(var M=0;M<s.Names.length;++M)L[0][M+1]=s.Names[M];var V=[],Fe=[],Ce=!1;vf[16]={n:"BrtShortReal",f:Gk};var Le;if(wa(t,function(ne,ye,ee){if(!x)switch(ee){case 148:h=ne;break;case 0:_=ne,c.sheetRows&&c.sheetRows<=_.r&&(x=!0),U=Nr(T=_.r),c["!row"]=_.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=Rc(ne.hpt)),Fe[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:ne[2]},ne[2]){case"n":S.v=ne[1];break;case"s":N=$u[ne[1]],S.v=N.t,S.r=N.r;break;case"b":S.v=!!ne[1];break;case"e":S.v=ne[1],c.cellText!==!1&&(S.w=Ea[S.v]);break;case"str":S.t="s",S.v=ne[1];break;case"is":S.t="s",S.v=ne[1].t;break}if((y=o.CellXf[ne[0].iStyleRef])&&Wk(S,y.numFmtId,null,c,i,o),R=ne[0].c==-1?R+1:ne[0].c,c.dense?(f[T]||(f[T]=[]),f[T][R]=S):f[vr(R)+U]=S,c.cellFormula){for(F=!1,k=0;k<I.length;++k){var b=I[k];_.r>=b[0].s.r&&_.r<=b[0].e.r&&R>=b[0].s.c&&R<=b[0].e.c&&(S.F=xt(b[0]),F=!0)}!F&&ne.length>3&&(S.f=ne[3])}if(d.s.r>_.r&&(d.s.r=_.r),d.s.c>R&&(d.s.c=R),d.e.r<_.r&&(d.e.r=_.r),d.e.c<R&&(d.e.c=R),c.cellDates&&y&&S.t=="n"&&Uc(nt[y.numFmtId])){var te=Xo(S.v);te&&(S.t="d",S.v=new Date(te.y,te.m-1,te.d,te.H,te.M,te.S,te.u))}Le&&(Le.type=="XLDAPR"&&(S.D=!0),Le=void 0);break;case 1:case 12:if(!c.sheetStubs||g)break;S={t:"z",v:void 0},R=ne[0].c==-1?R+1:ne[0].c,c.dense?(f[T]||(f[T]=[]),f[T][R]=S):f[vr(R)+U]=S,d.s.r>_.r&&(d.s.r=_.r),d.s.c>R&&(d.s.c=R),d.e.r<_.r&&(d.e.r=_.r),d.e.c<R&&(d.e.c=R),Le&&(Le.type=="XLDAPR"&&(S.D=!0),Le=void 0);break;case 176:G.push(ne);break;case 49:Le=((c.xlmeta||{}).Cell||[])[ne-1];break;case 494:var J=n["!id"][ne.relId];for(J?(ne.Target=J.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=J):ne.relId==""&&(ne.Target="#"+ne.loc),T=ne.rfx.s.r;T<=ne.rfx.e.r;++T)for(R=ne.rfx.s.c;R<=ne.rfx.e.c;++R)c.dense?(f[T]||(f[T]=[]),f[T][R]||(f[T][R]={t:"z",v:void 0}),f[T][R].l=ne):(O=it({c:R,r:T}),f[O]||(f[O]={t:"z",v:void 0}),f[O].l=ne);break;case 426:if(!c.cellFormula)break;I.push(ne),X=c.dense?f[T][R]:f[vr(R)+U],X.f=Rn(ne[1],d,{r:_.r,c:R},L,c),X.F=xt(ne[0]);break;case 427:if(!c.cellFormula)break;B[it(ne[0].s)]=ne[1],X=c.dense?f[T][R]:f[vr(R)+U],X.f=Rn(ne[1],d,{r:_.r,c:R},L,c);break;case 60:if(!c.cellStyles)break;for(;ne.e>=ne.s;)V[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},Ce||(Ce=!0,ex(ne.w/256)),mo(V[ne.e+1]);break;case 161:f["!autofilter"]={ref:xt(ne)};break;case 476:f["!margins"]=ne;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),ne.name&&(s.Sheets[r].CodeName=ne.name),(ne.above||ne.left)&&(f["!outline"]={above:ne.above,left:ne.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),ne.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!ye.T){if(!g||c.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(d.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(f["!ref"]=xt(h||d)),c.sheetRows&&f["!ref"]){var Ne=bt(f["!ref"]);c.sheetRows<=+Ne.e.r&&(Ne.e.r=c.sheetRows-1,Ne.e.r>d.e.r&&(Ne.e.r=d.e.r),Ne.e.r<Ne.s.r&&(Ne.s.r=Ne.e.r),Ne.e.c>d.e.c&&(Ne.e.c=d.e.c),Ne.e.c<Ne.s.c&&(Ne.s.c=Ne.e.c),f["!fullref"]=f["!ref"],f["!ref"]=xt(Ne))}return G.length>0&&(f["!merges"]=G),V.length>0&&(f["!cols"]=V),Fe.length>0&&(f["!rows"]=Fe),f}function S7(t,e,r,n,s,i,o){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=ur(e),e.z=e.z||nt[14],e.v=Xr(cr(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var f={r,c:n};switch(f.s=To(s.cellXfs,e,s),e.l&&i["!links"].push([it(f),e.l]),e.c&&i["!comments"].push([it(f),e.c]),e.t){case"s":case"str":return s.bookSST?(c=ix(s.Strings,e.v,s.revStrings),f.t="s",f.v=c,o?ke(t,18,W9(e,f)):ke(t,7,j9(e,f))):(f.t="str",o?ke(t,17,t7(e,f)):ke(t,6,Z9(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?ke(t,13,Y9(e,f)):ke(t,2,K9(e,f)):o?ke(t,16,G9(e,f)):ke(t,5,$9(e,f)),!0;case"b":return f.t="b",o?ke(t,15,O9(e,f)):ke(t,4,P9(e,f)),!0;case"e":return f.t="e",o?ke(t,14,B9(e,f)):ke(t,3,M9(e,f)),!0}return o?ke(t,12,N9(e,f)):ke(t,1,F9(e,f)),!0}function k7(t,e,r,n){var s=bt(e["!ref"]||"A1"),i,o="",c=[];ke(t,145);var f=Array.isArray(e),h=s.e.r;e["!rows"]&&(h=Math.max(s.e.r,e["!rows"].length-1));for(var d=s.s.r;d<=h;++d){o=Nr(d),E9(t,e,s,d);var g=!1;if(d<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){d===s.s.r&&(c[x]=vr(x)),i=c[x]+o;var _=f?(e[d]||[])[x]:e[i];if(!_){g=!1;continue}g=S7(t,_,d,x,n,e,g)}}ke(t,146)}function A7(t,e){!e||!e["!merges"]||(ke(t,177,l7(e["!merges"].length)),e["!merges"].forEach(function(r){ke(t,176,o7(r))}),ke(t,178))}function C7(t,e){!e||!e["!cols"]||(ke(t,390),e["!cols"].forEach(function(r,n){r&&ke(t,60,p7(n,r))}),ke(t,391))}function I7(t,e){!e||!e["!ref"]||(ke(t,648),ke(t,649,_7(bt(e["!ref"]))),ke(t,650))}function F7(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=Xt(r,-1,n[1].Target.replace(/#.*$/,""),wt.HLINK);ke(t,494,u7(n,s))}}),delete e["!links"]}function R7(t,e,r,n){if(e["!comments"].length>0){var s=Xt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",wt.VML);ke(t,551,Gg("rId"+s)),e["!legacy"]=s}}function N7(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],i=typeof s.ref=="string"?s.ref:xt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,c=is(i);c.s.r==c.e.r&&(c.e.r=is(e["!ref"]).e.r,i=xt(c));for(var f=0;f<o.length;++f){var h=o[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+i;break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ke(t,161,Wc(bt(i))),ke(t,162)}}function D7(t,e,r){ke(t,133),ke(t,137,v7(e,r)),ke(t,138),ke(t,134)}function P7(t,e){e["!protect"]&&ke(t,535,y7(e["!protect"]))}function b7(t,e,r,n){var s=ss(),i=r.SheetNames[t],o=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}var f=bt(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ke(s,129),(r.vbaraw||o["!outline"])&&ke(s,147,C9(c,o["!outline"])),ke(s,148,S9(f)),D7(s,o,r.Workbook),C7(s,o),k7(s,o,t,e),P7(s,o),N7(s,o,r,t),A7(s,o),F7(s,o,n),o["!margins"]&&ke(s,476,g7(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&I7(s,o),R7(s,o,t,n),ke(s,130),s.end()}function O7(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var s=Pt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function L7(t,e,r,n,s,i){var o=i||{"!type":"chart"};if(!t)return i;var c=0,f=0,h="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var x=O7(g);d.s.r=d.s.c=0,d.e.c=c,h=vr(c),x[0].forEach(function(_,S){o[h+Nr(S)]={t:"n",v:_,z:x[1]},f=S}),d.e.r<f&&(d.e.r=f),++c}),c>0&&(o["!ref"]=xt(d)),o}function M7(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,c=t.match(Hk);return c&&ax(c[0],i,s,r),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function V7(t,e){t.l+=10;var r=bn(t);return{name:r}}function B7(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return wa(t,function(f,h,d){switch(d){case 550:i["!rel"]=f;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),f.name&&(s.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var ox=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],U7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],j7=[],z7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function dw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=or(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function pw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=or(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Kk(t){pw(t.WBProps,ox),pw(t.CalcPr,z7),dw(t.WBView,U7),dw(t.Sheets,j7),_c.date1904=or(t.WBProps.date1904)}function W7(t){return!t.Workbook||!t.Workbook.WBProps?"false":or(t.Workbook.WBProps.date1904)?"true":"false"}var H7="][*?/\\".split("");function Xk(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return H7.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function $7(t,e,r){t.forEach(function(n,s){Xk(n);for(var i=0;i<s;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[s]&&e[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function G7(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];$7(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)WM(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var q7=/<\w+:workbook/;function K7(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},o=0;if(t.replace(Mn,function(f,h){var d=lt(f);switch(zi(d[0])){case"<?xml":break;case"<workbook":f.match(q7)&&(s="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ox.forEach(function(g){if(d[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=or(d[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(d[g[0]],10);break;default:r.WBProps[g[0]]=d[g[0]]}}),d.codeName&&(r.WBProps.CodeName=Qt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Pt(Qt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Qt(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),or(d.hidden||"0")&&(i.Hidden=!0),o=h+f.length;break;case"</definedName>":i.Ref=Pt(Qt(t.slice(o,h))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return f}),_l.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Kk(r),r}function Yk(t){var e=[Dr];e[e.length]=Be("workbook",null,{xmlns:_l[0],"xmlns:r":qr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(ox.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Be("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:Yt(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Be("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var f={name:c.Name};c.Comment&&(f.comment=c.Comment),c.Sheet!=null&&(f.localSheetId=""+c.Sheet),c.Hidden&&(f.hidden="1"),c.Ref&&(e[e.length]=Be("definedName",Yt(c.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function X7(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=d1(t),r.name=bn(t),r}function Y7(t,e){return e||(e=me(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Gg(t.strRelID,e),nn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Q7(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?bn(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function J7(t,e){e||(e=me(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),jS(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Z7(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function eV(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=RP(t),o=MM(t,0,r),c=$g(t);t.l=n;var f={Name:i,Ptg:o};return s<268435455&&(f.Sheet=s),c&&(f.Comment=c),f}function tV(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],vf[16]={n:"BrtFRTArchID$",f:Z7},wa(t,function(f,h,d){switch(d){case 156:o.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Rn(f.Ptg,null,null,o,e),delete e.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,f]):o[0]=[d,f],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(f),o.XTI=o.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!h.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),Kk(r),r.Names=i,r.supbooks=o,r}function rV(t,e){ke(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ke(t,156,Y7(s))}ke(t,144)}function nV(t,e){e||(e=me(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return nn("SheetJS",e),nn(z0.version,e),nn(z0.version,e),nn("7262",e),e.length>e.l?e.slice(0,e.l):e}function sV(t,e){e||(e=me(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function iV(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(ke(t,135),ke(t,158,sV(s)),ke(t,136))}}function aV(t,e){var r=ss();return ke(r,131),ke(r,128,nV()),ke(r,153,J7(t.Workbook&&t.Workbook.WBProps||null)),iV(r,t),rV(r,t),ke(r,132),r.end()}function oV(t,e,r){return e.slice(-4)===".bin"?tV(t,r):K7(t,r)}function lV(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?T7(t,n,r,s,i,o,c):e9(t,n,r,s,i,o,c)}function cV(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?B7(t,n,r,s,i):M7(t,n,r,s,i)}function uV(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?hL():dL()}function fV(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?uL():fL()}function hV(t,e,r,n){return e.slice(-4)===".bin"?o5(t,r,n):XO(t,r,n)}function dV(t,e,r){return Rk(t,r)}function pV(t,e,r){return e.slice(-4)===".bin"?pO(t,r):fO(t,r)}function mV(t,e,r){return e.slice(-4)===".bin"?iL(t,r):Y5(t,r)}function gV(t,e,r){return e.slice(-4)===".bin"?q5(t):$5(t)}function xV(t,e,r,n){return r.slice(-4)===".bin"?K5(t,e,r,n):void 0}function vV(t,e,r){return e.slice(-4)===".bin"?z5(t,e,r):H5(t,e,r)}function _V(t,e,r){return(e.slice(-4)===".bin"?aV:Yk)(t)}function yV(t,e,r,n,s){return(e.slice(-4)===".bin"?b7:$k)(t,r,n,s)}function wV(t,e,r){return(e.slice(-4)===".bin"?x5:Ik)(t,r)}function EV(t,e,r){return(e.slice(-4)===".bin"?xO:yk)(t,r)}function TV(t,e,r){return(e.slice(-4)===".bin"?aL:Pk)(t)}function SV(t){return(t.slice(-4)===".bin"?W5:Nk)()}var Qk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Jk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ti(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(Qk),i,o,c,f;if(s)for(f=0;f!=s.length;++f)i=s[f].match(Jk),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),n[c]=i[2].slice(1,i[2].length-1));return n}function kV(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(Qk),s,i,o,c;if(n)for(c=0;c!=n.length;++c)s=n[c].match(Jk),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var qu;function AV(t,e){var r=qu[t]||Pt(t);return r==="General"?ul(e):js(r,e)}function CV(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=or(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=cr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Pt(e)]=s}function IV(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ea[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=cf(t.v):t.w=ul(t.v):t.w=AV(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=qu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Uc(n)){var s=Xo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function FV(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=jO[n.Pattern]||n.Pattern)}t[e.ID]=e}function RV(t,e,r,n,s,i,o,c,f,h){var d="General",g=n.StyleID,x={};h=h||{};var _=[],S=0;for(g===void 0&&c&&(g=c.StyleID),g===void 0&&o&&(g=o.StyleID);i[g]!==void 0&&(i[g].nf&&(d=i[g].nf),i[g].Interior&&_.push(i[g].Interior),!!i[g].Parent);)g=i[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=or(t);break;case"String":n.t="s",n.r=N2(Pt(t)),n.v=t.indexOf("<")>-1?Pt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(cr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Pt(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=GS[t],h.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=N2(e||t));break}if(IV(n,d,h),h.cellFormula!==!1)if(n.Formula){var y=Pt(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=vc(y,s),delete n.Formula,n.ArrayRange=="RC"?n.F=vc("RC:RC",s):n.ArrayRange&&(n.F=vc(n.ArrayRange,s),f.push([bt(n.F),n.F]))}else for(S=0;S<f.length;++S)s.r>=f[S][0].s.r&&s.r<=f[S][0].e.r&&s.c>=f[S][0].s.c&&s.c<=f[S][0].e.c&&(n.F=f[S][1]);h.cellStyles&&(_.forEach(function(T){!x.patternType&&T.patternType&&(x.patternType=T.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function NV(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Fm(t,e){var r=e||{};jc();var n=Du(Bg(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Qt(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=ur(r);return o.type="string",Fc.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ht){s.indexOf("<"+Ht)>=0&&(i=!0)}),i)return gB(n,r);qu={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],h,d={},g=[],x=r.dense?[]:{},_="",S={},y={},T=ti('<Data ss:Type="String">'),R=0,O=0,N=0,U={s:{r:2e6,c:2e6},e:{r:0,c:0}},X={},G={},k="",F=0,I=[],B={},L={},M=0,V=[],Fe=[],Ce={},Le=[],Ne,Se=!1,ne=[],ye=[],ee={},b=0,te=0,J={Sheets:[],WBProps:{date1904:!1}},Z={};hf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";c=hf.exec(n);)switch(c[3]=(oe=c[3]).toLowerCase()){case"data":if(oe=="data"){if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?RV(n.slice(R,c.index),k,T,f[f.length-1][0]=="comment"?Ce:S,{c:O,r:N},X,Le[O],y,ne,r):(k="",T=ti(c[0]),R=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Fe.length>0&&(S.c=Fe),(!r.sheetRows||r.sheetRows>N)&&S.v!==void 0&&(r.dense?(x[N]||(x[N]=[]),x[N][O]=S):x[vr(O)+Nr(N)]=S),S.HRef&&(S.l={Target:Pt(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(b=O+(parseInt(S.MergeAcross,10)|0),te=N+(parseInt(S.MergeDown,10)|0),I.push({s:{c:O,r:N},e:{c:b,r:te}})),!r.sheetStubs)S.MergeAcross?O=b+1:++O;else if(S.MergeAcross||S.MergeDown){for(var _e=O;_e<=b;++_e)for(var ve=N;ve<=te;++ve)(_e>O||ve>N)&&(r.dense?(x[ve]||(x[ve]=[]),x[ve][_e]={t:"z"}):x[vr(_e)+Nr(ve)]={t:"z"});O=b+1}else++O;else S=kV(c[0]),S.Index&&(O=+S.Index-1),O<U.s.c&&(U.s.c=O),O>U.e.c&&(U.e.c=O),c[0].slice(-2)==="/>"&&++O,Fe=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(N<U.s.r&&(U.s.r=N),N>U.e.r&&(U.e.r=N),c[0].slice(-2)==="/>"&&(y=ti(c[0]),y.Index&&(N=+y.Index-1)),O=0,++N):(y=ti(c[0]),y.Index&&(N=+y.Index-1),ee={},(y.AutoFitHeight=="0"||y.Height)&&(ee.hpx=parseInt(y.Height,10),ee.hpt=xf(ee.hpx),ye[N]=ee),y.Hidden=="1"&&(ee.hidden=!0,ye[N]=ee));break;case"worksheet":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));g.push(_),U.s.r<=U.e.r&&U.s.c<=U.e.c&&(x["!ref"]=xt(U),r.sheetRows&&r.sheetRows<=U.e.r&&(x["!fullref"]=x["!ref"],U.e.r=r.sheetRows-1,x["!ref"]=xt(U))),I.length&&(x["!merges"]=I),Le.length>0&&(x["!cols"]=Le),ye.length>0&&(x["!rows"]=ye),d[_]=x}else U={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=O=0,f.push([c[3],!1]),h=ti(c[0]),_=Pt(h.Name),x=r.dense?[]:{},I=[],ne=[],ye=[],Z={name:_,Hidden:0},J.Sheets.push(Z);break;case"table":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),Le=[],Se=!1}break;case"style":c[1]==="/"?FV(X,G,r):G=ti(c[0]);break;case"numberformat":G.nf=Pt(ti(c[0]).Format||"General"),qu[G.nf]&&(G.nf=qu[G.nf]);for(var xe=0;xe!=392&&nt[xe]!=G.nf;++xe);if(xe==392){for(xe=57;xe!=392;++xe)if(nt[xe]==null){fa(G.nf,xe);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(Ne=ti(c[0]),Ne.Hidden&&(Ne.hidden=!0,delete Ne.Hidden),Ne.Width&&(Ne.wpx=parseInt(Ne.Width,10)),!Se&&Ne.wpx>10){Se=!0,Dn=Ak;for(var Ee=0;Ee<Le.length;++Ee)Le[Ee]&&mo(Le[Ee])}Se&&mo(Ne),Le[Ne.Index-1||Le.length]=Ne;for(var st=0;st<+Ne.Span;++st)Le[Le.length]=ur(Ne);break;case"namedrange":if(c[1]==="/")break;J.Names||(J.Names=[]);var Y=lt(c[0]),Et={Name:Y.Name,Ref:vc(Y.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(Et.Sheet=J.Sheets.length-1),J.Names.push(Et);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?k+=n.slice(F,c.index):F=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;G.Interior=ti(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?tb(B,oe,n.slice(M,c.index)):M=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));NV(Ce),Fe.push(Ce)}else f.push([c[3],!1]),h=ti(c[0]),Ce={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var gt=ti(c[0]);x["!autofilter"]={ref:vc(gt.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=f.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return _w(n,r);var It=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:It=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:It=!1}break;case"excelworkbook":switch(c[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:It=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:It=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(M,c.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else M=c.index+c[0].length;break;case"header":x["!margins"]||nl(x["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(x["!margins"].header=+lt(c[0]).Margin);break;case"footer":x["!margins"]||nl(x["!margins"]={},"xlml"),isNaN(+lt(c[0]).Margin)||(x["!margins"].footer=+lt(c[0]).Margin);break;case"pagemargins":var ht=lt(c[0]);x["!margins"]||nl(x["!margins"]={},"xlml"),isNaN(+ht.Top)||(x["!margins"].top=+ht.Top),isNaN(+ht.Left)||(x["!margins"].left=+ht.Left),isNaN(+ht.Right)||(x["!margins"].right=+ht.Right),isNaN(+ht.Bottom)||(x["!margins"].bottom=+ht.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:It=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:It=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:It=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:It=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:It=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:It=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:It=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:It=!1}break;case"smarttags":break;default:It=!1;break}if(It||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?CV(L,oe,V,n.slice(M,c.index)):(V=c,M=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var Ue={};return!r.bookSheets&&!r.bookProps&&(Ue.Sheets=d),Ue.SheetNames=g,Ue.Workbook=J,Ue.SSF=ur(nt),Ue.Props=B,Ue.Custprops=L,Ue}function y1(t,e){switch(cx(e=e||{}),e.type||"base64"){case"base64":return Fm(Es(t),e);case"binary":case"buffer":case"file":return Fm(t,e);case"array":return Fm(wo(t),e)}}function DV(t,e){var r=[];return t.Props&&r.push(rb(t.Props,e)),t.Custprops&&r.push(nb(t.Props,t.Custprops)),r.join("")}function PV(){return""}function bV(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var i=[];i.push(Be("NumberFormat",null,{"ss:Format":Yt(nt[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Be("Style",i.join(""),o))}),Be("Styles",r.join(""))}function Zk(t){return Be("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+nx(t.Ref,{r:0,c:0})})}function OV(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(Zk(s)))}return Be("Names",r.join(""))}function LV(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],o=0;o<s.length;++o){var c=s[o];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(Zk(c)))}return i.join("")}function MV(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(Be("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(Be("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(Be("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(pn("ProtectContents","True")),t["!protect"].objects&&s.push(pn("ProtectObjects","True")),t["!protect"].scenarios&&s.push(pn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(pn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(pn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Be("WorksheetOptions",s.join(""),{xmlns:xs.x})}function VV(t){return t.map(function(e){var r=iP(e.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":e.a})}).join("")}function BV(t,e,r,n,s,i,o){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+Yt(nx(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var f=_r(t.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=Yt(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=Yt(t.l.Tooltip))),r["!merges"])for(var h=r["!merges"],d=0;d!=h.length;++d)h[d].s.c!=o.c||h[d].s.r!=o.r||(h[d].e.c>h[d].s.c&&(c["ss:MergeAcross"]=h[d].e.c-h[d].s.c),h[d].e.r>h[d].s.r&&(c["ss:MergeDown"]=h[d].e.r-h[d].s.r));var g="",x="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",x=String(t.v);break;case"b":g="Boolean",x=t.v?"1":"0";break;case"e":g="Error",x=Ea[t.v];break;case"d":g="DateTime",x=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||nt[14]);break;case"s":g="String",x=sP(t.v||"");break}var _=To(n.cellXfs,t,n);c["ss:StyleID"]="s"+(21+_),c["ss:Index"]=o.c+1;var S=t.v!=null?x:"",y=t.t=="z"?"":'<Data ss:Type="'+g+'">'+S+"</Data>";return(t.c||[]).length>0&&(y+=VV(t.c)),Be("Cell",y,c)}function UV(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Rc(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function jV(t,e,r,n){if(!t["!ref"])return"";var s=bt(t["!ref"]),i=t["!merges"]||[],o=0,c=[];t["!cols"]&&t["!cols"].forEach(function(T,R){mo(T);var O=!!T.width,N=Rd(R,T),U={"ss:Index":R+1};O&&(U["ss:Width"]=mf(N.width)),T.hidden&&(U["ss:Hidden"]="1"),c.push(Be("Column",null,U))});for(var f=Array.isArray(t),h=s.s.r;h<=s.e.r;++h){for(var d=[UV(h,(t["!rows"]||[])[h])],g=s.s.c;g<=s.e.c;++g){var x=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>g)&&!(i[o].s.r>h)&&!(i[o].e.c<g)&&!(i[o].e.r<h)){(i[o].s.c!=g||i[o].s.r!=h)&&(x=!0);break}if(!x){var _={r:h,c:g},S=it(_),y=f?(t[h]||[])[g]:t[S];d.push(BV(y,S,t,e,r,n,_))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function zV(t,e,r){var n=[],s=r.SheetNames[t],i=r.Sheets[s],o=i?LV(i,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?jV(i,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(MV(i,e,t,r)),n.join("")}function WV(t,e){e||(e={}),t.SSF||(t.SSF=ur(nt)),t.SSF&&(jc(),Td(t.SSF),e.revssf=kd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],To(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(DV(t,e)),r.push(PV()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Be("Worksheet",zV(n,e,t),{"ss:Name":Yt(t.SheetNames[n])}));return r[2]=bV(t,e),r[3]=OV(t),Dr+Be("Workbook",r.join(""),{xmlns:xs.ss,"xmlns:o":xs.o,"xmlns:x":xs.x,"xmlns:ss":xs.ss,"xmlns:dt":xs.dt,"xmlns:html":xs.html})}function HV(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=OP(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=LP(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var $V=[60,1084,2066,2165,2175];function GV(t,e,r,n,s){var i=n,o=[],c=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(c)}o.push(c),r.l+=i;for(var f=la(r,r.l),h=w1[f],d=0;h!=null&&$V.indexOf(f)>-1;)i=la(r,r.l+2),d=r.l+4,f==2066?d+=4:(f==2165||f==2175)&&(d+=12),c=r.slice(d,r.l+4+i),o.push(c),r.l+=4+i,h=w1[f=la(r,r.l)];var g=rn(o);hn(g,0);var x=0;g.lens=[];for(var _=0;_<o.length;++_)g.lens.push(x),x+=o[_].length;if(g.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+g.length+" < "+n;return e.f(g,g.length,s)}function Ii(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=nt[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ea[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=cf(t.v):t.w=ul(t.v):t.w=js(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Uc(nt[n]||String(n))){var s=Xo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function u0(t,e,r){return{v:t,ixfe:e,t:r}}function qV(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},o={},c=null,f=[],h="",d={},g,x="",_,S,y,T,R={},O=[],N,U,X=[],G=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},I=function(ot){return ot<8?el[ot]:ot<64&&G[ot-8]||el[ot]},B=function(ot,Nt,Hr){var Mt=Nt.XF.data;if(!(!Mt||!Mt.patternType||!Hr||!Hr.cellStyles)){Nt.s={},Nt.s.patternType=Mt.patternType;var vn;(vn=pf(I(Mt.icvFore)))&&(Nt.s.fgColor={rgb:vn}),(vn=pf(I(Mt.icvBack)))&&(Nt.s.bgColor={rgb:vn})}},L=function(ot,Nt,Hr){if(!(ee>1)&&!(Hr.sheetRows&&ot.r>=Hr.sheetRows)){if(Hr.cellStyles&&Nt.XF&&Nt.XF.data&&B(ot,Nt,Hr),delete Nt.ixfe,delete Nt.XF,g=ot,x=it(ot),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<o.s.r&&(o.s.r=ot.r),ot.c<o.s.c&&(o.s.c=ot.c),ot.r+1>o.e.r&&(o.e.r=ot.r+1),ot.c+1>o.e.c&&(o.e.c=ot.c+1),Hr.cellFormula&&Nt.f){for(var Mt=0;Mt<O.length;++Mt)if(!(O[Mt][0].s.c>ot.c||O[Mt][0].s.r>ot.r)&&!(O[Mt][0].e.c<ot.c||O[Mt][0].e.r<ot.r)){Nt.F=xt(O[Mt][0]),(O[Mt][0].s.c!=ot.c||O[Mt][0].s.r!=ot.r)&&delete Nt.f,Nt.f&&(Nt.f=""+Rn(O[Mt][1],o,ot,ne,M));break}}Hr.dense?(s[ot.r]||(s[ot.r]=[]),s[ot.r][ot.c]=Nt):s[x]=Nt}},M={enc:!1,sbcch:0,snames:[],sharedf:R,arrayf:O,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(M.password=e.password);var V,Fe=[],Ce=[],Le=[],Ne=[],Se=!1,ne=[];ne.SheetNames=M.snames,ne.sharedf=M.sharedf,ne.arrayf=M.arrayf,ne.names=[],ne.XTI=[];var ye=0,ee=0,b=0,te=[],J=[],Z;M.codepage=1200,si(1200);for(var oe=!1;t.l<t.length-1;){var _e=t.l,ve=t.read_shift(2);if(ve===0&&ye===10)break;var xe=t.l===t.length?0:t.read_shift(2),Ee=w1[ve];if(Ee&&Ee.f){if(e.bookSheets&&ye===133&&ve!==133)break;if(ye=ve,Ee.r===2||Ee.r==12){var st=t.read_shift(2);if(xe-=2,!M.enc&&st!==ve&&((st&255)<<8|st>>8)!==ve)throw new Error("rt mismatch: "+st+"!="+ve);Ee.r==12&&(t.l+=10,xe-=10)}var Y={};if(ve===10?Y=Ee.f(t,xe,M):Y=GV(ve,Ee,t,xe,M),ee==0&&[9,521,1033,2057].indexOf(ye)===-1)continue;switch(ve){case 34:r.opts.Date1904=k.WBProps.date1904=Y;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(M.enc||(t.l=0),M.enc=Y,!e.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=Y;break;case 66:var Et=Number(Y);switch(Et){case 21010:Et=1200;break;case 32768:Et=1e4;break;case 32769:Et=1252;break}si(M.codepage=Et),oe=!0;break;case 317:M.rrtabid=Y;break;case 25:M.winlocked=Y;break;case 439:r.opts.RefreshAll=Y;break;case 12:r.opts.CalcCount=Y;break;case 16:r.opts.CalcDelta=Y;break;case 17:r.opts.CalcIter=Y;break;case 13:r.opts.CalcMode=Y;break;case 14:r.opts.CalcPrecision=Y;break;case 95:r.opts.CalcSaveRecalc=Y;break;case 15:M.CalcRefMode=Y;break;case 2211:r.opts.FullCalc=Y;break;case 129:Y.fDialog&&(s["!type"]="dialog"),Y.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Y.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:X.push(Y);break;case 430:ne.push([Y]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(Y);break;case 24:case 536:Z={Name:Y.Name,Ref:Rn(Y.rgce,o,null,ne,M)},Y.itab>0&&(Z.Sheet=Y.itab-1),ne.names.push(Z),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(J[Y.itab-1]={ref:xt(Y.rgce[0][0][1][2])});break;case 22:M.ExternCount=Y;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(Y),ne.XTI=ne.XTI.concat(Y);break;case 2196:if(M.biff<8)break;Z!=null&&(Z.Comment=Y[1]);break;case 18:s["!protect"]=Y;break;case 19:Y!==0&&M.WTF&&console.error("Password verifier: "+Y);break;case 133:i[Y.pos]=Y,M.snames.push(Y.name);break;case 10:{if(--ee)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=xt(o),e.sheetRows&&e.sheetRows<=o.e.r){var gt=o.e.r;o.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=xt(o),o.e.r=gt}o.e.r++,o.e.c++}Fe.length>0&&(s["!merges"]=Fe),Ce.length>0&&(s["!objects"]=Ce),Le.length>0&&(s["!cols"]=Le),Ne.length>0&&(s["!rows"]=Ne),k.Sheets.push(F)}h===""?d=s:n[h]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),M.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(M.biff=5,oe=!0,si(M.codepage=28591)),M.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(M.biff=2),ee++)break;if(s=e.dense?[]:{},M.biff<8&&!oe&&(oe=!0,si(M.codepage=e.codepage||1252)),M.biff<5||Y.BIFFVer==0&&Y.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var It={pos:t.l-xe,name:h};i[It.pos]=It,M.snames.push(h)}else h=(i[_e]||{name:""}).name;Y.dt==32&&(s["!type"]="chart"),Y.dt==64&&(s["!type"]="macro"),Fe=[],Ce=[],M.arrayf=O=[],Le=[],Ne=[],Se=!1,F={Hidden:(i[_e]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[Y.r]||[])[Y.c]:s[it({c:Y.c,r:Y.r})])&&++Y.c,N={ixfe:Y.ixfe,XF:X[Y.ixfe]||{},v:Y.val,t:"n"},b>0&&(N.z=te[N.ixfe>>8&63]),Ii(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e);break;case 5:case 517:N={ixfe:Y.ixfe,XF:X[Y.ixfe],v:Y.val,t:Y.t},b>0&&(N.z=te[N.ixfe>>8&63]),Ii(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e);break;case 638:N={ixfe:Y.ixfe,XF:X[Y.ixfe],v:Y.rknum,t:"n"},b>0&&(N.z=te[N.ixfe>>8&63]),Ii(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e);break;case 189:for(var ht=Y.c;ht<=Y.C;++ht){var Ue=Y.rkrec[ht-Y.c][0];N={ixfe:Ue,XF:X[Ue],v:Y.rkrec[ht-Y.c][1],t:"n"},b>0&&(N.z=te[N.ixfe>>8&63]),Ii(N,e,r.opts.Date1904),L({c:ht,r:Y.r},N,e)}break;case 6:case 518:case 1030:{if(Y.val=="String"){c=Y;break}if(N=u0(Y.val,Y.cell.ixfe,Y.tt),N.XF=X[N.ixfe],e.cellFormula){var Ht=Y.formula;if(Ht&&Ht[0]&&Ht[0][0]&&Ht[0][0][0]=="PtgExp"){var St=Ht[0][0][1][0],Tt=Ht[0][0][1][1],dr=it({r:St,c:Tt});R[dr]?N.f=""+Rn(Y.formula,o,Y.cell,ne,M):N.F=((e.dense?(s[St]||[])[Tt]:s[dr])||{}).F}else N.f=""+Rn(Y.formula,o,Y.cell,ne,M)}b>0&&(N.z=te[N.ixfe>>8&63]),Ii(N,e,r.opts.Date1904),L(Y.cell,N,e),c=Y}break;case 7:case 519:if(c)c.val=Y,N=u0(Y,c.cell.ixfe,"s"),N.XF=X[N.ixfe],e.cellFormula&&(N.f=""+Rn(c.formula,o,c.cell,ne,M)),b>0&&(N.z=te[N.ixfe>>8&63]),Ii(N,e,r.opts.Date1904),L(c.cell,N,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{O.push(Y);var gn=it(Y[0].s);if(_=e.dense?(s[Y[0].s.r]||[])[Y[0].s.c]:s[gn],e.cellFormula&&_){if(!c||!gn||!_)break;_.f=""+Rn(Y[1],o,Y[0],ne,M),_.F=xt(Y[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!c)break;R[it(c.cell)]=Y[0],_=e.dense?(s[c.cell.r]||[])[c.cell.c]:s[it(c.cell)],(_||{}).f=""+Rn(Y[0],o,g,ne,M)}}break;case 253:N=u0(f[Y.isst].t,Y.ixfe,"s"),f[Y.isst].h&&(N.h=f[Y.isst].h),N.XF=X[N.ixfe],b>0&&(N.z=te[N.ixfe>>8&63]),Ii(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e);break;case 513:e.sheetStubs&&(N={ixfe:Y.ixfe,XF:X[Y.ixfe],t:"z"},b>0&&(N.z=te[N.ixfe>>8&63]),Ii(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e));break;case 190:if(e.sheetStubs)for(var sn=Y.c;sn<=Y.C;++sn){var Wr=Y.ixfe[sn-Y.c];N={ixfe:Wr,XF:X[Wr],t:"z"},b>0&&(N.z=te[N.ixfe>>8&63]),Ii(N,e,r.opts.Date1904),L({c:sn,r:Y.r},N,e)}break;case 214:case 516:case 4:N=u0(Y.val,Y.ixfe,"s"),N.XF=X[N.ixfe],b>0&&(N.z=te[N.ixfe>>8&63]),Ii(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e);break;case 0:case 512:ee===1&&(o=Y);break;case 252:f=Y;break;case 1054:if(M.biff==4){te[b++]=Y[1];for(var Pr=0;Pr<b+163&&nt[Pr]!=Y[1];++Pr);Pr>=163&&fa(Y[1],b+163)}else fa(Y[1],Y[0]);break;case 30:{te[b++]=Y;for(var xn=0;xn<b+163&&nt[xn]!=Y;++xn);xn>=163&&fa(Y,b+163)}break;case 229:Fe=Fe.concat(Y);break;case 93:Ce[Y.cmo[0]]=M.lastobj=Y;break;case 438:M.lastobj.TxO=Y;break;case 127:M.lastobj.ImData=Y;break;case 440:for(T=Y[0].s.r;T<=Y[0].e.r;++T)for(y=Y[0].s.c;y<=Y[0].e.c;++y)_=e.dense?(s[T]||[])[y]:s[it({c:y,r:T})],_&&(_.l=Y[1]);break;case 2048:for(T=Y[0].s.r;T<=Y[0].e.r;++T)for(y=Y[0].s.c;y<=Y[0].e.c;++y)_=e.dense?(s[T]||[])[y]:s[it({c:y,r:T})],_&&_.l&&(_.l.Tooltip=Y[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;_=e.dense?(s[Y[0].r]||[])[Y[0].c]:s[it(Y[0])];var Vn=Ce[Y[2]];_||(e.dense?(s[Y[0].r]||(s[Y[0].r]=[]),_=s[Y[0].r][Y[0].c]={t:"z"}):_=s[it(Y[0])]={t:"z"},o.e.r=Math.max(o.e.r,Y[0].r),o.s.r=Math.min(o.s.r,Y[0].r),o.e.c=Math.max(o.e.c,Y[0].c),o.s.c=Math.min(o.s.c,Y[0].c)),_.c||(_.c=[]),S={a:Y[1],t:Vn.TxO.t},_.c.push(S)}break;case 2173:b5(X[Y.ixfe],Y.ext);break;case 125:{if(!M.cellStyles)break;for(;Y.e>=Y.s;)Le[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},Se||(Se=!0,ex(Y.w/256)),mo(Le[Y.e+1])}break;case 520:{var $t={};Y.level!=null&&(Ne[Y.r]=$t,$t.level=Y.level),Y.hidden&&(Ne[Y.r]=$t,$t.hidden=!0),Y.hpt&&(Ne[Y.r]=$t,$t.hpt=Y.hpt,$t.hpx=Rc(Y.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||nl(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=Y;break;case 161:s["!margins"]||nl(s["!margins"]={}),s["!margins"].header=Y.header,s["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(k.Views[0].RTL=!0);break;case 146:G=Y;break;case 2198:V=Y;break;case 140:U=Y;break;case 442:h?F.CodeName=Y||F.name:k.WBProps.CodeName=Y||"ThisWorkbook";break}}else Ee||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),t.l+=xe}return r.SheetNames=kr(i).sort(function(Yr,ot){return Number(Yr)-Number(ot)}).map(function(Yr){return i[Yr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&J.forEach(function(Yr,ot){r.Sheets[r.SheetNames[ot]]["!autofilter"]=Yr}),r.Strings=f,r.SSF=ur(nt),M.enc&&(r.Encryption=M.enc),V&&(r.Themes=V),r.Metadata={},U!==void 0&&(r.Metadata.Country=U),ne.names.length>0&&(k.Names=ne.names),r.Workbook=k,r}var Ku={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function KV(t,e,r){var n=Ze.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=X2(n,p1,Ku.DSI);for(var i in s)e[i]=s[i]}catch(h){if(r.WTF)throw h}var o=Ze.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var c=X2(o,m1,Ku.SI);for(var f in c)e[f]==null&&(e[f]=c[f])}catch(h){if(r.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(JS(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function XV(t,e){var r=[],n=[],s=[],i=0,o,c=k2(p1,"n"),f=k2(m1,"n");if(t.Props)for(o=kr(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(f,o[i])?n:s).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=kr(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(f,o[i])?n:s).push([o[i],t.Custprops[o[i]]]);var h=[];for(i=0;i<s.length;++i)ik.indexOf(s[i][0])>-1||QS.indexOf(s[i][0])>-1||s[i][1]!=null&&h.push(s[i]);n.length&&Ze.utils.cfb_add(e,"/SummaryInformation",Y2(n,Ku.SI,f,m1)),(r.length||h.length)&&Ze.utils.cfb_add(e,"/DocumentSummaryInformation",Y2(r,Ku.DSI,c,p1,h.length?h:null,Ku.UDI))}function eA(t,e){e||(e={}),cx(e),Rg(),e.codepage&&Fg(e.codepage);var r,n;if(t.FullPaths){if(Ze.find(t,"/encryption"))throw new Error("File is password-protected");r=Ze.find(t,"!CompObj"),n=Ze.find(t,"/Workbook")||Ze.find(t,"/Book")}else{switch(e.type){case"base64":t=_s(Es(t));break;case"binary":t=_s(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}hn(t,0),n={content:t}}var s,i;if(r&&HV(r),e.bookProps&&!e.bookSheets)s={};else{var o=_t?"buffer":"array";if(n&&n.content)s=qV(n.content,e);else if((i=Ze.find(t,"PerfectOffice_MAIN"))&&i.content)s=rl.to_workbook(i.content,(e.type=o,e));else if((i=Ze.find(t,"NativeContent_MAIN"))&&i.content)s=rl.to_workbook(i.content,(e.type=o,e));else throw(i=Ze.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Ze.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=lL(t))}var c={};return t.FullPaths&&KV(t,c,e),s.Props=s.Custprops=c,e.bookFiles&&(s.cfb=t),s}function YV(t,e){var r=e||{},n=Ze.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ze.utils.cfb_add(n,s,tA(t,r)),r.biff==8&&(t.Props||t.Custprops)&&XV(t,n),r.biff==8&&t.vbaraw&&cL(n,Ze.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var vf={0:{f:y9},1:{f:I9},2:{f:q9},3:{f:L9},4:{f:D9},5:{f:H9},6:{f:J9},7:{f:U9},8:{f:i7},9:{f:s7},10:{f:r7},11:{f:n7},12:{f:R9},13:{f:X9},14:{f:V9},15:{f:b9},16:{f:Gk},17:{f:e7},18:{f:z9},19:{f:Hg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:eV},40:{},42:{},43:{f:JO},44:{f:YO},45:{f:t5},46:{f:n5},47:{f:r5},48:{},49:{f:TP},50:{},51:{f:M5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:gk},62:{f:Q9},63:{f:G5},64:{f:w7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ln,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:x7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:A9},148:{f:T9,p:16},151:{f:f7},152:{},153:{f:Q7},154:{},155:{},156:{f:X7},157:{},158:{},159:{T:1,f:dO},160:{T:-1},161:{T:1,f:Tl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:a7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:O5},336:{T:-1},337:{f:U5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:d1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:mk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:h7},427:{f:d7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:m7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:k9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:c7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:d1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nL},633:{T:1},634:{T:-1},635:{T:1,f:tL},636:{T:-1},637:{f:CP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:V7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:E7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},w1={6:{f:Cm},10:{f:Xa},12:{f:Br},13:{f:Br},14:{f:Fr},15:{f:Fr},16:{f:Pn},17:{f:Fr},18:{f:Fr},19:{f:Br},20:{f:rw},21:{f:rw},23:{f:mk},24:{f:sw},25:{f:Fr},26:{},27:{},28:{f:E8},29:{},34:{f:Fr},35:{f:nw},38:{f:Pn},39:{f:Pn},40:{f:Pn},41:{f:Pn},42:{f:Fr},43:{f:Fr},47:{f:bO},49:{f:Xb},51:{f:Br},60:{},61:{f:Hb},64:{f:Fr},65:{f:Kb},66:{f:Br},77:{},80:{},81:{},82:{},85:{f:Br},89:{},90:{},91:{},92:{f:Pb},93:{f:k8},94:{},95:{f:Fr},96:{},97:{},99:{f:Fr},125:{f:gk},128:{f:u8},129:{f:Ob},130:{f:Br},131:{f:Fr},132:{f:Fr},133:{f:Lb},134:{},140:{f:P8},141:{f:Br},144:{},146:{f:L8},151:{},152:{},153:{},154:{},155:{},156:{f:Br},157:{},158:{},160:{f:W8},161:{f:B8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:a8},190:{f:o8},193:{f:Xa},197:{},198:{},199:{},200:{},201:{},202:{f:Fr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Br},220:{},221:{f:Fr},222:{},224:{f:c8},225:{f:Db},226:{f:Xa},227:{},229:{f:T8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Vb},253:{f:Qb},255:{f:Ub},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ak},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Fr},353:{f:Xa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:m8},431:{f:Fr},432:{},433:{},434:{},437:{},438:{f:I8},439:{f:Fr},440:{f:F8},441:{},442:{f:Uf},443:{},444:{f:Br},445:{},446:{},448:{f:Xa},449:{f:Wb,r:2},450:{f:Xa},512:{f:Z2},513:{f:z8},515:{f:d8},516:{f:Zb},517:{f:tw},519:{f:H8},520:{f:jb},523:{},545:{f:iw},549:{f:J2},566:{},574:{f:Gb},638:{f:i8},659:{},1048:{},1054:{f:t8},1084:{},1212:{f:_8},2048:{f:N8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:o0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Xa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:M8,r:12},2173:{f:P5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Fr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:v8,r:12},2197:{},2198:{f:C5,r:12},2199:{},2200:{},2201:{},2202:{f:y8,r:12},2203:{f:Xa},2204:{},2205:{},2206:{},2207:{},2211:{f:zb},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Br},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:U8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:O8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Z2},1:{},2:{f:X8},3:{f:q8},4:{f:G8},5:{f:tw},7:{f:Q8},8:{},9:{f:o0},11:{},22:{f:Br},30:{f:n8},31:{},32:{},33:{f:iw},36:{},37:{f:J2},50:{f:J8},62:{},52:{},67:{},68:{f:Br},69:{},86:{},126:{},127:{f:$8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Z8},223:{},234:{},354:{},421:{},518:{f:Cm},521:{f:o0},536:{f:sw},547:{f:nw},561:{},579:{},1030:{f:Cm},1033:{f:o0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function je(t,e,r,n){var s=e;if(!isNaN(s)){var i=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&jg(r)&&t.push(r)}}function QV(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return je(t,e,r,s);var i=e;if(!isNaN(i)){for(var o=r.parts||[],c=0,f=0,h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;var d=t.next(4);for(d.write_shift(2,i),d.write_shift(2,h),t.push(r.slice(f,f+h)),f+=h;f<s;){for(d=t.next(4),d.write_shift(2,60),h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;d.write_shift(2,h),t.push(r.slice(f,f+h)),f+=h}}}function Hf(t,e,r){return t||(t=me(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function JV(t,e,r,n){var s=me(9);return Hf(s,t,e),ok(r,n||"b",s),s}function ZV(t,e,r){var n=me(8+2*r.length);return Hf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function eB(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?Xr(cr(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?je(t,2,Y8(r,n,s)):je(t,3,K8(r,n,s));return;case"b":case"e":je(t,5,JV(r,n,e.v,e.t));return;case"s":case"str":je(t,4,ZV(r,n,(e.v||"").slice(0,255)));return}je(t,1,Hf(null,r,n))}function tB(t,e,r,n){var s=Array.isArray(e),i=bt(e["!ref"]||"A1"),o,c="",f=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=xt(i)}for(var h=i.s.r;h<=i.e.r;++h){c=Nr(h);for(var d=i.s.c;d<=i.e.c;++d){h===i.s.r&&(f[d]=vr(d)),o=f[d]+c;var g=s?(e[h]||[])[d]:e[o];g&&eB(t,g,h,d)}}}function rB(t,e){for(var r=e||{},n=ss(),s=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return je(n,r.biff==4?1033:r.biff==3?521:9,Qg(t,16,r)),tB(n,t.Sheets[t.SheetNames[s]],s,r),je(n,10),n.end()}function nB(t,e,r){je(t,49,Yb({sz:12,name:"Arial"},r))}function sB(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&je(t,1054,r8(s,e[s],r))})}function iB(t,e){var r=me(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),je(t,2151,r),r=me(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),hk(bt(e["!ref"]||"A1"),r),r.write_shift(4,4),je(t,2152,r)}function aB(t,e){for(var r=0;r<16;++r)je(t,224,ew({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){je(t,224,ew(n,0,e))})}function oB(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];je(t,440,R8(n)),n[1].Tooltip&&je(t,2048,D8(n))}delete e["!links"]}function lB(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&je(t,125,V8(Rd(s,n),s))})}}function cB(t,e,r,n,s){var i=16+To(s.cellXfs,e,s);if(e.v==null&&!e.bf){je(t,513,pl(r,n,i));return}if(e.bf)je(t,6,OM(e,r,n,s,i));else switch(e.t){case"d":case"n":var o=e.t=="d"?Xr(cr(e.v)):e.v;je(t,515,p8(r,n,o,i));break;case"b":case"e":je(t,517,h8(r,n,e.v,i,s,e.t));break;case"s":case"str":if(s.bookSST){var c=ix(s.Strings,e.v,s.revStrings);je(t,253,Jb(r,n,c,i))}else je(t,516,e8(r,n,(e.v||"").slice(0,255),i,s));break;default:je(t,513,pl(r,n,i))}}function uB(t,e,r){var n=ss(),s=r.SheetNames[t],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},c=(o.Sheets||[])[t]||{},f=Array.isArray(i),h=e.biff==8,d,g="",x=[],_=bt(i["!ref"]||"A1"),S=h?65536:16384;if(_.e.c>255||_.e.r>=S){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,S-1)}je(n,2057,Qg(r,16,e)),je(n,13,Vs(1)),je(n,12,Vs(100)),je(n,15,Hn(!0)),je(n,17,Hn(!1)),je(n,16,hl(.001)),je(n,95,Hn(!0)),je(n,42,Hn(!1)),je(n,43,Hn(!1)),je(n,130,Vs(1)),je(n,128,f8()),je(n,131,Hn(!1)),je(n,132,Hn(!1)),h&&lB(n,i["!cols"]),je(n,512,s8(_,e)),h&&(i["!links"]=[]);for(var y=_.s.r;y<=_.e.r;++y){g=Nr(y);for(var T=_.s.c;T<=_.e.c;++T){y===_.s.r&&(x[T]=vr(T)),d=x[T]+g;var R=f?(i[y]||[])[T]:i[d];R&&(cB(n,R,y,T,e),h&&R.l&&i["!links"].push([d,R.l]))}}var O=c.CodeName||c.name||s;return h&&je(n,574,qb((o.Views||[])[0])),h&&(i["!merges"]||[]).length&&je(n,229,S8(i["!merges"])),h&&oB(n,i),je(n,442,lk(O)),h&&iB(n,i),je(n,10),n.end()}function fB(t,e,r){var n=ss(),s=(t||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},c=r.biff==8,f=r.biff==5;if(je(n,2057,Qg(t,5,r)),r.bookType=="xla"&&je(n,135),je(n,225,c?Vs(1200):null),je(n,193,hb(2)),f&&je(n,191),f&&je(n,192),je(n,226),je(n,92,bb("SheetJS",r)),je(n,66,Vs(c?1200:1252)),c&&je(n,353,Vs(0)),c&&je(n,448),je(n,317,j8(t.SheetNames.length)),c&&t.vbaraw&&je(n,211),c&&t.vbaraw){var h=o.CodeName||"ThisWorkbook";je(n,442,lk(h))}je(n,156,Vs(17)),je(n,25,Hn(!1)),je(n,18,Hn(!1)),je(n,19,Vs(0)),c&&je(n,431,Hn(!1)),c&&je(n,444,Vs(0)),je(n,61,$b()),je(n,64,Hn(!1)),je(n,141,Vs(0)),je(n,34,Hn(W7(t)=="true")),je(n,14,Hn(!0)),c&&je(n,439,Hn(!1)),je(n,218,Vs(0)),nB(n,t,r),sB(n,t.SSF,r),aB(n,r),c&&je(n,352,Hn(!1));var d=n.end(),g=ss();c&&je(g,140,b8()),c&&r.Strings&&QV(g,252,Bb(r.Strings)),je(g,10);var x=g.end(),_=ss(),S=0,y=0;for(y=0;y<t.SheetNames.length;++y)S+=(c?12:11)+(c?2:1)*t.SheetNames[y].length;var T=d.length+S+x.length;for(y=0;y<t.SheetNames.length;++y){var R=i[y]||{};je(_,133,Mb({pos:T,hs:R.Hidden||0,dt:0,name:t.SheetNames[y]},r)),T+=e[y].length}var O=_.end();if(S!=O.length)throw new Error("BS8 "+S+" != "+O.length);var N=[];return d.length&&N.push(d),O.length&&N.push(O),x.length&&N.push(x),rn(N)}function hB(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=ur(nt)),t&&t.SSF&&(jc(),Td(t.SSF),r.revssf=kd(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ux(r),r.cellXfs=[],To(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=uB(s,r,t);return n.unshift(fB(t,n,r)),rn(n)}function tA(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=is(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return hB(t,e);case 4:case 3:case 2:return rB(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function mw(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),o=s.index,c=i&&i.index||t.length,f=YD(t.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,d=0,g=0,x=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(o=0;o<f.length;++o){var y=f[o].trim(),T=y.slice(0,3).toLowerCase();if(T=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}d=0;continue}if(!(T!="<td"&&T!="<th")){var R=y.split(/<\/t[dh]>/i);for(c=0;c<R.length;++c){var O=R[c].trim();if(O.match(/<t[dh]/i)){for(var N=O,U=0;N.charAt(0)=="<"&&(U=N.indexOf(">"))>-1;)N=N.slice(U+1);for(var X=0;X<S.length;++X){var G=S[X];G.s.c==d&&G.s.r<h&&h<=G.e.r&&(d=G.e.c+1,X=-1)}var k=lt(O.slice(0,O.indexOf(">")));x=k.colspan?+k.colspan:1,((g=+k.rowspan)>1||x>1)&&S.push({s:{r:h,c:d},e:{r:h+(g||1)-1,c:d+x-1}});var F=k.t||k["data-t"]||"";if(!N.length){d+=x;continue}if(N=kS(N),_.s.r>h&&(_.s.r=h),_.e.r<h&&(_.e.r=h),_.s.c>d&&(_.s.c=d),_.e.c<d&&(_.e.c=d),!N.length){d+=x;continue}var I={t:"s",v:N};r.raw||!N.trim().length||F=="s"||(N==="TRUE"?I={t:"b",v:!0}:N==="FALSE"?I={t:"b",v:!1}:isNaN(oi(N))?isNaN(Ic(N).getDate())||(I={t:"d",v:cr(N)},r.cellDates||(I={t:"n",v:Xr(I.v)}),I.z=r.dateNF||nt[14]):I={t:"n",v:oi(N)}),r.dense?(n[h]||(n[h]=[]),n[h][d]=I):n[it({r:h,c:d})]=I,d+=x}}}}return n["!ref"]=xt(_),S.length&&(n["!merges"]=S),n}function dB(t,e,r,n){for(var s=t["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var c=0,f=0,h=0;h<s.length;++h)if(!(s[h].s.r>r||s[h].s.c>o)&&!(s[h].e.r<r||s[h].e.c<o)){if(s[h].s.r<r||s[h].s.c<o){c=-1;break}c=s[h].e.r-s[h].s.r+1,f=s[h].e.c-s[h].s.c+1;break}if(!(c<0)){var d=it({r,c:o}),g=n.dense?(t[r]||[])[o]:t[d],x=g&&g.v!=null&&(g.h||Vg(g.w||(xa(g),g.w)||""))||"",_={};c>1&&(_.rowspan=c),f>1&&(_.colspan=f),n.editable?x='<span contenteditable="true">'+x+"</span>":g&&(_["data-t"]=g&&g.t||"z",g.v!=null&&(_["data-v"]=g.v),g.z!=null&&(_["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+g.l.Target+'">'+x+"</a>")),_.id=(n.id||"sjs")+"-"+d,i.push(Be("td",x,_))}}var S="<tr>";return S+i.join("")+"</tr>"}var pB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',mB="</body></html>";function gB(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Eo(mw(r[0],e),e);var n=px();return r.forEach(function(s,i){mx(n,mw(s,e),"Sheet"+(i+1))}),n}function xB(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function rA(t,e){var r=e||{},n=r.header!=null?r.header:pB,s=r.footer!=null?r.footer:mB,i=[n],o=is(t["!ref"]);r.dense=Array.isArray(t),i.push(xB(t,o,r));for(var c=o.s.r;c<=o.e.r;++c)i.push(dB(t,o,c,r));return i.push("</table>"+s),i.join("")}function nA(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?_r(n.origin):n.origin;s=o.r,i=o.c}var c=e.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var d=is(t["!ref"]);h.s.r=Math.min(h.s.r,d.s.r),h.s.c=Math.min(h.s.c,d.s.c),h.e.r=Math.max(h.e.r,d.e.r),h.e.c=Math.max(h.e.c,d.e.c),s==-1&&(h.e.r=s=d.e.r+1)}var g=[],x=0,_=t["!rows"]||(t["!rows"]=[]),S=0,y=0,T=0,R=0,O=0,N=0;for(t["!cols"]||(t["!cols"]=[]);S<c.length&&y<f;++S){var U=c[S];if(gw(U)){if(n.display)continue;_[y]={hidden:!0}}var X=U.children;for(T=R=0;T<X.length;++T){var G=X[T];if(!(n.display&&gw(G))){var k=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):kS(G.innerHTML),F=G.getAttribute("data-z")||G.getAttribute("z");for(x=0;x<g.length;++x){var I=g[x];I.s.c==R+i&&I.s.r<y+s&&y+s<=I.e.r&&(R=I.e.c+1-i,x=-1)}N=+G.getAttribute("colspan")||1,((O=+G.getAttribute("rowspan")||1)>1||N>1)&&g.push({s:{r:y+s,c:R+i},e:{r:y+s+(O||1)-1,c:R+i+(N||1)-1}});var B={t:"s",v:k},L=G.getAttribute("data-t")||G.getAttribute("t")||"";k!=null&&(k.length==0?B.t=L||"z":n.raw||k.trim().length==0||L=="s"||(k==="TRUE"?B={t:"b",v:!0}:k==="FALSE"?B={t:"b",v:!1}:isNaN(oi(k))?isNaN(Ic(k).getDate())||(B={t:"d",v:cr(k)},n.cellDates||(B={t:"n",v:Xr(B.v)}),B.z=n.dateNF||nt[14]):B={t:"n",v:oi(k)})),B.z===void 0&&F!=null&&(B.z=F);var M="",V=G.getElementsByTagName("A");if(V&&V.length)for(var Fe=0;Fe<V.length&&!(V[Fe].hasAttribute("href")&&(M=V[Fe].getAttribute("href"),M.charAt(0)!="#"));++Fe);M&&M.charAt(0)!="#"&&(B.l={Target:M}),n.dense?(t[y+s]||(t[y+s]=[]),t[y+s][R+i]=B):t[it({c:R+i,r:y+s})]=B,h.e.c<R+i&&(h.e.c=R+i),R+=N}}++y}return g.length&&(t["!merges"]=(t["!merges"]||[]).concat(g)),h.e.r=Math.max(h.e.r,y-1+s),t["!ref"]=xt(h),y>=f&&(t["!fullref"]=xt((h.e.r=c.length-S+y-1+s,h))),t}function sA(t,e){var r=e||{},n=r.dense?[]:{};return nA(n,t,e)}function vB(t,e){return Eo(sA(t,e),e)}function gw(t){var e="",r=_B(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function _B(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function yB(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Pt(e.replace(/<[^>]*>/g,""));return[r]}var xw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function iA(t,e){var r=e||{},n=Bg(t),s=[],i,o,c={name:""},f="",h=0,d,g,x={},_=[],S=r.dense?[]:{},y,T,R={value:""},O="",N=0,U=[],X=-1,G=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,I={},B=[],L={},M=0,V=0,Fe=[],Ce=1,Le=1,Ne=[],Se={Names:[]},ne={},ye=["",""],ee=[],b={},te="",J=0,Z=!1,oe=!1,_e=0;for(hf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=hf.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?S["!ref"]=xt(k):S["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(S["!fullref"]=S["!ref"],k.e.r=r.sheetRows-1,S["!ref"]=xt(k)),B.length&&(S["!merges"]=B),Fe.length&&(S["!rows"]=Fe),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),_.push(d.name),x[d.name]=S,oe=!1):y[0].charAt(y[0].length-2)!=="/"&&(d=lt(y[0],!1),X=G=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,S=r.dense?[]:{},B=[],Fe=[],oe=!0);break;case"table-row-group":y[1]==="/"?--F:++F;break;case"table-row":case"":if(y[1]==="/"){X+=Ce,Ce=1;break}if(g=lt(y[0],!1),g.?X=g.-1:X==-1&&(X=0),Ce=+g["number-rows-repeated"]||1,Ce<10)for(_e=0;_e<Ce;++_e)F>0&&(Fe[X+_e]={level:F});G=-1;break;case"covered-table-cell":y[1]!=="/"&&++G,r.sheetStubs&&(r.dense?(S[X]||(S[X]=[]),S[X][G]={t:"z"}):S[it({r:X,c:G})]={t:"z"}),O="",U=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++G,R=lt(y[0],!1),Le=parseInt(R["number-columns-repeated"]||"1",10),T={t:"z",v:null},R.formula&&r.cellFormula!=!1&&(T.f=hw(Pt(R.formula))),(R.||R["value-type"])=="string"&&(T.t="s",T.v=Pt(R["string-value"]||""),r.dense?(S[X]||(S[X]=[]),S[X][G]=T):S[it({r:X,c:G})]=T),G+=Le-1;else if(y[1]!=="/"){++G,O="",N=0,U=[],Le=1;var ve=Ce?X+Ce-1:X;if(G>k.e.c&&(k.e.c=G),G<k.s.c&&(k.s.c=G),X<k.s.r&&(k.s.r=X),ve>k.e.r&&(k.e.r=ve),R=lt(y[0],!1),ee=[],b={},T={t:R.||R["value-type"],v:null},r.cellFormula)if(R.formula&&(R.formula=Pt(R.formula)),R["number-matrix-columns-spanned"]&&R["number-matrix-rows-spanned"]&&(M=parseInt(R["number-matrix-rows-spanned"],10)||0,V=parseInt(R["number-matrix-columns-spanned"],10)||0,L={s:{r:X,c:G},e:{r:X+M-1,c:G+V-1}},T.F=xt(L),Ne.push([L,T.F])),R.formula)T.f=hw(R.formula);else for(_e=0;_e<Ne.length;++_e)X>=Ne[_e][0].s.r&&X<=Ne[_e][0].e.r&&G>=Ne[_e][0].s.c&&G<=Ne[_e][0].e.c&&(T.F=Ne[_e][1]);switch((R["number-columns-spanned"]||R["number-rows-spanned"])&&(M=parseInt(R["number-rows-spanned"],10)||0,V=parseInt(R["number-columns-spanned"],10)||0,L={s:{r:X,c:G},e:{r:X+M-1,c:G+V-1}},B.push(L)),R["number-columns-repeated"]&&(Le=parseInt(R["number-columns-repeated"],10)),T.t){case"boolean":T.t="b",T.v=or(R["boolean-value"]);break;case"float":T.t="n",T.v=parseFloat(R.value);break;case"percentage":T.t="n",T.v=parseFloat(R.value);break;case"currency":T.t="n",T.v=parseFloat(R.value);break;case"date":T.t="d",T.v=cr(R["date-value"]),r.cellDates||(T.t="n",T.v=Xr(T.v)),T.z="m/d/yy";break;case"time":T.t="n",T.v=qD(R["time-value"])/86400,r.cellDates&&(T.t="d",T.v=Ad(T.v)),T.z="HH:MM:SS";break;case"number":T.t="n",T.v=parseFloat(R.);break;default:if(T.t==="string"||T.t==="text"||!T.t)T.t="s",R["string-value"]!=null&&(O=Pt(R["string-value"]),U=[]);else throw new Error("Unsupported value type "+T.t)}}else{if(Z=!1,T.t==="s"&&(T.v=O||"",U.length&&(T.R=U),Z=N==0),ne.Target&&(T.l=ne),ee.length>0&&(T.c=ee,ee=[]),O&&r.cellText!==!1&&(T.w=O),Z&&(T.t="z",delete T.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=X))for(var xe=0;xe<Ce;++xe){if(Le=parseInt(R["number-columns-repeated"]||"1",10),r.dense)for(S[X+xe]||(S[X+xe]=[]),S[X+xe][G]=xe==0?T:ur(T);--Le>0;)S[X+xe][G+Le]=ur(T);else for(S[it({r:X+xe,c:G})]=T;--Le>0;)S[it({r:X+xe,c:G+Le})]=ur(T);k.e.c<=G&&(k.e.c=G)}Le=parseInt(R["number-columns-repeated"]||"1",10),G+=Le-1,Le=0,T={},O="",U=[]}ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i;b.t=O,U.length&&(b.R=U),b.a=te,ee.push(b)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);te="",J=0,O="",N=0,U=[];break;case"creator":y[1]==="/"?te=n.slice(J,y.index):J=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);O="",N=0,U=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(I[c.name]=f,(i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(f="",c=lt(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=lt(y[0],!1),f+=xw[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=lt(y[0],!1),f+=xw[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(h,y.index);break}else h=y.index+y[0].length;break;case"named-range":o=lt(y[0],!1),ye=Im(o["cell-range-address"]);var Ee={Name:o.name,Ref:ye[0]+"!"+ye[1]};oe&&(Ee.Sheet=_.length),Se.Names.push(Ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!R||!R["string-value"])){var st=yB(n.slice(N,y.index));O=(O.length>0?O+`
`:"")+st[0]}else lt(y[0],!1),N=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{ye=Im(lt(y[0])["target-range-address"]),x[ye[0]]["!autofilter"]={ref:ye[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(ne=lt(y[0],!1),!ne.href)break;ne.Target=Pt(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(ye=Im(ne.Target.slice(1)),ne.Target="#"+ye[0]+"!"+ye[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var Y={Sheets:x,SheetNames:_,Workbook:Se};return r.bookSheets&&delete Y.Sheets,Y}function vw(t,e){e=e||{},Ms(t,"META-INF/manifest.xml")&&qP(Vr(t,"META-INF/manifest.xml"),e);var r=ys(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=iA(Qt(r),e);return Ms(t,"meta.xml")&&(n.Props=XS(Vr(t,"meta.xml"))),n}function _w(t,e){return iA(t,e)}var wB=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+ff({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Dr+e}})(),yw=(function(){var t=function(i){return Yt(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,c){var f=[];f.push('      <table:table table:name="'+Yt(o.SheetNames[c])+`" table:style-name="ta1">
`);var h=0,d=0,g=is(i["!ref"]||"A1"),x=i["!merges"]||[],_=0,S=Array.isArray(i);if(i["!cols"])for(d=0;d<=g.e.c;++d)f.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var y="",T=i["!rows"]||[];for(h=0;h<g.s.r;++h)y=T[h]?' table:style-name="ro'+T[h].ods+'"':"",f.push("        <table:table-row"+y+`></table:table-row>
`);for(;h<=g.e.r;++h){for(y=T[h]?' table:style-name="ro'+T[h].ods+'"':"",f.push("        <table:table-row"+y+`>
`),d=0;d<g.s.c;++d)f.push(e);for(;d<=g.e.c;++d){var R=!1,O={},N="";for(_=0;_!=x.length;++_)if(!(x[_].s.c>d)&&!(x[_].s.r>h)&&!(x[_].e.c<d)&&!(x[_].e.r<h)){(x[_].s.c!=d||x[_].s.r!=h)&&(R=!0),O["table:number-columns-spanned"]=x[_].e.c-x[_].s.c+1,O["table:number-rows-spanned"]=x[_].e.r-x[_].s.r+1;break}if(R){f.push(r);continue}var U=it({r:h,c:d}),X=S?(i[h]||[])[d]:i[U];if(X&&X.f&&(O["table:formula"]=Yt(jM(X.f)),X.F&&X.F.slice(0,U.length)==U)){var G=is(X.F);O["table:number-matrix-columns-spanned"]=G.e.c-G.s.c+1,O["table:number-matrix-rows-spanned"]=G.e.r-G.s.r+1}if(!X){f.push(e);continue}switch(X.t){case"b":N=X.v?"TRUE":"FALSE",O["office:value-type"]="boolean",O["office:boolean-value"]=X.v?"true":"false";break;case"n":N=X.w||String(X.v||0),O["office:value-type"]="float",O["office:value"]=X.v||0;break;case"s":case"str":N=X.v==null?"":X.v,O["office:value-type"]="string";break;case"d":N=X.w||cr(X.v).toISOString(),O["office:value-type"]="date",O["office:date-value"]=cr(X.v).toISOString(),O["table:style-name"]="ce1";break;default:f.push(e);continue}var k=t(N);if(X.l&&X.l.Target){var F=X.l.Target;F=F.charAt(0)=="#"?"#"+zM(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),k=Be("text:a",k,{"xlink:href":F.replace(/&/g,"&amp;")})}f.push("          "+Be("table:table-cell",Be("text:p",k,{}),O)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var d=0;d<h["!cols"].length;++d)if(h["!cols"][d]){var g=h["!cols"][d];if(g.width==null&&g.wpx==null&&g.wch==null)continue;mo(g),g.ods=c;var x=h["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),i.push(`  </style:style>
`),++c}}});var f=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var d=0;d<h["!rows"].length;++d)if(h["!rows"][d]){h["!rows"][d].ods=f;var g=h["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),i.push(`  </style:style>
`),++f}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,c){var f=[Dr],h=ff({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=ff({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(f.push("<office:document"+h+d+`>
`),f.push(KS().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+h+`>
`),s(f,o),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)f.push(n(o.Sheets[o.SheetNames[g]],o,g));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),c.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function aA(t,e){if(e.bookType=="fods")return yw(t,e);var r=Og(),n="",s=[],i=[];return n="mimetype",vt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",vt(r,n,yw(t,e)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",vt(r,n,wB(t,e)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",vt(r,n,Dr+KS()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",vt(r,n,YP(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",vt(r,n,KP(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ml(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function E1(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Qt(wo(t))}function EB(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):_s(Pi(t))}function TB(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function xo(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function ww(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function SB(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function kB(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)t[e+i]=s&255;t[e+15]|=r>=0?0:128}function _f(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Kt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Sr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Lt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=_f(t,r),i=s&7;s=Math.floor(s/8);var o=0,c;if(s==0)break;switch(i){case 0:{for(var f=r[0];t[r[0]++]>=128;);c=t.slice(f,r[0])}break;case 5:o=4,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=_f(t,r),c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var h={data:c,type:i};e[s]==null?e[s]=[h]:e[s].push(h)}return e}function un(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(Kt(n*8+s.type)),s.type==2&&e.push(Kt(s.data.length)),e.push(s.data))})}),xo(e)}function lx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Os(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=_f(t,n),i=Lt(t.slice(n[0],n[0]+s));n[0]+=s;var o={id:Sr(i[1][0].data),messages:[]};i[2].forEach(function(c){var f=Lt(c.data),h=Sr(f[3][0].data);o.messages.push({meta:f,data:t.slice(n[0],n[0]+h)}),n[0]+=h}),(e=i[3])!=null&&e[0]&&(o.merge=Sr(i[3][0].data)>>>0>0),r.push(o)}return r}function nc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Kt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Kt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Kt(o.data.length)}],n[2].push({data:un(o.meta),type:2})});var i=un(n);e.push(Kt(i.length)),e.push(i),s.forEach(function(o){return e.push(o)})}),xo(e)}function AB(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=_f(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=e[r[0]],c>1&&(o|=e[r[0]+1]<<8),c>2&&(o|=e[r[0]+2]<<16),c>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}s.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var f=0,h=0;if(i==1?(h=(e[r[0]]>>2&7)+4,f=(e[r[0]++]&224)<<3,f|=e[r[0]++]):(h=(e[r[0]++]>>2)+1,i==2?(f=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(f=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[xo(s)],f==0)throw new Error("Invalid offset 0");if(f>s[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(s.push(s[0].slice(-f)),h-=f;h>=s[s.length-1].length;)s.push(s[s.length-1]),h-=s[s.length-1].length;s.push(s[0].slice(-f,-f+h))}}var d=xo(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Ls(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(AB(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return xo(e)}function sc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var i=Kt(n),o=i.length;e.push(i),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return xo(e)}function CB(t,e,r,n){var s=ml(t),i=s.getUint32(4,!0),o=(n>1?12:8)+ww(i&(n>1?3470:398))*4,c=-1,f=-1,h=NaN,d=new Date(2001,0,1);i&512&&(c=s.getUint32(o,!0),o+=4),o+=ww(i&(n>1?12288:4096))*4,i&16&&(f=s.getUint32(o,!0),o+=4),i&32&&(h=s.getFloat64(o,!0),o+=8),i&64&&(d.setTime(d.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var g;switch(t[2]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:e[f]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(c>-1)g={t:"s",v:r[c]};else if(f>-1)g={t:"s",v:e[f]};else if(!isNaN(h))g={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return g}function IB(t,e,r){var n=ml(t),s=n.getUint32(8,!0),i=12,o=-1,c=-1,f=NaN,h=NaN,d=new Date(2001,0,1);s&1&&(f=SB(t,i),i+=16),s&2&&(h=n.getFloat64(i,!0),i+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(c=n.getUint32(i,!0),i+=4),s&16&&(o=n.getUint32(i,!0),i+=4);var g;switch(t[1]){case 0:break;case 2:g={t:"n",v:f};break;case 3:g={t:"s",v:e[c]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:g={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return g}function Rm(t,e){var r=new Uint8Array(32),n=ml(r),s=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,kB(r,s,t.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),i|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,s)}function Nm(t,e){var r=new Uint8Array(32),n=ml(r),s=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),i|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,s)}function FB(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return CB(t,e,r,t[0]);case 5:return IB(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function In(t){var e=Lt(t);return _f(e[1][0].data)}function Ew(t,e){var r=Lt(e.data),n=Sr(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var c=Lt(o.data),f=Sr(c[1][0].data)>>>0;switch(n){case 1:i[f]=E1(c[3][0].data);break;case 8:{var h=t[In(c[9][0].data)][0],d=Lt(h.data),g=t[In(d[1][0].data)][0],x=Sr(g.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var _=Lt(g.data);i[f]=_[3].map(function(S){return E1(S.data)}).join("")}break}}),i}function RB(t,e){var r,n,s,i,o,c,f,h,d,g,x,_,S,y,T=Lt(t),R=Sr(T[1][0].data)>>>0,O=Sr(T[2][0].data)>>>0,N=((n=(r=T[8])==null?void 0:r[0])==null?void 0:n.data)&&Sr(T[8][0].data)>0||!1,U,X;if((i=(s=T[7])==null?void 0:s[0])!=null&&i.data&&e!=0)U=(c=(o=T[7])==null?void 0:o[0])==null?void 0:c.data,X=(h=(f=T[6])==null?void 0:f[0])==null?void 0:h.data;else if((g=(d=T[4])==null?void 0:d[0])!=null&&g.data&&e!=1)U=(_=(x=T[4])==null?void 0:x[0])==null?void 0:_.data,X=(y=(S=T[3])==null?void 0:S[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var G=N?4:1,k=ml(U),F=[],I=0;I<U.length/2;++I){var B=k.getUint16(I*2,!0);B<65535&&F.push([I,B])}if(F.length!=O)throw"Expected ".concat(O," cells, found ").concat(F.length);var L=[];for(I=0;I<F.length-1;++I)L[F[I][0]]=X.subarray(F[I][1]*G,F[I+1][1]*G);return F.length>=1&&(L[F[F.length-1][0]]=X.subarray(F[F.length-1][1]*G)),{R,cells:L}}function NB(t,e){var r,n=Lt(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Sr(n[7][0].data)>>>0>0?1:0:-1,i=lx(n[5],function(o){return RB(o,s)});return{nrows:Sr(n[4][0].data)>>>0,data:i.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(f,h){if(o[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));o[c.R][h]=f}),o},[])}}function DB(t,e,r){var n,s=Lt(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Sr(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Sr(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=xt(i);var o=Lt(s[4][0].data),c=Ew(t,t[In(o[4][0].data)][0]),f=(n=o[17])!=null&&n[0]?Ew(t,t[In(o[17][0].data)][0]):[],h=Lt(o[3][0].data),d=0;h[1].forEach(function(g){var x=Lt(g.data),_=t[In(x[2][0].data)][0],S=Sr(_.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var y=NB(t,_);y.data.forEach(function(T,R){T.forEach(function(O,N){var U=it({r:d+R,c:N}),X=FB(O,c,f);X&&(r[U]=X)})}),d+=y.nrows})}function PB(t,e){var r=Lt(e.data),n={"!ref":"A1"},s=t[In(r[2][0].data)],i=Sr(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return DB(t,s[0],n),n}function bB(t,e){var r,n=Lt(e.data),s={name:(r=n[1])!=null&&r[0]?E1(n[1][0].data):"",sheets:[]},i=lx(n[2],In);return i.forEach(function(o){t[o].forEach(function(c){var f=Sr(c.meta[1][0].data);f==6e3&&s.sheets.push(PB(t,c))})}),s}function OB(t,e){var r=px(),n=Lt(e.data),s=lx(n[1],In);if(s.forEach(function(i){t[i].forEach(function(o){var c=Sr(o.meta[1][0].data);if(c==2){var f=bB(t,o);f.sheets.forEach(function(h,d){mx(r,h,d==0?f.name:f.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Dm(t){var e,r,n,s,i={},o=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var h;try{h=Ls(f.content)}catch(g){return console.log("?? "+f.content.length+" "+(g.message||g))}var d;try{d=Os(h)}catch(g){return console.log("## "+(g.message||g))}d.forEach(function(g){i[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var c=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Sr(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||o.forEach(function(f){i[f].forEach(function(h){var d=Sr(h.meta[1][0].data)>>>0;if(d==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return OB(i,c)}function LB(t,e,r){var n,s,i,o;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&Sr(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var f=0,h=ml(t[7][0].data),d=0,g=[],x=ml(t[4][0].data),_=0,S=[],y=0;y<e.length;++y){if(e[y]==null){h.setUint16(y*2,65535,!0),x.setUint16(y*2,65535);continue}h.setUint16(y*2,d,!0),x.setUint16(y*2,_,!0);var T,R;switch(typeof e[y]){case"string":T=Rm({t:"s",v:e[y]},r),R=Nm({t:"s",v:e[y]},r);break;case"number":T=Rm({t:"n",v:e[y]},r),R=Nm({t:"n",v:e[y]},r);break;case"boolean":T=Rm({t:"b",v:e[y]},r),R=Nm({t:"b",v:e[y]},r);break;default:throw new Error("Unsupported value "+e[y])}g.push(T),d+=T.length,S.push(R),_+=R.length,++f}for(t[2][0].data=Kt(f);y<t[7][0].data.length/2;++y)h.setUint16(y*2,65535,!0),x.setUint16(y*2,65535,!0);return t[6][0].data=xo(g),t[3][0].data=xo(S),f}function MB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=is(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(xt(n)));var i=ed(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(te){return te.forEach(function(J){typeof J=="string"&&o.push(J)})});var c={},f=[],h=Ze.read(e.numbers,{type:"base64"});h.FileIndex.map(function(te,J){return[te,h.FullPaths[J]]}).forEach(function(te){var J=te[0],Z=te[1];if(J.type==2&&J.name.match(/\.iwa/)){var oe=J.content,_e=Ls(oe),ve=Os(_e);ve.forEach(function(xe){f.push(xe.id),c[xe.id]={deps:[],location:Z,type:Sr(xe.messages[0].meta[1][0].data)}})}}),f.sort(function(te,J){return te-J});var d=f.filter(function(te){return te>1}).map(function(te){return[te,Kt(te)]});h.FileIndex.map(function(te,J){return[te,h.FullPaths[J]]}).forEach(function(te){var J=te[0];if(te[1],!!J.name.match(/\.iwa/)){var Z=Os(Ls(J.content));Z.forEach(function(oe){oe.messages.forEach(function(_e){d.forEach(function(ve){oe.messages.some(function(xe){return Sr(xe.meta[1][0].data)!=11006&&TB(xe.data,ve[1])})&&c[ve[0]].deps.push(oe.id)})})})}});for(var g=Ze.find(h,c[1].location),x=Os(Ls(g.content)),_,S=0;S<x.length;++S){var y=x[S];y.id==1&&(_=y)}var T=In(Lt(_.messages[0].data)[1][0].data);for(g=Ze.find(h,c[T].location),x=Os(Ls(g.content)),S=0;S<x.length;++S)y=x[S],y.id==T&&(_=y);for(T=In(Lt(_.messages[0].data)[2][0].data),g=Ze.find(h,c[T].location),x=Os(Ls(g.content)),S=0;S<x.length;++S)y=x[S],y.id==T&&(_=y);for(T=In(Lt(_.messages[0].data)[2][0].data),g=Ze.find(h,c[T].location),x=Os(Ls(g.content)),S=0;S<x.length;++S)y=x[S],y.id==T&&(_=y);var R=Lt(_.messages[0].data);{R[6][0].data=Kt(n.e.r+1),R[7][0].data=Kt(n.e.c+1);var O=In(R[46][0].data),N=Ze.find(h,c[O].location),U=Os(Ls(N.content));{for(var X=0;X<U.length&&U[X].id!=O;++X);if(U[X].id!=O)throw"Bad ColumnRowUIDMapArchive";var G=Lt(U[X].messages[0].data);G[1]=[],G[2]=[],G[3]=[];for(var k=0;k<=n.e.c;++k){var F=[];F[1]=F[2]=[{type:0,data:Kt(k+420690)}],G[1].push({type:2,data:un(F)}),G[2].push({type:0,data:Kt(k)}),G[3].push({type:0,data:Kt(k)})}G[4]=[],G[5]=[],G[6]=[];for(var I=0;I<=n.e.r;++I)F=[],F[1]=F[2]=[{type:0,data:Kt(I+726270)}],G[4].push({type:2,data:un(F)}),G[5].push({type:0,data:Kt(I)}),G[6].push({type:0,data:Kt(I)});U[X].messages[0].data=un(G)}N.content=sc(nc(U)),N.size=N.content.length,delete R[46];var B=Lt(R[4][0].data);{B[7][0].data=Kt(n.e.r+1);var L=Lt(B[1][0].data),M=In(L[2][0].data);N=Ze.find(h,c[M].location),U=Os(Ls(N.content));{if(U[0].id!=M)throw"Bad HeaderStorageBucket";var V=Lt(U[0].messages[0].data);for(I=0;I<i.length;++I){var Fe=Lt(V[2][0].data);Fe[1][0].data=Kt(I),Fe[4][0].data=Kt(i[I].length),V[2][I]={type:V[2][0].type,data:un(Fe)}}U[0].messages[0].data=un(V)}N.content=sc(nc(U)),N.size=N.content.length;var Ce=In(B[2][0].data);N=Ze.find(h,c[Ce].location),U=Os(Ls(N.content));{if(U[0].id!=Ce)throw"Bad HeaderStorageBucket";for(V=Lt(U[0].messages[0].data),k=0;k<=n.e.c;++k)Fe=Lt(V[2][0].data),Fe[1][0].data=Kt(k),Fe[4][0].data=Kt(n.e.r+1),V[2][k]={type:V[2][0].type,data:un(Fe)};U[0].messages[0].data=un(V)}N.content=sc(nc(U)),N.size=N.content.length;var Le=In(B[4][0].data);(function(){for(var te=Ze.find(h,c[Le].location),J=Os(Ls(te.content)),Z,oe=0;oe<J.length;++oe){var _e=J[oe];_e.id==Le&&(Z=_e)}var ve=Lt(Z.messages[0].data);{ve[3]=[];var xe=[];o.forEach(function(Y,Et){xe[1]=[{type:0,data:Kt(Et)}],xe[2]=[{type:0,data:Kt(1)}],xe[3]=[{type:2,data:EB(Y)}],ve[3].push({type:2,data:un(xe)})})}Z.messages[0].data=un(ve);var Ee=nc(J),st=sc(Ee);te.content=st,te.size=te.content.length})();var Ne=Lt(B[3][0].data);{var Se=Ne[1][0];delete Ne[2];var ne=Lt(Se.data);{var ye=In(ne[2][0].data);(function(){for(var te=Ze.find(h,c[ye].location),J=Os(Ls(te.content)),Z,oe=0;oe<J.length;++oe){var _e=J[oe];_e.id==ye&&(Z=_e)}var ve=Lt(Z.messages[0].data);{delete ve[6],delete Ne[7];var xe=new Uint8Array(ve[5][0].data);ve[5]=[];for(var Ee=0,st=0;st<=n.e.r;++st){var Y=Lt(xe);Ee+=LB(Y,i[st],o),Y[1][0].data=Kt(st),ve[5].push({data:un(Y),type:2})}ve[1]=[{type:0,data:Kt(n.e.c+1)}],ve[2]=[{type:0,data:Kt(n.e.r+1)}],ve[3]=[{type:0,data:Kt(Ee)}],ve[4]=[{type:0,data:Kt(n.e.r+1)}]}Z.messages[0].data=un(ve);var Et=nc(J),gt=sc(Et);te.content=gt,te.size=te.content.length})()}Se.data=un(ne)}B[3][0].data=un(Ne)}R[4][0].data=un(B)}_.messages[0].data=un(R);var ee=nc(x),b=sc(ee);return g.content=b,g.size=g.content.length,h}function oA(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function cx(t){oA([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function ux(t){oA([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function VB(t){return wt.WS.indexOf(t)>-1?"sheet":t==wt.CS?"chart":t==wt.DS?"dialog":t==wt.MS?"macro":t&&t.length?t:"sheet"}function BB(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,VB(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function UB(t,e,r,n,s,i,o,c,f,h,d,g){try{i[n]=Hu(ys(t,r,!0),e);var x=Vr(t,e),_;switch(c){case"sheet":_=lV(x,e,s,f,i[n],h,d,g);break;case"chart":if(_=cV(x,e,s,f,i[n],h,d,g),!_||!_["!drawel"])break;var S=bu(_["!drawel"].Target,e),y=df(S),T=X5(ys(t,S,!0),Hu(ys(t,y,!0),S)),R=bu(T,S),O=df(R);_=L7(ys(t,R,!0),R,f,Hu(ys(t,O,!0),R),h,_);break;case"macro":_=uV(x,e,s,f,i[n],h,d,g);break;case"dialog":_=fV(x,e,s,f,i[n],h,d,g);break;default:throw new Error("Unrecognized sheet type "+c)}o[n]=_;var N=[];i&&i[n]&&kr(i[n]).forEach(function(U){var X="";if(i[n][U].Type==wt.CMNT){X=bu(i[n][U].Target,e);var G=mV(Vr(t,X,!0),X,f);if(!G||!G.length)return;ow(_,G,!1)}i[n][U].Type==wt.TCMNT&&(X=bu(i[n][U].Target,e),N=N.concat(Q5(Vr(t,X,!0),f)))}),N&&N.length&&ow(_,N,!0,f.people||[])}catch(U){if(f.WTF)throw U}}function Ps(t){return t.charAt(0)=="/"?t.slice(1):t}function jB(t,e){if(jc(),e=e||{},cx(e),Ms(t,"META-INF/manifest.xml")||Ms(t,"objectdata.xml"))return vw(t,e);if(Ms(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Dm<"u"){if(t.FileIndex)return Dm(t);var r=Ze.utils.cfb_new();return I2(t).forEach(function(Fe){vt(r,Fe,JD(t,Fe))}),Dm(r)}throw new Error("Unsupported NUMBERS file")}if(!Ms(t,"[Content_Types].xml"))throw Ms(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ms(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=I2(t),s=$P(ys(t,"[Content_Types].xml")),i=!1,o,c;if(s.workbooks.length===0&&(c="xl/workbook.xml",Vr(t,c,!0)&&s.workbooks.push(c)),s.workbooks.length===0){if(c="xl/workbook.bin",!Vr(t,c,!0))throw new Error("Could not find workbook");s.workbooks.push(c),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},h={};if(!e.bookSheets&&!e.bookProps){if($u=[],s.sst)try{$u=pV(Vr(t,Ps(s.sst)),s.sst,e)}catch(Fe){if(e.WTF)throw Fe}e.cellStyles&&s.themes.length&&(f=dV(ys(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(h=hV(Vr(t,Ps(s.style)),s.style,f,e))}s.links.map(function(Fe){try{var Ce=Hu(ys(t,df(Ps(Fe))),Fe);return xV(Vr(t,Ps(Fe)),Ce,Fe,e)}catch{}});var d=oV(Vr(t,Ps(s.workbooks[0])),s.workbooks[0],e),g={},x="";s.coreprops.length&&(x=Vr(t,Ps(s.coreprops[0]),!0),x&&(g=XS(x)),s.extprops.length!==0&&(x=Vr(t,Ps(s.extprops[0]),!0),x&&JP(x,g,e)));var _={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(x=ys(t,Ps(s.custprops[0]),!0),x&&(_=eb(x,e)));var S={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(Ce){return Ce.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),e.bookProps&&(S.Props=g,S.Custprops=_),e.bookSheets&&typeof o<"u"&&(S.SheetNames=o),e.bookSheets?S.SheetNames:e.bookProps))return S;o={};var y={};e.bookDeps&&s.calcchain&&(y=gV(Vr(t,Ps(s.calcchain)),s.calcchain));var T=0,R={},O,N;{var U=d.Sheets;g.Worksheets=U.length,g.SheetNames=[];for(var X=0;X!=U.length;++X)g.SheetNames[X]=U[X].name}var G=i?"bin":"xml",k=s.workbooks[0].lastIndexOf("/"),F=(s.workbooks[0].slice(0,k+1)+"_rels/"+s.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Ms(t,F)||(F="xl/_rels/workbook."+G+".rels");var I=Hu(ys(t,F,!0),F.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=vV(Vr(t,Ps(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=Z5(Vr(t,Ps(s.people[0])),e)),I&&(I=BB(I,d.Sheets));var B=Vr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=g.Worksheets;++T){var L="sheet";if(I&&I[T]?(O="xl/"+I[T][1].replace(/[\/]?xl\//,""),Ms(t,O)||(O=I[T][1]),Ms(t,O)||(O=F.replace(/_rels\/.*$/,"")+I[T][1]),L=I[T][2]):(O="xl/worksheets/sheet"+(T+1-B)+"."+G,O=O.replace(/sheet0\./,"sheet.")),N=O.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(T!=e.sheets)continue e;break;case"string":if(g.SheetNames[T].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var M=!1,V=0;V!=e.sheets.length;++V)typeof e.sheets[V]=="number"&&e.sheets[V]==T&&(M=1),typeof e.sheets[V]=="string"&&e.sheets[V].toLowerCase()==g.SheetNames[T].toLowerCase()&&(M=1);if(!M)continue e}}UB(t,O,N,g.SheetNames[T],T,R,o,L,e,d,f,h)}return S={Directory:s,Workbook:d,Props:g,Custprops:_,Deps:y,Sheets:o,SheetNames:g.SheetNames,Strings:$u,Styles:h,Themes:f,SSF:ur(nt)},e&&e.bookFiles&&(t.files?(S.keys=n,S.files=t.files):(S.keys=[],S.files={},t.FullPaths.forEach(function(Fe,Ce){Fe=Fe.replace(/^Root Entry[\/]/,""),S.keys.push(Fe),S.files[Fe]=t.FileIndex[Ce]}))),e&&e.bookVBA&&(s.vba.length>0?S.vbaraw=Vr(t,Ps(s.vba[0]),!0):s.defaults&&s.defaults.bin===oL&&(S.vbaraw=Vr(t,"xl/vbaProject.bin",!0))),S}function zB(t,e){var r=e||{},n="Workbook",s=Ze.find(t,n);try{if(n="/!DataSpaces/Version",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(vO(s.content),n="/!DataSpaces/DataSpaceMap",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=yO(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=wO(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);TO(s.content)}catch{}if(n="/EncryptionInfo",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=SO(s.content);if(n="/EncryptedPackage",s=Ze.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],s.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function WB(t,e){return e.bookType=="ods"?aA(t,e):e.bookType=="numbers"?MB(t,e):e.bookType=="xlsb"?HB(t,e):$B(t,e)}function HB(t,e){fc=1024,t&&!t.SSF&&(t.SSF=ur(nt)),t&&t.SSF&&(jc(),Td(t.SSF),e.revssf=kd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Gu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=bk.indexOf(e.bookType)>-1,s=Xg();ux(e=e||{});var i=Og(),o="",c=0;if(e.cellXfs=[],To(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",vt(i,o,YS(t.Props,e)),s.coreprops.push(o),Xt(e.rels,2,o,wt.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,vt(i,o,ZS(t.Props)),s.extprops.push(o),Xt(e.rels,3,o,wt.EXT_PROPS),t.Custprops!==t.Props&&kr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",vt(i,o,ek(t.Custprops)),s.custprops.push(o),Xt(e.rels,4,o,wt.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var d={"!id":{}},g=t.Sheets[t.SheetNames[c-1]],x=(g||{})["!type"]||"sheet";switch(x){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,vt(i,o,yV(c-1,o,e,t,d)),s.sheets.push(o),Xt(e.wbrels,-1,"worksheets/sheet"+c+"."+r,wt.WS[0])}if(g){var _=g["!comments"],S=!1,y="";_&&_.length>0&&(y="xl/comments"+c+"."+r,vt(i,y,TV(_,y)),s.comments.push(y),Xt(d,-1,"../comments"+c+"."+r,wt.CMNT),S=!0),g["!legacy"]&&S&&vt(i,"xl/drawings/vmlDrawing"+c+".vml",Dk(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}d["!id"].rId1&&vt(i,df(o),xc(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,vt(i,o,EV(e.Strings,o,e)),s.strs.push(o),Xt(e.wbrels,-1,"sharedStrings."+r,wt.SST)),o="xl/workbook."+r,vt(i,o,_V(t,o)),s.workbooks.push(o),Xt(e.rels,1,o,wt.WB),o="xl/theme/theme1.xml",vt(i,o,tx(t.Themes,e)),s.themes.push(o),Xt(e.wbrels,-1,"theme/theme1.xml",wt.THEME),o="xl/styles."+r,vt(i,o,wV(t,o,e)),s.styles.push(o),Xt(e.wbrels,-1,"styles."+r,wt.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",vt(i,o,t.vbaraw),s.vba.push(o),Xt(e.wbrels,-1,"vbaProject.bin",wt.VBA)),o="xl/metadata."+r,vt(i,o,SV(o)),s.metadata.push(o),Xt(e.wbrels,-1,"metadata."+r,wt.XLMETA),vt(i,"[Content_Types].xml",qS(s,e)),vt(i,"_rels/.rels",xc(e.rels)),vt(i,"xl/_rels/workbook."+r+".rels",xc(e.wbrels)),delete e.revssf,delete e.ssf,i}function $B(t,e){fc=1024,t&&!t.SSF&&(t.SSF=ur(nt)),t&&t.SSF&&(jc(),Td(t.SSF),e.revssf=kd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Gu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=bk.indexOf(e.bookType)>-1,s=Xg();ux(e=e||{});var i=Og(),o="",c=0;if(e.cellXfs=[],To(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",vt(i,o,YS(t.Props,e)),s.coreprops.push(o),Xt(e.rels,2,o,wt.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,vt(i,o,ZS(t.Props)),s.extprops.push(o),Xt(e.rels,3,o,wt.EXT_PROPS),t.Custprops!==t.Props&&kr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",vt(i,o,ek(t.Custprops)),s.custprops.push(o),Xt(e.rels,4,o,wt.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,c=1;c<=t.SheetNames.length;++c){var g={"!id":{}},x=t.Sheets[t.SheetNames[c-1]],_=(x||{})["!type"]||"sheet";switch(_){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,vt(i,o,$k(c-1,e,t,g)),s.sheets.push(o),Xt(e.wbrels,-1,"worksheets/sheet"+c+"."+r,wt.WS[0])}if(x){var S=x["!comments"],y=!1,T="";if(S&&S.length>0){var R=!1;S.forEach(function(O){O[1].forEach(function(N){N.T==!0&&(R=!0)})}),R&&(T="xl/threadedComments/threadedComment"+c+"."+r,vt(i,T,J5(S,d,e)),s.threadedcomments.push(T),Xt(g,-1,"../threadedComments/threadedComment"+c+"."+r,wt.TCMNT)),T="xl/comments"+c+"."+r,vt(i,T,Pk(S)),s.comments.push(T),Xt(g,-1,"../comments"+c+"."+r,wt.CMNT),y=!0}x["!legacy"]&&y&&vt(i,"xl/drawings/vmlDrawing"+c+".vml",Dk(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&vt(i,df(o),xc(g))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,vt(i,o,yk(e.Strings,e)),s.strs.push(o),Xt(e.wbrels,-1,"sharedStrings."+r,wt.SST)),o="xl/workbook."+r,vt(i,o,Yk(t)),s.workbooks.push(o),Xt(e.rels,1,o,wt.WB),o="xl/theme/theme1.xml",vt(i,o,tx(t.Themes,e)),s.themes.push(o),Xt(e.wbrels,-1,"theme/theme1.xml",wt.THEME),o="xl/styles."+r,vt(i,o,Ik(t,e)),s.styles.push(o),Xt(e.wbrels,-1,"styles."+r,wt.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",vt(i,o,t.vbaraw),s.vba.push(o),Xt(e.wbrels,-1,"vbaProject.bin",wt.VBA)),o="xl/metadata."+r,vt(i,o,Nk()),s.metadata.push(o),Xt(e.wbrels,-1,"metadata."+r,wt.XLMETA),d.length>1&&(o="xl/persons/person.xml",vt(i,o,eL(d)),s.people.push(o),Xt(e.wbrels,-1,"persons/person.xml",wt.PEOPLE)),vt(i,"[Content_Types].xml",qS(s,e)),vt(i,"_rels/.rels",xc(e.rels)),vt(i,"xl/_rels/workbook."+r+".rels",xc(e.wbrels)),delete e.revssf,delete e.ssf,i}function fx(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Es(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function GB(t,e){return Ze.find(t,"EncryptedPackage")?zB(t,e):eA(t,e)}function qB(t,e){var r,n=t,s=e||{};return s.type||(s.type=_t&&Buffer.isBuffer(t)?"buffer":"base64"),r=ES(n,s),jB(r,s)}function lA(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return y1(t.slice(r),e);default:break e}return Fc.to_workbook(t,e)}function KB(t,e){var r="",n=fx(t,e);switch(e.type){case"base64":r=Es(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=fl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Qt(r)),e.type="binary",lA(r,e)}function XB(t,e){var r=t;return e.type=="base64"&&(r=Es(r)),r=of.utils.decode(1200,r.slice(2),"str"),e.type="binary",lA(r,e)}function YB(t){return t.match(/[^\x00-\x7F]/)?Pi(t):t}function Pm(t,e,r,n){return n?(r.type="string",Fc.to_workbook(t,r)):Fc.to_workbook(e,r)}function T1(t,e){Rg();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return T1(new Uint8Array(t),(r=ur(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),_c={},r.dateNF&&(_c.dateNF=r.dateNF),r.type||(r.type=_t&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=_t?"buffer":"binary",n=HD(t),typeof Uint8Array<"u"&&!_t&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=YB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=ur(r),r.type="array",T1(Ng(n),r)}switch((s=fx(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return GB(Ze.read(n,r),r);break;case 9:if(s[1]<=8)return eA(n,r);break;case 60:return y1(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return tO(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return vk.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?qB(n,r):Pm(t,n,r,i);case 239:return s[3]===60?y1(n,r):Pm(t,n,r,i);case 255:if(s[1]===254)return XB(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return rl.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return rl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return _1.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return kk.to_workbook(n,r);break;case 10:case 13:case 32:return KB(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return eO.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?_1.to_workbook(n,r):Pm(t,n,r,i)}function cA(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Mf(e.file,Ze.write(t,{type:_t?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Ze.write(t,e)}function QB(t,e){var r=ur(e||{}),n=WB(t,r);return JB(n,r)}function JB(t,e){var r={},n=_t?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?Ze.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(Ed(s))}return e.password&&typeof encrypt_agile<"u"?cA(encrypt_agile(s,e.password),e):e.type==="file"?Mf(e.file,s):e.type=="string"?Qt(s):s}function ZB(t,e){var r=e||{},n=YV(t,r);return cA(n,r)}function Ri(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return lf(Pi(n));case"binary":return Pi(n);case"string":return t;case"file":return Mf(e.file,n,"utf8");case"buffer":return _t?ya(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ri(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function eU(t,e){switch(e.type){case"base64":return lf(t);case"binary":return t;case"string":return t;case"file":return Mf(e.file,t,"binary");case"buffer":return _t?ya(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function f0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?lf(r):e.type=="string"?Qt(r):r;case"file":return Mf(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function hx(t,e){Rg(),G7(t);var r=ur(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=hx(t,r);return r.type="array",Ed(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ri(WV(t,r),r);case"slk":case"sylk":return Ri(xk.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return Ri(rA(t.Sheets[t.SheetNames[s]],r),r);case"txt":return eU(uA(t.Sheets[t.SheetNames[s]],r),r);case"csv":return Ri(dx(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return Ri(vk.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return f0(_1.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return Ri(Fc.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return Ri(kk.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return Ri(_k.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return Ri(aA(t,r),r);case"wk1":return f0(rl.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return f0(rl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),f0(tA(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ZB(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return QB(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function tU(t,e,r,n,s,i,o,c){var f=Nr(r),h=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!o||t[r])for(var _=e.s.c;_<=e.e.c;++_){var S=o?t[r][_]:t[n[_]+f];if(S===void 0||S.t===void 0){if(h===void 0)continue;i[_]!=null&&(x[i[_]]=h);continue}var y=S.v;switch(S.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(i[_]!=null){if(y==null)if(S.t=="e"&&y===null)x[i[_]]=null;else if(h!==void 0)x[i[_]]=h;else if(d&&y===null)x[i[_]]=null;else continue;else x[i[_]]=d&&(S.t!=="n"||S.t==="n"&&c.rawNumbers!==!1)?y:xa(S,y,c);y!=null&&(g=!1)}}return{row:x,isempty:g}}function ed(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],o=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},d=h.range!=null?h.range:t["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof d){case"string":f=bt(d);break;case"number":f=bt(t["!ref"]),f.s.r=d;break;default:f=d}n>0&&(s=0);var g=Nr(f.s.r),x=[],_=[],S=0,y=0,T=Array.isArray(t),R=f.s.r,O=0,N={};T&&!t[R]&&(t[R]=[]);var U=h.skipHidden&&t["!cols"]||[],X=h.skipHidden&&t["!rows"]||[];for(O=f.s.c;O<=f.e.c;++O)if(!(U[O]||{}).hidden)switch(x[O]=vr(O),r=T?t[R][O]:t[x[O]+g],n){case 1:i[O]=O-f.s.c;break;case 2:i[O]=x[O];break;case 3:i[O]=h.header[O-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=xa(r,null,h),y=N[o]||0,!y)N[o]=1;else{do c=o+"_"+y++;while(N[c]);N[o]=y,N[c]=1}i[O]=c}for(R=f.s.r+s;R<=f.e.r;++R)if(!(X[R]||{}).hidden){var G=tU(t,f,R,x,n,i,T,h);(G.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(_[S++]=G.row)}return _.length=S,_}var Tw=/"/g;function rU(t,e,r,n,s,i,o,c){for(var f=!0,h=[],d="",g=Nr(r),x=e.s.c;x<=e.e.c;++x)if(n[x]){var _=c.dense?(t[r]||[])[x]:t[n[x]+g];if(_==null)d="";else if(_.v!=null){f=!1,d=""+(c.rawNumbers&&_.t=="n"?_.v:xa(_,null,c));for(var S=0,y=0;S!==d.length;++S)if((y=d.charCodeAt(S))===s||y===i||y===34||c.forceQuotes){d='"'+d.replace(Tw,'""')+'"';break}d=="ID"&&(d='"ID"')}else _.f!=null&&!_.F?(f=!1,d="="+_.f,d.indexOf(",")>=0&&(d='"'+d.replace(Tw,'""')+'"')):d="";h.push(d)}return c.blankrows===!1&&f?null:h.join(o)}function dx(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=bt(t["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,f=c.charCodeAt(0),h=new RegExp((i=="|"?"\\|":i)+"+$"),d="",g=[];n.dense=Array.isArray(t);for(var x=n.skipHidden&&t["!cols"]||[],_=n.skipHidden&&t["!rows"]||[],S=s.s.c;S<=s.e.c;++S)(x[S]||{}).hidden||(g[S]=vr(S));for(var y=0,T=s.s.r;T<=s.e.r;++T)(_[T]||{}).hidden||(d=rU(t,s,T,g,o,f,i,n),d!=null&&(n.strip&&(d=d.replace(h,"")),(d||n.blankrows!==!1)&&r.push((y++?c:"")+d)));return delete n.dense,r.join("")}function uA(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=dx(t,e);return r}function nU(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=bt(t["!ref"]),i="",o=[],c,f=[],h=Array.isArray(t);for(c=s.s.c;c<=s.e.c;++c)o[c]=vr(c);for(var d=s.s.r;d<=s.e.r;++d)for(i=Nr(d),c=s.s.c;c<=s.e.c;++c)if(e=o[c]+i,r=h?(t[d]||[])[c]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=e+"="+n}return f}function fA(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},o=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?_r(n.origin):n.origin;o=f.r,c=f.c}var h,d={s:{c:0,r:0},e:{c,r:o+e.length-1+s}};if(i["!ref"]){var g=bt(i["!ref"]);d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),o==-1&&(o=g.e.r+1,d.e.r=o+e.length-1+s)}else o==-1&&(o=0,d.e.r=e.length-1+s);var x=n.header||[],_=0;e.forEach(function(y,T){kr(y).forEach(function(R){(_=x.indexOf(R))==-1&&(x[_=x.length]=R);var O=y[R],N="z",U="",X=it({c:c+_,r:o+T+s});h=yf(i,X),O&&typeof O=="object"&&!(O instanceof Date)?i[X]=O:(typeof O=="number"?N="n":typeof O=="boolean"?N="b":typeof O=="string"?N="s":O instanceof Date?(N="d",n.cellDates||(N="n",O=Xr(O)),U=n.dateNF||nt[14]):O===null&&n.nullError&&(N="e",O=0),h?(h.t=N,h.v=O,delete h.w,delete h.R,U&&(h.z=U)):i[X]=h={t:N,v:O},U&&(h.z=U))})}),d.e.c=Math.max(d.e.c,c+x.length-1);var S=Nr(o);if(s)for(_=0;_<x.length;++_)i[vr(_+c)+S]={t:"s",v:x[_]};return i["!ref"]=xt(d),i}function sU(t,e){return fA(null,t,e)}function yf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=_r(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?yf(t,it(e)):yf(t,it({r:e,c:r||0}))}function iU(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function px(){return{SheetNames:[],Sheets:{}}}function mx(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=o+s)!=-1;++s);}if(Xk(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function aU(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=iU(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function oU(t,e){return t.z=e,t}function hA(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function lU(t,e,r){return hA(t,"#"+e,r)}function cU(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function uU(t,e,r,n){for(var s=typeof e!="string"?e:bt(e),i=typeof e=="string"?e:xt(e),o=s.s.r;o<=s.e.r;++o)for(var c=s.s.c;c<=s.e.c;++c){var f=yf(t,o,c);f.t="n",f.F=i,delete f.v,o==s.s.r&&c==s.s.c&&(f.f=r,n&&(f.D=!0))}return t}var sl={encode_col:vr,encode_row:Nr,encode_cell:it,encode_range:xt,decode_col:Wg,decode_row:zg,split_cell:EP,decode_cell:_r,decode_range:is,format_cell:xa,sheet_add_aoa:US,sheet_add_json:fA,sheet_add_dom:nA,aoa_to_sheet:zc,json_to_sheet:sU,table_to_sheet:sA,table_to_book:vB,sheet_to_csv:dx,sheet_to_txt:uA,sheet_to_json:ed,sheet_to_html:rA,sheet_to_formulae:nU,sheet_to_row_object_array:ed,sheet_get_cell:yf,book_new:px,book_append_sheet:mx,book_set_sheet_visibility:aU,cell_set_number_format:oU,cell_set_hyperlink:hA,cell_set_internal_link:lU,cell_add_comment:cU,sheet_set_array_formula:uU,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},E0={exports:{}},fU=E0.exports,Sw;function hU(){return Sw||(Sw=1,(function(t,e){(function(r,n){n()})(fU,function(){function r(h,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function n(h,d,g){var x=new XMLHttpRequest;x.open("GET",h),x.responseType="blob",x.onload=function(){f(x.response,d,g)},x.onerror=function(){console.error("could not download file")},x.send()}function s(h){var d=new XMLHttpRequest;d.open("HEAD",h,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function i(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(d)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Gh=="object"&&Gh.global===Gh?Gh:void 0,c=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),f=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(h,d,g){var x=o.URL||o.webkitURL,_=document.createElement("a");d=d||h.name||"download",_.download=d,_.rel="noopener",typeof h=="string"?(_.href=h,_.origin===location.origin?i(_):s(_.href)?n(h,d,g):i(_,_.target="_blank")):(_.href=x.createObjectURL(h),setTimeout(function(){x.revokeObjectURL(_.href)},4e4),setTimeout(function(){i(_)},0))}:"msSaveOrOpenBlob"in navigator?function(h,d,g){if(d=d||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(r(h,g),d);else if(s(h))n(h,d,g);else{var x=document.createElement("a");x.href=h,x.target="_blank",setTimeout(function(){i(x)})}}:function(h,d,g,x){if(x=x||open("","_blank"),x&&(x.document.title=x.document.body.innerText="downloading..."),typeof h=="string")return n(h,d,g);var _=h.type==="application/octet-stream",S=/constructor/i.test(o.HTMLElement)||o.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||_&&S||c)&&typeof FileReader<"u"){var T=new FileReader;T.onloadend=function(){var N=T.result;N=y?N:N.replace(/^data:[^;]*;/,"data:attachment/file;"),x?x.location.href=N:location=N,x=null},T.readAsDataURL(h)}else{var R=o.URL||o.webkitURL,O=R.createObjectURL(h);x?x.location=O:location.href=O,x=null,setTimeout(function(){R.revokeObjectURL(O)},4e4)}});o.saveAs=f.saveAs=f,t.exports=f})})(E0)),E0.exports}var dA=hU();const dU=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=s=>{try{const i=new Uint8Array(s.target.result),o=T1(i,{type:"array"}),c=o.SheetNames[0],f=o.Sheets[c],h=sl.sheet_to_json(f,{header:1});if(h.length<2){r(new Error(""));return}const d=h[0],g=h.slice(1).filter(x=>x.some(_=>_));e({headers:d,rows:g,sheetName:c})}catch{r(new Error(" Excel "))}},n.onerror=()=>{r(new Error(""))},n.readAsArrayBuffer(t)}),UU=t=>{const e={number:-1,name:-1,traits:-1,comment:-1},r={number:["","","","no","number",""],name:["","","","name",""],traits:["","","","","traits",""],comment:["","","","comment",""]};return t.forEach((n,s)=>{if(!n)return;const i=String(n).toLowerCase().trim();for(const[o,c]of Object.entries(r))c.some(f=>i.includes(f))&&(e[o]=s)}),e},pU=(t,e={})=>{const{includeNumber:r=!0,includeName:n=!0,includeTraits:s=!0,includeComment:i=!0,includeManualTraits:o=!1}=e,c=[],f=[];r&&f.push(""),n&&f.push(""),s&&f.push(""),o&&f.push(""),i&&f.push(""),c.push(f),t.forEach((g,x)=>{const _=[];r&&_.push(g.number||x+1),n&&_.push(g.name||""),s&&_.push((g.selectedTags||[]).join("")),o&&_.push(g.manualTraits||""),i&&_.push(g.comment||""),c.push(_)});const h=sl.aoa_to_sheet(c);h["!cols"]=[{wch:6},{wch:10},{wch:30},{wch:20},{wch:60}];const d=sl.book_new();return sl.book_append_sheet(d,h,""),hx(d,{bookType:"xlsx",type:"array"})},jU=(t,e="",r={})=>{const n=pU(t,r),s=new Blob([n],{type:"application/octet-stream"});dA.saveAs(s,`${e}.xlsx`)},zU=()=>{const t=[["","","",""],[1,"","",""],[2,"","",""],[3,"","",""]],e=sl.aoa_to_sheet(t);e["!cols"]=[{wch:6},{wch:10},{wch:30},{wch:20}];const r=sl.book_new();sl.book_append_sheet(r,e,"");const n=hx(r,{bookType:"xlsx",type:"array"}),s=new Blob([n],{type:"application/octet-stream"});dA.saveAs(s,".xlsx")},mU=({rawInput:t,setRawInput:e,numberCount:r,setNumberCount:n,onGenerateStudents:s,onGenerateNumbers:i,onResetList:o,onImportFromExcel:c,isGenerating:f})=>{const{toast:h}=bw(),d=Oe.useRef(null),[g,x]=Oe.useState(!1),_=async R=>{if(R){if(!R.name.match(/\.(xlsx|xls|csv)$/i)){h.error(" Excel  CSV ");return}try{const{headers:O,rows:N}=await dU(R);let U=0,X=1;O.forEach((k,F)=>{const I=String(k||"").toLowerCase();(I.includes("")||I.includes("name"))&&(U=F),(I.includes("")||I.includes("")||I.includes(""))&&(X=F)});const G=N.map(k=>{const F=String(k[U]||"").trim(),I=k[X]?String(k[X]).trim():"";return{name:F,number:I}}).filter(k=>k.name);if(G.length===0){h.error("");return}if(c)c(G),h.success(`  ${G.length} `);else{const k=G.map(F=>F.name).join(`
`);e(k),h.success(` ${G.length} `)}}catch(O){console.error("Excel :",O),h.error("Excel ")}}},S=Oe.useCallback(R=>{R.preventDefault(),x(!0)},[]),y=Oe.useCallback(R=>{R.preventDefault(),x(!1)},[]),T=Oe.useCallback(R=>{R.preventDefault(),x(!1);const O=R.dataTransfer.files[0];O&&_(O)},[]);return C.jsxs("div",{className:"flex-1 w-full flex flex-col gap-3 p-3 sm:p-4 bg-[#FF9F43] border-3 border-[#2D3436] rounded-lg shadow-[4px_4px_0_#2D3436] transform rotate-[-0.5deg]",children:[C.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 text-white font-black text-base sm:text-xl mb-1",children:[C.jsx("span",{className:"text-2xl",children:""}),"1. ",C.jsxs("button",{onClick:()=>{var R;return(R=d.current)==null?void 0:R.click()},className:"ml-auto btn-pop bg-white text-[#54A0FF] px-2 py-1 text-xs font-bold flex items-center gap-1",title:" Excel ",children:[C.jsx(Om,{size:14}),C.jsx("span",{className:"hidden sm:inline",children:"Excel "})]}),C.jsx("input",{ref:d,type:"file",accept:".xlsx,.xls,.csv",onChange:R=>_(R.target.files[0]),className:"hidden"})]}),C.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1",children:[C.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[C.jsxs("div",{onDragOver:S,onDragLeave:y,onDrop:T,className:`flex-1 relative ${g?"ring-4 ring-[#54A0FF] ring-offset-2":""}`,children:[C.jsx("textarea",{className:"w-full h-full min-h-[100px] sm:min-h-[120px] p-3 sm:p-4 border-3 border-[#2D3436] rounded-lg outline-none text-sm sm:text-base resize-none font-medium placeholder:text-[#9CA3AF] placeholder:leading-relaxed text-[#2D3436] leading-relaxed bg-white shadow-[inset_2px_2px_4px_rgba(0,0,0,0.1)]",placeholder:` 









Excel 
 Excel `,value:t,onChange:R=>e(R.target.value),disabled:f}),g&&C.jsxs("div",{className:"absolute inset-0 bg-[#54A0FF]/90 border-3 border-dashed border-white rounded-lg flex flex-col items-center justify-center text-white",children:[C.jsx(J4,{size:32,className:"mb-2"}),C.jsx("span",{className:"font-bold",children:" Excel"})]})]}),C.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 bg-white p-2 sm:p-3 border-2 border-[#2D3436] rounded-lg",children:[C.jsxs("span",{className:"text-[#2D3436] font-bold text-xs sm:text-sm flex items-center gap-1",children:[C.jsx(H4,{size:14})," "]}),C.jsx("input",{type:"number",min:"1",max:"100",value:r,onChange:R=>n(Number(R.target.value)),className:"w-14 sm:w-16 text-center border-2 border-[#2D3436] text-[#2D3436] font-bold text-xs sm:text-sm py-1.5 outline-none rounded"}),C.jsx("span",{className:"text-[#2D3436] text-xs sm:text-sm font-bold",children:""}),C.jsx("button",{onClick:i,className:"btn-pop ml-auto bg-[#FECA57] text-[#2D3436] px-3 py-1 text-xs sm:text-sm",children:" "})]})]}),C.jsxs("div",{className:"flex flex-row sm:flex-col gap-2 sm:gap-3 sm:w-24",children:[C.jsxs("button",{onClick:s,disabled:f,className:"flex-1 btn-pop bg-[#1DD1A1] text-white font-bold px-3 sm:px-2 py-3 sm:py-4 text-sm sm:text-base flex flex-row sm:flex-col items-center justify-center gap-2 disabled:opacity-50",children:[C.jsx(Rw,{size:20}),C.jsx("span",{children:""})]}),C.jsxs("button",{onClick:o,disabled:f,className:"flex-1 btn-pop bg-white text-[#FF6B6B] font-bold px-3 sm:px-2 py-3 sm:py-4 text-sm sm:text-base flex flex-row sm:flex-col items-center justify-center gap-2 disabled:opacity-50",children:[C.jsx(Nw,{size:18}),C.jsx("span",{children:""})]})]})]})]})},gU=({students:t,selectedIds:e,isGenerating:r,extraSettings:n,setExtraSettings:s,onGenerateSelected:i,onGenerateAll:o,onDownload:c,onDeleteSelected:f,onResetList:h})=>C.jsxs("div",{className:"flex-1 w-full flex flex-col gap-3 sm:gap-4 p-3 sm:p-4 bg-[#54A0FF] border-3 border-[#2D3436] rounded-lg shadow-[4px_4px_0_#2D3436] transform rotate-[0.5deg]",children:[C.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 text-white font-black text-base sm:text-xl",children:[C.jsx("span",{className:"text-2xl",children:""}),"2. AI "]}),C.jsxs("div",{className:"bg-white/90 border-2 border-[#2D3436] rounded-lg p-2 sm:p-3 flex flex-col gap-2 sm:gap-3",children:[C.jsx("div",{className:"flex items-center justify-between text-xs sm:text-sm font-bold text-[#2D3436] border-b-2 border-dashed border-[#E8DCC8] pb-2",children:C.jsx("span",{className:"flex items-center gap-1",children:" "})}),C.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[C.jsx("div",{className:"flex bg-[#FFF9E6] border-2 border-[#2D3436] rounded-lg overflow-hidden",children:[{val:"normal",label:"",emoji:""},{val:"casual",label:"",emoji:""},{val:"formal",label:"",emoji:""}].map(d=>C.jsxs("button",{onClick:()=>s(g=>({...g,tone:d.val})),className:`px-2 sm:px-3 py-1.5 text-xs sm:text-sm font-bold transition-colors 
                  ${n.tone===d.val?"bg-[#FF6B9D] text-white":"text-[#2D3436] hover:bg-[#FECA57]"}`,children:[C.jsx("span",{className:"hidden sm:inline",children:d.emoji})," ",d.label]},d.val))}),C.jsxs("div",{className:"flex items-center gap-2 bg-[#FFF9E6] border-2 border-[#2D3436] rounded-lg px-2 sm:px-3 py-1.5 ml-auto",children:[C.jsx("span",{className:"text-xs sm:text-sm font-bold text-[#2D3436]",children:" "}),C.jsx("input",{type:"number",min:"20",max:"500",step:"10",value:n.wordCount,onChange:d=>s(g=>({...g,wordCount:Number(d.target.value)})),className:"w-12 text-xs sm:text-sm font-bold text-[#2D3436] text-center outline-none bg-white border-2 border-[#2D3436] rounded"})]})]})]}),C.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[C.jsxs("button",{onClick:i,disabled:e.size===0||r,className:`flex-1 btn-pop py-3 sm:py-4 text-sm sm:text-base font-black flex items-center justify-center gap-2 
            ${e.size>0&&!r?"bg-white text-[#2D3436]":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-60"}`,children:[C.jsx(Q4,{size:18}),r?"...":` (${e.size})`]}),C.jsxs("button",{onClick:o,disabled:t.length===0||r,className:`flex-1 btn-pop py-3 sm:py-4 text-sm sm:text-base font-black flex items-center justify-center gap-2
            ${t.length>0&&!r?"bg-[#FECA57] text-[#2D3436]":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-60"}`,children:[C.jsx("span",{className:"text-xl",children:""}),r?"AI ...":""]})]}),C.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs sm:text-sm pt-2 border-t-2 border-dashed border-white/50",children:[C.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[C.jsxs("button",{onClick:()=>c("txt"),disabled:t.length===0,className:"btn-pop bg-white text-[#2D3436] px-2 sm:px-3 py-1 flex items-center gap-1 disabled:opacity-50",children:[C.jsx(bm,{size:14})," TXT"]}),C.jsxs("button",{onClick:()=>c("csv"),disabled:t.length===0,className:"btn-pop bg-white text-[#2D3436] px-2 sm:px-3 py-1 flex items-center gap-1 disabled:opacity-50",children:[C.jsx(bm,{size:14})," CSV"]})]}),C.jsxs("div",{className:"flex gap-2",children:[e.size>0&&C.jsxs("button",{onClick:f,disabled:r,className:"btn-pop bg-[#FF6B6B] text-white px-2 sm:px-3 py-1 flex items-center gap-1 text-xs sm:text-sm disabled:opacity-50",children:[C.jsx(I1,{size:12}),"  (",e.size,")"]}),C.jsx("button",{onClick:h,disabled:r||t.length===0,className:"text-white/80 hover:text-white font-bold transition-colors disabled:opacity-50",children:" "})]})]})]}),xU=({globalStyles:t,onOpenStyleModal:e,isGenerating:r})=>{const n={qualitative:"#FF6B9D",emotional:"#FF9F43",friendly:"#FECA57",humorous:"#1DD1A1",internal:"#54A0FF",philosophical:"#A29BFE",practical:"#FF6B6B",resonance:"#FF6B9D",blessing:"#FF9F43",scenario:"#FECA57",milestone:"#1DD1A1",journey:"#54A0FF"};return C.jsxs("div",{className:"mb-4 sm:mb-6 bg-[#FFFDF5] border-3 border-[#2D3436] rounded-lg p-3 sm:p-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 shadow-[4px_4px_0_#2D3436]",children:[C.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-[#2D3436] text-sm sm:text-base font-black",children:[C.jsx("span",{className:"text-xl",children:""}),C.jsx("span",{children:""}),C.jsx("div",{className:"flex gap-2 flex-wrap",children:t.length>0?t.map(s=>{var i;return C.jsx("span",{className:"px-3 py-1 border-2 border-[#2D3436] rounded-full text-xs sm:text-sm font-bold text-white shadow-[2px_2px_0_#2D3436]",style:{backgroundColor:n[s]||"#A29BFE"},children:(i=Aw.find(o=>o.id===s))==null?void 0:i.name},s)}):C.jsx("span",{className:"text-[#636E72] font-medium text-xs sm:text-sm bg-[#E8DCC8] px-3 py-1 rounded-full",children:" (: )"})})]}),C.jsxs("button",{onClick:e,disabled:r,className:"btn-pop w-full sm:w-auto bg-[#A29BFE] text-white px-4 sm:px-6 py-2 text-xs sm:text-sm font-bold flex items-center justify-center gap-2 disabled:opacity-50",children:[C.jsx(q4,{size:14})," "]})]})},vU=({student:t,isSelected:e,isFocused:r,isGenerating:n,isGeneratingSingle:s,onToggleSelection:i,onFocus:o,onOpenSidebar:c,onRemoveTag:f,onUpdateStudent:h,onDeleteStudent:d,onGenerateSingle:g,onSaveTemplate:x,onOpenHistory:_})=>{const S=["-1deg","0.5deg","-0.5deg","1deg","0deg"],y=S[t.id%S.length],T=s===t.id,R=O=>O<50?"text-[#FF6B6B]":O>120?"text-[#FF9F43]":"text-[#1DD1A1]";return C.jsxs("div",{className:`bg-[#FFFDF5] border-3 border-[#2D3436] rounded-lg overflow-hidden shadow-[4px_4px_0_#2D3436] transition-all
        ${e?"ring-4 ring-[#FF6B9D]":""}
        ${r?"ring-4 ring-[#54A0FF]":""}
        ${T?"ring-4 ring-[#FECA57] animate-pulse":""}`,style:{transform:`rotate(${y})`},children:[C.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#FECA57] border-b-2 border-[#2D3436]",children:[C.jsxs("div",{className:"flex items-center gap-3",children:[C.jsx("button",{onClick:()=>i(t.id),disabled:n||T,className:`w-6 h-6 border-2 border-[#2D3436] rounded flex items-center justify-center
              ${e?"bg-[#FF6B9D] text-white":"bg-white"}`,children:e&&C.jsx("span",{className:"text-sm font-bold",children:""})}),C.jsxs("span",{className:"font-black text-[#2D3436] text-base",children:[" ",t.name]})]}),C.jsxs("div",{className:"flex items-center gap-1",children:[C.jsxs("button",{onClick:()=>g(t.id),disabled:n||T,className:"btn-pop px-2 py-1 bg-[#1DD1A1] text-white text-xs font-bold flex items-center gap-1 disabled:opacity-50",children:[T?C.jsx(C1,{size:14,className:"animate-spin"}):C.jsx(C.Fragment,{children:""}),C.jsx("span",{className:"hidden sm:inline",children:T?"":""})]}),C.jsx("button",{onClick:()=>d(t.id),disabled:n||T,className:"text-[#2D3436]/50 hover:text-[#FF6B6B] transition-colors disabled:opacity-30 p-1",children:C.jsx(I1,{size:18})})]})]}),C.jsxs("div",{className:"p-3 border-b-2 border-dashed border-[#E8DCC8]",children:[C.jsx("div",{className:"text-xs font-bold text-[#636E72] mb-2",children:" "}),C.jsx("div",{onClick:()=>{o(t.id),c()},className:`p-2 border-2 border-dashed bg-white min-h-[50px] flex flex-col gap-2 cursor-pointer transition-colors rounded-lg
            ${r?"border-[#54A0FF] bg-[#54A0FF]/10":"border-[#E8DCC8]"}`,children:t.selectedTags.length>0?C.jsx("div",{className:"flex flex-wrap gap-1.5",children:t.selectedTags.map((O,N)=>C.jsxs("span",{className:"tag-handwrite text-xs",children:[O,C.jsx("button",{onClick:U=>{U.stopPropagation(),f(t.id,O)},className:"hover:text-[#FF6B6B] ml-1",children:""})]},N))}):C.jsx("span",{className:"text-[#636E72]/50 text-xs",children:" ..."})}),C.jsx("input",{type:"text",value:t.manualTraits,onChange:O=>h(t.id,"manualTraits",O.target.value),placeholder:" ...",disabled:n||T,className:"w-full mt-2 p-2 text-sm font-medium outline-none border-2 border-[#E8DCC8] focus:border-[#FF9F43] rounded-lg bg-white text-[#2D3436] placeholder:text-[#636E72]/40"})]}),C.jsxs("div",{className:"p-3 bg-[#FFF9E6]",children:[C.jsxs("div",{className:"text-xs font-bold text-[#636E72] mb-2 flex items-center justify-between",children:[C.jsx("span",{className:"flex items-center gap-1",children:" AI "}),C.jsxs("div",{className:"flex items-center gap-2",children:[_&&C.jsxs("button",{onClick:()=>_(t),className:"flex items-center gap-1 text-[#54A0FF] hover:text-[#2D3436] transition-colors",title:"",children:[C.jsx(k1,{size:14}),C.jsx("span",{children:""})]}),t.comment&&!t.comment.includes("")&&!t.comment.includes("")&&C.jsxs("button",{onClick:()=>x(t),className:"flex items-center gap-1 text-[#FF6B9D] hover:text-[#FF6B6B] transition-colors",title:"",children:[C.jsx(A1,{size:14}),C.jsx("span",{children:""})]})]})]}),C.jsx("textarea",{value:t.comment,onChange:O=>h(t.id,"comment",O.target.value),placeholder:" AI ...",disabled:T,className:`w-full text-sm p-3 border-2 border-[#E8DCC8] focus:border-[#1DD1A1] outline-none resize-y min-h-[100px] leading-relaxed font-medium text-[#2D3436] rounded-lg
            ${T?"bg-[#FECA57]/30 animate-pulse":"bg-white"}`}),t.comment&&C.jsxs("div",{className:`text-right text-xs mt-1 font-bold ${R(t.comment.length)}`,children:[t.comment.length," "]})]})]})},_U=({students:t,selectedIds:e,focusedStudentId:r,isGenerating:n,isGeneratingSingle:s,onToggleSelection:i,onToggleAllSelection:o,onFocusStudent:c,onOpenSidebar:f,onRemoveTag:h,onUpdateStudent:d,onDeleteStudent:g,onGenerateSingle:x,onSaveTemplate:_,onOpenHistory:S})=>{const y=typeof window<"u"&&window.innerWidth<768,T=R=>R<50?"text-[#FF6B6B]":R>120?"text-[#FF9F43]":"text-[#1DD1A1]";return y?C.jsx("div",{className:"space-y-4",children:t.length===0?C.jsxs("div",{className:"p-10 text-center font-bold text-lg bg-[#FFFDF5] border-3 border-[#2D3436] rounded-lg shadow-[4px_4px_0_#2D3436]",children:[C.jsx("span",{className:"text-4xl block mb-3",children:""}),C.jsx("span",{className:"text-[#636E72]",children:""})]}):C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"flex items-center justify-between bg-[#A29BFE] text-white border-3 border-[#2D3436] p-3 rounded-lg shadow-[3px_3px_0_#2D3436]",children:C.jsxs("button",{onClick:o,className:"flex items-center gap-2 font-bold text-sm",disabled:n,children:[C.jsx("span",{className:`w-5 h-5 border-2 border-white rounded flex items-center justify-center ${e.size===t.length&&t.length>0?"bg-white text-[#A29BFE]":""}`,children:e.size===t.length&&t.length>0&&C.jsx("span",{className:"text-xs",children:""})})," (",e.size,"/",t.length,")"]})}),t.map(R=>C.jsx(vU,{student:R,isSelected:e.has(R.id),isFocused:r===R.id,isGenerating:n,isGeneratingSingle:s,onToggleSelection:i,onFocus:c,onOpenSidebar:f,onRemoveTag:h,onUpdateStudent:d,onDeleteStudent:g,onGenerateSingle:x,onSaveTemplate:_,onOpenHistory:S},R.id))]})}):C.jsx("div",{className:"card-pop overflow-x-auto",children:C.jsxs("table",{className:"w-full text-left border-collapse min-w-[1000px]",children:[C.jsx("thead",{className:"bg-[#FF6B9D] text-white",children:C.jsxs("tr",{className:"text-base font-black",children:[C.jsx("th",{className:"p-4 lg:p-5 w-12 text-center border-r-2 border-[#2D3436]/20",children:C.jsx("button",{onClick:o,className:"w-6 h-6 border-2 border-white rounded flex items-center justify-center mx-auto bg-white/20 hover:bg-white/40 transition",disabled:n,children:e.size===t.length&&t.length>0&&C.jsx("span",{className:"text-sm",children:""})})}),C.jsx("th",{className:"p-4 lg:p-5 w-32 lg:w-40 border-r-2 border-[#2D3436]/20",children:" "}),C.jsx("th",{className:"p-4 lg:p-5 border-r-2 border-[#2D3436]/20 w-1/4",children:" "}),C.jsx("th",{className:"p-4 lg:p-5 border-r-2 border-[#2D3436]/20",children:" AI "}),C.jsx("th",{className:"p-4 lg:p-5 w-20 text-center",children:""})]})}),C.jsxs("tbody",{className:"bg-[#FFFDF5]",children:[t.length===0&&C.jsx("tr",{children:C.jsxs("td",{colSpan:"5",className:"p-16 lg:p-20 text-center font-bold text-xl text-[#636E72]",children:[C.jsx("span",{className:"text-5xl block mb-4",children:""}),""]})}),t.map(R=>{const O=s===R.id;return C.jsxs("tr",{className:`border-t-2 border-dashed border-[#E8DCC8] hover:bg-[#FECA57]/20 transition-colors ${e.has(R.id)?"bg-[#FF6B9D]/10":""} ${O?"bg-[#FECA57]/30":""}`,children:[C.jsx("td",{className:"p-4 lg:p-5 text-center align-top pt-6 lg:pt-8 border-r-2 border-dashed border-[#E8DCC8]",children:C.jsx("button",{onClick:()=>i(R.id),disabled:n||O,className:`w-6 h-6 border-2 border-[#2D3436] rounded flex items-center justify-center mx-auto transition ${e.has(R.id)?"bg-[#FF6B9D] text-white":"bg-white hover:bg-[#FECA57]"}`,children:e.has(R.id)&&C.jsx("span",{className:"text-sm font-bold",children:""})})}),C.jsxs("td",{className:"p-4 lg:p-5 align-top pt-6 lg:pt-8 border-r-2 border-dashed border-[#E8DCC8]",children:[C.jsx("div",{className:"font-black text-[#2D3436] text-base lg:text-lg mb-2",children:R.name}),C.jsx("button",{onClick:()=>x(R.id),disabled:n||O,className:"btn-pop px-3 py-1.5 bg-[#1DD1A1] text-white text-xs font-bold flex items-center gap-1 disabled:opacity-50 w-full justify-center",children:O?C.jsxs(C.Fragment,{children:[C.jsx(C1,{size:14,className:"animate-spin"})," ..."]}):C.jsx(C.Fragment,{children:" "})})]}),C.jsxs("td",{className:"p-4 lg:p-5 align-top border-r-2 border-dashed border-[#E8DCC8]",children:[C.jsx("div",{onClick:()=>{c(R.id),f()},className:`p-3 border-2 border-dashed bg-white min-h-[80px] lg:min-h-[100px] flex flex-col gap-3 cursor-pointer transition-colors rounded-lg ${r===R.id?"border-[#54A0FF] bg-[#54A0FF]/10":"border-[#E8DCC8] hover:border-[#FF9F43]"}`,children:R.selectedTags.length>0?C.jsx("div",{className:"flex flex-wrap gap-2",children:R.selectedTags.map((N,U)=>C.jsxs("span",{className:"tag-handwrite text-sm",children:[N,C.jsx("button",{onClick:X=>{X.stopPropagation(),h(R.id,N)},className:"hover:text-[#FF6B6B] ml-1",children:""})]},U))}):C.jsx("span",{className:"text-[#636E72]/50 text-sm",children:" ..."})}),C.jsx("input",{type:"text",value:R.manualTraits,onChange:N=>d(R.id,"manualTraits",N.target.value),placeholder:" ...",disabled:n||O,className:"w-full mt-3 p-3 text-sm lg:text-base font-medium outline-none border-2 border-[#E8DCC8] focus:border-[#FF9F43] rounded-lg bg-white text-[#2D3436] placeholder:text-[#636E72]/40 transition-all"})]}),C.jsxs("td",{className:"p-4 lg:p-5 align-top border-r-2 border-dashed border-[#E8DCC8]",children:[C.jsxs("div",{className:"flex items-center justify-between mb-2",children:[C.jsx("span",{className:"text-xs font-bold text-[#636E72]",children:""}),C.jsxs("div",{className:"flex items-center gap-2",children:[S&&C.jsxs("button",{onClick:()=>S(R),className:"flex items-center gap-1 text-xs text-[#54A0FF] hover:text-[#2D3436] transition-colors font-bold",title:"",children:[C.jsx(k1,{size:12})," "]}),R.comment&&!R.comment.includes("")&&!R.comment.includes("")&&C.jsxs("button",{onClick:()=>_(R),className:"flex items-center gap-1 text-xs text-[#FF6B9D] hover:text-[#FF6B6B] transition-colors font-bold",title:"",children:[C.jsx(A1,{size:12})," "]})]})]}),C.jsx("textarea",{value:R.comment,onChange:N=>d(R.id,"comment",N.target.value),placeholder:" AI ...",disabled:O,className:`w-full text-sm lg:text-base p-3 lg:p-4 border-2 border-[#E8DCC8] focus:border-[#1DD1A1] outline-none resize-y min-h-[180px] lg:min-h-[200px] leading-relaxed font-medium text-[#2D3436] rounded-lg transition-all ${O?"bg-[#FECA57]/30 animate-pulse":"bg-white"}`}),R.comment&&C.jsxs("div",{className:`text-right text-xs mt-1 font-bold ${T(R.comment.length)}`,children:[R.comment.length," "]})]}),C.jsx("td",{className:"p-4 lg:p-5 text-center align-top pt-6 lg:pt-8",children:C.jsx("button",{onClick:()=>g(R.id),disabled:n||O,className:"text-[#636E72]/50 hover:text-[#FF6B6B] transition-colors disabled:opacity-30",children:C.jsx(I1,{size:18})})})]},R.id)})]})]})})},yU=({isOpen:t,onClose:e,selectedIds:r,expandedCategories:n,onToggleCategory:s,onIdiomClick:i})=>{const[o,c]=Oe.useState(""),f={" ()":"#1DD1A1"," ()":"#FF6B6B"," ()":"#54A0FF"," ()":"#FECA57"," ()":"#FF9F43"," ()":"#A29BFE"," ()":"#FF6B9D"," ()":"#1DD1A1"," ()":"#FECA57"," ()":"#FF6B6B"," ()":"#54A0FF"," ()":"#A29BFE"," ()":"#FF9F43",:"#FF6B9D",:"#636E72"},h=y=>{try{return JSON.parse(localStorage.getItem("idiom_usage")||"{}")[y]||0}catch{return 0}},d=y=>{try{const T=JSON.parse(localStorage.getItem("idiom_usage")||"{}");T[y]=(T[y]||0)+1,localStorage.setItem("idiom_usage",JSON.stringify(T))}catch(T){console.error(":",T)}},g=y=>{d(y),i(y)},x=Oe.useMemo(()=>{if(!o.trim())return im;const y=o.trim().toLowerCase(),T={};return Object.entries(im).forEach(([R,O])=>{const N=O.filter(U=>U.toLowerCase().includes(y));N.length>0&&(T[R]=N)}),T},[o]),_=Oe.useMemo(()=>Object.values(im).flat().map(R=>({idiom:R,count:h(R)})).filter(R=>R.count>0).sort((R,O)=>O.count-R.count).slice(0,12).map(R=>R.idiom),[t]),S=Object.values(x).reduce((y,T)=>y+T.length,0);return C.jsxs(C.Fragment,{children:[t&&C.jsx("div",{className:"fixed inset-0 bg-black/30 z-40 backdrop-blur-[2px] transition-opacity",onClick:e}),C.jsxs("div",{className:`fixed top-0 right-0 bottom-0 bg-[#FFF9E6] border-l-4 border-[#2D3436] shadow-[-8px_0_0_#2D3436] transform transition-transform duration-300 ease-in-out flex flex-col z-50
          ${t?"translate-x-0":"translate-x-full"}
          w-full sm:w-[80%] md:w-[50%] lg:w-[35%] xl:w-[30%] max-w-[400px]`,children:[C.jsxs("div",{className:"p-3 sm:p-5 bg-[#1DD1A1] border-b-3 border-[#2D3436] flex items-center justify-between shrink-0",children:[C.jsxs("h2",{className:"font-black text-white flex items-center gap-2 sm:gap-3 text-base sm:text-xl",children:[C.jsx("span",{className:"text-2xl",children:""})," "]}),C.jsx("button",{onClick:e,className:"btn-pop p-2 bg-white text-[#2D3436]",children:C.jsx(wf,{size:20})})]}),C.jsxs("div",{className:"p-3 sm:p-4 bg-white border-b-2 border-dashed border-[#E8DCC8]",children:[C.jsxs("div",{className:"relative",children:[C.jsx(K4,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#636E72]"}),C.jsx("input",{type:"text",value:o,onChange:y=>c(y.target.value),placeholder:" ...",className:"w-full pl-10 pr-4 py-2.5 border-2 border-[#2D3436] rounded-lg text-sm font-medium outline-none focus:border-[#1DD1A1] bg-[#FFFDF5]"}),o&&C.jsx("button",{onClick:()=>c(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#636E72] hover:text-[#FF6B6B]",children:""})]}),o&&C.jsxs("div",{className:"mt-2 text-xs text-[#636E72] font-bold",children:[" ",S," "]})]}),C.jsxs("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 space-y-3 sm:space-y-4 mobile-scroll-hide",children:[C.jsxs("div",{className:"text-sm font-bold text-[#2D3436] bg-[#FECA57] px-3 py-2 border-2 border-[#2D3436] rounded-lg inline-flex items-center gap-2 shadow-[2px_2px_0_#2D3436]",children:[C.jsx("span",{children:""})," "]}),r.size>0&&C.jsxs("div",{className:"bg-[#54A0FF] text-white p-3 sm:p-4 border-2 border-[#2D3436] text-xs sm:text-sm font-bold rounded-lg shadow-[3px_3px_0_#2D3436]",children:[C.jsx("span",{className:"block mb-1 text-white/80",children:" "})," ",C.jsx("strong",{children:r.size})," "]}),_.length>0&&!o&&C.jsxs("div",{className:"border-2 border-[#2D3436] rounded-lg overflow-hidden shadow-[3px_3px_0_#2D3436]",children:[C.jsxs("div",{className:"w-full flex items-center justify-between p-3 sm:p-4 text-left text-sm sm:text-base font-black text-white bg-[#FF6B9D]",children:[C.jsx("span",{children:" "}),C.jsx("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded-full",children:_.length})]}),C.jsx("div",{className:"p-3 sm:p-4 bg-[#FFFDF5] flex flex-wrap gap-1.5 sm:gap-2 border-t-2 border-dashed border-[#E8DCC8]",children:_.map((y,T)=>C.jsx("button",{onClick:()=>g(y),className:"px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm bg-[#FF6B9D] border-2 border-[#2D3436] text-white font-bold rounded-lg hover:bg-[#FF5291] transition-all shadow-[2px_2px_0_#2D3436] hover:-translate-y-0.5",children:y},`popular-${y}-${T}`))})]}),Object.entries(x).map(([y,T])=>{const R=f[y]||"#A29BFE";return C.jsxs("div",{className:"border-2 border-[#2D3436] rounded-lg overflow-hidden shadow-[3px_3px_0_#2D3436]",children:[C.jsxs("button",{onClick:()=>s(y),className:"w-full flex items-center justify-between p-3 sm:p-4 text-left text-sm sm:text-base font-black text-white transition-colors",style:{backgroundColor:R},children:[C.jsx("span",{children:y}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded-full",children:T.length}),C.jsx("span",{className:"bg-white/20 rounded-full w-6 h-6 flex items-center justify-center",children:n[y]?"":""})]})]}),(n[y]||o)&&C.jsx("div",{className:"p-3 sm:p-4 bg-[#FFFDF5] flex flex-wrap gap-1.5 sm:gap-2 border-t-2 border-dashed border-[#E8DCC8]",children:T.map((O,N)=>C.jsx("button",{onClick:()=>g(O),className:"px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm bg-white border-2 border-[#2D3436] text-[#2D3436] font-bold rounded-lg hover:text-white transition-all shadow-[2px_2px_0_#2D3436] hover:-translate-y-0.5 hover:shadow-[3px_3px_0_#2D3436] active:translate-y-0 active:shadow-[1px_1px_0_#2D3436]",style:{"--hover-bg":R},onMouseEnter:U=>U.target.style.backgroundColor=R,onMouseLeave:U=>U.target.style.backgroundColor="white",children:o&&O.includes(o)?C.jsx("span",{dangerouslySetInnerHTML:{__html:O.replace(new RegExp(`(${o})`,"gi"),'<mark class="bg-[#FECA57] px-0.5 rounded">$1</mark>')}}):O},`${O}-${N}`))})]},y)}),o&&Object.keys(x).length===0&&C.jsxs("div",{className:"text-center py-10",children:[C.jsx("div",{className:"text-4xl mb-3",children:""}),C.jsxs("p",{className:"text-[#636E72] font-bold",children:["",o,""]})]})]})]})]})},wU=()=>C.jsx("div",{className:"fixed inset-0 z-[90] flex items-center justify-center bg-[#FFF9E6]",children:C.jsxs("div",{className:"text-center",children:[C.jsx("div",{className:"text-6xl mb-4 animate-bounce",children:""}),C.jsx("h2",{className:"text-2xl font-black text-[#2D3436] mb-2",children:"..."}),C.jsx("p",{className:"text-[#636E72] font-medium",children:""}),C.jsxs("div",{className:"mt-4 flex justify-center gap-1",children:[C.jsx("span",{className:"w-3 h-3 bg-[#FF6B9D] rounded-full animate-bounce",style:{animationDelay:"0ms"}}),C.jsx("span",{className:"w-3 h-3 bg-[#FECA57] rounded-full animate-bounce",style:{animationDelay:"150ms"}}),C.jsx("span",{className:"w-3 h-3 bg-[#1DD1A1] rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})}),EU=()=>{const[t,e]=Oe.useState(null),[r,n]=Oe.useState(!1);Oe.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches)return;const c=localStorage.getItem("pwa_install_dismissed");if(c&&Date.now()-parseInt(c)<1e3*60*60*24*7)return;const f=h=>{h.preventDefault(),e(h),n(!0)};return window.addEventListener("beforeinstallprompt",f),()=>window.removeEventListener("beforeinstallprompt",f)},[]);const s=async()=>{if(!t)return;t.prompt();const{outcome:o}=await t.userChoice;o==="accepted"&&n(!1),e(null)},i=()=>{n(!1),localStorage.setItem("pwa_install_dismissed",Date.now().toString())};return r?C.jsx("div",{className:"fixed bottom-4 left-4 right-4 sm:left-auto sm:right-4 sm:max-w-sm z-[100] animate-in",children:C.jsxs("div",{className:"bg-[#2D3436] text-white p-4 rounded-lg border-3 border-[#FECA57] shadow-[4px_4px_0_#FECA57] flex items-center gap-3",children:[C.jsx("div",{className:"text-3xl",children:""}),C.jsxs("div",{className:"flex-1",children:[C.jsx("h3",{className:"font-black text-sm",children:""}),C.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:""})]}),C.jsxs("button",{onClick:s,className:"btn-pop px-3 py-2 bg-[#FECA57] text-[#2D3436] text-xs font-bold flex items-center gap-1",children:[C.jsx(bm,{size:14}),""]}),C.jsx("button",{onClick:i,className:"text-white/50 hover:text-white p-1",children:C.jsx(wf,{size:16})})]})}):null},TU=()=>C.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm",children:C.jsxs("div",{className:"bg-[#FFF9E6] border-3 border-[#2D3436] rounded-lg p-6 shadow-lg flex flex-col items-center gap-3",children:[C.jsx(C1,{size:32,className:"animate-spin text-[#FF6B9D]"}),C.jsx("span",{className:"font-bold text-[#2D3436]",children:"..."})]})}),SU=Oe.lazy(()=>va(()=>import("./StyleModal-BeyhTMRH.js"),[])),kU=Oe.lazy(()=>va(()=>import("./ApiKeyModal-BtrX0KI5.js"),[])),AU=Oe.lazy(()=>va(()=>import("./TemplateModal-BlL6iL0E.js"),[])),CU=Oe.lazy(()=>va(()=>import("./ClassModal-B9DId8xg.js"),[])),IU=Oe.lazy(()=>va(()=>import("./HistoryModal-4z9f9018.js"),[])),FU=Oe.lazy(()=>va(()=>import("./AdminPanel-BvaILyQP.js"),__vite__mapDeps([0,1]))),RU=Oe.lazy(()=>va(()=>import("./ImportExportModal-BQWD408T.js"),__vite__mapDeps([2,3]))),NU=Oe.lazy(()=>va(()=>import("./PrintModal-B0FJCx7k.js").then(t=>t.P),__vite__mapDeps([4,3]))),DU=Oe.lazy(()=>va(()=>import("./DashboardModal-DWUNL89m.js"),__vite__mapDeps([5,1]))),PU=({currentUser:t,onLogout:e,isAdmin:r})=>{const{toast:n}=bw(),{dialog:s,closeDialog:i,showConfirm:o,showAlert:c}=nC(),[f,h]=Oe.useState(!1),{students:d,setStudents:g,selectedIds:x,isLoading:_,generateStudents:S,updateStudent:y,deleteStudent:T,deleteSelected:R,resetStudents:O,toggleSelection:N,toggleAllSelection:U,addTagToStudents:X,removeTag:G,syncComment:k}=oD(t==null?void 0:t.uid),[F,I]=Oe.useState(`

`),[B,L]=Oe.useState(30),[M,V]=Oe.useState(!1),[Fe,Ce]=Oe.useState(!1),[Le,Ne]=Oe.useState(null),[Se,ne]=Oe.useState({current:0,total:0}),[ye,ee]=Oe.useState(!1),[b,te]=Oe.useState(["qualitative"]),[J,Z]=Oe.useState(!1),[oe,_e]=Oe.useState(!1),[ve,xe]=Oe.useState(b_()),[Ee,st]=Oe.useState({tone:"normal",wordCount:80}),[Y,Et]=Oe.useState(null),[gt,It]=Oe.useState(!1),[ht,Ue]=Oe.useState(0),[Ht,St]=Oe.useState(!1),[Tt,dr]=Oe.useState(null),[gn,sn]=Oe.useState(""),[Wr,Pr]=Oe.useState([]),[xn,Vn]=Oe.useState(!1),[$t,Yr]=Oe.useState(null),[ot,Nt]=Oe.useState(!1),[Hr,Mt]=Oe.useState(!1),[vn,Ws]=Oe.useState(!1);Oe.useEffect(()=>{if(!t)return;const Qe=nD.subscribe(Je=>{Je!=null&&Je.apiKey&&(localStorage.setItem("gemini_api_key",Je.apiKey),xe(!0))});return()=>Qe()},[t]),Oe.useEffect(()=>{const Qe=p2.subscribe(Je=>{Ue(Je.length)});return()=>Qe()},[]),Oe.useEffect(()=>{const Qe=sS.subscribe(Je=>{if(Pr(Je),Tt){const jt=Je.find(Jt=>Jt.id===Tt);sn(jt?jt.name:"")}});return()=>Qe()},[Tt]);const[Bn,fi]=Oe.useState({" ()":!0," ()":!0});Oe.useEffect(()=>{const Qe=()=>ee(window.innerWidth<768);return Qe(),window.addEventListener("resize",Qe),()=>window.removeEventListener("resize",Qe)},[]);const as=()=>{F.trim()&&(S(F),I(""))},Hs=()=>{if(B<1)return;const Qe=[];for(let jt=1;jt<=B;jt++){const Jt=jt<10?`0${jt}`:`${jt}`;Qe.push(`${Jt}`)}const Je=Qe.join(`
`);I(jt=>jt?`${jt}
${Je}`:Je)},Un=()=>{o("","",()=>{O(),i()})},os=()=>{x.size!==0&&o("",` ${x.size} `,()=>{R(),i()})},er=Qe=>{let Je=[];if(x.size>0?Je=Array.from(x):Le&&(Je=[Le]),Je.length===0){c("");return}X(Je,Qe)},Ts=Qe=>{fi(Je=>({...Je,[Qe]:!Je[Qe]}))},Ss=Qe=>{te(Je=>Je.includes(Qe)?Je.filter(Jt=>Jt!==Qe):Je.length>=2?Je:[...Je,Qe])},ls=async(Qe=!1)=>{Ce(!0);const Je=d.filter(Jt=>Qe?x.has(Jt.id):!0),jt=Je.length;if(jt===0){Ce(!1);return}ne({current:0,total:jt});for(let Jt=0;Jt<jt;Jt++){const nr=Je[Jt];g(j=>j.map(W=>W.id===nr.id?{...W,comment:""}:W));const P=[...nr.selectedTags,nr.manualTraits].filter(Boolean).join(""),H=await O_(nr.name,P,b,Ee);g(j=>j.map(W=>W.id===nr.id?{...W,comment:H}:W)),await k(nr.id,H),ne(j=>({...j,current:Jt+1}))}Ce(!1),ne({current:0,total:0}),n.success(`  ${jt} `)},Ta=Qe=>{rC(d,Qe)},Sa=async Qe=>{const Je=d.find(nr=>nr.id===Qe);if(!Je)return;if(Et(Qe),Je.comment&&!Je.comment.includes(""))try{await iD.add(Qe,Je.comment,b)}catch(nr){console.error(":",nr)}const jt=[...Je.selectedTags,Je.manualTraits].filter(Boolean).join(""),Jt=await O_(Je.name,jt,b,Ee);g(nr=>nr.map(P=>P.id===Qe?{...P,comment:Jt}:P)),await k(Qe,Jt),Et(null),n.success(` ${Je.name} `)},Kn=async Qe=>{try{await p2.add({content:Qe.comment,studentName:Qe.name,tags:Qe.selectedTags,styles:b}),n.success(" ")}catch(Je){console.error(":",Je),n.error("")}},ka=Qe=>{Le&&(y(Le,"comment",Qe),k(Le,Qe))},$s=async(Qe,Je)=>{Je==="replace"&&await clearAllStudents();for(const jt of Qe)await addStudent(jt.name,jt.selectedTags,jt.comment)};return C.jsxs("div",{className:"min-h-screen text-[#2D3436] font-sans flex flex-col relative",children:[_&&C.jsx(wU,{}),C.jsx(uD,{dialog:s,closeDialog:i}),Fe&&C.jsx(fD,{progress:Se}),C.jsxs(Oe.Suspense,{fallback:C.jsx(TU,{}),children:[C.jsx(SU,{isOpen:J,onClose:()=>Z(!1),globalStyles:b,toggleGlobalStyle:Ss}),C.jsx(kU,{isOpen:oe,onClose:()=>{_e(!1),xe(b_())},currentUser:t}),C.jsx(AU,{isOpen:gt,onClose:()=>It(!1),onApplyTemplate:ka}),C.jsx(CU,{isOpen:Ht,onClose:()=>St(!1),currentClassId:Tt,onSelectClass:Qe=>{dr(Qe),Qe||sn("")}}),C.jsx(IU,{isOpen:xn,onClose:()=>{Vn(!1),Yr(null)},student:$t,onRestore:Qe=>{$t&&(y($t.id,"comment",Qe),k($t.id,Qe))}}),C.jsx(FU,{isOpen:f,onClose:()=>h(!1),currentUser:t}),C.jsx(RU,{isOpen:ot,onClose:()=>Nt(!1),students:d,onImport:$s,currentClassName:gn}),C.jsx(NU,{isOpen:Hr,onClose:()=>Mt(!1),students:d,currentClassName:gn}),C.jsx(DU,{isOpen:vn,onClose:()=>Ws(!1),students:d,currentClassName:gn})]}),C.jsx(lD,{isSidebarOpen:M,setIsSidebarOpen:V,onOpenSettings:()=>_e(!0),onOpenTemplates:()=>It(!0),onOpenClasses:()=>St(!0),onOpenAdmin:()=>h(!0),onOpenImportExport:()=>Nt(!0),onOpenPrint:()=>Mt(!0),onOpenDashboard:()=>Ws(!0),onLogout:e,hasApiKey:ve,templateCount:ht,currentClassName:gn,currentUser:t,isAdmin:r}),C.jsxs("div",{className:"flex flex-col flex-1 w-full mx-auto relative",children:[C.jsxs("div",{className:"p-3 sm:p-6 bg-[#FFFDF5] border-b-4 border-[#2D3436] flex flex-col lg:flex-row gap-4 sm:gap-6 items-stretch",children:[C.jsx(mU,{rawInput:F,setRawInput:I,numberCount:B,setNumberCount:L,onGenerateStudents:as,onGenerateNumbers:Hs,onResetList:Un,isGenerating:Fe}),C.jsx(gU,{students:d,selectedIds:x,isGenerating:Fe,extraSettings:Ee,setExtraSettings:st,onGenerateSelected:()=>ls(!0),onGenerateAll:()=>ls(!1),onDownload:Ta,onDeleteSelected:os,onResetList:Un})]}),C.jsxs("div",{className:"flex-1 p-3 sm:p-6",children:[C.jsx(xU,{globalStyles:b,onOpenStyleModal:()=>Z(!0),isGenerating:Fe}),C.jsx(_U,{students:d,selectedIds:x,focusedStudentId:Le,isGenerating:Fe,isGeneratingSingle:Y,onToggleSelection:N,onToggleAllSelection:U,onFocusStudent:Ne,onOpenSidebar:()=>V(!0),onRemoveTag:G,onUpdateStudent:y,onDeleteStudent:T,onGenerateSingle:Sa,onSaveTemplate:Kn,onOpenHistory:Qe=>{Yr(Qe),Vn(!0)}})]}),C.jsx(yU,{isOpen:M,onClose:()=>V(!1),selectedIds:x,expandedCategories:Bn,onToggleCategory:Ts,onIdiomClick:er})]}),C.jsx(cD,{}),C.jsx(EU,{})]})},bU=({onLogin:t})=>{const[e,r]=Xu.useState(!1),[n,s]=Xu.useState(null),i=async()=>{r(!0),s(null);const o=await f1.signInWithGoogle();o.success||s(o.error),r(!1)};return C.jsx("div",{className:"min-h-screen bg-[#FFF9E6] flex items-center justify-center p-4",children:C.jsxs("div",{className:"card-pop w-full max-w-md p-8 text-center",children:[C.jsxs("div",{className:"mb-6",children:[C.jsx("div",{className:"inline-block bg-[#FECA57] text-[#2D3436] p-4 border-3 border-[#2D3436] shadow-[4px_4px_0_#2D3436] transform rotate-[-3deg] rounded-lg mb-4",children:C.jsx("span",{className:"text-5xl",children:""})}),C.jsx("h1",{className:"text-3xl font-black text-[#2D3436]",children:C.jsxs("span",{className:"relative",children:[C.jsx("span",{className:"relative z-10",children:""}),C.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-3 bg-[#FF6B9D] -z-0 transform -rotate-1"})]})}),C.jsx("p",{className:"text-[#636E72] font-bold mt-2",children:"AI "})]}),C.jsx("div",{className:"bg-[#54A0FF]/20 border-2 border-dashed border-[#54A0FF] rounded-lg p-4 mb-6 text-left",children:C.jsx("p",{className:"text-sm text-[#2D3436] font-medium",children:"  Google "})}),n&&C.jsxs("div",{className:"bg-[#FF6B6B]/20 border-2 border-[#FF6B6B] rounded-lg p-3 mb-4 text-sm text-[#FF6B6B] font-bold",children:[" ",n]}),C.jsx("button",{onClick:i,disabled:e,className:"btn-pop w-full py-4 bg-white text-[#2D3436] font-bold flex items-center justify-center gap-3 text-lg disabled:opacity-50",children:e?C.jsx("span",{className:"animate-spin text-2xl",children:""}):C.jsxs(C.Fragment,{children:[C.jsxs("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",children:[C.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),C.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),C.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),C.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})," Google "]})}),C.jsx("p",{className:"text-xs text-[#636E72]/50 mt-6",children:" 2026 "})]})})},OU=({user:t,onLogout:e,schools:r=[],onSubmitApplication:n,needsInfo:s})=>{var R,O,N;const[i,o]=Oe.useState(null),[c,f]=Oe.useState([]),[h,d]=Oe.useState(""),[g,x]=Oe.useState(!1),_=()=>{const U=h.trim();U&&!c.includes(U)&&(f([...c,U]),d(""))},S=U=>{f(c.filter(X=>X!==U))},y=async()=>{if(!(!i||c.length===0)){x(!0);try{await n(t.uid,i,c)}catch(U){console.error(":",U)}x(!1)}},T=U=>{U.key==="Enter"&&(U.preventDefault(),_())};return C.jsx("div",{className:"min-h-screen bg-[#FFF9E6] flex items-center justify-center p-4",children:C.jsxs("div",{className:"card-pop w-full max-w-lg p-6 sm:p-8",children:[C.jsx("div",{className:"mb-6 text-center",children:t!=null&&t.photoURL?C.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full border-3 border-[#2D3436] shadow-[3px_3px_0_#2D3436] mx-auto"}):C.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-[#FECA57] rounded-full border-3 border-[#2D3436] shadow-[3px_3px_0_#2D3436] mx-auto flex items-center justify-center",children:C.jsx("span",{className:"text-3xl sm:text-4xl",children:""})})}),C.jsxs("h2",{className:"text-xl sm:text-2xl font-black text-[#2D3436] mb-2 text-center",children:["",(t==null?void 0:t.displayName)||"",""]}),C.jsx("p",{className:"text-[#636E72] text-xs sm:text-sm mb-6 text-center",children:t==null?void 0:t.email}),s?C.jsxs("div",{className:"space-y-4",children:[C.jsx("div",{className:"bg-[#54A0FF]/10 border-2 border-dashed border-[#54A0FF] rounded-lg p-4 mb-4",children:C.jsx("p",{className:"text-sm text-[#2D3436] font-medium text-center",children:" "})}),C.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg p-4",children:[C.jsxs("h4",{className:"font-bold text-[#2D3436] mb-3 flex items-center gap-2 text-sm sm:text-base",children:[C.jsx(M4,{size:18}),""]}),r.length===0?C.jsx("p",{className:"text-sm text-[#636E72]",children:" (cagooo@gmail.com)"}):C.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(U=>C.jsxs("button",{onClick:()=>o(i===U.id?null:U.id),className:`px-3 py-2 border-2 border-[#2D3436] rounded-lg font-bold text-xs sm:text-sm transition-all
                                              ${i===U.id?"bg-[#A29BFE] text-white shadow-[2px_2px_0_#2D3436]":"bg-white hover:bg-[#A29BFE]/20"}`,children:[i===U.id&&C.jsx(V4,{size:14,className:"inline mr-1"})," ",U.name,U.city&&C.jsxs("span",{className:"opacity-70 ml-1",children:["(",U.city,")"]})]},U.id))})]}),C.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg p-4",children:[C.jsxs("h4",{className:"font-bold text-[#2D3436] mb-3 flex items-center gap-2 text-sm sm:text-base",children:[C.jsx(Lm,{size:18}),""]}),c.length>0&&C.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:c.map(U=>C.jsxs("span",{className:"px-3 py-1.5 bg-[#1DD1A1] text-white text-xs sm:text-sm font-bold rounded-lg flex items-center gap-1 border-2 border-[#2D3436]",children:[U,C.jsx("button",{onClick:()=>S(U),className:"hover:bg-white/20 rounded p-0.5",children:C.jsx(wf,{size:14})})]},U))}),C.jsxs("div",{className:"flex gap-2",children:[C.jsx("input",{type:"text",value:h,onChange:U=>d(U.target.value),onKeyDown:T,placeholder:"",className:"flex-1 px-3 py-2 border-2 border-[#2D3436] rounded-lg text-sm font-medium"}),C.jsxs("button",{onClick:_,disabled:!h.trim(),className:"btn-pop px-3 py-2 bg-[#1DD1A1] text-white font-bold disabled:opacity-50 flex items-center gap-1",children:[C.jsx(Rw,{size:16}),C.jsx("span",{className:"hidden sm:inline",children:""})]})]})]}),C.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-2",children:[C.jsx("button",{onClick:e,className:"btn-pop px-4 py-3 bg-[#636E72] text-white font-bold order-2 sm:order-1",children:""}),C.jsxs("button",{onClick:y,disabled:!i||c.length===0||g,className:"btn-pop px-4 py-3 bg-[#54A0FF] text-white font-bold flex-1 flex items-center justify-center gap-2 disabled:opacity-50 order-1 sm:order-2",children:[C.jsx(X4,{size:18}),g?"...":""]})]})]}):C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"bg-[#FECA57]/30 border-3 border-[#FECA57] rounded-lg p-6 mb-6",children:[C.jsx("div",{className:"text-4xl mb-3 animate-bounce",children:C.jsx(k1,{size:48,className:"mx-auto text-[#FF9F43]"})}),C.jsx("h3",{className:"text-lg sm:text-xl font-black text-[#2D3436] mb-2 text-center",children:" "}),C.jsxs("p",{className:"text-xs sm:text-sm text-[#636E72] font-medium text-center",children:["",C.jsx("br",{}),""]})]}),((t==null?void 0:t.requestedSchoolId)||((R=t==null?void 0:t.requestedClasses)==null?void 0:R.length)>0)&&C.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg p-4 mb-6",children:[C.jsx("h4",{className:"font-bold text-[#2D3436] mb-2 text-sm",children:" "}),t.requestedSchoolId&&r.length>0&&C.jsxs("p",{className:"text-xs sm:text-sm text-[#636E72]",children:[C.jsx("span",{className:"font-medium",children:""}),((O=r.find(U=>U.id===t.requestedSchoolId))==null?void 0:O.name)||""]}),((N=t.requestedClasses)==null?void 0:N.length)>0&&C.jsxs("p",{className:"text-xs sm:text-sm text-[#636E72]",children:[C.jsx("span",{className:"font-medium",children:""}),t.requestedClasses.join("")]})]}),C.jsx("div",{className:"bg-[#54A0FF]/10 border-2 border-dashed border-[#54A0FF] rounded-lg p-4 mb-6 text-left",children:C.jsxs("p",{className:"text-xs text-[#636E72]",children:[" ",C.jsx("strong",{children:""})," (cagooo@gmail.com) "]})}),C.jsx("button",{onClick:e,className:"btn-pop w-full px-6 py-3 bg-[#636E72] text-white font-bold",children:""})]})]})})},LU=({children:t})=>{var x;const[e,r]=Oe.useState(null),[n,s]=Oe.useState(!0),[i,o]=Oe.useState([]),[c,f]=Oe.useState([]);Oe.useEffect(()=>{const _=f1.onAuthStateChange(S=>{r(S),s(!1)});return()=>_()},[]),Oe.useEffect(()=>{if(!e)return;const _=sD.subscribe(y=>{o(y)}),S=sS.subscribe(y=>{f(y)});return()=>{_(),S()}},[e]);const h=e?{...e,schoolName:e.schoolId?(x=i.find(_=>_.id===e.schoolId))==null?void 0:x.name:null,assignedClassNames:(e.assignedClasses||[]).map(_=>{var S;return(S=c.find(y=>y.id===_))==null?void 0:S.name}).filter(Boolean)}:null,d=async()=>{await f1.signOut(),r(null)},g=async(_,S,y)=>{const T=await $o.submitApplication(_,S,y);if(T.success){const R=await $o.get(_);R&&r(R)}return T};return n?C.jsx("div",{className:"min-h-screen bg-[#FFF9E6] flex items-center justify-center",children:C.jsxs("div",{className:"text-center",children:[C.jsx("div",{className:"text-6xl animate-bounce mb-4",children:""}),C.jsx("p",{className:"font-bold text-[#2D3436]",children:"..."})]})}):e?$o.isApproved(e)?Xu.cloneElement(t,{currentUser:h,onLogout:d,isAdmin:$o.isAdmin(e)}):C.jsx(OU,{user:e,onLogout:d,schools:i,onSubmitApplication:g,needsInfo:$o.needsInfo(e)}):C.jsx(bU,{})};class MU extends Xu.Component{constructor(r){super(r);Zp(this,"handleReload",()=>{window.location.reload()});Zp(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){this.setState({errorInfo:n}),console.error(" ErrorBoundary :",r,n)}render(){return this.state.hasError?C.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-[#FFF9E6] to-[#FFE4E1] p-4",children:C.jsxs("div",{className:"card-pop max-w-md w-full p-8 bg-white text-center",children:[C.jsxs("div",{className:"mb-6",children:[C.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-[#FF6B6B]/20 rounded-full mb-4",children:C.jsx(Dw,{size:40,className:"text-[#FF6B6B]"})}),C.jsx("div",{className:"text-4xl",children:""})]}),C.jsx("h1",{className:"text-2xl font-black text-[#2D3436] mb-2",children:""}),C.jsx("p",{className:"text-[#636E72] mb-6",children:""}),!1,C.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[C.jsx("button",{onClick:this.handleReset,className:"btn-pop flex-1 py-3 px-4 bg-[#636E72] text-white font-bold flex items-center justify-center gap-2",children:""}),C.jsxs("button",{onClick:this.handleReload,className:"btn-pop flex-1 py-3 px-4 bg-[#FF6B9D] text-white font-bold flex items-center justify-center gap-2",children:[C.jsx(Nw,{size:18}),""]})]}),C.jsx("p",{className:"mt-6 text-xs text-[#636E72]",children:""})]})}):this.props.children}}N4.createRoot(document.getElementById("root")).render(C.jsx(Xu.StrictMode,{children:C.jsx(MU,{children:C.jsx(tC,{children:C.jsx(LU,{children:C.jsx(PU,{})})})})}));export{M4 as B,j4 as C,bm as D,Om as F,A1 as H,C1 as L,Rw as P,Aw as S,I1 as T,ei as U,wf as X,va as _,U4 as a,sS as b,Ut as c,Lm as d,V4 as e,k1 as f,sD as g,iD as h,Y4 as i,C as j,z4 as k,bw as l,J4 as m,UU as n,jU as o,dU as p,zU as q,Oe as r,nD as s,p2 as t,$o as u,M_ as v,L_ as w,Gh as x,kw as y};
