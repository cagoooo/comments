const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ApiKeyModal-C0FhU_ce.js","assets/key-RDmEU-JP.js","assets/ClassModal-Cky9s5J6.js","assets/users-4Vnw4V3a.js","assets/eye-yGmyv5bi.js","assets/AdminPanel-E1oFPAsO.js","assets/file-text-B2FDNG5L.js","assets/ImportExportModal-BpJiQ2jp.js","assets/file-down-DonMBIGv.js","assets/PrintModal-DSgrPF9m.js","assets/DashboardModal-DZ8el1uZ.js"])))=>i.map(i=>d[i]);
var IA=Object.defineProperty;var FA=(t,e,r)=>e in t?IA(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var sm=(t,e,r)=>FA(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Xh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ow(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var im={exports:{}},Iu={},am={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D_;function RA(){if(D_)return It;D_=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function x(ee){return ee===null||typeof ee!="object"?null:(ee=g&&ee[g]||ee["@@iterator"],typeof ee=="function"?ee:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,y={};function S(ee,O,te){this.props=ee,this.context=O,this.refs=y,this.updater=te||_}S.prototype.isReactComponent={},S.prototype.setState=function(ee,O){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,O,"setState")},S.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function R(){}R.prototype=S.prototype;function M(ee,O,te){this.props=ee,this.context=O,this.refs=y,this.updater=te||_}var N=M.prototype=new R;N.constructor=M,k(N,S.prototype),N.isPureReactComponent=!0;var V=Array.isArray,W=Object.prototype.hasOwnProperty,j={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function F(ee,O,te){var J,Z={},oe=null,_e=null;if(O!=null)for(J in O.ref!==void 0&&(_e=O.ref),O.key!==void 0&&(oe=""+O.key),O)W.call(O,J)&&!A.hasOwnProperty(J)&&(Z[J]=O[J]);var ve=arguments.length-2;if(ve===1)Z.children=te;else if(1<ve){for(var xe=Array(ve),Te=0;Te<ve;Te++)xe[Te]=arguments[Te+2];Z.children=xe}if(ee&&ee.defaultProps)for(J in ve=ee.defaultProps,ve)Z[J]===void 0&&(Z[J]=ve[J]);return{$$typeof:t,type:ee,key:oe,ref:_e,props:Z,_owner:j.current}}function I(ee,O){return{$$typeof:t,type:ee.type,key:O,ref:ee.ref,props:ee.props,_owner:ee._owner}}function U(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===t}function L(ee){var O={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(te){return O[te]})}var D=/\/+/g;function B(ee,O){return typeof ee=="object"&&ee!==null&&ee.key!=null?L(""+ee.key):O.toString(36)}function De(ee,O,te,J,Z){var oe=typeof ee;(oe==="undefined"||oe==="boolean")&&(ee=null);var _e=!1;if(ee===null)_e=!0;else switch(oe){case"string":case"number":_e=!0;break;case"object":switch(ee.$$typeof){case t:case e:_e=!0}}if(_e)return _e=ee,Z=Z(_e),ee=J===""?"."+B(_e,0):J,V(Z)?(te="",ee!=null&&(te=ee.replace(D,"$&/")+"/"),De(Z,O,te,"",function(Te){return Te})):Z!=null&&(U(Z)&&(Z=I(Z,te+(!Z.key||_e&&_e.key===Z.key?"":(""+Z.key).replace(D,"$&/")+"/")+ee)),O.push(Z)),1;if(_e=0,J=J===""?".":J+":",V(ee))for(var ve=0;ve<ee.length;ve++){oe=ee[ve];var xe=J+B(oe,ve);_e+=De(oe,O,te,xe,Z)}else if(xe=x(ee),typeof xe=="function")for(ee=xe.call(ee),ve=0;!(oe=ee.next()).done;)oe=oe.value,xe=J+B(oe,ve++),_e+=De(oe,O,te,xe,Z);else if(oe==="object")throw O=String(ee),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.");return _e}function Re(ee,O,te){if(ee==null)return ee;var J=[],Z=0;return De(ee,J,"","",function(oe){return O.call(te,oe,Z++)}),J}function Ve(ee){if(ee._status===-1){var O=ee._result;O=O(),O.then(function(te){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=te)},function(te){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=te)}),ee._status===-1&&(ee._status=0,ee._result=O)}if(ee._status===1)return ee._result.default;throw ee._result}var Le={current:null},Ae={transition:null},ne={ReactCurrentDispatcher:Le,ReactCurrentBatchConfig:Ae,ReactCurrentOwner:j};function we(){throw Error("act(...) is not supported in production builds of React.")}return It.Children={map:Re,forEach:function(ee,O,te){Re(ee,function(){O.apply(this,arguments)},te)},count:function(ee){var O=0;return Re(ee,function(){O++}),O},toArray:function(ee){return Re(ee,function(O){return O})||[]},only:function(ee){if(!U(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}},It.Component=S,It.Fragment=r,It.Profiler=s,It.PureComponent=M,It.StrictMode=n,It.Suspense=u,It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,It.act=we,It.cloneElement=function(ee,O,te){if(ee==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ee+".");var J=k({},ee.props),Z=ee.key,oe=ee.ref,_e=ee._owner;if(O!=null){if(O.ref!==void 0&&(oe=O.ref,_e=j.current),O.key!==void 0&&(Z=""+O.key),ee.type&&ee.type.defaultProps)var ve=ee.type.defaultProps;for(xe in O)W.call(O,xe)&&!A.hasOwnProperty(xe)&&(J[xe]=O[xe]===void 0&&ve!==void 0?ve[xe]:O[xe])}var xe=arguments.length-2;if(xe===1)J.children=te;else if(1<xe){ve=Array(xe);for(var Te=0;Te<xe;Te++)ve[Te]=arguments[Te+2];J.children=ve}return{$$typeof:t,type:ee.type,key:Z,ref:oe,props:J,_owner:_e}},It.createContext=function(ee){return ee={$$typeof:o,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ee.Provider={$$typeof:i,_context:ee},ee.Consumer=ee},It.createElement=F,It.createFactory=function(ee){var O=F.bind(null,ee);return O.type=ee,O},It.createRef=function(){return{current:null}},It.forwardRef=function(ee){return{$$typeof:c,render:ee}},It.isValidElement=U,It.lazy=function(ee){return{$$typeof:d,_payload:{_status:-1,_result:ee},_init:Ve}},It.memo=function(ee,O){return{$$typeof:h,type:ee,compare:O===void 0?null:O}},It.startTransition=function(ee){var O=Ae.transition;Ae.transition={};try{ee()}finally{Ae.transition=O}},It.unstable_act=we,It.useCallback=function(ee,O){return Le.current.useCallback(ee,O)},It.useContext=function(ee){return Le.current.useContext(ee)},It.useDebugValue=function(){},It.useDeferredValue=function(ee){return Le.current.useDeferredValue(ee)},It.useEffect=function(ee,O){return Le.current.useEffect(ee,O)},It.useId=function(){return Le.current.useId()},It.useImperativeHandle=function(ee,O,te){return Le.current.useImperativeHandle(ee,O,te)},It.useInsertionEffect=function(ee,O){return Le.current.useInsertionEffect(ee,O)},It.useLayoutEffect=function(ee,O){return Le.current.useLayoutEffect(ee,O)},It.useMemo=function(ee,O){return Le.current.useMemo(ee,O)},It.useReducer=function(ee,O,te){return Le.current.useReducer(ee,O,te)},It.useRef=function(ee){return Le.current.useRef(ee)},It.useState=function(ee){return Le.current.useState(ee)},It.useSyncExternalStore=function(ee,O,te){return Le.current.useSyncExternalStore(ee,O,te)},It.useTransition=function(){return Le.current.useTransition()},It.version="18.3.1",It}var P_;function Ng(){return P_||(P_=1,am.exports=RA()),am.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O_;function NA(){if(O_)return Iu;O_=1;var t=Ng(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(c,u,h){var d,g={},x=null,_=null;h!==void 0&&(x=""+h),u.key!==void 0&&(x=""+u.key),u.ref!==void 0&&(_=u.ref);for(d in u)n.call(u,d)&&!i.hasOwnProperty(d)&&(g[d]=u[d]);if(c&&c.defaultProps)for(d in u=c.defaultProps,u)g[d]===void 0&&(g[d]=u[d]);return{$$typeof:e,type:c,key:x,ref:_,props:g,_owner:s.current}}return Iu.Fragment=r,Iu.jsx=o,Iu.jsxs=o,Iu}var L_;function bA(){return L_||(L_=1,im.exports=NA()),im.exports}var w=bA(),ye=Ng();const Sf=Ow(ye);var Yh={},om={exports:{}},ms={},lm={exports:{}},cm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M_;function DA(){return M_||(M_=1,(function(t){function e(Ae,ne){var we=Ae.length;Ae.push(ne);e:for(;0<we;){var ee=we-1>>>1,O=Ae[ee];if(0<s(O,ne))Ae[ee]=ne,Ae[we]=O,we=ee;else break e}}function r(Ae){return Ae.length===0?null:Ae[0]}function n(Ae){if(Ae.length===0)return null;var ne=Ae[0],we=Ae.pop();if(we!==ne){Ae[0]=we;e:for(var ee=0,O=Ae.length,te=O>>>1;ee<te;){var J=2*(ee+1)-1,Z=Ae[J],oe=J+1,_e=Ae[oe];if(0>s(Z,we))oe<O&&0>s(_e,Z)?(Ae[ee]=_e,Ae[oe]=we,ee=oe):(Ae[ee]=Z,Ae[J]=we,ee=J);else if(oe<O&&0>s(_e,we))Ae[ee]=_e,Ae[oe]=we,ee=oe;else break e}}return ne}function s(Ae,ne){var we=Ae.sortIndex-ne.sortIndex;return we!==0?we:Ae.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],h=[],d=1,g=null,x=3,_=!1,k=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Ae){for(var ne=r(h);ne!==null;){if(ne.callback===null)n(h);else if(ne.startTime<=Ae)n(h),ne.sortIndex=ne.expirationTime,e(u,ne);else break;ne=r(h)}}function V(Ae){if(y=!1,N(Ae),!k)if(r(u)!==null)k=!0,Ve(W);else{var ne=r(h);ne!==null&&Le(V,ne.startTime-Ae)}}function W(Ae,ne){k=!1,y&&(y=!1,R(F),F=-1),_=!0;var we=x;try{for(N(ne),g=r(u);g!==null&&(!(g.expirationTime>ne)||Ae&&!L());){var ee=g.callback;if(typeof ee=="function"){g.callback=null,x=g.priorityLevel;var O=ee(g.expirationTime<=ne);ne=t.unstable_now(),typeof O=="function"?g.callback=O:g===r(u)&&n(u),N(ne)}else n(u);g=r(u)}if(g!==null)var te=!0;else{var J=r(h);J!==null&&Le(V,J.startTime-ne),te=!1}return te}finally{g=null,x=we,_=!1}}var j=!1,A=null,F=-1,I=5,U=-1;function L(){return!(t.unstable_now()-U<I)}function D(){if(A!==null){var Ae=t.unstable_now();U=Ae;var ne=!0;try{ne=A(!0,Ae)}finally{ne?B():(j=!1,A=null)}}else j=!1}var B;if(typeof M=="function")B=function(){M(D)};else if(typeof MessageChannel<"u"){var De=new MessageChannel,Re=De.port2;De.port1.onmessage=D,B=function(){Re.postMessage(null)}}else B=function(){S(D,0)};function Ve(Ae){A=Ae,j||(j=!0,B())}function Le(Ae,ne){F=S(function(){Ae(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ae){Ae.callback=null},t.unstable_continueExecution=function(){k||_||(k=!0,Ve(W))},t.unstable_forceFrameRate=function(Ae){0>Ae||125<Ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Ae?Math.floor(1e3/Ae):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(Ae){switch(x){case 1:case 2:case 3:var ne=3;break;default:ne=x}var we=x;x=ne;try{return Ae()}finally{x=we}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ae,ne){switch(Ae){case 1:case 2:case 3:case 4:case 5:break;default:Ae=3}var we=x;x=Ae;try{return ne()}finally{x=we}},t.unstable_scheduleCallback=function(Ae,ne,we){var ee=t.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?ee+we:ee):we=ee,Ae){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=we+O,Ae={id:d++,callback:ne,priorityLevel:Ae,startTime:we,expirationTime:O,sortIndex:-1},we>ee?(Ae.sortIndex=we,e(h,Ae),r(u)===null&&Ae===r(h)&&(y?(R(F),F=-1):y=!0,Le(V,we-ee))):(Ae.sortIndex=O,e(u,Ae),k||_||(k=!0,Ve(W))),Ae},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(Ae){var ne=x;return function(){var we=x;x=ne;try{return Ae.apply(this,arguments)}finally{x=we}}}})(cm)),cm}var V_;function PA(){return V_||(V_=1,lm.exports=DA()),lm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B_;function OA(){if(B_)return ms;B_=1;var t=Ng(),e=PA();function r(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function i(a,l){o(a,l),o(a+"Capture",l)}function o(a,l){for(s[a]=l,a=0;a<l.length;a++)n.add(l[a])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},g={};function x(a){return u.call(g,a)?!0:u.call(d,a)?!1:h.test(a)?g[a]=!0:(d[a]=!0,!1)}function _(a,l,f,m){if(f!==null&&f.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return m?!1:f!==null?!f.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function k(a,l,f,m){if(l===null||typeof l>"u"||_(a,l,f,m))return!0;if(m)return!1;if(f!==null)switch(f.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function y(a,l,f,m,v,E,b){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=m,this.attributeNamespace=v,this.mustUseProperty=f,this.propertyName=a,this.type=l,this.sanitizeURL=E,this.removeEmptyString=b}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){S[a]=new y(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var l=a[0];S[l]=new y(l,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){S[a]=new y(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){S[a]=new y(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){S[a]=new y(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){S[a]=new y(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){S[a]=new y(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){S[a]=new y(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){S[a]=new y(a,5,!1,a.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function M(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var l=a.replace(R,M);S[l]=new y(l,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var l=a.replace(R,M);S[l]=new y(l,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var l=a.replace(R,M);S[l]=new y(l,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){S[a]=new y(a,1,!1,a.toLowerCase(),null,!1,!1)}),S.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){S[a]=new y(a,1,!1,a.toLowerCase(),null,!0,!0)});function N(a,l,f,m){var v=S.hasOwnProperty(l)?S[l]:null;(v!==null?v.type!==0:m||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(k(l,f,v,m)&&(f=null),m||v===null?x(l)&&(f===null?a.removeAttribute(l):a.setAttribute(l,""+f)):v.mustUseProperty?a[v.propertyName]=f===null?v.type===3?!1:"":f:(l=v.attributeName,m=v.attributeNamespace,f===null?a.removeAttribute(l):(v=v.type,f=v===3||v===4&&f===!0?"":""+f,m?a.setAttributeNS(m,l,f):a.setAttribute(l,f))))}var V=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,W=Symbol.for("react.element"),j=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),L=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),De=Symbol.for("react.suspense_list"),Re=Symbol.for("react.memo"),Ve=Symbol.for("react.lazy"),Le=Symbol.for("react.offscreen"),Ae=Symbol.iterator;function ne(a){return a===null||typeof a!="object"?null:(a=Ae&&a[Ae]||a["@@iterator"],typeof a=="function"?a:null)}var we=Object.assign,ee;function O(a){if(ee===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);ee=l&&l[1]||""}return`
`+ee+a}var te=!1;function J(a,l){if(!a||te)return"";te=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(de){var m=de}Reflect.construct(a,[],l)}else{try{l.call()}catch(de){m=de}a.call(l.prototype)}else{try{throw Error()}catch(de){m=de}a()}}catch(de){if(de&&m&&typeof de.stack=="string"){for(var v=de.stack.split(`
`),E=m.stack.split(`
`),b=v.length-1,Q=E.length-1;1<=b&&0<=Q&&v[b]!==E[Q];)Q--;for(;1<=b&&0<=Q;b--,Q--)if(v[b]!==E[Q]){if(b!==1||Q!==1)do if(b--,Q--,0>Q||v[b]!==E[Q]){var re=`
`+v[b].replace(" at new "," at ");return a.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",a.displayName)),re}while(1<=b&&0<=Q);break}}}finally{te=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?O(a):""}function Z(a){switch(a.tag){case 5:return O(a.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return a=J(a.type,!1),a;case 11:return a=J(a.type.render,!1),a;case 1:return a=J(a.type,!0),a;default:return""}}function oe(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case A:return"Fragment";case j:return"Portal";case I:return"Profiler";case F:return"StrictMode";case B:return"Suspense";case De:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case L:return(a.displayName||"Context")+".Consumer";case U:return(a._context.displayName||"Context")+".Provider";case D:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Re:return l=a.displayName||null,l!==null?l:oe(a.type)||"Memo";case Ve:l=a._payload,a=a._init;try{return oe(a(l))}catch{}}return null}function _e(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oe(l);case 8:return l===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ve(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function xe(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Te(a){var l=xe(a)?"checked":"value",f=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),m=""+a[l];if(!a.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var v=f.get,E=f.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return v.call(this)},set:function(b){m=""+b,E.call(this,b)}}),Object.defineProperty(a,l,{enumerable:f.enumerable}),{getValue:function(){return m},setValue:function(b){m=""+b},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function ut(a){a._valueTracker||(a._valueTracker=Te(a))}function Y(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var f=l.getValue(),m="";return a&&(m=xe(a)?a.checked?"true":"false":a.value),a=m,a!==f?(l.setValue(a),!0):!1}function At(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function wt(a,l){var f=l.checked;return we({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??a._wrapperState.initialChecked})}function Lt(a,l){var f=l.defaultValue==null?"":l.defaultValue,m=l.checked!=null?l.checked:l.defaultChecked;f=ve(l.value!=null?l.value:f),a._wrapperState={initialChecked:m,initialValue:f,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function xt(a,l){l=l.checked,l!=null&&N(a,"checked",l,!1)}function je(a,l){xt(a,l);var f=ve(l.value),m=l.type;if(f!=null)m==="number"?(f===0&&a.value===""||a.value!=f)&&(a.value=""+f):a.value!==""+f&&(a.value=""+f);else if(m==="submit"||m==="reset"){a.removeAttribute("value");return}l.hasOwnProperty("value")?Mt(a,l.type,f):l.hasOwnProperty("defaultValue")&&Mt(a,l.type,ve(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(a.defaultChecked=!!l.defaultChecked)}function Zt(a,l,f){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var m=l.type;if(!(m!=="submit"&&m!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+a._wrapperState.initialValue,f||l===a.value||(a.value=l),a.defaultValue=l}f=a.name,f!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,f!==""&&(a.name=f)}function Mt(a,l,f){(l!=="number"||At(a.ownerDocument)!==a)&&(f==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+f&&(a.defaultValue=""+f))}var Bt=Array.isArray;function xr(a,l,f,m){if(a=a.options,l){l={};for(var v=0;v<f.length;v++)l["$"+f[v]]=!0;for(f=0;f<a.length;f++)v=l.hasOwnProperty("$"+a[f].value),a[f].selected!==v&&(a[f].selected=v),v&&m&&(a[f].defaultSelected=!0)}else{for(f=""+ve(f),l=null,v=0;v<a.length;v++){if(a[v].value===f){a[v].selected=!0,m&&(a[v].defaultSelected=!0);return}l!==null||a[v].disabled||(l=a[v])}l!==null&&(l.selected=!0)}}function Tn(a,l){if(l.dangerouslySetInnerHTML!=null)throw Error(r(91));return we({},l,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function Sn(a,l){var f=l.value;if(f==null){if(f=l.children,l=l.defaultValue,f!=null){if(l!=null)throw Error(r(92));if(Bt(f)){if(1<f.length)throw Error(r(93));f=f[0]}l=f}l==null&&(l=""),f=l}a._wrapperState={initialValue:ve(f)}}function _r(a,l){var f=ve(l.value),m=ve(l.defaultValue);f!=null&&(f=""+f,f!==a.value&&(a.value=f),l.defaultValue==null&&a.defaultValue!==f&&(a.defaultValue=f)),m!=null&&(a.defaultValue=""+m)}function Rr(a){var l=a.textContent;l===a._wrapperState.initialValue&&l!==""&&l!==null&&(a.value=l)}function qn(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function as(a,l){return a==null||a==="http://www.w3.org/1999/xhtml"?qn(l):a==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var or,Zr=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,f,m,v){MSApp.execUnsafeLocalFunction(function(){return a(l,f,m,v)})}:a})(function(a,l){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=l;else{for(or=or||document.createElement("div"),or.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=or.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}});function ot(a,l){if(l){var f=a.firstChild;if(f&&f===a.lastChild&&f.nodeType===3){f.nodeValue=l;return}}a.textContent=l}var jt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gr=["Webkit","ms","Moz","O"];Object.keys(jt).forEach(function(a){Gr.forEach(function(l){l=l+a.charAt(0).toUpperCase()+a.substring(1),jt[l]=jt[a]})});function Yt(a,l,f){return l==null||typeof l=="boolean"||l===""?"":f||typeof l!="number"||l===0||jt.hasOwnProperty(a)&&jt[a]?(""+l).trim():l+"px"}function kn(a,l){a=a.style;for(var f in l)if(l.hasOwnProperty(f)){var m=f.indexOf("--")===0,v=Yt(f,l[f],m);f==="float"&&(f="cssFloat"),m?a.setProperty(f,v):a[f]=v}}var ni=we({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Kn(a,l){if(l){if(ni[a]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(r(137,a));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(r(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(r(61))}if(l.style!=null&&typeof l.style!="object")throw Error(r(62))}}function si(a,l){if(a.indexOf("-")===-1)return typeof l.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ws=null;function Vs(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Qe=null,Xn=null,Rt=null;function qr(a){if(a=du(a)){if(typeof Qe!="function")throw Error(r(280));var l=a.stateNode;l&&(l=uh(l),Qe(a.stateNode,a.type,l))}}function An(a){Xn?Rt?Rt.push(a):Rt=[a]:Xn=a}function Bs(){if(Xn){var a=Xn,l=Rt;if(Rt=Xn=null,qr(a),l)for(a=0;a<l.length;a++)qr(l[a])}}function Yn(a,l){return a(l)}function ba(){}var ln=!1;function Qn(a,l,f){if(ln)return a(l,f);ln=!0;try{return Yn(a,l,f)}finally{ln=!1,(Xn!==null||Rt!==null)&&(ba(),Bs())}}function cn(a,l){var f=a.stateNode;if(f===null)return null;var m=uh(f);if(m===null)return null;f=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break e;default:a=!1}if(a)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var os=!1;if(c)try{var Cn={};Object.defineProperty(Cn,"passive",{get:function(){os=!0}}),window.addEventListener("test",Cn,Cn),window.removeEventListener("test",Cn,Cn)}catch{os=!1}function Da(a,l,f,m,v,E,b,Q,re){var de=Array.prototype.slice.call(arguments,3);try{l.apply(f,de)}catch(be){this.onError(be)}}var Es=!1,ls=null,P=!1,q=null,H={onError:function(a){Es=!0,ls=a}};function G(a,l,f,m,v,E,b,Q,re){Es=!1,ls=null,Da.apply(H,arguments)}function K(a,l,f,m,v,E,b,Q,re){if(G.apply(this,arguments),Es){if(Es){var de=ls;Es=!1,ls=null}else throw Error(r(198));P||(P=!0,q=de)}}function X(a){var l=a,f=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(f=l.return),a=l.return;while(a)}return l.tag===3?f:null}function ce(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function me(a){if(X(a)!==a)throw Error(r(188))}function le(a){var l=a.alternate;if(!l){if(l=X(a),l===null)throw Error(r(188));return l!==a?null:a}for(var f=a,m=l;;){var v=f.return;if(v===null)break;var E=v.alternate;if(E===null){if(m=v.return,m!==null){f=m;continue}break}if(v.child===E.child){for(E=v.child;E;){if(E===f)return me(v),a;if(E===m)return me(v),l;E=E.sibling}throw Error(r(188))}if(f.return!==m.return)f=v,m=E;else{for(var b=!1,Q=v.child;Q;){if(Q===f){b=!0,f=v,m=E;break}if(Q===m){b=!0,m=v,f=E;break}Q=Q.sibling}if(!b){for(Q=E.child;Q;){if(Q===f){b=!0,f=E,m=v;break}if(Q===m){b=!0,m=E,f=v;break}Q=Q.sibling}if(!b)throw Error(r(189))}}if(f.alternate!==m)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?a:l}function ue(a){return a=le(a),a!==null?fe(a):null}function fe(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=fe(a);if(l!==null)return l;a=a.sibling}return null}var Ne=e.unstable_scheduleCallback,Ue=e.unstable_cancelCallback,Ge=e.unstable_shouldYield,Oe=e.unstable_requestPaint,Pe=e.unstable_now,ft=e.unstable_getCurrentPriorityLevel,$t=e.unstable_ImmediatePriority,Qt=e.unstable_UserBlockingPriority,lr=e.unstable_NormalPriority,Ts=e.unstable_LowPriority,cs=e.unstable_IdlePriority,Jn=null,Se=null;function Ie(a){if(Se&&typeof Se.onCommitFiberRoot=="function")try{Se.onCommitFiberRoot(Jn,a,void 0,(a.current.flags&128)===128)}catch{}}var ze=Math.clz32?Math.clz32:Nt,qe=Math.log,rt=Math.LN2;function Nt(a){return a>>>=0,a===0?32:31-(qe(a)/rt|0)|0}var Gt=64,Us=4194304;function bt(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function un(a,l){var f=a.pendingLanes;if(f===0)return 0;var m=0,v=a.suspendedLanes,E=a.pingedLanes,b=f&268435455;if(b!==0){var Q=b&~v;Q!==0?m=bt(Q):(E&=b,E!==0&&(m=bt(E)))}else b=f&~v,b!==0?m=bt(b):E!==0&&(m=bt(E));if(m===0)return 0;if(l!==0&&l!==m&&(l&v)===0&&(v=m&-m,E=l&-l,v>=E||v===16&&(E&4194240)!==0))return l;if((m&4)!==0&&(m|=f&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=m;0<l;)f=31-ze(l),v=1<<f,m|=a[f],l&=~v;return m}function fn(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ji(a,l){for(var f=a.suspendedLanes,m=a.pingedLanes,v=a.expirationTimes,E=a.pendingLanes;0<E;){var b=31-ze(E),Q=1<<b,re=v[b];re===-1?((Q&f)===0||(Q&m)!==0)&&(v[b]=fn(Q,l)):re<=l&&(a.expiredLanes|=Q),E&=~Q}}function Gc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function qc(){var a=Gt;return Gt<<=1,(Gt&4194240)===0&&(Gt=64),a}function Kc(a){for(var l=[],f=0;31>f;f++)l.push(a);return l}function No(a,l,f){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-ze(l),a[l]=f}function Ld(a,l){var f=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var m=a.eventTimes;for(a=a.expirationTimes;0<f;){var v=31-ze(f),E=1<<v;l[v]=0,m[v]=-1,a[v]=-1,f&=~E}}function Xc(a,l){var f=a.entangledLanes|=l;for(a=a.entanglements;f;){var m=31-ze(f),v=1<<m;v&l|a[m]&l&&(a[m]|=l),f&=~v}}var Vt=0;function wi(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Yc,Il,Qc,Jc,Zc,Ei=!1,Fl=[],Ti=null,Si=null,hn=null,bo=new Map,Zi=new Map,Ss=[],Kf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pa(a,l){switch(a){case"focusin":case"focusout":Ti=null;break;case"dragenter":case"dragleave":Si=null;break;case"mouseover":case"mouseout":hn=null;break;case"pointerover":case"pointerout":bo.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zi.delete(l.pointerId)}}function ii(a,l,f,m,v,E){return a===null||a.nativeEvent!==E?(a={blockedOn:l,domEventName:f,eventSystemFlags:m,nativeEvent:E,targetContainers:[v]},l!==null&&(l=du(l),l!==null&&Il(l)),a):(a.eventSystemFlags|=m,l=a.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),a)}function Xf(a,l,f,m,v){switch(l){case"focusin":return Ti=ii(Ti,a,l,f,m,v),!0;case"dragenter":return Si=ii(Si,a,l,f,m,v),!0;case"mouseover":return hn=ii(hn,a,l,f,m,v),!0;case"pointerover":var E=v.pointerId;return bo.set(E,ii(bo.get(E)||null,a,l,f,m,v)),!0;case"gotpointercapture":return E=v.pointerId,Zi.set(E,ii(Zi.get(E)||null,a,l,f,m,v)),!0}return!1}function Rl(a){var l=Lo(a.target);if(l!==null){var f=X(l);if(f!==null){if(l=f.tag,l===13){if(l=ce(f),l!==null){a.blockedOn=l,Zc(a.priority,function(){Qc(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){a.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}a.blockedOn=null}function ar(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var f=Nl(a.domEventName,a.eventSystemFlags,l[0],a.nativeEvent);if(f===null){f=a.nativeEvent;var m=new f.constructor(f.type,f);ws=m,f.target.dispatchEvent(m),ws=null}else return l=du(f),l!==null&&Il(l),a.blockedOn=f,!1;l.shift()}return!0}function Yf(a,l,f){ar(a)&&f.delete(l)}function Md(){Ei=!1,Ti!==null&&ar(Ti)&&(Ti=null),Si!==null&&ar(Si)&&(Si=null),hn!==null&&ar(hn)&&(hn=null),bo.forEach(Yf),Zi.forEach(Yf)}function Oa(a,l){a.blockedOn===l&&(a.blockedOn=null,Ei||(Ei=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Md)))}function La(a){function l(v){return Oa(v,a)}if(0<Fl.length){Oa(Fl[0],a);for(var f=1;f<Fl.length;f++){var m=Fl[f];m.blockedOn===a&&(m.blockedOn=null)}}for(Ti!==null&&Oa(Ti,a),Si!==null&&Oa(Si,a),hn!==null&&Oa(hn,a),bo.forEach(l),Zi.forEach(l),f=0;f<Ss.length;f++)m=Ss[f],m.blockedOn===a&&(m.blockedOn=null);for(;0<Ss.length&&(f=Ss[0],f.blockedOn===null);)Rl(f),f.blockedOn===null&&Ss.shift()}var ea=V.ReactCurrentBatchConfig,ta=!0;function ki(a,l,f,m){var v=Vt,E=ea.transition;ea.transition=null;try{Vt=1,eu(a,l,f,m)}finally{Vt=v,ea.transition=E}}function Qf(a,l,f,m){var v=Vt,E=ea.transition;ea.transition=null;try{Vt=4,eu(a,l,f,m)}finally{Vt=v,ea.transition=E}}function eu(a,l,f,m){if(ta){var v=Nl(a,l,f,m);if(v===null)Kd(a,l,m,Ai,f),Pa(a,m);else if(Xf(v,a,l,f,m))m.stopPropagation();else if(Pa(a,m),l&4&&-1<Kf.indexOf(a)){for(;v!==null;){var E=du(v);if(E!==null&&Yc(E),E=Nl(a,l,f,m),E===null&&Kd(a,l,m,Ai,f),E===v)break;v=E}v!==null&&m.stopPropagation()}else Kd(a,l,m,null,f)}}var Ai=null;function Nl(a,l,f,m){if(Ai=null,a=Vs(m),a=Lo(a),a!==null)if(l=X(a),l===null)a=null;else if(f=l.tag,f===13){if(a=ce(l),a!==null)return a;a=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null);return Ai=a,null}function bl(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ft()){case $t:return 1;case Qt:return 4;case lr:case Ts:return 16;case cs:return 536870912;default:return 16}default:return 16}}var ks=null,Dl=null,ra=null;function Jf(){if(ra)return ra;var a,l=Dl,f=l.length,m,v="value"in ks?ks.value:ks.textContent,E=v.length;for(a=0;a<f&&l[a]===v[a];a++);var b=f-a;for(m=1;m<=b&&l[f-m]===v[E-m];m++);return ra=v.slice(a,1<m?1-m:void 0)}function Do(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function Ci(){return!0}function tu(){return!1}function In(a){function l(f,m,v,E,b){this._reactName=f,this._targetInst=v,this.type=m,this.nativeEvent=E,this.target=b,this.currentTarget=null;for(var Q in a)a.hasOwnProperty(Q)&&(f=a[Q],this[Q]=f?f(E):E[Q]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?Ci:tu,this.isPropagationStopped=tu,this}return we(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Ci)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Ci)},persist:function(){},isPersistent:Ci}),l}var Ii={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Po=In(Ii),Ma=we({},Ii,{view:0,detail:0}),Pl=In(Ma),Ol,Ll,As,Oo=we({},Ma,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_t,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==As&&(As&&a.type==="mousemove"?(Ol=a.screenX-As.screenX,Ll=a.screenY-As.screenY):Ll=Ol=0,As=a),Ol)},movementY:function(a){return"movementY"in a?a.movementY:Ll}}),ru=In(Oo),Zf=we({},Oo,{dataTransfer:0}),eh=In(Zf),Ml=we({},Ma,{relatedTarget:0}),dn=In(Ml),th=we({},Ii,{animationName:0,elapsedTime:0,pseudoElement:0}),rh=In(th),Va=we({},Ii,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),p=In(Va),T=we({},Ii,{data:0}),C=In(T),z={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ae={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $e(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=pe[a])?!!l[a]:!1}function _t(){return $e}var Nr=we({},Ma,{key:function(a){if(a.key){var l=z[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Do(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?ae[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_t,charCode:function(a){return a.type==="keypress"?Do(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Do(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),er=In(Nr),Mr=we({},Oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cs=In(Mr),na=we({},Ma,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_t}),Fi=In(na),Ri=we({},Ii,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vl=In(Ri),nu=we({},Oo,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),E4=In(nu),T4=[9,13,27,32],Vd=c&&"CompositionEvent"in window,su=null;c&&"documentMode"in document&&(su=document.documentMode);var S4=c&&"TextEvent"in window&&!su,kx=c&&(!Vd||su&&8<su&&11>=su),Ax=" ",Cx=!1;function Ix(a,l){switch(a){case"keyup":return T4.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fx(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Bl=!1;function k4(a,l){switch(a){case"compositionend":return Fx(l);case"keypress":return l.which!==32?null:(Cx=!0,Ax);case"textInput":return a=l.data,a===Ax&&Cx?null:a;default:return null}}function A4(a,l){if(Bl)return a==="compositionend"||!Vd&&Ix(a,l)?(a=Jf(),ra=Dl=ks=null,Bl=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return kx&&l.locale!=="ko"?null:l.data;default:return null}}var C4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rx(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!C4[a.type]:l==="textarea"}function Nx(a,l,f,m){An(m),l=oh(l,"onChange"),0<l.length&&(f=new Po("onChange","change",null,f,m),a.push({event:f,listeners:l}))}var iu=null,au=null;function I4(a){Xx(a,0)}function nh(a){var l=Wl(a);if(Y(l))return a}function F4(a,l){if(a==="change")return l}var bx=!1;if(c){var Bd;if(c){var Ud="oninput"in document;if(!Ud){var Dx=document.createElement("div");Dx.setAttribute("oninput","return;"),Ud=typeof Dx.oninput=="function"}Bd=Ud}else Bd=!1;bx=Bd&&(!document.documentMode||9<document.documentMode)}function Px(){iu&&(iu.detachEvent("onpropertychange",Ox),au=iu=null)}function Ox(a){if(a.propertyName==="value"&&nh(au)){var l=[];Nx(l,au,a,Vs(a)),Qn(I4,l)}}function R4(a,l,f){a==="focusin"?(Px(),iu=l,au=f,iu.attachEvent("onpropertychange",Ox)):a==="focusout"&&Px()}function N4(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return nh(au)}function b4(a,l){if(a==="click")return nh(l)}function D4(a,l){if(a==="input"||a==="change")return nh(l)}function P4(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var ai=typeof Object.is=="function"?Object.is:P4;function ou(a,l){if(ai(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var f=Object.keys(a),m=Object.keys(l);if(f.length!==m.length)return!1;for(m=0;m<f.length;m++){var v=f[m];if(!u.call(l,v)||!ai(a[v],l[v]))return!1}return!0}function Lx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Mx(a,l){var f=Lx(a);a=0;for(var m;f;){if(f.nodeType===3){if(m=a+f.textContent.length,a<=l&&m>=l)return{node:f,offset:l-a};a=m}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Lx(f)}}function Vx(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Vx(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function Bx(){for(var a=window,l=At();l instanceof a.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)a=l.contentWindow;else break;l=At(a.document)}return l}function jd(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function O4(a){var l=Bx(),f=a.focusedElem,m=a.selectionRange;if(l!==f&&f&&f.ownerDocument&&Vx(f.ownerDocument.documentElement,f)){if(m!==null&&jd(f)){if(l=m.start,a=m.end,a===void 0&&(a=l),"selectionStart"in f)f.selectionStart=l,f.selectionEnd=Math.min(a,f.value.length);else if(a=(l=f.ownerDocument||document)&&l.defaultView||window,a.getSelection){a=a.getSelection();var v=f.textContent.length,E=Math.min(m.start,v);m=m.end===void 0?E:Math.min(m.end,v),!a.extend&&E>m&&(v=m,m=E,E=v),v=Mx(f,E);var b=Mx(f,m);v&&b&&(a.rangeCount!==1||a.anchorNode!==v.node||a.anchorOffset!==v.offset||a.focusNode!==b.node||a.focusOffset!==b.offset)&&(l=l.createRange(),l.setStart(v.node,v.offset),a.removeAllRanges(),E>m?(a.addRange(l),a.extend(b.node,b.offset)):(l.setEnd(b.node,b.offset),a.addRange(l)))}}for(l=[],a=f;a=a.parentNode;)a.nodeType===1&&l.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<l.length;f++)a=l[f],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var L4=c&&"documentMode"in document&&11>=document.documentMode,Ul=null,zd=null,lu=null,Hd=!1;function Ux(a,l,f){var m=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Hd||Ul==null||Ul!==At(m)||(m=Ul,"selectionStart"in m&&jd(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),lu&&ou(lu,m)||(lu=m,m=oh(zd,"onSelect"),0<m.length&&(l=new Po("onSelect","select",null,l,f),a.push({event:l,listeners:m}),l.target=Ul)))}function sh(a,l){var f={};return f[a.toLowerCase()]=l.toLowerCase(),f["Webkit"+a]="webkit"+l,f["Moz"+a]="moz"+l,f}var jl={animationend:sh("Animation","AnimationEnd"),animationiteration:sh("Animation","AnimationIteration"),animationstart:sh("Animation","AnimationStart"),transitionend:sh("Transition","TransitionEnd")},Wd={},jx={};c&&(jx=document.createElement("div").style,"AnimationEvent"in window||(delete jl.animationend.animation,delete jl.animationiteration.animation,delete jl.animationstart.animation),"TransitionEvent"in window||delete jl.transitionend.transition);function ih(a){if(Wd[a])return Wd[a];if(!jl[a])return a;var l=jl[a],f;for(f in l)if(l.hasOwnProperty(f)&&f in jx)return Wd[a]=l[f];return a}var zx=ih("animationend"),Hx=ih("animationiteration"),Wx=ih("animationstart"),$x=ih("transitionend"),Gx=new Map,qx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ba(a,l){Gx.set(a,l),i(l,[a])}for(var $d=0;$d<qx.length;$d++){var Gd=qx[$d],M4=Gd.toLowerCase(),V4=Gd[0].toUpperCase()+Gd.slice(1);Ba(M4,"on"+V4)}Ba(zx,"onAnimationEnd"),Ba(Hx,"onAnimationIteration"),Ba(Wx,"onAnimationStart"),Ba("dblclick","onDoubleClick"),Ba("focusin","onFocus"),Ba("focusout","onBlur"),Ba($x,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B4=new Set("cancel close invalid load scroll toggle".split(" ").concat(cu));function Kx(a,l,f){var m=a.type||"unknown-event";a.currentTarget=f,K(m,l,void 0,a),a.currentTarget=null}function Xx(a,l){l=(l&4)!==0;for(var f=0;f<a.length;f++){var m=a[f],v=m.event;m=m.listeners;e:{var E=void 0;if(l)for(var b=m.length-1;0<=b;b--){var Q=m[b],re=Q.instance,de=Q.currentTarget;if(Q=Q.listener,re!==E&&v.isPropagationStopped())break e;Kx(v,Q,de),E=re}else for(b=0;b<m.length;b++){if(Q=m[b],re=Q.instance,de=Q.currentTarget,Q=Q.listener,re!==E&&v.isPropagationStopped())break e;Kx(v,Q,de),E=re}}}if(P)throw a=q,P=!1,q=null,a}function fr(a,l){var f=l[ep];f===void 0&&(f=l[ep]=new Set);var m=a+"__bubble";f.has(m)||(Yx(l,a,2,!1),f.add(m))}function qd(a,l,f){var m=0;l&&(m|=4),Yx(f,a,m,l)}var ah="_reactListening"+Math.random().toString(36).slice(2);function uu(a){if(!a[ah]){a[ah]=!0,n.forEach(function(f){f!=="selectionchange"&&(B4.has(f)||qd(f,!1,a),qd(f,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[ah]||(l[ah]=!0,qd("selectionchange",!1,l))}}function Yx(a,l,f,m){switch(bl(l)){case 1:var v=ki;break;case 4:v=Qf;break;default:v=eu}f=v.bind(null,l,f,a),v=void 0,!os||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),m?v!==void 0?a.addEventListener(l,f,{capture:!0,passive:v}):a.addEventListener(l,f,!0):v!==void 0?a.addEventListener(l,f,{passive:v}):a.addEventListener(l,f,!1)}function Kd(a,l,f,m,v){var E=m;if((l&1)===0&&(l&2)===0&&m!==null)e:for(;;){if(m===null)return;var b=m.tag;if(b===3||b===4){var Q=m.stateNode.containerInfo;if(Q===v||Q.nodeType===8&&Q.parentNode===v)break;if(b===4)for(b=m.return;b!==null;){var re=b.tag;if((re===3||re===4)&&(re=b.stateNode.containerInfo,re===v||re.nodeType===8&&re.parentNode===v))return;b=b.return}for(;Q!==null;){if(b=Lo(Q),b===null)return;if(re=b.tag,re===5||re===6){m=E=b;continue e}Q=Q.parentNode}}m=m.return}Qn(function(){var de=E,be=Vs(f),Me=[];e:{var Fe=Gx.get(a);if(Fe!==void 0){var Xe=Po,Ze=a;switch(a){case"keypress":if(Do(f)===0)break e;case"keydown":case"keyup":Xe=er;break;case"focusin":Ze="focus",Xe=dn;break;case"focusout":Ze="blur",Xe=dn;break;case"beforeblur":case"afterblur":Xe=dn;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Xe=ru;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Xe=eh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Xe=Fi;break;case zx:case Hx:case Wx:Xe=rh;break;case $x:Xe=Vl;break;case"scroll":Xe=Pl;break;case"wheel":Xe=E4;break;case"copy":case"cut":case"paste":Xe=p;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Xe=Cs}var et=(l&4)!==0,br=!et&&a==="scroll",ie=et?Fe!==null?Fe+"Capture":null:Fe;et=[];for(var se=de,he;se!==null;){he=se;var Be=he.stateNode;if(he.tag===5&&Be!==null&&(he=Be,ie!==null&&(Be=cn(se,ie),Be!=null&&et.push(fu(se,Be,he)))),br)break;se=se.return}0<et.length&&(Fe=new Xe(Fe,Ze,null,f,be),Me.push({event:Fe,listeners:et}))}}if((l&7)===0){e:{if(Fe=a==="mouseover"||a==="pointerover",Xe=a==="mouseout"||a==="pointerout",Fe&&f!==ws&&(Ze=f.relatedTarget||f.fromElement)&&(Lo(Ze)||Ze[sa]))break e;if((Xe||Fe)&&(Fe=be.window===be?be:(Fe=be.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,Xe?(Ze=f.relatedTarget||f.toElement,Xe=de,Ze=Ze?Lo(Ze):null,Ze!==null&&(br=X(Ze),Ze!==br||Ze.tag!==5&&Ze.tag!==6)&&(Ze=null)):(Xe=null,Ze=de),Xe!==Ze)){if(et=ru,Be="onMouseLeave",ie="onMouseEnter",se="mouse",(a==="pointerout"||a==="pointerover")&&(et=Cs,Be="onPointerLeave",ie="onPointerEnter",se="pointer"),br=Xe==null?Fe:Wl(Xe),he=Ze==null?Fe:Wl(Ze),Fe=new et(Be,se+"leave",Xe,f,be),Fe.target=br,Fe.relatedTarget=he,Be=null,Lo(be)===de&&(et=new et(ie,se+"enter",Ze,f,be),et.target=he,et.relatedTarget=br,Be=et),br=Be,Xe&&Ze)t:{for(et=Xe,ie=Ze,se=0,he=et;he;he=zl(he))se++;for(he=0,Be=ie;Be;Be=zl(Be))he++;for(;0<se-he;)et=zl(et),se--;for(;0<he-se;)ie=zl(ie),he--;for(;se--;){if(et===ie||ie!==null&&et===ie.alternate)break t;et=zl(et),ie=zl(ie)}et=null}else et=null;Xe!==null&&Qx(Me,Fe,Xe,et,!1),Ze!==null&&br!==null&&Qx(Me,br,Ze,et,!0)}}e:{if(Fe=de?Wl(de):window,Xe=Fe.nodeName&&Fe.nodeName.toLowerCase(),Xe==="select"||Xe==="input"&&Fe.type==="file")var tt=F4;else if(Rx(Fe))if(bx)tt=D4;else{tt=N4;var it=R4}else(Xe=Fe.nodeName)&&Xe.toLowerCase()==="input"&&(Fe.type==="checkbox"||Fe.type==="radio")&&(tt=b4);if(tt&&(tt=tt(a,de))){Nx(Me,tt,f,be);break e}it&&it(a,Fe,de),a==="focusout"&&(it=Fe._wrapperState)&&it.controlled&&Fe.type==="number"&&Mt(Fe,"number",Fe.value)}switch(it=de?Wl(de):window,a){case"focusin":(Rx(it)||it.contentEditable==="true")&&(Ul=it,zd=de,lu=null);break;case"focusout":lu=zd=Ul=null;break;case"mousedown":Hd=!0;break;case"contextmenu":case"mouseup":case"dragend":Hd=!1,Ux(Me,f,be);break;case"selectionchange":if(L4)break;case"keydown":case"keyup":Ux(Me,f,be)}var at;if(Vd)e:{switch(a){case"compositionstart":var mt="onCompositionStart";break e;case"compositionend":mt="onCompositionEnd";break e;case"compositionupdate":mt="onCompositionUpdate";break e}mt=void 0}else Bl?Ix(a,f)&&(mt="onCompositionEnd"):a==="keydown"&&f.keyCode===229&&(mt="onCompositionStart");mt&&(kx&&f.locale!=="ko"&&(Bl||mt!=="onCompositionStart"?mt==="onCompositionEnd"&&Bl&&(at=Jf()):(ks=be,Dl="value"in ks?ks.value:ks.textContent,Bl=!0)),it=oh(de,mt),0<it.length&&(mt=new C(mt,a,null,f,be),Me.push({event:mt,listeners:it}),at?mt.data=at:(at=Fx(f),at!==null&&(mt.data=at)))),(at=S4?k4(a,f):A4(a,f))&&(de=oh(de,"onBeforeInput"),0<de.length&&(be=new C("onBeforeInput","beforeinput",null,f,be),Me.push({event:be,listeners:de}),be.data=at))}Xx(Me,l)})}function fu(a,l,f){return{instance:a,listener:l,currentTarget:f}}function oh(a,l){for(var f=l+"Capture",m=[];a!==null;){var v=a,E=v.stateNode;v.tag===5&&E!==null&&(v=E,E=cn(a,f),E!=null&&m.unshift(fu(a,E,v)),E=cn(a,l),E!=null&&m.push(fu(a,E,v))),a=a.return}return m}function zl(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function Qx(a,l,f,m,v){for(var E=l._reactName,b=[];f!==null&&f!==m;){var Q=f,re=Q.alternate,de=Q.stateNode;if(re!==null&&re===m)break;Q.tag===5&&de!==null&&(Q=de,v?(re=cn(f,E),re!=null&&b.unshift(fu(f,re,Q))):v||(re=cn(f,E),re!=null&&b.push(fu(f,re,Q)))),f=f.return}b.length!==0&&a.push({event:l,listeners:b})}var U4=/\r\n?/g,j4=/\u0000|\uFFFD/g;function Jx(a){return(typeof a=="string"?a:""+a).replace(U4,`
`).replace(j4,"")}function lh(a,l,f){if(l=Jx(l),Jx(a)!==l&&f)throw Error(r(425))}function ch(){}var Xd=null,Yd=null;function Qd(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Jd=typeof setTimeout=="function"?setTimeout:void 0,z4=typeof clearTimeout=="function"?clearTimeout:void 0,Zx=typeof Promise=="function"?Promise:void 0,H4=typeof queueMicrotask=="function"?queueMicrotask:typeof Zx<"u"?function(a){return Zx.resolve(null).then(a).catch(W4)}:Jd;function W4(a){setTimeout(function(){throw a})}function Zd(a,l){var f=l,m=0;do{var v=f.nextSibling;if(a.removeChild(f),v&&v.nodeType===8)if(f=v.data,f==="/$"){if(m===0){a.removeChild(v),La(l);return}m--}else f!=="$"&&f!=="$?"&&f!=="$!"||m++;f=v}while(f);La(l)}function Ua(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return a}function ev(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var f=a.data;if(f==="$"||f==="$!"||f==="$?"){if(l===0)return a;l--}else f==="/$"&&l++}a=a.previousSibling}return null}var Hl=Math.random().toString(36).slice(2),Ni="__reactFiber$"+Hl,hu="__reactProps$"+Hl,sa="__reactContainer$"+Hl,ep="__reactEvents$"+Hl,$4="__reactListeners$"+Hl,G4="__reactHandles$"+Hl;function Lo(a){var l=a[Ni];if(l)return l;for(var f=a.parentNode;f;){if(l=f[sa]||f[Ni]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(a=ev(a);a!==null;){if(f=a[Ni])return f;a=ev(a)}return l}a=f,f=a.parentNode}return null}function du(a){return a=a[Ni]||a[sa],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function Wl(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(r(33))}function uh(a){return a[hu]||null}var tp=[],$l=-1;function ja(a){return{current:a}}function hr(a){0>$l||(a.current=tp[$l],tp[$l]=null,$l--)}function cr(a,l){$l++,tp[$l]=a.current,a.current=l}var za={},Fn=ja(za),us=ja(!1),Mo=za;function Gl(a,l){var f=a.type.contextTypes;if(!f)return za;var m=a.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===l)return m.__reactInternalMemoizedMaskedChildContext;var v={},E;for(E in f)v[E]=l[E];return m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=v),v}function fs(a){return a=a.childContextTypes,a!=null}function fh(){hr(us),hr(Fn)}function tv(a,l,f){if(Fn.current!==za)throw Error(r(168));cr(Fn,l),cr(us,f)}function rv(a,l,f){var m=a.stateNode;if(l=l.childContextTypes,typeof m.getChildContext!="function")return f;m=m.getChildContext();for(var v in m)if(!(v in l))throw Error(r(108,_e(a)||"Unknown",v));return we({},f,m)}function hh(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||za,Mo=Fn.current,cr(Fn,a),cr(us,us.current),!0}function nv(a,l,f){var m=a.stateNode;if(!m)throw Error(r(169));f?(a=rv(a,l,Mo),m.__reactInternalMemoizedMergedChildContext=a,hr(us),hr(Fn),cr(Fn,a)):hr(us),cr(us,f)}var ia=null,dh=!1,rp=!1;function sv(a){ia===null?ia=[a]:ia.push(a)}function q4(a){dh=!0,sv(a)}function Ha(){if(!rp&&ia!==null){rp=!0;var a=0,l=Vt;try{var f=ia;for(Vt=1;a<f.length;a++){var m=f[a];do m=m(!0);while(m!==null)}ia=null,dh=!1}catch(v){throw ia!==null&&(ia=ia.slice(a+1)),Ne($t,Ha),v}finally{Vt=l,rp=!1}}return null}var ql=[],Kl=0,ph=null,mh=0,js=[],zs=0,Vo=null,aa=1,oa="";function Bo(a,l){ql[Kl++]=mh,ql[Kl++]=ph,ph=a,mh=l}function iv(a,l,f){js[zs++]=aa,js[zs++]=oa,js[zs++]=Vo,Vo=a;var m=aa;a=oa;var v=32-ze(m)-1;m&=~(1<<v),f+=1;var E=32-ze(l)+v;if(30<E){var b=v-v%5;E=(m&(1<<b)-1).toString(32),m>>=b,v-=b,aa=1<<32-ze(l)+v|f<<v|m,oa=E+a}else aa=1<<E|f<<v|m,oa=a}function np(a){a.return!==null&&(Bo(a,1),iv(a,1,0))}function sp(a){for(;a===ph;)ph=ql[--Kl],ql[Kl]=null,mh=ql[--Kl],ql[Kl]=null;for(;a===Vo;)Vo=js[--zs],js[zs]=null,oa=js[--zs],js[zs]=null,aa=js[--zs],js[zs]=null}var Is=null,Fs=null,vr=!1,oi=null;function av(a,l){var f=Gs(5,null,null,0);f.elementType="DELETED",f.stateNode=l,f.return=a,l=a.deletions,l===null?(a.deletions=[f],a.flags|=16):l.push(f)}function ov(a,l){switch(a.tag){case 5:var f=a.type;return l=l.nodeType!==1||f.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(a.stateNode=l,Is=a,Fs=Ua(l.firstChild),!0):!1;case 6:return l=a.pendingProps===""||l.nodeType!==3?null:l,l!==null?(a.stateNode=l,Is=a,Fs=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(f=Vo!==null?{id:aa,overflow:oa}:null,a.memoizedState={dehydrated:l,treeContext:f,retryLane:1073741824},f=Gs(18,null,null,0),f.stateNode=l,f.return=a,a.child=f,Is=a,Fs=null,!0):!1;default:return!1}}function ip(a){return(a.mode&1)!==0&&(a.flags&128)===0}function ap(a){if(vr){var l=Fs;if(l){var f=l;if(!ov(a,l)){if(ip(a))throw Error(r(418));l=Ua(f.nextSibling);var m=Is;l&&ov(a,l)?av(m,f):(a.flags=a.flags&-4097|2,vr=!1,Is=a)}}else{if(ip(a))throw Error(r(418));a.flags=a.flags&-4097|2,vr=!1,Is=a}}}function lv(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Is=a}function gh(a){if(a!==Is)return!1;if(!vr)return lv(a),vr=!0,!1;var l;if((l=a.tag!==3)&&!(l=a.tag!==5)&&(l=a.type,l=l!=="head"&&l!=="body"&&!Qd(a.type,a.memoizedProps)),l&&(l=Fs)){if(ip(a))throw cv(),Error(r(418));for(;l;)av(a,l),l=Ua(l.nextSibling)}if(lv(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8){var f=a.data;if(f==="/$"){if(l===0){Fs=Ua(a.nextSibling);break e}l--}else f!=="$"&&f!=="$!"&&f!=="$?"||l++}a=a.nextSibling}Fs=null}}else Fs=Is?Ua(a.stateNode.nextSibling):null;return!0}function cv(){for(var a=Fs;a;)a=Ua(a.nextSibling)}function Xl(){Fs=Is=null,vr=!1}function op(a){oi===null?oi=[a]:oi.push(a)}var K4=V.ReactCurrentBatchConfig;function pu(a,l,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(r(309));var m=f.stateNode}if(!m)throw Error(r(147,a));var v=m,E=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===E?l.ref:(l=function(b){var Q=v.refs;b===null?delete Q[E]:Q[E]=b},l._stringRef=E,l)}if(typeof a!="string")throw Error(r(284));if(!f._owner)throw Error(r(290,a))}return a}function xh(a,l){throw a=Object.prototype.toString.call(l),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function uv(a){var l=a._init;return l(a._payload)}function fv(a){function l(ie,se){if(a){var he=ie.deletions;he===null?(ie.deletions=[se],ie.flags|=16):he.push(se)}}function f(ie,se){if(!a)return null;for(;se!==null;)l(ie,se),se=se.sibling;return null}function m(ie,se){for(ie=new Map;se!==null;)se.key!==null?ie.set(se.key,se):ie.set(se.index,se),se=se.sibling;return ie}function v(ie,se){return ie=Qa(ie,se),ie.index=0,ie.sibling=null,ie}function E(ie,se,he){return ie.index=he,a?(he=ie.alternate,he!==null?(he=he.index,he<se?(ie.flags|=2,se):he):(ie.flags|=2,se)):(ie.flags|=1048576,se)}function b(ie){return a&&ie.alternate===null&&(ie.flags|=2),ie}function Q(ie,se,he,Be){return se===null||se.tag!==6?(se=Jp(he,ie.mode,Be),se.return=ie,se):(se=v(se,he),se.return=ie,se)}function re(ie,se,he,Be){var tt=he.type;return tt===A?be(ie,se,he.props.children,Be,he.key):se!==null&&(se.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===Ve&&uv(tt)===se.type)?(Be=v(se,he.props),Be.ref=pu(ie,se,he),Be.return=ie,Be):(Be=jh(he.type,he.key,he.props,null,ie.mode,Be),Be.ref=pu(ie,se,he),Be.return=ie,Be)}function de(ie,se,he,Be){return se===null||se.tag!==4||se.stateNode.containerInfo!==he.containerInfo||se.stateNode.implementation!==he.implementation?(se=Zp(he,ie.mode,Be),se.return=ie,se):(se=v(se,he.children||[]),se.return=ie,se)}function be(ie,se,he,Be,tt){return se===null||se.tag!==7?(se=qo(he,ie.mode,Be,tt),se.return=ie,se):(se=v(se,he),se.return=ie,se)}function Me(ie,se,he){if(typeof se=="string"&&se!==""||typeof se=="number")return se=Jp(""+se,ie.mode,he),se.return=ie,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case W:return he=jh(se.type,se.key,se.props,null,ie.mode,he),he.ref=pu(ie,null,se),he.return=ie,he;case j:return se=Zp(se,ie.mode,he),se.return=ie,se;case Ve:var Be=se._init;return Me(ie,Be(se._payload),he)}if(Bt(se)||ne(se))return se=qo(se,ie.mode,he,null),se.return=ie,se;xh(ie,se)}return null}function Fe(ie,se,he,Be){var tt=se!==null?se.key:null;if(typeof he=="string"&&he!==""||typeof he=="number")return tt!==null?null:Q(ie,se,""+he,Be);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case W:return he.key===tt?re(ie,se,he,Be):null;case j:return he.key===tt?de(ie,se,he,Be):null;case Ve:return tt=he._init,Fe(ie,se,tt(he._payload),Be)}if(Bt(he)||ne(he))return tt!==null?null:be(ie,se,he,Be,null);xh(ie,he)}return null}function Xe(ie,se,he,Be,tt){if(typeof Be=="string"&&Be!==""||typeof Be=="number")return ie=ie.get(he)||null,Q(se,ie,""+Be,tt);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case W:return ie=ie.get(Be.key===null?he:Be.key)||null,re(se,ie,Be,tt);case j:return ie=ie.get(Be.key===null?he:Be.key)||null,de(se,ie,Be,tt);case Ve:var it=Be._init;return Xe(ie,se,he,it(Be._payload),tt)}if(Bt(Be)||ne(Be))return ie=ie.get(he)||null,be(se,ie,Be,tt,null);xh(se,Be)}return null}function Ze(ie,se,he,Be){for(var tt=null,it=null,at=se,mt=se=0,rn=null;at!==null&&mt<he.length;mt++){at.index>mt?(rn=at,at=null):rn=at.sibling;var qt=Fe(ie,at,he[mt],Be);if(qt===null){at===null&&(at=rn);break}a&&at&&qt.alternate===null&&l(ie,at),se=E(qt,se,mt),it===null?tt=qt:it.sibling=qt,it=qt,at=rn}if(mt===he.length)return f(ie,at),vr&&Bo(ie,mt),tt;if(at===null){for(;mt<he.length;mt++)at=Me(ie,he[mt],Be),at!==null&&(se=E(at,se,mt),it===null?tt=at:it.sibling=at,it=at);return vr&&Bo(ie,mt),tt}for(at=m(ie,at);mt<he.length;mt++)rn=Xe(at,ie,mt,he[mt],Be),rn!==null&&(a&&rn.alternate!==null&&at.delete(rn.key===null?mt:rn.key),se=E(rn,se,mt),it===null?tt=rn:it.sibling=rn,it=rn);return a&&at.forEach(function(Ja){return l(ie,Ja)}),vr&&Bo(ie,mt),tt}function et(ie,se,he,Be){var tt=ne(he);if(typeof tt!="function")throw Error(r(150));if(he=tt.call(he),he==null)throw Error(r(151));for(var it=tt=null,at=se,mt=se=0,rn=null,qt=he.next();at!==null&&!qt.done;mt++,qt=he.next()){at.index>mt?(rn=at,at=null):rn=at.sibling;var Ja=Fe(ie,at,qt.value,Be);if(Ja===null){at===null&&(at=rn);break}a&&at&&Ja.alternate===null&&l(ie,at),se=E(Ja,se,mt),it===null?tt=Ja:it.sibling=Ja,it=Ja,at=rn}if(qt.done)return f(ie,at),vr&&Bo(ie,mt),tt;if(at===null){for(;!qt.done;mt++,qt=he.next())qt=Me(ie,qt.value,Be),qt!==null&&(se=E(qt,se,mt),it===null?tt=qt:it.sibling=qt,it=qt);return vr&&Bo(ie,mt),tt}for(at=m(ie,at);!qt.done;mt++,qt=he.next())qt=Xe(at,ie,mt,qt.value,Be),qt!==null&&(a&&qt.alternate!==null&&at.delete(qt.key===null?mt:qt.key),se=E(qt,se,mt),it===null?tt=qt:it.sibling=qt,it=qt);return a&&at.forEach(function(CA){return l(ie,CA)}),vr&&Bo(ie,mt),tt}function br(ie,se,he,Be){if(typeof he=="object"&&he!==null&&he.type===A&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case W:e:{for(var tt=he.key,it=se;it!==null;){if(it.key===tt){if(tt=he.type,tt===A){if(it.tag===7){f(ie,it.sibling),se=v(it,he.props.children),se.return=ie,ie=se;break e}}else if(it.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===Ve&&uv(tt)===it.type){f(ie,it.sibling),se=v(it,he.props),se.ref=pu(ie,it,he),se.return=ie,ie=se;break e}f(ie,it);break}else l(ie,it);it=it.sibling}he.type===A?(se=qo(he.props.children,ie.mode,Be,he.key),se.return=ie,ie=se):(Be=jh(he.type,he.key,he.props,null,ie.mode,Be),Be.ref=pu(ie,se,he),Be.return=ie,ie=Be)}return b(ie);case j:e:{for(it=he.key;se!==null;){if(se.key===it)if(se.tag===4&&se.stateNode.containerInfo===he.containerInfo&&se.stateNode.implementation===he.implementation){f(ie,se.sibling),se=v(se,he.children||[]),se.return=ie,ie=se;break e}else{f(ie,se);break}else l(ie,se);se=se.sibling}se=Zp(he,ie.mode,Be),se.return=ie,ie=se}return b(ie);case Ve:return it=he._init,br(ie,se,it(he._payload),Be)}if(Bt(he))return Ze(ie,se,he,Be);if(ne(he))return et(ie,se,he,Be);xh(ie,he)}return typeof he=="string"&&he!==""||typeof he=="number"?(he=""+he,se!==null&&se.tag===6?(f(ie,se.sibling),se=v(se,he),se.return=ie,ie=se):(f(ie,se),se=Jp(he,ie.mode,Be),se.return=ie,ie=se),b(ie)):f(ie,se)}return br}var Yl=fv(!0),hv=fv(!1),vh=ja(null),_h=null,Ql=null,lp=null;function cp(){lp=Ql=_h=null}function up(a){var l=vh.current;hr(vh),a._currentValue=l}function fp(a,l,f){for(;a!==null;){var m=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),a===f)break;a=a.return}}function Jl(a,l){_h=a,lp=Ql=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&l)!==0&&(hs=!0),a.firstContext=null)}function Hs(a){var l=a._currentValue;if(lp!==a)if(a={context:a,memoizedValue:l,next:null},Ql===null){if(_h===null)throw Error(r(308));Ql=a,_h.dependencies={lanes:0,firstContext:a}}else Ql=Ql.next=a;return l}var Uo=null;function hp(a){Uo===null?Uo=[a]:Uo.push(a)}function dv(a,l,f,m){var v=l.interleaved;return v===null?(f.next=f,hp(l)):(f.next=v.next,v.next=f),l.interleaved=f,la(a,m)}function la(a,l){a.lanes|=l;var f=a.alternate;for(f!==null&&(f.lanes|=l),f=a,a=a.return;a!==null;)a.childLanes|=l,f=a.alternate,f!==null&&(f.childLanes|=l),f=a,a=a.return;return f.tag===3?f.stateNode:null}var Wa=!1;function dp(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pv(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ca(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function $a(a,l,f){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(zt&2)!==0){var v=m.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),m.pending=l,la(a,f)}return v=m.interleaved,v===null?(l.next=l,hp(m)):(l.next=v.next,v.next=l),m.interleaved=l,la(a,f)}function yh(a,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194240)!==0)){var m=l.lanes;m&=a.pendingLanes,f|=m,l.lanes=f,Xc(a,f)}}function mv(a,l){var f=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,f===m)){var v=null,E=null;if(f=f.firstBaseUpdate,f!==null){do{var b={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};E===null?v=E=b:E=E.next=b,f=f.next}while(f!==null);E===null?v=E=l:E=E.next=l}else v=E=l;f={baseState:m.baseState,firstBaseUpdate:v,lastBaseUpdate:E,shared:m.shared,effects:m.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=l:a.next=l,f.lastBaseUpdate=l}function wh(a,l,f,m){var v=a.updateQueue;Wa=!1;var E=v.firstBaseUpdate,b=v.lastBaseUpdate,Q=v.shared.pending;if(Q!==null){v.shared.pending=null;var re=Q,de=re.next;re.next=null,b===null?E=de:b.next=de,b=re;var be=a.alternate;be!==null&&(be=be.updateQueue,Q=be.lastBaseUpdate,Q!==b&&(Q===null?be.firstBaseUpdate=de:Q.next=de,be.lastBaseUpdate=re))}if(E!==null){var Me=v.baseState;b=0,be=de=re=null,Q=E;do{var Fe=Q.lane,Xe=Q.eventTime;if((m&Fe)===Fe){be!==null&&(be=be.next={eventTime:Xe,lane:0,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null});e:{var Ze=a,et=Q;switch(Fe=l,Xe=f,et.tag){case 1:if(Ze=et.payload,typeof Ze=="function"){Me=Ze.call(Xe,Me,Fe);break e}Me=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=et.payload,Fe=typeof Ze=="function"?Ze.call(Xe,Me,Fe):Ze,Fe==null)break e;Me=we({},Me,Fe);break e;case 2:Wa=!0}}Q.callback!==null&&Q.lane!==0&&(a.flags|=64,Fe=v.effects,Fe===null?v.effects=[Q]:Fe.push(Q))}else Xe={eventTime:Xe,lane:Fe,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},be===null?(de=be=Xe,re=Me):be=be.next=Xe,b|=Fe;if(Q=Q.next,Q===null){if(Q=v.shared.pending,Q===null)break;Fe=Q,Q=Fe.next,Fe.next=null,v.lastBaseUpdate=Fe,v.shared.pending=null}}while(!0);if(be===null&&(re=Me),v.baseState=re,v.firstBaseUpdate=de,v.lastBaseUpdate=be,l=v.shared.interleaved,l!==null){v=l;do b|=v.lane,v=v.next;while(v!==l)}else E===null&&(v.shared.lanes=0);Ho|=b,a.lanes=b,a.memoizedState=Me}}function gv(a,l,f){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var m=a[l],v=m.callback;if(v!==null){if(m.callback=null,m=f,typeof v!="function")throw Error(r(191,v));v.call(m)}}}var mu={},bi=ja(mu),gu=ja(mu),xu=ja(mu);function jo(a){if(a===mu)throw Error(r(174));return a}function pp(a,l){switch(cr(xu,l),cr(gu,a),cr(bi,mu),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:as(null,"");break;default:a=a===8?l.parentNode:l,l=a.namespaceURI||null,a=a.tagName,l=as(l,a)}hr(bi),cr(bi,l)}function Zl(){hr(bi),hr(gu),hr(xu)}function xv(a){jo(xu.current);var l=jo(bi.current),f=as(l,a.type);l!==f&&(cr(gu,a),cr(bi,f))}function mp(a){gu.current===a&&(hr(bi),hr(gu))}var yr=ja(0);function Eh(a){for(var l=a;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var gp=[];function xp(){for(var a=0;a<gp.length;a++)gp[a]._workInProgressVersionPrimary=null;gp.length=0}var Th=V.ReactCurrentDispatcher,vp=V.ReactCurrentBatchConfig,zo=0,wr=null,Kr=null,en=null,Sh=!1,vu=!1,_u=0,X4=0;function Rn(){throw Error(r(321))}function _p(a,l){if(l===null)return!1;for(var f=0;f<l.length&&f<a.length;f++)if(!ai(a[f],l[f]))return!1;return!0}function yp(a,l,f,m,v,E){if(zo=E,wr=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Th.current=a===null||a.memoizedState===null?Z4:eA,a=f(m,v),vu){E=0;do{if(vu=!1,_u=0,25<=E)throw Error(r(301));E+=1,en=Kr=null,l.updateQueue=null,Th.current=tA,a=f(m,v)}while(vu)}if(Th.current=Ch,l=Kr!==null&&Kr.next!==null,zo=0,en=Kr=wr=null,Sh=!1,l)throw Error(r(300));return a}function wp(){var a=_u!==0;return _u=0,a}function Di(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?wr.memoizedState=en=a:en=en.next=a,en}function Ws(){if(Kr===null){var a=wr.alternate;a=a!==null?a.memoizedState:null}else a=Kr.next;var l=en===null?wr.memoizedState:en.next;if(l!==null)en=l,Kr=a;else{if(a===null)throw Error(r(310));Kr=a,a={memoizedState:Kr.memoizedState,baseState:Kr.baseState,baseQueue:Kr.baseQueue,queue:Kr.queue,next:null},en===null?wr.memoizedState=en=a:en=en.next=a}return en}function yu(a,l){return typeof l=="function"?l(a):l}function Ep(a){var l=Ws(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=a;var m=Kr,v=m.baseQueue,E=f.pending;if(E!==null){if(v!==null){var b=v.next;v.next=E.next,E.next=b}m.baseQueue=v=E,f.pending=null}if(v!==null){E=v.next,m=m.baseState;var Q=b=null,re=null,de=E;do{var be=de.lane;if((zo&be)===be)re!==null&&(re=re.next={lane:0,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),m=de.hasEagerState?de.eagerState:a(m,de.action);else{var Me={lane:be,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null};re===null?(Q=re=Me,b=m):re=re.next=Me,wr.lanes|=be,Ho|=be}de=de.next}while(de!==null&&de!==E);re===null?b=m:re.next=Q,ai(m,l.memoizedState)||(hs=!0),l.memoizedState=m,l.baseState=b,l.baseQueue=re,f.lastRenderedState=m}if(a=f.interleaved,a!==null){v=a;do E=v.lane,wr.lanes|=E,Ho|=E,v=v.next;while(v!==a)}else v===null&&(f.lanes=0);return[l.memoizedState,f.dispatch]}function Tp(a){var l=Ws(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=a;var m=f.dispatch,v=f.pending,E=l.memoizedState;if(v!==null){f.pending=null;var b=v=v.next;do E=a(E,b.action),b=b.next;while(b!==v);ai(E,l.memoizedState)||(hs=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),f.lastRenderedState=E}return[E,m]}function vv(){}function _v(a,l){var f=wr,m=Ws(),v=l(),E=!ai(m.memoizedState,v);if(E&&(m.memoizedState=v,hs=!0),m=m.queue,Sp(Ev.bind(null,f,m,a),[a]),m.getSnapshot!==l||E||en!==null&&en.memoizedState.tag&1){if(f.flags|=2048,wu(9,wv.bind(null,f,m,v,l),void 0,null),tn===null)throw Error(r(349));(zo&30)!==0||yv(f,l,v)}return v}function yv(a,l,f){a.flags|=16384,a={getSnapshot:l,value:f},l=wr.updateQueue,l===null?(l={lastEffect:null,stores:null},wr.updateQueue=l,l.stores=[a]):(f=l.stores,f===null?l.stores=[a]:f.push(a))}function wv(a,l,f,m){l.value=f,l.getSnapshot=m,Tv(l)&&Sv(a)}function Ev(a,l,f){return f(function(){Tv(l)&&Sv(a)})}function Tv(a){var l=a.getSnapshot;a=a.value;try{var f=l();return!ai(a,f)}catch{return!0}}function Sv(a){var l=la(a,1);l!==null&&fi(l,a,1,-1)}function kv(a){var l=Di();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yu,lastRenderedState:a},l.queue=a,a=a.dispatch=J4.bind(null,wr,a),[l.memoizedState,a]}function wu(a,l,f,m){return a={tag:a,create:l,destroy:f,deps:m,next:null},l=wr.updateQueue,l===null?(l={lastEffect:null,stores:null},wr.updateQueue=l,l.lastEffect=a.next=a):(f=l.lastEffect,f===null?l.lastEffect=a.next=a:(m=f.next,f.next=a,a.next=m,l.lastEffect=a)),a}function Av(){return Ws().memoizedState}function kh(a,l,f,m){var v=Di();wr.flags|=a,v.memoizedState=wu(1|l,f,void 0,m===void 0?null:m)}function Ah(a,l,f,m){var v=Ws();m=m===void 0?null:m;var E=void 0;if(Kr!==null){var b=Kr.memoizedState;if(E=b.destroy,m!==null&&_p(m,b.deps)){v.memoizedState=wu(l,f,E,m);return}}wr.flags|=a,v.memoizedState=wu(1|l,f,E,m)}function Cv(a,l){return kh(8390656,8,a,l)}function Sp(a,l){return Ah(2048,8,a,l)}function Iv(a,l){return Ah(4,2,a,l)}function Fv(a,l){return Ah(4,4,a,l)}function Rv(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function Nv(a,l,f){return f=f!=null?f.concat([a]):null,Ah(4,4,Rv.bind(null,l,a),f)}function kp(){}function bv(a,l){var f=Ws();l=l===void 0?null:l;var m=f.memoizedState;return m!==null&&l!==null&&_p(l,m[1])?m[0]:(f.memoizedState=[a,l],a)}function Dv(a,l){var f=Ws();l=l===void 0?null:l;var m=f.memoizedState;return m!==null&&l!==null&&_p(l,m[1])?m[0]:(a=a(),f.memoizedState=[a,l],a)}function Pv(a,l,f){return(zo&21)===0?(a.baseState&&(a.baseState=!1,hs=!0),a.memoizedState=f):(ai(f,l)||(f=qc(),wr.lanes|=f,Ho|=f,a.baseState=!0),l)}function Y4(a,l){var f=Vt;Vt=f!==0&&4>f?f:4,a(!0);var m=vp.transition;vp.transition={};try{a(!1),l()}finally{Vt=f,vp.transition=m}}function Ov(){return Ws().memoizedState}function Q4(a,l,f){var m=Xa(a);if(f={lane:m,action:f,hasEagerState:!1,eagerState:null,next:null},Lv(a))Mv(l,f);else if(f=dv(a,l,f,m),f!==null){var v=es();fi(f,a,m,v),Vv(f,l,m)}}function J4(a,l,f){var m=Xa(a),v={lane:m,action:f,hasEagerState:!1,eagerState:null,next:null};if(Lv(a))Mv(l,v);else{var E=a.alternate;if(a.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var b=l.lastRenderedState,Q=E(b,f);if(v.hasEagerState=!0,v.eagerState=Q,ai(Q,b)){var re=l.interleaved;re===null?(v.next=v,hp(l)):(v.next=re.next,re.next=v),l.interleaved=v;return}}catch{}finally{}f=dv(a,l,v,m),f!==null&&(v=es(),fi(f,a,m,v),Vv(f,l,m))}}function Lv(a){var l=a.alternate;return a===wr||l!==null&&l===wr}function Mv(a,l){vu=Sh=!0;var f=a.pending;f===null?l.next=l:(l.next=f.next,f.next=l),a.pending=l}function Vv(a,l,f){if((f&4194240)!==0){var m=l.lanes;m&=a.pendingLanes,f|=m,l.lanes=f,Xc(a,f)}}var Ch={readContext:Hs,useCallback:Rn,useContext:Rn,useEffect:Rn,useImperativeHandle:Rn,useInsertionEffect:Rn,useLayoutEffect:Rn,useMemo:Rn,useReducer:Rn,useRef:Rn,useState:Rn,useDebugValue:Rn,useDeferredValue:Rn,useTransition:Rn,useMutableSource:Rn,useSyncExternalStore:Rn,useId:Rn,unstable_isNewReconciler:!1},Z4={readContext:Hs,useCallback:function(a,l){return Di().memoizedState=[a,l===void 0?null:l],a},useContext:Hs,useEffect:Cv,useImperativeHandle:function(a,l,f){return f=f!=null?f.concat([a]):null,kh(4194308,4,Rv.bind(null,l,a),f)},useLayoutEffect:function(a,l){return kh(4194308,4,a,l)},useInsertionEffect:function(a,l){return kh(4,2,a,l)},useMemo:function(a,l){var f=Di();return l=l===void 0?null:l,a=a(),f.memoizedState=[a,l],a},useReducer:function(a,l,f){var m=Di();return l=f!==void 0?f(l):l,m.memoizedState=m.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},m.queue=a,a=a.dispatch=Q4.bind(null,wr,a),[m.memoizedState,a]},useRef:function(a){var l=Di();return a={current:a},l.memoizedState=a},useState:kv,useDebugValue:kp,useDeferredValue:function(a){return Di().memoizedState=a},useTransition:function(){var a=kv(!1),l=a[0];return a=Y4.bind(null,a[1]),Di().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,f){var m=wr,v=Di();if(vr){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),tn===null)throw Error(r(349));(zo&30)!==0||yv(m,l,f)}v.memoizedState=f;var E={value:f,getSnapshot:l};return v.queue=E,Cv(Ev.bind(null,m,E,a),[a]),m.flags|=2048,wu(9,wv.bind(null,m,E,f,l),void 0,null),f},useId:function(){var a=Di(),l=tn.identifierPrefix;if(vr){var f=oa,m=aa;f=(m&~(1<<32-ze(m)-1)).toString(32)+f,l=":"+l+"R"+f,f=_u++,0<f&&(l+="H"+f.toString(32)),l+=":"}else f=X4++,l=":"+l+"r"+f.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},eA={readContext:Hs,useCallback:bv,useContext:Hs,useEffect:Sp,useImperativeHandle:Nv,useInsertionEffect:Iv,useLayoutEffect:Fv,useMemo:Dv,useReducer:Ep,useRef:Av,useState:function(){return Ep(yu)},useDebugValue:kp,useDeferredValue:function(a){var l=Ws();return Pv(l,Kr.memoizedState,a)},useTransition:function(){var a=Ep(yu)[0],l=Ws().memoizedState;return[a,l]},useMutableSource:vv,useSyncExternalStore:_v,useId:Ov,unstable_isNewReconciler:!1},tA={readContext:Hs,useCallback:bv,useContext:Hs,useEffect:Sp,useImperativeHandle:Nv,useInsertionEffect:Iv,useLayoutEffect:Fv,useMemo:Dv,useReducer:Tp,useRef:Av,useState:function(){return Tp(yu)},useDebugValue:kp,useDeferredValue:function(a){var l=Ws();return Kr===null?l.memoizedState=a:Pv(l,Kr.memoizedState,a)},useTransition:function(){var a=Tp(yu)[0],l=Ws().memoizedState;return[a,l]},useMutableSource:vv,useSyncExternalStore:_v,useId:Ov,unstable_isNewReconciler:!1};function li(a,l){if(a&&a.defaultProps){l=we({},l),a=a.defaultProps;for(var f in a)l[f]===void 0&&(l[f]=a[f]);return l}return l}function Ap(a,l,f,m){l=a.memoizedState,f=f(m,l),f=f==null?l:we({},l,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var Ih={isMounted:function(a){return(a=a._reactInternals)?X(a)===a:!1},enqueueSetState:function(a,l,f){a=a._reactInternals;var m=es(),v=Xa(a),E=ca(m,v);E.payload=l,f!=null&&(E.callback=f),l=$a(a,E,v),l!==null&&(fi(l,a,v,m),yh(l,a,v))},enqueueReplaceState:function(a,l,f){a=a._reactInternals;var m=es(),v=Xa(a),E=ca(m,v);E.tag=1,E.payload=l,f!=null&&(E.callback=f),l=$a(a,E,v),l!==null&&(fi(l,a,v,m),yh(l,a,v))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var f=es(),m=Xa(a),v=ca(f,m);v.tag=2,l!=null&&(v.callback=l),l=$a(a,v,m),l!==null&&(fi(l,a,m,f),yh(l,a,m))}};function Bv(a,l,f,m,v,E,b){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,E,b):l.prototype&&l.prototype.isPureReactComponent?!ou(f,m)||!ou(v,E):!0}function Uv(a,l,f){var m=!1,v=za,E=l.contextType;return typeof E=="object"&&E!==null?E=Hs(E):(v=fs(l)?Mo:Fn.current,m=l.contextTypes,E=(m=m!=null)?Gl(a,v):za),l=new l(f,E),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Ih,a.stateNode=l,l._reactInternals=a,m&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=E),l}function jv(a,l,f,m){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,m),l.state!==a&&Ih.enqueueReplaceState(l,l.state,null)}function Cp(a,l,f,m){var v=a.stateNode;v.props=f,v.state=a.memoizedState,v.refs={},dp(a);var E=l.contextType;typeof E=="object"&&E!==null?v.context=Hs(E):(E=fs(l)?Mo:Fn.current,v.context=Gl(a,E)),v.state=a.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(Ap(a,l,E,f),v.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(l=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),l!==v.state&&Ih.enqueueReplaceState(v,v.state,null),wh(a,f,v,m),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function ec(a,l){try{var f="",m=l;do f+=Z(m),m=m.return;while(m);var v=f}catch(E){v=`
Error generating stack: `+E.message+`
`+E.stack}return{value:a,source:l,stack:v,digest:null}}function Ip(a,l,f){return{value:a,source:null,stack:f??null,digest:l??null}}function Fp(a,l){try{console.error(l.value)}catch(f){setTimeout(function(){throw f})}}var rA=typeof WeakMap=="function"?WeakMap:Map;function zv(a,l,f){f=ca(-1,f),f.tag=3,f.payload={element:null};var m=l.value;return f.callback=function(){Oh||(Oh=!0,Wp=m),Fp(a,l)},f}function Hv(a,l,f){f=ca(-1,f),f.tag=3;var m=a.type.getDerivedStateFromError;if(typeof m=="function"){var v=l.value;f.payload=function(){return m(v)},f.callback=function(){Fp(a,l)}}var E=a.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(f.callback=function(){Fp(a,l),typeof m!="function"&&(qa===null?qa=new Set([this]):qa.add(this));var b=l.stack;this.componentDidCatch(l.value,{componentStack:b!==null?b:""})}),f}function Wv(a,l,f){var m=a.pingCache;if(m===null){m=a.pingCache=new rA;var v=new Set;m.set(l,v)}else v=m.get(l),v===void 0&&(v=new Set,m.set(l,v));v.has(f)||(v.add(f),a=gA.bind(null,a,l,f),l.then(a,a))}function $v(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function Gv(a,l,f,m,v){return(a.mode&1)===0?(a===l?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(l=ca(-1,1),l.tag=2,$a(f,l,1))),f.lanes|=1),a):(a.flags|=65536,a.lanes=v,a)}var nA=V.ReactCurrentOwner,hs=!1;function Zn(a,l,f,m){l.child=a===null?hv(l,null,f,m):Yl(l,a.child,f,m)}function qv(a,l,f,m,v){f=f.render;var E=l.ref;return Jl(l,v),m=yp(a,l,f,m,E,v),f=wp(),a!==null&&!hs?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~v,ua(a,l,v)):(vr&&f&&np(l),l.flags|=1,Zn(a,l,m,v),l.child)}function Kv(a,l,f,m,v){if(a===null){var E=f.type;return typeof E=="function"&&!Qp(E)&&E.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(l.tag=15,l.type=E,Xv(a,l,E,m,v)):(a=jh(f.type,null,m,l,l.mode,v),a.ref=l.ref,a.return=l,l.child=a)}if(E=a.child,(a.lanes&v)===0){var b=E.memoizedProps;if(f=f.compare,f=f!==null?f:ou,f(b,m)&&a.ref===l.ref)return ua(a,l,v)}return l.flags|=1,a=Qa(E,m),a.ref=l.ref,a.return=l,l.child=a}function Xv(a,l,f,m,v){if(a!==null){var E=a.memoizedProps;if(ou(E,m)&&a.ref===l.ref)if(hs=!1,l.pendingProps=m=E,(a.lanes&v)!==0)(a.flags&131072)!==0&&(hs=!0);else return l.lanes=a.lanes,ua(a,l,v)}return Rp(a,l,f,m,v)}function Yv(a,l,f){var m=l.pendingProps,v=m.children,E=a!==null?a.memoizedState:null;if(m.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},cr(rc,Rs),Rs|=f;else{if((f&1073741824)===0)return a=E!==null?E.baseLanes|f:f,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,cr(rc,Rs),Rs|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=E!==null?E.baseLanes:f,cr(rc,Rs),Rs|=m}else E!==null?(m=E.baseLanes|f,l.memoizedState=null):m=f,cr(rc,Rs),Rs|=m;return Zn(a,l,v,f),l.child}function Qv(a,l){var f=l.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(l.flags|=512,l.flags|=2097152)}function Rp(a,l,f,m,v){var E=fs(f)?Mo:Fn.current;return E=Gl(l,E),Jl(l,v),f=yp(a,l,f,m,E,v),m=wp(),a!==null&&!hs?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~v,ua(a,l,v)):(vr&&m&&np(l),l.flags|=1,Zn(a,l,f,v),l.child)}function Jv(a,l,f,m,v){if(fs(f)){var E=!0;hh(l)}else E=!1;if(Jl(l,v),l.stateNode===null)Rh(a,l),Uv(l,f,m),Cp(l,f,m,v),m=!0;else if(a===null){var b=l.stateNode,Q=l.memoizedProps;b.props=Q;var re=b.context,de=f.contextType;typeof de=="object"&&de!==null?de=Hs(de):(de=fs(f)?Mo:Fn.current,de=Gl(l,de));var be=f.getDerivedStateFromProps,Me=typeof be=="function"||typeof b.getSnapshotBeforeUpdate=="function";Me||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(Q!==m||re!==de)&&jv(l,b,m,de),Wa=!1;var Fe=l.memoizedState;b.state=Fe,wh(l,m,b,v),re=l.memoizedState,Q!==m||Fe!==re||us.current||Wa?(typeof be=="function"&&(Ap(l,f,be,m),re=l.memoizedState),(Q=Wa||Bv(l,f,Q,m,Fe,re,de))?(Me||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(l.flags|=4194308)):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=re),b.props=m,b.state=re,b.context=de,m=Q):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{b=l.stateNode,pv(a,l),Q=l.memoizedProps,de=l.type===l.elementType?Q:li(l.type,Q),b.props=de,Me=l.pendingProps,Fe=b.context,re=f.contextType,typeof re=="object"&&re!==null?re=Hs(re):(re=fs(f)?Mo:Fn.current,re=Gl(l,re));var Xe=f.getDerivedStateFromProps;(be=typeof Xe=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(Q!==Me||Fe!==re)&&jv(l,b,m,re),Wa=!1,Fe=l.memoizedState,b.state=Fe,wh(l,m,b,v);var Ze=l.memoizedState;Q!==Me||Fe!==Ze||us.current||Wa?(typeof Xe=="function"&&(Ap(l,f,Xe,m),Ze=l.memoizedState),(de=Wa||Bv(l,f,de,m,Fe,Ze,re)||!1)?(be||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(m,Ze,re),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(m,Ze,re)),typeof b.componentDidUpdate=="function"&&(l.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof b.componentDidUpdate!="function"||Q===a.memoizedProps&&Fe===a.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||Q===a.memoizedProps&&Fe===a.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=Ze),b.props=m,b.state=Ze,b.context=re,m=de):(typeof b.componentDidUpdate!="function"||Q===a.memoizedProps&&Fe===a.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||Q===a.memoizedProps&&Fe===a.memoizedState||(l.flags|=1024),m=!1)}return Np(a,l,f,m,E,v)}function Np(a,l,f,m,v,E){Qv(a,l);var b=(l.flags&128)!==0;if(!m&&!b)return v&&nv(l,f,!1),ua(a,l,E);m=l.stateNode,nA.current=l;var Q=b&&typeof f.getDerivedStateFromError!="function"?null:m.render();return l.flags|=1,a!==null&&b?(l.child=Yl(l,a.child,null,E),l.child=Yl(l,null,Q,E)):Zn(a,l,Q,E),l.memoizedState=m.state,v&&nv(l,f,!0),l.child}function Zv(a){var l=a.stateNode;l.pendingContext?tv(a,l.pendingContext,l.pendingContext!==l.context):l.context&&tv(a,l.context,!1),pp(a,l.containerInfo)}function e_(a,l,f,m,v){return Xl(),op(v),l.flags|=256,Zn(a,l,f,m),l.child}var bp={dehydrated:null,treeContext:null,retryLane:0};function Dp(a){return{baseLanes:a,cachePool:null,transitions:null}}function t_(a,l,f){var m=l.pendingProps,v=yr.current,E=!1,b=(l.flags&128)!==0,Q;if((Q=b)||(Q=a!==null&&a.memoizedState===null?!1:(v&2)!==0),Q?(E=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),cr(yr,v&1),a===null)return ap(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((l.mode&1)===0?l.lanes=1:a.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(b=m.children,a=m.fallback,E?(m=l.mode,E=l.child,b={mode:"hidden",children:b},(m&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=b):E=zh(b,m,0,null),a=qo(a,m,f,null),E.return=l,a.return=l,E.sibling=a,l.child=E,l.child.memoizedState=Dp(f),l.memoizedState=bp,a):Pp(l,b));if(v=a.memoizedState,v!==null&&(Q=v.dehydrated,Q!==null))return sA(a,l,b,m,Q,v,f);if(E){E=m.fallback,b=l.mode,v=a.child,Q=v.sibling;var re={mode:"hidden",children:m.children};return(b&1)===0&&l.child!==v?(m=l.child,m.childLanes=0,m.pendingProps=re,l.deletions=null):(m=Qa(v,re),m.subtreeFlags=v.subtreeFlags&14680064),Q!==null?E=Qa(Q,E):(E=qo(E,b,f,null),E.flags|=2),E.return=l,m.return=l,m.sibling=E,l.child=m,m=E,E=l.child,b=a.child.memoizedState,b=b===null?Dp(f):{baseLanes:b.baseLanes|f,cachePool:null,transitions:b.transitions},E.memoizedState=b,E.childLanes=a.childLanes&~f,l.memoizedState=bp,m}return E=a.child,a=E.sibling,m=Qa(E,{mode:"visible",children:m.children}),(l.mode&1)===0&&(m.lanes=f),m.return=l,m.sibling=null,a!==null&&(f=l.deletions,f===null?(l.deletions=[a],l.flags|=16):f.push(a)),l.child=m,l.memoizedState=null,m}function Pp(a,l){return l=zh({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function Fh(a,l,f,m){return m!==null&&op(m),Yl(l,a.child,null,f),a=Pp(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function sA(a,l,f,m,v,E,b){if(f)return l.flags&256?(l.flags&=-257,m=Ip(Error(r(422))),Fh(a,l,b,m)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(E=m.fallback,v=l.mode,m=zh({mode:"visible",children:m.children},v,0,null),E=qo(E,v,b,null),E.flags|=2,m.return=l,E.return=l,m.sibling=E,l.child=m,(l.mode&1)!==0&&Yl(l,a.child,null,b),l.child.memoizedState=Dp(b),l.memoizedState=bp,E);if((l.mode&1)===0)return Fh(a,l,b,null);if(v.data==="$!"){if(m=v.nextSibling&&v.nextSibling.dataset,m)var Q=m.dgst;return m=Q,E=Error(r(419)),m=Ip(E,m,void 0),Fh(a,l,b,m)}if(Q=(b&a.childLanes)!==0,hs||Q){if(m=tn,m!==null){switch(b&-b){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(m.suspendedLanes|b))!==0?0:v,v!==0&&v!==E.retryLane&&(E.retryLane=v,la(a,v),fi(m,a,v,-1))}return Yp(),m=Ip(Error(r(421))),Fh(a,l,b,m)}return v.data==="$?"?(l.flags|=128,l.child=a.child,l=xA.bind(null,a),v._reactRetry=l,null):(a=E.treeContext,Fs=Ua(v.nextSibling),Is=l,vr=!0,oi=null,a!==null&&(js[zs++]=aa,js[zs++]=oa,js[zs++]=Vo,aa=a.id,oa=a.overflow,Vo=l),l=Pp(l,m.children),l.flags|=4096,l)}function r_(a,l,f){a.lanes|=l;var m=a.alternate;m!==null&&(m.lanes|=l),fp(a.return,l,f)}function Op(a,l,f,m,v){var E=a.memoizedState;E===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:f,tailMode:v}:(E.isBackwards=l,E.rendering=null,E.renderingStartTime=0,E.last=m,E.tail=f,E.tailMode=v)}function n_(a,l,f){var m=l.pendingProps,v=m.revealOrder,E=m.tail;if(Zn(a,l,m.children,f),m=yr.current,(m&2)!==0)m=m&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&r_(a,f,l);else if(a.tag===19)r_(a,f,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}if(cr(yr,m),(l.mode&1)===0)l.memoizedState=null;else switch(v){case"forwards":for(f=l.child,v=null;f!==null;)a=f.alternate,a!==null&&Eh(a)===null&&(v=f),f=f.sibling;f=v,f===null?(v=l.child,l.child=null):(v=f.sibling,f.sibling=null),Op(l,!1,v,f,E);break;case"backwards":for(f=null,v=l.child,l.child=null;v!==null;){if(a=v.alternate,a!==null&&Eh(a)===null){l.child=v;break}a=v.sibling,v.sibling=f,f=v,v=a}Op(l,!0,f,null,E);break;case"together":Op(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Rh(a,l){(l.mode&1)===0&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function ua(a,l,f){if(a!==null&&(l.dependencies=a.dependencies),Ho|=l.lanes,(f&l.childLanes)===0)return null;if(a!==null&&l.child!==a.child)throw Error(r(153));if(l.child!==null){for(a=l.child,f=Qa(a,a.pendingProps),l.child=f,f.return=l;a.sibling!==null;)a=a.sibling,f=f.sibling=Qa(a,a.pendingProps),f.return=l;f.sibling=null}return l.child}function iA(a,l,f){switch(l.tag){case 3:Zv(l),Xl();break;case 5:xv(l);break;case 1:fs(l.type)&&hh(l);break;case 4:pp(l,l.stateNode.containerInfo);break;case 10:var m=l.type._context,v=l.memoizedProps.value;cr(vh,m._currentValue),m._currentValue=v;break;case 13:if(m=l.memoizedState,m!==null)return m.dehydrated!==null?(cr(yr,yr.current&1),l.flags|=128,null):(f&l.child.childLanes)!==0?t_(a,l,f):(cr(yr,yr.current&1),a=ua(a,l,f),a!==null?a.sibling:null);cr(yr,yr.current&1);break;case 19:if(m=(f&l.childLanes)!==0,(a.flags&128)!==0){if(m)return n_(a,l,f);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),cr(yr,yr.current),m)break;return null;case 22:case 23:return l.lanes=0,Yv(a,l,f)}return ua(a,l,f)}var s_,Lp,i_,a_;s_=function(a,l){for(var f=l.child;f!==null;){if(f.tag===5||f.tag===6)a.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Lp=function(){},i_=function(a,l,f,m){var v=a.memoizedProps;if(v!==m){a=l.stateNode,jo(bi.current);var E=null;switch(f){case"input":v=wt(a,v),m=wt(a,m),E=[];break;case"select":v=we({},v,{value:void 0}),m=we({},m,{value:void 0}),E=[];break;case"textarea":v=Tn(a,v),m=Tn(a,m),E=[];break;default:typeof v.onClick!="function"&&typeof m.onClick=="function"&&(a.onclick=ch)}Kn(f,m);var b;f=null;for(de in v)if(!m.hasOwnProperty(de)&&v.hasOwnProperty(de)&&v[de]!=null)if(de==="style"){var Q=v[de];for(b in Q)Q.hasOwnProperty(b)&&(f||(f={}),f[b]="")}else de!=="dangerouslySetInnerHTML"&&de!=="children"&&de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&de!=="autoFocus"&&(s.hasOwnProperty(de)?E||(E=[]):(E=E||[]).push(de,null));for(de in m){var re=m[de];if(Q=v!=null?v[de]:void 0,m.hasOwnProperty(de)&&re!==Q&&(re!=null||Q!=null))if(de==="style")if(Q){for(b in Q)!Q.hasOwnProperty(b)||re&&re.hasOwnProperty(b)||(f||(f={}),f[b]="");for(b in re)re.hasOwnProperty(b)&&Q[b]!==re[b]&&(f||(f={}),f[b]=re[b])}else f||(E||(E=[]),E.push(de,f)),f=re;else de==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,Q=Q?Q.__html:void 0,re!=null&&Q!==re&&(E=E||[]).push(de,re)):de==="children"?typeof re!="string"&&typeof re!="number"||(E=E||[]).push(de,""+re):de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&(s.hasOwnProperty(de)?(re!=null&&de==="onScroll"&&fr("scroll",a),E||Q===re||(E=[])):(E=E||[]).push(de,re))}f&&(E=E||[]).push("style",f);var de=E;(l.updateQueue=de)&&(l.flags|=4)}},a_=function(a,l,f,m){f!==m&&(l.flags|=4)};function Eu(a,l){if(!vr)switch(a.tailMode){case"hidden":l=a.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function Nn(a){var l=a.alternate!==null&&a.alternate.child===a.child,f=0,m=0;if(l)for(var v=a.child;v!==null;)f|=v.lanes|v.childLanes,m|=v.subtreeFlags&14680064,m|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)f|=v.lanes|v.childLanes,m|=v.subtreeFlags,m|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=m,a.childLanes=f,l}function aA(a,l,f){var m=l.pendingProps;switch(sp(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nn(l),null;case 1:return fs(l.type)&&fh(),Nn(l),null;case 3:return m=l.stateNode,Zl(),hr(us),hr(Fn),xp(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(gh(l)?l.flags|=4:a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,oi!==null&&(qp(oi),oi=null))),Lp(a,l),Nn(l),null;case 5:mp(l);var v=jo(xu.current);if(f=l.type,a!==null&&l.stateNode!=null)i_(a,l,f,m,v),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!m){if(l.stateNode===null)throw Error(r(166));return Nn(l),null}if(a=jo(bi.current),gh(l)){m=l.stateNode,f=l.type;var E=l.memoizedProps;switch(m[Ni]=l,m[hu]=E,a=(l.mode&1)!==0,f){case"dialog":fr("cancel",m),fr("close",m);break;case"iframe":case"object":case"embed":fr("load",m);break;case"video":case"audio":for(v=0;v<cu.length;v++)fr(cu[v],m);break;case"source":fr("error",m);break;case"img":case"image":case"link":fr("error",m),fr("load",m);break;case"details":fr("toggle",m);break;case"input":Lt(m,E),fr("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!E.multiple},fr("invalid",m);break;case"textarea":Sn(m,E),fr("invalid",m)}Kn(f,E),v=null;for(var b in E)if(E.hasOwnProperty(b)){var Q=E[b];b==="children"?typeof Q=="string"?m.textContent!==Q&&(E.suppressHydrationWarning!==!0&&lh(m.textContent,Q,a),v=["children",Q]):typeof Q=="number"&&m.textContent!==""+Q&&(E.suppressHydrationWarning!==!0&&lh(m.textContent,Q,a),v=["children",""+Q]):s.hasOwnProperty(b)&&Q!=null&&b==="onScroll"&&fr("scroll",m)}switch(f){case"input":ut(m),Zt(m,E,!0);break;case"textarea":ut(m),Rr(m);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(m.onclick=ch)}m=v,l.updateQueue=m,m!==null&&(l.flags|=4)}else{b=v.nodeType===9?v:v.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=qn(f)),a==="http://www.w3.org/1999/xhtml"?f==="script"?(a=b.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof m.is=="string"?a=b.createElement(f,{is:m.is}):(a=b.createElement(f),f==="select"&&(b=a,m.multiple?b.multiple=!0:m.size&&(b.size=m.size))):a=b.createElementNS(a,f),a[Ni]=l,a[hu]=m,s_(a,l,!1,!1),l.stateNode=a;e:{switch(b=si(f,m),f){case"dialog":fr("cancel",a),fr("close",a),v=m;break;case"iframe":case"object":case"embed":fr("load",a),v=m;break;case"video":case"audio":for(v=0;v<cu.length;v++)fr(cu[v],a);v=m;break;case"source":fr("error",a),v=m;break;case"img":case"image":case"link":fr("error",a),fr("load",a),v=m;break;case"details":fr("toggle",a),v=m;break;case"input":Lt(a,m),v=wt(a,m),fr("invalid",a);break;case"option":v=m;break;case"select":a._wrapperState={wasMultiple:!!m.multiple},v=we({},m,{value:void 0}),fr("invalid",a);break;case"textarea":Sn(a,m),v=Tn(a,m),fr("invalid",a);break;default:v=m}Kn(f,v),Q=v;for(E in Q)if(Q.hasOwnProperty(E)){var re=Q[E];E==="style"?kn(a,re):E==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,re!=null&&Zr(a,re)):E==="children"?typeof re=="string"?(f!=="textarea"||re!=="")&&ot(a,re):typeof re=="number"&&ot(a,""+re):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(s.hasOwnProperty(E)?re!=null&&E==="onScroll"&&fr("scroll",a):re!=null&&N(a,E,re,b))}switch(f){case"input":ut(a),Zt(a,m,!1);break;case"textarea":ut(a),Rr(a);break;case"option":m.value!=null&&a.setAttribute("value",""+ve(m.value));break;case"select":a.multiple=!!m.multiple,E=m.value,E!=null?xr(a,!!m.multiple,E,!1):m.defaultValue!=null&&xr(a,!!m.multiple,m.defaultValue,!0);break;default:typeof v.onClick=="function"&&(a.onclick=ch)}switch(f){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Nn(l),null;case 6:if(a&&l.stateNode!=null)a_(a,l,a.memoizedProps,m);else{if(typeof m!="string"&&l.stateNode===null)throw Error(r(166));if(f=jo(xu.current),jo(bi.current),gh(l)){if(m=l.stateNode,f=l.memoizedProps,m[Ni]=l,(E=m.nodeValue!==f)&&(a=Is,a!==null))switch(a.tag){case 3:lh(m.nodeValue,f,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&lh(m.nodeValue,f,(a.mode&1)!==0)}E&&(l.flags|=4)}else m=(f.nodeType===9?f:f.ownerDocument).createTextNode(m),m[Ni]=l,l.stateNode=m}return Nn(l),null;case 13:if(hr(yr),m=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(vr&&Fs!==null&&(l.mode&1)!==0&&(l.flags&128)===0)cv(),Xl(),l.flags|=98560,E=!1;else if(E=gh(l),m!==null&&m.dehydrated!==null){if(a===null){if(!E)throw Error(r(318));if(E=l.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(r(317));E[Ni]=l}else Xl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Nn(l),E=!1}else oi!==null&&(qp(oi),oi=null),E=!0;if(!E)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=f,l):(m=m!==null,m!==(a!==null&&a.memoizedState!==null)&&m&&(l.child.flags|=8192,(l.mode&1)!==0&&(a===null||(yr.current&1)!==0?Xr===0&&(Xr=3):Yp())),l.updateQueue!==null&&(l.flags|=4),Nn(l),null);case 4:return Zl(),Lp(a,l),a===null&&uu(l.stateNode.containerInfo),Nn(l),null;case 10:return up(l.type._context),Nn(l),null;case 17:return fs(l.type)&&fh(),Nn(l),null;case 19:if(hr(yr),E=l.memoizedState,E===null)return Nn(l),null;if(m=(l.flags&128)!==0,b=E.rendering,b===null)if(m)Eu(E,!1);else{if(Xr!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(b=Eh(a),b!==null){for(l.flags|=128,Eu(E,!1),m=b.updateQueue,m!==null&&(l.updateQueue=m,l.flags|=4),l.subtreeFlags=0,m=f,f=l.child;f!==null;)E=f,a=m,E.flags&=14680066,b=E.alternate,b===null?(E.childLanes=0,E.lanes=a,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=b.childLanes,E.lanes=b.lanes,E.child=b.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=b.memoizedProps,E.memoizedState=b.memoizedState,E.updateQueue=b.updateQueue,E.type=b.type,a=b.dependencies,E.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),f=f.sibling;return cr(yr,yr.current&1|2),l.child}a=a.sibling}E.tail!==null&&Pe()>nc&&(l.flags|=128,m=!0,Eu(E,!1),l.lanes=4194304)}else{if(!m)if(a=Eh(b),a!==null){if(l.flags|=128,m=!0,f=a.updateQueue,f!==null&&(l.updateQueue=f,l.flags|=4),Eu(E,!0),E.tail===null&&E.tailMode==="hidden"&&!b.alternate&&!vr)return Nn(l),null}else 2*Pe()-E.renderingStartTime>nc&&f!==1073741824&&(l.flags|=128,m=!0,Eu(E,!1),l.lanes=4194304);E.isBackwards?(b.sibling=l.child,l.child=b):(f=E.last,f!==null?f.sibling=b:l.child=b,E.last=b)}return E.tail!==null?(l=E.tail,E.rendering=l,E.tail=l.sibling,E.renderingStartTime=Pe(),l.sibling=null,f=yr.current,cr(yr,m?f&1|2:f&1),l):(Nn(l),null);case 22:case 23:return Xp(),m=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==m&&(l.flags|=8192),m&&(l.mode&1)!==0?(Rs&1073741824)!==0&&(Nn(l),l.subtreeFlags&6&&(l.flags|=8192)):Nn(l),null;case 24:return null;case 25:return null}throw Error(r(156,l.tag))}function oA(a,l){switch(sp(l),l.tag){case 1:return fs(l.type)&&fh(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return Zl(),hr(us),hr(Fn),xp(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 5:return mp(l),null;case 13:if(hr(yr),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Xl()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return hr(yr),null;case 4:return Zl(),null;case 10:return up(l.type._context),null;case 22:case 23:return Xp(),null;case 24:return null;default:return null}}var Nh=!1,bn=!1,lA=typeof WeakSet=="function"?WeakSet:Set,Je=null;function tc(a,l){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(m){kr(a,l,m)}else f.current=null}function Mp(a,l,f){try{f()}catch(m){kr(a,l,m)}}var o_=!1;function cA(a,l){if(Xd=ta,a=Bx(),jd(a)){if("selectionStart"in a)var f={start:a.selectionStart,end:a.selectionEnd};else e:{f=(f=a.ownerDocument)&&f.defaultView||window;var m=f.getSelection&&f.getSelection();if(m&&m.rangeCount!==0){f=m.anchorNode;var v=m.anchorOffset,E=m.focusNode;m=m.focusOffset;try{f.nodeType,E.nodeType}catch{f=null;break e}var b=0,Q=-1,re=-1,de=0,be=0,Me=a,Fe=null;t:for(;;){for(var Xe;Me!==f||v!==0&&Me.nodeType!==3||(Q=b+v),Me!==E||m!==0&&Me.nodeType!==3||(re=b+m),Me.nodeType===3&&(b+=Me.nodeValue.length),(Xe=Me.firstChild)!==null;)Fe=Me,Me=Xe;for(;;){if(Me===a)break t;if(Fe===f&&++de===v&&(Q=b),Fe===E&&++be===m&&(re=b),(Xe=Me.nextSibling)!==null)break;Me=Fe,Fe=Me.parentNode}Me=Xe}f=Q===-1||re===-1?null:{start:Q,end:re}}else f=null}f=f||{start:0,end:0}}else f=null;for(Yd={focusedElem:a,selectionRange:f},ta=!1,Je=l;Je!==null;)if(l=Je,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,Je=a;else for(;Je!==null;){l=Je;try{var Ze=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Ze!==null){var et=Ze.memoizedProps,br=Ze.memoizedState,ie=l.stateNode,se=ie.getSnapshotBeforeUpdate(l.elementType===l.type?et:li(l.type,et),br);ie.__reactInternalSnapshotBeforeUpdate=se}break;case 3:var he=l.stateNode.containerInfo;he.nodeType===1?he.textContent="":he.nodeType===9&&he.documentElement&&he.removeChild(he.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Be){kr(l,l.return,Be)}if(a=l.sibling,a!==null){a.return=l.return,Je=a;break}Je=l.return}return Ze=o_,o_=!1,Ze}function Tu(a,l,f){var m=l.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var v=m=m.next;do{if((v.tag&a)===a){var E=v.destroy;v.destroy=void 0,E!==void 0&&Mp(l,f,E)}v=v.next}while(v!==m)}}function bh(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var f=l=l.next;do{if((f.tag&a)===a){var m=f.create;f.destroy=m()}f=f.next}while(f!==l)}}function Vp(a){var l=a.ref;if(l!==null){var f=a.stateNode;switch(a.tag){case 5:a=f;break;default:a=f}typeof l=="function"?l(a):l.current=a}}function l_(a){var l=a.alternate;l!==null&&(a.alternate=null,l_(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&(delete l[Ni],delete l[hu],delete l[ep],delete l[$4],delete l[G4])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function c_(a){return a.tag===5||a.tag===3||a.tag===4}function u_(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||c_(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Bp(a,l,f){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?f.nodeType===8?f.parentNode.insertBefore(a,l):f.insertBefore(a,l):(f.nodeType===8?(l=f.parentNode,l.insertBefore(a,f)):(l=f,l.appendChild(a)),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=ch));else if(m!==4&&(a=a.child,a!==null))for(Bp(a,l,f),a=a.sibling;a!==null;)Bp(a,l,f),a=a.sibling}function Up(a,l,f){var m=a.tag;if(m===5||m===6)a=a.stateNode,l?f.insertBefore(a,l):f.appendChild(a);else if(m!==4&&(a=a.child,a!==null))for(Up(a,l,f),a=a.sibling;a!==null;)Up(a,l,f),a=a.sibling}var pn=null,ci=!1;function Ga(a,l,f){for(f=f.child;f!==null;)f_(a,l,f),f=f.sibling}function f_(a,l,f){if(Se&&typeof Se.onCommitFiberUnmount=="function")try{Se.onCommitFiberUnmount(Jn,f)}catch{}switch(f.tag){case 5:bn||tc(f,l);case 6:var m=pn,v=ci;pn=null,Ga(a,l,f),pn=m,ci=v,pn!==null&&(ci?(a=pn,f=f.stateNode,a.nodeType===8?a.parentNode.removeChild(f):a.removeChild(f)):pn.removeChild(f.stateNode));break;case 18:pn!==null&&(ci?(a=pn,f=f.stateNode,a.nodeType===8?Zd(a.parentNode,f):a.nodeType===1&&Zd(a,f),La(a)):Zd(pn,f.stateNode));break;case 4:m=pn,v=ci,pn=f.stateNode.containerInfo,ci=!0,Ga(a,l,f),pn=m,ci=v;break;case 0:case 11:case 14:case 15:if(!bn&&(m=f.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){v=m=m.next;do{var E=v,b=E.destroy;E=E.tag,b!==void 0&&((E&2)!==0||(E&4)!==0)&&Mp(f,l,b),v=v.next}while(v!==m)}Ga(a,l,f);break;case 1:if(!bn&&(tc(f,l),m=f.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=f.memoizedProps,m.state=f.memoizedState,m.componentWillUnmount()}catch(Q){kr(f,l,Q)}Ga(a,l,f);break;case 21:Ga(a,l,f);break;case 22:f.mode&1?(bn=(m=bn)||f.memoizedState!==null,Ga(a,l,f),bn=m):Ga(a,l,f);break;default:Ga(a,l,f)}}function h_(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new lA),l.forEach(function(m){var v=vA.bind(null,a,m);f.has(m)||(f.add(m),m.then(v,v))})}}function ui(a,l){var f=l.deletions;if(f!==null)for(var m=0;m<f.length;m++){var v=f[m];try{var E=a,b=l,Q=b;e:for(;Q!==null;){switch(Q.tag){case 5:pn=Q.stateNode,ci=!1;break e;case 3:pn=Q.stateNode.containerInfo,ci=!0;break e;case 4:pn=Q.stateNode.containerInfo,ci=!0;break e}Q=Q.return}if(pn===null)throw Error(r(160));f_(E,b,v),pn=null,ci=!1;var re=v.alternate;re!==null&&(re.return=null),v.return=null}catch(de){kr(v,l,de)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)d_(l,a),l=l.sibling}function d_(a,l){var f=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(ui(l,a),Pi(a),m&4){try{Tu(3,a,a.return),bh(3,a)}catch(et){kr(a,a.return,et)}try{Tu(5,a,a.return)}catch(et){kr(a,a.return,et)}}break;case 1:ui(l,a),Pi(a),m&512&&f!==null&&tc(f,f.return);break;case 5:if(ui(l,a),Pi(a),m&512&&f!==null&&tc(f,f.return),a.flags&32){var v=a.stateNode;try{ot(v,"")}catch(et){kr(a,a.return,et)}}if(m&4&&(v=a.stateNode,v!=null)){var E=a.memoizedProps,b=f!==null?f.memoizedProps:E,Q=a.type,re=a.updateQueue;if(a.updateQueue=null,re!==null)try{Q==="input"&&E.type==="radio"&&E.name!=null&&xt(v,E),si(Q,b);var de=si(Q,E);for(b=0;b<re.length;b+=2){var be=re[b],Me=re[b+1];be==="style"?kn(v,Me):be==="dangerouslySetInnerHTML"?Zr(v,Me):be==="children"?ot(v,Me):N(v,be,Me,de)}switch(Q){case"input":je(v,E);break;case"textarea":_r(v,E);break;case"select":var Fe=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!E.multiple;var Xe=E.value;Xe!=null?xr(v,!!E.multiple,Xe,!1):Fe!==!!E.multiple&&(E.defaultValue!=null?xr(v,!!E.multiple,E.defaultValue,!0):xr(v,!!E.multiple,E.multiple?[]:"",!1))}v[hu]=E}catch(et){kr(a,a.return,et)}}break;case 6:if(ui(l,a),Pi(a),m&4){if(a.stateNode===null)throw Error(r(162));v=a.stateNode,E=a.memoizedProps;try{v.nodeValue=E}catch(et){kr(a,a.return,et)}}break;case 3:if(ui(l,a),Pi(a),m&4&&f!==null&&f.memoizedState.isDehydrated)try{La(l.containerInfo)}catch(et){kr(a,a.return,et)}break;case 4:ui(l,a),Pi(a);break;case 13:ui(l,a),Pi(a),v=a.child,v.flags&8192&&(E=v.memoizedState!==null,v.stateNode.isHidden=E,!E||v.alternate!==null&&v.alternate.memoizedState!==null||(Hp=Pe())),m&4&&h_(a);break;case 22:if(be=f!==null&&f.memoizedState!==null,a.mode&1?(bn=(de=bn)||be,ui(l,a),bn=de):ui(l,a),Pi(a),m&8192){if(de=a.memoizedState!==null,(a.stateNode.isHidden=de)&&!be&&(a.mode&1)!==0)for(Je=a,be=a.child;be!==null;){for(Me=Je=be;Je!==null;){switch(Fe=Je,Xe=Fe.child,Fe.tag){case 0:case 11:case 14:case 15:Tu(4,Fe,Fe.return);break;case 1:tc(Fe,Fe.return);var Ze=Fe.stateNode;if(typeof Ze.componentWillUnmount=="function"){m=Fe,f=Fe.return;try{l=m,Ze.props=l.memoizedProps,Ze.state=l.memoizedState,Ze.componentWillUnmount()}catch(et){kr(m,f,et)}}break;case 5:tc(Fe,Fe.return);break;case 22:if(Fe.memoizedState!==null){g_(Me);continue}}Xe!==null?(Xe.return=Fe,Je=Xe):g_(Me)}be=be.sibling}e:for(be=null,Me=a;;){if(Me.tag===5){if(be===null){be=Me;try{v=Me.stateNode,de?(E=v.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(Q=Me.stateNode,re=Me.memoizedProps.style,b=re!=null&&re.hasOwnProperty("display")?re.display:null,Q.style.display=Yt("display",b))}catch(et){kr(a,a.return,et)}}}else if(Me.tag===6){if(be===null)try{Me.stateNode.nodeValue=de?"":Me.memoizedProps}catch(et){kr(a,a.return,et)}}else if((Me.tag!==22&&Me.tag!==23||Me.memoizedState===null||Me===a)&&Me.child!==null){Me.child.return=Me,Me=Me.child;continue}if(Me===a)break e;for(;Me.sibling===null;){if(Me.return===null||Me.return===a)break e;be===Me&&(be=null),Me=Me.return}be===Me&&(be=null),Me.sibling.return=Me.return,Me=Me.sibling}}break;case 19:ui(l,a),Pi(a),m&4&&h_(a);break;case 21:break;default:ui(l,a),Pi(a)}}function Pi(a){var l=a.flags;if(l&2){try{e:{for(var f=a.return;f!==null;){if(c_(f)){var m=f;break e}f=f.return}throw Error(r(160))}switch(m.tag){case 5:var v=m.stateNode;m.flags&32&&(ot(v,""),m.flags&=-33);var E=u_(a);Up(a,E,v);break;case 3:case 4:var b=m.stateNode.containerInfo,Q=u_(a);Bp(a,Q,b);break;default:throw Error(r(161))}}catch(re){kr(a,a.return,re)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function uA(a,l,f){Je=a,p_(a)}function p_(a,l,f){for(var m=(a.mode&1)!==0;Je!==null;){var v=Je,E=v.child;if(v.tag===22&&m){var b=v.memoizedState!==null||Nh;if(!b){var Q=v.alternate,re=Q!==null&&Q.memoizedState!==null||bn;Q=Nh;var de=bn;if(Nh=b,(bn=re)&&!de)for(Je=v;Je!==null;)b=Je,re=b.child,b.tag===22&&b.memoizedState!==null?x_(v):re!==null?(re.return=b,Je=re):x_(v);for(;E!==null;)Je=E,p_(E),E=E.sibling;Je=v,Nh=Q,bn=de}m_(a)}else(v.subtreeFlags&8772)!==0&&E!==null?(E.return=v,Je=E):m_(a)}}function m_(a){for(;Je!==null;){var l=Je;if((l.flags&8772)!==0){var f=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:bn||bh(5,l);break;case 1:var m=l.stateNode;if(l.flags&4&&!bn)if(f===null)m.componentDidMount();else{var v=l.elementType===l.type?f.memoizedProps:li(l.type,f.memoizedProps);m.componentDidUpdate(v,f.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var E=l.updateQueue;E!==null&&gv(l,E,m);break;case 3:var b=l.updateQueue;if(b!==null){if(f=null,l.child!==null)switch(l.child.tag){case 5:f=l.child.stateNode;break;case 1:f=l.child.stateNode}gv(l,b,f)}break;case 5:var Q=l.stateNode;if(f===null&&l.flags&4){f=Q;var re=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":re.autoFocus&&f.focus();break;case"img":re.src&&(f.src=re.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var de=l.alternate;if(de!==null){var be=de.memoizedState;if(be!==null){var Me=be.dehydrated;Me!==null&&La(Me)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}bn||l.flags&512&&Vp(l)}catch(Fe){kr(l,l.return,Fe)}}if(l===a){Je=null;break}if(f=l.sibling,f!==null){f.return=l.return,Je=f;break}Je=l.return}}function g_(a){for(;Je!==null;){var l=Je;if(l===a){Je=null;break}var f=l.sibling;if(f!==null){f.return=l.return,Je=f;break}Je=l.return}}function x_(a){for(;Je!==null;){var l=Je;try{switch(l.tag){case 0:case 11:case 15:var f=l.return;try{bh(4,l)}catch(re){kr(l,f,re)}break;case 1:var m=l.stateNode;if(typeof m.componentDidMount=="function"){var v=l.return;try{m.componentDidMount()}catch(re){kr(l,v,re)}}var E=l.return;try{Vp(l)}catch(re){kr(l,E,re)}break;case 5:var b=l.return;try{Vp(l)}catch(re){kr(l,b,re)}}}catch(re){kr(l,l.return,re)}if(l===a){Je=null;break}var Q=l.sibling;if(Q!==null){Q.return=l.return,Je=Q;break}Je=l.return}}var fA=Math.ceil,Dh=V.ReactCurrentDispatcher,jp=V.ReactCurrentOwner,$s=V.ReactCurrentBatchConfig,zt=0,tn=null,Vr=null,mn=0,Rs=0,rc=ja(0),Xr=0,Su=null,Ho=0,Ph=0,zp=0,ku=null,ds=null,Hp=0,nc=1/0,fa=null,Oh=!1,Wp=null,qa=null,Lh=!1,Ka=null,Mh=0,Au=0,$p=null,Vh=-1,Bh=0;function es(){return(zt&6)!==0?Pe():Vh!==-1?Vh:Vh=Pe()}function Xa(a){return(a.mode&1)===0?1:(zt&2)!==0&&mn!==0?mn&-mn:K4.transition!==null?(Bh===0&&(Bh=qc()),Bh):(a=Vt,a!==0||(a=window.event,a=a===void 0?16:bl(a.type)),a)}function fi(a,l,f,m){if(50<Au)throw Au=0,$p=null,Error(r(185));No(a,f,m),((zt&2)===0||a!==tn)&&(a===tn&&((zt&2)===0&&(Ph|=f),Xr===4&&Ya(a,mn)),ps(a,m),f===1&&zt===0&&(l.mode&1)===0&&(nc=Pe()+500,dh&&Ha()))}function ps(a,l){var f=a.callbackNode;Ji(a,l);var m=un(a,a===tn?mn:0);if(m===0)f!==null&&Ue(f),a.callbackNode=null,a.callbackPriority=0;else if(l=m&-m,a.callbackPriority!==l){if(f!=null&&Ue(f),l===1)a.tag===0?q4(__.bind(null,a)):sv(__.bind(null,a)),H4(function(){(zt&6)===0&&Ha()}),f=null;else{switch(wi(m)){case 1:f=$t;break;case 4:f=Qt;break;case 16:f=lr;break;case 536870912:f=cs;break;default:f=lr}f=C_(f,v_.bind(null,a))}a.callbackPriority=l,a.callbackNode=f}}function v_(a,l){if(Vh=-1,Bh=0,(zt&6)!==0)throw Error(r(327));var f=a.callbackNode;if(sc()&&a.callbackNode!==f)return null;var m=un(a,a===tn?mn:0);if(m===0)return null;if((m&30)!==0||(m&a.expiredLanes)!==0||l)l=Uh(a,m);else{l=m;var v=zt;zt|=2;var E=w_();(tn!==a||mn!==l)&&(fa=null,nc=Pe()+500,$o(a,l));do try{pA();break}catch(Q){y_(a,Q)}while(!0);cp(),Dh.current=E,zt=v,Vr!==null?l=0:(tn=null,mn=0,l=Xr)}if(l!==0){if(l===2&&(v=Gc(a),v!==0&&(m=v,l=Gp(a,v))),l===1)throw f=Su,$o(a,0),Ya(a,m),ps(a,Pe()),f;if(l===6)Ya(a,m);else{if(v=a.current.alternate,(m&30)===0&&!hA(v)&&(l=Uh(a,m),l===2&&(E=Gc(a),E!==0&&(m=E,l=Gp(a,E))),l===1))throw f=Su,$o(a,0),Ya(a,m),ps(a,Pe()),f;switch(a.finishedWork=v,a.finishedLanes=m,l){case 0:case 1:throw Error(r(345));case 2:Go(a,ds,fa);break;case 3:if(Ya(a,m),(m&130023424)===m&&(l=Hp+500-Pe(),10<l)){if(un(a,0)!==0)break;if(v=a.suspendedLanes,(v&m)!==m){es(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=Jd(Go.bind(null,a,ds,fa),l);break}Go(a,ds,fa);break;case 4:if(Ya(a,m),(m&4194240)===m)break;for(l=a.eventTimes,v=-1;0<m;){var b=31-ze(m);E=1<<b,b=l[b],b>v&&(v=b),m&=~E}if(m=v,m=Pe()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*fA(m/1960))-m,10<m){a.timeoutHandle=Jd(Go.bind(null,a,ds,fa),m);break}Go(a,ds,fa);break;case 5:Go(a,ds,fa);break;default:throw Error(r(329))}}}return ps(a,Pe()),a.callbackNode===f?v_.bind(null,a):null}function Gp(a,l){var f=ku;return a.current.memoizedState.isDehydrated&&($o(a,l).flags|=256),a=Uh(a,l),a!==2&&(l=ds,ds=f,l!==null&&qp(l)),a}function qp(a){ds===null?ds=a:ds.push.apply(ds,a)}function hA(a){for(var l=a;;){if(l.flags&16384){var f=l.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var m=0;m<f.length;m++){var v=f[m],E=v.getSnapshot;v=v.value;try{if(!ai(E(),v))return!1}catch{return!1}}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ya(a,l){for(l&=~zp,l&=~Ph,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var f=31-ze(l),m=1<<f;a[f]=-1,l&=~m}}function __(a){if((zt&6)!==0)throw Error(r(327));sc();var l=un(a,0);if((l&1)===0)return ps(a,Pe()),null;var f=Uh(a,l);if(a.tag!==0&&f===2){var m=Gc(a);m!==0&&(l=m,f=Gp(a,m))}if(f===1)throw f=Su,$o(a,0),Ya(a,l),ps(a,Pe()),f;if(f===6)throw Error(r(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,Go(a,ds,fa),ps(a,Pe()),null}function Kp(a,l){var f=zt;zt|=1;try{return a(l)}finally{zt=f,zt===0&&(nc=Pe()+500,dh&&Ha())}}function Wo(a){Ka!==null&&Ka.tag===0&&(zt&6)===0&&sc();var l=zt;zt|=1;var f=$s.transition,m=Vt;try{if($s.transition=null,Vt=1,a)return a()}finally{Vt=m,$s.transition=f,zt=l,(zt&6)===0&&Ha()}}function Xp(){Rs=rc.current,hr(rc)}function $o(a,l){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==-1&&(a.timeoutHandle=-1,z4(f)),Vr!==null)for(f=Vr.return;f!==null;){var m=f;switch(sp(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&fh();break;case 3:Zl(),hr(us),hr(Fn),xp();break;case 5:mp(m);break;case 4:Zl();break;case 13:hr(yr);break;case 19:hr(yr);break;case 10:up(m.type._context);break;case 22:case 23:Xp()}f=f.return}if(tn=a,Vr=a=Qa(a.current,null),mn=Rs=l,Xr=0,Su=null,zp=Ph=Ho=0,ds=ku=null,Uo!==null){for(l=0;l<Uo.length;l++)if(f=Uo[l],m=f.interleaved,m!==null){f.interleaved=null;var v=m.next,E=f.pending;if(E!==null){var b=E.next;E.next=v,m.next=b}f.pending=m}Uo=null}return a}function y_(a,l){do{var f=Vr;try{if(cp(),Th.current=Ch,Sh){for(var m=wr.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}Sh=!1}if(zo=0,en=Kr=wr=null,vu=!1,_u=0,jp.current=null,f===null||f.return===null){Xr=1,Su=l,Vr=null;break}e:{var E=a,b=f.return,Q=f,re=l;if(l=mn,Q.flags|=32768,re!==null&&typeof re=="object"&&typeof re.then=="function"){var de=re,be=Q,Me=be.tag;if((be.mode&1)===0&&(Me===0||Me===11||Me===15)){var Fe=be.alternate;Fe?(be.updateQueue=Fe.updateQueue,be.memoizedState=Fe.memoizedState,be.lanes=Fe.lanes):(be.updateQueue=null,be.memoizedState=null)}var Xe=$v(b);if(Xe!==null){Xe.flags&=-257,Gv(Xe,b,Q,E,l),Xe.mode&1&&Wv(E,de,l),l=Xe,re=de;var Ze=l.updateQueue;if(Ze===null){var et=new Set;et.add(re),l.updateQueue=et}else Ze.add(re);break e}else{if((l&1)===0){Wv(E,de,l),Yp();break e}re=Error(r(426))}}else if(vr&&Q.mode&1){var br=$v(b);if(br!==null){(br.flags&65536)===0&&(br.flags|=256),Gv(br,b,Q,E,l),op(ec(re,Q));break e}}E=re=ec(re,Q),Xr!==4&&(Xr=2),ku===null?ku=[E]:ku.push(E),E=b;do{switch(E.tag){case 3:E.flags|=65536,l&=-l,E.lanes|=l;var ie=zv(E,re,l);mv(E,ie);break e;case 1:Q=re;var se=E.type,he=E.stateNode;if((E.flags&128)===0&&(typeof se.getDerivedStateFromError=="function"||he!==null&&typeof he.componentDidCatch=="function"&&(qa===null||!qa.has(he)))){E.flags|=65536,l&=-l,E.lanes|=l;var Be=Hv(E,Q,l);mv(E,Be);break e}}E=E.return}while(E!==null)}T_(f)}catch(tt){l=tt,Vr===f&&f!==null&&(Vr=f=f.return);continue}break}while(!0)}function w_(){var a=Dh.current;return Dh.current=Ch,a===null?Ch:a}function Yp(){(Xr===0||Xr===3||Xr===2)&&(Xr=4),tn===null||(Ho&268435455)===0&&(Ph&268435455)===0||Ya(tn,mn)}function Uh(a,l){var f=zt;zt|=2;var m=w_();(tn!==a||mn!==l)&&(fa=null,$o(a,l));do try{dA();break}catch(v){y_(a,v)}while(!0);if(cp(),zt=f,Dh.current=m,Vr!==null)throw Error(r(261));return tn=null,mn=0,Xr}function dA(){for(;Vr!==null;)E_(Vr)}function pA(){for(;Vr!==null&&!Ge();)E_(Vr)}function E_(a){var l=A_(a.alternate,a,Rs);a.memoizedProps=a.pendingProps,l===null?T_(a):Vr=l,jp.current=null}function T_(a){var l=a;do{var f=l.alternate;if(a=l.return,(l.flags&32768)===0){if(f=aA(f,l,Rs),f!==null){Vr=f;return}}else{if(f=oA(f,l),f!==null){f.flags&=32767,Vr=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Xr=6,Vr=null;return}}if(l=l.sibling,l!==null){Vr=l;return}Vr=l=a}while(l!==null);Xr===0&&(Xr=5)}function Go(a,l,f){var m=Vt,v=$s.transition;try{$s.transition=null,Vt=1,mA(a,l,f,m)}finally{$s.transition=v,Vt=m}return null}function mA(a,l,f,m){do sc();while(Ka!==null);if((zt&6)!==0)throw Error(r(327));f=a.finishedWork;var v=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(r(177));a.callbackNode=null,a.callbackPriority=0;var E=f.lanes|f.childLanes;if(Ld(a,E),a===tn&&(Vr=tn=null,mn=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||Lh||(Lh=!0,C_(lr,function(){return sc(),null})),E=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||E){E=$s.transition,$s.transition=null;var b=Vt;Vt=1;var Q=zt;zt|=4,jp.current=null,cA(a,f),d_(f,a),O4(Yd),ta=!!Xd,Yd=Xd=null,a.current=f,uA(f),Oe(),zt=Q,Vt=b,$s.transition=E}else a.current=f;if(Lh&&(Lh=!1,Ka=a,Mh=v),E=a.pendingLanes,E===0&&(qa=null),Ie(f.stateNode),ps(a,Pe()),l!==null)for(m=a.onRecoverableError,f=0;f<l.length;f++)v=l[f],m(v.value,{componentStack:v.stack,digest:v.digest});if(Oh)throw Oh=!1,a=Wp,Wp=null,a;return(Mh&1)!==0&&a.tag!==0&&sc(),E=a.pendingLanes,(E&1)!==0?a===$p?Au++:(Au=0,$p=a):Au=0,Ha(),null}function sc(){if(Ka!==null){var a=wi(Mh),l=$s.transition,f=Vt;try{if($s.transition=null,Vt=16>a?16:a,Ka===null)var m=!1;else{if(a=Ka,Ka=null,Mh=0,(zt&6)!==0)throw Error(r(331));var v=zt;for(zt|=4,Je=a.current;Je!==null;){var E=Je,b=E.child;if((Je.flags&16)!==0){var Q=E.deletions;if(Q!==null){for(var re=0;re<Q.length;re++){var de=Q[re];for(Je=de;Je!==null;){var be=Je;switch(be.tag){case 0:case 11:case 15:Tu(8,be,E)}var Me=be.child;if(Me!==null)Me.return=be,Je=Me;else for(;Je!==null;){be=Je;var Fe=be.sibling,Xe=be.return;if(l_(be),be===de){Je=null;break}if(Fe!==null){Fe.return=Xe,Je=Fe;break}Je=Xe}}}var Ze=E.alternate;if(Ze!==null){var et=Ze.child;if(et!==null){Ze.child=null;do{var br=et.sibling;et.sibling=null,et=br}while(et!==null)}}Je=E}}if((E.subtreeFlags&2064)!==0&&b!==null)b.return=E,Je=b;else e:for(;Je!==null;){if(E=Je,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:Tu(9,E,E.return)}var ie=E.sibling;if(ie!==null){ie.return=E.return,Je=ie;break e}Je=E.return}}var se=a.current;for(Je=se;Je!==null;){b=Je;var he=b.child;if((b.subtreeFlags&2064)!==0&&he!==null)he.return=b,Je=he;else e:for(b=se;Je!==null;){if(Q=Je,(Q.flags&2048)!==0)try{switch(Q.tag){case 0:case 11:case 15:bh(9,Q)}}catch(tt){kr(Q,Q.return,tt)}if(Q===b){Je=null;break e}var Be=Q.sibling;if(Be!==null){Be.return=Q.return,Je=Be;break e}Je=Q.return}}if(zt=v,Ha(),Se&&typeof Se.onPostCommitFiberRoot=="function")try{Se.onPostCommitFiberRoot(Jn,a)}catch{}m=!0}return m}finally{Vt=f,$s.transition=l}}return!1}function S_(a,l,f){l=ec(f,l),l=zv(a,l,1),a=$a(a,l,1),l=es(),a!==null&&(No(a,1,l),ps(a,l))}function kr(a,l,f){if(a.tag===3)S_(a,a,f);else for(;l!==null;){if(l.tag===3){S_(l,a,f);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(qa===null||!qa.has(m))){a=ec(f,a),a=Hv(l,a,1),l=$a(l,a,1),a=es(),l!==null&&(No(l,1,a),ps(l,a));break}}l=l.return}}function gA(a,l,f){var m=a.pingCache;m!==null&&m.delete(l),l=es(),a.pingedLanes|=a.suspendedLanes&f,tn===a&&(mn&f)===f&&(Xr===4||Xr===3&&(mn&130023424)===mn&&500>Pe()-Hp?$o(a,0):zp|=f),ps(a,l)}function k_(a,l){l===0&&((a.mode&1)===0?l=1:(l=Us,Us<<=1,(Us&130023424)===0&&(Us=4194304)));var f=es();a=la(a,l),a!==null&&(No(a,l,f),ps(a,f))}function xA(a){var l=a.memoizedState,f=0;l!==null&&(f=l.retryLane),k_(a,f)}function vA(a,l){var f=0;switch(a.tag){case 13:var m=a.stateNode,v=a.memoizedState;v!==null&&(f=v.retryLane);break;case 19:m=a.stateNode;break;default:throw Error(r(314))}m!==null&&m.delete(l),k_(a,f)}var A_;A_=function(a,l,f){if(a!==null)if(a.memoizedProps!==l.pendingProps||us.current)hs=!0;else{if((a.lanes&f)===0&&(l.flags&128)===0)return hs=!1,iA(a,l,f);hs=(a.flags&131072)!==0}else hs=!1,vr&&(l.flags&1048576)!==0&&iv(l,mh,l.index);switch(l.lanes=0,l.tag){case 2:var m=l.type;Rh(a,l),a=l.pendingProps;var v=Gl(l,Fn.current);Jl(l,f),v=yp(null,l,m,a,v,f);var E=wp();return l.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,fs(m)?(E=!0,hh(l)):E=!1,l.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,dp(l),v.updater=Ih,l.stateNode=v,v._reactInternals=l,Cp(l,m,a,f),l=Np(null,l,m,!0,E,f)):(l.tag=0,vr&&E&&np(l),Zn(null,l,v,f),l=l.child),l;case 16:m=l.elementType;e:{switch(Rh(a,l),a=l.pendingProps,v=m._init,m=v(m._payload),l.type=m,v=l.tag=yA(m),a=li(m,a),v){case 0:l=Rp(null,l,m,a,f);break e;case 1:l=Jv(null,l,m,a,f);break e;case 11:l=qv(null,l,m,a,f);break e;case 14:l=Kv(null,l,m,li(m.type,a),f);break e}throw Error(r(306,m,""))}return l;case 0:return m=l.type,v=l.pendingProps,v=l.elementType===m?v:li(m,v),Rp(a,l,m,v,f);case 1:return m=l.type,v=l.pendingProps,v=l.elementType===m?v:li(m,v),Jv(a,l,m,v,f);case 3:e:{if(Zv(l),a===null)throw Error(r(387));m=l.pendingProps,E=l.memoizedState,v=E.element,pv(a,l),wh(l,m,null,f);var b=l.memoizedState;if(m=b.element,E.isDehydrated)if(E={element:m,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){v=ec(Error(r(423)),l),l=e_(a,l,m,f,v);break e}else if(m!==v){v=ec(Error(r(424)),l),l=e_(a,l,m,f,v);break e}else for(Fs=Ua(l.stateNode.containerInfo.firstChild),Is=l,vr=!0,oi=null,f=hv(l,null,m,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Xl(),m===v){l=ua(a,l,f);break e}Zn(a,l,m,f)}l=l.child}return l;case 5:return xv(l),a===null&&ap(l),m=l.type,v=l.pendingProps,E=a!==null?a.memoizedProps:null,b=v.children,Qd(m,v)?b=null:E!==null&&Qd(m,E)&&(l.flags|=32),Qv(a,l),Zn(a,l,b,f),l.child;case 6:return a===null&&ap(l),null;case 13:return t_(a,l,f);case 4:return pp(l,l.stateNode.containerInfo),m=l.pendingProps,a===null?l.child=Yl(l,null,m,f):Zn(a,l,m,f),l.child;case 11:return m=l.type,v=l.pendingProps,v=l.elementType===m?v:li(m,v),qv(a,l,m,v,f);case 7:return Zn(a,l,l.pendingProps,f),l.child;case 8:return Zn(a,l,l.pendingProps.children,f),l.child;case 12:return Zn(a,l,l.pendingProps.children,f),l.child;case 10:e:{if(m=l.type._context,v=l.pendingProps,E=l.memoizedProps,b=v.value,cr(vh,m._currentValue),m._currentValue=b,E!==null)if(ai(E.value,b)){if(E.children===v.children&&!us.current){l=ua(a,l,f);break e}}else for(E=l.child,E!==null&&(E.return=l);E!==null;){var Q=E.dependencies;if(Q!==null){b=E.child;for(var re=Q.firstContext;re!==null;){if(re.context===m){if(E.tag===1){re=ca(-1,f&-f),re.tag=2;var de=E.updateQueue;if(de!==null){de=de.shared;var be=de.pending;be===null?re.next=re:(re.next=be.next,be.next=re),de.pending=re}}E.lanes|=f,re=E.alternate,re!==null&&(re.lanes|=f),fp(E.return,f,l),Q.lanes|=f;break}re=re.next}}else if(E.tag===10)b=E.type===l.type?null:E.child;else if(E.tag===18){if(b=E.return,b===null)throw Error(r(341));b.lanes|=f,Q=b.alternate,Q!==null&&(Q.lanes|=f),fp(b,f,l),b=E.sibling}else b=E.child;if(b!==null)b.return=E;else for(b=E;b!==null;){if(b===l){b=null;break}if(E=b.sibling,E!==null){E.return=b.return,b=E;break}b=b.return}E=b}Zn(a,l,v.children,f),l=l.child}return l;case 9:return v=l.type,m=l.pendingProps.children,Jl(l,f),v=Hs(v),m=m(v),l.flags|=1,Zn(a,l,m,f),l.child;case 14:return m=l.type,v=li(m,l.pendingProps),v=li(m.type,v),Kv(a,l,m,v,f);case 15:return Xv(a,l,l.type,l.pendingProps,f);case 17:return m=l.type,v=l.pendingProps,v=l.elementType===m?v:li(m,v),Rh(a,l),l.tag=1,fs(m)?(a=!0,hh(l)):a=!1,Jl(l,f),Uv(l,m,v),Cp(l,m,v,f),Np(null,l,m,!0,a,f);case 19:return n_(a,l,f);case 22:return Yv(a,l,f)}throw Error(r(156,l.tag))};function C_(a,l){return Ne(a,l)}function _A(a,l,f,m){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gs(a,l,f,m){return new _A(a,l,f,m)}function Qp(a){return a=a.prototype,!(!a||!a.isReactComponent)}function yA(a){if(typeof a=="function")return Qp(a)?1:0;if(a!=null){if(a=a.$$typeof,a===D)return 11;if(a===Re)return 14}return 2}function Qa(a,l){var f=a.alternate;return f===null?(f=Gs(a.tag,l,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=l,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,l=a.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function jh(a,l,f,m,v,E){var b=2;if(m=a,typeof a=="function")Qp(a)&&(b=1);else if(typeof a=="string")b=5;else e:switch(a){case A:return qo(f.children,v,E,l);case F:b=8,v|=8;break;case I:return a=Gs(12,f,l,v|2),a.elementType=I,a.lanes=E,a;case B:return a=Gs(13,f,l,v),a.elementType=B,a.lanes=E,a;case De:return a=Gs(19,f,l,v),a.elementType=De,a.lanes=E,a;case Le:return zh(f,v,E,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case U:b=10;break e;case L:b=9;break e;case D:b=11;break e;case Re:b=14;break e;case Ve:b=16,m=null;break e}throw Error(r(130,a==null?a:typeof a,""))}return l=Gs(b,f,l,v),l.elementType=a,l.type=m,l.lanes=E,l}function qo(a,l,f,m){return a=Gs(7,a,m,l),a.lanes=f,a}function zh(a,l,f,m){return a=Gs(22,a,m,l),a.elementType=Le,a.lanes=f,a.stateNode={isHidden:!1},a}function Jp(a,l,f){return a=Gs(6,a,null,l),a.lanes=f,a}function Zp(a,l,f){return l=Gs(4,a.children!==null?a.children:[],a.key,l),l.lanes=f,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function wA(a,l,f,m,v){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kc(0),this.expirationTimes=Kc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kc(0),this.identifierPrefix=m,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function em(a,l,f,m,v,E,b,Q,re){return a=new wA(a,l,f,Q,re),l===1?(l=1,E===!0&&(l|=8)):l=0,E=Gs(3,null,null,l),a.current=E,E.stateNode=a,E.memoizedState={element:m,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},dp(E),a}function EA(a,l,f){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j,key:m==null?null:""+m,children:a,containerInfo:l,implementation:f}}function I_(a){if(!a)return za;a=a._reactInternals;e:{if(X(a)!==a||a.tag!==1)throw Error(r(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(fs(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(r(171))}if(a.tag===1){var f=a.type;if(fs(f))return rv(a,f,l)}return l}function F_(a,l,f,m,v,E,b,Q,re){return a=em(f,m,!0,a,v,E,b,Q,re),a.context=I_(null),f=a.current,m=es(),v=Xa(f),E=ca(m,v),E.callback=l??null,$a(f,E,v),a.current.lanes=v,No(a,v,m),ps(a,m),a}function Hh(a,l,f,m){var v=l.current,E=es(),b=Xa(v);return f=I_(f),l.context===null?l.context=f:l.pendingContext=f,l=ca(E,b),l.payload={element:a},m=m===void 0?null:m,m!==null&&(l.callback=m),a=$a(v,l,b),a!==null&&(fi(a,v,b,E),yh(a,v,b)),b}function Wh(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function R_(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<l?f:l}}function tm(a,l){R_(a,l),(a=a.alternate)&&R_(a,l)}function TA(){return null}var N_=typeof reportError=="function"?reportError:function(a){console.error(a)};function rm(a){this._internalRoot=a}$h.prototype.render=rm.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(r(409));Hh(a,l,null,null)},$h.prototype.unmount=rm.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;Wo(function(){Hh(null,a,null,null)}),l[sa]=null}};function $h(a){this._internalRoot=a}$h.prototype.unstable_scheduleHydration=function(a){if(a){var l=Jc();a={blockedOn:null,target:a,priority:l};for(var f=0;f<Ss.length&&l!==0&&l<Ss[f].priority;f++);Ss.splice(f,0,a),f===0&&Rl(a)}};function nm(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Gh(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function b_(){}function SA(a,l,f,m,v){if(v){if(typeof m=="function"){var E=m;m=function(){var de=Wh(b);E.call(de)}}var b=F_(l,m,a,0,null,!1,!1,"",b_);return a._reactRootContainer=b,a[sa]=b.current,uu(a.nodeType===8?a.parentNode:a),Wo(),b}for(;v=a.lastChild;)a.removeChild(v);if(typeof m=="function"){var Q=m;m=function(){var de=Wh(re);Q.call(de)}}var re=em(a,0,!1,null,null,!1,!1,"",b_);return a._reactRootContainer=re,a[sa]=re.current,uu(a.nodeType===8?a.parentNode:a),Wo(function(){Hh(l,re,f,m)}),re}function qh(a,l,f,m,v){var E=f._reactRootContainer;if(E){var b=E;if(typeof v=="function"){var Q=v;v=function(){var re=Wh(b);Q.call(re)}}Hh(l,b,a,v)}else b=SA(f,l,a,v,m);return Wh(b)}Yc=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var f=bt(l.pendingLanes);f!==0&&(Xc(l,f|1),ps(l,Pe()),(zt&6)===0&&(nc=Pe()+500,Ha()))}break;case 13:Wo(function(){var m=la(a,1);if(m!==null){var v=es();fi(m,a,1,v)}}),tm(a,1)}},Il=function(a){if(a.tag===13){var l=la(a,134217728);if(l!==null){var f=es();fi(l,a,134217728,f)}tm(a,134217728)}},Qc=function(a){if(a.tag===13){var l=Xa(a),f=la(a,l);if(f!==null){var m=es();fi(f,a,l,m)}tm(a,l)}},Jc=function(){return Vt},Zc=function(a,l){var f=Vt;try{return Vt=a,l()}finally{Vt=f}},Qe=function(a,l,f){switch(l){case"input":if(je(a,f),l=f.name,f.type==="radio"&&l!=null){for(f=a;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<f.length;l++){var m=f[l];if(m!==a&&m.form===a.form){var v=uh(m);if(!v)throw Error(r(90));Y(m),je(m,v)}}}break;case"textarea":_r(a,f);break;case"select":l=f.value,l!=null&&xr(a,!!f.multiple,l,!1)}},Yn=Kp,ba=Wo;var kA={usingClientEntryPoint:!1,Events:[du,Wl,uh,An,Bs,Kp]},Cu={findFiberByHostInstance:Lo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},AA={bundleType:Cu.bundleType,version:Cu.version,rendererPackageName:Cu.rendererPackageName,rendererConfig:Cu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:V.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=ue(a),a===null?null:a.stateNode},findFiberByHostInstance:Cu.findFiberByHostInstance||TA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kh.isDisabled&&Kh.supportsFiber)try{Jn=Kh.inject(AA),Se=Kh}catch{}}return ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kA,ms.createPortal=function(a,l){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nm(l))throw Error(r(200));return EA(a,l,null,f)},ms.createRoot=function(a,l){if(!nm(a))throw Error(r(299));var f=!1,m="",v=N_;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onRecoverableError!==void 0&&(v=l.onRecoverableError)),l=em(a,1,!1,null,null,f,!1,m,v),a[sa]=l.current,uu(a.nodeType===8?a.parentNode:a),new rm(l)},ms.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=ue(l),a=a===null?null:a.stateNode,a},ms.flushSync=function(a){return Wo(a)},ms.hydrate=function(a,l,f){if(!Gh(l))throw Error(r(200));return qh(null,a,l,!0,f)},ms.hydrateRoot=function(a,l,f){if(!nm(a))throw Error(r(405));var m=f!=null&&f.hydratedSources||null,v=!1,E="",b=N_;if(f!=null&&(f.unstable_strictMode===!0&&(v=!0),f.identifierPrefix!==void 0&&(E=f.identifierPrefix),f.onRecoverableError!==void 0&&(b=f.onRecoverableError)),l=F_(l,null,a,1,f??null,v,!1,E,b),a[sa]=l.current,uu(a),m)for(a=0;a<m.length;a++)f=m[a],v=f._getVersion,v=v(f._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[f,v]:l.mutableSourceEagerHydrationData.push(f,v);return new $h(l)},ms.render=function(a,l,f){if(!Gh(l))throw Error(r(200));return qh(null,a,l,!1,f)},ms.unmountComponentAtNode=function(a){if(!Gh(a))throw Error(r(40));return a._reactRootContainer?(Wo(function(){qh(null,null,a,!1,function(){a._reactRootContainer=null,a[sa]=null})}),!0):!1},ms.unstable_batchedUpdates=Kp,ms.unstable_renderSubtreeIntoContainer=function(a,l,f,m){if(!Gh(f))throw Error(r(200));if(a==null||a._reactInternals===void 0)throw Error(r(38));return qh(a,l,f,!1,m)},ms.version="18.3.1-next-f1338f8080-20240426",ms}var U_;function LA(){if(U_)return om.exports;U_=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),om.exports=OA(),om.exports}var j_;function MA(){if(j_)return Yh;j_=1;var t=LA();return Yh.createRoot=t.createRoot,Yh.hydrateRoot=t.hydrateRoot,Yh}var VA=MA();const BA=Ow(VA),UA="modulepreload",jA=function(t){return"/"+t},z_={},Ca=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){let o=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=o(r.map(h=>{if(h=jA(h),h in z_)return;z_[h]=!0;const d=h.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const x=document.createElement("link");if(x.rel=d?"stylesheet":UA,d||(x.as="script"),x.crossOrigin="",x.href=h,u&&x.setAttribute("nonce",u),document.head.appendChild(x),d)return new Promise((_,k)=>{x.addEventListener("load",_),x.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},um={" ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]," ()":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],:["","","","","","","","","","","","","","","","","",""],:["","","","","",""]},Lw=[{id:"qualitative",name:"",desc:""},{id:"emotional",name:"",desc:""},{id:"friendly",name:"",desc:""},{id:"humorous",name:"",desc:""},{id:"internal",name:"",desc:""},{id:"philosophical",name:"",desc:""},{id:"practical",name:"",desc:""},{id:"resonance",name:"",desc:""},{id:"blessing",name:"",desc:""},{id:"scenario",name:"",desc:""},{id:"milestone",name:"",desc:""},{id:"journey",name:"",desc:""}],bg=()=>localStorage.getItem("gemini_api_key")||"",H_=()=>!!bg(),fm=async(t,e,r=[],n)=>{var k,y,S,R,M,N,V,W;const s=bg();if(!s)return"  API Key Gemini API Key";const i=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${s}`;let o="";r.length>0?o=r.map(j=>{const A=Lw.find(F=>F.id===j);return A?`${A.name}${A.desc}`:""}).join(`
`):o="";const u=`${{normal:"",casual:"",formal:""}[n.tone]||""}`,h=` ${n.wordCount||80} `,d=`""

 ****
- 
- 
- 
- 

${t}
${e||""}

****
1. ${u}
2. ${h}

 ${r.length||1} 
${o}

****
1. 
2. 
3. ** Markdown ** ******# 
4. ****
5. 
6. ****
7. 

...
()

...
`;let g=0;const x=5,_=[1e3,2e3,4e3,8e3,16e3];for(;g<=x;)try{const j=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:d}]}]})});if(!j.ok){if(j.status===400||j.status===401||j.status===403)return" API Key ";if(j.status===429){const I=await j.json().catch(()=>({})),U=(S=(y=(k=I==null?void 0:I.error)==null?void 0:k.details)==null?void 0:y.find(L=>{var D;return(D=L["@type"])==null?void 0:D.includes("RetryInfo")}))==null?void 0:S.retryDelay;if(U&&g<x){const L=parseInt(U)*1e3||_[g];await new Promise(D=>setTimeout(D,Math.min(L,1e4))),g++;continue}return" API  API Key"}throw new Error(`API Error: ${j.status}`)}return((W=(V=(N=(M=(R=(await j.json()).candidates)==null?void 0:R[0])==null?void 0:M.content)==null?void 0:N.parts)==null?void 0:V[0])==null?void 0:W.text)||""}catch(j){if(g===x)return console.error("Gemini API Failed:",j)," ";await new Promise(A=>setTimeout(A,_[g])),g++}},zA=async(t,e,r=3)=>{var g,x,_,k,y;const n=bg();if(!n)return"  API Key";if(!t||t.includes(""))return" ";const s=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${n}`,i={1:"",2:"",3:"",4:"",5:""},o={shorter:" 30-50%",detailed:" 30-50%",rephrase:""},c=`

 ****
- 
- 
- 

****
${t}

****
${o[e]||o.rephrase}

****
${i[r]||i[3]}

****
1. 
2.  Markdown 
3. 
4. 
`;let u=0;const h=3,d=[1e3,2e3,4e3];for(;u<=h;)try{const S=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:c}]}]})});if(!S.ok){if(S.status===400||S.status===401||S.status===403)return" API Key ";if(S.status===429)return" API ";throw new Error(`API Error: ${S.status}`)}const M=(y=(k=(_=(x=(g=(await S.json()).candidates)==null?void 0:g[0])==null?void 0:x.content)==null?void 0:_.parts)==null?void 0:k[0])==null?void 0:y.text;return(M==null?void 0:M.trim())||" "}catch(S){if(u===h)return console.error("Gemini API Adjust Failed:",S)," ";await new Promise(R=>setTimeout(R,d[u])),u++}};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Mw=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var WA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $A=ye.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:o,...c},u)=>ye.createElement("svg",{ref:u,...WA,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:Mw("lucide",s),...c},[...o.map(([h,d])=>ye.createElement(h,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=(t,e)=>{const r=ye.forwardRef(({className:n,...s},i)=>ye.createElement($A,{ref:i,iconNode:e,className:Mw(`lucide-${HA(t)}`,n),...s}));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GA=kt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W_=kt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ju=kt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qA=kt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KA=kt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XA=kt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YA=kt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=kt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Um=kt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jm=kt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QA=kt("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=kt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JA=kt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=kt("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pg=kt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eC=kt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=kt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const id=kt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tC=kt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rC=kt("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nC=kt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sC=kt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iC=kt("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=kt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=kt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=kt("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=kt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=kt("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=kt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oC=kt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=kt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=kt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lC=kt("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cC=kt("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uC=kt("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fC=kt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=kt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=kt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hC=kt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ol=kt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),jw=ye.createContext(null),K_={success:{bg:"bg-[#1DD1A1]",icon:XA,iconColor:"text-white"},error:{bg:"bg-[#FF6B6B]",icon:YA,iconColor:"text-white"},warning:{bg:"bg-[#FECA57]",icon:KA,iconColor:"text-[#2D3436]"},info:{bg:"bg-[#54A0FF]",icon:Vw,iconColor:"text-white"}},dC=({id:t,message:e,type:r,onRemove:n})=>{const s=K_[r]||K_.info,i=s.icon;return w.jsxs("div",{className:`${s.bg} text-white px-4 py-3 rounded-lg shadow-lg border-2 border-[#2D3436] 
                       flex items-center gap-3 min-w-[280px] max-w-[400px] animate-in 
                       slide-in-from-right-5 duration-300`,role:"alert",children:[w.jsx(i,{size:20,className:s.iconColor}),w.jsx("span",{className:"flex-1 font-medium text-sm",children:e}),w.jsx("button",{onClick:()=>n(t),className:"p-1 hover:bg-white/20 rounded transition-colors",children:w.jsx(ol,{size:16})})]})},pC=({toasts:t,onRemove:e})=>t.length===0?null:w.jsx("div",{className:"fixed top-4 right-4 z-[100] flex flex-col gap-2",children:t.map(r=>w.jsx(dC,{...r,onRemove:e},r.id))}),mC=({children:t})=>{const[e,r]=ye.useState([]),n=ye.useCallback(o=>{r(c=>c.filter(u=>u.id!==o))},[]),s=ye.useCallback((o,c="info",u=3e3)=>{const h=Date.now()+Math.random();return r(d=>[...d,{id:h,message:o,type:c}]),u>0&&setTimeout(()=>n(h),u),h},[n]),i={success:(o,c)=>s(o,"success",c),error:(o,c)=>s(o,"error",c??5e3),warning:(o,c)=>s(o,"warning",c),info:(o,c)=>s(o,"info",c)};return w.jsxs(jw.Provider,{value:{showToast:s,toast:i,removeToast:n},children:[t,w.jsx(pC,{toasts:e,onRemove:n})]})},zw=()=>{const t=ye.useContext(jw);if(!t)throw new Error("useToast  ToastProvider ");return t},gC=(t,e)=>{let r="";e==="csv"?(r=`\uFEFF,,
`,t.forEach(o=>{const u=[...o.selectedTags,o.manualTraits].filter(Boolean).join("").replace(/,/g,""),h=o.comment.replace(/,/g,"").replace(/\n/g," ");r+=`${o.name},"${u}","${h}"
`})):t.forEach(o=>{const c=[...o.selectedTags,o.manualTraits].filter(Boolean).join("");r+=`${o.name}
${c||""}

${o.comment}
-------------------
`});const n=new Blob([r],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download=`_${new Date().toLocaleDateString()}.${e}`,i.click(),URL.revokeObjectURL(s)},xC=()=>{const[t,e]=ye.useState({isOpen:!1,type:"info",title:"",message:"",onConfirm:null}),r=ye.useCallback(()=>{e(i=>({...i,isOpen:!1}))},[]),n=ye.useCallback((i,o,c)=>{e({isOpen:!0,type:"confirm",title:i,message:o,onConfirm:c})},[]),s=ye.useCallback(i=>{e({isOpen:!0,type:"info",title:"",message:i,onConfirm:null})},[]);return{dialog:t,closeDialog:r,showConfirm:n,showAlert:s}},vC=()=>{};var X_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},_C=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],o=t[r++],c=t[r++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Ww={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,d=i>>2,g=(i&3)<<4|c>>4;let x=(c&15)<<2|h>>6,_=h&63;u||(_=64,o||(x=64)),n.push(r[d],r[g],r[x],r[_])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Hw(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):_C(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],c=s<t.length?r[t.charAt(s)]:0;++s;const h=s<t.length?r[t.charAt(s)]:64;++s;const g=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||c==null||h==null||g==null)throw new yC;const x=i<<2|c>>4;if(n.push(x),h!==64){const _=c<<4&240|h>>2;if(n.push(_),g!==64){const k=h<<6&192|g;n.push(k)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class yC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wC=function(t){const e=Hw(t);return Ww.encodeByteArray(e,!0)},A0=function(t){return wC(t).replace(/\./g,"")},$w=function(t){try{return Ww.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TC=()=>EC().__FIREBASE_DEFAULTS__,SC=()=>{if(typeof process>"u"||typeof X_>"u")return;const t=X_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},kC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&$w(t[1]);return e&&JSON.parse(e)},ad=()=>{try{return vC()||TC()||SC()||kC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Gw=t=>{var e,r;return(r=(e=ad())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},AC=t=>{const e=Gw(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},qw=()=>{var t;return(t=ad())==null?void 0:t.config},Kw=t=>{var e;return(e=ad())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Xw(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[A0(JSON.stringify(r)),A0(JSON.stringify(o)),""].join(".")}const Vu={};function FC(){const t={prod:[],emulator:[]};for(const e of Object.keys(Vu))Vu[e]?t.emulator.push(e):t.prod.push(e);return t}function RC(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Y_=!1;function Yw(t,e){if(typeof window>"u"||typeof document>"u"||!Pc(window.location.host)||Vu[t]===e||Vu[t]||Y_)return;Vu[t]=e;function r(x){return`__firebase__banner__${x}`}const n="__firebase__banner",i=FC().prod.length>0;function o(){const x=document.getElementById(n);x&&x.remove()}function c(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function u(x,_){x.setAttribute("width","24"),x.setAttribute("id",_),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function h(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{Y_=!0,o()},x}function d(x,_){x.setAttribute("id",_),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function g(){const x=RC(n),_=r("text"),k=document.getElementById(_)||document.createElement("span"),y=r("learnmore"),S=document.getElementById(y)||document.createElement("a"),R=r("preprendIcon"),M=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const N=x.element;c(N),d(S,y);const V=h();u(M,R),N.append(M,k,S,V),document.body.appendChild(N)}i?(k.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function NC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Wn())}function bC(){var e;const t=(e=ad())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function DC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function OC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function LC(){const t=Wn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function MC(){return!bC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function VC(){try{return typeof indexedDB=="object"}catch{return!1}}function BC(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC="FirebaseError";class Ia extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=UC,Object.setPrototypeOf(this,Ia.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,kf.prototype.create)}}class kf{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?jC(i,n):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Ia(s,c,n)}}function jC(t,e){return t.replace(zC,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const zC=/\{\$([^}]+)}/g;function HC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ll(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],o=e[s];if(Q_(i)&&Q_(o)){if(!ll(i,o))return!1}else if(i!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function Q_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Af(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function WC(t,e){const r=new $C(t,e);return r.subscribe.bind(r)}class $C{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");GC(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=hm),s.error===void 0&&(s.error=hm),s.complete===void 0&&(s.complete=hm);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function GC(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function hm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(t){return t&&t._delegate?t._delegate:t}class cl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ko="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new CC;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(XC(e))try{this.getOrInitializeService({instanceIdentifier:Ko})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Ko){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ko){return this.instances.has(e)}getOptions(e=Ko){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);n===c&&o.resolve(s)}return s}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:KC(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ko){return this.component?this.component.multipleInstances?e:Ko:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function KC(t){return t===Ko?void 0:t}function XC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new qC(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Dt||(Dt={}));const QC={debug:Dt.DEBUG,verbose:Dt.VERBOSE,info:Dt.INFO,warn:Dt.WARN,error:Dt.ERROR,silent:Dt.SILENT},JC=Dt.INFO,ZC={[Dt.DEBUG]:"log",[Dt.VERBOSE]:"log",[Dt.INFO]:"info",[Dt.WARN]:"warn",[Dt.ERROR]:"error"},e3=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=ZC[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vg{constructor(e){this.name=e,this._logLevel=JC,this._logHandler=e3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?QC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Dt.DEBUG,...e),this._logHandler(this,Dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Dt.VERBOSE,...e),this._logHandler(this,Dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Dt.INFO,...e),this._logHandler(this,Dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Dt.WARN,...e),this._logHandler(this,Dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Dt.ERROR,...e),this._logHandler(this,Dt.ERROR,...e)}}const t3=(t,e)=>e.some(r=>t instanceof r);let J_,Z_;function r3(){return J_||(J_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function n3(){return Z_||(Z_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Qw=new WeakMap,Wm=new WeakMap,Jw=new WeakMap,dm=new WeakMap,Bg=new WeakMap;function s3(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(co(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&Qw.set(r,t)}).catch(()=>{}),Bg.set(e,t),e}function i3(t){if(Wm.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Wm.set(t,e)}let $m={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Wm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Jw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return co(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function a3(t){$m=t($m)}function o3(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(pm(this),e,...r);return Jw.set(n,e.sort?e.sort():[e]),co(n)}:n3().includes(t)?function(...e){return t.apply(pm(this),e),co(Qw.get(this))}:function(...e){return co(t.apply(pm(this),e))}}function l3(t){return typeof t=="function"?o3(t):(t instanceof IDBTransaction&&i3(t),t3(t,r3())?new Proxy(t,$m):t)}function co(t){if(t instanceof IDBRequest)return s3(t);if(dm.has(t))return dm.get(t);const e=l3(t);return e!==t&&(dm.set(t,e),Bg.set(e,t)),e}const pm=t=>Bg.get(t);function c3(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=co(o);return n&&o.addEventListener("upgradeneeded",u=>{n(co(o.result),u.oldVersion,u.newVersion,co(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const u3=["get","getKey","getAll","getAllKeys","count"],f3=["put","add","delete","clear"],mm=new Map;function ey(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(mm.get(e))return mm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=f3.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||u3.includes(r)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),s&&u.done]))[0]};return mm.set(e,i),i}a3(t=>({...t,get:(e,r,n)=>ey(e,r)||t.get(e,r,n),has:(e,r)=>!!ey(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h3{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(d3(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function d3(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Gm="@firebase/app",ty="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=new Vg("@firebase/app"),p3="@firebase/app-compat",m3="@firebase/analytics-compat",g3="@firebase/analytics",x3="@firebase/app-check-compat",v3="@firebase/app-check",_3="@firebase/auth",y3="@firebase/auth-compat",w3="@firebase/database",E3="@firebase/data-connect",T3="@firebase/database-compat",S3="@firebase/functions",k3="@firebase/functions-compat",A3="@firebase/installations",C3="@firebase/installations-compat",I3="@firebase/messaging",F3="@firebase/messaging-compat",R3="@firebase/performance",N3="@firebase/performance-compat",b3="@firebase/remote-config",D3="@firebase/remote-config-compat",P3="@firebase/storage",O3="@firebase/storage-compat",L3="@firebase/firestore",M3="@firebase/ai",V3="@firebase/firestore-compat",B3="firebase",U3="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qm="[DEFAULT]",j3={[Gm]:"fire-core",[p3]:"fire-core-compat",[g3]:"fire-analytics",[m3]:"fire-analytics-compat",[v3]:"fire-app-check",[x3]:"fire-app-check-compat",[_3]:"fire-auth",[y3]:"fire-auth-compat",[w3]:"fire-rtdb",[E3]:"fire-data-connect",[T3]:"fire-rtdb-compat",[S3]:"fire-fn",[k3]:"fire-fn-compat",[A3]:"fire-iid",[C3]:"fire-iid-compat",[I3]:"fire-fcm",[F3]:"fire-fcm-compat",[R3]:"fire-perf",[N3]:"fire-perf-compat",[b3]:"fire-rc",[D3]:"fire-rc-compat",[P3]:"fire-gcs",[O3]:"fire-gcs-compat",[L3]:"fire-fst",[V3]:"fire-fst-compat",[M3]:"fire-vertex","fire-js":"fire-js",[B3]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0=new Map,z3=new Map,Km=new Map;function ry(t,e){try{t.container.addComponent(e)}catch(r){wa.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Tc(t){const e=t.name;if(Km.has(e))return wa.debug(`There were multiple attempts to register component ${e}.`),!1;Km.set(e,t);for(const r of C0.values())ry(r,t);for(const r of z3.values())ry(r,t);return!0}function Ug(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function di(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H3={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},uo=new kf("app","Firebase",H3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new cl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw uo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oc=U3;function Zw(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:qm,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw uo.create("bad-app-name",{appName:String(s)});if(r||(r=qw()),!r)throw uo.create("no-options");const i=C0.get(s);if(i){if(ll(r,i.options)&&ll(n,i.config))return i;throw uo.create("duplicate-app",{appName:s})}const o=new YC(s);for(const u of Km.values())o.addComponent(u);const c=new W3(r,n,o);return C0.set(s,c),c}function eE(t=qm){const e=C0.get(t);if(!e&&t===qm&&qw())return Zw();if(!e)throw uo.create("no-app",{appName:t});return e}function fo(t,e,r){let n=j3[t]??t;r&&(n+=`-${r}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${n}" with version "${e}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wa.warn(o.join(" "));return}Tc(new cl(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3="firebase-heartbeat-database",G3=1,Zu="firebase-heartbeat-store";let gm=null;function tE(){return gm||(gm=c3($3,G3,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Zu)}catch(r){console.warn(r)}}}}).catch(t=>{throw uo.create("idb-open",{originalErrorMessage:t.message})})),gm}async function q3(t){try{const r=(await tE()).transaction(Zu),n=await r.objectStore(Zu).get(rE(t));return await r.done,n}catch(e){if(e instanceof Ia)wa.warn(e.message);else{const r=uo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});wa.warn(r.message)}}}async function ny(t,e){try{const n=(await tE()).transaction(Zu,"readwrite");await n.objectStore(Zu).put(e,rE(t)),await n.done}catch(r){if(r instanceof Ia)wa.warn(r.message);else{const n=uo.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});wa.warn(n.message)}}}function rE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K3=1024,X3=30;class Y3{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new J3(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=sy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>X3){const o=Z3(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){wa.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=sy(),{heartbeatsToSend:n,unsentEntries:s}=Q3(this._heartbeatsCache.heartbeats),i=A0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return wa.warn(r),""}}}function sy(){return new Date().toISOString().substring(0,10)}function Q3(t,e=K3){const r=[];let n=t.slice();for(const s of t){const i=r.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),iy(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),iy(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class J3{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return VC()?BC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await q3(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return ny(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return ny(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function iy(t){return A0(JSON.stringify({version:2,heartbeats:t})).length}function Z3(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(t){Tc(new cl("platform-logger",e=>new h3(e),"PRIVATE")),Tc(new cl("heartbeat",e=>new Y3(e),"PRIVATE")),fo(Gm,ty,t),fo(Gm,ty,"esm2020"),fo("fire-js","")}eI("");var tI="firebase",rI="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fo(tI,rI,"app");var ay=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ho,nE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,F){function I(){}I.prototype=F.prototype,A.F=F.prototype,A.prototype=new I,A.prototype.constructor=A,A.D=function(U,L,D){for(var B=Array(arguments.length-2),De=2;De<arguments.length;De++)B[De-2]=arguments[De];return F.prototype[L].apply(U,B)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(A,F,I){I||(I=0);const U=Array(16);if(typeof F=="string")for(var L=0;L<16;++L)U[L]=F.charCodeAt(I++)|F.charCodeAt(I++)<<8|F.charCodeAt(I++)<<16|F.charCodeAt(I++)<<24;else for(L=0;L<16;++L)U[L]=F[I++]|F[I++]<<8|F[I++]<<16|F[I++]<<24;F=A.g[0],I=A.g[1],L=A.g[2];let D=A.g[3],B;B=F+(D^I&(L^D))+U[0]+3614090360&4294967295,F=I+(B<<7&4294967295|B>>>25),B=D+(L^F&(I^L))+U[1]+3905402710&4294967295,D=F+(B<<12&4294967295|B>>>20),B=L+(I^D&(F^I))+U[2]+606105819&4294967295,L=D+(B<<17&4294967295|B>>>15),B=I+(F^L&(D^F))+U[3]+3250441966&4294967295,I=L+(B<<22&4294967295|B>>>10),B=F+(D^I&(L^D))+U[4]+4118548399&4294967295,F=I+(B<<7&4294967295|B>>>25),B=D+(L^F&(I^L))+U[5]+1200080426&4294967295,D=F+(B<<12&4294967295|B>>>20),B=L+(I^D&(F^I))+U[6]+2821735955&4294967295,L=D+(B<<17&4294967295|B>>>15),B=I+(F^L&(D^F))+U[7]+4249261313&4294967295,I=L+(B<<22&4294967295|B>>>10),B=F+(D^I&(L^D))+U[8]+1770035416&4294967295,F=I+(B<<7&4294967295|B>>>25),B=D+(L^F&(I^L))+U[9]+2336552879&4294967295,D=F+(B<<12&4294967295|B>>>20),B=L+(I^D&(F^I))+U[10]+4294925233&4294967295,L=D+(B<<17&4294967295|B>>>15),B=I+(F^L&(D^F))+U[11]+2304563134&4294967295,I=L+(B<<22&4294967295|B>>>10),B=F+(D^I&(L^D))+U[12]+1804603682&4294967295,F=I+(B<<7&4294967295|B>>>25),B=D+(L^F&(I^L))+U[13]+4254626195&4294967295,D=F+(B<<12&4294967295|B>>>20),B=L+(I^D&(F^I))+U[14]+2792965006&4294967295,L=D+(B<<17&4294967295|B>>>15),B=I+(F^L&(D^F))+U[15]+1236535329&4294967295,I=L+(B<<22&4294967295|B>>>10),B=F+(L^D&(I^L))+U[1]+4129170786&4294967295,F=I+(B<<5&4294967295|B>>>27),B=D+(I^L&(F^I))+U[6]+3225465664&4294967295,D=F+(B<<9&4294967295|B>>>23),B=L+(F^I&(D^F))+U[11]+643717713&4294967295,L=D+(B<<14&4294967295|B>>>18),B=I+(D^F&(L^D))+U[0]+3921069994&4294967295,I=L+(B<<20&4294967295|B>>>12),B=F+(L^D&(I^L))+U[5]+3593408605&4294967295,F=I+(B<<5&4294967295|B>>>27),B=D+(I^L&(F^I))+U[10]+38016083&4294967295,D=F+(B<<9&4294967295|B>>>23),B=L+(F^I&(D^F))+U[15]+3634488961&4294967295,L=D+(B<<14&4294967295|B>>>18),B=I+(D^F&(L^D))+U[4]+3889429448&4294967295,I=L+(B<<20&4294967295|B>>>12),B=F+(L^D&(I^L))+U[9]+568446438&4294967295,F=I+(B<<5&4294967295|B>>>27),B=D+(I^L&(F^I))+U[14]+3275163606&4294967295,D=F+(B<<9&4294967295|B>>>23),B=L+(F^I&(D^F))+U[3]+4107603335&4294967295,L=D+(B<<14&4294967295|B>>>18),B=I+(D^F&(L^D))+U[8]+1163531501&4294967295,I=L+(B<<20&4294967295|B>>>12),B=F+(L^D&(I^L))+U[13]+2850285829&4294967295,F=I+(B<<5&4294967295|B>>>27),B=D+(I^L&(F^I))+U[2]+4243563512&4294967295,D=F+(B<<9&4294967295|B>>>23),B=L+(F^I&(D^F))+U[7]+1735328473&4294967295,L=D+(B<<14&4294967295|B>>>18),B=I+(D^F&(L^D))+U[12]+2368359562&4294967295,I=L+(B<<20&4294967295|B>>>12),B=F+(I^L^D)+U[5]+4294588738&4294967295,F=I+(B<<4&4294967295|B>>>28),B=D+(F^I^L)+U[8]+2272392833&4294967295,D=F+(B<<11&4294967295|B>>>21),B=L+(D^F^I)+U[11]+1839030562&4294967295,L=D+(B<<16&4294967295|B>>>16),B=I+(L^D^F)+U[14]+4259657740&4294967295,I=L+(B<<23&4294967295|B>>>9),B=F+(I^L^D)+U[1]+2763975236&4294967295,F=I+(B<<4&4294967295|B>>>28),B=D+(F^I^L)+U[4]+1272893353&4294967295,D=F+(B<<11&4294967295|B>>>21),B=L+(D^F^I)+U[7]+4139469664&4294967295,L=D+(B<<16&4294967295|B>>>16),B=I+(L^D^F)+U[10]+3200236656&4294967295,I=L+(B<<23&4294967295|B>>>9),B=F+(I^L^D)+U[13]+681279174&4294967295,F=I+(B<<4&4294967295|B>>>28),B=D+(F^I^L)+U[0]+3936430074&4294967295,D=F+(B<<11&4294967295|B>>>21),B=L+(D^F^I)+U[3]+3572445317&4294967295,L=D+(B<<16&4294967295|B>>>16),B=I+(L^D^F)+U[6]+76029189&4294967295,I=L+(B<<23&4294967295|B>>>9),B=F+(I^L^D)+U[9]+3654602809&4294967295,F=I+(B<<4&4294967295|B>>>28),B=D+(F^I^L)+U[12]+3873151461&4294967295,D=F+(B<<11&4294967295|B>>>21),B=L+(D^F^I)+U[15]+530742520&4294967295,L=D+(B<<16&4294967295|B>>>16),B=I+(L^D^F)+U[2]+3299628645&4294967295,I=L+(B<<23&4294967295|B>>>9),B=F+(L^(I|~D))+U[0]+4096336452&4294967295,F=I+(B<<6&4294967295|B>>>26),B=D+(I^(F|~L))+U[7]+1126891415&4294967295,D=F+(B<<10&4294967295|B>>>22),B=L+(F^(D|~I))+U[14]+2878612391&4294967295,L=D+(B<<15&4294967295|B>>>17),B=I+(D^(L|~F))+U[5]+4237533241&4294967295,I=L+(B<<21&4294967295|B>>>11),B=F+(L^(I|~D))+U[12]+1700485571&4294967295,F=I+(B<<6&4294967295|B>>>26),B=D+(I^(F|~L))+U[3]+2399980690&4294967295,D=F+(B<<10&4294967295|B>>>22),B=L+(F^(D|~I))+U[10]+4293915773&4294967295,L=D+(B<<15&4294967295|B>>>17),B=I+(D^(L|~F))+U[1]+2240044497&4294967295,I=L+(B<<21&4294967295|B>>>11),B=F+(L^(I|~D))+U[8]+1873313359&4294967295,F=I+(B<<6&4294967295|B>>>26),B=D+(I^(F|~L))+U[15]+4264355552&4294967295,D=F+(B<<10&4294967295|B>>>22),B=L+(F^(D|~I))+U[6]+2734768916&4294967295,L=D+(B<<15&4294967295|B>>>17),B=I+(D^(L|~F))+U[13]+1309151649&4294967295,I=L+(B<<21&4294967295|B>>>11),B=F+(L^(I|~D))+U[4]+4149444226&4294967295,F=I+(B<<6&4294967295|B>>>26),B=D+(I^(F|~L))+U[11]+3174756917&4294967295,D=F+(B<<10&4294967295|B>>>22),B=L+(F^(D|~I))+U[2]+718787259&4294967295,L=D+(B<<15&4294967295|B>>>17),B=I+(D^(L|~F))+U[9]+3951481745&4294967295,A.g[0]=A.g[0]+F&4294967295,A.g[1]=A.g[1]+(L+(B<<21&4294967295|B>>>11))&4294967295,A.g[2]=A.g[2]+L&4294967295,A.g[3]=A.g[3]+D&4294967295}n.prototype.v=function(A,F){F===void 0&&(F=A.length);const I=F-this.blockSize,U=this.C;let L=this.h,D=0;for(;D<F;){if(L==0)for(;D<=I;)s(this,A,D),D+=this.blockSize;if(typeof A=="string"){for(;D<F;)if(U[L++]=A.charCodeAt(D++),L==this.blockSize){s(this,U),L=0;break}}else for(;D<F;)if(U[L++]=A[D++],L==this.blockSize){s(this,U),L=0;break}}this.h=L,this.o+=F},n.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var F=1;F<A.length-8;++F)A[F]=0;F=this.o*8;for(var I=A.length-8;I<A.length;++I)A[I]=F&255,F/=256;for(this.v(A),A=Array(16),F=0,I=0;I<4;++I)for(let U=0;U<32;U+=8)A[F++]=this.g[I]>>>U&255;return A};function i(A,F){var I=c;return Object.prototype.hasOwnProperty.call(I,A)?I[A]:I[A]=F(A)}function o(A,F){this.h=F;const I=[];let U=!0;for(let L=A.length-1;L>=0;L--){const D=A[L]|0;U&&D==F||(I[L]=D,U=!1)}this.g=I}var c={};function u(A){return-128<=A&&A<128?i(A,function(F){return new o([F|0],F<0?-1:0)}):new o([A|0],A<0?-1:0)}function h(A){if(isNaN(A)||!isFinite(A))return g;if(A<0)return S(h(-A));const F=[];let I=1;for(let U=0;A>=I;U++)F[U]=A/I|0,I*=4294967296;return new o(F,0)}function d(A,F){if(A.length==0)throw Error("number format error: empty string");if(F=F||10,F<2||36<F)throw Error("radix out of range: "+F);if(A.charAt(0)=="-")return S(d(A.substring(1),F));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=h(Math.pow(F,8));let U=g;for(let D=0;D<A.length;D+=8){var L=Math.min(8,A.length-D);const B=parseInt(A.substring(D,D+L),F);L<8?(L=h(Math.pow(F,L)),U=U.j(L).add(h(B))):(U=U.j(I),U=U.add(h(B)))}return U}var g=u(0),x=u(1),_=u(16777216);t=o.prototype,t.m=function(){if(y(this))return-S(this).m();let A=0,F=1;for(let I=0;I<this.g.length;I++){const U=this.i(I);A+=(U>=0?U:4294967296+U)*F,F*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(k(this))return"0";if(y(this))return"-"+S(this).toString(A);const F=h(Math.pow(A,6));var I=this;let U="";for(;;){const L=V(I,F).g;I=R(I,L.j(F));let D=((I.g.length>0?I.g[0]:I.h)>>>0).toString(A);if(I=L,k(I))return D+U;for(;D.length<6;)D="0"+D;U=D+U}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function k(A){if(A.h!=0)return!1;for(let F=0;F<A.g.length;F++)if(A.g[F]!=0)return!1;return!0}function y(A){return A.h==-1}t.l=function(A){return A=R(this,A),y(A)?-1:k(A)?0:1};function S(A){const F=A.g.length,I=[];for(let U=0;U<F;U++)I[U]=~A.g[U];return new o(I,~A.h).add(x)}t.abs=function(){return y(this)?S(this):this},t.add=function(A){const F=Math.max(this.g.length,A.g.length),I=[];let U=0;for(let L=0;L<=F;L++){let D=U+(this.i(L)&65535)+(A.i(L)&65535),B=(D>>>16)+(this.i(L)>>>16)+(A.i(L)>>>16);U=B>>>16,D&=65535,B&=65535,I[L]=B<<16|D}return new o(I,I[I.length-1]&-2147483648?-1:0)};function R(A,F){return A.add(S(F))}t.j=function(A){if(k(this)||k(A))return g;if(y(this))return y(A)?S(this).j(S(A)):S(S(this).j(A));if(y(A))return S(this.j(S(A)));if(this.l(_)<0&&A.l(_)<0)return h(this.m()*A.m());const F=this.g.length+A.g.length,I=[];for(var U=0;U<2*F;U++)I[U]=0;for(U=0;U<this.g.length;U++)for(let L=0;L<A.g.length;L++){const D=this.i(U)>>>16,B=this.i(U)&65535,De=A.i(L)>>>16,Re=A.i(L)&65535;I[2*U+2*L]+=B*Re,M(I,2*U+2*L),I[2*U+2*L+1]+=D*Re,M(I,2*U+2*L+1),I[2*U+2*L+1]+=B*De,M(I,2*U+2*L+1),I[2*U+2*L+2]+=D*De,M(I,2*U+2*L+2)}for(A=0;A<F;A++)I[A]=I[2*A+1]<<16|I[2*A];for(A=F;A<2*F;A++)I[A]=0;return new o(I,0)};function M(A,F){for(;(A[F]&65535)!=A[F];)A[F+1]+=A[F]>>>16,A[F]&=65535,F++}function N(A,F){this.g=A,this.h=F}function V(A,F){if(k(F))throw Error("division by zero");if(k(A))return new N(g,g);if(y(A))return F=V(S(A),F),new N(S(F.g),S(F.h));if(y(F))return F=V(A,S(F)),new N(S(F.g),F.h);if(A.g.length>30){if(y(A)||y(F))throw Error("slowDivide_ only works with positive integers.");for(var I=x,U=F;U.l(A)<=0;)I=W(I),U=W(U);var L=j(I,1),D=j(U,1);for(U=j(U,2),I=j(I,2);!k(U);){var B=D.add(U);B.l(A)<=0&&(L=L.add(I),D=B),U=j(U,1),I=j(I,1)}return F=R(A,L.j(F)),new N(L,F)}for(L=g;A.l(F)>=0;){for(I=Math.max(1,Math.floor(A.m()/F.m())),U=Math.ceil(Math.log(I)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),D=h(I),B=D.j(F);y(B)||B.l(A)>0;)I-=U,D=h(I),B=D.j(F);k(D)&&(D=x),L=L.add(D),A=R(A,B)}return new N(L,A)}t.B=function(A){return V(this,A).h},t.and=function(A){const F=Math.max(this.g.length,A.g.length),I=[];for(let U=0;U<F;U++)I[U]=this.i(U)&A.i(U);return new o(I,this.h&A.h)},t.or=function(A){const F=Math.max(this.g.length,A.g.length),I=[];for(let U=0;U<F;U++)I[U]=this.i(U)|A.i(U);return new o(I,this.h|A.h)},t.xor=function(A){const F=Math.max(this.g.length,A.g.length),I=[];for(let U=0;U<F;U++)I[U]=this.i(U)^A.i(U);return new o(I,this.h^A.h)};function W(A){const F=A.g.length+1,I=[];for(let U=0;U<F;U++)I[U]=A.i(U)<<1|A.i(U-1)>>>31;return new o(I,A.h)}function j(A,F){const I=F>>5;F%=32;const U=A.g.length-I,L=[];for(let D=0;D<U;D++)L[D]=F>0?A.i(D+I)>>>F|A.i(D+I+1)<<32-F:A.i(D+I);return new o(L,A.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,nE=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,ho=o}).apply(typeof ay<"u"?ay:typeof self<"u"?self:typeof window<"u"?window:{});var Qh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sE,Nu,iE,m0,Xm,aE,oE,lE;(function(){var t,e=Object.defineProperty;function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qh=="object"&&Qh];for(var T=0;T<p.length;++T){var C=p[T];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=r(this);function s(p,T){if(T)e:{var C=n;p=p.split(".");for(var z=0;z<p.length-1;z++){var ae=p[z];if(!(ae in C))break e;C=C[ae]}p=p[p.length-1],z=C[p],T=T(z),T!=z&&T!=null&&e(C,p,{configurable:!0,writable:!0,value:T})}}s("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(p){return p||function(T){var C=[],z;for(z in T)Object.prototype.hasOwnProperty.call(T,z)&&C.push([z,T[z]]);return C}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function c(p){var T=typeof p;return T=="object"&&p!=null||T=="function"}function u(p,T,C){return p.call.apply(p.bind,arguments)}function h(p,T,C){return h=u,h.apply(null,arguments)}function d(p,T){var C=Array.prototype.slice.call(arguments,1);return function(){var z=C.slice();return z.push.apply(z,arguments),p.apply(this,z)}}function g(p,T){function C(){}C.prototype=T.prototype,p.Z=T.prototype,p.prototype=new C,p.prototype.constructor=p,p.Ob=function(z,ae,pe){for(var $e=Array(arguments.length-2),_t=2;_t<arguments.length;_t++)$e[_t-2]=arguments[_t];return T.prototype[ae].apply(z,$e)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function _(p){const T=p.length;if(T>0){const C=Array(T);for(let z=0;z<T;z++)C[z]=p[z];return C}return[]}function k(p,T){for(let z=1;z<arguments.length;z++){const ae=arguments[z];var C=typeof ae;if(C=C!="object"?C:ae?Array.isArray(ae)?"array":C:"null",C=="array"||C=="object"&&typeof ae.length=="number"){C=p.length||0;const pe=ae.length||0;p.length=C+pe;for(let $e=0;$e<pe;$e++)p[C+$e]=ae[$e]}else p.push(ae)}}class y{constructor(T,C){this.i=T,this.j=C,this.h=0,this.g=null}get(){let T;return this.h>0?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function S(p){o.setTimeout(()=>{throw p},0)}function R(){var p=A;let T=null;return p.g&&(T=p.g,p.g=p.g.next,p.g||(p.h=null),T.next=null),T}class M{constructor(){this.h=this.g=null}add(T,C){const z=N.get();z.set(T,C),this.h?this.h.next=z:this.g=z,this.h=z}}var N=new y(()=>new V,p=>p.reset());class V{constructor(){this.next=this.g=this.h=null}set(T,C){this.h=T,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let W,j=!1,A=new M,F=()=>{const p=Promise.resolve(void 0);W=()=>{p.then(I)}};function I(){for(var p;p=R();){try{p.h.call(p.g)}catch(C){S(C)}var T=N;T.j(p),T.h<100&&(T.h++,p.next=T.g,T.g=p)}j=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(p,T){this.type=p,this.g=this.target=T,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var D=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var p=!1,T=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const C=()=>{};o.addEventListener("test",C,T),o.removeEventListener("test",C,T)}catch{}return p})();function B(p){return/^[\s\xa0]*$/.test(p)}function De(p,T){L.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,T)}g(De,L),De.prototype.init=function(p,T){const C=this.type=p.type,z=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=T,T=p.relatedTarget,T||(C=="mouseover"?T=p.fromElement:C=="mouseout"&&(T=p.toElement)),this.relatedTarget=T,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&De.Z.h.call(this)},De.prototype.h=function(){De.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Re="closure_listenable_"+(Math.random()*1e6|0),Ve=0;function Le(p,T,C,z,ae){this.listener=p,this.proxy=null,this.src=T,this.type=C,this.capture=!!z,this.ha=ae,this.key=++Ve,this.da=this.fa=!1}function Ae(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ne(p,T,C){for(const z in p)T.call(C,p[z],z,p)}function we(p,T){for(const C in p)T.call(void 0,p[C],C,p)}function ee(p){const T={};for(const C in p)T[C]=p[C];return T}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function te(p,T){let C,z;for(let ae=1;ae<arguments.length;ae++){z=arguments[ae];for(C in z)p[C]=z[C];for(let pe=0;pe<O.length;pe++)C=O[pe],Object.prototype.hasOwnProperty.call(z,C)&&(p[C]=z[C])}}function J(p){this.src=p,this.g={},this.h=0}J.prototype.add=function(p,T,C,z,ae){const pe=p.toString();p=this.g[pe],p||(p=this.g[pe]=[],this.h++);const $e=oe(p,T,z,ae);return $e>-1?(T=p[$e],C||(T.fa=!1)):(T=new Le(T,this.src,pe,!!z,ae),T.fa=C,p.push(T)),T};function Z(p,T){const C=T.type;if(C in p.g){var z=p.g[C],ae=Array.prototype.indexOf.call(z,T,void 0),pe;(pe=ae>=0)&&Array.prototype.splice.call(z,ae,1),pe&&(Ae(T),p.g[C].length==0&&(delete p.g[C],p.h--))}}function oe(p,T,C,z){for(let ae=0;ae<p.length;++ae){const pe=p[ae];if(!pe.da&&pe.listener==T&&pe.capture==!!C&&pe.ha==z)return ae}return-1}var _e="closure_lm_"+(Math.random()*1e6|0),ve={};function xe(p,T,C,z,ae){if(Array.isArray(T)){for(let pe=0;pe<T.length;pe++)xe(p,T[pe],C,z,ae);return null}return C=Zt(C),p&&p[Re]?p.J(T,C,c(z)?!!z.capture:!1,ae):Te(p,T,C,!1,z,ae)}function Te(p,T,C,z,ae,pe){if(!T)throw Error("Invalid event type");const $e=c(ae)?!!ae.capture:!!ae;let _t=xt(p);if(_t||(p[_e]=_t=new J(p)),C=_t.add(T,C,z,$e,pe),C.proxy)return C;if(z=ut(),C.proxy=z,z.src=p,z.listener=C,p.addEventListener)D||(ae=$e),ae===void 0&&(ae=!1),p.addEventListener(T.toString(),z,ae);else if(p.attachEvent)p.attachEvent(wt(T.toString()),z);else if(p.addListener&&p.removeListener)p.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return C}function ut(){function p(C){return T.call(p.src,p.listener,C)}const T=Lt;return p}function Y(p,T,C,z,ae){if(Array.isArray(T))for(var pe=0;pe<T.length;pe++)Y(p,T[pe],C,z,ae);else z=c(z)?!!z.capture:!!z,C=Zt(C),p&&p[Re]?(p=p.i,pe=String(T).toString(),pe in p.g&&(T=p.g[pe],C=oe(T,C,z,ae),C>-1&&(Ae(T[C]),Array.prototype.splice.call(T,C,1),T.length==0&&(delete p.g[pe],p.h--)))):p&&(p=xt(p))&&(T=p.g[T.toString()],p=-1,T&&(p=oe(T,C,z,ae)),(C=p>-1?T[p]:null)&&At(C))}function At(p){if(typeof p!="number"&&p&&!p.da){var T=p.src;if(T&&T[Re])Z(T.i,p);else{var C=p.type,z=p.proxy;T.removeEventListener?T.removeEventListener(C,z,p.capture):T.detachEvent?T.detachEvent(wt(C),z):T.addListener&&T.removeListener&&T.removeListener(z),(C=xt(T))?(Z(C,p),C.h==0&&(C.src=null,T[_e]=null)):Ae(p)}}}function wt(p){return p in ve?ve[p]:ve[p]="on"+p}function Lt(p,T){if(p.da)p=!0;else{T=new De(T,this);const C=p.listener,z=p.ha||p.src;p.fa&&At(p),p=C.call(z,T)}return p}function xt(p){return p=p[_e],p instanceof J?p:null}var je="__closure_events_fn_"+(Math.random()*1e9>>>0);function Zt(p){return typeof p=="function"?p:(p[je]||(p[je]=function(T){return p.handleEvent(T)}),p[je])}function Mt(){U.call(this),this.i=new J(this),this.M=this,this.G=null}g(Mt,U),Mt.prototype[Re]=!0,Mt.prototype.removeEventListener=function(p,T,C,z){Y(this,p,T,C,z)};function Bt(p,T){var C,z=p.G;if(z)for(C=[];z;z=z.G)C.push(z);if(p=p.M,z=T.type||T,typeof T=="string")T=new L(T,p);else if(T instanceof L)T.target=T.target||p;else{var ae=T;T=new L(z,p),te(T,ae)}ae=!0;let pe,$e;if(C)for($e=C.length-1;$e>=0;$e--)pe=T.g=C[$e],ae=xr(pe,z,!0,T)&&ae;if(pe=T.g=p,ae=xr(pe,z,!0,T)&&ae,ae=xr(pe,z,!1,T)&&ae,C)for($e=0;$e<C.length;$e++)pe=T.g=C[$e],ae=xr(pe,z,!1,T)&&ae}Mt.prototype.N=function(){if(Mt.Z.N.call(this),this.i){var p=this.i;for(const T in p.g){const C=p.g[T];for(let z=0;z<C.length;z++)Ae(C[z]);delete p.g[T],p.h--}}this.G=null},Mt.prototype.J=function(p,T,C,z){return this.i.add(String(p),T,!1,C,z)},Mt.prototype.K=function(p,T,C,z){return this.i.add(String(p),T,!0,C,z)};function xr(p,T,C,z){if(T=p.i.g[String(T)],!T)return!0;T=T.concat();let ae=!0;for(let pe=0;pe<T.length;++pe){const $e=T[pe];if($e&&!$e.da&&$e.capture==C){const _t=$e.listener,Nr=$e.ha||$e.src;$e.fa&&Z(p.i,$e),ae=_t.call(Nr,z)!==!1&&ae}}return ae&&!z.defaultPrevented}function Tn(p,T){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(T)>2147483647?-1:o.setTimeout(p,T||0)}function Sn(p){p.g=Tn(()=>{p.g=null,p.i&&(p.i=!1,Sn(p))},p.l);const T=p.h;p.h=null,p.m.apply(null,T)}class _r extends U{constructor(T,C){super(),this.m=T,this.l=C,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:Sn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rr(p){U.call(this),this.h=p,this.g={}}g(Rr,U);var qn=[];function as(p){ne(p.g,function(T,C){this.g.hasOwnProperty(C)&&At(T)},p),p.g={}}Rr.prototype.N=function(){Rr.Z.N.call(this),as(this)},Rr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var or=o.JSON.stringify,Zr=o.JSON.parse,ot=class{stringify(p){return o.JSON.stringify(p,void 0)}parse(p){return o.JSON.parse(p,void 0)}};function jt(){}function Gr(){}var Yt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function kn(){L.call(this,"d")}g(kn,L);function ni(){L.call(this,"c")}g(ni,L);var Kn={},si=null;function ws(){return si=si||new Mt}Kn.Ia="serverreachability";function Vs(p){L.call(this,Kn.Ia,p)}g(Vs,L);function Qe(p){const T=ws();Bt(T,new Vs(T))}Kn.STAT_EVENT="statevent";function Xn(p,T){L.call(this,Kn.STAT_EVENT,p),this.stat=T}g(Xn,L);function Rt(p){const T=ws();Bt(T,new Xn(T,p))}Kn.Ja="timingevent";function qr(p,T){L.call(this,Kn.Ja,p),this.size=T}g(qr,L);function An(p,T){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){p()},T)}function Bs(){this.g=!0}Bs.prototype.ua=function(){this.g=!1};function Yn(p,T,C,z,ae,pe){p.info(function(){if(p.g)if(pe){var $e="",_t=pe.split("&");for(let er=0;er<_t.length;er++){var Nr=_t[er].split("=");if(Nr.length>1){const Mr=Nr[0];Nr=Nr[1];const Cs=Mr.split("_");$e=Cs.length>=2&&Cs[1]=="type"?$e+(Mr+"="+Nr+"&"):$e+(Mr+"=redacted&")}}}else $e=null;else $e=pe;return"XMLHTTP REQ ("+z+") [attempt "+ae+"]: "+T+`
`+C+`
`+$e})}function ba(p,T,C,z,ae,pe,$e){p.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+ae+"]: "+T+`
`+C+`
`+pe+" "+$e})}function ln(p,T,C,z){p.info(function(){return"XMLHTTP TEXT ("+T+"): "+cn(p,C)+(z?" "+z:"")})}function Qn(p,T){p.info(function(){return"TIMEOUT: "+T})}Bs.prototype.info=function(){};function cn(p,T){if(!p.g)return T;if(!T)return null;try{const pe=JSON.parse(T);if(pe){for(p=0;p<pe.length;p++)if(Array.isArray(pe[p])){var C=pe[p];if(!(C.length<2)){var z=C[1];if(Array.isArray(z)&&!(z.length<1)){var ae=z[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(let $e=1;$e<z.length;$e++)z[$e]=""}}}}return or(pe)}catch{return T}}var os={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Cn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Da;function Es(){}g(Es,jt),Es.prototype.g=function(){return new XMLHttpRequest},Da=new Es;function ls(p){return encodeURIComponent(String(p))}function P(p){var T=1;p=p.split(":");const C=[];for(;T>0&&p.length;)C.push(p.shift()),T--;return p.length&&C.push(p.join(":")),C}function q(p,T,C,z){this.j=p,this.i=T,this.l=C,this.S=z||1,this.V=new Rr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new H}function H(){this.i=null,this.g="",this.h=!1}var G={},K={};function X(p,T,C){p.M=1,p.A=un(rt(T)),p.u=C,p.R=!0,ce(p,null)}function ce(p,T){p.F=Date.now(),fe(p),p.B=rt(p.A);var C=p.B,z=p.S;Array.isArray(z)||(z=[String(z)]),Jc(C.i,"t",z),p.C=0,C=p.j.L,p.h=new H,p.g=Zf(p.j,C?T:null,!p.u),p.P>0&&(p.O=new _r(h(p.Y,p,p.g),p.P)),T=p.V,C=p.g,z=p.ba;var ae="readystatechange";Array.isArray(ae)||(ae&&(qn[0]=ae.toString()),ae=qn);for(let pe=0;pe<ae.length;pe++){const $e=xe(C,ae[pe],z||T.handleEvent,!1,T.h||T);if(!$e)break;T.g[$e.key]=$e}T=p.J?ee(p.J):{},p.u?(p.v||(p.v="POST"),T["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,T)):(p.v="GET",p.g.ea(p.B,p.v,null,T)),Qe(),Yn(p.i,p.v,p.B,p.l,p.S,p.u)}q.prototype.ba=function(p){p=p.target;const T=this.O;T&&ki(p)==3?T.j():this.Y(p)},q.prototype.Y=function(p){try{if(p==this.g)e:{const _t=ki(this.g),Nr=this.g.ya(),er=this.g.ca();if(!(_t<3)&&(_t!=3||this.g&&(this.h.h||this.g.la()||Qf(this.g)))){this.K||_t!=4||Nr==7||(Nr==8||er<=0?Qe(3):Qe(2)),Ue(this);var T=this.g.ca();this.X=T;var C=me(this);if(this.o=T==200,ba(this.i,this.v,this.B,this.l,this.S,_t,T),this.o){if(this.U&&!this.L){t:{if(this.g){var z,ae=this.g;if((z=ae.g?ae.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(z)){var pe=z;break t}}pe=null}if(p=pe)ln(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Pe(this,p);else{this.o=!1,this.m=3,Rt(12),Oe(this),Ge(this);break e}}if(this.R){p=!0;let Mr;for(;!this.K&&this.C<C.length;)if(Mr=ue(this,C),Mr==K){_t==4&&(this.m=4,Rt(14),p=!1),ln(this.i,this.l,null,"[Incomplete Response]");break}else if(Mr==G){this.m=4,Rt(15),ln(this.i,this.l,C,"[Invalid Chunk]"),p=!1;break}else ln(this.i,this.l,Mr,null),Pe(this,Mr);if(le(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_t!=4||C.length!=0||this.h.h||(this.m=1,Rt(16),p=!1),this.o=this.o&&p,!p)ln(this.i,this.l,C,"[Invalid Chunked Response]"),Oe(this),Ge(this);else if(C.length>0&&!this.W){this.W=!0;var $e=this.j;$e.g==this&&$e.aa&&!$e.P&&($e.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),Po($e),$e.P=!0,Rt(11))}}else ln(this.i,this.l,C,null),Pe(this,C);_t==4&&Oe(this),this.o&&!this.K&&(_t==4?Ol(this.j,this):(this.o=!1,fe(this)))}else eu(this.g),T==400&&C.indexOf("Unknown SID")>0?(this.m=3,Rt(12)):(this.m=0,Rt(13)),Oe(this),Ge(this)}}}catch{}finally{}};function me(p){if(!le(p))return p.g.la();const T=Qf(p.g);if(T==="")return"";let C="";const z=T.length,ae=ki(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Oe(p),Ge(p),"";p.h.i=new o.TextDecoder}for(let pe=0;pe<z;pe++)p.h.h=!0,C+=p.h.i.decode(T[pe],{stream:!(ae&&pe==z-1)});return T.length=0,p.h.g+=C,p.C=0,p.h.g}function le(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function ue(p,T){var C=p.C,z=T.indexOf(`
`,C);return z==-1?K:(C=Number(T.substring(C,z)),isNaN(C)?G:(z+=1,z+C>T.length?K:(T=T.slice(z,z+C),p.C=z+C,T)))}q.prototype.cancel=function(){this.K=!0,Oe(this)};function fe(p){p.T=Date.now()+p.H,Ne(p,p.H)}function Ne(p,T){if(p.D!=null)throw Error("WatchDog timer not null");p.D=An(h(p.aa,p),T)}function Ue(p){p.D&&(o.clearTimeout(p.D),p.D=null)}q.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(Qn(this.i,this.B),this.M!=2&&(Qe(),Rt(17)),Oe(this),this.m=2,Ge(this)):Ne(this,this.T-p)};function Ge(p){p.j.I==0||p.K||Ol(p.j,p)}function Oe(p){Ue(p);var T=p.O;T&&typeof T.dispose=="function"&&T.dispose(),p.O=null,as(p.V),p.g&&(T=p.g,p.g=null,T.abort(),T.dispose())}function Pe(p,T){try{var C=p.j;if(C.I!=0&&(C.g==p||Ts(C.h,p))){if(!p.L&&Ts(C.h,p)&&C.I==3){try{var z=C.Ba.g.parse(T)}catch{z=null}if(Array.isArray(z)&&z.length==3){var ae=z;if(ae[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<p.F)Pl(C),ks(C);else break e;Ii(C),Rt(18)}}else C.xa=ae[1],0<C.xa-C.K&&ae[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=An(h(C.Va,C),6e3));lr(C.h)<=1&&C.ta&&(C.ta=void 0)}else As(C,11)}else if((p.L||C.g==p)&&Pl(C),!B(T))for(ae=C.Ba.g.parse(T),T=0;T<ae.length;T++){let er=ae[T];const Mr=er[0];if(!(Mr<=C.K))if(C.K=Mr,er=er[1],C.I==2)if(er[0]=="c"){C.M=er[1],C.ba=er[2];const Cs=er[3];Cs!=null&&(C.ka=Cs,C.j.info("VER="+C.ka));const na=er[4];na!=null&&(C.za=na,C.j.info("SVER="+C.za));const Fi=er[5];Fi!=null&&typeof Fi=="number"&&Fi>0&&(z=1.5*Fi,C.O=z,C.j.info("backChannelRequestTimeoutMs_="+z)),z=C;const Ri=p.g;if(Ri){const Vl=Ri.g?Ri.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vl){var pe=z.h;pe.g||Vl.indexOf("spdy")==-1&&Vl.indexOf("quic")==-1&&Vl.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(cs(pe,pe.h),pe.h=null))}if(z.G){const nu=Ri.g?Ri.g.getResponseHeader("X-HTTP-Session-Id"):null;nu&&(z.wa=nu,bt(z.J,z.G,nu))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-p.F,C.j.info("Handshake RTT: "+C.T+"ms")),z=C;var $e=p;if(z.na=ru(z,z.L?z.ba:null,z.W),$e.L){Jn(z.h,$e);var _t=$e,Nr=z.O;Nr&&(_t.H=Nr),_t.D&&(Ue(_t),fe(_t)),z.g=$e}else In(z);C.i.length>0&&ra(C)}else er[0]!="stop"&&er[0]!="close"||As(C,7);else C.I==3&&(er[0]=="stop"||er[0]=="close"?er[0]=="stop"?As(C,7):bl(C):er[0]!="noop"&&C.l&&C.l.qa(er),C.A=0)}}Qe(4)}catch{}}var ft=class{constructor(p,T){this.g=p,this.map=T}};function $t(p){this.l=p||10,o.PerformanceNavigationTiming?(p=o.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qt(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function lr(p){return p.h?1:p.g?p.g.size:0}function Ts(p,T){return p.h?p.h==T:p.g?p.g.has(T):!1}function cs(p,T){p.g?p.g.add(T):p.h=T}function Jn(p,T){p.h&&p.h==T?p.h=null:p.g&&p.g.has(T)&&p.g.delete(T)}$t.prototype.cancel=function(){if(this.i=Se(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Se(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let T=p.i;for(const C of p.g.values())T=T.concat(C.G);return T}return _(p.i)}var Ie=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ze(p,T){if(p){p=p.split("&");for(let C=0;C<p.length;C++){const z=p[C].indexOf("=");let ae,pe=null;z>=0?(ae=p[C].substring(0,z),pe=p[C].substring(z+1)):ae=p[C],T(ae,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function qe(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let T;p instanceof qe?(this.l=p.l,Nt(this,p.j),this.o=p.o,this.g=p.g,Gt(this,p.u),this.h=p.h,Us(this,Zc(p.i)),this.m=p.m):p&&(T=String(p).match(Ie))?(this.l=!1,Nt(this,T[1]||"",!0),this.o=fn(T[2]||""),this.g=fn(T[3]||"",!0),Gt(this,T[4]),this.h=fn(T[5]||"",!0),Us(this,T[6]||"",!0),this.m=fn(T[7]||"")):(this.l=!1,this.i=new Vt(null,this.l))}qe.prototype.toString=function(){const p=[];var T=this.j;T&&p.push(Ji(T,qc,!0),":");var C=this.g;return(C||T=="file")&&(p.push("//"),(T=this.o)&&p.push(Ji(T,qc,!0),"@"),p.push(ls(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&p.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&p.push("/"),p.push(Ji(C,C.charAt(0)=="/"?No:Kc,!0))),(C=this.i.toString())&&p.push("?",C),(C=this.m)&&p.push("#",Ji(C,Xc)),p.join("")},qe.prototype.resolve=function(p){const T=rt(this);let C=!!p.j;C?Nt(T,p.j):C=!!p.o,C?T.o=p.o:C=!!p.g,C?T.g=p.g:C=p.u!=null;var z=p.h;if(C)Gt(T,p.u);else if(C=!!p.h){if(z.charAt(0)!="/")if(this.g&&!this.h)z="/"+z;else{var ae=T.h.lastIndexOf("/");ae!=-1&&(z=T.h.slice(0,ae+1)+z)}if(ae=z,ae==".."||ae==".")z="";else if(ae.indexOf("./")!=-1||ae.indexOf("/.")!=-1){z=ae.lastIndexOf("/",0)==0,ae=ae.split("/");const pe=[];for(let $e=0;$e<ae.length;){const _t=ae[$e++];_t=="."?z&&$e==ae.length&&pe.push(""):_t==".."?((pe.length>1||pe.length==1&&pe[0]!="")&&pe.pop(),z&&$e==ae.length&&pe.push("")):(pe.push(_t),z=!0)}z=pe.join("/")}else z=ae}return C?T.h=z:C=p.i.toString()!=="",C?Us(T,Zc(p.i)):C=!!p.m,C&&(T.m=p.m),T};function rt(p){return new qe(p)}function Nt(p,T,C){p.j=C?fn(T,!0):T,p.j&&(p.j=p.j.replace(/:$/,""))}function Gt(p,T){if(T){if(T=Number(T),isNaN(T)||T<0)throw Error("Bad port number "+T);p.u=T}else p.u=null}function Us(p,T,C){T instanceof Vt?(p.i=T,Fl(p.i,p.l)):(C||(T=Ji(T,Ld)),p.i=new Vt(T,p.l))}function bt(p,T,C){p.i.set(T,C)}function un(p){return bt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function fn(p,T){return p?T?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Ji(p,T,C){return typeof p=="string"?(p=encodeURI(p).replace(T,Gc),C&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Gc(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var qc=/[#\/\?@]/g,Kc=/[#\?:]/g,No=/[#\?]/g,Ld=/[#\?@]/g,Xc=/#/g;function Vt(p,T){this.h=this.g=null,this.i=p||null,this.j=!!T}function wi(p){p.g||(p.g=new Map,p.h=0,p.i&&ze(p.i,function(T,C){p.add(decodeURIComponent(T.replace(/\+/g," ")),C)}))}t=Vt.prototype,t.add=function(p,T){wi(this),this.i=null,p=Ei(this,p);let C=this.g.get(p);return C||this.g.set(p,C=[]),C.push(T),this.h+=1,this};function Yc(p,T){wi(p),T=Ei(p,T),p.g.has(T)&&(p.i=null,p.h-=p.g.get(T).length,p.g.delete(T))}function Il(p,T){return wi(p),T=Ei(p,T),p.g.has(T)}t.forEach=function(p,T){wi(this),this.g.forEach(function(C,z){C.forEach(function(ae){p.call(T,ae,z,this)},this)},this)};function Qc(p,T){wi(p);let C=[];if(typeof T=="string")Il(p,T)&&(C=C.concat(p.g.get(Ei(p,T))));else for(p=Array.from(p.g.values()),T=0;T<p.length;T++)C=C.concat(p[T]);return C}t.set=function(p,T){return wi(this),this.i=null,p=Ei(this,p),Il(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[T]),this.h+=1,this},t.get=function(p,T){return p?(p=Qc(this,p),p.length>0?String(p[0]):T):T};function Jc(p,T,C){Yc(p,T),C.length>0&&(p.i=null,p.g.set(Ei(p,T),_(C)),p.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],T=Array.from(this.g.keys());for(let z=0;z<T.length;z++){var C=T[z];const ae=ls(C);C=Qc(this,C);for(let pe=0;pe<C.length;pe++){let $e=ae;C[pe]!==""&&($e+="="+ls(C[pe])),p.push($e)}}return this.i=p.join("&")};function Zc(p){const T=new Vt;return T.i=p.i,p.g&&(T.g=new Map(p.g),T.h=p.h),T}function Ei(p,T){return T=String(T),p.j&&(T=T.toLowerCase()),T}function Fl(p,T){T&&!p.j&&(wi(p),p.i=null,p.g.forEach(function(C,z){const ae=z.toLowerCase();z!=ae&&(Yc(this,z),Jc(this,ae,C))},p)),p.j=T}function Ti(p,T){const C=new Bs;if(o.Image){const z=new Image;z.onload=d(hn,C,"TestLoadImage: loaded",!0,T,z),z.onerror=d(hn,C,"TestLoadImage: error",!1,T,z),z.onabort=d(hn,C,"TestLoadImage: abort",!1,T,z),z.ontimeout=d(hn,C,"TestLoadImage: timeout",!1,T,z),o.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=p}else T(!1)}function Si(p,T){const C=new Bs,z=new AbortController,ae=setTimeout(()=>{z.abort(),hn(C,"TestPingServer: timeout",!1,T)},1e4);fetch(p,{signal:z.signal}).then(pe=>{clearTimeout(ae),pe.ok?hn(C,"TestPingServer: ok",!0,T):hn(C,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(ae),hn(C,"TestPingServer: error",!1,T)})}function hn(p,T,C,z,ae){try{ae&&(ae.onload=null,ae.onerror=null,ae.onabort=null,ae.ontimeout=null),z(C)}catch{}}function bo(){this.g=new ot}function Zi(p){this.i=p.Sb||null,this.h=p.ab||!1}g(Zi,jt),Zi.prototype.g=function(){return new Ss(this.i,this.h)};function Ss(p,T){Mt.call(this),this.H=p,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(Ss,Mt),t=Ss.prototype,t.open=function(p,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=T,this.readyState=1,ii(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const T={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(T.body=p),(this.H||o).fetch(new Request(this.D,T)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Pa(this)),this.readyState=0},t.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ii(this)),this.g&&(this.readyState=3,ii(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Kf(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Kf(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}t.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var T=p.value?p.value:new Uint8Array(0);(T=this.B.decode(T,{stream:!p.done}))&&(this.response=this.responseText+=T)}p.done?Pa(this):ii(this),this.readyState==3&&Kf(this)}},t.Oa=function(p){this.g&&(this.response=this.responseText=p,Pa(this))},t.Na=function(p){this.g&&(this.response=p,Pa(this))},t.ga=function(){this.g&&Pa(this)};function Pa(p){p.readyState=4,p.l=null,p.j=null,p.B=null,ii(p)}t.setRequestHeader=function(p,T){this.A.append(p,T)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],T=this.h.entries();for(var C=T.next();!C.done;)C=C.value,p.push(C[0]+": "+C[1]),C=T.next();return p.join(`\r
`)};function ii(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Ss.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Xf(p){let T="";return ne(p,function(C,z){T+=z,T+=":",T+=C,T+=`\r
`}),T}function Rl(p,T,C){e:{for(z in C){var z=!1;break e}z=!0}z||(C=Xf(C),typeof p=="string"?C!=null&&ls(C):bt(p,T,C))}function ar(p){Mt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(ar,Mt);var Yf=/^https?$/i,Md=["POST","PUT"];t=ar.prototype,t.Fa=function(p){this.H=p},t.ea=function(p,T,C,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);T=T?T.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Da.g(),this.g.onreadystatechange=x(h(this.Ca,this));try{this.B=!0,this.g.open(T,String(p),!0),this.B=!1}catch(pe){Oa(this,pe);return}if(p=C||"",C=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var ae in z)C.set(ae,z[ae]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const pe of z.keys())C.set(pe,z.get(pe));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(C.keys()).find(pe=>pe.toLowerCase()=="content-type"),ae=o.FormData&&p instanceof o.FormData,!(Array.prototype.indexOf.call(Md,T,void 0)>=0)||z||ae||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,$e]of C)this.g.setRequestHeader(pe,$e);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(pe){Oa(this,pe)}};function Oa(p,T){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=T,p.o=5,La(p),ta(p)}function La(p){p.A||(p.A=!0,Bt(p,"complete"),Bt(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Bt(this,"complete"),Bt(this,"abort"),ta(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ta(this,!0)),ar.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ea(this):this.Xa())},t.Xa=function(){ea(this)};function ea(p){if(p.h&&typeof i<"u"){if(p.v&&ki(p)==4)setTimeout(p.Ca.bind(p),0);else if(Bt(p,"readystatechange"),ki(p)==4){p.h=!1;try{const pe=p.ca();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var C;if(!(C=T)){var z;if(z=pe===0){let $e=String(p.D).match(Ie)[1]||null;!$e&&o.self&&o.self.location&&($e=o.self.location.protocol.slice(0,-1)),z=!Yf.test($e?$e.toLowerCase():"")}C=z}if(C)Bt(p,"complete"),Bt(p,"success");else{p.o=6;try{var ae=ki(p)>2?p.g.statusText:""}catch{ae=""}p.l=ae+" ["+p.ca()+"]",La(p)}}finally{ta(p)}}}}function ta(p,T){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const C=p.g;p.g=null,T||Bt(p,"ready");try{C.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function ki(p){return p.g?p.g.readyState:0}t.ca=function(){try{return ki(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(p){if(this.g){var T=this.g.responseText;return p&&T.indexOf(p)==0&&(T=T.substring(p.length)),Zr(T)}};function Qf(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function eu(p){const T={};p=(p.g&&ki(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<p.length;z++){if(B(p[z]))continue;var C=P(p[z]);const ae=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const pe=T[ae]||[];T[ae]=pe,pe.push(C)}we(T,function(z){return z.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ai(p,T,C){return C&&C.internalChannelParams&&C.internalChannelParams[p]||T}function Nl(p){this.za=0,this.i=[],this.j=new Bs,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ai("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ai("baseRetryDelayMs",5e3,p),this.Za=Ai("retryDelaySeedMs",1e4,p),this.Ta=Ai("forwardChannelMaxRetries",2,p),this.va=Ai("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new $t(p&&p.concurrentRequestLimit),this.Ba=new bo,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Nl.prototype,t.ka=8,t.I=1,t.connect=function(p,T,C,z){Rt(0),this.W=p,this.H=T||{},C&&z!==void 0&&(this.H.OSID=C,this.H.OAID=z),this.F=this.X,this.J=ru(this,null,this.W),ra(this)};function bl(p){if(Dl(p),p.I==3){var T=p.V++,C=rt(p.J);if(bt(C,"SID",p.M),bt(C,"RID",T),bt(C,"TYPE","terminate"),Ci(p,C),T=new q(p,p.j,T),T.M=2,T.A=un(rt(C)),C=!1,o.navigator&&o.navigator.sendBeacon)try{C=o.navigator.sendBeacon(T.A.toString(),"")}catch{}!C&&o.Image&&(new Image().src=T.A,C=!0),C||(T.g=Zf(T.j,null),T.g.ea(T.A)),T.F=Date.now(),fe(T)}Oo(p)}function ks(p){p.g&&(Po(p),p.g.cancel(),p.g=null)}function Dl(p){ks(p),p.v&&(o.clearTimeout(p.v),p.v=null),Pl(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&o.clearTimeout(p.m),p.m=null)}function ra(p){if(!Qt(p.h)&&!p.m){p.m=!0;var T=p.Ea;W||F(),j||(W(),j=!0),A.add(T,p),p.D=0}}function Jf(p,T){return lr(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=T.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=An(h(p.Ea,p,T),Ll(p,p.D)),p.D++,!0)}t.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const ae=new q(this,this.j,p);let pe=this.o;if(this.U&&(pe?(pe=ee(pe),te(pe,this.U)):pe=this.U),this.u!==null||this.R||(ae.J=pe,pe=null),this.S)e:{for(var T=0,C=0;C<this.i.length;C++){t:{var z=this.i[C];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(T+=z,T>4096){T=C;break e}if(T===4096||C===this.i.length-1){T=C+1;break e}}T=1e3}else T=1e3;T=tu(this,ae,T),C=rt(this.J),bt(C,"RID",p),bt(C,"CVER",22),this.G&&bt(C,"X-HTTP-Session-Id",this.G),Ci(this,C),pe&&(this.R?T="headers="+ls(Xf(pe))+"&"+T:this.u&&Rl(C,this.u,pe)),cs(this.h,ae),this.Ra&&bt(C,"TYPE","init"),this.S?(bt(C,"$req",T),bt(C,"SID","null"),ae.U=!0,X(ae,C,null)):X(ae,C,T),this.I=2}}else this.I==3&&(p?Do(this,p):this.i.length==0||Qt(this.h)||Do(this))};function Do(p,T){var C;T?C=T.l:C=p.V++;const z=rt(p.J);bt(z,"SID",p.M),bt(z,"RID",C),bt(z,"AID",p.K),Ci(p,z),p.u&&p.o&&Rl(z,p.u,p.o),C=new q(p,p.j,C,p.D+1),p.u===null&&(C.J=p.o),T&&(p.i=T.G.concat(p.i)),T=tu(p,C,1e3),C.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),cs(p.h,C),X(C,z,T)}function Ci(p,T){p.H&&ne(p.H,function(C,z){bt(T,z,C)}),p.l&&ne({},function(C,z){bt(T,z,C)})}function tu(p,T,C){C=Math.min(p.i.length,C);const z=p.l?h(p.l.Ka,p.l,p):null;e:{var ae=p.i;let _t=-1;for(;;){const Nr=["count="+C];_t==-1?C>0?(_t=ae[0].g,Nr.push("ofs="+_t)):_t=0:Nr.push("ofs="+_t);let er=!0;for(let Mr=0;Mr<C;Mr++){var pe=ae[Mr].g;const Cs=ae[Mr].map;if(pe-=_t,pe<0)_t=Math.max(0,ae[Mr].g-100),er=!1;else try{pe="req"+pe+"_"||"";try{var $e=Cs instanceof Map?Cs:Object.entries(Cs);for(const[na,Fi]of $e){let Ri=Fi;c(Fi)&&(Ri=or(Fi)),Nr.push(pe+na+"="+encodeURIComponent(Ri))}}catch(na){throw Nr.push(pe+"type="+encodeURIComponent("_badmap")),na}}catch{z&&z(Cs)}}if(er){$e=Nr.join("&");break e}}$e=void 0}return p=p.i.splice(0,C),T.G=p,$e}function In(p){if(!p.g&&!p.v){p.Y=1;var T=p.Da;W||F(),j||(W(),j=!0),A.add(T,p),p.A=0}}function Ii(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=An(h(p.Da,p),Ll(p,p.A)),p.A++,!0)}t.Da=function(){if(this.v=null,Ma(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=An(h(this.Wa,this),p)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Rt(10),ks(this),Ma(this))};function Po(p){p.B!=null&&(o.clearTimeout(p.B),p.B=null)}function Ma(p){p.g=new q(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var T=rt(p.na);bt(T,"RID","rpc"),bt(T,"SID",p.M),bt(T,"AID",p.K),bt(T,"CI",p.F?"0":"1"),!p.F&&p.ia&&bt(T,"TO",p.ia),bt(T,"TYPE","xmlhttp"),Ci(p,T),p.u&&p.o&&Rl(T,p.u,p.o),p.O&&(p.g.H=p.O);var C=p.g;p=p.ba,C.M=1,C.A=un(rt(T)),C.u=null,C.R=!0,ce(C,p)}t.Va=function(){this.C!=null&&(this.C=null,ks(this),Ii(this),Rt(19))};function Pl(p){p.C!=null&&(o.clearTimeout(p.C),p.C=null)}function Ol(p,T){var C=null;if(p.g==T){Pl(p),Po(p),p.g=null;var z=2}else if(Ts(p.h,T))C=T.G,Jn(p.h,T),z=1;else return;if(p.I!=0){if(T.o)if(z==1){C=T.u?T.u.length:0,T=Date.now()-T.F;var ae=p.D;z=ws(),Bt(z,new qr(z,C)),ra(p)}else In(p);else if(ae=T.m,ae==3||ae==0&&T.X>0||!(z==1&&Jf(p,T)||z==2&&Ii(p)))switch(C&&C.length>0&&(T=p.h,T.i=T.i.concat(C)),ae){case 1:As(p,5);break;case 4:As(p,10);break;case 3:As(p,6);break;default:As(p,2)}}}function Ll(p,T){let C=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(C*=2),C*T}function As(p,T){if(p.j.info("Error code "+T),T==2){var C=h(p.bb,p),z=p.Ua;const ae=!z;z=new qe(z||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Nt(z,"https"),un(z),ae?Ti(z.toString(),C):Si(z.toString(),C)}else Rt(2);p.I=0,p.l&&p.l.pa(T),Oo(p),Dl(p)}t.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Rt(2)):(this.j.info("Failed to ping google.com"),Rt(1))};function Oo(p){if(p.I=0,p.ja=[],p.l){const T=Se(p.h);(T.length!=0||p.i.length!=0)&&(k(p.ja,T),k(p.ja,p.i),p.h.i.length=0,_(p.i),p.i.length=0),p.l.oa()}}function ru(p,T,C){var z=C instanceof qe?rt(C):new qe(C);if(z.g!="")T&&(z.g=T+"."+z.g),Gt(z,z.u);else{var ae=o.location;z=ae.protocol,T=T?T+"."+ae.hostname:ae.hostname,ae=+ae.port;const pe=new qe(null);z&&Nt(pe,z),T&&(pe.g=T),ae&&Gt(pe,ae),C&&(pe.h=C),z=pe}return C=p.G,T=p.wa,C&&T&&bt(z,C,T),bt(z,"VER",p.ka),Ci(p,z),z}function Zf(p,T,C){if(T&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return T=p.Aa&&!p.ma?new ar(new Zi({ab:C})):new ar(p.ma),T.Fa(p.L),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function eh(){}t=eh.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Ml(){}Ml.prototype.g=function(p,T){return new dn(p,T)};function dn(p,T){Mt.call(this),this.g=new Nl(T),this.l=p,this.h=T&&T.messageUrlParams||null,p=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(p?p["X-WebChannel-Content-Type"]=T.messageContentType:p={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.sa&&(p?p["X-WebChannel-Client-Profile"]=T.sa:p={"X-WebChannel-Client-Profile":T.sa}),this.g.U=p,(p=T&&T.Qb)&&!B(p)&&(this.g.u=p),this.A=T&&T.supportsCrossDomainXhr||!1,this.v=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!B(T)&&(this.g.G=T,p=this.h,p!==null&&T in p&&(p=this.h,T in p&&delete p[T])),this.j=new Va(this)}g(dn,Mt),dn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},dn.prototype.close=function(){bl(this.g)},dn.prototype.o=function(p){var T=this.g;if(typeof p=="string"){var C={};C.__data__=p,p=C}else this.v&&(C={},C.__data__=or(p),p=C);T.i.push(new ft(T.Ya++,p)),T.I==3&&ra(T)},dn.prototype.N=function(){this.g.l=null,delete this.j,bl(this.g),delete this.g,dn.Z.N.call(this)};function th(p){kn.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var T=p.__sm__;if(T){e:{for(const C in T){p=C;break e}p=void 0}(this.i=p)&&(p=this.i,T=T!==null&&p in T?T[p]:void 0),this.data=T}else this.data=p}g(th,kn);function rh(){ni.call(this),this.status=1}g(rh,ni);function Va(p){this.g=p}g(Va,eh),Va.prototype.ra=function(){Bt(this.g,"a")},Va.prototype.qa=function(p){Bt(this.g,new th(p))},Va.prototype.pa=function(p){Bt(this.g,new rh)},Va.prototype.oa=function(){Bt(this.g,"b")},Ml.prototype.createWebChannel=Ml.prototype.g,dn.prototype.send=dn.prototype.o,dn.prototype.open=dn.prototype.m,dn.prototype.close=dn.prototype.close,lE=function(){return new Ml},oE=function(){return ws()},aE=Kn,Xm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},os.NO_ERROR=0,os.TIMEOUT=8,os.HTTP_ERROR=6,m0=os,Cn.COMPLETE="complete",iE=Cn,Gr.EventType=Yt,Yt.OPEN="a",Yt.CLOSE="b",Yt.ERROR="c",Yt.MESSAGE="d",Mt.prototype.listen=Mt.prototype.J,Nu=Gr,ar.prototype.listenOnce=ar.prototype.K,ar.prototype.getLastError=ar.prototype.Ha,ar.prototype.getLastErrorCode=ar.prototype.ya,ar.prototype.getStatus=ar.prototype.ca,ar.prototype.getResponseJson=ar.prototype.La,ar.prototype.getResponseText=ar.prototype.la,ar.prototype.send=ar.prototype.ea,ar.prototype.setWithCredentials=ar.prototype.Fa,sE=ar}).apply(typeof Qh<"u"?Qh:typeof self<"u"?self:typeof window<"u"?window:{});const oy="@firebase/firestore",ly="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ln.UNAUTHENTICATED=new Ln(null),Ln.GOOGLE_CREDENTIALS=new Ln("google-credentials-uid"),Ln.FIRST_PARTY=new Ln("first-party-uid"),Ln.MOCK_USER=new Ln("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lc="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul=new Vg("@firebase/firestore");function lc(){return ul.logLevel}function Ye(t,...e){if(ul.logLevel<=Dt.DEBUG){const r=e.map(jg);ul.debug(`Firestore (${Lc}): ${t}`,...r)}}function Ea(t,...e){if(ul.logLevel<=Dt.ERROR){const r=e.map(jg);ul.error(`Firestore (${Lc}): ${t}`,...r)}}function Sc(t,...e){if(ul.logLevel<=Dt.WARN){const r=e.map(jg);ul.warn(`Firestore (${Lc}): ${t}`,...r)}}function jg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(r){return JSON.stringify(r)})(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,cE(t,n,r)}function cE(t,e,r){let n=`FIRESTORE (${Lc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Ea(n),new Error(n)}function Jt(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||cE(e,s,n)}function yt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ke extends Ia{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class nI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(Ln.UNAUTHENTICATED)))}shutdown(){}}class sI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class iI{constructor(e){this.t=e,this.currentUser=Ln.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Jt(this.o===void 0,42304);let n=this.i;const s=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let i=new ga;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ga,e.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const u=i;e.enqueueRetryable((async()=>{await u.promise,await s(this.currentUser)}))},c=u=>{Ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ga)}}),0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(Ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Jt(typeof n.accessToken=="string",31837,{l:n}),new uE(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Jt(e===null||typeof e=="string",2055,{h:e}),new Ln(e)}}class aI{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Ln.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class oI{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new aI(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(Ln.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class cy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lI{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,di(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Jt(this.o===void 0,3512);const n=i=>{i.error!=null&&Ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Ye("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>n(i)))};const s=i=>{Ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new cy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Jt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new cy(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=cI(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%62))}return n}}function Pt(t,e){return t<e?-1:t>e?1:0}function Ym(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const s=t.charAt(n),i=e.charAt(n);if(s!==i)return xm(s)===xm(i)?Pt(s,i):xm(s)?1:-1}return Pt(t.length,e.length)}const uI=55296,fI=57343;function xm(t){const e=t.charCodeAt(0);return e>=uI&&e<=fI}function kc(t,e,r){return t.length===e.length&&t.every(((n,s)=>r(n,e[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy="__name__";class Vi{constructor(e,r,n){r===void 0?r=0:r>e.length&&dt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&dt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Vi.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Vi?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=Vi.compareSegments(e.get(s),r.get(s));if(i!==0)return i}return Pt(e.length,r.length)}static compareSegments(e,r){const n=Vi.isNumericId(e),s=Vi.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?Vi.extractNumericId(e).compare(Vi.extractNumericId(r)):Ym(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ho.fromString(e.substring(4,e.length-2))}}class ur extends Vi{construct(e,r,n){return new ur(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ke(Ee.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((s=>s.length>0)))}return new ur(r)}static emptyPath(){return new ur([])}}const hI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _n extends Vi{construct(e,r,n){return new _n(e,r,n)}static isValidIdentifier(e){return hI.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_n.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===uy}static keyField(){return new _n([uy])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new Ke(Ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new Ke(Ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ke(Ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(n+=c,s++):(i(),s++)}if(i(),o)throw new Ke(Ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _n(r)}static emptyPath(){return new _n([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.path=e}static fromPath(e){return new st(ur.fromString(e))}static fromName(e){return new st(ur.fromString(e).popFirst(5))}static empty(){return new st(ur.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ur.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ur.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new st(new ur(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE(t,e,r){if(!r)throw new Ke(Ee.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function dI(t,e,r,n){if(e===!0&&n===!0)throw new Ke(Ee.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function fy(t){if(!st.isDocumentKey(t))throw new Ke(Ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function hy(t){if(st.isDocumentKey(t))throw new Ke(Ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function hE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function od(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":dt(12329,{type:typeof t})}function ns(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ke(Ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=od(t);throw new Ke(Ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(t,e){const r={typeString:t};return e&&(r.value=e),r}function Cf(t,e){if(!hE(t))throw new Ke(Ee.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(s&&typeof o!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new Ke(Ee.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy=-62135596800,py=1e6;class pr{static now(){return pr.fromMillis(Date.now())}static fromDate(e){return pr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*py);return new pr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ke(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ke(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<dy)throw new Ke(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ke(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/py}_compareTo(e){return this.seconds===e.seconds?Pt(this.nanoseconds,e.nanoseconds):Pt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:pr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Cf(e,pr._jsonSchema))return new pr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-dy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}pr._jsonSchemaVersion="firestore/timestamp/1.0",pr._jsonSchema={type:Wr("string",pr._jsonSchemaVersion),seconds:Wr("number"),nanoseconds:Wr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{static fromTimestamp(e){return new vt(e)}static min(){return new vt(new pr(0,0))}static max(){return new vt(new pr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef=-1;function pI(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=vt.fromTimestamp(n===1e9?new pr(r+1,0):new pr(r,n));return new mo(s,st.empty(),e)}function mI(t){return new mo(t.readTime,t.key,ef)}class mo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new mo(vt.min(),st.empty(),ef)}static max(){return new mo(vt.max(),st.empty(),ef)}}function gI(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=st.comparator(t.documentKey,e.documentKey),r!==0?r:Pt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mc(t){if(t.code!==Ee.FAILED_PRECONDITION||t.message!==xI)throw t;Ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&dt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ke(((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof ke?r:ke.resolve(r)}catch(r){return ke.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):ke.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):ke.reject(r)}static resolve(e){return new ke(((r,n)=>{r(e)}))}static reject(e){return new ke(((r,n)=>{n(e)}))}static waitFor(e){return new ke(((r,n)=>{let s=0,i=0,o=!1;e.forEach((c=>{++s,c.next((()=>{++i,o&&i===s&&r()}),(u=>n(u)))})),o=!0,i===s&&r()}))}static or(e){let r=ke.resolve(!1);for(const n of e)r=r.next((s=>s?ke.resolve(s):n()));return r}static forEach(e,r){const n=[];return e.forEach(((s,i)=>{n.push(r.call(this,s,i))})),this.waitFor(n)}static mapArray(e,r){return new ke(((n,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;r(e[h]).next((d=>{o[h]=d,++c,c===i&&n(o)}),(d=>s(d)))}}))}static doWhile(e,r){return new ke(((n,s)=>{const i=()=>{e()===!0?r().next((()=>{i()}),s):n()};i()}))}}function _I(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Vc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ld.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg=-1;function cd(t){return t==null}function I0(t){return t===0&&1/t==-1/0}function yI(t){return typeof t=="number"&&Number.isInteger(t)&&!I0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE="";function wI(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=my(e)),e=EI(t.get(r),e);return my(e)}function EI(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const i=t.charAt(s);switch(i){case"\0":r+="";break;case dE:r+="";break;default:r+=i}}return r}function my(t){return t+dE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gy(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ko(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function pE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,r){this.comparator=e,this.root=r||xn.EMPTY}insert(e,r){return new Sr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,xn.BLACK,null,null))}remove(e){return new Sr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jh(this.root,e,this.comparator,!0)}}class Jh{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xn{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??xn.RED,this.left=s??xn.EMPTY,this.right=i??xn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new xn(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return xn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return xn.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw dt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw dt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw dt(27949);return e+(this.isRed()?0:1)}}xn.EMPTY=null,xn.RED=!0,xn.BLACK=!1;xn.EMPTY=new class{constructor(){this.size=0}get key(){throw dt(57766)}get value(){throw dt(16141)}get color(){throw dt(16727)}get left(){throw dt(29726)}get right(){throw dt(36894)}copy(e,r,n,s,i){return this}insert(e,r,n){return new xn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.comparator=e,this.data=new Sr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new xy(this.data.getIterator())}getIteratorFrom(e){return new xy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof Qr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new Qr(this.comparator);return r.data=e,r}}class xy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e){this.fields=e,e.sort(_n.comparator)}static empty(){return new Ls([])}unionWith(e){let r=new Qr(_n.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ls(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return kc(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new mE("Invalid base64 string: "+i):i}})(e);return new En(r)}static fromUint8Array(e){const r=(function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i})(e);return new En(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}En.EMPTY_BYTE_STRING=new En("");const TI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){if(Jt(!!t,39018),typeof t=="string"){let e=0;const r=TI.exec(t);if(Jt(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Pr(t.seconds),nanos:Pr(t.nanos)}}function Pr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function xo(t){return typeof t=="string"?En.fromBase64String(t):En.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE="server_timestamp",xE="__type__",vE="__previous_value__",_E="__local_write_time__";function Wg(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[xE])==null?void 0:n.stringValue)===gE}function ud(t){const e=t.mapValue.fields[vE];return Wg(e)?ud(e):e}function tf(t){const e=go(t.mapValue.fields[_E].timestampValue);return new pr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(e,r,n,s,i,o,c,u,h,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=d}}const F0="(default)";class rf{constructor(e,r){this.projectId=e,this.database=r||F0}static empty(){return new rf("","")}get isDefaultDatabase(){return this.database===F0}isEqual(e){return e instanceof rf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yE="__type__",kI="__max__",Zh={mapValue:{}},wE="__vector__",R0="value";function vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Wg(t)?4:CI(t)?9007199254740991:AI(t)?10:11:dt(28295,{value:t})}function qi(t,e){if(t===e)return!0;const r=vo(t);if(r!==vo(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return tf(t).isEqual(tf(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=go(s.timestampValue),c=go(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(s,i){return xo(s.bytesValue).isEqual(xo(i.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(s,i){return Pr(s.geoPointValue.latitude)===Pr(i.geoPointValue.latitude)&&Pr(s.geoPointValue.longitude)===Pr(i.geoPointValue.longitude)})(t,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return Pr(s.integerValue)===Pr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Pr(s.doubleValue),c=Pr(i.doubleValue);return o===c?I0(o)===I0(c):isNaN(o)&&isNaN(c)}return!1})(t,e);case 9:return kc(t.arrayValue.values||[],e.arrayValue.values||[],qi);case 10:case 11:return(function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(gy(o)!==gy(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!qi(o[u],c[u])))return!1;return!0})(t,e);default:return dt(52216,{left:t})}}function nf(t,e){return(t.values||[]).find((r=>qi(r,e)))!==void 0}function Ac(t,e){if(t===e)return 0;const r=vo(t),n=vo(e);if(r!==n)return Pt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Pt(t.booleanValue,e.booleanValue);case 2:return(function(i,o){const c=Pr(i.integerValue||i.doubleValue),u=Pr(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(t,e);case 3:return vy(t.timestampValue,e.timestampValue);case 4:return vy(tf(t),tf(e));case 5:return Ym(t.stringValue,e.stringValue);case 6:return(function(i,o){const c=xo(i),u=xo(o);return c.compareTo(u)})(t.bytesValue,e.bytesValue);case 7:return(function(i,o){const c=i.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){const d=Pt(c[h],u[h]);if(d!==0)return d}return Pt(c.length,u.length)})(t.referenceValue,e.referenceValue);case 8:return(function(i,o){const c=Pt(Pr(i.latitude),Pr(o.latitude));return c!==0?c:Pt(Pr(i.longitude),Pr(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return _y(t.arrayValue,e.arrayValue);case 10:return(function(i,o){var x,_,k,y;const c=i.fields||{},u=o.fields||{},h=(x=c[R0])==null?void 0:x.arrayValue,d=(_=u[R0])==null?void 0:_.arrayValue,g=Pt(((k=h==null?void 0:h.values)==null?void 0:k.length)||0,((y=d==null?void 0:d.values)==null?void 0:y.length)||0);return g!==0?g:_y(h,d)})(t.mapValue,e.mapValue);case 11:return(function(i,o){if(i===Zh.mapValue&&o===Zh.mapValue)return 0;if(i===Zh.mapValue)return 1;if(o===Zh.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),h=o.fields||{},d=Object.keys(h);u.sort(),d.sort();for(let g=0;g<u.length&&g<d.length;++g){const x=Ym(u[g],d[g]);if(x!==0)return x;const _=Ac(c[u[g]],h[d[g]]);if(_!==0)return _}return Pt(u.length,d.length)})(t.mapValue,e.mapValue);default:throw dt(23264,{he:r})}}function vy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Pt(t,e);const r=go(t),n=go(e),s=Pt(r.seconds,n.seconds);return s!==0?s:Pt(r.nanos,n.nanos)}function _y(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Ac(r[s],n[s]);if(i)return i}return Pt(r.length,n.length)}function Cc(t){return Qm(t)}function Qm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=go(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return xo(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return st.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=Qm(i);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const o of n)i?i=!1:s+=",",s+=`${o}:${Qm(r.fields[o])}`;return s+"}"})(t.mapValue):dt(61005,{value:t})}function g0(t){switch(vo(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ud(t);return e?16+g0(e):16;case 5:return 2*t.stringValue.length;case 6:return xo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,i)=>s+g0(i)),0)})(t.arrayValue);case 10:case 11:return(function(n){let s=0;return ko(n.fields,((i,o)=>{s+=i.length+g0(o)})),s})(t.mapValue);default:throw dt(13486,{value:t})}}function yy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Jm(t){return!!t&&"integerValue"in t}function $g(t){return!!t&&"arrayValue"in t}function wy(t){return!!t&&"nullValue"in t}function Ey(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function x0(t){return!!t&&"mapValue"in t}function AI(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[yE])==null?void 0:n.stringValue)===wE}function Bu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ko(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=Bu(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Bu(t.arrayValue.values[r]);return e}return{...t}}function CI(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===kI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this.value=e}static empty(){return new vs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!x0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bu(r)}setAll(e){let r=_n.emptyPath(),n={},s=[];e.forEach(((o,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,s),n={},s=[],r=c.popLast()}o?n[c.lastSegment()]=Bu(o):s.push(c.lastSegment())}));const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());x0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return qi(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];x0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){ko(r,((s,i)=>e[s]=i));for(const s of n)delete e[s]}clone(){return new vs(Bu(this.value))}}function EE(t){const e=[];return ko(t.fields,((r,n)=>{const s=new _n([r]);if(x0(n)){const i=EE(n.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)})),new Ls(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,r,n,s,i,o,c){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Un(e,0,vt.min(),vt.min(),vt.min(),vs.empty(),0)}static newFoundDocument(e,r,n,s){return new Un(e,1,r,vt.min(),n,s,0)}static newNoDocument(e,r){return new Un(e,2,r,vt.min(),vt.min(),vs.empty(),0)}static newUnknownDocument(e,r){return new Un(e,3,r,vt.min(),vt.min(),vs.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(vt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=vs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=vs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=vt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Un&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Un(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,r){this.position=e,this.inclusive=r}}function Ty(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?n=st.comparator(st.fromName(o.referenceValue),r.key):n=Ac(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function Sy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!qi(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e,r="asc"){this.field=e,this.dir=r}}function II(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{}class Hr extends TE{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new RI(e,r,n):r==="array-contains"?new DI(e,n):r==="in"?new PI(e,n):r==="not-in"?new OI(e,n):r==="array-contains-any"?new LI(e,n):new Hr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new NI(e,n):new bI(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Ac(r,this.value)):r!==null&&vo(this.value)===vo(r)&&this.matchesComparison(Ac(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class yi extends TE{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new yi(e,r)}matches(e){return SE(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function SE(t){return t.op==="and"}function kE(t){return FI(t)&&SE(t)}function FI(t){for(const e of t.filters)if(e instanceof yi)return!1;return!0}function Zm(t){if(t instanceof Hr)return t.field.canonicalString()+t.op.toString()+Cc(t.value);if(kE(t))return t.filters.map((e=>Zm(e))).join(",");{const e=t.filters.map((r=>Zm(r))).join(",");return`${t.op}(${e})`}}function AE(t,e){return t instanceof Hr?(function(n,s){return s instanceof Hr&&n.op===s.op&&n.field.isEqual(s.field)&&qi(n.value,s.value)})(t,e):t instanceof yi?(function(n,s){return s instanceof yi&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((i,o,c)=>i&&AE(o,s.filters[c])),!0):!1})(t,e):void dt(19439)}function CE(t){return t instanceof Hr?(function(r){return`${r.field.canonicalString()} ${r.op} ${Cc(r.value)}`})(t):t instanceof yi?(function(r){return r.op.toString()+" {"+r.getFilters().map(CE).join(" ,")+"}"})(t):"Filter"}class RI extends Hr{constructor(e,r,n){super(e,r,n),this.key=st.fromName(n.referenceValue)}matches(e){const r=st.comparator(e.key,this.key);return this.matchesComparison(r)}}class NI extends Hr{constructor(e,r){super(e,"in",r),this.keys=IE("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class bI extends Hr{constructor(e,r){super(e,"not-in",r),this.keys=IE("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function IE(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map((n=>st.fromName(n.referenceValue)))}class DI extends Hr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return $g(r)&&nf(r.arrayValue,this.value)}}class PI extends Hr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&nf(this.value.arrayValue,r)}}class OI extends Hr{constructor(e,r){super(e,"not-in",r)}matches(e){if(nf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!nf(this.value.arrayValue,r)}}class LI extends Hr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!$g(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>nf(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e,r=null,n=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.Te=null}}function ky(t,e=null,r=[],n=[],s=null,i=null,o=null){return new MI(t,e,r,n,s,i,o)}function Gg(t){const e=yt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>Zm(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(i){return i.field.canonicalString()+i.dir})(n))).join(","),cd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>Cc(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>Cc(n))).join(",")),e.Te=r}return e.Te}function qg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!II(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!AE(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Sy(t.startAt,e.startAt)&&Sy(t.endAt,e.endAt)}function eg(t){return st.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(e,r=null,n=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function VI(t,e,r,n,s,i,o,c){return new Bc(t,e,r,n,s,i,o,c)}function fd(t){return new Bc(t)}function Ay(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function FE(t){return t.collectionGroup!==null}function Uu(t){const e=yt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Qr(_n.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new sf(i,n))})),r.has(_n.keyField().canonicalString())||e.Ie.push(new sf(_n.keyField(),n))}return e.Ie}function zi(t){const e=yt(t);return e.Ee||(e.Ee=BI(e,Uu(t))),e.Ee}function BI(t,e){if(t.limitType==="F")return ky(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new sf(s.field,i)}));const r=t.endAt?new N0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new N0(t.startAt.position,t.startAt.inclusive):null;return ky(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function tg(t,e){const r=t.filters.concat([e]);return new Bc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function rg(t,e,r){return new Bc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function hd(t,e){return qg(zi(t),zi(e))&&t.limitType===e.limitType}function RE(t){return`${Gg(zi(t))}|lt:${t.limitType}`}function cc(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((s=>CE(s))).join(", ")}]`),cd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((s=>Cc(s))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((s=>Cc(s))).join(",")),`Target(${n})`})(zi(t))}; limitType=${t.limitType})`}function dd(t,e){return e.isFoundDocument()&&(function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):st.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)})(t,e)&&(function(n,s){for(const i of Uu(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(t,e)&&(function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0})(t,e)&&(function(n,s){return!(n.startAt&&!(function(o,c,u){const h=Ty(o,c,u);return o.inclusive?h<=0:h<0})(n.startAt,Uu(n),s)||n.endAt&&!(function(o,c,u){const h=Ty(o,c,u);return o.inclusive?h>=0:h>0})(n.endAt,Uu(n),s))})(t,e)}function UI(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function NE(t){return(e,r)=>{let n=!1;for(const s of Uu(t)){const i=jI(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function jI(t,e,r){const n=t.field.isKeyField()?st.comparator(e.key,r.key):(function(i,o,c){const u=o.data.field(i),h=c.data.field(i);return u!==null&&h!==null?Ac(u,h):dt(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return dt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ko(this.inner,((r,n)=>{for(const[s,i]of n)e(s,i)}))}isEmpty(){return pE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zI=new Sr(st.comparator);function Ta(){return zI}const bE=new Sr(st.comparator);function bu(...t){let e=bE;for(const r of t)e=e.insert(r.key,r);return e}function DE(t){let e=bE;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function Yo(){return ju()}function PE(){return ju()}function ju(){return new yl((t=>t.toString()),((t,e)=>t.isEqual(e)))}const HI=new Sr(st.comparator),WI=new Qr(st.comparator);function Ot(...t){let e=WI;for(const r of t)e=e.add(r);return e}const $I=new Qr(Pt);function GI(){return $I}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:I0(e)?"-0":e}}function OE(t){return{integerValue:""+t}}function qI(t,e){return yI(e)?OE(e):Kg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(){this._=void 0}}function KI(t,e,r){return t instanceof af?(function(s,i){const o={fields:{[xE]:{stringValue:gE},[_E]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Wg(i)&&(i=ud(i)),i&&(o.fields[vE]=i),{mapValue:o}})(r,e):t instanceof of?ME(t,e):t instanceof lf?VE(t,e):(function(s,i){const o=LE(s,i),c=Cy(o)+Cy(s.Ae);return Jm(o)&&Jm(s.Ae)?OE(c):Kg(s.serializer,c)})(t,e)}function XI(t,e,r){return t instanceof of?ME(t,e):t instanceof lf?VE(t,e):r}function LE(t,e){return t instanceof b0?(function(n){return Jm(n)||(function(i){return!!i&&"doubleValue"in i})(n)})(e)?e:{integerValue:0}:null}class af extends pd{}class of extends pd{constructor(e){super(),this.elements=e}}function ME(t,e){const r=BE(e);for(const n of t.elements)r.some((s=>qi(s,n)))||r.push(n);return{arrayValue:{values:r}}}class lf extends pd{constructor(e){super(),this.elements=e}}function VE(t,e){let r=BE(e);for(const n of t.elements)r=r.filter((s=>!qi(s,n)));return{arrayValue:{values:r}}}class b0 extends pd{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Cy(t){return Pr(t.integerValue||t.doubleValue)}function BE(t){return $g(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(e,r){this.field=e,this.transform=r}}function QI(t,e){return t.field.isEqual(e.field)&&(function(n,s){return n instanceof of&&s instanceof of||n instanceof lf&&s instanceof lf?kc(n.elements,s.elements,qi):n instanceof b0&&s instanceof b0?qi(n.Ae,s.Ae):n instanceof af&&s instanceof af})(t.transform,e.transform)}class JI{constructor(e,r){this.version=e,this.transformResults=r}}class ss{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new ss}static exists(e){return new ss(void 0,e)}static updateTime(e){return new ss(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function v0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class md{}function UE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new gd(t.key,ss.none()):new If(t.key,t.data,ss.none());{const r=t.data,n=vs.empty();let s=new Qr(_n.comparator);for(let i of e.fields)if(!s.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),s=s.add(i)}return new Ao(t.key,n,new Ls(s.toArray()),ss.none())}}function ZI(t,e,r){t instanceof If?(function(s,i,o){const c=s.value.clone(),u=Fy(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(t,e,r):t instanceof Ao?(function(s,i,o){if(!v0(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=Fy(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(jE(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(t,e,r):(function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,r)}function zu(t,e,r,n){return t instanceof If?(function(i,o,c,u){if(!v0(i.precondition,o))return c;const h=i.value.clone(),d=Ry(i.fieldTransforms,u,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(t,e,r,n):t instanceof Ao?(function(i,o,c,u){if(!v0(i.precondition,o))return c;const h=Ry(i.fieldTransforms,u,o),d=o.data;return d.setAll(jE(i)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((g=>g.field)))})(t,e,r,n):(function(i,o,c){return v0(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(t,e,r)}function eF(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=LE(n.transform,s||null);i!=null&&(r===null&&(r=vs.empty()),r.set(n.field,i))}return r||null}function Iy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&kc(n,s,((i,o)=>QI(i,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class If extends md{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ao extends md{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function jE(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function Fy(t,e,r){const n=new Map;Jt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let s=0;s<r.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);n.set(i.field,XI(o,c,r[s]))}return n}function Ry(t,e,r){const n=new Map;for(const s of t){const i=s.transform,o=r.data.field(s.field);n.set(s.field,KI(i,o,e))}return n}class gd extends md{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tF extends md{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rF{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&ZI(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=zu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=zu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=PE();return this.mutations.forEach((s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=r.has(s.key)?null:c;const u=UE(o,c);u!==null&&n.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(vt.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Ot())}isEqual(e){return this.batchId===e.batchId&&kc(this.mutations,e.mutations,((r,n)=>Iy(r,n)))&&kc(this.baseMutations,e.baseMutations,((r,n)=>Iy(r,n)))}}class Xg{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){Jt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=(function(){return HI})();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,n[o].version);return new Xg(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sF{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ur,Ut;function iF(t){switch(t){case Ee.OK:return dt(64938);case Ee.CANCELLED:case Ee.UNKNOWN:case Ee.DEADLINE_EXCEEDED:case Ee.RESOURCE_EXHAUSTED:case Ee.INTERNAL:case Ee.UNAVAILABLE:case Ee.UNAUTHENTICATED:return!1;case Ee.INVALID_ARGUMENT:case Ee.NOT_FOUND:case Ee.ALREADY_EXISTS:case Ee.PERMISSION_DENIED:case Ee.FAILED_PRECONDITION:case Ee.ABORTED:case Ee.OUT_OF_RANGE:case Ee.UNIMPLEMENTED:case Ee.DATA_LOSS:return!0;default:return dt(15467,{code:t})}}function zE(t){if(t===void 0)return Ea("GRPC error has no .code"),Ee.UNKNOWN;switch(t){case Ur.OK:return Ee.OK;case Ur.CANCELLED:return Ee.CANCELLED;case Ur.UNKNOWN:return Ee.UNKNOWN;case Ur.DEADLINE_EXCEEDED:return Ee.DEADLINE_EXCEEDED;case Ur.RESOURCE_EXHAUSTED:return Ee.RESOURCE_EXHAUSTED;case Ur.INTERNAL:return Ee.INTERNAL;case Ur.UNAVAILABLE:return Ee.UNAVAILABLE;case Ur.UNAUTHENTICATED:return Ee.UNAUTHENTICATED;case Ur.INVALID_ARGUMENT:return Ee.INVALID_ARGUMENT;case Ur.NOT_FOUND:return Ee.NOT_FOUND;case Ur.ALREADY_EXISTS:return Ee.ALREADY_EXISTS;case Ur.PERMISSION_DENIED:return Ee.PERMISSION_DENIED;case Ur.FAILED_PRECONDITION:return Ee.FAILED_PRECONDITION;case Ur.ABORTED:return Ee.ABORTED;case Ur.OUT_OF_RANGE:return Ee.OUT_OF_RANGE;case Ur.UNIMPLEMENTED:return Ee.UNIMPLEMENTED;case Ur.DATA_LOSS:return Ee.DATA_LOSS;default:return dt(39323,{code:t})}}(Ut=Ur||(Ur={}))[Ut.OK=0]="OK",Ut[Ut.CANCELLED=1]="CANCELLED",Ut[Ut.UNKNOWN=2]="UNKNOWN",Ut[Ut.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ut[Ut.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ut[Ut.NOT_FOUND=5]="NOT_FOUND",Ut[Ut.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ut[Ut.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ut[Ut.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ut[Ut.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ut[Ut.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ut[Ut.ABORTED=10]="ABORTED",Ut[Ut.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ut[Ut.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ut[Ut.INTERNAL=13]="INTERNAL",Ut[Ut.UNAVAILABLE=14]="UNAVAILABLE",Ut[Ut.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=new ho([4294967295,4294967295],0);function Ny(t){const e=aF().encode(t),r=new nE;return r.update(e),new Uint8Array(r.digest())}function by(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ho([r,n],0),new ho([s,i],0)]}class Yg{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Du(`Invalid padding: ${r}`);if(n<0)throw new Du(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Du(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Du(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=ho.fromNumber(this.ge)}ye(e,r,n){let s=e.add(r.multiply(ho.fromNumber(n)));return s.compare(oF)===1&&(s=new ho([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Ny(e),[n,s]=by(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,s,i);if(!this.we(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Yg(i,s,r);return n.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const r=Ny(e),[n,s]=by(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,s,i);this.Se(o)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Du extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Ff.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new xd(vt.min(),s,new Sr(Pt),Ta(),Ot())}}class Ff{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Ff(n,r,Ot(),Ot(),Ot())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(e,r,n,s){this.be=e,this.removedTargetIds=r,this.key=n,this.De=s}}class HE{constructor(e,r){this.targetId=e,this.Ce=r}}class WE{constructor(e,r,n=En.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class Dy{constructor(){this.ve=0,this.Fe=Py(),this.Me=En.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ot(),r=Ot(),n=Ot();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:dt(38017,{changeType:i})}})),new Ff(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Py()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Jt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class lF{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ta(),this.Je=e0(),this.He=e0(),this.Ye=new Sr(Pt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:dt(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,s)=>{this.rt(s)&&r(s)}))}st(e){const r=e.targetId,n=e.Ce.count,s=this.ot(r);if(s){const i=s.target;if(eg(i))if(n===0){const o=new st(i.path);this.et(r,o,Un.newNoDocument(o,vt.min()))}else Jt(n===1,20013,{expectedCount:n});else{const o=this._t(r);if(o!==n){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let o,c;try{o=xo(n).toUint8Array()}catch(u){if(u instanceof mE)return Sc("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Yg(o,s,i)}catch(u){return Sc(u instanceof Du?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach((i=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(r,i,null),s++)})),s}Tt(e){const r=new Map;this.ze.forEach(((i,o)=>{const c=this.ot(o);if(c){if(i.current&&eg(c.target)){const u=new st(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Un.newNoDocument(u,e))}i.Be&&(r.set(o,i.ke()),i.qe())}}));let n=Ot();this.He.forEach(((i,o)=>{let c=!0;o.forEachWhile((u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(n=n.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const s=new xd(e,r,this.Ye,this.je,n);return this.je=Ta(),this.Je=e0(),this.He=e0(),this.Ye=new Sr(Pt),s}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Dy,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Qr(Pt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Qr(Pt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ye("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Dy),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function e0(){return new Sr(st.comparator)}function Py(){return new Sr(st.comparator)}const cF={asc:"ASCENDING",desc:"DESCENDING"},uF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fF={and:"AND",or:"OR"};class hF{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function ng(t,e){return t.useProto3Json||cd(e)?e:{value:e}}function D0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $E(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function dF(t,e){return D0(t,e.toTimestamp())}function Hi(t){return Jt(!!t,49232),vt.fromTimestamp((function(r){const n=go(r);return new pr(n.seconds,n.nanos)})(t))}function Qg(t,e){return sg(t,e).canonicalString()}function sg(t,e){const r=(function(s){return new ur(["projects",s.projectId,"databases",s.database])})(t).child("documents");return e===void 0?r:r.child(e)}function GE(t){const e=ur.fromString(t);return Jt(QE(e),10190,{key:e.toString()}),e}function ig(t,e){return Qg(t.databaseId,e.path)}function vm(t,e){const r=GE(e);if(r.get(1)!==t.databaseId.projectId)throw new Ke(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ke(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new st(KE(r))}function qE(t,e){return Qg(t.databaseId,e)}function pF(t){const e=GE(t);return e.length===4?ur.emptyPath():KE(e)}function ag(t){return new ur(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function KE(t){return Jt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Oy(t,e,r){return{name:ig(t,e),fields:r.value.mapValue.fields}}function mF(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:dt(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,d){return h.useProto3Json?(Jt(d===void 0||typeof d=="string",58123),En.fromBase64String(d||"")):(Jt(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),En.fromUint8Array(d||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(h){const d=h.code===void 0?Ee.UNKNOWN:zE(h.code);return new Ke(d,h.message||"")})(o);r=new WE(n,s,i,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=vm(t,n.document.name),i=Hi(n.document.updateTime),o=n.document.createTime?Hi(n.document.createTime):vt.min(),c=new vs({mapValue:{fields:n.document.fields}}),u=Un.newFoundDocument(s,i,o,c),h=n.targetIds||[],d=n.removedTargetIds||[];r=new _0(h,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=vm(t,n.document),i=n.readTime?Hi(n.readTime):vt.min(),o=Un.newNoDocument(s,i),c=n.removedTargetIds||[];r=new _0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=vm(t,n.document),i=n.removedTargetIds||[];r=new _0([],i,s,null)}else{if(!("filter"in e))return dt(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,o=new sF(s,i),c=n.targetId;r=new HE(c,o)}}return r}function gF(t,e){let r;if(e instanceof If)r={update:Oy(t,e.key,e.value)};else if(e instanceof gd)r={delete:ig(t,e.key)};else if(e instanceof Ao)r={update:Oy(t,e.key,e.data),updateMask:kF(e.fieldMask)};else{if(!(e instanceof tF))return dt(16599,{Vt:e.type});r={verify:ig(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(i,o){const c=o.transform;if(c instanceof af)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof of)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof lf)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof b0)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw dt(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:dF(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:dt(27497)})(t,e.precondition)),r}function xF(t,e){return t&&t.length>0?(Jt(e!==void 0,14353),t.map((r=>(function(s,i){let o=s.updateTime?Hi(s.updateTime):Hi(i);return o.isEqual(vt.min())&&(o=Hi(i)),new JI(o,s.transformResults||[])})(r,e)))):[]}function vF(t,e){return{documents:[qE(t,e.path)]}}function _F(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=qE(t,s);const i=(function(h){if(h.length!==0)return YE(yi.create(h,"and"))})(e.filters);i&&(r.structuredQuery.where=i);const o=(function(h){if(h.length!==0)return h.map((d=>(function(x){return{field:uc(x.field),direction:EF(x.dir)}})(d)))})(e.orderBy);o&&(r.structuredQuery.orderBy=o);const c=ng(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:r,parent:s}}function yF(t){let e=pF(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Jt(n===1,65062);const d=r.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];r.where&&(i=(function(g){const x=XE(g);return x instanceof yi&&kE(x)?x.getFilters():[x]})(r.where));let o=[];r.orderBy&&(o=(function(g){return g.map((x=>(function(k){return new sf(fc(k.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(x)))})(r.orderBy));let c=null;r.limit&&(c=(function(g){let x;return x=typeof g=="object"?g.value:g,cd(x)?null:x})(r.limit));let u=null;r.startAt&&(u=(function(g){const x=!!g.before,_=g.values||[];return new N0(_,x)})(r.startAt));let h=null;return r.endAt&&(h=(function(g){const x=!g.before,_=g.values||[];return new N0(_,x)})(r.endAt)),VI(e,s,o,i,c,"F",u,h)}function wF(t,e){const r=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return dt(28987,{purpose:s})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function XE(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=fc(r.unaryFilter.field);return Hr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=fc(r.unaryFilter.field);return Hr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=fc(r.unaryFilter.field);return Hr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=fc(r.unaryFilter.field);return Hr.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return dt(61313);default:return dt(60726)}})(t):t.fieldFilter!==void 0?(function(r){return Hr.create(fc(r.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return dt(58110);default:return dt(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return yi.create(r.compositeFilter.filters.map((n=>XE(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return dt(1026)}})(r.compositeFilter.op))})(t):dt(30097,{filter:t})}function EF(t){return cF[t]}function TF(t){return uF[t]}function SF(t){return fF[t]}function uc(t){return{fieldPath:t.canonicalString()}}function fc(t){return _n.fromServerFormat(t.fieldPath)}function YE(t){return t instanceof Hr?(function(r){if(r.op==="=="){if(Ey(r.value))return{unaryFilter:{field:uc(r.field),op:"IS_NAN"}};if(wy(r.value))return{unaryFilter:{field:uc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Ey(r.value))return{unaryFilter:{field:uc(r.field),op:"IS_NOT_NAN"}};if(wy(r.value))return{unaryFilter:{field:uc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:uc(r.field),op:TF(r.op),value:r.value}}})(t):t instanceof yi?(function(r){const n=r.getFilters().map((s=>YE(s)));return n.length===1?n[0]:{compositeFilter:{op:SF(r.op),filters:n}}})(t):dt(54877,{filter:t})}function kF(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function QE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,r,n,s,i=vt.min(),o=vt.min(),c=En.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new ao(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AF{constructor(e){this.yt=e}}function CF(t){const e=yF({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?rg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(){this.Cn=new FF}addToCollectionParentIndex(e,r){return this.Cn.add(r),ke.resolve()}getCollectionParents(e,r){return ke.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return ke.resolve()}deleteFieldIndex(e,r){return ke.resolve()}deleteAllFieldIndexes(e){return ke.resolve()}createTargetIndexes(e,r){return ke.resolve()}getDocumentsMatchingTarget(e,r){return ke.resolve(null)}getIndexType(e,r){return ke.resolve(0)}getFieldIndexes(e,r){return ke.resolve([])}getNextCollectionGroupToUpdate(e){return ke.resolve(null)}getMinOffset(e,r){return ke.resolve(mo.min())}getMinOffsetFromCollectionGroup(e,r){return ke.resolve(mo.min())}updateCollectionGroup(e,r,n){return ke.resolve()}updateIndexEntries(e,r){return ke.resolve()}}class FF{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Qr(ur.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Qr(ur.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ly={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},JE=41943040;class xs{static withCacheSize(e){return new xs(e,xs.DEFAULT_COLLECTION_PERCENTILE,xs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xs.DEFAULT_COLLECTION_PERCENTILE=10,xs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xs.DEFAULT=new xs(JE,xs.DEFAULT_COLLECTION_PERCENTILE,xs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xs.DISABLED=new xs(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ic(0)}static cr(){return new Ic(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My="LruGarbageCollector",RF=1048576;function Vy([t,e],[r,n]){const s=Pt(t,r);return s===0?Pt(e,n):s}class NF{constructor(e){this.Ir=e,this.buffer=new Qr(Vy),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Vy(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class bF{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ye(My,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Vc(r)?Ye(My,"Ignoring IndexedDB error during garbage collection: ",r):await Mc(r)}await this.Vr(3e5)}))}}class DF{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return ke.resolve(ld.ce);const n=new NF(r);return this.mr.forEachTarget(e,(s=>n.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>n.Ar(s))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ye("LruGarbageCollector","Garbage collection skipped; disabled"),ke.resolve(Ly)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ly):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,s,i,o,c,u,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(Ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),s=this.params.maximumSequenceNumbersToCollect):s=g,o=Date.now(),this.nthSequenceNumber(e,s)))).next((g=>(n=g,c=Date.now(),this.removeTargets(e,n,r)))).next((g=>(i=g,u=Date.now(),this.removeOrphanedDocuments(e,n)))).next((g=>(h=Date.now(),lc()<=Dt.DEBUG&&Ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-d}ms`),ke.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:g}))))}}function PF(t,e){return new DF(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OF{constructor(){this.changes=new yl((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Un.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ke.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MF{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,r)))).next((s=>(n!==null&&zu(n.mutation,s,Ls.empty(),pr.now()),s)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Ot()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Ot()){const s=Yo();return this.populateOverlays(e,s,r).next((()=>this.computeViews(e,r,s,n).next((i=>{let o=bu();return i.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,r){const n=Yo();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Ot())))}populateOverlays(e,r,n){const s=[];return n.forEach((i=>{r.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((o,c)=>{r.set(o,c)}))}))}computeViews(e,r,n,s){let i=Ta();const o=ju(),c=(function(){return ju()})();return r.forEach(((u,h)=>{const d=n.get(h.key);s.has(h.key)&&(d===void 0||d.mutation instanceof Ao)?i=i.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),zu(d.mutation,h,d.mutation.getFieldMask(),pr.now())):o.set(h.key,Ls.empty())})),this.recalculateAndSaveOverlays(e,i).next((u=>(u.forEach(((h,d)=>o.set(h,d))),r.forEach(((h,d)=>c.set(h,new LF(d,o.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,r){const n=ju();let s=new Sr(((o,c)=>o-c)),i=Ot();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((o=>{for(const c of o)c.keys().forEach((u=>{const h=r.get(u);if(h===null)return;let d=n.get(u)||Ls.empty();d=c.applyToLocalView(h,d),n.set(u,d);const g=(s.get(c.batchId)||Ot()).add(u);s=s.insert(c.batchId,g)}))})).next((()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,d=u.value,g=PE();d.forEach((x=>{if(!i.has(x)){const _=UE(r.get(x),n.get(x));_!==null&&g.set(x,_),i=i.add(x)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return ke.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,s){return(function(o){return st.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):FE(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next((i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):ke.resolve(Yo());let c=ef,u=i;return o.next((h=>ke.forEach(h,((d,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(d)?ke.resolve():this.remoteDocumentCache.getEntry(e,d).next((x=>{u=u.insert(d,x)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,u,h,Ot()))).next((d=>({batchId:c,changes:DE(d)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new st(r)).next((n=>{let s=bu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let o=bu();return this.indexManager.getCollectionParents(e,i).next((c=>ke.forEach(c,(u=>{const h=(function(g,x){return new Bc(x,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(r,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,n,s).next((d=>{d.forEach(((g,x)=>{o=o.insert(g,x)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s)))).next((o=>{i.forEach(((u,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Un.newInvalidDocument(d)))}));let c=bu();return o.forEach(((u,h)=>{const d=i.get(u);d!==void 0&&zu(d.mutation,h,Ls.empty(),pr.now()),dd(r,h)&&(c=c.insert(u,h))})),c}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return ke.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(s){return{id:s.id,version:s.version,createTime:Hi(s.createTime)}})(r)),ke.resolve()}getNamedQuery(e,r){return ke.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(s){return{name:s.name,query:CF(s.bundledQuery),readTime:Hi(s.readTime)}})(r)),ke.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(){this.overlays=new Sr(st.comparator),this.qr=new Map}getOverlay(e,r){return ke.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Yo();return ke.forEach(r,(s=>this.getOverlay(e,s).next((i=>{i!==null&&n.set(s,i)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((s,i)=>{this.St(e,r,i)})),ke.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(n)),ke.resolve()}getOverlaysForCollection(e,r,n){const s=Yo(),i=r.length+1,o=new st(r.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>n&&s.set(u.getKey(),u)}return ke.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Sr(((h,d)=>h-d));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let d=i.get(h.largestBatchId);d===null&&(d=Yo(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=Yo(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,d)=>c.set(h,d))),!(c.size()>=s)););return ke.resolve(c)}St(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new nF(r,n));let i=this.qr.get(r);i===void 0&&(i=Ot(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(){this.sessionToken=En.EMPTY_BYTE_STRING}getSessionToken(e){return ke.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ke.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(){this.Qr=new Qr(nn.$r),this.Ur=new Qr(nn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new nn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new nn(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new st(new ur([])),n=new nn(r,e),s=new nn(r,e+1),i=[];return this.Ur.forEachInRange([n,s],(o=>{this.Gr(o),i.push(o.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new st(new ur([])),n=new nn(r,e),s=new nn(r,e+1);let i=Ot();return this.Ur.forEachInRange([n,s],(o=>{i=i.add(o.key)})),i}containsKey(e){const r=new nn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class nn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return st.comparator(e.key,r.key)||Pt(e.Yr,r.Yr)}static Kr(e,r){return Pt(e.Yr,r.Yr)||st.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Qr(nn.$r)}checkEmpty(e){return ke.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new rF(i,r,n,s);this.mutationQueue.push(o);for(const c of s)this.Zr=this.Zr.add(new nn(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ke.resolve(o)}lookupMutationBatch(e,r){return ke.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ei(n),i=s<0?0:s;return ke.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ke.resolve(this.mutationQueue.length===0?Hg:this.tr-1)}getAllMutationBatches(e){return ke.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new nn(r,0),s=new nn(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],(o=>{const c=this.Xr(o.Yr);i.push(c)})),ke.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Qr(Pt);return r.forEach((s=>{const i=new nn(s,0),o=new nn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],(c=>{n=n.add(c.Yr)}))})),ke.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;st.isDocumentKey(i)||(i=i.child(""));const o=new nn(new st(i),0);let c=new Qr(Pt);return this.Zr.forEachWhile((u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===s&&(c=c.add(u.Yr)),!0)}),o),ke.resolve(this.ti(c))}ti(e){const r=[];return e.forEach((n=>{const s=this.Xr(n);s!==null&&r.push(s)})),r}removeMutationBatch(e,r){Jt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ke.forEach(r.mutations,(s=>{const i=new nn(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new nn(r,0),s=this.Zr.firstAfterOrEqual(n);return ke.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ke.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e){this.ri=e,this.docs=(function(){return new Sr(st.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,o=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ke.resolve(n?n.document.mutableCopy():Un.newInvalidDocument(r))}getEntries(e,r){let n=Ta();return r.forEach((s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Un.newInvalidDocument(s))})),ke.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=Ta();const o=r.path,c=new st(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:d}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||gI(mI(d),n)<=0||(s.has(d.key)||dd(r,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ke.resolve(i)}getAllFromCollectionGroup(e,r,n,s){dt(9500)}ii(e,r){return ke.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new HF(this)}getSize(e){return ke.resolve(this.size)}}class HF extends OF{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)})),ke.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(e){this.persistence=e,this.si=new yl((r=>Gg(r)),qg),this.lastRemoteSnapshotVersion=vt.min(),this.highestTargetId=0,this.oi=0,this._i=new Jg,this.targetCount=0,this.ai=Ic.ur()}forEachTarget(e,r){return this.si.forEach(((n,s)=>r(s))),ke.resolve()}getLastRemoteSnapshotVersion(e){return ke.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ke.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ke.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),ke.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Ic(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,ke.resolve()}updateTargetData(e,r){return this.Pr(r),ke.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,ke.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),ke.waitFor(i).next((()=>s))}getTargetCount(e){return ke.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return ke.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),ke.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach((o=>{i.push(s.markPotentiallyOrphaned(e,o))})),ke.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),ke.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return ke.resolve(n)}containsKey(e,r){return ke.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e,r){this.ui={},this.overlays={},this.ci=new ld(0),this.li=!1,this.li=!0,this.hi=new UF,this.referenceDelegate=e(this),this.Pi=new WF(this),this.indexManager=new IF,this.remoteDocumentCache=(function(s){return new zF(s)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new AF(r),this.Ii=new VF(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new BF,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new jF(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ye("MemoryPersistence","Starting transaction:",e);const s=new $F(this.ci.next());return this.referenceDelegate.Ei(),n(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,r){return ke.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class $F extends vI{constructor(e){super(),this.currentSequenceNumber=e}}class Zg{constructor(e){this.persistence=e,this.Ri=new Jg,this.Vi=null}static mi(e){return new Zg(e)}get fi(){if(this.Vi)return this.Vi;throw dt(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),ke.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),ke.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),ke.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((s=>this.fi.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ke.forEach(this.fi,(n=>{const s=st.fromPath(n);return this.gi(e,s).next((i=>{i||r.removeEntry(s,vt.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return ke.or([()=>ke.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class P0{constructor(e,r){this.persistence=e,this.pi=new yl((n=>wI(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=PF(this,r)}static mi(e,r){return new P0(e,r)}Ei(){}di(e){return ke.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((s=>n+s))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return ke.forEach(this.pi,((n,s)=>this.br(e,n,s).next((i=>i?ke.resolve():r(s)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(o=>this.br(e,o,r).next((c=>{c||(n++,i.removeEntry(o,vt.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),ke.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),ke.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),ke.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),ke.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=g0(e.data.value)),r}br(e,r,n){return ke.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.pi.get(r);return ke.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=s}static As(e,r){let n=Ot(),s=Ot();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new e1(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GF{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return MC()?8:_I(Wn())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.ys(e,r).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ws(e,r,s,n).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new GF;return this.Ss(e,r,o).next((c=>{if(i.result=c,this.Vs)return this.bs(e,r,o,c.size)}))})).next((()=>i.result))}bs(e,r,n,s){return n.documentReadCount<this.fs?(lc()<=Dt.DEBUG&&Ye("QueryEngine","SDK will not create cache indexes for query:",cc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ke.resolve()):(lc()<=Dt.DEBUG&&Ye("QueryEngine","Query:",cc(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(lc()<=Dt.DEBUG&&Ye("QueryEngine","The SDK decides to create cache indexes for query:",cc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zi(r))):ke.resolve())}ys(e,r){if(Ay(r))return ke.resolve(null);let n=zi(r);return this.indexManager.getIndexType(e,n).next((s=>s===0?null:(r.limit!==null&&s===1&&(r=rg(r,null,"F"),n=zi(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const o=Ot(...i);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,n).next((u=>{const h=this.Ds(r,c);return this.Cs(r,h,o,u.readTime)?this.ys(e,rg(r,null,"F")):this.vs(e,h,r,u)}))))})))))}ws(e,r,n,s){return Ay(r)||s.isEqual(vt.min())?ke.resolve(null):this.ps.getDocuments(e,n).next((i=>{const o=this.Ds(r,i);return this.Cs(r,o,n,s)?ke.resolve(null):(lc()<=Dt.DEBUG&&Ye("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),cc(r)),this.vs(e,o,r,pI(s,ef)).next((c=>c)))}))}Ds(e,r){let n=new Qr(NE(e));return r.forEach(((s,i)=>{dd(e,i)&&(n=n.add(i))})),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,r,n){return lc()<=Dt.DEBUG&&Ye("QueryEngine","Using full collection scan to execute query:",cc(r)),this.ps.getDocumentsMatchingQuery(e,r,mo.min(),n)}vs(e,r,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next((i=>(r.forEach((o=>{i=i.insert(o.key,o)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t1="LocalStore",KF=3e8;class XF{constructor(e,r,n,s){this.persistence=e,this.Fs=r,this.serializer=s,this.Ms=new Sr(Pt),this.xs=new yl((i=>Gg(i)),qg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MF(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function YF(t,e,r,n){return new XF(t,e,r,n)}async function eT(t,e){const r=yt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next((i=>(s=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((i=>{const o=[],c=[];let u=Ot();for(const h of s){o.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}return r.localDocuments.getDocuments(n,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:c})))}))}))}function QF(t,e){const r=yt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,h,d){const g=h.batch,x=g.keys();let _=ke.resolve();return x.forEach((k=>{_=_.next((()=>d.getEntry(u,k))).next((y=>{const S=h.docVersions.get(k);Jt(S!==null,48541),y.version.compareTo(S)<0&&(g.applyToRemoteDocument(y,h),y.isValidDocument()&&(y.setReadTime(h.commitVersion),d.addEntry(y)))}))})),_.next((()=>c.mutationQueue.removeMutationBatch(u,g)))})(r,n,e,i).next((()=>i.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(c){let u=Ot();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u})(e)))).next((()=>r.localDocuments.getDocuments(n,s)))}))}function tT(t){const e=yt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function JF(t,e){const r=yt(t),n=e.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const c=[];e.targetChanges.forEach(((d,g)=>{const x=s.get(g);if(!x)return;c.push(r.Pi.removeMatchingKeys(i,d.removedDocuments,g).next((()=>r.Pi.addMatchingKeys(i,d.addedDocuments,g))));let _=x.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?_=_.withResumeToken(En.EMPTY_BYTE_STRING,vt.min()).withLastLimboFreeSnapshotVersion(vt.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,n)),s=s.insert(g,_),(function(y,S,R){return y.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=KF?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0})(x,_,d)&&c.push(r.Pi.updateTargetData(i,_))}));let u=Ta(),h=Ot();if(e.documentUpdates.forEach((d=>{e.resolvedLimboDocuments.has(d)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(i,d))})),c.push(ZF(i,o,e.documentUpdates).next((d=>{u=d.ks,h=d.qs}))),!n.isEqual(vt.min())){const d=r.Pi.getLastRemoteSnapshotVersion(i).next((g=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n)));c.push(d)}return ke.waitFor(c).next((()=>o.apply(i))).next((()=>r.localDocuments.getLocalViewOfDocuments(i,u,h))).next((()=>u))})).then((i=>(r.Ms=s,i)))}function ZF(t,e,r){let n=Ot(),s=Ot();return r.forEach((i=>n=n.add(i))),e.getEntries(t,n).next((i=>{let o=Ta();return r.forEach(((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(vt.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Ye(t1,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)})),{ks:o,qs:s}}))}function e6(t,e){const r=yt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Hg),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function t6(t,e){const r=yt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return r.Pi.getTargetData(n,e).next((i=>i?(s=i,ke.resolve(s)):r.Pi.allocateTargetId(n).next((o=>(s=new ao(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function og(t,e,r){const n=yt(t),s=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,(o=>n.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!Vc(o))throw o;Ye(t1,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function By(t,e,r){const n=yt(t);let s=vt.min(),i=Ot();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,h,d){const g=yt(u),x=g.xs.get(d);return x!==void 0?ke.resolve(g.Ms.get(x)):g.Pi.getTargetData(h,d)})(n,o,zi(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{i=u}))})).next((()=>n.Fs.getDocumentsMatchingQuery(o,e,r?s:vt.min(),r?i:Ot()))).next((c=>(r6(n,UI(e),c),{documents:c,Qs:i})))))}function r6(t,e,r){let n=t.Os.get(e)||vt.min();r.forEach(((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)})),t.Os.set(e,n)}class Uy{constructor(){this.activeTargetIds=GI()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class n6{constructor(){this.Mo=new Uy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Uy,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy="ConnectivityMonitor";class zy{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ye(jy,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ye(jy,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let t0=null;function lg(){return t0===null?t0=(function(){return 268435456+Math.round(2147483648*Math.random())})():t0++,"0x"+t0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m="RestConnection",i6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class a6{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===F0?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,r,n,s,i){const o=lg(),c=this.zo(e,r.toUriEncodedString());Ye(_m,`Sending RPC '${e}' ${o}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:h}=new URL(c),d=Pc(h);return this.Jo(e,c,u,n,d).then((g=>(Ye(_m,`Received RPC '${e}' ${o}: `,g),g)),(g=>{throw Sc(_m,`RPC '${e}' ${o} failed with error: `,g,"url: ",c,"request:",n),g}))}Ho(e,r,n,s,i,o){return this.Go(e,r,n,s,i)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Lc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((s,i)=>e[i]=s)),n&&n.headers.forEach(((s,i)=>e[i]=s))}zo(e,r){const n=i6[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dn="WebChannelConnection";class l6 extends a6{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,i){const o=lg();return new Promise(((c,u)=>{const h=new sE;h.setWithCredentials(!0),h.listenOnce(iE.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case m0.NO_ERROR:const g=h.getResponseJson();Ye(Dn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),c(g);break;case m0.TIMEOUT:Ye(Dn,`RPC '${e}' ${o} timed out`),u(new Ke(Ee.DEADLINE_EXCEEDED,"Request time out"));break;case m0.HTTP_ERROR:const x=h.getStatus();if(Ye(Dn,`RPC '${e}' ${o} failed with status:`,x,"response text:",h.getResponseText()),x>0){let _=h.getResponseJson();Array.isArray(_)&&(_=_[0]);const k=_==null?void 0:_.error;if(k&&k.status&&k.message){const y=(function(R){const M=R.toLowerCase().replace(/_/g,"-");return Object.values(Ee).indexOf(M)>=0?M:Ee.UNKNOWN})(k.status);u(new Ke(y,k.message))}else u(new Ke(Ee.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Ke(Ee.UNAVAILABLE,"Connection failed."));break;default:dt(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Ye(Dn,`RPC '${e}' ${o} completed.`)}}));const d=JSON.stringify(s);Ye(Dn,`RPC '${e}' ${o} sending request:`,s),h.send(r,"POST",d,n,15)}))}T_(e,r,n){const s=lg(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=lE(),c=oE(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const d=i.join("");Ye(Dn,`Creating RPC '${e}' stream ${s}: ${d}`,u);const g=o.createWebChannel(d,u);this.I_(g);let x=!1,_=!1;const k=new o6({Yo:S=>{_?Ye(Dn,`Not sending because RPC '${e}' stream ${s} is closed:`,S):(x||(Ye(Dn,`Opening RPC '${e}' stream ${s} transport.`),g.open(),x=!0),Ye(Dn,`RPC '${e}' stream ${s} sending:`,S),g.send(S))},Zo:()=>g.close()}),y=(S,R,M)=>{S.listen(R,(N=>{try{M(N)}catch(V){setTimeout((()=>{throw V}),0)}}))};return y(g,Nu.EventType.OPEN,(()=>{_||(Ye(Dn,`RPC '${e}' stream ${s} transport opened.`),k.o_())})),y(g,Nu.EventType.CLOSE,(()=>{_||(_=!0,Ye(Dn,`RPC '${e}' stream ${s} transport closed`),k.a_(),this.E_(g))})),y(g,Nu.EventType.ERROR,(S=>{_||(_=!0,Sc(Dn,`RPC '${e}' stream ${s} transport errored. Name:`,S.name,"Message:",S.message),k.a_(new Ke(Ee.UNAVAILABLE,"The operation could not be completed")))})),y(g,Nu.EventType.MESSAGE,(S=>{var R;if(!_){const M=S.data[0];Jt(!!M,16349);const N=M,V=(N==null?void 0:N.error)||((R=N[0])==null?void 0:R.error);if(V){Ye(Dn,`RPC '${e}' stream ${s} received error:`,V);const W=V.status;let j=(function(I){const U=Ur[I];if(U!==void 0)return zE(U)})(W),A=V.message;j===void 0&&(j=Ee.INTERNAL,A="Unknown error status: "+W+" with message "+V.message),_=!0,k.a_(new Ke(j,A)),g.close()}else Ye(Dn,`RPC '${e}' stream ${s} received:`,M),k.u_(M)}})),y(c,aE.STAT_EVENT,(S=>{S.stat===Xm.PROXY?Ye(Dn,`RPC '${e}' stream ${s} detected buffering proxy`):S.stat===Xm.NOPROXY&&Ye(Dn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{k.__()}),0),k}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function ym(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(t){return new hF(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(e,r,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&Ye("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="PersistentStream";class nT{constructor(e,r,n,s,i,o,c,u){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new rT(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Ee.RESOURCE_EXHAUSTED?(Ea(r.toString()),Ea("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===r&&this.G_(n,s)}),(n=>{e((()=>{const s=new Ke(Ee.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ye(Hy,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(Ye(Hy,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class c6 extends nT{constructor(e,r,n,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=mF(this.serializer,e),n=(function(i){if(!("targetChange"in i))return vt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?vt.min():o.readTime?Hi(o.readTime):vt.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=ag(this.serializer),r.addTarget=(function(i,o){let c;const u=o.target;if(c=eg(u)?{documents:vF(i,u)}:{query:_F(i,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=$E(i,o.resumeToken);const h=ng(i,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(vt.min())>0){c.readTime=D0(i,o.snapshotVersion.toTimestamp());const h=ng(i,o.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const n=wF(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=ag(this.serializer),r.removeTarget=e,this.q_(r)}}class u6 extends nT{constructor(e,r,n,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Jt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Jt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Jt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=xF(e.writeResults,e.commitTime),n=Hi(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=ag(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>gF(this.serializer,n)))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{}class h6 extends f6{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Ke(Ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Go(e,sg(r,n),s,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ke(Ee.UNKNOWN,i.toString())}))}Ho(e,r,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,sg(r,n),s,o,c,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ke(Ee.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class d6{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ea(r),this.aa=!1):Ye("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fl="RemoteStore";class p6{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((o=>{n.enqueueAndForget((async()=>{wl(this)&&(Ye(fl,"Restarting streams for network reachability change."),await(async function(u){const h=yt(u);h.Ea.add(4),await Rf(h),h.Ra.set("Unknown"),h.Ea.delete(4),await _d(h)})(this))}))})),this.Ra=new d6(n,s)}}async function _d(t){if(wl(t))for(const e of t.da)await e(!0)}async function Rf(t){for(const e of t.da)await e(!1)}function sT(t,e){const r=yt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),i1(r)?s1(r):Uc(r).O_()&&n1(r,e))}function r1(t,e){const r=yt(t),n=Uc(r);r.Ia.delete(e),n.O_()&&iT(r,e),r.Ia.size===0&&(n.O_()?n.L_():wl(r)&&r.Ra.set("Unknown"))}function n1(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(vt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Uc(t).Y_(e)}function iT(t,e){t.Va.Ue(e),Uc(t).Z_(e)}function s1(t){t.Va=new lF({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Uc(t).start(),t.Ra.ua()}function i1(t){return wl(t)&&!Uc(t).x_()&&t.Ia.size>0}function wl(t){return yt(t).Ea.size===0}function aT(t){t.Va=void 0}async function m6(t){t.Ra.set("Online")}async function g6(t){t.Ia.forEach(((e,r)=>{n1(t,e)}))}async function x6(t,e){aT(t),i1(t)?(t.Ra.ha(e),s1(t)):t.Ra.set("Unknown")}async function v6(t,e,r){if(t.Ra.set("Online"),e instanceof WE&&e.state===2&&e.cause)try{await(async function(s,i){const o=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.Va.removeTarget(c))})(t,e)}catch(n){Ye(fl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await O0(t,n)}else if(e instanceof _0?t.Va.Ze(e):e instanceof HE?t.Va.st(e):t.Va.tt(e),!r.isEqual(vt.min()))try{const n=await tT(t.localStore);r.compareTo(n)>=0&&await(function(i,o){const c=i.Va.Tt(o);return c.targetChanges.forEach(((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,h)=>{const d=i.Ia.get(u);if(!d)return;i.Ia.set(u,d.withResumeToken(En.EMPTY_BYTE_STRING,d.snapshotVersion)),iT(i,u);const g=new ao(d.target,u,h,d.sequenceNumber);n1(i,g)})),i.remoteSyncer.applyRemoteEvent(c)})(t,r)}catch(n){Ye(fl,"Failed to raise snapshot:",n),await O0(t,n)}}async function O0(t,e,r){if(!Vc(e))throw e;t.Ea.add(1),await Rf(t),t.Ra.set("Offline"),r||(r=()=>tT(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ye(fl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await _d(t)}))}function oT(t,e){return e().catch((r=>O0(t,r,e)))}async function yd(t){const e=yt(t),r=_o(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Hg;for(;_6(e);)try{const s=await e6(e.localStore,n);if(s===null){e.Ta.length===0&&r.L_();break}n=s.batchId,y6(e,s)}catch(s){await O0(e,s)}lT(e)&&cT(e)}function _6(t){return wl(t)&&t.Ta.length<10}function y6(t,e){t.Ta.push(e);const r=_o(t);r.O_()&&r.X_&&r.ea(e.mutations)}function lT(t){return wl(t)&&!_o(t).x_()&&t.Ta.length>0}function cT(t){_o(t).start()}async function w6(t){_o(t).ra()}async function E6(t){const e=_o(t);for(const r of t.Ta)e.ea(r.mutations)}async function T6(t,e,r){const n=t.Ta.shift(),s=Xg.from(n,e,r);await oT(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await yd(t)}async function S6(t,e){e&&_o(t).X_&&await(async function(n,s){if((function(o){return iF(o)&&o!==Ee.ABORTED})(s.code)){const i=n.Ta.shift();_o(n).B_(),await oT(n,(()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s))),await yd(n)}})(t,e),lT(t)&&cT(t)}async function Wy(t,e){const r=yt(t);r.asyncQueue.verifyOperationInProgress(),Ye(fl,"RemoteStore received new credentials");const n=wl(r);r.Ea.add(3),await Rf(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await _d(r)}async function k6(t,e){const r=yt(t);e?(r.Ea.delete(2),await _d(r)):e||(r.Ea.add(2),await Rf(r),r.Ra.set("Unknown"))}function Uc(t){return t.ma||(t.ma=(function(r,n,s){const i=yt(r);return i.sa(),new c6(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(t.datastore,t.asyncQueue,{Xo:m6.bind(null,t),t_:g6.bind(null,t),r_:x6.bind(null,t),H_:v6.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),i1(t)?s1(t):t.Ra.set("Unknown")):(await t.ma.stop(),aT(t))}))),t.ma}function _o(t){return t.fa||(t.fa=(function(r,n,s){const i=yt(r);return i.sa(),new u6(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:w6.bind(null,t),r_:S6.bind(null,t),ta:E6.bind(null,t),na:T6.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await yd(t)):(await t.fa.stop(),t.Ta.length>0&&(Ye(fl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new ga,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const o=Date.now()+n,c=new a1(e,r,o,s,i);return c.start(n),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ke(Ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function o1(t,e){if(Ea("AsyncQueue",`${e}: ${t}`),Vc(t))return new Ke(Ee.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{static emptySet(e){return new mc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||st.comparator(r.key,n.key):(r,n)=>st.comparator(r.key,n.key),this.keyedMap=bu(),this.sortedSet=new Sr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof mc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new mc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(){this.ga=new Sr(st.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):dt(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class Fc{constructor(e,r,n,s,i,o,c,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,s,i){const o=[];return r.forEach((c=>{o.push({type:0,doc:c})})),new Fc(e,r,mc.emptySet(r),o,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class C6{constructor(){this.queries=Gy(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=yt(r),i=s.queries;s.queries=Gy(),i.forEach(((o,c)=>{for(const u of c.Sa)u.onError(n)}))})(this,new Ke(Ee.ABORTED,"Firestore shutting down"))}}function Gy(){return new yl((t=>RE(t)),hd)}async function l1(t,e){const r=yt(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new A6,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(s,!0);break;case 1:i.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const c=o1(o,`Initialization of query '${cc(e.query)}' failed`);return void e.onError(c)}r.queries.set(s,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&u1(r)}async function c1(t,e){const r=yt(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function I6(t,e){const r=yt(t);let n=!1;for(const s of e){const i=s.query,o=r.queries.get(i);if(o){for(const c of o.Sa)c.Fa(s)&&(n=!0);o.wa=s}}n&&u1(r)}function F6(t,e,r){const n=yt(t),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(r);n.queries.delete(e)}function u1(t){t.Ca.forEach((e=>{e.next()}))}var cg,qy;(qy=cg||(cg={})).Ma="default",qy.Cache="cache";class f1{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Fc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Fc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==cg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e){this.key=e}}class fT{constructor(e){this.key=e}}class R6{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ot(),this.mutatedKeys=Ot(),this.eu=NE(e),this.tu=new mc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new $y,s=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((d,g)=>{const x=s.get(d),_=dd(this.query,g)?g:null,k=!!x&&this.mutatedKeys.has(x.key),y=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let S=!1;x&&_?x.data.isEqual(_.data)?k!==y&&(n.track({type:3,doc:_}),S=!0):this.su(x,_)||(n.track({type:2,doc:_}),S=!0,(u&&this.eu(_,u)>0||h&&this.eu(_,h)<0)&&(c=!0)):!x&&_?(n.track({type:0,doc:_}),S=!0):x&&!_&&(n.track({type:1,doc:x}),S=!0,(u||h)&&(c=!0)),S&&(_?(o=o.add(_),i=y?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),n.track({type:1,doc:d})}return{tu:o,iu:n,Cs:c,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((d,g)=>(function(_,k){const y=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dt(20277,{Rt:S})}};return y(_)-y(k)})(d.type,g.type)||this.eu(d.doc,g.doc))),this.ou(n),s=s??!1;const c=r&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,h=u!==this.Za;return this.Za=u,o.length!==0||h?{snapshot:new Fc(this.query,e.tu,i,o,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new $y,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ot(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new fT(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new uT(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=Ot();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Fc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const h1="SyncEngine";class N6{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class b6{constructor(e){this.key=e,this.hu=!1}}class D6{constructor(e,r,n,s,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new yl((c=>RE(c)),hd),this.Iu=new Map,this.Eu=new Set,this.du=new Sr(st.comparator),this.Au=new Map,this.Ru=new Jg,this.Vu={},this.mu=new Map,this.fu=Ic.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function P6(t,e,r=!0){const n=xT(t);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await hT(n,e,r,!0),s}async function O6(t,e){const r=xT(t);await hT(r,e,!0,!1)}async function hT(t,e,r,n){const s=await t6(t.localStore,zi(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let c;return n&&(c=await L6(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&sT(t.remoteStore,s),c}async function L6(t,e,r,n,s){t.pu=(g,x,_)=>(async function(y,S,R,M){let N=S.view.ru(R);N.Cs&&(N=await By(y.localStore,S.query,!1).then((({documents:A})=>S.view.ru(A,N))));const V=M&&M.targetChanges.get(S.targetId),W=M&&M.targetMismatches.get(S.targetId)!=null,j=S.view.applyChanges(N,y.isPrimaryClient,V,W);return Xy(y,S.targetId,j.au),j.snapshot})(t,g,x,_);const i=await By(t.localStore,e,!0),o=new R6(e,i.Qs),c=o.ru(i.documents),u=Ff.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),h=o.applyChanges(c,t.isPrimaryClient,u);Xy(t,r,h.au);const d=new N6(e,r,o);return t.Tu.set(e,d),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function M6(t,e,r){const n=yt(t),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter((o=>!hd(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await og(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),r&&r1(n.remoteStore,s.targetId),ug(n,s.targetId)})).catch(Mc)):(ug(n,s.targetId),await og(n.localStore,s.targetId,!0))}async function V6(t,e){const r=yt(t),n=r.Tu.get(e),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),r1(r.remoteStore,n.targetId))}async function B6(t,e,r){const n=G6(t);try{const s=await(function(o,c){const u=yt(o),h=pr.now(),d=c.reduce(((_,k)=>_.add(k.key)),Ot());let g,x;return u.persistence.runTransaction("Locally write mutations","readwrite",(_=>{let k=Ta(),y=Ot();return u.Ns.getEntries(_,d).next((S=>{k=S,k.forEach(((R,M)=>{M.isValidDocument()||(y=y.add(R))}))})).next((()=>u.localDocuments.getOverlayedDocuments(_,k))).next((S=>{g=S;const R=[];for(const M of c){const N=eF(M,g.get(M.key).overlayedDocument);N!=null&&R.push(new Ao(M.key,N,EE(N.value.mapValue),ss.exists(!0)))}return u.mutationQueue.addMutationBatch(_,h,R,c)})).next((S=>{x=S;const R=S.applyToLocalDocumentSet(g,y);return u.documentOverlayCache.saveOverlays(_,S.batchId,R)}))})).then((()=>({batchId:x.batchId,changes:DE(g)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),(function(o,c,u){let h=o.Vu[o.currentUser.toKey()];h||(h=new Sr(Pt)),h=h.insert(c,u),o.Vu[o.currentUser.toKey()]=h})(n,s.batchId,r),await Nf(n,s.changes),await yd(n.remoteStore)}catch(s){const i=o1(s,"Failed to persist write");r.reject(i)}}async function dT(t,e){const r=yt(t);try{const n=await JF(r.localStore,e);e.targetChanges.forEach(((s,i)=>{const o=r.Au.get(i);o&&(Jt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Jt(o.hu,14607):s.removedDocuments.size>0&&(Jt(o.hu,42227),o.hu=!1))})),await Nf(r,n,e)}catch(n){await Mc(n)}}function Ky(t,e,r){const n=yt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach(((i,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(o,c){const u=yt(o);u.onlineState=c;let h=!1;u.queries.forEach(((d,g)=>{for(const x of g.Sa)x.va(c)&&(h=!0)})),h&&u1(u)})(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function U6(t,e,r){const n=yt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Au.get(e),i=s&&s.key;if(i){let o=new Sr(st.comparator);o=o.insert(i,Un.newNoDocument(i,vt.min()));const c=Ot().add(i),u=new xd(vt.min(),new Map,new Sr(Pt),o,c);await dT(n,u),n.du=n.du.remove(i),n.Au.delete(e),d1(n)}else await og(n.localStore,e,!1).then((()=>ug(n,e,r))).catch(Mc)}async function j6(t,e){const r=yt(t),n=e.batch.batchId;try{const s=await QF(r.localStore,e);mT(r,n,null),pT(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Nf(r,s)}catch(s){await Mc(s)}}async function z6(t,e,r){const n=yt(t);try{const s=await(function(o,c){const u=yt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return u.mutationQueue.lookupMutationBatch(h,c).next((g=>(Jt(g!==null,37113),d=g.keys(),u.mutationQueue.removeMutationBatch(h,g)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,d,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>u.localDocuments.getDocuments(h,d)))}))})(n.localStore,e);mT(n,e,r),pT(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Nf(n,s)}catch(s){await Mc(s)}}function pT(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function mT(t,e,r){const n=yt(t);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function ug(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||gT(t,n)}))}function gT(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(r1(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),d1(t))}function Xy(t,e,r){for(const n of r)n instanceof uT?(t.Ru.addReference(n.key,e),H6(t,n)):n instanceof fT?(Ye(h1,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||gT(t,n.key)):dt(19791,{wu:n})}function H6(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ye(h1,"New document in limbo: "+r),t.Eu.add(n),d1(t))}function d1(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new st(ur.fromString(e)),n=t.fu.next();t.Au.set(n,new b6(r)),t.du=t.du.insert(r,n),sT(t.remoteStore,new ao(zi(fd(r.path)),n,"TargetPurposeLimboResolution",ld.ce))}}async function Nf(t,e,r){const n=yt(t),s=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((c,u)=>{o.push(n.pu(u,e,r).then((h=>{var d;if((h||r)&&n.isPrimaryClient){const g=h?!h.fromCache:(d=r==null?void 0:r.targetChanges.get(u.targetId))==null?void 0:d.current;n.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){s.push(h);const g=e1.As(u.targetId,h);i.push(g)}})))})),await Promise.all(o),n.Pu.H_(s),await(async function(u,h){const d=yt(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>ke.forEach(h,(x=>ke.forEach(x.Es,(_=>d.persistence.referenceDelegate.addReference(g,x.targetId,_))).next((()=>ke.forEach(x.ds,(_=>d.persistence.referenceDelegate.removeReference(g,x.targetId,_)))))))))}catch(g){if(!Vc(g))throw g;Ye(t1,"Failed to update sequence numbers: "+g)}for(const g of h){const x=g.targetId;if(!g.fromCache){const _=d.Ms.get(x),k=_.snapshotVersion,y=_.withLastLimboFreeSnapshotVersion(k);d.Ms=d.Ms.insert(x,y)}}})(n.localStore,i))}async function W6(t,e){const r=yt(t);if(!r.currentUser.isEqual(e)){Ye(h1,"User change. New user:",e.toKey());const n=await eT(r.localStore,e);r.currentUser=e,(function(i,o){i.mu.forEach((c=>{c.forEach((u=>{u.reject(new Ke(Ee.CANCELLED,o))}))})),i.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Nf(r,n.Ls)}}function $6(t,e){const r=yt(t),n=r.Au.get(e);if(n&&n.hu)return Ot().add(n.key);{let s=Ot();const i=r.Iu.get(e);if(!i)return s;for(const o of i){const c=r.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function xT(t){const e=yt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=dT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=U6.bind(null,e),e.Pu.H_=I6.bind(null,e.eventManager),e.Pu.yu=F6.bind(null,e.eventManager),e}function G6(t){const e=yt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=j6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=z6.bind(null,e),e}class L0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return YF(this.persistence,new qF,e.initialUser,this.serializer)}Cu(e){return new ZE(Zg.mi,this.serializer)}Du(e){return new n6}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}L0.provider={build:()=>new L0};class q6 extends L0{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Jt(this.persistence.referenceDelegate instanceof P0,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new bF(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?xs.withCacheSize(this.cacheSizeBytes):xs.DEFAULT;return new ZE((n=>P0.mi(n,r)),this.serializer)}}class fg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Ky(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=W6.bind(null,this.syncEngine),await k6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new C6})()}createDatastore(e){const r=vd(e.databaseInfo.databaseId),n=(function(i){return new l6(i)})(e.databaseInfo);return(function(i,o,c,u){return new h6(i,o,c,u)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,s,i,o,c){return new p6(n,s,i,o,c)})(this.localStore,this.datastore,e.asyncQueue,(r=>Ky(this.syncEngine,r,0)),(function(){return zy.v()?new zy:new s6})())}createSyncEngine(e,r){return(function(s,i,o,c,u,h,d){const g=new D6(s,i,o,c,u,h);return d&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await(async function(s){const i=yt(s);Ye(fl,"RemoteStore shutting down."),i.Ea.add(5),await Rf(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}fg.provider={build:()=>new fg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ea("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo="FirestoreClient";class K6{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Ln.UNAUTHENTICATED,this.clientId=zg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async o=>{Ye(yo,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(Ye(yo,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ga;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=o1(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function wm(t,e){t.asyncQueue.verifyOperationInProgress(),Ye(yo,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async s=>{n.isEqual(s)||(await eT(e.localStore,s),n=s)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Yy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await X6(t);Ye(yo,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>Wy(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,s)=>Wy(e.remoteStore,s))),t._onlineComponents=e}async function X6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ye(yo,"Using user provided OfflineComponentProvider");try{await wm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(s){return s.name==="FirebaseError"?s.code===Ee.FAILED_PRECONDITION||s.code===Ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(r))throw r;Sc("Error using user provided cache. Falling back to memory cache: "+r),await wm(t,new L0)}}else Ye(yo,"Using default OfflineComponentProvider"),await wm(t,new q6(void 0));return t._offlineComponents}async function vT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ye(yo,"Using user provided OnlineComponentProvider"),await Yy(t,t._uninitializedComponentsProvider._online)):(Ye(yo,"Using default OnlineComponentProvider"),await Yy(t,new fg))),t._onlineComponents}function Y6(t){return vT(t).then((e=>e.syncEngine))}async function M0(t){const e=await vT(t),r=e.eventManager;return r.onListen=P6.bind(null,e.syncEngine),r.onUnlisten=M6.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=O6.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=V6.bind(null,e.syncEngine),r}function Q6(t,e,r={}){const n=new ga;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,c,u,h){const d=new p1({next:x=>{d.Nu(),o.enqueueAndForget((()=>c1(i,g)));const _=x.docs.has(c);!_&&x.fromCache?h.reject(new Ke(Ee.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&x.fromCache&&u&&u.source==="server"?h.reject(new Ke(Ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(x)},error:x=>h.reject(x)}),g=new f1(fd(c.path),d,{includeMetadataChanges:!0,qa:!0});return l1(i,g)})(await M0(t),t.asyncQueue,e,r,n))),n.promise}function J6(t,e,r={}){const n=new ga;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,c,u,h){const d=new p1({next:x=>{d.Nu(),o.enqueueAndForget((()=>c1(i,g))),x.fromCache&&u.source==="server"?h.reject(new Ke(Ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(x)},error:x=>h.reject(x)}),g=new f1(c,d,{includeMetadataChanges:!0,qa:!0});return l1(i,g)})(await M0(t),t.asyncQueue,e,r,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT="firestore.googleapis.com",Jy=!0;class Zy{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ke(Ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yT,this.ssl=Jy}else this.host=e.host,this.ssl=e.ssl??Jy;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=JE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<RF)throw new Ke(Ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_T(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ke(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ke(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ke(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wd{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Zy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ke(Ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ke(Ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Zy(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new nI;switch(n.type){case"firstParty":return new oI(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ke(Ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=Qy.get(r);n&&(Ye("ComponentProvider","Removing Datastore"),Qy.delete(r),n.terminate())})(this),Promise.resolve()}}function Z6(t,e,r,n={}){var h;t=ns(t,wd);const s=Pc(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${r}`;s&&(Xw(`https://${c}`),Yw("Firestore",!0)),i.host!==yT&&i.host!==c&&Sc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:c,ssl:s,emulatorOptions:n};if(!ll(u,o)&&(t._setSettings(u),n.mockUserToken)){let d,g;if(typeof n.mockUserToken=="string")d=n.mockUserToken,g=Ln.MOCK_USER;else{d=IC(n.mockUserToken,(h=t._app)==null?void 0:h.options.projectId);const x=n.mockUserToken.sub||n.mockUserToken.user_id;if(!x)throw new Ke(Ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new Ln(x)}t._authCredentials=new sI(new uE(d,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Co(this.firestore,e,this._query)}}class Cr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new po(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Cr(this.firestore,e,this._key)}toJSON(){return{type:Cr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Cf(r,Cr._jsonSchema))return new Cr(e,n||null,new st(ur.fromString(r.referencePath)))}}Cr._jsonSchemaVersion="firestore/documentReference/1.0",Cr._jsonSchema={type:Wr("string",Cr._jsonSchemaVersion),referencePath:Wr("string")};class po extends Co{constructor(e,r,n){super(e,r,fd(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Cr(this.firestore,null,new st(e))}withConverter(e){return new po(this.firestore,e,this._path)}}function xa(t,e,...r){if(t=$r(t),fE("collection","path",e),t instanceof wd){const n=ur.fromString(e,...r);return hy(n),new po(t,null,n)}{if(!(t instanceof Cr||t instanceof po))throw new Ke(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ur.fromString(e,...r));return hy(n),new po(t.firestore,null,n)}}function sr(t,e,...r){if(t=$r(t),arguments.length===1&&(e=zg.newId()),fE("doc","path",e),t instanceof wd){const n=ur.fromString(e,...r);return fy(n),new Cr(t,null,new st(n))}{if(!(t instanceof Cr||t instanceof po))throw new Ke(Ee.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ur.fromString(e,...r));return fy(n),new Cr(t.firestore,t instanceof po?t.converter:null,new st(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e2="AsyncQueue";class t2{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new rT(this,"async_queue_retry"),this._c=()=>{const n=ym();n&&Ye(e2,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=ym();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=ym();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new ga;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Vc(e))throw e;Ye(e2,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Ea("INTERNAL UNHANDLED ERROR: ",r2(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const s=a1.createAndSchedule(this,e,r,n,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&dt(47125,{Pc:r2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function r2(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n2(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1})(t,["next","error","complete"])}class Ki extends wd{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new t2,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new t2(e),this._firestoreClient=void 0,await e}}}function eR(t,e){const r=typeof t=="object"?t:eE(),n=typeof t=="string"?t:F0,s=Ug(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=AC("firestore");i&&Z6(s,...i)}return s}function bf(t){if(t._terminated)throw new Ke(Ee.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||tR(t),t._firestoreClient}function tR(t){var n,s,i;const e=t._freezeSettings(),r=(function(c,u,h,d){return new SI(c,u,h,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,_T(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)})(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new K6(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}})(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zs(En.fromBase64String(e))}catch(r){throw new Ke(Ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Zs(En.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Zs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Cf(e,Zs._jsonSchema))return Zs.fromBase64String(e.bytes)}}Zs._jsonSchemaVersion="firestore/bytes/1.0",Zs._jsonSchema={type:Wr("string",Zs._jsonSchemaVersion),bytes:Wr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ke(Ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _n(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ke(Ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ke(Ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Pt(this._lat,e._lat)||Pt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Wi._jsonSchemaVersion}}static fromJSON(e){if(Cf(e,Wi._jsonSchema))return new Wi(e.latitude,e.longitude)}}Wi._jsonSchemaVersion="firestore/geoPoint/1.0",Wi._jsonSchema={type:Wr("string",Wi._jsonSchemaVersion),latitude:Wr("number"),longitude:Wr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:$i._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Cf(e,$i._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new $i(e.vectorValues);throw new Ke(Ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$i._jsonSchemaVersion="firestore/vectorValue/1.0",$i._jsonSchema={type:Wr("string",$i._jsonSchemaVersion),vectorValues:Wr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=/^__.*__$/;class nR{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Ao(e,this.data,this.fieldMask,r,this.fieldTransforms):new If(e,this.data,r,this.fieldTransforms)}}class wT{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Ao(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function ET(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dt(40011,{Ac:t})}}class m1{constructor(e,r,n,s,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new m1({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var s;const r=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return V0(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(ET(this.Ac)&&rR.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class sR{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||vd(e)}Cc(e,r,n,s=!1){return new m1({Ac:e,methodName:r,Dc:n,path:_n.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pf(t){const e=t._freezeSettings(),r=vd(t._databaseId);return new sR(t._databaseId,!!e.ignoreUndefinedProperties,r)}function g1(t,e,r,n,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,r,s);v1("Data must be an object, but it was:",o,n);const c=kT(n,o);let u,h;if(i.merge)u=new Ls(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const g of i.mergeFields){const x=hg(e,g,r);if(!o.contains(x))throw new Ke(Ee.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);CT(d,x)||d.push(x)}u=new Ls(d),h=o.fieldTransforms.filter((g=>u.covers(g.field)))}else u=null,h=o.fieldTransforms;return new nR(new vs(c),u,h)}class Td extends Ed{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Td}}class x1 extends Ed{_toFieldTransform(e){return new YI(e.path,new af)}isEqual(e){return e instanceof x1}}function TT(t,e,r,n){const s=t.Cc(1,e,r);v1("Data must be an object, but it was:",s,n);const i=[],o=vs.empty();ko(n,((u,h)=>{const d=_1(e,u,r);h=$r(h);const g=s.yc(d);if(h instanceof Td)i.push(d);else{const x=Of(h,g);x!=null&&(i.push(d),o.set(d,x))}}));const c=new Ls(i);return new wT(o,c,s.fieldTransforms)}function ST(t,e,r,n,s,i){const o=t.Cc(1,e,r),c=[hg(e,n,r)],u=[s];if(i.length%2!=0)throw new Ke(Ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<i.length;x+=2)c.push(hg(e,i[x])),u.push(i[x+1]);const h=[],d=vs.empty();for(let x=c.length-1;x>=0;--x)if(!CT(h,c[x])){const _=c[x];let k=u[x];k=$r(k);const y=o.yc(_);if(k instanceof Td)h.push(_);else{const S=Of(k,y);S!=null&&(h.push(_),d.set(_,S))}}const g=new Ls(h);return new wT(d,g,o.fieldTransforms)}function iR(t,e,r,n=!1){return Of(r,t.Cc(n?4:3,e))}function Of(t,e){if(AT(t=$r(t)))return v1("Unsupported field value:",e,t),kT(t,e);if(t instanceof Ed)return(function(n,s){if(!ET(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,s){const i=[];let o=0;for(const c of n){let u=Of(c,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}})(t,e)}return(function(n,s){if((n=$r(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return qI(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=pr.fromDate(n);return{timestampValue:D0(s.serializer,i)}}if(n instanceof pr){const i=new pr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:D0(s.serializer,i)}}if(n instanceof Wi)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Zs)return{bytesValue:$E(s.serializer,n._byteString)};if(n instanceof Cr){const i=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Qg(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof $i)return(function(o,c){return{mapValue:{fields:{[yE]:{stringValue:wE},[R0]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Kg(c.serializer,h)}))}}}}}})(n,s);throw s.Sc(`Unsupported field value: ${od(n)}`)})(t,e)}function kT(t,e){const r={};return pE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ko(t,((n,s)=>{const i=Of(s,e.mc(n));i!=null&&(r[n]=i)})),{mapValue:{fields:r}}}function AT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof pr||t instanceof Wi||t instanceof Zs||t instanceof Cr||t instanceof Ed||t instanceof $i)}function v1(t,e,r){if(!AT(r)||!hE(r)){const n=od(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function hg(t,e,r){if((e=$r(e))instanceof Df)return e._internalPath;if(typeof e=="string")return _1(t,e);throw V0("Field path arguments must be of type string or ",t,!1,void 0,r)}const aR=new RegExp("[~\\*/\\[\\]]");function _1(t,e,r){if(e.search(aR)>=0)throw V0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Df(...e.split("."))._internalPath}catch{throw V0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function V0(t,e,r,n,s){const i=n&&!n.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${n}`),o&&(u+=` in document ${s}`),u+=")"),new Ke(Ee.INVALID_ARGUMENT,c+t+u)}function CT(t,e){return t.some((r=>r.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Cr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(y1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class oR extends IT{data(){return super.data()}}function y1(t,e){return typeof e=="string"?_1(t,e):e instanceof Df?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ke(Ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class w1{}class RT extends w1{}function lR(t,e,...r){let n=[];e instanceof w1&&n.push(e),n=n.concat(r),(function(i){const o=i.filter((u=>u instanceof T1)).length,c=i.filter((u=>u instanceof E1)).length;if(o>1||o>0&&c>0)throw new Ke(Ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const s of n)t=s._apply(t);return t}class E1 extends RT{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new E1(e,r,n)}_apply(e){const r=this._parse(e);return NT(e._query,r),new Co(e.firestore,e.converter,tg(e._query,r))}_parse(e){const r=Pf(e.firestore);return(function(i,o,c,u,h,d,g){let x;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Ke(Ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){i2(g,d);const k=[];for(const y of g)k.push(s2(u,i,y));x={arrayValue:{values:k}}}else x=s2(u,i,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||i2(g,d),x=iR(c,o,g,d==="in"||d==="not-in");return Hr.create(h,d,x)})(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class T1 extends w1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new T1(e,r)}_parse(e){const r=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return r.length===1?r[0]:yi.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:((function(s,i){let o=s;const c=i.getFlattenedFilters();for(const u of c)NT(o,u),o=tg(o,u)})(e._query,r),new Co(e.firestore,e.converter,tg(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class S1 extends RT{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new S1(e,r)}_apply(e){const r=(function(s,i,o){if(s.startAt!==null)throw new Ke(Ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Ke(Ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new sf(i,o)})(e._query,this._field,this._direction);return new Co(e.firestore,e.converter,(function(s,i){const o=s.explicitOrderBy.concat([i]);return new Bc(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,r))}}function cR(t,e="asc"){const r=e,n=y1("orderBy",t);return S1._create(n,r)}function s2(t,e,r){if(typeof(r=$r(r))=="string"){if(r==="")throw new Ke(Ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!FE(e)&&r.indexOf("/")!==-1)throw new Ke(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(ur.fromString(r));if(!st.isDocumentKey(n))throw new Ke(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return yy(t,new st(n))}if(r instanceof Cr)return yy(t,r._key);throw new Ke(Ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${od(r)}.`)}function i2(t,e){if(!Array.isArray(t)||t.length===0)throw new Ke(Ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function NT(t,e){const r=(function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null})(t.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(r!==null)throw r===e.op?new Ke(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ke(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class uR{convertValue(e,r="none"){switch(vo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(xo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw dt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ko(e,((s,i)=>{n[s]=this.convertValue(i,r)})),n}convertVectorValue(e){var n,s,i;const r=(i=(s=(n=e.fields)==null?void 0:n[R0].arrayValue)==null?void 0:s.values)==null?void 0:i.map((o=>Pr(o.doubleValue)));return new $i(r)}convertGeoPoint(e){return new Wi(Pr(e.latitude),Pr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=ud(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(tf(e));default:return null}}convertTimestamp(e){const r=go(e);return new pr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=ur.fromString(e);Jt(QE(n),9688,{name:e});const s=new rf(n.get(1),n.get(3)),i=new st(n.popFirst(5));return s.isEqual(r)||Ea(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k1(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Pu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Zo extends IT{constructor(e,r,n,s,i,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new y0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(y1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ke(Ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Zo._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Zo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Zo._jsonSchema={type:Wr("string",Zo._jsonSchemaVersion),bundleSource:Wr("string","DocumentSnapshot"),bundleName:Wr("string"),bundle:Wr("string")};class y0 extends Zo{data(e={}){return super.data(e)}}class el{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Pu(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new y0(this._firestore,this._userDataWriter,n.key,n,new Pu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ke(Ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((c=>{const u=new y0(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Pu(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const u=new y0(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Pu(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,d=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),d=o.indexOf(c.doc.key)),{type:fR(c.type),doc:u,oldIndex:h,newIndex:d}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ke(Ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=el._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=zg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function fR(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dt(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bi(t){t=ns(t,Cr);const e=ns(t.firestore,Ki);return Q6(bf(e),t._key).then((r=>bT(e,t,r)))}el._jsonSchemaVersion="firestore/querySnapshot/1.0",el._jsonSchema={type:Wr("string",el._jsonSchemaVersion),bundleSource:Wr("string","QuerySnapshot"),bundleName:Wr("string"),bundle:Wr("string")};class A1 extends uR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zs(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Cr(this.firestore,null,r)}}function dg(t){t=ns(t,Co);const e=ns(t.firestore,Ki),r=bf(e),n=new A1(e);return FT(t._query),J6(r,t._query).then((s=>new el(e,n,t,s)))}function wn(t,e,r){t=ns(t,Cr);const n=ns(t.firestore,Ki),s=k1(t.converter,e,r);return Lf(n,[g1(Pf(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,ss.none())])}function r0(t,e,r,...n){t=ns(t,Cr);const s=ns(t.firestore,Ki),i=Pf(s);let o;return o=typeof(e=$r(e))=="string"||e instanceof Df?ST(i,"updateDoc",t._key,e,r,n):TT(i,"updateDoc",t._key,e),Lf(s,[o.toMutation(t._key,ss.exists(!0))])}function hl(t){return Lf(ns(t.firestore,Ki),[new gd(t._key,ss.none())])}function hR(t,e){const r=ns(t.firestore,Ki),n=sr(t),s=k1(t.converter,e);return Lf(r,[g1(Pf(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,ss.exists(!1))]).then((()=>n))}function Sa(t,...e){var u,h,d;t=$r(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||n2(e[n])||(r=e[n++]);const s={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(n2(e[n])){const g=e[n];e[n]=(u=g.next)==null?void 0:u.bind(g),e[n+1]=(h=g.error)==null?void 0:h.bind(g),e[n+2]=(d=g.complete)==null?void 0:d.bind(g)}let i,o,c;if(t instanceof Cr)o=ns(t.firestore,Ki),c=fd(t._key.path),i={next:g=>{e[n]&&e[n](bT(o,t,g))},error:e[n+1],complete:e[n+2]};else{const g=ns(t,Co);o=ns(g.firestore,Ki),c=g._query;const x=new A1(o);i={next:_=>{e[n]&&e[n](new el(o,x,g,_))},error:e[n+1],complete:e[n+2]},FT(t._query)}return(function(x,_,k,y){const S=new p1(y),R=new f1(_,S,k);return x.asyncQueue.enqueueAndForget((async()=>l1(await M0(x),R))),()=>{S.Nu(),x.asyncQueue.enqueueAndForget((async()=>c1(await M0(x),R)))}})(bf(o),c,s,i)}function Lf(t,e){return(function(n,s){const i=new ga;return n.asyncQueue.enqueueAndForget((async()=>B6(await Y6(n),s,i))),i.promise})(bf(t),e)}function bT(t,e,r){const n=r.docs.get(e._key),s=new A1(t);return new Zo(t,s,e._key,n,new Pu(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Pf(e)}set(e,r,n){this._verifyNotCommitted();const s=Em(e,this._firestore),i=k1(s.converter,r,n),o=g1(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(o.toMutation(s._key,ss.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=Em(e,this._firestore);let o;return o=typeof(r=$r(r))=="string"||r instanceof Df?ST(this._dataReader,"WriteBatch.update",i._key,r,n,s):TT(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,ss.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Em(e,this._firestore);return this._mutations=this._mutations.concat(new gd(r._key,ss.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ke(Ee.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Em(t,e){if((t=$r(t)).firestore!==e)throw new Ke(Ee.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Xt(){return new x1("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fu(t){return bf(t=ns(t,Ki)),new dR(t,(e=>Lf(t,e)))}(function(e,r=!0){(function(s){Lc=s})(Oc),Tc(new cl("firestore",((n,{instanceIdentifier:s,options:i})=>{const o=n.getProvider("app").getImmediate(),c=new Ki(new iI(n.getProvider("auth-internal")),new lI(o,n.getProvider("app-check-internal")),(function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ke(Ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rf(h.options.projectId,d)})(o,s),o);return i={useFetchStreams:r,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),fo(oy,ly,e),fo(oy,ly,"esm2020")})();function DT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const pR=DT,PT=new kf("auth","Firebase",DT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B0=new Vg("@firebase/auth");function mR(t,...e){B0.logLevel<=Dt.WARN&&B0.warn(`Auth (${Oc}): ${t}`,...e)}function w0(t,...e){B0.logLevel<=Dt.ERROR&&B0.error(`Auth (${Oc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(t,...e){throw I1(t,...e)}function xi(t,...e){return I1(t,...e)}function C1(t,e,r){const n={...pR(),[e]:r};return new kf("auth","Firebase",n).create(e,{appName:t.name})}function tl(t){return C1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function gR(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Xi(t,"argument-error"),C1(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function I1(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return PT.create(t,...e)}function gt(t,e,...r){if(!t)throw I1(e,...r)}function da(t){const e="INTERNAL ASSERTION FAILED: "+t;throw w0(e),new Error(e)}function ka(t,e){t||da(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pg(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function xR(){return a2()==="http:"||a2()==="https:"}function a2(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xR()||PC()||"connection"in navigator)?navigator.onLine:!0}function _R(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e,r){this.shortDelay=e,this.longDelay=r,ka(r>e,"Short delay should be less than long delay!"),this.isMobile=NC()||OC()}get(){return vR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(t,e){ka(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;da("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;da("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;da("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wR=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ER=new Mf(3e4,6e4);function R1(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function jc(t,e,r,n,s={}){return LT(t,s,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const c=Af({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:u,...i};return DC()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&Pc(t.emulatorConfig.host)&&(h.credentials="include"),OT.fetch()(await MT(t,t.config.apiHost,r,c),h)})}async function LT(t,e,r){t._canInitEmulator=!1;const n={...yR,...e};try{const s=new SR(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw n0(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw n0(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw n0(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw n0(t,"user-disabled",o);const d=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw C1(t,d,h);Xi(t,d)}}catch(s){if(s instanceof Ia)throw s;Xi(t,"network-request-failed",{message:String(s)})}}async function TR(t,e,r,n,s={}){const i=await jc(t,e,r,n,s);return"mfaPendingCredential"in i&&Xi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function MT(t,e,r,n){const s=`${e}${r}?${n}`,i=t,o=i.config.emulator?F1(t.config,s):`${t.config.apiScheme}://${s}`;return wR.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class SR{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(xi(this.auth,"network-request-failed")),ER.get())})}}function n0(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=xi(t,e,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kR(t,e){return jc(t,"POST","/v1/accounts:delete",e)}async function U0(t,e){return jc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function AR(t,e=!1){const r=$r(t),n=await r.getIdToken(e),s=N1(n);gt(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Hu(Tm(s.auth_time)),issuedAtTime:Hu(Tm(s.iat)),expirationTime:Hu(Tm(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Tm(t){return Number(t)*1e3}function N1(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return w0("JWT malformed, contained fewer than 3 sections"),null;try{const s=$w(r);return s?JSON.parse(s):(w0("Failed to decode base64 JWT payload"),null)}catch(s){return w0("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function o2(t){const e=N1(t);return gt(e,"internal-error"),gt(typeof e.exp<"u","internal-error"),gt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ia&&CR(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function CR({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hu(this.lastLoginAt),this.creationTime=Hu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j0(t){var g;const e=t.auth,r=await t.getIdToken(),n=await cf(t,U0(e,{idToken:r}));gt(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];t._notifyReloadListener(s);const i=(g=s.providerUserInfo)!=null&&g.length?VT(s.providerUserInfo):[],o=RR(t.providerData,i),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),h=c?u:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new mg(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,d)}async function FR(t){const e=$r(t);await j0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function RR(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function VT(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NR(t,e){const r=await LT(t,{},async()=>{const n=Af({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await MT(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return t.emulatorConfig&&Pc(t.emulatorConfig.host)&&(u.credentials="include"),OT.fetch()(o,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function bR(t,e){return jc(t,"POST","/v2/accounts:revokeToken",R1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){gt(e.idToken,"internal-error"),gt(typeof e.idToken<"u","internal-error"),gt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):o2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){gt(e.length!==0,"internal-error");const r=o2(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(gt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await NR(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,o=new gc;return n&&(gt(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(gt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(gt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gc,this.toJSON())}_performRefresh(){return da("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Za(t,e){gt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class pi{constructor({uid:e,auth:r,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new IR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new mg(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await cf(this,this.stsTokenManager.getToken(this.auth,e));return gt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return AR(this,e)}reload(){return FR(this)}_assign(e){this!==e&&(gt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new pi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){gt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await j0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(di(this.auth.app))return Promise.reject(tl(this.auth));const e=await this.getIdToken();return await cf(this,kR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,s=r.email??void 0,i=r.phoneNumber??void 0,o=r.photoURL??void 0,c=r.tenantId??void 0,u=r._redirectEventId??void 0,h=r.createdAt??void 0,d=r.lastLoginAt??void 0,{uid:g,emailVerified:x,isAnonymous:_,providerData:k,stsTokenManager:y}=r;gt(g&&y,e,"internal-error");const S=gc.fromJSON(this.name,y);gt(typeof g=="string",e,"internal-error"),Za(n,e.name),Za(s,e.name),gt(typeof x=="boolean",e,"internal-error"),gt(typeof _=="boolean",e,"internal-error"),Za(i,e.name),Za(o,e.name),Za(c,e.name),Za(u,e.name),Za(h,e.name),Za(d,e.name);const R=new pi({uid:g,auth:e,email:s,emailVerified:x,displayName:n,isAnonymous:_,photoURL:o,phoneNumber:i,tenantId:c,stsTokenManager:S,createdAt:h,lastLoginAt:d});return k&&Array.isArray(k)&&(R.providerData=k.map(M=>({...M}))),u&&(R._redirectEventId=u),R}static async _fromIdTokenResponse(e,r,n=!1){const s=new gc;s.updateFromServerResponse(r);const i=new pi({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await j0(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];gt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?VT(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new gc;c.updateFromIdToken(n);const u=new pi({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new mg(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2=new Map;function pa(t){ka(t instanceof Function,"Expected a class definition");let e=l2.get(t);return e?(ka(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,l2.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}BT.type="NONE";const c2=BT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(t,e,r){return`firebase:${t}:${e}:${r}`}class xc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=E0(this.userKey,s.apiKey,i),this.fullPersistenceKey=E0("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await U0(this.auth,{idToken:e}).catch(()=>{});return r?pi._fromGetAccountInfoResponse(this.auth,r,e):null}return pi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new xc(pa(c2),e,n);const s=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||pa(c2);const o=E0(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const d=await h._get(o);if(d){let g;if(typeof d=="string"){const x=await U0(e,{idToken:d}).catch(()=>{});if(!x)break;g=await pi._fromGetAccountInfoResponse(e,x,d)}else g=pi._fromJSON(e,d);h!==i&&(c=g),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new xc(i,e,n):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new xc(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u2(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(HT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(UT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($T(e))return"Blackberry";if(GT(e))return"Webos";if(jT(e))return"Safari";if((e.includes("chrome/")||zT(e))&&!e.includes("edge/"))return"Chrome";if(WT(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function UT(t=Wn()){return/firefox\//i.test(t)}function jT(t=Wn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function zT(t=Wn()){return/crios\//i.test(t)}function HT(t=Wn()){return/iemobile/i.test(t)}function WT(t=Wn()){return/android/i.test(t)}function $T(t=Wn()){return/blackberry/i.test(t)}function GT(t=Wn()){return/webos/i.test(t)}function b1(t=Wn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function DR(t=Wn()){var e;return b1(t)&&!!((e=window.navigator)!=null&&e.standalone)}function PR(){return LC()&&document.documentMode===10}function qT(t=Wn()){return b1(t)||WT(t)||GT(t)||$T(t)||/windows phone/i.test(t)||HT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KT(t,e=[]){let r;switch(t){case"Browser":r=u2(Wn());break;case"Worker":r=`${u2(Wn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Oc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LR(t,e={}){return jc(t,"GET","/v2/passwordPolicy",R1(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR=6;class VR{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??MR,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new f2(this),this.idTokenSubscription=new f2(this),this.beforeStateQueue=new OR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=pa(r)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await xc.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await U0(this,{idToken:e}),n=await pi._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(di(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=n==null?void 0:n._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(n=u.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return gt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await j0(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_R()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(di(this.app))return Promise.reject(tl(this));const r=e?$r(e):null;return r&&gt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&gt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return di(this.app)?Promise.reject(tl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return di(this.app)?Promise.reject(tl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(pa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await LR(this),r=new VR(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new kf("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await bR(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&pa(e)||this._popupRedirectResolver;gt(r,this,"argument-error"),this.redirectPersistenceManager=await xc.create(this,[pa(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(gt(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,s);return()=>{o=!0,u()}}else{const u=e.addObserver(r);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return gt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=KT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(di(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&mR(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Sd(t){return $r(t)}class f2{constructor(e){this.auth=e,this.observer=null,this.addObserver=WC(r=>this.observer=r)}get next(){return gt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let D1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function UR(t){D1=t}function jR(t){return D1.loadJS(t)}function zR(){return D1.gapiScript}function HR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WR(t,e){const r=Ug(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(ll(i,e??{}))return s;Xi(s,"already-initialized")}return r.initialize({options:e})}function $R(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(pa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function GR(t,e,r){const n=Sd(t);gt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=XT(e),{host:o,port:c}=qR(e),u=c===null?"":`:${c}`,h={url:`${i}//${o}${u}/`},d=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){gt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),gt(ll(h,n.config.emulator)&&ll(d,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=d,n.settings.appVerificationDisabledForTesting=!0,Pc(o)?(Xw(`${i}//${o}${u}`),Yw("Auth",!0)):KR()}function XT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function qR(t){const e=XT(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:h2(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:h2(o)}}}function h2(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function KR(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return da("not implemented")}_getIdTokenResponse(e){return da("not implemented")}_linkToIdToken(e,r){return da("not implemented")}_getReauthenticationResolver(e){return da("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vc(t,e){return TR(t,"POST","/v1/accounts:signInWithIdp",R1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR="http://localhost";class dl extends YT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new dl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Xi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=r;if(!n||!s)return null;const o=new dl(n,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return vc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,vc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,vc(e,r)}buildRequest(){const e={requestUri:XR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Af(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf extends P1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro extends Vf{constructor(){super("facebook.com")}static credential(e){return dl._fromParams({providerId:ro.PROVIDER_ID,signInMethod:ro.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ro.credentialFromTaggedObject(e)}static credentialFromError(e){return ro.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ro.credential(e.oauthAccessToken)}catch{return null}}}ro.FACEBOOK_SIGN_IN_METHOD="facebook.com";ro.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha extends Vf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return dl._fromParams({providerId:ha.PROVIDER_ID,signInMethod:ha.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return ha.credentialFromTaggedObject(e)}static credentialFromError(e){return ha.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return ha.credential(r,n)}catch{return null}}}ha.GOOGLE_SIGN_IN_METHOD="google.com";ha.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no extends Vf{constructor(){super("github.com")}static credential(e){return dl._fromParams({providerId:no.PROVIDER_ID,signInMethod:no.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return no.credentialFromTaggedObject(e)}static credentialFromError(e){return no.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return no.credential(e.oauthAccessToken)}catch{return null}}}no.GITHUB_SIGN_IN_METHOD="github.com";no.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so extends Vf{constructor(){super("twitter.com")}static credential(e,r){return dl._fromParams({providerId:so.PROVIDER_ID,signInMethod:so.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return so.credentialFromTaggedObject(e)}static credentialFromError(e){return so.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return so.credential(r,n)}catch{return null}}}so.TWITTER_SIGN_IN_METHOD="twitter.com";so.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await pi._fromIdTokenResponse(e,n,s),o=d2(n);return new Rc({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=d2(n);return new Rc({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function d2(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0 extends Ia{constructor(e,r,n,s){super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,z0.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new z0(e,r,n,s)}}function QT(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?z0._fromErrorAndOperation(t,i,e,n):i})}async function YR(t,e,r=!1){const n=await cf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Rc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QR(t,e,r=!1){const{auth:n}=t;if(di(n.app))return Promise.reject(tl(n));const s="reauthenticate";try{const i=await cf(t,QT(n,s,e,t),r);gt(i.idToken,n,"internal-error");const o=N1(i.idToken);gt(o,n,"internal-error");const{sub:c}=o;return gt(t.uid===c,n,"user-mismatch"),Rc._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Xi(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JR(t,e,r=!1){if(di(t.app))return Promise.reject(tl(t));const n="signIn",s=await QT(t,n,e),i=await Rc._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}function ZR(t,e,r,n){return $r(t).onIdTokenChanged(e,r,n)}function eN(t,e,r){return $r(t).beforeAuthStateChanged(e,r)}function tN(t,e,r,n){return $r(t).onAuthStateChanged(e,r,n)}function rN(t){return $r(t).signOut()}const H0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(H0,"1"),this.storage.removeItem(H0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nN=1e3,sN=10;class ZT extends JT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);PR()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,sN):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},nN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}ZT.type="LOCAL";const iN=ZT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS extends JT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}eS.type="SESSION";const tS=eS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aN(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new kd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(o).map(async h=>h(r.origin,i)),u=await aN(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}kd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const h=O1("",20);s.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(g){const x=g;if(x.data.eventId===h)switch(x.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(x.data.response);break;default:clearTimeout(d),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(){return window}function lN(t){Gi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(){return typeof Gi().WorkerGlobalScope<"u"&&typeof Gi().importScripts=="function"}async function cN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function uN(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function fN(){return rS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS="firebaseLocalStorageDb",hN=1,W0="firebaseLocalStorage",sS="fbase_key";class Bf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Ad(t,e){return t.transaction([W0],e?"readwrite":"readonly").objectStore(W0)}function dN(){const t=indexedDB.deleteDatabase(nS);return new Bf(t).toPromise()}function gg(){const t=indexedDB.open(nS,hN);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(W0,{keyPath:sS})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(W0)?e(n):(n.close(),await dN(),e(await gg()))})})}async function p2(t,e,r){const n=Ad(t,!0).put({[sS]:e,value:r});return new Bf(n).toPromise()}async function pN(t,e){const r=Ad(t,!1).get(e),n=await new Bf(r).toPromise();return n===void 0?null:n.value}function m2(t,e){const r=Ad(t,!0).delete(e);return new Bf(r).toPromise()}const mN=800,gN=3;class iS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await gg(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>gN)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return rS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=kd._getInstance(fN()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await cN(),!this.activeServiceWorker)return;this.sender=new oN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||uN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await gg();return await p2(e,H0,"1"),await m2(e,H0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>p2(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>pN(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>m2(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Ad(s,!1).getAll();return new Bf(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),mN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}iS.type="LOCAL";const xN=iS;new Mf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aS(t,e){return e?pa(e):(gt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1 extends YT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return vc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return vc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function vN(t){return JR(t.auth,new L1(t),t.bypassAuthState)}function _N(t){const{auth:e,user:r}=t;return gt(r,e,"internal-error"),QR(r,new L1(t),t.bypassAuthState)}async function yN(t){const{auth:e,user:r}=t;return gt(r,e,"internal-error"),YR(r,new L1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vN;case"linkViaPopup":case"linkViaRedirect":return yN;case"reauthViaPopup":case"reauthViaRedirect":return _N;default:Xi(this.auth,"internal-error")}}resolve(e){ka(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ka(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wN=new Mf(2e3,1e4);async function EN(t,e,r){if(di(t.app))return Promise.reject(xi(t,"operation-not-supported-in-this-environment"));const n=Sd(t);gR(t,e,P1);const s=aS(n,r);return new Qo(n,"signInViaPopup",e,s).executeNotNull()}class Qo extends oS{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Qo.currentPopupAction&&Qo.currentPopupAction.cancel(),Qo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return gt(e,this.auth,"internal-error"),e}async onExecution(){ka(this.filter.length===1,"Popup operations only handle one event");const e=O1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(xi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(xi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,wN.get())};e()}}Qo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TN="pendingRedirect",T0=new Map;class SN extends oS{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=T0.get(this.auth._key());if(!e){try{const n=await kN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}T0.set(this.auth._key(),e)}return this.bypassAuthState||T0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function kN(t,e){const r=IN(e),n=CN(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function AN(t,e){T0.set(t._key(),e)}function CN(t){return pa(t._redirectPersistence)}function IN(t){return E0(TN,t.config.apiKey,t.name)}async function FN(t,e,r=!1){if(di(t.app))return Promise.reject(tl(t));const n=Sd(t),s=aS(n,e),o=await new SN(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN=600*1e3;class NN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!bN(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!lS(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(xi(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=RN&&this.cachedEventUids.clear(),this.cachedEventUids.has(g2(e))}saveEventToCache(e){this.cachedEventUids.add(g2(e)),this.lastProcessedEventTime=Date.now()}}function g2(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function lS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function bN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DN(t,e={}){return jc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ON=/^https?/;async function LN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await DN(t);for(const r of e)try{if(MN(r))return}catch{}Xi(t,"unauthorized-domain")}function MN(t){const e=pg(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!ON.test(r))return!1;if(PN.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN=new Mf(3e4,6e4);function x2(){const t=Gi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function BN(t){return new Promise((e,r)=>{var s,i,o;function n(){x2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{x2(),r(xi(t,"network-request-failed"))},timeout:VN.get()})}if((i=(s=Gi().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Gi().gapi)!=null&&o.load)n();else{const c=HR("iframefcb");return Gi()[c]=()=>{gapi.load?n():r(xi(t,"network-request-failed"))},jR(`${zR()}?onload=${c}`).catch(u=>r(u))}}).catch(e=>{throw S0=null,e})}let S0=null;function UN(t){return S0=S0||BN(t),S0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jN=new Mf(5e3,15e3),zN="__/auth/iframe",HN="emulator/auth/iframe",WN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$N=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function GN(t){const e=t.config;gt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?F1(e,HN):`https://${t.config.authDomain}/${zN}`,n={apiKey:e.apiKey,appName:t.name,v:Oc},s=$N.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Af(n).slice(1)}`}async function qN(t){const e=await UN(t),r=Gi().gapi;return gt(r,t,"internal-error"),e.open({where:document.body,url:GN(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:WN,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const o=xi(t,"network-request-failed"),c=Gi().setTimeout(()=>{i(o)},jN.get());function u(){Gi().clearTimeout(c),s(n)}n.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},XN=500,YN=600,QN="_blank",JN="http://localhost";class v2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ZN(t,e,r,n=XN,s=YN){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...KN,width:n.toString(),height:s.toString(),top:i,left:o},h=Wn().toLowerCase();r&&(c=zT(h)?QN:r),UT(h)&&(e=e||JN,u.scrollbars="yes");const d=Object.entries(u).reduce((x,[_,k])=>`${x}${_}=${k},`,"");if(DR(h)&&c!=="_self")return eb(e||"",c),new v2(null);const g=window.open(e||"",c,d);gt(g,t,"popup-blocked");try{g.focus()}catch{}return new v2(g)}function eb(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb="__/auth/handler",rb="emulator/auth/handler",nb=encodeURIComponent("fac");async function _2(t,e,r,n,s,i){gt(t.config.authDomain,t,"auth-domain-config-required"),gt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Oc,eventId:s};if(e instanceof P1){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",HC(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(e instanceof Vf){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const u=await t._getAppCheckToken(),h=u?`#${nb}=${encodeURIComponent(u)}`:"";return`${sb(t)}?${Af(c).slice(1)}${h}`}function sb({config:t}){return t.emulator?F1(t,rb):`https://${t.authDomain}/${tb}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm="webStorageSupport";class ib{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tS,this._completeRedirectFn=FN,this._overrideRedirectResult=AN}async _openPopup(e,r,n,s){var o;ka((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await _2(e,r,n,pg(),s);return ZN(e,i,O1())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await _2(e,r,n,pg(),s);return lN(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(ka(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await qN(e),n=new NN(e);return r.register("authEvent",s=>(gt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Sm,{type:Sm},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Sm];i!==void 0&&r(!!i),Xi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=LN(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return qT()||jT()||b1()}}const ab=ib;var y2="@firebase/auth",w2="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){gt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lb(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function cb(t){Tc(new cl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;gt(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:KT(t)},h=new BR(n,s,i,u);return $R(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Tc(new cl("auth-internal",e=>{const r=Sd(e.getProvider("auth").getImmediate());return(n=>new ob(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),fo(y2,w2,lb(t)),fo(y2,w2,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ub=300,fb=Kw("authIdTokenMaxAge")||ub;let E2=null;const hb=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>fb)return;const s=r==null?void 0:r.token;E2!==s&&(E2=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function db(t=eE()){const e=Ug(t,"auth");if(e.isInitialized())return e.getImmediate();const r=WR(t,{popupRedirectResolver:ab,persistence:[xN,iN,tS]}),n=Kw("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=hb(i.toString());eN(r,o,()=>o(r.currentUser)),ZR(r,c=>o(c))}}const s=Gw("auth");return s&&GR(r,`http://${s}`),r}function pb(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}UR({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=xi("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",pb().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});cb("Browser");const mb={apiKey:"AIzaSyBBfpg8D4bqcqOTTuO5ONIQRInRCPOZM5k",authDomain:"comments-67079.firebaseapp.com",projectId:"comments-67079",storageBucket:"comments-67079.firebasestorage.app",messagingSenderId:"36001866008",appId:"1:36001866008:web:448de13685ad843551be6d"},cS=Zw(mb),St=eR(cS),dc=db(cS),uS=new ha;uS.setCustomParameters({prompt:"select_account"});let Mn=null;const gb=t=>{Mn=t},lt={USERS:"users",STUDENTS:"students",SETTINGS:"settings",TEMPLATES:"templates",CLASSES:"classes",SCHOOLS:"schools",ADMIN_CONFIG:"adminConfig"},xg=t=>{if(!Mn)throw new Error(" ID  setCurrentUserId()");return xa(St,lt.USERS,Mn,t)},Ui=(t,e)=>{if(!Mn)throw new Error(" ID  setCurrentUserId()");return sr(St,lt.USERS,Mn,t,e)},On={subscribe:(t,e=null)=>{if(!Mn)return console.error(" ID "),t([]),()=>{};const r=xg(lt.STUDENTS);return Sa(r,n=>{let s=[];n.forEach(i=>{const o={id:i.id,...i.data()};(!e||o.classId===e)&&s.push(o)}),s.sort((i,o)=>{var c,u,h,d;return(((u=(c=i.createdAt)==null?void 0:c.toMillis)==null?void 0:u.call(c))||0)-(((d=(h=o.createdAt)==null?void 0:h.toMillis)==null?void 0:d.call(h))||0)}),t(s)},n=>{console.error("Firestore :",n),t([])})},subscribeByUserId:(t,e)=>{if(!t)return console.error(" ID "),e([]),()=>{};const r=xa(St,lt.USERS,t,lt.STUDENTS);return Sa(r,n=>{let s=[];n.forEach(i=>{s.push({id:i.id,...i.data()})}),s.sort((i,o)=>{var c,u,h,d;return(((u=(c=i.createdAt)==null?void 0:c.toMillis)==null?void 0:u.call(c))||0)-(((d=(h=o.createdAt)==null?void 0:h.toMillis)==null?void 0:d.call(h))||0)}),e(s)},n=>{console.error("Firestore :",n),e([])})},add:async t=>{try{const e=Ui(lt.STUDENTS,t.id.toString());await wn(e,{...t,createdAt:Xt(),updatedAt:Xt()})}catch(e){throw console.error(":",e),e}},addBatch:async t=>{try{const e=Fu(St);t.forEach(r=>{const n=Ui(lt.STUDENTS,r.id.toString());e.set(n,{...r,createdAt:Xt(),updatedAt:Xt()})}),await e.commit()}catch(e){throw console.error(":",e),e}},update:async(t,e)=>{try{const r=Ui(lt.STUDENTS,t.toString());await wn(r,{...e,updatedAt:Xt()},{merge:!0})}catch(r){throw console.error(":",r),r}},delete:async t=>{try{const e=Ui(lt.STUDENTS,t.toString());await hl(e)}catch(e){throw console.error(":",e),e}},deleteBatch:async t=>{try{const e=Fu(St);t.forEach(r=>{const n=Ui(lt.STUDENTS,r.toString());e.delete(n)}),await e.commit()}catch(e){throw console.error(":",e),e}},deleteAll:async()=>{try{const t=xg(lt.STUDENTS),e=await dg(t),r=Fu(St);e.forEach(n=>{r.delete(n.ref)}),await r.commit()}catch(t){throw console.error(":",t),t}},updateByUserId:async(t,e,r)=>{if(!t)throw new Error(" ID ");try{const n=sr(St,lt.USERS,t,lt.STUDENTS,e.toString());await wn(n,{...r,updatedAt:Xt()},{merge:!0})}catch(n){throw console.error(":",n),n}},deleteByUserId:async(t,e)=>{if(!t)throw new Error(" ID ");try{const r=sr(St,lt.USERS,t,lt.STUDENTS,e.toString());await hl(r)}catch(r){throw console.error(":",r),r}},addByUserId:async(t,e)=>{if(!t)throw new Error(" ID ");try{const r=sr(St,lt.USERS,t,lt.STUDENTS,e.id.toString());await wn(r,{...e,createdAt:Xt(),updatedAt:Xt()})}catch(r){throw console.error(":",r),r}},addBatchByUserId:async(t,e)=>{if(!t)throw new Error(" ID ");try{const r=Fu(St);e.forEach(n=>{const s=sr(St,lt.USERS,t,lt.STUDENTS,n.id.toString());r.set(s,{...n,createdAt:Xt(),updatedAt:Xt()})}),await r.commit()}catch(r){throw console.error(":",r),r}},deleteAllByUserId:async t=>{if(!t)throw new Error(" ID ");try{const e=xa(St,lt.USERS,t,lt.STUDENTS),r=await dg(e),n=Fu(St);r.forEach(s=>{n.delete(s.ref)}),await n.commit()}catch(e){throw console.error(":",e),e}}},xb={subscribe:t=>{if(!Mn)return console.error(" ID "),t({}),()=>{};const e=Ui(lt.SETTINGS,"user");return Sa(e,r=>{r.exists()?t(r.data()):t({})},r=>{console.error(":",r),t({})})},save:async t=>{try{const e=Ui(lt.SETTINGS,"user");await wn(e,{...t,updatedAt:Xt()},{merge:!0})}catch(e){throw console.error(":",e),e}}},T2={subscribe:t=>{if(!Mn)return console.error(" ID "),t([]),()=>{};const e=xg(lt.TEMPLATES);return Sa(e,r=>{const n=[];r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>{var o,c,u,h;return(((c=(o=i.createdAt)==null?void 0:o.toMillis)==null?void 0:c.call(o))||0)-(((h=(u=s.createdAt)==null?void 0:u.toMillis)==null?void 0:h.call(u))||0)}),t(n)},r=>{console.error(":",r),t([])})},add:async t=>{try{const e=Date.now().toString(),r=Ui(lt.TEMPLATES,e);return await wn(r,{...t,createdAt:Xt(),usageCount:0}),e}catch(e){throw console.error(":",e),e}},delete:async t=>{try{const e=Ui(lt.TEMPLATES,t.toString());await hl(e)}catch(e){throw console.error(":",e),e}},incrementUsage:async t=>{try{const e=Ui(lt.TEMPLATES,t.toString()),r=await Bi(e);r.exists()&&await wn(e,{usageCount:(r.data().usageCount||0)+1,updatedAt:Xt()},{merge:!0})}catch(e){console.error(":",e)}}},fS={subscribe:t=>{const e=xa(St,lt.CLASSES);return Sa(e,r=>{const n=[];r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>{var o,c,u,h;return(((c=(o=s.createdAt)==null?void 0:o.toMillis)==null?void 0:c.call(o))||0)-(((h=(u=i.createdAt)==null?void 0:u.toMillis)==null?void 0:h.call(u))||0)}),t(n)},r=>{console.error(":",r)})},add:async t=>{try{const e=Date.now().toString(),r=sr(St,lt.CLASSES,e);return await wn(r,{...t,schoolId:t.schoolId||null,createdAt:Xt(),updatedAt:Xt()}),e}catch(e){throw console.error(":",e),e}},update:async(t,e)=>{try{const r=sr(St,lt.CLASSES,t.toString());await wn(r,{...e,updatedAt:Xt()},{merge:!0})}catch(r){throw console.error(":",r),r}},delete:async t=>{try{const e=sr(St,lt.CLASSES,t.toString());await hl(e)}catch(e){throw console.error(":",e),e}}},vb={subscribe:t=>{const e=xa(St,lt.SCHOOLS);return Sa(e,r=>{const n=[];r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>(s.name||"").localeCompare(i.name||"","zh-TW")),t(n)},r=>{console.error(":",r),t([])})},add:async t=>{try{const e=Date.now().toString(),r=sr(St,lt.SCHOOLS,e);return await wn(r,{...t,createdAt:Xt(),updatedAt:Xt()}),e}catch(e){throw console.error(":",e),e}},update:async(t,e)=>{try{const r=sr(St,lt.SCHOOLS,t.toString());await wn(r,{...e,updatedAt:Xt()},{merge:!0})}catch(r){throw console.error(":",r),r}},delete:async t=>{try{const e=sr(St,lt.SCHOOLS,t.toString());await hl(e)}catch(e){throw console.error(":",e),e}}},S2={subscribe:(t,e)=>{if(!Mn)return console.error(" ID "),e([]),()=>{};const r=xa(St,lt.USERS,Mn,lt.STUDENTS,t.toString(),"history");return Sa(r,n=>{const s=[];n.forEach(i=>{s.push({id:i.id,...i.data()})}),s.sort((i,o)=>{var c,u,h,d;return(((u=(c=o.createdAt)==null?void 0:c.toMillis)==null?void 0:u.call(c))||0)-(((d=(h=i.createdAt)==null?void 0:h.toMillis)==null?void 0:d.call(h))||0)}),e(s)},n=>{console.error(":",n),e([])})},add:async(t,e,r=[])=>{if(!Mn)throw new Error(" ID ");try{const n=xa(St,lt.USERS,Mn,lt.STUDENTS,t.toString(),"history");await hR(n,{comment:e,styles:r,createdAt:Xt()})}catch(n){throw console.error(":",n),n}},getAll:async t=>{if(!Mn)return console.error(" ID "),[];try{const e=xa(St,lt.USERS,Mn,lt.STUDENTS,t.toString(),"history"),r=await dg(e),n=[];return r.forEach(s=>{n.push({id:s.id,...s.data()})}),n.sort((s,i)=>{var o,c,u,h;return(((c=(o=i.createdAt)==null?void 0:o.toMillis)==null?void 0:c.call(o))||0)-(((h=(u=s.createdAt)==null?void 0:u.toMillis)==null?void 0:h.call(u))||0)})}catch(e){return console.error(":",e),[]}},delete:async(t,e)=>{if(!Mn)throw new Error(" ID ");try{const r=sr(St,lt.USERS,Mn,lt.STUDENTS,t.toString(),"history",e);await hl(r)}catch(r){throw console.error(":",r),r}}},_b={subscribe:t=>{const e=sr(St,lt.ADMIN_CONFIG,"shared");return Sa(e,r=>{r.exists()?t(r.data()):t(null)},r=>{console.error(":",r),t(null)})},getSharedConfig:async()=>{try{const t=sr(St,lt.ADMIN_CONFIG,"shared"),e=await Bi(t);return e.exists()?e.data():null}catch(t){return console.error(":",t),null}},saveSharedApiKey:async(t,e)=>{try{const r=sr(St,lt.ADMIN_CONFIG,"shared"),n=await Bi(r),s=n.exists()?n.data():{};await wn(r,{...s,sharedApiKey:t,updatedAt:Xt(),updatedBy:e},{merge:!0})}catch(r){throw console.error(" API Key :",r),r}},clearSharedApiKey:async t=>{try{const e=sr(St,lt.ADMIN_CONFIG,"shared"),r=await Bi(e),n=r.exists()?r.data():{};await wn(e,{...n,sharedApiKey:"",updatedAt:Xt(),updatedBy:t},{merge:!0})}catch(e){throw console.error(" API Key :",e),e}},grantAccess:async(t,e)=>{try{const r=sr(St,lt.ADMIN_CONFIG,"shared"),n=await Bi(r),s=n.exists()?n.data():{},i=s.authorizedUsers||[];i.includes(t)||i.push(t),await wn(r,{...s,authorizedUsers:i,updatedAt:Xt(),updatedBy:e},{merge:!0})}catch(r){throw console.error(":",r),r}},revokeAccess:async(t,e)=>{try{const r=sr(St,lt.ADMIN_CONFIG,"shared"),n=await Bi(r),s=n.exists()?n.data():{},i=(s.authorizedUsers||[]).filter(o=>o!==t);await wn(r,{...s,authorizedUsers:i,updatedAt:Xt(),updatedBy:e},{merge:!0})}catch(r){throw console.error(":",r),r}},checkAuthorization:async t=>{try{const e=sr(St,lt.ADMIN_CONFIG,"shared"),r=await Bi(e);return r.exists()?(r.data().authorizedUsers||[]).includes(t):!1}catch(e){return console.error(":",e),!1}},getSharedApiKey:async t=>{try{const e=sr(St,lt.ADMIN_CONFIG,"shared"),r=await Bi(e);if(!r.exists())return null;const n=r.data();return(n.authorizedUsers||[]).includes(t)&&n.sharedApiKey||null}catch(e){return console.error(" API Key :",e),null}}},yb="cagooo@gmail.com",eo={USERS:"users"},Ns={ADMIN:"admin",TEACHER:"teacher",PENDING:"pending",PENDING_INFO:"pending_info",PENDING_REVIEW:"pending_review"},vg={getCurrentUser:()=>dc.currentUser,onAuthStateChange:t=>tN(dc,async e=>{if(e){const r=await io.getOrCreate(e);t({...e,...r})}else t(null)}),signInWithGoogle:async()=>{try{const e=(await EN(dc,uS)).user;return await io.getOrCreate(e),{success:!0,user:e}}catch(t){return console.error("Google :",t),{success:!1,error:t.message}}},signOut:async()=>{try{return localStorage.removeItem("gemini_api_key"),await rN(dc),{success:!0}}catch(t){return console.error(":",t),{success:!1,error:t.message}}}},io={getOrCreate:async t=>{const e=sr(St,eo.USERS,t.uid),r=await Bi(e);if(r.exists())return await wn(e,{lastLoginAt:Xt()},{merge:!0}),{id:r.id,...r.data()};const n=t.email===yb,s={uid:t.uid,email:t.email,displayName:t.displayName||"",photoURL:t.photoURL||null,role:n?Ns.ADMIN:Ns.PENDING_INFO,assignedClasses:[],requestedSchoolId:null,requestedClasses:[],createdAt:Xt(),lastLoginAt:Xt(),approvedAt:n?Xt():null,approvedBy:n?"system":null};return await wn(e,s),{id:t.uid,...s}},get:async t=>{const e=sr(St,eo.USERS,t),r=await Bi(e);return r.exists()?{id:r.id,...r.data()}:null},subscribeAll:t=>{const e=xa(St,eo.USERS),r=lR(e,cR("createdAt","desc"));return Sa(r,n=>{const s=[];n.forEach(i=>{s.push({id:i.id,...i.data()})}),t(s)},n=>{console.error(":",n)})},approve:async(t,e=[],r=null,n=null)=>{var s;try{const i=sr(St,eo.USERS,t),o={role:Ns.TEACHER,assignedClasses:e,approvedAt:Xt(),approvedBy:((s=dc.currentUser)==null?void 0:s.uid)||"unknown"};return r?(o.schoolId=r,o.customSchoolName=null,o.customSchoolCity=null):n&&(o.schoolId=null,o.customSchoolName=n.name,o.customSchoolCity=n.city),await r0(i,o),{success:!0}}catch(i){return console.error(":",i),{success:!1,error:i.message}}},updateAssignedClasses:async(t,e,r=null,n=null)=>{try{const s=sr(St,eo.USERS,t),i={assignedClasses:e,updatedAt:Xt()};return r?(i.schoolId=r,i.customSchoolName=null,i.customSchoolCity=null):n&&(i.schoolId=null,i.customSchoolName=n.name,i.customSchoolCity=n.city),await r0(s,i),{success:!0}}catch(s){return console.error(":",s),{success:!1,error:s.message}}},reject:async t=>{var e;try{const r=sr(St,eo.USERS,t);return await r0(r,{role:Ns.PENDING_INFO,assignedClasses:[],requestedSchoolId:null,requestedClasses:[],rejectedAt:Xt(),rejectedBy:((e=dc.currentUser)==null?void 0:e.uid)||"unknown"}),{success:!0}}catch(r){return console.error(":",r),{success:!1,error:r.message}}},submitApplication:async(t,e,r)=>{try{const n=sr(St,eo.USERS,t),s={role:Ns.PENDING_REVIEW,requestedClasses:r,applicationSubmittedAt:Xt()};return e.schoolId?(s.requestedSchoolId=e.schoolId,s.requestedSchoolName=null,s.requestedSchoolCity=null):(s.requestedSchoolId=null,s.requestedSchoolName=e.schoolName,s.requestedSchoolCity=e.schoolCity),await r0(n,s),{success:!0}}catch(n){return console.error(":",n),{success:!1,error:n.message}}},delete:async t=>{try{const e=sr(St,eo.USERS,t);return await hl(e),{success:!0}}catch(e){return console.error(":",e),{success:!1,error:e.message}}},isAdmin:t=>(t==null?void 0:t.role)===Ns.ADMIN,isApproved:t=>(t==null?void 0:t.role)===Ns.ADMIN||(t==null?void 0:t.role)===Ns.TEACHER,needsInfo:t=>(t==null?void 0:t.role)===Ns.PENDING_INFO,isPendingReview:t=>(t==null?void 0:t.role)===Ns.PENDING_REVIEW||(t==null?void 0:t.role)===Ns.PENDING},wb=t=>{const[e,r]=ye.useState([]),[n,s]=ye.useState(new Set),[i,o]=ye.useState(!0),[c,u]=ye.useState(!1);ye.useEffect(()=>{if(!t){r([]),o(!1);return}gb(t),o(!0);const V=On.subscribe(W=>{const j=W.map(A=>({...A,id:parseInt(A.id)||A.id,selectedTags:A.selectedTags||[],manualTraits:A.manualTraits||"",comment:A.comment||""}));r(j),o(!1)});return()=>V()},[t]);const h=ye.useCallback(async V=>{const W=V.split(`
`).map(A=>A.trim()).filter(A=>A!=="");if(W.length===0)return[];const j=W.map((A,F)=>({id:Date.now()+F,name:A,selectedTags:[],manualTraits:"",comment:""}));u(!0);try{await On.addBatch(j)}catch(A){console.error(":",A)}return u(!1),j},[]),d=ye.useCallback(async(V,W,j)=>{r(A=>A.map(F=>F.id===V?{...F,[W]:j}:F));try{const A=e.find(F=>F.id===V);A&&await On.update(V,{...A,[W]:j})}catch(A){console.error(":",A)}},[e]),g=ye.useCallback(async V=>{r(W=>W.filter(j=>j.id!==V)),s(W=>{const j=new Set(W);return j.delete(V),j});try{await On.delete(V)}catch(W){console.error(":",W)}},[]),x=ye.useCallback(async()=>{const V=Array.from(n);r(W=>W.filter(j=>!n.has(j.id))),s(new Set);try{await On.deleteBatch(V)}catch(W){console.error(":",W)}},[n]),_=ye.useCallback(async()=>{r([]),s(new Set);try{await On.deleteAll()}catch(V){console.error(":",V)}},[]),k=ye.useCallback(V=>{s(W=>{const j=new Set(W);return j.has(V)?j.delete(V):j.add(V),j})},[]),y=ye.useCallback(()=>{if(n.size===e.length&&e.length>0)s(new Set);else{const V=new Set(e.map(W=>W.id));s(V)}},[n.size,e]),S=ye.useCallback(async(V,W)=>{r(j=>j.map(A=>V.includes(A.id)?A.selectedTags.includes(W)?A:{...A,selectedTags:[...A.selectedTags,W]}:A));try{for(const j of V){const A=e.find(F=>F.id===j);A&&!A.selectedTags.includes(W)&&await On.update(j,{selectedTags:[...A.selectedTags,W]})}}catch(j){console.error(":",j)}},[e]),R=ye.useCallback(async(V,W)=>{r(j=>j.map(A=>A.id===V?{...A,selectedTags:A.selectedTags.filter(F=>F!==W)}:A));try{const j=e.find(A=>A.id===V);j&&await On.update(V,{selectedTags:j.selectedTags.filter(A=>A!==W)})}catch(j){console.error(":",j)}},[e]),M=ye.useCallback(V=>{r(W=>typeof V=="function"?V(W):V)},[]),N=ye.useCallback(async(V,W)=>{try{await On.update(V,{comment:W})}catch(j){console.error(":",j)}},[]);return{students:e,setStudents:M,selectedIds:n,isLoading:i,isSyncing:c,generateStudents:h,updateStudent:d,deleteStudent:g,deleteSelected:x,resetStudents:_,toggleSelection:k,toggleAllSelection:y,addTagToStudents:S,removeTag:R,syncComment:N}},Eb=({isSidebarOpen:t,setIsSidebarOpen:e,onOpenSettings:r,onOpenTemplates:n,onOpenClasses:s,onOpenAdmin:i,onOpenImportExport:o,onOpenPrint:c,onOpenDashboard:u,onLogout:h,hasApiKey:d,templateCount:g=0,currentClassName:x="",currentUser:_,isAdmin:k,pendingCount:y=0})=>{const[S,R]=ye.useState(!1),M=[{icon:zm,label:"Excel /",onClick:o,color:"text-[#54A0FF]"},{icon:$_,label:" PDF",onClick:c,color:"text-[#FF6B9D]"},{icon:W_,label:"",onClick:u,color:"text-[#6C5CE7]"},{icon:G_,label:d?"API  ":"API  ",onClick:r,color:d?"text-[#1DD1A1]":"text-[#FF6B6B]"}];return w.jsxs("header",{className:"bg-[#FFF9E6] border-b-4 border-[#2D3436] h-14 sm:h-16 md:h-20 flex items-center justify-between px-2 sm:px-4 md:px-6 shrink-0 z-20 sticky top-0 shadow-[0_4px_0_#2D3436]",children:[w.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 md:gap-3 shrink-0",children:[w.jsx("div",{className:"bg-[#FECA57] text-[#2D3436] p-1 sm:p-1.5 md:p-2 lg:p-3 border-2 sm:border-3 border-[#2D3436] shadow-[2px_2px_0_#2D3436] sm:shadow-[3px_3px_0_#2D3436] transform rotate-[-2deg] rounded-lg shrink-0",children:w.jsx("span",{className:"text-base sm:text-lg md:text-xl lg:text-2xl",children:""})}),w.jsxs("div",{className:"min-w-0 flex-shrink",children:[w.jsxs("h1",{className:"text-xs sm:text-sm md:text-lg lg:text-2xl font-black text-[#2D3436] tracking-wide truncate",children:[w.jsxs("span",{className:"hidden lg:inline relative",children:[w.jsx("span",{className:"relative z-10",children:""}),w.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-3 bg-[#FF6B9D] -z-0 transform -rotate-1"})]}),w.jsx("span",{className:"hidden lg:inline ml-1",children:""}),w.jsx("span",{className:"hidden md:inline lg:hidden",children:""}),w.jsx("span",{className:"md:hidden"})]}),w.jsxs("button",{onClick:s,className:"text-[10px] sm:text-xs font-bold text-[#636E72] hover:text-[#A29BFE] transition-colors flex items-center gap-0.5 max-w-[100px] sm:max-w-[120px] md:max-w-none",children:[w.jsx(Hm,{size:10,className:"shrink-0 hidden sm:block"}),w.jsx("span",{className:"truncate",children:x}),w.jsx(qA,{size:10,className:"shrink-0"})]})]})]}),w.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 md:gap-2",children:[k&&w.jsxs("button",{onClick:i,className:"btn-pop p-1.5 sm:p-2 bg-[#FF6B9D] text-white flex items-center gap-1 text-xs sm:text-sm relative",title:"",children:[w.jsx(q_,{size:16,className:"sm:w-[18px] sm:h-[18px]"}),w.jsx("span",{className:"hidden md:inline",children:""}),y>0&&w.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 sm:w-5 sm:h-5 bg-[#FECA57] text-[#2D3436] text-[10px] sm:text-xs font-bold rounded-full flex items-center justify-center animate-pulse shadow-[1px_1px_0_#2D3436]",children:y>9?"9+":y})]}),w.jsxs("button",{onClick:n,className:"btn-pop p-1.5 sm:p-2 bg-[#A29BFE] text-white flex items-center gap-1 text-xs sm:text-sm relative",title:"",children:[w.jsx(Pg,{size:16,className:"sm:w-[18px] sm:h-[18px]"}),w.jsx("span",{className:"hidden md:inline",children:""}),g>0&&w.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 sm:w-5 sm:h-5 bg-[#2D3436] text-white text-[10px] sm:text-xs font-bold rounded-full flex items-center justify-center",children:g>9?"9+":g})]}),w.jsxs("div",{className:"hidden lg:flex items-center gap-1.5",children:[w.jsxs("button",{onClick:o,className:"btn-pop p-2 bg-[#54A0FF] text-white flex items-center gap-1 text-sm",title:"Excel /",children:[w.jsx(zm,{size:18}),w.jsx("span",{children:"Excel"})]}),w.jsxs("button",{onClick:c,className:"btn-pop p-2 bg-[#FF6B9D] text-white flex items-center gap-1 text-sm",title:" PDF ",children:[w.jsx($_,{size:18}),w.jsx("span",{children:""})]}),w.jsxs("button",{onClick:u,className:"btn-pop p-2 bg-[#6C5CE7] text-white flex items-center gap-1 text-sm",title:"",children:[w.jsx(W_,{size:18}),w.jsx("span",{children:""})]}),w.jsxs("button",{onClick:r,className:`btn-pop p-2 flex items-center gap-1 text-sm
                            ${d?"bg-[#1DD1A1] text-white":"bg-[#FF6B6B] text-white animate-pulse"}`,title:d?"API Key ":" API Key",children:[w.jsx(G_,{size:18}),w.jsx("span",{children:d?"":""})]})]}),w.jsxs("div",{className:"lg:hidden relative",children:[w.jsxs("button",{onClick:()=>R(!S),className:`btn-pop p-1.5 sm:p-2 flex items-center gap-1 text-xs sm:text-sm
                            ${d?"bg-[#636E72] text-white":"bg-[#FF6B6B] text-white animate-pulse"}`,title:"",children:[w.jsx(QA,{size:16,className:"sm:w-[18px] sm:h-[18px]"}),w.jsx("span",{className:"hidden sm:inline",children:""})]}),S&&w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>R(!1)}),w.jsx("div",{className:"absolute right-0 top-full mt-2 bg-white border-2 border-[#2D3436] rounded-lg shadow-[3px_3px_0_#2D3436] py-2 w-48 z-50",children:M.map((N,V)=>w.jsxs("button",{onClick:()=>{N.onClick(),R(!1)},className:"w-full px-4 py-2.5 flex items-center gap-3 hover:bg-[#FFF9E6] transition-colors text-left",children:[w.jsx(N.icon,{size:18,className:N.color}),w.jsx("span",{className:"text-sm font-medium text-[#2D3436]",children:N.label})]},V))})]})]}),w.jsxs("button",{onClick:()=>e(!t),className:`btn-pop p-1.5 sm:p-2 md:px-3 flex items-center gap-1 text-xs sm:text-sm
                        ${t?"bg-[#FF6B9D] text-white":"bg-[#54A0FF] text-white"}`,children:[t?w.jsx(ol,{size:16,className:"sm:w-[18px] sm:h-[18px]"}):w.jsx(nC,{size:16,className:"sm:w-[18px] sm:h-[18px]"}),w.jsx("span",{className:"hidden sm:inline",children:t?"":""}),w.jsx("span",{className:"sm:hidden",children:""})]}),w.jsxs("div",{className:"relative group",children:[_!=null&&_.photoURL?w.jsx("img",{src:_.photoURL,alt:_.displayName,className:"w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 rounded-full border-2 border-[#2D3436] cursor-pointer hover:ring-2 hover:ring-[#FECA57] transition-all"}):w.jsx("div",{className:"w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-[#FECA57] rounded-full border-2 border-[#2D3436] flex items-center justify-center cursor-pointer",children:w.jsx("span",{className:"text-sm sm:text-lg",children:""})}),w.jsxs("div",{className:"absolute right-0 top-10 sm:top-12 bg-white border-2 border-[#2D3436] rounded-lg shadow-[3px_3px_0_#2D3436] p-3 w-48 sm:w-56 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[w.jsx("div",{className:"text-sm font-bold text-[#2D3436] truncate",children:_==null?void 0:_.displayName}),w.jsx("div",{className:"text-xs text-[#636E72] truncate",children:_==null?void 0:_.email}),(_==null?void 0:_.schoolName)&&w.jsx("div",{className:"mt-2 pt-2 border-t border-dashed border-[#E8DCC8]",children:w.jsxs("div",{className:"text-xs text-[#636E72] flex items-center gap-1",children:[" ",w.jsx("span",{className:"font-bold text-[#A29BFE]",children:_.schoolName})]})}),k&&w.jsx("div",{className:`${_!=null&&_.schoolName?"mt-1":"mt-2 pt-2 border-t border-dashed border-[#E8DCC8]"}`,children:w.jsxs("div",{className:"text-xs flex items-center gap-1",children:[w.jsx(q_,{size:12,className:"text-[#FF6B9D]"}),w.jsx("span",{className:"font-bold text-[#FF6B9D]",children:""})]})}),(_==null?void 0:_.assignedClassNames)&&_.assignedClassNames.length>0&&w.jsx("div",{className:`${_!=null&&_.schoolName?"mt-1":"mt-2 pt-2 border-t border-dashed border-[#E8DCC8]"}`,children:w.jsxs("div",{className:"text-xs text-[#636E72] flex items-start gap-1",children:[w.jsx(Hm,{size:12,className:"mt-0.5 shrink-0"}),w.jsx("span",{className:"font-bold text-[#54A0FF]",children:_.assignedClassNames.join("")})]})}),w.jsxs("button",{onClick:h,className:"w-full btn-pop px-3 py-2 bg-[#636E72] text-white text-xs font-bold flex items-center justify-center gap-2 mt-3",children:[w.jsx(tC,{size:14}),""]})]})]})]})]})},Tb=()=>w.jsx("footer",{className:"bg-[#FECA57] text-[#2D3436] text-xs sm:text-sm py-3 sm:py-4 text-center border-t-4 border-[#2D3436] shrink-0 font-bold",children:w.jsxs("p",{className:"flex items-center justify-center gap-2",children:[w.jsx("span",{children:""}),w.jsx("span",{children:" "}),w.jsx("span",{children:""})]})}),Sb=({dialog:t,closeDialog:e})=>t.isOpen?w.jsx("div",{className:"fixed inset-0 z-[110] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",children:w.jsxs("div",{className:"card-pop w-full max-w-sm overflow-hidden animate-in",children:[w.jsx("div",{className:"p-4 sm:p-5 bg-[#FF6B9D] border-b-3 border-[#2D3436]",children:w.jsxs("h3",{className:"font-black text-lg sm:text-xl text-white flex items-center gap-2",children:[t.type==="confirm"?w.jsx(Mg,{size:24}):w.jsx(Vw,{size:24}),t.title]})}),w.jsx("div",{className:"p-4 sm:p-6 bg-[#FFFDF5] text-[#2D3436] font-bold text-base sm:text-lg",children:t.message}),w.jsx("div",{className:"p-3 sm:p-4 bg-[#FFF9E6] flex justify-end gap-2 sm:gap-3 border-t-2 border-dashed border-[#E8DCC8]",children:t.type==="confirm"?w.jsxs(w.Fragment,{children:[w.jsx("button",{onClick:e,className:"btn-pop px-4 sm:px-6 py-2 bg-white text-[#2D3436] text-sm sm:text-base",children:" "}),w.jsx("button",{onClick:t.onConfirm,className:"btn-pop px-4 sm:px-6 py-2 bg-[#FF6B6B] text-white text-sm sm:text-base",children:" "})]}):w.jsx("button",{onClick:e,className:"btn-pop px-4 sm:px-6 py-2 bg-[#1DD1A1] text-white text-sm sm:text-base",children:" "})})]})}):null,kb=({progress:t})=>{const e=t.total>0?t.current/t.total*100:0;return w.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-[#2D3436]/70 backdrop-blur-md p-4",children:w.jsxs("div",{className:"card-pop w-[95%] sm:w-[90%] max-w-2xl flex flex-col items-center justify-center p-6 sm:p-10 text-center animate-in bg-[#FFF9E6]",children:[w.jsx("div",{className:"mb-4 sm:mb-6 text-6xl sm:text-8xl animate-bounce-soft",children:""}),w.jsxs("h2",{className:"text-2xl sm:text-4xl md:text-5xl font-black text-[#2D3436] mb-4 sm:mb-6",children:[w.jsxs("span",{className:"relative inline-block",children:["",w.jsx("span",{className:"absolute bottom-1 left-0 right-0 h-3 bg-[#FECA57] -z-10 transform rotate-1"})]}),w.jsx("span",{className:"animate-pulse",children:"..."})]}),w.jsx("div",{className:"w-full max-w-md bg-white border-3 border-[#2D3436] h-8 sm:h-10 mb-3 sm:mb-4 overflow-hidden rounded-full shadow-[4px_4px_0_#2D3436]",children:w.jsx("div",{className:"h-full transition-all duration-300 ease-out bg-gradient-to-r from-[#FF6B9D] via-[#FECA57] to-[#1DD1A1]",style:{width:`${e}%`}})}),w.jsxs("p",{className:"text-lg sm:text-2xl text-[#2D3436] font-bold mb-4 sm:mb-6",children:[" ",t.current," / ",t.total," "]}),w.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl text-[#FF6B9D] font-black",children:" "})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var $0={};$0.version="0.18.5";var hS=1252,Ab=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],M1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},V1=function(t){Ab.indexOf(t)!=-1&&(hS=M1[0]=t)};function Cb(){V1(1252)}var mi=function(t){V1(t)};function B1(){mi(1200),Cb()}function k2(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Ib(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function dS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Ou=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Ib(t.slice(2)):e==254&&r==255?dS(t.slice(2)):e==65279?t.slice(1):t},s0=function(e){return String.fromCharCode(e)},A2=function(e){return String.fromCharCode(e)},uf,oo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ff(t){for(var e="",r=0,n=0,s=0,i=0,o=0,c=0,u=0,h=0;h<t.length;)r=t.charCodeAt(h++),i=r>>2,n=t.charCodeAt(h++),o=(r&3)<<4|n>>4,s=t.charCodeAt(h++),c=(n&15)<<2|s>>6,u=s&63,isNaN(n)?c=u=64:isNaN(s)&&(u=64),e+=oo.charAt(i)+oo.charAt(o)+oo.charAt(c)+oo.charAt(u);return e}function Ms(t){var e="",r=0,n=0,s=0,i=0,o=0,c=0,u=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)i=oo.indexOf(t.charAt(h++)),o=oo.indexOf(t.charAt(h++)),r=i<<2|o>>4,e+=String.fromCharCode(r),c=oo.indexOf(t.charAt(h++)),n=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(n)),u=oo.indexOf(t.charAt(h++)),s=(c&3)<<6|u,u!==64&&(e+=String.fromCharCode(s));return e}var Ct=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Fa=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function wo(t){return Ct?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function C2(t){return Ct?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ps=function(e){return Ct?Fa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Cd(t){if(typeof ArrayBuffer>"u")return Ps(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Io(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Fb(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function U1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return U1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var an=Ct?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Fa(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Rb(t){for(var e=[],r=0,n=t.length+250,s=wo(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=t.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|c>>6&15|(o&3)<<4,s[r++]=128|c&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(e.push(s.slice(0,r)),r=0,s=wo(65535),n=65530)}return e.push(s.slice(0,r)),an(e)}var is=/\u0000/g,Lu=/[\u0001-\u0006]/g;function _c(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function gi(t,e){var r=""+t;return r.length>=e?r:Ar("0",e-r.length)+r}function j1(t,e){var r=""+t;return r.length>=e?r:Ar(" ",e-r.length)+r}function G0(t,e){var r=""+t;return r.length>=e?r:r+Ar(" ",e-r.length)}function Nb(t,e){var r=""+Math.round(t);return r.length>=e?r:Ar("0",e-r.length)+r}function bb(t,e){var r=""+t;return r.length>=e?r:Ar("0",e-r.length)+r}var I2=Math.pow(2,32);function ic(t,e){if(t>I2||t<-I2)return Nb(t,e);var r=Math.round(t);return bb(r,e)}function q0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var F2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],km=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Db(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ct={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},R2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Pb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function K0(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,o=1,c=0,u=1,h=0,d=0,g=Math.floor(s);h<e&&(g=Math.floor(s),c=g*o+i,d=g*h+u,!(s-g<5e-8));)s=1/(s-g),i=o,o=c,u=h,h=d;if(d>e&&(h>e?(d=u,c=i):(d=h,c=o)),!r)return[0,n*c,d];var x=Math.floor(n*c/d);return[x,n*c-x*d,d]}function Jo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,o=[],c={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++n,++c.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),n<60&&(i=(i+6)%7),r&&(i=Ub(u,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=i,c}var pS=new Date(1899,11,31,0,0,0),Ob=pS.getTime(),Lb=new Date(1900,2,1,0,0,0);function mS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Lb&&(r+=1440*60*1e3),(r-(Ob+(t.getTimezoneOffset()-pS.getTimezoneOffset())*6e4))/(1440*60*1e3)}function z1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Mb(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Vb(t){var e=t<0?12:11,r=z1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Bb(t){var e=z1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function hf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Vb(t):e===10?r=t.toFixed(10).substr(0,12):r=Bb(t),z1(Mb(r.toUpperCase()))}function pl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):hf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ti(14,mS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Ub(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function jb(t,e,r,n){var s="",i=0,o=0,c=r.y,u,h=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:u=c%100,h=2;break;default:u=c%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:u=r.m,h=e.length;break;case 3:return km[r.m-1][1];case 5:return km[r.m-1][0];default:return km[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:u=r.d,h=e.length;break;case 3:return F2[r.q][0];default:return F2[r.q][1]}break;case 104:switch(e.length){case 1:case 2:u=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:u=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:u=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?gi(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(s=gi(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:u=c,h=1;break}var d=h>0?gi(u,h):"";return d}function lo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var gS=/%/g;function zb(t,e,r){var n=e.replace(gS,""),s=e.length-n.length;return va(t,n,r*Math.pow(10,2*s))+Ar("%",s)}function Hb(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return va(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function xS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+xS(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var vS=/# (\?+)( ?)\/( ?)(\d+)/;function Wb(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),o=s-i*n,c=n;return r+(i===0?"":""+i)+" "+(o===0?Ar(" ",t[1].length+1+t[4].length):j1(o,t[1].length)+t[2]+"/"+t[3]+gi(c,t[4].length))}function $b(t,e,r){return r+(e===0?"":""+e)+Ar(" ",t[1].length+2+t[4].length)}var _S=/^#*0*\.([0#]+)/,yS=/\).*[0#]/,wS=/\(###\) ###\\?-####/;function ts(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function N2(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function b2(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Gb(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function qb(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ks(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ks("n",n,r):"("+Ks("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Hb(t,e,r);if(e.indexOf("%")!==-1)return zb(t,e,r);if(e.indexOf("E")!==-1)return xS(e,r);if(e.charCodeAt(0)===36)return"$"+Ks(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+ic(u,e.length);if(e.match(/^[#?]+$/))return s=ic(r,0),s==="0"&&(s=""),s.length>e.length?s:ts(e.substr(0,e.length-s.length))+s;if(i=e.match(vS))return Wb(i,u,h);if(e.match(/^#+0+$/))return h+ic(u,e.length-e.indexOf("0"));if(i=e.match(_S))return s=N2(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ts(i[1])).replace(/\.$/,"."+ts(i[1])).replace(/\.(\d*)$/,function(k,y){return"."+y+Ar("0",ts(i[1]).length-y.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+N2(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+lo(ic(u,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ks(t,e,-r):lo(""+(Math.floor(r)+Gb(r,i[1].length)))+"."+gi(b2(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Ks(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=_c(Ks(t,e.replace(/[\\-]/g,""),r)),o=0,_c(_c(e.replace(/\\/g,"")).replace(/[0#]/g,function(k){return o<s.length?s.charAt(o++):k==="0"?"0":""}));if(e.match(wS))return s=Ks(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=K0(u,Math.pow(10,o)-1,!1),s=""+h,d=va("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=G0(c[2],o),d.length<i[4].length&&(d=ts(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=K0(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?j1(c[1],o)+i[2]+"/"+i[3]+G0(c[2],o):Ar(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=ic(r,0),e.length<=s.length?s:ts(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=e.indexOf(".")-o,x=e.length-s.length-g;return ts(e.substr(0,g)+s+e.substr(e.length-x))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=b2(r,i[1].length),r<0?"-"+Ks(t,e,-r):lo(qb(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?gi(0,3-k.length):"")+k})+"."+gi(o,i[1].length);switch(e){case"###,##0.00":return Ks(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=lo(ic(u,0));return _!=="0"?h+_:"";case"###,###.00":return Ks(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ks(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Kb(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return va(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Xb(t,e,r){var n=e.replace(gS,""),s=e.length-n.length;return va(t,n,r*Math.pow(10,2*s))+Ar("%",s)}function ES(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ES(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Li(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Li("n",n,r):"("+Li("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Kb(t,e,r);if(e.indexOf("%")!==-1)return Xb(t,e,r);if(e.indexOf("E")!==-1)return ES(e,r);if(e.charCodeAt(0)===36)return"$"+Li(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+gi(u,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:ts(e.substr(0,e.length-s.length))+s;if(i=e.match(vS))return $b(i,u,h);if(e.match(/^#+0+$/))return h+gi(u,e.length-e.indexOf("0"));if(i=e.match(_S))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ts(i[1])).replace(/\.$/,"."+ts(i[1])),s=s.replace(/\.(\d*)$/,function(k,y){return"."+y+Ar("0",ts(i[1]).length-y.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+lo(""+u);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Li(t,e,-r):lo(""+r)+"."+Ar("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Li(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=_c(Li(t,e.replace(/[\\-]/g,""),r)),o=0,_c(_c(e.replace(/\\/g,"")).replace(/[0#]/g,function(k){return o<s.length?s.charAt(o++):k==="0"?"0":""}));if(e.match(wS))return s=Li(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=K0(u,Math.pow(10,o)-1,!1),s=""+h,d=va("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=G0(c[2],o),d.length<i[4].length&&(d=ts(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=K0(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?j1(c[1],o)+i[2]+"/"+i[3]+G0(c[2],o):Ar(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:ts(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var g=e.indexOf(".")-o,x=e.length-s.length-g;return ts(e.substr(0,g)+s+e.substr(e.length-x))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Li(t,e,-r):lo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?gi(0,3-k.length):"")+k})+"."+gi(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var _=lo(""+u);return _!=="0"?h+_:"";default:if(e.match(/\.[0#?]*$/))return Li(t,e.slice(0,e.lastIndexOf(".")),r)+ts(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function va(t,e,r){return(r|0)===r?Li(t,e,r):Ks(t,e,r)}function Yb(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var TS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":q0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(TS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Qb(t,e,r,n){for(var s=[],i="",o=0,c="",u="t",h,d,g,x="H";o<t.length;)switch(c=t.charAt(o)){case"G":if(!q0(t,o))throw new Error("unrecognized character "+c+" in "+t);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(g=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(g);s[s.length]={t:"t",v:i},++o;break;case"\\":var _=t.charAt(++o),k=_==="("||_===")"?_:"t";s[s.length]={t:k,v:_},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(h==null&&(h=Jo(e,r,t.charAt(o+1)==="2"),h==null))return"";s[s.length]={t:"X",v:t.substr(o,2)},u=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=Jo(e,r),h==null))return"";for(i=c;++o<t.length&&t.charAt(o).toLowerCase()===c;)i+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),s[s.length]={t:c,v:i},u=c;break;case"A":case"a":case"":var y={t:c,v:c};if(h==null&&(h=Jo(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(y.v=h.H>=12?"P":"A"),y.t="T",x="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(y.v=h.H>=12?"PM":"AM"),y.t="T",o+=5,x="h"):t.substr(o,5).toUpperCase()==="/"?(h!=null&&(y.v=h.H>=12?"":""),y.t="T",o+=5,x="h"):(y.t="t",++o),h==null&&y.t==="T")return"";s[s.length]=y,u=c;break;case"[":for(i=c;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(TS)){if(h==null&&(h=Jo(e,r),h==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",zc(t)||(s[s.length]={t:"t",v:i}));break;case".":if(h!=null){for(i=c;++o<t.length&&(c=t.charAt(o))==="0";)i+=c;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++o<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(o))>-1;)i+=c;s[s.length]={t:"n",v:i};break;case"?":for(i=c;t.charAt(++o)===c;)i+=c;s[s.length]={t:c,v:i},u=c;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:c,v:c},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);s[s.length]={t:"t",v:c},++o;break}var S=0,R=0,M;for(o=s.length-1,u="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=x,u="h",S<1&&(S=1);break;case"s":(M=s[o].v.match(/\.0+$/))&&(R=Math.max(R,M[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":u=s[o].t;break;case"m":u==="s"&&(s[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&s[o].v.match(/[Hh]/)&&(S=1),S<2&&s[o].v.match(/[Mm]/)&&(S=2),S<3&&s[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var N="",V;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=jb(s[o].t.charCodeAt(0),s[o].v,h,R),s[o].t="t";break;case"n":case"?":for(V=o+1;s[V]!=null&&((c=s[V].t)==="?"||c==="D"||(c===" "||c==="t")&&s[V+1]!=null&&(s[V+1].t==="?"||s[V+1].t==="t"&&s[V+1].v==="/")||s[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[V].v==="/"||s[V].v===" "&&s[V+1]!=null&&s[V+1].t=="?"));)s[o].v+=s[V].v,s[V]={v:"",t:";"},++V;N+=s[o].v,o=V-1;break;case"G":s[o].t="t",s[o].v=pl(e,r);break}var W="",j,A;if(N.length>0){N.charCodeAt(0)==40?(j=e<0&&N.charCodeAt(0)===45?-e:e,A=va("n",N,j)):(j=e<0&&n>1?-e:e,A=va("n",N,j),j<0&&s[0]&&s[0].t=="t"&&(A=A.substr(1),s[0].v="-"+s[0].v)),V=A.length-1;var F=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){F=o;break}var I=s.length;if(F===s.length&&A.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(V>=s[o].v.length-1?(V-=s[o].v.length,s[o].v=A.substr(V+1,s[o].v.length)):V<0?s[o].v="":(s[o].v=A.substr(0,V+1),V=-1),s[o].t="t",I=o);V>=0&&I<s.length&&(s[I].v=A.substr(0,V+1)+s[I].v)}else if(F!==s.length&&A.indexOf("E")===-1){for(V=A.indexOf(".")-1,o=F;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(d=s[o].v.indexOf(".")>-1&&o===F?s[o].v.indexOf(".")-1:s[o].v.length-1,W=s[o].v.substr(d+1);d>=0;--d)V>=0&&(s[o].v.charAt(d)==="0"||s[o].v.charAt(d)==="#")&&(W=A.charAt(V--)+W);s[o].v=W,s[o].t="t",I=o}for(V>=0&&I<s.length&&(s[I].v=A.substr(0,V+1)+s[I].v),V=A.indexOf(".")+1,o=F;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==F)){for(d=s[o].v.indexOf(".")>-1&&o===F?s[o].v.indexOf(".")+1:0,W=s[o].v.substr(0,d);d<s[o].v.length;++d)V<A.length&&(W+=A.charAt(V++));s[o].v=W,s[o].t="t",I=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(j=n>1&&e<0&&o>0&&s[o-1].v==="-"?-e:e,s[o].v=va(s[o].t,s[o].v,j),s[o].t="t");var U="";for(o=0;o!==s.length;++o)s[o]!=null&&(U+=s[o].v);return U}var D2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function P2(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function Jb(t,e){var r=Yb(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(D2),c=r[1].match(D2);return P2(e,o)?[n,r[0]]:P2(e,c)?[n,r[1]]:[n,r[o!=null&&c!=null?2:1]]}return[n,i]}function ti(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ct)[t],n==null&&(n=r.table&&r.table[R2[t]]||ct[R2[t]]),n==null&&(n=Pb[t]||"General");break}if(q0(n,0))return pl(e,r);e instanceof Date&&(e=mS(e,r.date1904));var s=Jb(n,e);if(q0(s[1]))return pl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Qb(s[1],e,r,s[0])}function _a(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ct[r]==null){e<0&&(e=r);continue}if(ct[r]==t){e=r;break}}e<0&&(e=391)}return ct[e]=t,e}function Id(t){for(var e=0;e!=392;++e)t[e]!==void 0&&_a(t[e],e)}function Hc(){ct=Db()}var Zb={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},SS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function eD(t){var e=typeof t=="number"?ct[t]:t;return e=e.replace(SS,"(\\d+)"),new RegExp("^"+e+"$")}function tD(t,e,r){var n=-1,s=-1,i=-1,o=-1,c=-1,u=-1;(e.match(SS)||[]).forEach(function(g,x){var _=parseInt(r[x+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=_;break;case"d":i=_;break;case"h":o=_;break;case"s":u=_;break;case"m":o>=0?c=_:s=_;break}}),u>=0&&c==-1&&s>=0&&(c=s,s=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&c==-1&&u==-1?h:n==-1&&s==-1&&i==-1?d:h+"T"+d}var rD=(function(){var t={};t.version="1.2.0";function e(){for(var A=0,F=new Array(256),I=0;I!=256;++I)A=I,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,F[I]=A;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(A){var F=0,I=0,U=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)L[U]=A[U];for(U=0;U!=256;++U)for(I=A[U],F=256+U;F<4096;F+=256)I=L[F]=I>>>8^A[I&255];var D=[];for(U=1;U!=16;++U)D[U-1]=typeof Int32Array<"u"?L.subarray(U*256,U*256+256):L.slice(U*256,U*256+256);return D}var s=n(r),i=s[0],o=s[1],c=s[2],u=s[3],h=s[4],d=s[5],g=s[6],x=s[7],_=s[8],k=s[9],y=s[10],S=s[11],R=s[12],M=s[13],N=s[14];function V(A,F){for(var I=F^-1,U=0,L=A.length;U<L;)I=I>>>8^r[(I^A.charCodeAt(U++))&255];return~I}function W(A,F){for(var I=F^-1,U=A.length-15,L=0;L<U;)I=N[A[L++]^I&255]^M[A[L++]^I>>8&255]^R[A[L++]^I>>16&255]^S[A[L++]^I>>>24]^y[A[L++]]^k[A[L++]]^_[A[L++]]^x[A[L++]]^g[A[L++]]^d[A[L++]]^h[A[L++]]^u[A[L++]]^c[A[L++]]^o[A[L++]]^i[A[L++]]^r[A[L++]];for(U+=15;L<U;)I=I>>>8^r[(I^A[L++])&255];return~I}function j(A,F){for(var I=F^-1,U=0,L=A.length,D=0,B=0;U<L;)D=A.charCodeAt(U++),D<128?I=I>>>8^r[(I^D)&255]:D<2048?(I=I>>>8^r[(I^(192|D>>6&31))&255],I=I>>>8^r[(I^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,B=A.charCodeAt(U++)&1023,I=I>>>8^r[(I^(240|D>>8&7))&255],I=I>>>8^r[(I^(128|D>>2&63))&255],I=I>>>8^r[(I^(128|B>>6&15|(D&3)<<4))&255],I=I>>>8^r[(I^(128|B&63))&255]):(I=I>>>8^r[(I^(224|D>>12&15))&255],I=I>>>8^r[(I^(128|D>>6&63))&255],I=I>>>8^r[(I^(128|D&63))&255]);return~I}return t.table=r,t.bstr=V,t.buf=W,t.str=j,t})(),nt=(function(){var e={};e.version="1.2.1";function r(P,q){for(var H=P.split("/"),G=q.split("/"),K=0,X=0,ce=Math.min(H.length,G.length);K<ce;++K){if(X=H[K].length-G[K].length)return X;if(H[K]!=G[K])return H[K]<G[K]?-1:1}return H.length-G.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var q=P.lastIndexOf("/");return q===-1?P:P.slice(0,q+1)}function s(P){if(P.charAt(P.length-1)=="/")return s(P.slice(0,-1));var q=P.lastIndexOf("/");return q===-1?P:P.slice(q+1)}function i(P,q){typeof q=="string"&&(q=new Date(q));var H=q.getHours();H=H<<6|q.getMinutes(),H=H<<5|q.getSeconds()>>>1,P.write_shift(2,H);var G=q.getFullYear()-1980;G=G<<4|q.getMonth()+1,G=G<<5|q.getDate(),P.write_shift(2,G)}function o(P){var q=P.read_shift(2)&65535,H=P.read_shift(2)&65535,G=new Date,K=H&31;H>>>=5;var X=H&15;H>>>=4,G.setMilliseconds(0),G.setFullYear(H+1980),G.setMonth(X-1),G.setDate(K);var ce=q&31;q>>>=5;var me=q&63;return q>>>=6,G.setHours(q),G.setMinutes(me),G.setSeconds(ce<<1),G}function c(P){vn(P,0);for(var q={},H=0;P.l<=P.length-4;){var G=P.read_shift(2),K=P.read_shift(2),X=P.l+K,ce={};switch(G){case 21589:H=P.read_shift(1),H&1&&(ce.mtime=P.read_shift(4)),K>5&&(H&2&&(ce.atime=P.read_shift(4)),H&4&&(ce.ctime=P.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}P.l=X,q[G]=ce}return q}var u;function h(){return u||(u={})}function d(P,q){if(P[0]==80&&P[1]==75)return Qe(P,q);if((P[0]|32)==109&&(P[1]|32)==105)return Qn(P,q);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var H=3,G=512,K=0,X=0,ce=0,me=0,le=0,ue=[],fe=P.slice(0,512);vn(fe,0);var Ne=g(fe);switch(H=Ne[0],H){case 3:G=512;break;case 4:G=4096;break;case 0:if(Ne[1]==0)return Qe(P,q);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}G!==512&&(fe=P.slice(0,G),vn(fe,28));var Ue=P.slice(0,G);x(fe,H);var Ge=fe.read_shift(4,"i");if(H===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);fe.l+=4,ce=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),me=fe.read_shift(4,"i"),K=fe.read_shift(4,"i"),le=fe.read_shift(4,"i"),X=fe.read_shift(4,"i");for(var Oe=-1,Pe=0;Pe<109&&(Oe=fe.read_shift(4,"i"),!(Oe<0));++Pe)ue[Pe]=Oe;var ft=_(P,G);S(le,X,ft,G,ue);var $t=M(ft,ce,ue,G);$t[ce].name="!Directory",K>0&&me!==B&&($t[me].name="!MiniFAT"),$t[ue[0]].name="!FAT",$t.fat_addrs=ue,$t.ssz=G;var Qt={},lr=[],Ts=[],cs=[];N(ce,$t,ft,lr,K,Qt,Ts,me),k(Ts,cs,lr),lr.shift();var Jn={FileIndex:Ts,FullPaths:cs};return q&&q.raw&&(Jn.raw={header:Ue,sectors:ft}),Jn}function g(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(De,"Header Signature: "),P.l+=16;var q=P.read_shift(2,"u");return[P.read_shift(2,"u"),q]}function x(P,q){var H=9;switch(P.l+=2,H=P.read_shift(2)){case 9:if(q!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(q!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function _(P,q){for(var H=Math.ceil(P.length/q)-1,G=[],K=1;K<H;++K)G[K-1]=P.slice(K*q,(K+1)*q);return G[H-1]=P.slice(H*q),G}function k(P,q,H){for(var G=0,K=0,X=0,ce=0,me=0,le=H.length,ue=[],fe=[];G<le;++G)ue[G]=fe[G]=G,q[G]=H[G];for(;me<fe.length;++me)G=fe[me],K=P[G].L,X=P[G].R,ce=P[G].C,ue[G]===G&&(K!==-1&&ue[K]!==K&&(ue[G]=ue[K]),X!==-1&&ue[X]!==X&&(ue[G]=ue[X])),ce!==-1&&(ue[ce]=G),K!==-1&&G!=ue[G]&&(ue[K]=ue[G],fe.lastIndexOf(K)<me&&fe.push(K)),X!==-1&&G!=ue[G]&&(ue[X]=ue[G],fe.lastIndexOf(X)<me&&fe.push(X));for(G=1;G<le;++G)ue[G]===G&&(X!==-1&&ue[X]!==X?ue[G]=ue[X]:K!==-1&&ue[K]!==K&&(ue[G]=ue[K]));for(G=1;G<le;++G)if(P[G].type!==0){if(me=G,me!=ue[me])do me=ue[me],q[G]=q[me]+"/"+q[G];while(me!==0&&ue[me]!==-1&&me!=ue[me]);ue[G]=-1}for(q[0]+="/",G=1;G<le;++G)P[G].type!==2&&(q[G]+="/")}function y(P,q,H){for(var G=P.start,K=P.size,X=[],ce=G;H&&K>0&&ce>=0;)X.push(q.slice(ce*D,ce*D+D)),K-=D,ce=Xo(H,ce*4);return X.length===0?ge(0):an(X).slice(0,P.size)}function S(P,q,H,G,K){var X=B;if(P===B){if(q!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var ce=H[P],me=(G>>>2)-1;if(!ce)return;for(var le=0;le<me&&(X=Xo(ce,le*4))!==B;++le)K.push(X);S(Xo(ce,G-4),q-1,H,G,K)}}function R(P,q,H,G,K){var X=[],ce=[];K||(K=[]);var me=G-1,le=0,ue=0;for(le=q;le>=0;){K[le]=!0,X[X.length]=le,ce.push(P[le]);var fe=H[Math.floor(le*4/G)];if(ue=le*4&me,G<4+ue)throw new Error("FAT boundary crossed: "+le+" 4 "+G);if(!P[fe])break;le=Xo(P[fe],ue)}return{nodes:X,data:G2([ce])}}function M(P,q,H,G){var K=P.length,X=[],ce=[],me=[],le=[],ue=G-1,fe=0,Ne=0,Ue=0,Ge=0;for(fe=0;fe<K;++fe)if(me=[],Ue=fe+q,Ue>=K&&(Ue-=K),!ce[Ue]){le=[];var Oe=[];for(Ne=Ue;Ne>=0;){Oe[Ne]=!0,ce[Ne]=!0,me[me.length]=Ne,le.push(P[Ne]);var Pe=H[Math.floor(Ne*4/G)];if(Ge=Ne*4&ue,G<4+Ge)throw new Error("FAT boundary crossed: "+Ne+" 4 "+G);if(!P[Pe]||(Ne=Xo(P[Pe],Ge),Oe[Ne]))break}X[Ue]={nodes:me,data:G2([le])}}return X}function N(P,q,H,G,K,X,ce,me){for(var le=0,ue=G.length?2:0,fe=q[P].data,Ne=0,Ue=0,Ge;Ne<fe.length;Ne+=128){var Oe=fe.slice(Ne,Ne+128);vn(Oe,64),Ue=Oe.read_shift(2),Ge=X1(Oe,0,Ue-ue),G.push(Ge);var Pe={name:Ge,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},ft=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);ft!==0&&(Pe.ct=V(Oe,Oe.l-8));var $t=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);$t!==0&&(Pe.mt=V(Oe,Oe.l-8)),Pe.start=Oe.read_shift(4,"i"),Pe.size=Oe.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=B,Pe.name=""),Pe.type===5?(le=Pe.start,K>0&&le!==B&&(q[le].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",q[Pe.start]===void 0&&(q[Pe.start]=R(H,Pe.start,q.fat_addrs,q.ssz)),q[Pe.start].name=Pe.name,Pe.content=q[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:le!==B&&Pe.start!==B&&q[le]&&(Pe.content=y(Pe,q[le].data,(q[me]||{}).data))),Pe.content&&vn(Pe.content,0),X[Ge]=Pe,ce.push(Pe)}}function V(P,q){return new Date((Ds(P,q+4)/1e7*Math.pow(2,32)+Ds(P,q)/1e7-11644473600)*1e3)}function W(P,q){return h(),d(u.readFileSync(P),q)}function j(P,q){var H=q&&q.type;switch(H||Ct&&Buffer.isBuffer(P)&&(H="buffer"),H||"base64"){case"file":return W(P,q);case"base64":return d(Ps(Ms(P)),q);case"binary":return d(Ps(P),q)}return d(P,q)}function A(P,q){var H=q||{},G=H.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=G+"/",P.FileIndex[0]={name:G,type:5}),H.CLSID&&(P.FileIndex[0].clsid=H.CLSID),F(P)}function F(P){var q="Sh33tJ5";if(!nt.find(P,"/"+q)){var H=ge(4);H[0]=55,H[1]=H[3]=50,H[2]=54,P.FileIndex.push({name:q,type:2,content:H,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+q),I(P)}}function I(P,q){A(P);for(var H=!1,G=!1,K=P.FullPaths.length-1;K>=0;--K){var X=P.FileIndex[K];switch(X.type){case 0:G?H=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:G=!0,isNaN(X.R*X.L*X.C)&&(H=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!q)){var ce=new Date(1987,1,19),me=0,le=Object.create?Object.create(null):{},ue=[];for(K=0;K<P.FullPaths.length;++K)le[P.FullPaths[K]]=!0,P.FileIndex[K].type!==0&&ue.push([P.FullPaths[K],P.FileIndex[K]]);for(K=0;K<ue.length;++K){var fe=n(ue[K][0]);G=le[fe],G||(ue.push([fe,{name:s(fe).replace("/",""),type:1,clsid:Ve,ct:ce,mt:ce,content:null}]),le[fe]=!0)}for(ue.sort(function(Ge,Oe){return r(Ge[0],Oe[0])}),P.FullPaths=[],P.FileIndex=[],K=0;K<ue.length;++K)P.FullPaths[K]=ue[K][0],P.FileIndex[K]=ue[K][1];for(K=0;K<ue.length;++K){var Ne=P.FileIndex[K],Ue=P.FullPaths[K];if(Ne.name=s(Ue).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||Ve,K===0)Ne.C=ue.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Ue.slice(-1)=="/"){for(me=K+1;me<ue.length&&n(P.FullPaths[me])!=Ue;++me);for(Ne.C=me>=ue.length?-1:me,me=K+1;me<ue.length&&n(P.FullPaths[me])!=n(Ue);++me);Ne.R=me>=ue.length?-1:me,Ne.type=1}else n(P.FullPaths[K+1]||"")==n(Ue)&&(Ne.R=K+1),Ne.type=2}}}function U(P,q){var H=q||{};if(H.fileType=="mad")return cn(P,H);switch(I(P),H.fileType){case"zip":return Rt(P,H)}var G=(function(Ge){for(var Oe=0,Pe=0,ft=0;ft<Ge.FileIndex.length;++ft){var $t=Ge.FileIndex[ft];if($t.content){var Qt=$t.content.length;Qt>0&&(Qt<4096?Oe+=Qt+63>>6:Pe+=Qt+511>>9)}}for(var lr=Ge.FullPaths.length+3>>2,Ts=Oe+7>>3,cs=Oe+127>>7,Jn=Ts+Pe+lr+cs,Se=Jn+127>>7,Ie=Se<=109?0:Math.ceil((Se-109)/127);Jn+Se+Ie+127>>7>Se;)Ie=++Se<=109?0:Math.ceil((Se-109)/127);var ze=[1,Ie,Se,cs,lr,Pe,Oe,0];return Ge.FileIndex[0].size=Oe<<6,ze[7]=(Ge.FileIndex[0].start=ze[0]+ze[1]+ze[2]+ze[3]+ze[4]+ze[5])+(ze[6]+7>>3),ze})(P),K=ge(G[7]<<9),X=0,ce=0;{for(X=0;X<8;++X)K.write_shift(1,Re[X]);for(X=0;X<8;++X)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),X=0;X<3;++X)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,G[2]),K.write_shift(4,G[0]+G[1]+G[2]+G[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,G[3]?G[0]+G[1]+G[2]-1:B),K.write_shift(4,G[3]),K.write_shift(-4,G[1]?G[0]-1:B),K.write_shift(4,G[1]),X=0;X<109;++X)K.write_shift(-4,X<G[2]?G[1]+X:-1)}if(G[1])for(ce=0;ce<G[1];++ce){for(;X<236+ce*127;++X)K.write_shift(-4,X<G[2]?G[1]+X:-1);K.write_shift(-4,ce===G[1]-1?B:ce+1)}var me=function(Ge){for(ce+=Ge;X<ce-1;++X)K.write_shift(-4,X+1);Ge&&(++X,K.write_shift(-4,B))};for(ce=X=0,ce+=G[1];X<ce;++X)K.write_shift(-4,Le.DIFSECT);for(ce+=G[2];X<ce;++X)K.write_shift(-4,Le.FATSECT);me(G[3]),me(G[4]);for(var le=0,ue=0,fe=P.FileIndex[0];le<P.FileIndex.length;++le)fe=P.FileIndex[le],fe.content&&(ue=fe.content.length,!(ue<4096)&&(fe.start=ce,me(ue+511>>9)));for(me(G[6]+7>>3);K.l&511;)K.write_shift(-4,Le.ENDOFCHAIN);for(ce=X=0,le=0;le<P.FileIndex.length;++le)fe=P.FileIndex[le],fe.content&&(ue=fe.content.length,!(!ue||ue>=4096)&&(fe.start=ce,me(ue+63>>6)));for(;K.l&511;)K.write_shift(-4,Le.ENDOFCHAIN);for(X=0;X<G[4]<<2;++X){var Ne=P.FullPaths[X];if(!Ne||Ne.length===0){for(le=0;le<17;++le)K.write_shift(4,0);for(le=0;le<3;++le)K.write_shift(4,-1);for(le=0;le<12;++le)K.write_shift(4,0);continue}fe=P.FileIndex[X],X===0&&(fe.start=fe.size?fe.start-1:B);var Ue=X===0&&H.root||fe.name;if(ue=2*(Ue.length+1),K.write_shift(64,Ue,"utf16le"),K.write_shift(2,ue),K.write_shift(1,fe.type),K.write_shift(1,fe.color),K.write_shift(-4,fe.L),K.write_shift(-4,fe.R),K.write_shift(-4,fe.C),fe.clsid)K.write_shift(16,fe.clsid,"hex");else for(le=0;le<4;++le)K.write_shift(4,0);K.write_shift(4,fe.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,fe.start),K.write_shift(4,fe.size),K.write_shift(4,0)}for(X=1;X<P.FileIndex.length;++X)if(fe=P.FileIndex[X],fe.size>=4096)if(K.l=fe.start+1<<9,Ct&&Buffer.isBuffer(fe.content))fe.content.copy(K,K.l,0,fe.size),K.l+=fe.size+511&-512;else{for(le=0;le<fe.size;++le)K.write_shift(1,fe.content[le]);for(;le&511;++le)K.write_shift(1,0)}for(X=1;X<P.FileIndex.length;++X)if(fe=P.FileIndex[X],fe.size>0&&fe.size<4096)if(Ct&&Buffer.isBuffer(fe.content))fe.content.copy(K,K.l,0,fe.size),K.l+=fe.size+63&-64;else{for(le=0;le<fe.size;++le)K.write_shift(1,fe.content[le]);for(;le&63;++le)K.write_shift(1,0)}if(Ct)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function L(P,q){var H=P.FullPaths.map(function(le){return le.toUpperCase()}),G=H.map(function(le){var ue=le.split("/");return ue[ue.length-(le.slice(-1)=="/"?2:1)]}),K=!1;q.charCodeAt(0)===47?(K=!0,q=H[0].slice(0,-1)+q):K=q.indexOf("/")!==-1;var X=q.toUpperCase(),ce=K===!0?H.indexOf(X):G.indexOf(X);if(ce!==-1)return P.FileIndex[ce];var me=!X.match(Lu);for(X=X.replace(is,""),me&&(X=X.replace(Lu,"!")),ce=0;ce<H.length;++ce)if((me?H[ce].replace(Lu,"!"):H[ce]).replace(is,"")==X||(me?G[ce].replace(Lu,"!"):G[ce]).replace(is,"")==X)return P.FileIndex[ce];return null}var D=64,B=-2,De="d0cf11e0a1b11ae1",Re=[208,207,17,224,161,177,26,225],Ve="00000000000000000000000000000000",Le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:De,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ve,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ae(P,q,H){h();var G=U(P,H);u.writeFileSync(q,G)}function ne(P){for(var q=new Array(P.length),H=0;H<P.length;++H)q[H]=String.fromCharCode(P[H]);return q.join("")}function we(P,q){var H=U(P,q);switch(q&&q.type||"buffer"){case"file":return h(),u.writeFileSync(q.filename,H),H;case"binary":return typeof H=="string"?H:ne(H);case"base64":return ff(typeof H=="string"?H:ne(H));case"buffer":if(Ct)return Buffer.isBuffer(H)?H:Fa(H);case"array":return typeof H=="string"?Ps(H):H}return H}var ee;function O(P){try{var q=P.InflateRaw,H=new q;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)ee=P;else throw new Error("zlib does not expose bytesRead")}catch(G){console.error("cannot use native zlib: "+(G.message||G))}}function te(P,q){if(!ee)return ws(P,q);var H=ee.InflateRaw,G=new H,K=G._processChunk(P.slice(P.l),G._finishFlushFlag);return P.l+=G.bytesRead,K}function J(P){return ee?ee.deflateRawSync(P):ot(P)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(P){var q=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(q>>16|q>>8|q)&255}for(var xe=typeof Uint8Array<"u",Te=xe?new Uint8Array(256):[],ut=0;ut<256;++ut)Te[ut]=ve(ut);function Y(P,q){var H=Te[P&255];return q<=8?H>>>8-q:(H=H<<8|Te[P>>8&255],q<=16?H>>>16-q:(H=H<<8|Te[P>>16&255],H>>>24-q))}function At(P,q){var H=q&7,G=q>>>3;return(P[G]|(H<=6?0:P[G+1]<<8))>>>H&3}function wt(P,q){var H=q&7,G=q>>>3;return(P[G]|(H<=5?0:P[G+1]<<8))>>>H&7}function Lt(P,q){var H=q&7,G=q>>>3;return(P[G]|(H<=4?0:P[G+1]<<8))>>>H&15}function xt(P,q){var H=q&7,G=q>>>3;return(P[G]|(H<=3?0:P[G+1]<<8))>>>H&31}function je(P,q){var H=q&7,G=q>>>3;return(P[G]|(H<=1?0:P[G+1]<<8))>>>H&127}function Zt(P,q,H){var G=q&7,K=q>>>3,X=(1<<H)-1,ce=P[K]>>>G;return H<8-G||(ce|=P[K+1]<<8-G,H<16-G)||(ce|=P[K+2]<<16-G,H<24-G)||(ce|=P[K+3]<<24-G),ce&X}function Mt(P,q,H){var G=q&7,K=q>>>3;return G<=5?P[K]|=(H&7)<<G:(P[K]|=H<<G&255,P[K+1]=(H&7)>>8-G),q+3}function Bt(P,q,H){var G=q&7,K=q>>>3;return H=(H&1)<<G,P[K]|=H,q+1}function xr(P,q,H){var G=q&7,K=q>>>3;return H<<=G,P[K]|=H&255,H>>>=8,P[K+1]=H,q+8}function Tn(P,q,H){var G=q&7,K=q>>>3;return H<<=G,P[K]|=H&255,H>>>=8,P[K+1]=H&255,P[K+2]=H>>>8,q+16}function Sn(P,q){var H=P.length,G=2*H>q?2*H:q+5,K=0;if(H>=q)return P;if(Ct){var X=C2(G);if(P.copy)P.copy(X);else for(;K<P.length;++K)X[K]=P[K];return X}else if(xe){var ce=new Uint8Array(G);if(ce.set)ce.set(P);else for(;K<H;++K)ce[K]=P[K];return ce}return P.length=G,P}function _r(P){for(var q=new Array(P),H=0;H<P;++H)q[H]=0;return q}function Rr(P,q,H){var G=1,K=0,X=0,ce=0,me=0,le=P.length,ue=xe?new Uint16Array(32):_r(32);for(X=0;X<32;++X)ue[X]=0;for(X=le;X<H;++X)P[X]=0;le=P.length;var fe=xe?new Uint16Array(le):_r(le);for(X=0;X<le;++X)ue[K=P[X]]++,G<K&&(G=K),fe[X]=0;for(ue[0]=0,X=1;X<=G;++X)ue[X+16]=me=me+ue[X-1]<<1;for(X=0;X<le;++X)me=P[X],me!=0&&(fe[X]=ue[me+16]++);var Ne=0;for(X=0;X<le;++X)if(Ne=P[X],Ne!=0)for(me=Y(fe[X],G)>>G-Ne,ce=(1<<G+4-Ne)-1;ce>=0;--ce)q[me|ce<<Ne]=Ne&15|X<<4;return G}var qn=xe?new Uint16Array(512):_r(512),as=xe?new Uint16Array(32):_r(32);if(!xe){for(var or=0;or<512;++or)qn[or]=0;for(or=0;or<32;++or)as[or]=0}(function(){for(var P=[],q=0;q<32;q++)P.push(5);Rr(P,as,32);var H=[];for(q=0;q<=143;q++)H.push(8);for(;q<=255;q++)H.push(9);for(;q<=279;q++)H.push(7);for(;q<=287;q++)H.push(8);Rr(H,qn,288)})();var Zr=(function(){for(var q=xe?new Uint8Array(32768):[],H=0,G=0;H<_e.length-1;++H)for(;G<_e[H+1];++G)q[G]=H;for(;G<32768;++G)q[G]=29;var K=xe?new Uint8Array(259):[];for(H=0,G=0;H<oe.length-1;++H)for(;G<oe[H+1];++G)K[G]=H;function X(me,le){for(var ue=0;ue<me.length;){var fe=Math.min(65535,me.length-ue),Ne=ue+fe==me.length;for(le.write_shift(1,+Ne),le.write_shift(2,fe),le.write_shift(2,~fe&65535);fe-- >0;)le[le.l++]=me[ue++]}return le.l}function ce(me,le){for(var ue=0,fe=0,Ne=xe?new Uint16Array(32768):[];fe<me.length;){var Ue=Math.min(65535,me.length-fe);if(Ue<10){for(ue=Mt(le,ue,+(fe+Ue==me.length)),ue&7&&(ue+=8-(ue&7)),le.l=ue/8|0,le.write_shift(2,Ue),le.write_shift(2,~Ue&65535);Ue-- >0;)le[le.l++]=me[fe++];ue=le.l*8;continue}ue=Mt(le,ue,+(fe+Ue==me.length)+2);for(var Ge=0;Ue-- >0;){var Oe=me[fe];Ge=(Ge<<5^Oe)&32767;var Pe=-1,ft=0;if((Pe=Ne[Ge])&&(Pe|=fe&-32768,Pe>fe&&(Pe-=32768),Pe<fe))for(;me[Pe+ft]==me[fe+ft]&&ft<250;)++ft;if(ft>2){Oe=K[ft],Oe<=22?ue=xr(le,ue,Te[Oe+1]>>1)-1:(xr(le,ue,3),ue+=5,xr(le,ue,Te[Oe-23]>>5),ue+=3);var $t=Oe<8?0:Oe-4>>2;$t>0&&(Tn(le,ue,ft-oe[Oe]),ue+=$t),Oe=q[fe-Pe],ue=xr(le,ue,Te[Oe]>>3),ue-=3;var Qt=Oe<4?0:Oe-2>>1;Qt>0&&(Tn(le,ue,fe-Pe-_e[Oe]),ue+=Qt);for(var lr=0;lr<ft;++lr)Ne[Ge]=fe&32767,Ge=(Ge<<5^me[fe])&32767,++fe;Ue-=ft-1}else Oe<=143?Oe=Oe+48:ue=Bt(le,ue,1),ue=xr(le,ue,Te[Oe]),Ne[Ge]=fe&32767,++fe}ue=xr(le,ue,0)-1}return le.l=(ue+7)/8|0,le.l}return function(le,ue){return le.length<8?X(le,ue):ce(le,ue)}})();function ot(P){var q=ge(50+Math.floor(P.length*1.1)),H=Zr(P,q);return q.slice(0,H)}var jt=xe?new Uint16Array(32768):_r(32768),Gr=xe?new Uint16Array(32768):_r(32768),Yt=xe?new Uint16Array(128):_r(128),kn=1,ni=1;function Kn(P,q){var H=xt(P,q)+257;q+=5;var G=xt(P,q)+1;q+=5;var K=Lt(P,q)+4;q+=4;for(var X=0,ce=xe?new Uint8Array(19):_r(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,ue=xe?new Uint8Array(8):_r(8),fe=xe?new Uint8Array(8):_r(8),Ne=ce.length,Ue=0;Ue<K;++Ue)ce[Z[Ue]]=X=wt(P,q),le<X&&(le=X),ue[X]++,q+=3;var Ge=0;for(ue[0]=0,Ue=1;Ue<=le;++Ue)fe[Ue]=Ge=Ge+ue[Ue-1]<<1;for(Ue=0;Ue<Ne;++Ue)(Ge=ce[Ue])!=0&&(me[Ue]=fe[Ge]++);var Oe=0;for(Ue=0;Ue<Ne;++Ue)if(Oe=ce[Ue],Oe!=0){Ge=Te[me[Ue]]>>8-Oe;for(var Pe=(1<<7-Oe)-1;Pe>=0;--Pe)Yt[Ge|Pe<<Oe]=Oe&7|Ue<<3}var ft=[];for(le=1;ft.length<H+G;)switch(Ge=Yt[je(P,q)],q+=Ge&7,Ge>>>=3){case 16:for(X=3+At(P,q),q+=2,Ge=ft[ft.length-1];X-- >0;)ft.push(Ge);break;case 17:for(X=3+wt(P,q),q+=3;X-- >0;)ft.push(0);break;case 18:for(X=11+je(P,q),q+=7;X-- >0;)ft.push(0);break;default:ft.push(Ge),le<Ge&&(le=Ge);break}var $t=ft.slice(0,H),Qt=ft.slice(H);for(Ue=H;Ue<286;++Ue)$t[Ue]=0;for(Ue=G;Ue<30;++Ue)Qt[Ue]=0;return kn=Rr($t,jt,286),ni=Rr(Qt,Gr,30),q}function si(P,q){if(P[0]==3&&!(P[1]&3))return[wo(q),2];for(var H=0,G=0,K=C2(q||1<<18),X=0,ce=K.length>>>0,me=0,le=0;(G&1)==0;){if(G=wt(P,H),H+=3,G>>>1)G>>1==1?(me=9,le=5):(H=Kn(P,H),me=kn,le=ni);else{H&7&&(H+=8-(H&7));var ue=P[H>>>3]|P[(H>>>3)+1]<<8;if(H+=32,ue>0)for(!q&&ce<X+ue&&(K=Sn(K,X+ue),ce=K.length);ue-- >0;)K[X++]=P[H>>>3],H+=8;continue}for(;;){!q&&ce<X+32767&&(K=Sn(K,X+32767),ce=K.length);var fe=Zt(P,H,me),Ne=G>>>1==1?qn[fe]:jt[fe];if(H+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)K[X++]=Ne;else{if(Ne==256)break;Ne-=257;var Ue=Ne<8?0:Ne-4>>2;Ue>5&&(Ue=0);var Ge=X+oe[Ne];Ue>0&&(Ge+=Zt(P,H,Ue),H+=Ue),fe=Zt(P,H,le),Ne=G>>>1==1?as[fe]:Gr[fe],H+=Ne&15,Ne>>>=4;var Oe=Ne<4?0:Ne-2>>1,Pe=_e[Ne];for(Oe>0&&(Pe+=Zt(P,H,Oe),H+=Oe),!q&&ce<Ge&&(K=Sn(K,Ge+100),ce=K.length);X<Ge;)K[X]=K[X-Pe],++X}}}return q?[K,H+7>>>3]:[K.slice(0,X),H+7>>>3]}function ws(P,q){var H=P.slice(P.l||0),G=si(H,q);return P.l+=G[1],G[0]}function Vs(P,q){if(P)typeof console<"u"&&console.error(q);else throw new Error(q)}function Qe(P,q){var H=P;vn(H,0);var G=[],K=[],X={FileIndex:G,FullPaths:K};A(X,{root:q.root});for(var ce=H.length-4;(H[ce]!=80||H[ce+1]!=75||H[ce+2]!=5||H[ce+3]!=6)&&ce>=0;)--ce;H.l=ce+4,H.l+=4;var me=H.read_shift(2);H.l+=6;var le=H.read_shift(4);for(H.l=le,ce=0;ce<me;++ce){H.l+=20;var ue=H.read_shift(4),fe=H.read_shift(4),Ne=H.read_shift(2),Ue=H.read_shift(2),Ge=H.read_shift(2);H.l+=8;var Oe=H.read_shift(4),Pe=c(H.slice(H.l+Ne,H.l+Ne+Ue));H.l+=Ne+Ue+Ge;var ft=H.l;H.l=Oe+4,Xn(H,ue,fe,X,Pe),H.l=ft}return X}function Xn(P,q,H,G,K){P.l+=2;var X=P.read_shift(2),ce=P.read_shift(2),me=o(P);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var le=P.read_shift(4),ue=P.read_shift(4),fe=P.read_shift(4),Ne=P.read_shift(2),Ue=P.read_shift(2),Ge="",Oe=0;Oe<Ne;++Oe)Ge+=String.fromCharCode(P[P.l++]);if(Ue){var Pe=c(P.slice(P.l,P.l+Ue));(Pe[21589]||{}).mt&&(me=Pe[21589].mt),((K||{})[21589]||{}).mt&&(me=K[21589].mt)}P.l+=Ue;var ft=P.slice(P.l,P.l+ue);switch(ce){case 8:ft=te(P,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var $t=!1;X&8&&(le=P.read_shift(4),le==134695760&&(le=P.read_shift(4),$t=!0),ue=P.read_shift(4),fe=P.read_shift(4)),ue!=q&&Vs($t,"Bad compressed size: "+q+" != "+ue),fe!=H&&Vs($t,"Bad uncompressed size: "+H+" != "+fe),Cn(G,Ge,ft,{unsafe:!0,mt:me})}function Rt(P,q){var H=q||{},G=[],K=[],X=ge(1),ce=H.compression?8:0,me=0,le=0,ue=0,fe=0,Ne=0,Ue=P.FullPaths[0],Ge=Ue,Oe=P.FileIndex[0],Pe=[],ft=0;for(le=1;le<P.FullPaths.length;++le)if(Ge=P.FullPaths[le].slice(Ue.length),Oe=P.FileIndex[le],!(!Oe.size||!Oe.content||Ge=="Sh33tJ5")){var $t=fe,Qt=ge(Ge.length);for(ue=0;ue<Ge.length;++ue)Qt.write_shift(1,Ge.charCodeAt(ue)&127);Qt=Qt.slice(0,Qt.l),Pe[Ne]=rD.buf(Oe.content,0);var lr=Oe.content;ce==8&&(lr=J(lr)),X=ge(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,me),X.write_shift(2,ce),Oe.mt?i(X,Oe.mt):X.write_shift(4,0),X.write_shift(-4,Pe[Ne]),X.write_shift(4,lr.length),X.write_shift(4,Oe.content.length),X.write_shift(2,Qt.length),X.write_shift(2,0),fe+=X.length,G.push(X),fe+=Qt.length,G.push(Qt),fe+=lr.length,G.push(lr),X=ge(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,me),X.write_shift(2,ce),X.write_shift(4,0),X.write_shift(-4,Pe[Ne]),X.write_shift(4,lr.length),X.write_shift(4,Oe.content.length),X.write_shift(2,Qt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,$t),ft+=X.l,K.push(X),ft+=Qt.length,K.push(Qt),++Ne}return X=ge(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Ne),X.write_shift(2,Ne),X.write_shift(4,ft),X.write_shift(4,fe),X.write_shift(2,0),an([an(G),an(K),X])}var qr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function An(P,q){if(P.ctype)return P.ctype;var H=P.name||"",G=H.match(/\.([^\.]+)$/);return G&&qr[G[1]]||q&&(G=(H=q).match(/[\.\\]([^\.\\])+$/),G&&qr[G[1]])?qr[G[1]]:"application/octet-stream"}function Bs(P){for(var q=ff(P),H=[],G=0;G<q.length;G+=76)H.push(q.slice(G,G+76));return H.join(`\r
`)+`\r
`}function Yn(P){var q=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ue){var fe=ue.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});q=q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),q.charAt(0)==`
`&&(q="=0D"+q.slice(1)),q=q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],G=q.split(`\r
`),K=0;K<G.length;++K){var X=G[K];if(X.length==0){H.push("");continue}for(var ce=0;ce<X.length;){var me=76,le=X.slice(ce,ce+me);le.charAt(me-1)=="="?me--:le.charAt(me-2)=="="?me-=2:le.charAt(me-3)=="="&&(me-=3),le=X.slice(ce,ce+me),ce+=me,ce<X.length&&(le+="="),H.push(le)}}return H.join(`\r
`)}function ba(P){for(var q=[],H=0;H<P.length;++H){for(var G=P[H];H<=P.length&&G.charAt(G.length-1)=="=";)G=G.slice(0,G.length-1)+P[++H];q.push(G)}for(var K=0;K<q.length;++K)q[K]=q[K].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Ps(q.join(`\r
`))}function ln(P,q,H){for(var G="",K="",X="",ce,me=0;me<10;++me){var le=q[me];if(!le||le.match(/^\s*$/))break;var ue=le.match(/^(.*?):\s*([^\s].*)$/);if(ue)switch(ue[1].toLowerCase()){case"content-location":G=ue[2].trim();break;case"content-type":X=ue[2].trim();break;case"content-transfer-encoding":K=ue[2].trim();break}}switch(++me,K.toLowerCase()){case"base64":ce=Ps(Ms(q.slice(me).join("")));break;case"quoted-printable":ce=ba(q.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var fe=Cn(P,G.slice(H.length),ce,{unsafe:!0});X&&(fe.ctype=X)}function Qn(P,q){if(ne(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=q&&q.root||"",G=(Ct&&Buffer.isBuffer(P)?P.toString("binary"):ne(P)).split(`\r
`),K=0,X="";for(K=0;K<G.length;++K)if(X=G[K],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),H||(H=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),X.slice(0,H.length)!=H););var ce=(G[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var me="--"+(ce[1]||""),le=[],ue=[],fe={FileIndex:le,FullPaths:ue};A(fe);var Ne,Ue=0;for(K=0;K<G.length;++K){var Ge=G[K];Ge!==me&&Ge!==me+"--"||(Ue++&&ln(fe,G.slice(Ne,K),H),Ne=K)}return fe}function cn(P,q){var H=q||{},G=H.boundary||"SheetJS";G="------="+G;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+G.slice(2)+'"',"","",""],X=P.FullPaths[0],ce=X,me=P.FileIndex[0],le=1;le<P.FullPaths.length;++le)if(ce=P.FullPaths[le].slice(X.length),me=P.FileIndex[le],!(!me.size||!me.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ft){return"_x"+ft.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ft){return"_u"+ft.charCodeAt(0).toString(16)+"_"});for(var ue=me.content,fe=Ct&&Buffer.isBuffer(ue)?ue.toString("binary"):ne(ue),Ne=0,Ue=Math.min(1024,fe.length),Ge=0,Oe=0;Oe<=Ue;++Oe)(Ge=fe.charCodeAt(Oe))>=32&&Ge<128&&++Ne;var Pe=Ne>=Ue*4/5;K.push(G),K.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+ce),K.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),K.push("Content-Type: "+An(me,ce)),K.push(""),K.push(Pe?Yn(fe):Bs(fe))}return K.push(G+`--\r
`),K.join(`\r
`)}function os(P){var q={};return A(q,P),q}function Cn(P,q,H,G){var K=G&&G.unsafe;K||A(P);var X=!K&&nt.find(P,q);if(!X){var ce=P.FullPaths[0];q.slice(0,ce.length)==ce?ce=q:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+q).replace("//","/")),X={name:s(q),type:2},P.FileIndex.push(X),P.FullPaths.push(ce),K||nt.utils.cfb_gc(P)}return X.content=H,X.size=H?H.length:0,G&&(G.CLSID&&(X.clsid=G.CLSID),G.mt&&(X.mt=G.mt),G.ct&&(X.ct=G.ct)),X}function Da(P,q){A(P);var H=nt.find(P,q);if(H){for(var G=0;G<P.FileIndex.length;++G)if(P.FileIndex[G]==H)return P.FileIndex.splice(G,1),P.FullPaths.splice(G,1),!0}return!1}function Es(P,q,H){A(P);var G=nt.find(P,q);if(G){for(var K=0;K<P.FileIndex.length;++K)if(P.FileIndex[K]==G)return P.FileIndex[K].name=s(H),P.FullPaths[K]=H,!0}return!1}function ls(P){I(P,!0)}return e.find=L,e.read=j,e.parse=d,e.write=we,e.writeFile=Ae,e.utils={cfb_new:os,cfb_add:Cn,cfb_del:Da,cfb_mov:Es,cfb_gc:ls,ReadShift:Wu,CheckField:GS,prep_blob:vn,bconcat:an,use_zlib:O,_deflateRaw:ot,_inflateRaw:ws,consts:Le},e})();function nD(t){return typeof t=="string"?Cd(t):Array.isArray(t)?Fb(t):t}function Uf(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Cd(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?ji(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([nD(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=Io(e)),c.write(e),c.close(),e}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+t)}function sD(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Fr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function O2(t,e){for(var r=[],n=Fr(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function Fd(t){for(var e=[],r=Fr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Rd(t){for(var e=[],r=Fr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function iD(t){for(var e=[],r=Fr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var X0=new Date(1899,11,30,0,0,0);function Jr(t,e){var r=t.getTime(),n=X0.getTime()+(t.getTimezoneOffset()-X0.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var kS=new Date,aD=X0.getTime()+(kS.getTimezoneOffset()-X0.getTimezoneOffset())*6e4,L2=kS.getTimezoneOffset();function Nd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+aD),e.getTimezoneOffset()!==L2&&e.setTime(e.getTime()+(e.getTimezoneOffset()-L2)*6e4),e}function oD(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var M2=new Date("2017-02-19T19:06:09.000Z"),AS=isNaN(M2.getFullYear())?new Date("2/19/17"):M2,lD=AS.getFullYear()==2017;function mr(t,e){var r=new Date(t);if(lD)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(AS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function ml(t,e){if(Ct&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ji(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ji(dS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ji(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ji(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function gr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=gr(t[r]));return e}function Ar(t,e){for(var r="";r.length<e;)r+=t;return r}function vi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var cD=["january","february","march","april","may","june","july","august","september","october","november","december"];function Nc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&cD.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var uD=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],c=1;c<i.length;++c)o.push(s),o.push(i[c]);return o}})();function CS(t){return t?t.content&&t.type?ml(t.content,!0):t.data?Ou(t.data):t.asNodeBuffer&&Ct?Ou(t.asNodeBuffer().toString("binary")):t.asBinary?Ou(t.asBinary()):t._data&&t._data.getContent?Ou(ml(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function IS(t){if(!t)return null;if(t.data)return k2(t.data);if(t.asNodeBuffer&&Ct)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?k2(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function fD(t){return t&&t.name.slice(-4)===".bin"?IS(t):CS(t)}function Qs(t,e){for(var r=t.FullPaths||Fr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function H1(t,e){var r=Qs(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function jr(t,e,r){if(!r)return fD(H1(t,e));if(!e)return null;try{return jr(t,e)}catch{return null}}function Os(t,e,r){if(!r)return CS(H1(t,e));if(!e)return null;try{return Os(t,e)}catch{return null}}function hD(t,e,r){return IS(H1(t,e))}function V2(t){for(var e=t.FullPaths||Fr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Tt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ct?n=Fa(r):n=Rb(r),nt.utils.cfb_add(t,e,n)}nt.utils.cfb_add(t,e,r)}else t.file(e,r)}function W1(){return nt.utils.cfb_new()}function FS(t,e){switch(e.type){case"base64":return nt.read(t,{type:"base64"});case"binary":return nt.read(t,{type:"binary"});case"buffer":case"array":return nt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Mu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Lr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,dD=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,B2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,pD=/<[^>]*>/g,Gn=Lr.match(B2)?B2:pD,mD=/<\w*:/,gD=/<(\/?)\w+:/;function pt(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var o=t.match(dD),c=0,u="",h=0,d="",g="",x=1;if(o)for(h=0;h!=o.length;++h){for(g=o[h],i=0;i!=g.length&&g.charCodeAt(i)!==61;++i);for(d=g.slice(0,i).trim();g.charCodeAt(i+1)==32;)++i;for(x=(s=g.charCodeAt(i+1))==34||s==39?1:0,u=g.slice(i+1+x,g.length-x),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var _=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(n[_]&&d.slice(c-3,c)=="ext")continue;n[_]=u,n[_.toLowerCase()]=u}}return n}function Yi(t){return t.replace(gD,"<$1")}var RS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$1=Fd(RS),Ht=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(c,u){return RS[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,u){return String.fromCharCode(parseInt(u,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}})(),G1=/[&<>'"]/g,xD=/[\u0000-\u0008\u000b-\u001f]/g;function nr(t){var e=t+"";return e.replace(G1,function(r){return $1[r]}).replace(xD,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function U2(t){return nr(t).replace(/ /g,"_x0020_")}var NS=/[\u0000-\u001f]/g;function q1(t){var e=t+"";return e.replace(G1,function(r){return $1[r]}).replace(/\n/g,"<br/>").replace(NS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function vD(t){var e=t+"";return e.replace(G1,function(r){return $1[r]}).replace(NS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var j2=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function _D(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function dr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Am(t){for(var e="",r=0,n=0,s=0,i=0,o=0,c=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,e+=String.fromCharCode(o);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}o=t.charCodeAt(r++),c=((n&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function z2(t){var e=wo(2*t.length),r,n,s=1,i=0,o=0,c;for(n=0;n<t.length;n+=s)s=1,(c=t.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(t.charCodeAt(n+1)&63),s=2):c<240?(r=(c&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(c&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function H2(t){return Fa(t,"binary").toString("utf8")}var i0="foo bar baz",ir=Ct&&(H2(i0)==Am(i0)&&H2||z2(i0)==Am(i0)&&z2)||Am,ji=Ct?function(t){return Fa(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},df=(function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),bS=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}})(),yD=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),wD=/<\/?(?:vt:)?variant>/g,ED=/<(?:vt:)([^>]*)>([\s\S]*)</;function W2(t,e){var r=pt(t),n=t.match(yD(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var o=i.replace(wD,"").match(ED);o&&s.push({v:ir(o[2]),t:o[1]})}),s}var DS=/(^\s|\s$|\n)/;function yn(t,e){return"<"+t+(e.match(DS)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function pf(t){return Fr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function He(t,e,r){return"<"+t+(r!=null?pf(r):"")+(e!=null?(e.match(DS)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function _g(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function TD(t,e){switch(typeof t){case"string":var r=He("vt:lpwstr",nr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return He((t|0)==t?"vt:i4":"vt:r8",nr(String(t)));case"boolean":return He("vt:bool",t?"true":"false")}if(t instanceof Date)return He("vt:filetime",_g(t));throw new Error("Unable to serialize "+t)}function K1(t){if(Ct&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return ir(Io(U1(t)));throw new Error("Bad input format: expected Buffer or string")}var mf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Yr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},El=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],bs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function SD(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function kD(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,o=n?-e:e;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var c=0;c<=5;++c,i/=256)t[r+c]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var $2=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},G2=Ct?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Fa(e)})):$2(t)}:$2,q2=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(ma(t,s)));return n.join("").replace(is,"")},X1=Ct?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(is,""):q2(t,e,r)}:q2,K2=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},PS=Ct?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):K2(t,e,r)}:K2,X2=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(hc(t,s)));return n.join("")},jf=Ct?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):X2(e,r,n)}:X2,OS=function(t,e){var r=Ds(t,e);return r>0?jf(t,e+4,e+4+r-1):""},LS=OS,MS=function(t,e){var r=Ds(t,e);return r>0?jf(t,e+4,e+4+r-1):""},VS=MS,BS=function(t,e){var r=2*Ds(t,e);return r>0?jf(t,e+4,e+4+r-1):""},US=BS,jS=function(e,r){var n=Ds(e,r);return n>0?X1(e,r+4,r+4+n):""},zS=jS,HS=function(t,e){var r=Ds(t,e);return r>0?jf(t,e+4,e+4+r):""},WS=HS,$S=function(t,e){return SD(t,e)},Y0=$S,Y1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ct&&(LS=function(e,r){if(!Buffer.isBuffer(e))return OS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},VS=function(e,r){if(!Buffer.isBuffer(e))return MS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},US=function(e,r){if(!Buffer.isBuffer(e))return BS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},zS=function(e,r){if(!Buffer.isBuffer(e))return jS(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},WS=function(e,r){if(!Buffer.isBuffer(e))return HS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Y0=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):$S(e,r)},Y1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var hc=function(t,e){return t[e]},ma=function(t,e){return t[e+1]*256+t[e]},AD=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Ds=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Xo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},CD=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Wu(t,e){var r="",n,s,i=[],o,c,u,h;switch(e){case"dbcs":if(h=this.l,Ct&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(u=0;u<t;++u)r+=String.fromCharCode(ma(this,h)),h+=2;t*=2;break;case"utf8":r=jf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=X1(this,this.l,this.l+t);break;case"wstr":return Wu.call(this,t,"dbcs");case"lpstr-ansi":r=LS(this,this.l),t=4+Ds(this,this.l);break;case"lpstr-cp":r=VS(this,this.l),t=4+Ds(this,this.l);break;case"lpwstr":r=US(this,this.l),t=4+2*Ds(this,this.l);break;case"lpp4":t=4+Ds(this,this.l),r=zS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ds(this,this.l),r=WS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=hc(this,this.l+t++))!==0;)i.push(s0(o));r=i.join("");break;case"_wstr":for(t=0,r="";(o=ma(this,this.l+t))!==0;)i.push(s0(o)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",h=this.l,u=0;u<t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=hc(this,h),this.l=h+1,c=Wu.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(s0(ma(this,h))),h+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,u=0;u!=t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=hc(this,h),this.l=h+1,c=Wu.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(s0(hc(this,h))),h+=1}r=i.join("");break;default:switch(t){case 1:return n=hc(this,this.l),this.l++,n;case 2:return n=(e==="i"?AD:ma)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Xo:CD)(this,this.l),this.l+=4,n):(s=Ds(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=Y0(this,this.l):s=Y0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=PS(this,this.l,t);break}}return this.l+=t,r}var ID=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},FD=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},RD=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function ND(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)RD(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var o=e.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,ID(this,e,this.l);break;case 8:if(n=8,r==="f"){kD(this,e,this.l);break}case 16:break;case-4:n=4,FD(this,e,this.l);break}return this.l+=n,this}function GS(t,e){var r=PS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function vn(t,e){t.l=e,t.read_shift=Wu,t.chk=GS,t.write_shift=ND}function $n(t,e){t.l+=e}function ge(t){var e=wo(t);return vn(e,0),e}function Ra(t,e,r){if(t){var n,s,i;vn(t,t.l||0);for(var o=t.length,c=0,u=0;t.l<o;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var h=wf[c]||wf[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;u=t.l+i;var d=h.f&&h.f(t,i,r);if(t.l=u,e(d,h,c))return}}}function _s(){var t=[],e=Ct?256:2048,r=function(h){var d=ge(h);return vn(d,0),d},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(h){return n&&h<n.length-n.l?n:(s(),n=r(Math.max(h+1,e)))},o=function(){return s(),an(t)},c=function(h){s(),n=h,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:c,end:o,_bufs:t}}function Ce(t,e,r,n){var s=+e,i;if(!isNaN(s)){n||(n=wf[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=t.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var c=0;c!=4;++c)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Y1(r)&&t.push(r)}}function $u(t,e,r){var n=gr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Y2(t,e,r){var n=gr(t);return n.s=$u(n.s,e.s,r),n.e=$u(n.e,e.s,r),n}function Gu(t,e){if(t.cRel&&t.c<0)for(t=gr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=gr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ht(t);return!t.cRel&&t.cRel!=null&&(r=PD(r)),!t.rRel&&t.rRel!=null&&(r=bD(r)),r}function Cm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Er(t.s.c)+":"+(t.e.cRel?"":"$")+Er(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Or(t.s.r)+":"+(t.e.rRel?"":"$")+Or(t.e.r):Gu(t.s,e.biff)+":"+Gu(t.e,e.biff)}function Q1(t){return parseInt(DD(t),10)-1}function Or(t){return""+(t+1)}function bD(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function DD(t){return t.replace(/\$(\d+)$/,"$1")}function J1(t){for(var e=OD(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Er(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function PD(t){return t.replace(/^([A-Z])/,"$$$1")}function OD(t){return t.replace(/^\$([A-Z])/,"$1")}function LD(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tr(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function ht(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ys(t){var e=t.indexOf(":");return e==-1?{s:Tr(t),e:Tr(t)}:{s:Tr(t.slice(0,e)),e:Tr(t.slice(e+1))}}function Et(t,e){return typeof e>"u"||typeof e=="number"?Et(t.s,t.e):(typeof t!="string"&&(t=ht(t)),typeof e!="string"&&(e=ht(e)),t==e?t:t+":"+e)}function Wt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function Q2(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ti(t.z,r?Jr(e):e)}catch{}try{return t.w=ti((t.XF||{}).numFmtId||(r?14:0),r?Jr(e):e)}catch{return""+e}}function Aa(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Na[t.v]||t.v:e==null?Q2(t,t.v):Q2(t,e))}function Fo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function qS(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),o=0,c=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Tr(n.origin):n.origin;o=u.r,c=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Wt(i["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),o==-1&&(h.e.r=o=d.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[g].length;++x)if(!(typeof e[g][x]>"u")){var _={v:e[g][x]},k=o+g,y=c+x;if(h.s.r>k&&(h.s.r=k),h.s.c>y&&(h.s.c=y),h.e.r<k&&(h.e.r=k),h.e.c<y&&(h.e.c=y),e[g][x]&&typeof e[g][x]=="object"&&!Array.isArray(e[g][x])&&!(e[g][x]instanceof Date))_=e[g][x];else if(Array.isArray(_.v)&&(_.f=e[g][x][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||ct[14],n.cellDates?(_.t="d",_.w=ti(_.z,Jr(_.v))):(_.t="n",_.v=Jr(_.v),_.w=ti(_.z,_.v))):_.t="s";if(s)i[k]||(i[k]=[]),i[k][y]&&i[k][y].z&&(_.z=i[k][y].z),i[k][y]=_;else{var S=ht({c:y,r:k});i[S]&&i[S].z&&(_.z=i[S].z),i[S]=_}}}return h.s.c<1e7&&(i["!ref"]=Et(h)),i}function Wc(t,e){return qS(null,t,e)}function MD(t){return t.read_shift(4,"i")}function _i(t,e){return e||(e=ge(4)),e.write_shift(4,t),e}function Hn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function on(t,e){var r=!1;return e==null&&(r=!0,e=ge(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function VD(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function BD(t,e){return e||(e=ge(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Z1(t,e){var r=t.l,n=t.read_shift(1),s=Hn(t),i=[],o={t:s,h:s};if((n&1)!==0){for(var c=t.read_shift(4),u=0;u!=c;++u)i.push(VD(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function UD(t,e){var r=!1;return e==null&&(r=!0,e=ge(15+4*t.t.length)),e.write_shift(1,0),on(t.t,e),r?e.slice(0,e.l):e}var jD=Z1;function zD(t,e){var r=!1;return e==null&&(r=!0,e=ge(23+4*t.t.length)),e.write_shift(1,1),on(t.t,e),e.write_shift(4,1),BD({},e),r?e.slice(0,e.l):e}function ri(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Tl(t,e){return e==null&&(e=ge(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Sl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function kl(t,e){return e==null&&(e=ge(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var HD=Hn,KS=on;function ex(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Q0(t,e){var r=!1;return e==null&&(r=!0,e=ge(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var WD=Hn,yg=ex,tx=Q0;function rx(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?Y0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Xo(e,0)>>2;return r?s/100:s}function XS(t,e){e==null&&(e=ge(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function YS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function $D(t,e){return e||(e=ge(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Al=YS,$c=$D;function zn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function gl(t,e){return(e||ge(8)).write_shift(8,t,"f")}function GD(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),c=t.read_shift(1),u=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var h=rl[s];h&&(e.rgb=xf(h));break;case 2:e.rgb=xf([o,c,u]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function J0(t,e){if(e||(e=ge(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function qD(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function KD(t,e){e||(e=ge(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function QS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function XD(t){return QS(t,1)}function YD(t){return QS(t,2)}var nx=2,gs=3,a0=11,J2=12,Z0=19,o0=64,QD=65,JD=71,ZD=4108,eP=4126,sn=80,JS=81,tP=[sn,JS],wg={1:{n:"CodePage",t:nx},2:{n:"Category",t:sn},3:{n:"PresentationFormat",t:sn},4:{n:"ByteCount",t:gs},5:{n:"LineCount",t:gs},6:{n:"ParagraphCount",t:gs},7:{n:"SlideCount",t:gs},8:{n:"NoteCount",t:gs},9:{n:"HiddenCount",t:gs},10:{n:"MultimediaClipCount",t:gs},11:{n:"ScaleCrop",t:a0},12:{n:"HeadingPairs",t:ZD},13:{n:"TitlesOfParts",t:eP},14:{n:"Manager",t:sn},15:{n:"Company",t:sn},16:{n:"LinksUpToDate",t:a0},17:{n:"CharacterCount",t:gs},19:{n:"SharedDoc",t:a0},22:{n:"HyperlinksChanged",t:a0},23:{n:"AppVersion",t:gs,p:"version"},24:{n:"DigSig",t:QD},26:{n:"ContentType",t:sn},27:{n:"ContentStatus",t:sn},28:{n:"Language",t:sn},29:{n:"Version",t:sn},255:{},2147483648:{n:"Locale",t:Z0},2147483651:{n:"Behavior",t:Z0},1919054434:{}},Eg={1:{n:"CodePage",t:nx},2:{n:"Title",t:sn},3:{n:"Subject",t:sn},4:{n:"Author",t:sn},5:{n:"Keywords",t:sn},6:{n:"Comments",t:sn},7:{n:"Template",t:sn},8:{n:"LastAuthor",t:sn},9:{n:"RevNumber",t:sn},10:{n:"EditTime",t:o0},11:{n:"LastPrinted",t:o0},12:{n:"CreatedDate",t:o0},13:{n:"ModifiedDate",t:o0},14:{n:"PageCount",t:gs},15:{n:"WordCount",t:gs},16:{n:"CharCount",t:gs},17:{n:"Thumbnail",t:JD},18:{n:"Application",t:sn},19:{n:"DocSecurity",t:gs},255:{},2147483648:{n:"Locale",t:Z0},2147483651:{n:"Behavior",t:Z0},1919054434:{}},Z2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},rP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function nP(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var sP=nP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rl=gr(sP),Na={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ZS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Tg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},l0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function sx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function iP(t){var e=sx();if(!t||!t.match)return e;var r={};if((t.match(Gn)||[]).forEach(function(n){var s=pt(n);switch(s[0].replace(mD,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[Tg[s.ContentType]]!==void 0&&e[Tg[s.ContentType]].push(s.PartName);break}}),e.xmlns!==Yr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function ek(t,e){var r=iD(Tg),n=[],s;n[n.length]=Lr,n[n.length]=He("Types",null,{xmlns:Yr.CT,"xmlns:xsd":Yr.xsd,"xmlns:xsi":Yr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return He("Default",null,{Extension:u[0],ContentType:u[1]})}));var i=function(u){t[u]&&t[u].length>0&&(s=t[u][0],n[n.length]=He("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:l0[u][e.bookType]||l0[u].xlsx}))},o=function(u){(t[u]||[]).forEach(function(h){n[n.length]=He("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:l0[u][e.bookType]||l0[u].xlsx})})},c=function(u){(t[u]||[]).forEach(function(h){n[n.length]=He("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[u][0]})})};return i("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ft={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function gf(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function qu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Gn)||[]).forEach(function(s){var i=pt(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:Mu(i.Target,e);r[c]=o,n[i.Id]=o}}),r["!id"]=n,r}function yc(t){var e=[Lr,He("Relationships",null,{xmlns:Yr.RELS})];return Fr(t["!id"]).forEach(function(r){e[e.length]=He("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function rr(t,e,r,n,s,i){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[Ft.HLINK,Ft.XPATH,Ft.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var aP="application/vnd.oasis.opendocument.spreadsheet";function oP(t,e){for(var r=K1(t),n,s;n=mf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=pt(n[0],!1),s.path=="/"&&s.type!==aP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function lP(t){var e=[Lr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function ew(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function cP(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function uP(t){var e=[Lr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(ew(t[r][0],t[r][1])),e.push(cP("",t[r][0]));return e.push(ew("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function tk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+$0.version+"</meta:generator></office:meta></office:document-meta>"}var ei=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],fP=(function(){for(var t=new Array(ei.length),e=0;e<ei.length;++e){var r=ei[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function rk(t){var e={};t=ir(t);for(var r=0;r<ei.length;++r){var n=ei[r],s=t.match(fP[r]);s!=null&&s.length>0&&(e[n[1]]=Ht(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=mr(e[n[1]]))}return e}function Im(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=nr(e),n[n.length]=r?He(t,e,r):yn(t,e))}function nk(t,e){var r=e||{},n=[Lr,He("cp:coreProperties",null,{"xmlns:cp":Yr.CORE_PROPS,"xmlns:dc":Yr.dc,"xmlns:dcterms":Yr.dcterms,"xmlns:dcmitype":Yr.dcmitype,"xmlns:xsi":Yr.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Im("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:_g(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&Im("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:_g(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=ei.length;++i){var o=ei[i],c=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Im(o[0],c,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var nl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],sk=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ik(t,e,r,n){var s=[];if(typeof t=="string")s=W2(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(d){return{v:d}}));var o=typeof e=="string"?W2(e,n).map(function(d){return d.v}):e,c=0,u=0;if(o.length>0)for(var h=0;h!==s.length;h+=2){switch(u=+s[h+1].v,s[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(c,c+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(c,c+u);break}c+=u}}function hP(t,e,r){var n={};return e||(e={}),t=ir(t),nl.forEach(function(s){var i=(t.match(df(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=Ht(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var o=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ik(n.HeadingPairs,n.TitlesOfParts,e,r),e}function ak(t){var e=[],r=He;return t||(t={}),t.Application="SheetJS",e[e.length]=Lr,e[e.length]=He("Properties",null,{xmlns:Yr.EXT_PROPS,"xmlns:vt":Yr.vt}),nl.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=nr(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+nr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var dP=/<[^>]+>[^<]*/g;function pP(t,e){var r={},n="",s=t.match(dP);if(s)for(var i=0;i!=s.length;++i){var o=s[i],c=pt(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ht(c.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),h=u[0].slice(4),d=u[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[n]=Ht(d);break;case"bool":r[n]=dr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=mr(d);break;case"cy":case"error":r[n]=Ht(d);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,u)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function ok(t){var e=[Lr,He("Properties",null,{xmlns:Yr.CUST_PROPS,"xmlns:vt":Yr.vt})];if(!t)return e.join("");var r=1;return Fr(t).forEach(function(s){++r,e[e.length]=He("property",TD(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:nr(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Sg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Fm;function mP(t,e,r){Fm||(Fm=Fd(Sg)),e=Fm[e]||e,t[e]=r}function gP(t,e){var r=[];return Fr(Sg).map(function(n){for(var s=0;s<ei.length;++s)if(ei[s][1]==n)return ei[s];for(s=0;s<nl.length;++s)if(nl[s][1]==n)return nl[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(yn(Sg[n[1]]||n[1],s))}}),He("DocumentProperties",r.join(""),{xmlns:bs.o})}function xP(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&Fr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<ei.length;++o)if(i==ei[o][1])return;for(o=0;o<nl.length;++o)if(i==nl[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var c=t[i],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c=String(c),s.push(He(U2(i),c,{"dt:dt":u}))}}),e&&Fr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),s.push(He(U2(i),o,{"dt:dt":c}))}}),"<"+n+' xmlns="'+bs.o+'">'+s.join("")+"</"+n+">"}function ix(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function vP(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var o=ge(8);return o.write_shift(4,n),o.write_shift(4,s),o}function lk(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function ck(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function uk(t,e,r){return e===31?ck(t):lk(t,e,r)}function kg(t,e,r){return uk(t,e,r===!1?0:4)}function _P(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return uk(t,e,0)}function yP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(is,""),t.l-s&2&&(t.l+=2)}return r}function wP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(is,"");return r}function EP(t){var e=t.l,r=ed(t,JS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=ed(t,gs);return[r,n]}function TP(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(EP(t));return r}function tw(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),o=t.read_shift(4);n[i]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(is,"").replace(Lu,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function fk(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function SP(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function ed(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==J2&&n!==e&&tP.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===J2?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return lk(t,n,4).replace(is,"");case 31:return ck(t);case 64:return ix(t);case 65:return fk(t);case 71:return SP(t);case 80:return kg(t,n,!i.raw).replace(is,"");case 81:return _P(t,n).replace(is,"");case 4108:return TP(t);case 4126:case 4127:return n==4127?yP(t):wP(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function rw(t,e){var r=ge(4),n=ge(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ge(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=vP(e);break;case 31:case 80:for(n=ge(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return an([r,n])}function nw(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],o=0,c=0,u=-1,h={};for(o=0;o!=s;++o){var d=t.read_shift(4),g=t.read_shift(4);i[o]=[d,g+r]}i.sort(function(M,N){return M[1]-N[1]});var x={};for(o=0;o!=s;++o){if(t.l!==i[o][1]){var _=!0;if(o>0&&e)switch(e[i[o-1][0]].t){case 2:t.l+2===i[o][1]&&(t.l+=2,_=!1);break;case 80:t.l<=i[o][1]&&(t.l=i[o][1],_=!1);break;case 4108:t.l<=i[o][1]&&(t.l=i[o][1],_=!1);break}if((!e||o==0)&&t.l<=i[o][1]&&(_=!1,t.l=i[o][1]),_)throw new Error("Read Error: Expected address "+i[o][1]+" at "+t.l+" :"+o)}if(e){var k=e[i[o][0]];if(x[k.n]=ed(t,k.t,{raw:!0}),k.p==="version"&&(x[k.n]=String(x[k.n]>>16)+"."+("0000"+String(x[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(x[k.n]){case 0:x[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:mi(c=x[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[k.n])}}else if(i[o][0]===1){if(c=x.CodePage=ed(t,nx),mi(c),u!==-1){var y=t.l;t.l=i[u][1],h=tw(t,c),t.l=y}}else if(i[o][0]===0){if(c===0){u=o,t.l=i[o+1][1];continue}h=tw(t,c)}else{var S=h[i[o][0]],R;switch(t[t.l]){case 65:t.l+=4,R=fk(t);break;case 30:t.l+=4,R=kg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,R=kg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,R=t.read_shift(4,"i");break;case 19:t.l+=4,R=t.read_shift(4);break;case 5:t.l+=4,R=t.read_shift(8,"f");break;case 11:t.l+=4,R=Dr(t,4);break;case 64:t.l+=4,R=mr(ix(t));break;default:throw new Error("unparsed value: "+t[t.l])}x[S]=R}}return t.l=r+n,x}var hk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function kP(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function sw(t,e,r){var n=ge(8),s=[],i=[],o=8,c=0,u=ge(8),h=ge(8);if(u.write_shift(4,2),u.write_shift(4,1200),h.write_shift(4,1),i.push(u),s.push(h),o+=8+u.length,!e){h=ge(8),h.write_shift(4,0),s.unshift(h);var d=[ge(4)];for(d[0].write_shift(4,t.length),c=0;c<t.length;++c){var g=t[c][0];for(u=ge(8+2*(g.length+1)+(g.length%2?0:2)),u.write_shift(4,c+2),u.write_shift(4,g.length+1),u.write_shift(0,g,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=an(d),i.unshift(u),o+=8+u.length}for(c=0;c<t.length;++c)if(!(e&&!e[t[c][0]])&&!(hk.indexOf(t[c][0])>-1||sk.indexOf(t[c][0])>-1)&&t[c][1]!=null){var x=t[c][1],_=0;if(e){_=+e[t[c][0]];var k=r[_];if(k.p=="version"&&typeof x=="string"){var y=x.split(".");x=(+y[0]<<16)+(+y[1]||0)}u=rw(k.t,x)}else{var S=kP(x);S==-1&&(S=31,x=String(x)),u=rw(S,x)}i.push(u),h=ge(8),h.write_shift(4,e?_:2+c),s.push(h),o+=8+u.length}var R=8*(i.length+1);for(c=0;c<i.length;++c)s[c].write_shift(4,R),R+=i[c].length;return n.write_shift(4,o),n.write_shift(4,i.length),an([n].concat(s).concat(i))}function iw(t,e,r){var n=t.content;if(!n)return{};vn(n,0);var s,i,o,c,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),d=n.read_shift(16);if(d!==nt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),c=n.read_shift(4),s===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);s===2&&(o=n.read_shift(16),u=n.read_shift(4));var g=nw(n,e),x={SystemIdentifier:h};for(var _ in g)x[_]=g[_];if(x.FMTID=i,s===1)return x;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var k;try{k=nw(n,null)}catch{}for(_ in k)x[_]=k[_];return x.FMTID=[i,o],x}function aw(t,e,r,n,s,i){var o=ge(s?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,nt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,s?68:48);var u=sw(t,r,n);if(c.push(u),s){var h=sw(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+u.length),c.push(h)}return an(c)}function to(t,e){return t.read_shift(e),null}function AP(t,e){e||(e=ge(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function CP(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Dr(t,e){return t.read_shift(e)===1}function rs(t,e){return e||(e=ge(2)),e.write_shift(2,+!!t),e}function zr(t){return t.read_shift(2,"u")}function Js(t,e){return e||(e=ge(2)),e.write_shift(2,t),e}function dk(t,e){return CP(t,e,zr)}function IP(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function pk(t,e,r){return r||(r=ge(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function zf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?t.read_shift(n,s):"";return o}function FP(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),o=0,c,u={};s&&(o=t.read_shift(2)),n&&(c=t.read_shift(4));var h=i==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,h);return s&&(t.l+=4*o),n&&(t.l+=c),u.t=d,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function RP(t){var e=t.t||"",r=ge(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ge(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return an(s)}function xl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Hf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):xl(t,n,r)}function Cl(t,e,r){if(r.biff>5)return Hf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function mk(t,e,r){return r||(r=ge(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function NP(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function bP(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(is,"");return n&&(t.l+=24),s}function DP(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(i>>1,"utf16le").replace(is,"");return r+o}function PP(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return bP(t);case"0303000000000000c000000000000046":return DP(t);default:throw new Error("Unsupported Moniker "+r)}}function c0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(is,""):"";return r}function ow(t,e){e||(e=ge(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function OP(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,o,c,u,h="",d,g;s&16&&(i=c0(t,r-t.l)),s&128&&(o=c0(t,r-t.l)),(s&257)===257&&(c=c0(t,r-t.l)),(s&257)===1&&(u=PP(t,r-t.l)),s&8&&(h=c0(t,r-t.l)),s&32&&(d=t.read_shift(16)),s&64&&(g=ix(t)),t.l=r;var x=o||c||u||"";x&&h&&(x+="#"+h),x||(x="#"+h),s&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var _={Target:x};return d&&(_.guid=d),g&&(_.time=g),i&&(_.Tooltip=i),_}function LP(t){var e=ge(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(i==28)n=n.slice(1),ow(n,e);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var c=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)e.write_shift(2,c.charCodeAt(r));e.write_shift(2,0),i&8&&ow(s>-1?n.slice(s+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var u=0;n.slice(u*3,u*3+3)=="../"||n.slice(u*3,u*3+3)=="..\\";)++u;for(e.write_shift(2,u),e.write_shift(4,n.length-3*u+1),r=0;r<n.length-3*u;++r)e.write_shift(1,n.charCodeAt(r+3*u)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function gk(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function xk(t,e){var r=gk(t);return r[3]=0,r}function Qi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function vl(t,e,r,n){return n||(n=ge(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function MP(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function VP(t,e,r){return e===0?"":Cl(t,e,r)}function BP(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[s,i,o]}function vk(t){var e=t.read_shift(2),r=rx(t);return[e,r]}function UP(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=zf(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function bd(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function _k(t,e){return e||(e=ge(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function yk(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var jP=yk;function wk(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function zP(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function HP(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Pn(t){t.l+=2,t.l+=t.read_shift(2)}var WP={0:Pn,4:Pn,5:Pn,6:Pn,7:HP,8:Pn,9:Pn,10:Pn,11:Pn,12:Pn,13:zP,14:Pn,15:Pn,16:Pn,17:Pn,18:Pn,19:Pn,20:Pn,21:wk};function $P(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(WP[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function u0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function ax(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ge(s);return i.write_shift(2,n),i.write_shift(2,e),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function GP(t,e){return e===0||t.read_shift(2),1200}function qP(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Cl(t,0,r);return t.read_shift(e+n-t.l),s}function KP(t,e){var r=!e||e.biff==8,n=ge(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function XP(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function YP(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=zf(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:i,name:o}}function QP(t,e){var r=!e||e.biff>=8?2:1,n=ge(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function JP(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],o=0;o!=s&&t.l<r;++o)i.push(FP(t));return i.Count=n,i.Unique=s,i}function ZP(t,e){var r=ge(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=RP(t[s]);var i=an([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function e5(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function t5(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function r5(t){var e=MP(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function n5(t){return t.read_shift(2),t.read_shift(4)}function lw(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function s5(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:o,FirstTab:c,Selected:u,TabRatio:h}}function i5(){var t=ge(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function a5(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function o5(t){var e=ge(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function l5(){}function c5(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=zf(t,0,r),n}function u5(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,i=ge(s);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function f5(t){var e=Qi(t);return e.isst=t.read_shift(4),e}function h5(t,e,r,n){var s=ge(10);return vl(t,e,n,s),s.write_shift(4,r),s}function d5(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Qi(t);r.biff==2&&t.l++;var i=Hf(t,n-t.l,r);return s.val=i,s}function p5(t,e,r,n,s){var i=!s||s.biff==8,o=ge(8+ +i+(1+i)*r.length);return vl(t,e,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function m5(t,e,r){var n=t.read_shift(2),s=Cl(t,0,r);return[n,s]}function g5(t,e,r,n){var s=r&&r.biff==5;n||(n=ge(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var x5=Cl;function cw(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),o=t.read_shift(s),c=t.read_shift(2),u=t.read_shift(2);return t.l=n,{s:{r:i,c},e:{r:o,c:u}}}function v5(t,e){var r=e.biff==8||!e.biff?4:2,n=ge(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function _5(t){var e=t.read_shift(2),r=t.read_shift(2),n=vk(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function y5(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(vk(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:i}}function w5(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:i}}function E5(t,e,r,n){var s={},i=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(2);return s.patternType=rP[c>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=c&127,s.icvBottom=c>>7&127,s.icvDiag=c>>14&127,s.dgDiag=c>>21&15,s.icvFore=u&127,s.icvBack=u>>7&127,s.fsxButton=u>>14&1),s}function T5(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=E5(t,e,n.fStyle,r),n}function uw(t,e,r,n){var s=r&&r.biff==5;n||(n=ge(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function S5(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function k5(t){var e=ge(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function fw(t,e,r){var n=Qi(t);(r.biff==2||e==9)&&++t.l;var s=IP(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function A5(t,e,r,n,s,i){var o=ge(8);return vl(t,e,n,o),pk(r,i,o),o}function C5(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Qi(t),s=zn(t);return n.val=s,n}function I5(t,e,r,n){var s=ge(14);return vl(t,e,n,s),gl(r,s),s}var hw=VP;function F5(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=xl(t,i),c=[];n>t.l;)c.push(Hf(t));return[i,s,o,c]}function dw(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=UP(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var R5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function pw(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),u=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var h=xl(t,o,r);s&32&&(h=R5[h.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var g=n==t.l||c===0||!(d>0)?[]:$M(t,d,r,c);return{chKey:i,Name:h,itab:u,rgce:g}}function Ek(t,e,r){if(r.biff<8)return N5(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(BP(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function N5(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=zf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function b5(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=xl(t,n,r),o=xl(t,s,r);return[i,o]}function D5(t,e,r){var n=yk(t);t.l++;var s=t.read_shift(1);return e-=8,[GM(t,e,r),s,n]}function mw(t,e,r){var n=jP(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,HM(t,e,r)]}function P5(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function O5(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=Cl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},c,o,i]}}function L5(t,e,r){return O5(t,e,r)}function M5(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(bd(t));return r}function V5(t){var e=ge(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)_k(t[r],e);return e}function B5(t,e,r){if(r&&r.biff<8)return j5(t,e,r);var n=wk(t),s=$P(t,e-22,n[1]);return{cmo:n,ft:s}}var U5={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function j5(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((U5[n]||$n)(t,e,r)),{cmo:[s,n,i],ft:o}}function z5(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:o=NP(t,6,r);var c=t.read_shift(2);t.read_shift(2),zr(t,2);var u=t.read_shift(2);t.l+=u;for(var h=1;h<t.lens.length-1;++h){if(t.l-n!=t.lens[h])throw new Error("TxO: bad continue record");var d=t[t.l],g=xl(t,t.lens[h+1]-t.lens[h]-1);if(s+=g,s.length>=(d?c:2*c))break}if(s.length!==c&&s.length!==c*2)throw new Error("cchText: "+c+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function H5(t,e){var r=bd(t);t.l+=16;var n=OP(t,e-24);return[r,n]}function W5(t){var e=ge(24),r=Tr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return an([e,LP(t[1])])}function $5(t,e){t.read_shift(2);var r=bd(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(is,""),[r,n]}function G5(t){var e=t[1].Tooltip,r=ge(10+2*(e.length+1));r.write_shift(2,2048);var n=Tr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function q5(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Z2[r]||r,r=t.read_shift(2),e[1]=Z2[r]||r,e}function K5(t){return t||(t=ge(4)),t.write_shift(2,1),t.write_shift(2,1),t}function X5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(xk(t));return r}function Y5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(xk(t));return r}function Q5(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function Tk(t,e,r){if(!r.cellStyles)return $n(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(2);n==2&&(t.l+=2);var h={s,e:i,w:o,ixfe:c,flags:u};return(r.biff>=5||!r.biff)&&(h.level=u>>8&7),h}function J5(t,e){var r=ge(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Z5(t,e){var r={};return e<32||(t.l+=16,r.header=zn(t),r.footer=zn(t),t.l+=2),r}function e8(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function t8(t){for(var e=ge(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var r8=Qi,n8=dk,s8=Hf;function i8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function a8(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Qi(t);++t.l;var s=Cl(t,e-7,r);return n.t="str",n.val=s,n}function o8(t){var e=Qi(t);++t.l;var r=zn(t);return e.t="n",e.val=r,e}function l8(t,e,r){var n=ge(15);return qf(n,t,e),n.write_shift(8,r,"f"),n}function c8(t){var e=Qi(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function u8(t,e,r){var n=ge(9);return qf(n,t,e),n.write_shift(2,r),n}function f8(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function h8(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function d8(t,e,r){var n=t.l+e,s=Qi(t),i=t.read_shift(2),o=xl(t,i,r);return t.l=n,s.t="str",s.val=o,s}var p8=[2,3,48,49,131,139,140,245],Ag=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Fd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,u){var h=[],d=wo(1);switch(u.type){case"base64":d=Ps(Ms(c));break;case"binary":d=Ps(c);break;case"buffer":case"array":d=c;break}vn(d,0);var g=d.read_shift(1),x=!!(g&136),_=!1,k=!1;switch(g){case 2:break;case 3:break;case 48:_=!0,x=!0;break;case 49:_=!0,x=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var y=0,S=521;g==2&&(y=d.read_shift(2)),d.l+=3,g!=2&&(y=d.read_shift(4)),y>1048576&&(y=1e6),g!=2&&(S=d.read_shift(2));var R=d.read_shift(2),M=u.codepage||1252;g!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(M=t[d[d.l]]),d.l+=1,d.l+=2),k&&(d.l+=36);for(var N=[],V={},W=Math.min(d.length,g==2?521:S-10-(_?264:0)),j=k?32:11;d.l<W&&d[d.l]!=13;)switch(V={},V.name=uf.utils.decode(M,d.slice(d.l,d.l+j)).replace(/[\u0000\r\n].*$/g,""),d.l+=j,V.type=String.fromCharCode(d.read_shift(1)),g!=2&&!k&&(V.offset=d.read_shift(4)),V.len=d.read_shift(1),g==2&&(V.offset=d.read_shift(2)),V.dec=d.read_shift(1),V.name.length&&N.push(V),g!=2&&(d.l+=k?13:14),V.type){case"B":(!_||V.len!=8)&&u.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+V.type)}if(d[d.l]!==13&&(d.l=S-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=S;var A=0,F=0;for(h[0]=[],F=0;F!=N.length;++F)h[0][F]=N[F].name;for(;y-- >0;){if(d[d.l]===42){d.l+=R;continue}for(++d.l,h[++A]=[],F=0,F=0;F!=N.length;++F){var I=d.slice(d.l,d.l+N[F].len);d.l+=N[F].len,vn(I,0);var U=uf.utils.decode(M,I);switch(N[F].type){case"C":U.trim().length&&(h[A][F]=U.replace(/\s+$/,""));break;case"D":U.length===8?h[A][F]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):h[A][F]=U;break;case"F":h[A][F]=parseFloat(U.trim());break;case"+":case"I":h[A][F]=k?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":h[A][F]=!0;break;case"N":case"F":h[A][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));h[A][F]="##MEMO##"+(k?parseInt(U.trim(),10):I.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(h[A][F]=+U||0);break;case"@":h[A][F]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":h[A][F]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":h[A][F]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[A][F]=-I.read_shift(-8,"f");break;case"B":if(_&&N[F].len==8){h[A][F]=I.read_shift(8,"f");break}case"G":case"P":I.l+=N[F].len;break;case"0":if(N[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[F].type)}}}if(g!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(h=h.slice(0,u.sheetRows)),u.DBF=N,h}function n(c,u){var h=u||{};h.dateNF||(h.dateNF="yyyymmdd");var d=Wc(r(c,h),h);return d["!cols"]=h.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete h.DBF,d}function s(c,u){try{return Fo(n(c,u),u)}catch(h){if(u&&u.WTF)throw h}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,u){var h=u||{};if(+h.codepage>=0&&mi(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var d=_s(),g=nd(c,{header:1,raw:!0,cellDates:!0}),x=g[0],_=g.slice(1),k=c["!cols"]||[],y=0,S=0,R=0,M=1;for(y=0;y<x.length;++y){if(((k[y]||{}).DBF||{}).name){x[y]=k[y].DBF.name,++R;continue}if(x[y]!=null){if(++R,typeof x[y]=="number"&&(x[y]=x[y].toString(10)),typeof x[y]!="string")throw new Error("DBF Invalid column name "+x[y]+" |"+typeof x[y]+"|");if(x.indexOf(x[y])!==y){for(S=0;S<1024;++S)if(x.indexOf(x[y]+"_"+S)==-1){x[y]+="_"+S;break}}}}var N=Wt(c["!ref"]),V=[],W=[],j=[];for(y=0;y<=N.e.c-N.s.c;++y){var A="",F="",I=0,U=[];for(S=0;S<_.length;++S)_[S][y]!=null&&U.push(_[S][y]);if(U.length==0||x[y]==null){V[y]="?";continue}for(S=0;S<U.length;++S){switch(typeof U[S]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=U[S]instanceof Date?"D":"C";break;default:F="C"}I=Math.max(I,String(U[S]).length),A=A&&A!=F?"C":F}I>250&&(I=250),F=((k[y]||{}).DBF||{}).type,F=="C"&&k[y].DBF.len>I&&(I=k[y].DBF.len),A=="B"&&F=="N"&&(A="N",j[y]=k[y].DBF.dec,I=k[y].DBF.len),W[y]=A=="C"||F=="N"?I:i[A]||0,M+=W[y],V[y]=A}var L=d.next(32);for(L.write_shift(4,318902576),L.write_shift(4,_.length),L.write_shift(2,296+32*R),L.write_shift(2,M),y=0;y<4;++y)L.write_shift(4,0);for(L.write_shift(4,0|(+e[hS]||3)<<8),y=0,S=0;y<x.length;++y)if(x[y]!=null){var D=d.next(32),B=(x[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,B,"sbcs"),D.write_shift(1,V[y]=="?"?"C":V[y],"sbcs"),D.write_shift(4,S),D.write_shift(1,W[y]||i[V[y]]||0),D.write_shift(1,j[y]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),S+=W[y]||i[V[y]]||0}var De=d.next(264);for(De.write_shift(4,13),y=0;y<65;++y)De.write_shift(4,0);for(y=0;y<_.length;++y){var Re=d.next(M);for(Re.write_shift(1,0),S=0;S<x.length;++S)if(x[S]!=null)switch(V[S]){case"L":Re.write_shift(1,_[y][S]==null?63:_[y][S]?84:70);break;case"B":Re.write_shift(8,_[y][S]||0,"f");break;case"N":var Ve="0";for(typeof _[y][S]=="number"&&(Ve=_[y][S].toFixed(j[S]||0)),R=0;R<W[S]-Ve.length;++R)Re.write_shift(1,32);Re.write_shift(1,Ve,"sbcs");break;case"D":_[y][S]?(Re.write_shift(4,("0000"+_[y][S].getFullYear()).slice(-4),"sbcs"),Re.write_shift(2,("00"+(_[y][S].getMonth()+1)).slice(-2),"sbcs"),Re.write_shift(2,("00"+_[y][S].getDate()).slice(-2),"sbcs")):Re.write_shift(8,"00000000","sbcs");break;case"C":var Le=String(_[y][S]!=null?_[y][S]:"").slice(0,W[S]);for(Re.write_shift(1,Le,"sbcs"),R=0;R<W[S]-Le.length;++R)Re.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}})(),Sk=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Fr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,_){var k=t[_];return typeof k=="number"?A2(k):k},n=function(x,_,k){var y=_.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return y==59?x:A2(y)};t["|"]=254;function s(x,_){switch(_.type){case"base64":return i(Ms(x),_);case"binary":return i(x,_);case"buffer":return i(Ct&&Buffer.isBuffer(x)?x.toString("binary"):Io(x),_);case"array":return i(ml(x),_)}throw new Error("Unrecognized type "+_.type)}function i(x,_){var k=x.split(/[\n\r]+/),y=-1,S=-1,R=0,M=0,N=[],V=[],W=null,j={},A=[],F=[],I=[],U=0,L;for(+_.codepage>=0&&mi(+_.codepage);R!==k.length;++R){U=0;var D=k[R].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),B=D.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),De=B[0],Re;if(D.length>0)switch(De){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&V.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Ve=!1,Le=!1,Ae=!1,ne=!1,we=-1,ee=-1;for(M=1;M<B.length;++M)switch(B[M].charAt(0)){case"A":break;case"X":S=parseInt(B[M].slice(1))-1,Le=!0;break;case"Y":for(y=parseInt(B[M].slice(1))-1,Le||(S=0),L=N.length;L<=y;++L)N[L]=[];break;case"K":Re=B[M].slice(1),Re.charAt(0)==='"'?Re=Re.slice(1,Re.length-1):Re==="TRUE"?Re=!0:Re==="FALSE"?Re=!1:isNaN(vi(Re))?isNaN(Nc(Re).getDate())||(Re=mr(Re)):(Re=vi(Re),W!==null&&zc(W)&&(Re=Nd(Re))),Ve=!0;break;case"E":ne=!0;var O=wc(B[M].slice(1),{r:y,c:S});N[y][S]=[N[y][S],O];break;case"S":Ae=!0,N[y][S]=[N[y][S],"S5S"];break;case"G":break;case"R":we=parseInt(B[M].slice(1))-1;break;case"C":ee=parseInt(B[M].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+D)}if(Ve&&(N[y][S]&&N[y][S].length==2?N[y][S][0]=Re:N[y][S]=Re,W=null),Ae){if(ne)throw new Error("SYLK shared formula cannot have own formula");var te=we>-1&&N[we][ee];if(!te||!te[1])throw new Error("SYLK shared formula cannot find base");N[y][S][1]=zk(te[1],{r:y-we,c:S-ee})}break;case"F":var J=0;for(M=1;M<B.length;++M)switch(B[M].charAt(0)){case"X":S=parseInt(B[M].slice(1))-1,++J;break;case"Y":for(y=parseInt(B[M].slice(1))-1,L=N.length;L<=y;++L)N[L]=[];break;case"M":U=parseInt(B[M].slice(1))/20;break;case"F":break;case"G":break;case"P":W=V[parseInt(B[M].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=B[M].slice(1).split(" "),L=parseInt(I[0],10);L<=parseInt(I[1],10);++L)U=parseInt(I[2],10),F[L-1]=U===0?{hidden:!0}:{wch:U},Eo(F[L-1]);break;case"C":S=parseInt(B[M].slice(1))-1,F[S]||(F[S]={});break;case"R":y=parseInt(B[M].slice(1))-1,A[y]||(A[y]={}),U>0?(A[y].hpt=U,A[y].hpx=Dc(U)):U===0&&(A[y].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+D)}J<1&&(W=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+D)}}return A.length>0&&(j["!rows"]=A),F.length>0&&(j["!cols"]=F),_&&_.sheetRows&&(N=N.slice(0,_.sheetRows)),[N,j]}function o(x,_){var k=s(x,_),y=k[0],S=k[1],R=Wc(y,_);return Fr(S).forEach(function(M){R[M]=S[M]}),R}function c(x,_){return Fo(o(x,_),_)}function u(x,_,k,y){var S="C;Y"+(k+1)+";X"+(y+1)+";K";switch(x.t){case"n":S+=x.v||0,x.f&&!x.F&&(S+=";E"+hx(x.f,{r:k,c:y}));break;case"b":S+=x.v?"TRUE":"FALSE";break;case"e":S+=x.w||x.v;break;case"d":S+='"'+(x.w||x.v)+'"';break;case"s":S+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function h(x,_){_.forEach(function(k,y){var S="F;W"+(y+1)+" "+(y+1)+" ";k.hidden?S+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=vf(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=_f(k.wpx)),typeof k.wch=="number"&&(S+=Math.round(k.wch))),S.charAt(S.length-1)!=" "&&x.push(S)})}function d(x,_){_.forEach(function(k,y){var S="F;";k.hidden?S+="M0;":k.hpt?S+="M"+20*k.hpt+";":k.hpx&&(S+="M"+20*yf(k.hpx)+";"),S.length>2&&x.push(S+"R"+(y+1))})}function g(x,_){var k=["ID;PWXL;N;E"],y=[],S=Wt(x["!ref"]),R,M=Array.isArray(x),N=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),x["!cols"]&&h(k,x["!cols"]),x["!rows"]&&d(k,x["!rows"]),k.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var V=S.s.r;V<=S.e.r;++V)for(var W=S.s.c;W<=S.e.c;++W){var j=ht({r:V,c:W});R=M?(x[V]||[])[W]:x[j],!(!R||R.v==null&&(!R.f||R.F))&&y.push(u(R,x,V,W))}return k.join(N)+N+y.join(N)+N+"E"+N}return{to_workbook:c,to_sheet:o,from_sheet:g}})(),kk=(function(){function t(i,o){switch(o.type){case"base64":return e(Ms(i),o);case"binary":return e(i,o);case"buffer":return e(Ct&&Buffer.isBuffer(i)?i.toString("binary"):Io(i),o);case"array":return e(ml(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var c=i.split(`
`),u=-1,h=-1,d=0,g=[];d!==c.length;++d){if(c[d].trim()==="BOT"){g[++u]=[],h=0;continue}if(!(u<0)){var x=c[d].trim().split(","),_=x[0],k=x[1];++d;for(var y=c[d]||"";(y.match(/["]/g)||[]).length&1&&d<c.length-1;)y+=`
`+c[++d];switch(y=y.trim(),+_){case-1:if(y==="BOT"){g[++u]=[],h=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?g[u][h]=!0:y==="FALSE"?g[u][h]=!1:isNaN(vi(k))?isNaN(Nc(k).getDate())?g[u][h]=k:g[u][h]=mr(k):g[u][h]=vi(k),++h;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),g[u][h++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(i,o){return Wc(t(i,o),o)}function n(i,o){return Fo(r(i,o),o)}var s=(function(){var i=function(u,h,d,g,x){u.push(h),u.push(d+","+g),u.push('"'+x.replace(/"/g,'""')+'"')},o=function(u,h,d,g){u.push(h+","+d),u.push(h==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var h=[],d=Wt(u["!ref"]),g,x=Array.isArray(u);i(h,"TABLE",0,1,"sheetjs"),i(h,"VECTORS",0,d.e.r-d.s.r+1,""),i(h,"TUPLES",0,d.e.c-d.s.c+1,""),i(h,"DATA",0,0,"");for(var _=d.s.r;_<=d.e.r;++_){o(h,-1,0,"BOT");for(var k=d.s.c;k<=d.e.c;++k){var y=ht({r:_,c:k});if(g=x?(u[_]||[])[k]:u[y],!g){o(h,1,0,"");continue}switch(g.t){case"n":var S=g.w;!S&&g.v!=null&&(S=g.v),S==null?g.f&&!g.F?o(h,1,0,"="+g.f):o(h,1,0,""):o(h,0,S,"V");break;case"b":o(h,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=ti(g.z||ct[14],Jr(mr(g.v)))),o(h,0,g.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var R=`\r
`,M=h.join(R);return M}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),Ak=(function(){function t(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,x){for(var _=g.split(`
`),k=-1,y=-1,S=0,R=[];S!==_.length;++S){var M=_[S].trim().split(":");if(M[0]==="cell"){var N=Tr(M[1]);if(R.length<=N.r)for(k=R.length;k<=N.r;++k)R[k]||(R[k]=[]);switch(k=N.r,y=N.c,M[2]){case"t":R[k][y]=t(M[3]);break;case"v":R[k][y]=+M[3];break;case"vtf":var V=M[M.length-1];case"vtc":switch(M[3]){case"nl":R[k][y]=!!+M[4];break;default:R[k][y]=+M[4];break}M[2]=="vtf"&&(R[k][y]=[R[k][y],V])}}}return x&&x.sheetRows&&(R=R.slice(0,x.sheetRows)),R}function n(g,x){return Wc(r(g,x),x)}function s(g,x){return Fo(n(g,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function h(g){if(!g||!g["!ref"])return"";for(var x=[],_=[],k,y="",S=ys(g["!ref"]),R=Array.isArray(g),M=S.s.r;M<=S.e.r;++M)for(var N=S.s.c;N<=S.e.c;++N)if(y=ht({r:M,c:N}),k=R?(g[M]||[])[N]:g[y],!(!k||k.v==null||k.t==="z")){switch(_=["cell",y,"t"],k.t){case"s":case"str":_.push(e(k.v));break;case"n":k.f?(_[2]="vtf",_[3]="n",_[4]=k.v,_[5]=e(k.f)):(_[2]="v",_[3]=k.v);break;case"b":_[2]="vt"+(k.f?"f":"c"),_[3]="nl",_[4]=k.v?"1":"0",_[5]=e(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var V=Jr(mr(k.v));_[2]="vtc",_[3]="nd",_[4]=""+V,_[5]=k.w||ti(k.z||ct[14],V);break;case"e":continue}x.push(_.join(":"))}return x.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(g){return[i,o,c,o,h(g),u].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}})(),bc=(function(){function t(d,g,x,_,k){k.raw?g[x][_]=d:d===""||(d==="TRUE"?g[x][_]=!0:d==="FALSE"?g[x][_]=!1:isNaN(vi(d))?isNaN(Nc(d).getDate())?g[x][_]=d:g[x][_]=mr(d):g[x][_]=vi(d))}function e(d,g){var x=g||{},_=[];if(!d||d.length===0)return _;for(var k=d.split(/[\r\n]/),y=k.length-1;y>=0&&k[y].length===0;)--y;for(var S=10,R=0,M=0;M<=y;++M)R=k[M].indexOf(" "),R==-1?R=k[M].length:R++,S=Math.max(S,R);for(M=0;M<=y;++M){_[M]=[];var N=0;for(t(k[M].slice(0,S).trim(),_,M,N,x),N=1;N<=(k[M].length-S)/10+1;++N)t(k[M].slice(S+(N-1)*10,S+N*10).trim(),_,M,N,x)}return x.sheetRows&&(_=_.slice(0,x.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var g={},x=!1,_=0,k=0;_<d.length;++_)(k=d.charCodeAt(_))==34?x=!x:!x&&k in r&&(g[k]=(g[k]||0)+1);k=[];for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&k.push([g[_],_]);if(!k.length){g=n;for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&k.push([g[_],_])}return k.sort(function(y,S){return y[0]-S[0]||n[y[1]]-n[S[1]]}),r[k.pop()[1]]||44}function i(d,g){var x=g||{},_="",k=x.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(_=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(_=d.charAt(4),d=d.slice(6)):_=s(d.slice(0,1024)):x&&x.FS?_=x.FS:_=s(d.slice(0,1024));var S=0,R=0,M=0,N=0,V=0,W=_.charCodeAt(0),j=!1,A=0,F=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var I=x.dateNF!=null?eD(x.dateNF):null;function U(){var L=d.slice(N,V),D={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)D.t="z";else if(x.raw)D.t="s",D.v=L;else if(L.trim().length===0)D.t="s",D.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(D.t="s",D.v=L.slice(2,-1).replace(/""/g,'"')):FL(L)?(D.t="n",D.f=L.slice(1)):(D.t="s",D.v=L);else if(L=="TRUE")D.t="b",D.v=!0;else if(L=="FALSE")D.t="b",D.v=!1;else if(!isNaN(M=vi(L)))D.t="n",x.cellText!==!1&&(D.w=L),D.v=M;else if(!isNaN(Nc(L).getDate())||I&&L.match(I)){D.z=x.dateNF||ct[14];var B=0;I&&L.match(I)&&(L=tD(L,x.dateNF,L.match(I)||[]),B=1),x.cellDates?(D.t="d",D.v=mr(L,B)):(D.t="n",D.v=Jr(mr(L,B))),x.cellText!==!1&&(D.w=ti(D.z,D.v instanceof Date?Jr(D.v):D.v)),x.cellNF||delete D.z}else D.t="s",D.v=L;if(D.t=="z"||(x.dense?(k[S]||(k[S]=[]),k[S][R]=D):k[ht({c:R,r:S})]=D),N=V+1,F=d.charCodeAt(N),y.e.c<R&&(y.e.c=R),y.e.r<S&&(y.e.r=S),A==W)++R;else if(R=0,++S,x.sheetRows&&x.sheetRows<=S)return!0}e:for(;V<d.length;++V)switch(A=d.charCodeAt(V)){case 34:F===34&&(j=!j);break;case W:case 10:case 13:if(!j&&U())break e;break}return V-N>0&&U(),k["!ref"]=Et(y),k}function o(d,g){return!(g&&g.PRN)||g.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,g):Wc(e(d,g),g)}function c(d,g){var x="",_=g.type=="string"?[0,0,0,0]:yx(d,g);switch(g.type){case"base64":x=Ms(d);break;case"binary":x=d;break;case"buffer":g.codepage==65001?x=d.toString("utf8"):g.codepage&&typeof uf<"u"||(x=Ct&&Buffer.isBuffer(d)?d.toString("binary"):Io(d));break;case"array":x=ml(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+g.type)}return _[0]==239&&_[1]==187&&_[2]==191?x=ir(x.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?x=ir(x):g.type=="binary"&&typeof uf<"u",x.slice(0,19)=="socialcalc:version:"?Ak.to_sheet(g.type=="string"?x:ir(x),g):o(x,g)}function u(d,g){return Fo(c(d,g),g)}function h(d){for(var g=[],x=Wt(d["!ref"]),_,k=Array.isArray(d),y=x.s.r;y<=x.e.r;++y){for(var S=[],R=x.s.c;R<=x.e.c;++R){var M=ht({r:y,c:R});if(_=k?(d[y]||[])[R]:d[M],!_||_.v==null){S.push("          ");continue}for(var N=(_.w||(Aa(_),_.w)||"").slice(0,10);N.length<10;)N+=" ";S.push(N+(R===0?" ":""))}g.push(S.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:h}})();function m8(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=Sk.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return bc.to_workbook(t,e)}}var sl=(function(){function t(O,te,J){if(O){vn(O,O.l||0);for(var Z=J.Enum||we;O.l<O.length;){var oe=O.read_shift(2),_e=Z[oe]||Z[65535],ve=O.read_shift(2),xe=O.l+ve,Te=_e.f&&_e.f(O,ve,J);if(O.l=xe,te(Te,_e,oe))return}}}function e(O,te){switch(te.type){case"base64":return r(Ps(Ms(O)),te);case"binary":return r(Ps(O),te);case"buffer":case"array":return r(O,te)}throw"Unsupported type "+te.type}function r(O,te){if(!O)return O;var J=te||{},Z=J.dense?[]:{},oe="Sheet1",_e="",ve=0,xe={},Te=[],ut=[],Y={s:{r:0,c:0},e:{r:0,c:0}},At=J.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)J.Enum=we,t(O,function(je,Zt,Mt){switch(Mt){case 0:J.vers=je,je>=4096&&(J.qpro=!0);break;case 6:Y=je;break;case 204:je&&(_e=je);break;case 222:_e=je;break;case 15:case 51:J.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:Mt==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=J.dateNF||ct[14],J.cellDates&&(je[1].t="d",je[1].v=Nd(je[1].v))),J.qpro&&je[3]>ve&&(Z["!ref"]=Et(Y),xe[oe]=Z,Te.push(oe),Z=J.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ve=je[3],oe=_e||"Sheet"+(ve+1),_e="");var Bt=J.dense?(Z[je[0].r]||[])[je[0].c]:Z[ht(je[0])];if(Bt){Bt.t=je[1].t,Bt.v=je[1].v,je[1].z!=null&&(Bt.z=je[1].z),je[1].f!=null&&(Bt.f=je[1].f);break}J.dense?(Z[je[0].r]||(Z[je[0].r]=[]),Z[je[0].r][je[0].c]=je[1]):Z[ht(je[0])]=je[1];break}},J);else if(O[2]==26||O[2]==14)J.Enum=ee,O[2]==14&&(J.qpro=!0,O.l=0),t(O,function(je,Zt,Mt){switch(Mt){case 204:oe=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>ve&&(Z["!ref"]=Et(Y),xe[oe]=Z,Te.push(oe),Z=J.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ve=je[3],oe="Sheet"+(ve+1)),At>0&&je[0].r>=At)break;J.dense?(Z[je[0].r]||(Z[je[0].r]=[]),Z[je[0].r][je[0].c]=je[1]):Z[ht(je[0])]=je[1],Y.e.c<je[0].c&&(Y.e.c=je[0].c),Y.e.r<je[0].r&&(Y.e.r=je[0].r);break;case 27:je[14e3]&&(ut[je[14e3][0]]=je[14e3][1]);break;case 1537:ut[je[0]]=je[1],je[0]==ve&&(oe=je[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(Z["!ref"]=Et(Y),xe[_e||oe]=Z,Te.push(_e||oe),!ut.length)return{SheetNames:Te,Sheets:xe};for(var wt={},Lt=[],xt=0;xt<ut.length;++xt)xe[Te[xt]]?(Lt.push(ut[xt]||Te[xt]),wt[ut[xt]]=xe[ut[xt]]||xe[Te[xt]]):(Lt.push(ut[xt]),wt[ut[xt]]={"!ref":"A1"});return{SheetNames:Lt,Sheets:wt}}function n(O,te){var J=te||{};if(+J.codepage>=0&&mi(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=_s(),oe=Wt(O["!ref"]),_e=Array.isArray(O),ve=[];We(Z,0,i(1030)),We(Z,6,u(oe));for(var xe=Math.min(oe.e.r,8191),Te=oe.s.r;Te<=xe;++Te)for(var ut=Or(Te),Y=oe.s.c;Y<=oe.e.c;++Y){Te===oe.s.r&&(ve[Y]=Er(Y));var At=ve[Y]+ut,wt=_e?(O[Te]||[])[Y]:O[At];if(!(!wt||wt.t=="z"))if(wt.t=="n")(wt.v|0)==wt.v&&wt.v>=-32768&&wt.v<=32767?We(Z,13,_(Te,Y,wt.v)):We(Z,14,y(Te,Y,wt.v));else{var Lt=Aa(wt);We(Z,15,g(Te,Y,Lt.slice(0,239)))}}return We(Z,1),Z.end()}function s(O,te){var J=te||{};if(+J.codepage>=0&&mi(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=_s();We(Z,0,o(O));for(var oe=0,_e=0;oe<O.SheetNames.length;++oe)(O.Sheets[O.SheetNames[oe]]||{})["!ref"]&&We(Z,27,ne(O.SheetNames[oe],_e++));var ve=0;for(oe=0;oe<O.SheetNames.length;++oe){var xe=O.Sheets[O.SheetNames[oe]];if(!(!xe||!xe["!ref"])){for(var Te=Wt(xe["!ref"]),ut=Array.isArray(xe),Y=[],At=Math.min(Te.e.r,8191),wt=Te.s.r;wt<=At;++wt)for(var Lt=Or(wt),xt=Te.s.c;xt<=Te.e.c;++xt){wt===Te.s.r&&(Y[xt]=Er(xt));var je=Y[xt]+Lt,Zt=ut?(xe[wt]||[])[xt]:xe[je];if(!(!Zt||Zt.t=="z"))if(Zt.t=="n")We(Z,23,U(wt,xt,ve,Zt.v));else{var Mt=Aa(Zt);We(Z,22,A(wt,xt,ve,Mt.slice(0,239)))}}++ve}}return We(Z,1),Z.end()}function i(O){var te=ge(2);return te.write_shift(2,O),te}function o(O){var te=ge(26);te.write_shift(2,4096),te.write_shift(2,4),te.write_shift(4,0);for(var J=0,Z=0,oe=0,_e=0;_e<O.SheetNames.length;++_e){var ve=O.SheetNames[_e],xe=O.Sheets[ve];if(!(!xe||!xe["!ref"])){++oe;var Te=ys(xe["!ref"]);J<Te.e.r&&(J=Te.e.r),Z<Te.e.c&&(Z=Te.e.c)}}return J>8191&&(J=8191),te.write_shift(2,J),te.write_shift(1,oe),te.write_shift(1,Z),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(1,1),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(4,0),te}function c(O,te,J){var Z={s:{c:0,r:0},e:{c:0,r:0}};return te==8&&J.qpro?(Z.s.c=O.read_shift(1),O.l++,Z.s.r=O.read_shift(2),Z.e.c=O.read_shift(1),O.l++,Z.e.r=O.read_shift(2),Z):(Z.s.c=O.read_shift(2),Z.s.r=O.read_shift(2),te==12&&J.qpro&&(O.l+=2),Z.e.c=O.read_shift(2),Z.e.r=O.read_shift(2),te==12&&J.qpro&&(O.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function u(O){var te=ge(8);return te.write_shift(2,O.s.c),te.write_shift(2,O.s.r),te.write_shift(2,O.e.c),te.write_shift(2,O.e.r),te}function h(O,te,J){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(Z[0].c=O.read_shift(1),Z[3]=O.read_shift(1),Z[0].r=O.read_shift(2),O.l+=2):(Z[2]=O.read_shift(1),Z[0].c=O.read_shift(2),Z[0].r=O.read_shift(2)),Z}function d(O,te,J){var Z=O.l+te,oe=h(O,te,J);if(oe[1].t="s",J.vers==20768){O.l++;var _e=O.read_shift(1);return oe[1].v=O.read_shift(_e,"utf8"),oe}return J.qpro&&O.l++,oe[1].v=O.read_shift(Z-O.l,"cstr"),oe}function g(O,te,J){var Z=ge(7+J.length);Z.write_shift(1,255),Z.write_shift(2,te),Z.write_shift(2,O),Z.write_shift(1,39);for(var oe=0;oe<Z.length;++oe){var _e=J.charCodeAt(oe);Z.write_shift(1,_e>=128?95:_e)}return Z.write_shift(1,0),Z}function x(O,te,J){var Z=h(O,te,J);return Z[1].v=O.read_shift(2,"i"),Z}function _(O,te,J){var Z=ge(7);return Z.write_shift(1,255),Z.write_shift(2,te),Z.write_shift(2,O),Z.write_shift(2,J,"i"),Z}function k(O,te,J){var Z=h(O,te,J);return Z[1].v=O.read_shift(8,"f"),Z}function y(O,te,J){var Z=ge(13);return Z.write_shift(1,255),Z.write_shift(2,te),Z.write_shift(2,O),Z.write_shift(8,J,"f"),Z}function S(O,te,J){var Z=O.l+te,oe=h(O,te,J);if(oe[1].v=O.read_shift(8,"f"),J.qpro)O.l=Z;else{var _e=O.read_shift(2);V(O.slice(O.l,O.l+_e),oe),O.l+=_e}return oe}function R(O,te,J){var Z=te&32768;return te&=-32769,te=(Z?O:0)+(te>=8192?te-16384:te),(Z?"":"$")+(J?Er(te):Or(te))}var M={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function V(O,te){vn(O,0);for(var J=[],Z=0,oe="",_e="",ve="",xe="";O.l<O.length;){var Te=O[O.l++];switch(Te){case 0:J.push(O.read_shift(8,"f"));break;case 1:_e=R(te[0].c,O.read_shift(2),!0),oe=R(te[0].r,O.read_shift(2),!1),J.push(_e+oe);break;case 2:{var ut=R(te[0].c,O.read_shift(2),!0),Y=R(te[0].r,O.read_shift(2),!1);_e=R(te[0].c,O.read_shift(2),!0),oe=R(te[0].r,O.read_shift(2),!1),J.push(ut+Y+":"+_e+oe)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(O.read_shift(2));break;case 6:{for(var At="";Te=O[O.l++];)At+=String.fromCharCode(Te);J.push('"'+At.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:xe=J.pop(),ve=J.pop(),J.push(["AND","OR"][Te-20]+"("+ve+","+xe+")");break;default:if(Te<32&&N[Te])xe=J.pop(),ve=J.pop(),J.push(ve+N[Te]+xe);else if(M[Te]){if(Z=M[Te][1],Z==69&&(Z=O[O.l++]),Z>J.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+J.join("|")+"|");return}var wt=J.slice(-Z);J.length-=Z,J.push(M[Te][0]+"("+wt.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}J.length==1?te[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function W(O){var te=[{c:0,r:0},{t:"n",v:0},0];return te[0].r=O.read_shift(2),te[3]=O[O.l++],te[0].c=O[O.l++],te}function j(O,te){var J=W(O);return J[1].t="s",J[1].v=O.read_shift(te-4,"cstr"),J}function A(O,te,J,Z){var oe=ge(6+Z.length);oe.write_shift(2,O),oe.write_shift(1,J),oe.write_shift(1,te),oe.write_shift(1,39);for(var _e=0;_e<Z.length;++_e){var ve=Z.charCodeAt(_e);oe.write_shift(1,ve>=128?95:ve)}return oe.write_shift(1,0),oe}function F(O,te){var J=W(O);J[1].v=O.read_shift(2);var Z=J[1].v>>1;if(J[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return J[1].v=Z,J}function I(O,te){var J=W(O),Z=O.read_shift(4),oe=O.read_shift(4),_e=O.read_shift(2);if(_e==65535)return Z===0&&oe===3221225472?(J[1].t="e",J[1].v=15):Z===0&&oe===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var ve=_e&32768;return _e=(_e&32767)-16446,J[1].v=(1-ve*2)*(oe*Math.pow(2,_e+32)+Z*Math.pow(2,_e)),J}function U(O,te,J,Z){var oe=ge(14);if(oe.write_shift(2,O),oe.write_shift(1,J),oe.write_shift(1,te),Z==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var _e=0,ve=0,xe=0,Te=0;return Z<0&&(_e=1,Z=-Z),ve=Math.log2(Z)|0,Z/=Math.pow(2,ve-31),Te=Z>>>0,(Te&2147483648)==0&&(Z/=2,++ve,Te=Z>>>0),Z-=Te,Te|=2147483648,Te>>>=0,Z*=Math.pow(2,32),xe=Z>>>0,oe.write_shift(4,xe),oe.write_shift(4,Te),ve+=16383+(_e?32768:0),oe.write_shift(2,ve),oe}function L(O,te){var J=I(O);return O.l+=te-14,J}function D(O,te){var J=W(O),Z=O.read_shift(4);return J[1].v=Z>>6,J}function B(O,te){var J=W(O),Z=O.read_shift(8,"f");return J[1].v=Z,J}function De(O,te){var J=B(O);return O.l+=te-10,J}function Re(O,te){return O[O.l+te-1]==0?O.read_shift(te,"cstr"):""}function Ve(O,te){var J=O[O.l++];J>te-1&&(J=te-1);for(var Z="";Z.length<J;)Z+=String.fromCharCode(O[O.l++]);return Z}function Le(O,te,J){if(!(!J.qpro||te<21)){var Z=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var oe=O.read_shift(te-21,"cstr");return[Z,oe]}}function Ae(O,te){for(var J={},Z=O.l+te;O.l<Z;){var oe=O.read_shift(2);if(oe==14e3){for(J[oe]=[0,""],J[oe][0]=O.read_shift(2);O[O.l];)J[oe][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return J}function ne(O,te){var J=ge(5+O.length);J.write_shift(2,14e3),J.write_shift(2,te);for(var Z=0;Z<O.length;++Z){var oe=O.charCodeAt(Z);J[J.l++]=oe>127?95:oe}return J[J.l++]=0,J}var we={0:{n:"BOF",f:zr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Re},222:{n:"SHEETNAMELP",f:Ve},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:De},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}})();function g8(t){var e={},r=t.match(Gn),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=pt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=M1[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var x8=(function(){var t=df("t"),e=df("rPr");function r(i){var o=i.match(t);if(!o)return{t:"s",v:""};var c={t:"s",v:Ht(o[1])},u=i.match(e);return u&&(c.s=g8(u[1])),c}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(c){return c.v})}})(),v8=(function(){var e=/(\r\n|\n)/g;function r(s,i,o){var c=[];s.u&&c.push("text-decoration: underline;"),s.uval&&c.push("text-underline-style:"+s.uval+";"),s.sz&&c.push("font-size:"+s.sz+"pt;"),s.outline&&c.push("text-effect: outline;"),s.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var u=s.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),_8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,y8=/<(?:\w+:)?r>/,w8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ox(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ht(ir(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ir(t),r&&(n.h=q1(n.t))):t.match(y8)&&(n.r=ir(t),n.t=Ht(ir((t.replace(w8,"").match(_8)||[]).join("").replace(Gn,""))),r&&(n.h=v8(x8(n.r)))),n):{t:""}}var E8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,T8=/<(?:\w+:)?(?:si|sstItem)>/g,S8=/<\/(?:\w+:)?(?:si|sstItem)>/;function k8(t,e){var r=[],n="";if(!t)return r;var s=t.match(E8);if(s){n=s[2].replace(T8,"").split(S8);for(var i=0;i!=n.length;++i){var o=ox(n[i].trim(),e);o!=null&&(r[r.length]=o)}s=pt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var A8=/^\s|\s$|[\t\n\r]/;function Ck(t,e){if(!e.bookSST)return"";var r=[Lr];r[r.length]=He("sst",null,{xmlns:El[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(A8)&&(i+=' xml:space="preserve"'),i+=">"+nr(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function C8(t){return[t.read_shift(4),t.read_shift(4)]}function I8(t,e){var r=[],n=!1;return Ra(t,function(i,o,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function F8(t,e){return e||(e=ge(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var R8=UD;function N8(t){var e=_s();Ce(e,159,F8(t));for(var r=0;r<t.length;++r)Ce(e,19,R8(t[r]));return Ce(e,160),e.end()}function Ik(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function ya(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function b8(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=ya(t,4),e.U=ya(t,4),e.W=ya(t,4),e}function D8(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function P8(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(D8(t));return e}function O8(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function L8(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=ya(t,4),e.U=ya(t,4),e.W=ya(t,4),e}function M8(t){var e=L8(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Fk(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Rk(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function V8(t){var e=ya(t);switch(e.Minor){case 2:return[e.Minor,B8(t)];case 3:return[e.Minor,U8()];case 4:return[e.Minor,j8(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function B8(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Fk(t,r),s=Rk(t,t.length-t.l);return{t:"Std",h:n,v:s}}function U8(){throw new Error("File is password-protected: ECMA-376 Extensible")}function j8(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Gn,function(i){var o=pt(i);switch(Yi(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){n[c]=o[c]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function z8(t,e){var r={},n=r.EncryptionVersionInfo=ya(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=Fk(t,s),e-=s,r.EncryptionVerifier=Rk(t,e),r}function H8(t){var e={},r=e.EncryptionVersionInfo=ya(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function lx(t){var e=0,r,n=Ik(t),s=n.length+1,i,o,c,u,h;for(r=wo(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)o=r[i],c=(e&16384)===0?0:1,u=e<<1&32767,h=c|u,e=h^o;return e^52811}var Nk=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,c){return n(o^c)},i=function(o){for(var c=e[o.length-1],u=104,h=o.length-1;h>=0;--h)for(var d=o[h],g=0;g!=7;++g)d&64&&(c^=r[u]),d*=2,--u;return c};return function(o){for(var c=Ik(o),u=i(c),h=c.length,d=wo(16),g=0;g!=16;++g)d[g]=0;var x,_,k;for((h&1)===1&&(x=u>>8,d[h]=s(t[0],x),--h,x=u&255,_=c[c.length-1],d[h]=s(_,x));h>0;)--h,x=u>>8,d[h]=s(c[h],x),--h,x=u&255,d[h]=s(c[h],x);for(h=15,k=15-c.length;k>0;)x=u>>8,d[h]=s(t[k],x),--h,--k,x=u&255,d[h]=s(c[h],x),--h,--k;return d}})(),W8=function(t,e,r,n,s){s||(s=e),n||(n=Nk(t));var i,o;for(i=0;i!=e.length;++i)o=e[i],o^=n[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,n]},$8=function(t){var e=0,r=Nk(t);return function(n){var s=W8("",n,e,r);return e=s[1],s[0]}};function G8(t,e,r,n){var s={key:zr(t),verificationBytes:zr(t)};return r.password&&(s.verifier=lx(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=$8(r.password)),s}function q8(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=H8(t):n.Data=z8(t,e),n}function K8(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?q8(t,e-2,n):G8(t,r.biff>=8?e:e-2,r,n),n}var bk=(function(){function t(s,i){switch(i.type){case"base64":return e(Ms(s),i);case"binary":return e(s,i);case"buffer":return e(Ct&&Buffer.isBuffer(s)?s.toString("binary"):Io(s),i);case"array":return e(ml(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var o=i||{},c=o.dense?[]:{},u=s.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,g){Array.isArray(c)&&(c[g]=[]);for(var x=/\\\w+\b/g,_=0,k,y=-1;k=x.exec(d);){switch(k[0]){case"\\cell":var S=d.slice(_,x.lastIndex-k[0].length);if(S[0]==" "&&(S=S.slice(1)),++y,S.length){var R={v:S,t:"s"};Array.isArray(c)?c[g][y]=R:c[ht({r:g,c:y})]=R}break}_=x.lastIndex}y>h.e.c&&(h.e.c=y)}),c["!ref"]=Et(h),c}function r(s,i){return Fo(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],o=Wt(s["!ref"]),c,u=Array.isArray(s),h=o.s.r;h<=o.e.r;++h){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var g=ht({r:h,c:d});c=u?(s[h]||[])[d]:s[g],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(Aa(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function X8(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function xf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Y8(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),o=s-i;if(o===0)return[0,0,e];var c=0,u=0,h=s+i;switch(u=o/(h>1?2-h:h),s){case e:c=((r-n)/o+6)%6;break;case r:c=(n-e)/o+2;break;case n:c=(e-r)/o+4;break}return[c/6,u,h/2]}function Q8(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,o=[i,i,i],c=6*e,u;if(r!==0)switch(c|0){case 0:case 6:u=s*c,o[0]+=s,o[1]+=u;break;case 1:u=s*(2-c),o[0]+=u,o[1]+=s;break;case 2:u=s*(c-2),o[1]+=s,o[2]+=u;break;case 3:u=s*(4-c),o[1]+=u,o[2]+=s;break;case 4:u=s*(c-4),o[2]+=s,o[0]+=u;break;case 5:u=s*(6-c),o[2]+=u,o[0]+=s;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function td(t,e){if(e===0)return t;var r=Y8(X8(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),xf(Q8(r))}var Dk=6,J8=15,Z8=1,jn=Dk;function vf(t){return Math.floor((t+Math.round(128/jn)/256)*jn)}function _f(t){return Math.floor((t-5)/jn*100+.5)/100}function rd(t){return Math.round((t*jn+5)/jn*256)/256}function Rm(t){return rd(_f(vf(t)))}function cx(t){var e=Math.abs(t-Rm(t)),r=jn;if(e>.005)for(jn=Z8;jn<J8;++jn)Math.abs(t-Rm(t))<=e&&(e=Math.abs(t-Rm(t)),r=jn);jn=r}function Eo(t){t.width?(t.wpx=vf(t.width),t.wch=_f(t.wpx),t.MDW=jn):t.wpx?(t.wch=_f(t.wpx),t.width=rd(t.wch),t.MDW=jn):typeof t.wch=="number"&&(t.width=rd(t.wch),t.wpx=vf(t.width),t.MDW=jn),t.customWidth&&delete t.customWidth}var eO=96,Pk=eO;function yf(t){return t*96/Pk}function Dc(t){return t*Pk/96}var tO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function rO(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(Gn)||[]).forEach(function(o){var c=pt(o);switch(Yi(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},c.diagonalUp&&(s.diagonalUp=dr(c.diagonalUp)),c.diagonalDown&&(s.diagonalDown=dr(c.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function nO(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(Gn)||[]).forEach(function(o){var c=pt(o);switch(Yi(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":c.patternType&&(s.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),c.indexed&&(s.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(s.bgColor.theme=parseInt(c.theme,10)),c.tint&&(s.bgColor.tint=parseFloat(c.tint)),c.rgb&&(s.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),c.theme&&(s.fgColor.theme=parseInt(c.theme,10)),c.tint&&(s.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(s.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function sO(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(Gn)||[]).forEach(function(o){var c=pt(o);switch(Yi(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":c.val&&(s.name=ir(c.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=c.val?dr(c.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=c.val?dr(c.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(c.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=c.val?dr(c.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=c.val?dr(c.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=c.val?dr(c.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=c.val?dr(c.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=c.val?dr(c.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":c.val&&(s.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(s.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(s.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(s.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=M1[parseInt(c.val,10)];break;case"<color":if(s.color||(s.color={}),c.auto&&(s.color.auto=dr(c.auto)),c.rgb)s.color.rgb=c.rgb.slice(-6);else if(c.indexed){s.color.index=parseInt(c.indexed,10);var u=rl[s.color.index];s.color.index==81&&(u=rl[1]),u||(u=rl[1]),s.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(s.color.theme=parseInt(c.theme,10),c.tint&&(s.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=td(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function iO(t,e,r){e.NumberFmt=[];for(var n=Fr(ct),s=0;s<n.length;++s)e.NumberFmt[n[s]]=ct[n[s]];var i=t[0].match(Gn);if(i)for(s=0;s<i.length;++s){var o=pt(i[s]);switch(Yi(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Ht(ir(o.formatCode)),u=parseInt(o.numFmtId,10);if(e.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&e.NumberFmt[u]!=null;--u);e.NumberFmt[u]=c}_a(c,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function aO(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=He("numFmt",null,{numFmtId:n,formatCode:nr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=He("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var f0=["numFmtId","fillId","fontId","borderId","xfId"],h0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function oO(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Gn)||[]).forEach(function(i){var o=pt(i),c=0;switch(Yi(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],c=0;c<f0.length;++c)n[f0[c]]&&(n[f0[c]]=parseInt(n[f0[c]],10));for(c=0;c<h0.length;++c)n[h0[c]]&&(n[h0[c]]=dr(n[h0[c]]));if(e.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[c]){n.numFmtId=c;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=dr(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function lO(t){var e=[];return e[e.length]=He("cellXfs",null),t.forEach(function(r){e[e.length]=He("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=He("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var cO=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,h){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=c.match(e))&&iO(g,d,h),(g=c.match(s))&&sO(g,d,u,h),(g=c.match(n))&&nO(g,d,u,h),(g=c.match(i))&&rO(g,d,u,h),(g=c.match(r))&&oO(g,d,h),d}})();function Ok(t,e){var r=[Lr,He("styleSheet",null,{xmlns:El[0],"xmlns:vt":Yr.vt})],n;return t.SSF&&(n=aO(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=lO(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function uO(t,e){var r=t.read_shift(2),n=Hn(t);return[r,n]}function fO(t,e,r){r||(r=ge(6+4*e.length)),r.write_shift(2,t),on(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function hO(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=qD(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var c=t.read_shift(1);c>0&&(n.family=c);var u=t.read_shift(1);switch(u>0&&(n.charset=u),t.l++,n.color=GD(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Hn(t),n}function dO(t,e){e||(e=ge(153)),e.write_shift(2,t.sz*20),KD(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),J0(t.color,e);var n=0;return n=2,e.write_shift(1,n),on(t.name,e),e.length>e.l?e.slice(0,e.l):e}var pO=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Nm,mO=$n;function gw(t,e){e||(e=ge(84)),Nm||(Nm=Fd(pO));var r=Nm[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(J0({auto:1},e),J0({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function gO(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function Lk(t,e,r){r||(r=ge(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ru(t,e){return e||(e=ge(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var xO=$n;function vO(t,e){return e||(e=ge(51)),e.write_shift(1,0),Ru(null,e),Ru(null,e),Ru(null,e),Ru(null,e),Ru(null,e),e.length>e.l?e.slice(0,e.l):e}function _O(t,e){return e||(e=ge(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Q0(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function yO(t,e,r){var n=ge(2052);return n.write_shift(4,t),Q0(e,n),Q0(r,n),n.length>n.l?n.slice(0,n.l):n}function wO(t,e,r){var n={};n.NumberFmt=[];for(var s in ct)n.NumberFmt[s]=ct[s];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Ra(t,function(u,h,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],_a(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(u.color.rgb=td(e.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(d),o=!0;break;case 38:i.pop(),o=!1;break;default:if(h.T>0)i.push(d);else if(h.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function EO(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(Ce(t,615,_i(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Ce(t,44,fO(s,e[s]))}),Ce(t,616))}}function TO(t){var e=1;Ce(t,611,_i(e)),Ce(t,43,dO({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(t,612)}function SO(t){var e=2;Ce(t,603,_i(e)),Ce(t,45,gw({patternType:"none"})),Ce(t,45,gw({patternType:"gray125"})),Ce(t,604)}function kO(t){var e=1;Ce(t,613,_i(e)),Ce(t,46,vO()),Ce(t,614)}function AO(t){var e=1;Ce(t,626,_i(e)),Ce(t,47,Lk({numFmtId:0},65535)),Ce(t,627)}function CO(t,e){Ce(t,617,_i(e.length)),e.forEach(function(r){Ce(t,47,Lk(r,0))}),Ce(t,618)}function IO(t){var e=1;Ce(t,619,_i(e)),Ce(t,48,_O({xfId:0,name:"Normal"})),Ce(t,620)}function FO(t){var e=0;Ce(t,505,_i(e)),Ce(t,506)}function RO(t){var e=0;Ce(t,508,yO(e,"TableStyleMedium9","PivotStyleMedium4")),Ce(t,509)}function NO(t,e){var r=_s();return Ce(r,278),EO(r,t.SSF),TO(r),SO(r),kO(r),AO(r),CO(r,e.cellXfs),IO(r),FO(r),RO(r),Ce(r,279),r.end()}var bO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function DO(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Gn)||[]).forEach(function(s){var i=pt(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[bO.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function PO(){}function OO(){}var LO=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,MO=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,VO=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function BO(t,e,r){e.themeElements={};var n;[["clrScheme",LO,DO],["fontScheme",MO,PO],["fmtScheme",VO,OO]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var UO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Mk(t,e){(!t||t.length===0)&&(t=ux());var r,n={};if(!(r=t.match(UO)))throw new Error("themeElements not found in theme");return BO(r[0],n,e),n.raw=t,n}function ux(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Lr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function jO(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var o;try{o=FS(i,{type:"array"})}catch{return}var c=Os(o,"theme/theme/theme1.xml",!0);if(c)return Mk(c,r)}}function zO(t){return t.read_shift(4)}function HO(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=WO(t,4);break;case 2:e.xclrValue=gk(t);break;case 3:e.xclrValue=zO(t);break;case 4:t.l+=4;break}return t.l+=8,e}function WO(t,e){return $n(t,e)}function $O(t,e){return $n(t,e)}function GO(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=HO(t);break;case 6:n[1]=$O(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function qO(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(GO(t,r-t.l));return{ixfe:n,ext:i}}function KO(t,e){e.forEach(function(r){r[0]})}function XO(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Hn(t)}}function YO(t){var e=ge(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),on(t.name,e),e.slice(0,e.l)}function QO(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function JO(t){var e=ge(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function ZO(t,e){var r=ge(8+2*e.length);return r.write_shift(4,t),on(e,r),r.slice(0,r.l)}function eL(t){return t.l+=4,t.read_shift(4)!=0}function tL(t,e){var r=ge(8);return r.write_shift(4,t),r.write_shift(4,1),r}function rL(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,c=2;return Ra(t,function(u,h,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(g){c==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):c==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:i.push(d),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!h.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function nL(){var t=_s();return Ce(t,332),Ce(t,334,_i(1)),Ce(t,335,YO({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(t,336),Ce(t,339,ZO(1,"XLDAPR")),Ce(t,52),Ce(t,35,_i(514)),Ce(t,4096,_i(0)),Ce(t,4097,Js(1)),Ce(t,36),Ce(t,53),Ce(t,340),Ce(t,337,tL(1)),Ce(t,51,JO([[1,0]])),Ce(t,338),Ce(t,333),t.end()}function sL(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,o;return t.replace(Gn,function(c){var u=pt(c);switch(Yi(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==u.name&&(o=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):i==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),n}function Vk(){var t=[Lr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function iL(t){var e=[];if(!t)return e;var r=1;return(t.match(Gn)||[]).forEach(function(n){var s=pt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function aL(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ht(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function oL(t,e,r){var n=[];return Ra(t,function(i,o,c){switch(c){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function lL(t,e,r,n){if(!t)return t;var s=n||{},i=!1;Ra(t,function(c,u,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},s)}function cL(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var pc=1024;function Bk(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[He("xml",null,{"xmlns:v":bs.v,"xmlns:o":bs.o,"xmlns:x":bs.x,"xmlns:mv":bs.mv}).replace(/\/>/,">"),He("o:shapelayout",He("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),He("v:shapetype",[He("v:stroke",null,{joinstyle:"miter"}),He("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];pc<t*1e3;)pc+=1e3;return e.forEach(function(i){var o=Tr(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var u=c.type=="gradient"?He("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=He("v:fill",u,c),d={on:"t",obscured:"t"};++pc,s=s.concat(["<v:shape"+pf({id:"_x0000_s"+pc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,He("v:shadow",null,d),He("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",yn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),yn("x:AutoFill","False"),yn("x:Row",String(o.r)),yn("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function xw(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(o){var c=Tr(o.ref);if(s?(t[c.r]||(t[c.r]=[]),i=t[c.r][c.c]):i=t[o.ref],!i){i={t:"z"},s?t[c.r][c.c]=i:t[o.ref]=i;var u=Wt(t["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var h=Et(u);h!==t["!ref"]&&(t["!ref"]=h)}i.c||(i.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var g=i.c.length-1;g>=0;--g){if(!r&&i.c[g].T)return;r&&!i.c[g].T&&i.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(d.a==n[g].id){d.a=n[g].name||d.a;break}}i.c.push(d)})}function uL(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=pt(c[0]),h={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Tr(u.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!g&&!!g[1]&&ox(g[1])||{r:"",t:"",h:""};h.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),h.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=x.h),n.push(h)}}}}),n}function Uk(t){var e=[Lr,He("comments",null,{xmlns:El[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var i=nr(s.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(u){u.a&&(s=r.indexOf(nr(u.a))),i.push(u.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)e.push(yn("t",nr(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)o+=`Reply:
    `+i[c]+`
`;e.push(yn("t",nr(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function fL(t,e){var r=[],n=!1,s={},i=0;return t.replace(Gn,function(c,u){var h=pt(c);switch(Yi(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=u+c.length;break;case"</text>":s.t=t.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),r}function hL(t,e,r){var n=[Lr,He("ThreadedComments",null,{xmlns:Yr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var u={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=u.id:u.parentId=i,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(He("threadedComment",yn("text",o.t||""),u))})}),n.push("</ThreadedComments>"),n.join("")}function dL(t,e){var r=[],n=!1;return t.replace(Gn,function(i){var o=pt(i);switch(Yi(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function pL(t){var e=[Lr,He("personList",null,{xmlns:Yr.TCMNT,"xmlns:x":El[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(He("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function mL(t){var e={};e.iauthor=t.read_shift(4);var r=Al(t);return e.rfx=r.s,e.ref=ht(r.s),t.l+=16,e}function gL(t,e){return e==null&&(e=ge(36)),e.write_shift(4,t[1].iauthor),$c(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var xL=Hn;function vL(t){return on(t.slice(0,54))}function _L(t,e){var r=[],n=[],s={},i=!1;return Ra(t,function(c,u,h){switch(h){case 632:n.push(c);break;case 635:s=c;break;case 637:s.t=c.t,s.h=c.h,s.r=c.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function yL(t){var e=_s(),r=[];return Ce(e,628),Ce(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Ce(e,632,vL(s.a)))})}),Ce(e,631),Ce(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Tr(n[0]),e:Tr(n[0])};Ce(e,635,gL([i,s])),s.t&&s.t.length>0&&Ce(e,637,zD(s)),Ce(e,636),delete s.iauthor})}),Ce(e,634),Ce(e,629),e.end()}var wL="application/vnd.ms-office.vbaProject";function EL(t){var e=nt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");nt.utils.cfb_add(e,s,t.FileIndex[n].content)}}),nt.write(e)}function TL(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&nt.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var jk=["xlsb","xlsm","xlam","biff8","xla"];function SL(){return{"!type":"dialog"}}function kL(){return{"!type":"dialog"}}function AL(){return{"!type":"macro"}}function CL(){return{"!type":"macro"}}var wc=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,o){var c=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var h=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return c?d+=e.c:--d,u?h+=e.r:--h,s+(c?"":"$")+Er(d)+(u?"":"$")+Or(h)}return function(s,i){return e=i,s.replace(t,r)}})(),fx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,hx=(function(){return function(e,r){return e.replace(fx,function(n,s,i,o,c,u){var h=J1(o)-(i?0:r.c),d=Q1(u)-(c?0:r.r),g=d==0?"":c?d+1:"["+d+"]",x=h==0?"":i?h+1:"["+h+"]";return s+"R"+g+"C"+x})}})();function zk(t,e){return t.replace(fx,function(r,n,s,i,o,c){return n+(s=="$"?s+i:Er(J1(i)+e.c))+(o=="$"?o+c:Or(Q1(c)+e.r))})}function IL(t,e,r){var n=ys(e),s=n.s,i=Tr(r),o={r:i.r-s.r,c:i.c-s.c};return zk(t,o)}function FL(t){return t.length!=1}function vw(t){return t.replace(/_xlfn\./g,"")}function Br(t){t.l+=1}function To(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Hk(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Wk(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),o=To(t),c=To(t);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function Wk(t){var e=To(t),r=To(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function RL(t,e,r){if(r.biff<8)return Wk(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=To(t),o=To(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function $k(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return NL(t);var n=t.read_shift(r&&r.biff==12?4:2),s=To(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function NL(t){var e=To(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function bL(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function DL(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return PL(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:c}}function PL(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function OL(t,e,r){var n=(t[t.l++]&96)>>5,s=Hk(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function LL(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=Hk(t,i,r);return[n,s,o]}function ML(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function VL(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function BL(t,e,r){var n=(t[t.l++]&96)>>5,s=RL(t,e-1,r);return[n,s]}function UL(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function _w(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function jL(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function zL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function HL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function WL(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function $L(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Gk(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function GL(t){return t.read_shift(2),Gk(t)}function qL(t){return t.read_shift(2),Gk(t)}function KL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=$k(t,0,r);return[n,s]}function XL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=DL(t,0,r);return[n,s]}function YL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=$k(t,0,r);return[n,s,i]}function QL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[e9[s],Xk[s],n]}function JL(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:ZL(t);return[s,(i[0]===0?Xk:ZM)[i[1]]]}function ZL(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function eM(t,e,r){t.l+=r&&r.biff==2?3:4}function tM(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function rM(t){return t.l++,Na[t.read_shift(1)]}function nM(t){return t.l++,t.read_shift(2)}function sM(t){return t.l++,t.read_shift(1)!==0}function iM(t){return t.l++,zn(t)}function aM(t,e,r){return t.l++,zf(t,e-1,r)}function oM(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Dr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Na[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=zn(t);break;case 2:r[1]=Cl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function lM(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Al:bd)(t));return s}function cM(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var c=0;c!=s;++c)o[i][c]=oM(t,r.biff);return o}function uM(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function fM(t,e,r){if(r.biff==5)return hM(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function hM(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function dM(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function pM(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function mM(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function gM(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var xM=$n,vM=$n,_M=$n;function Wf(t,e,r){return t.l+=2,[bL(t)]}function dx(t){return t.l+=6,[]}var yM=Wf,wM=dx,EM=dx,TM=Wf;function qk(t){return t.l+=2,[zr(t),t.read_shift(2)&1]}var SM=Wf,kM=qk,AM=dx,CM=Wf,IM=Wf,FM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function RM(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),o=FM[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:s,C:i}}function NM(t){return t.l+=2,[t.read_shift(4)]}function bM(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function DM(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function PM(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function OM(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function LM(t){return t.l+=4,[0,0]}var yw={1:{n:"PtgExp",f:tM},2:{n:"PtgTbl",f:_M},3:{n:"PtgAdd",f:Br},4:{n:"PtgSub",f:Br},5:{n:"PtgMul",f:Br},6:{n:"PtgDiv",f:Br},7:{n:"PtgPower",f:Br},8:{n:"PtgConcat",f:Br},9:{n:"PtgLt",f:Br},10:{n:"PtgLe",f:Br},11:{n:"PtgEq",f:Br},12:{n:"PtgGe",f:Br},13:{n:"PtgGt",f:Br},14:{n:"PtgNe",f:Br},15:{n:"PtgIsect",f:Br},16:{n:"PtgUnion",f:Br},17:{n:"PtgRange",f:Br},18:{n:"PtgUplus",f:Br},19:{n:"PtgUminus",f:Br},20:{n:"PtgPercent",f:Br},21:{n:"PtgParen",f:Br},22:{n:"PtgMissArg",f:Br},23:{n:"PtgStr",f:aM},26:{n:"PtgSheet",f:bM},27:{n:"PtgEndSheet",f:DM},28:{n:"PtgErr",f:rM},29:{n:"PtgBool",f:sM},30:{n:"PtgInt",f:nM},31:{n:"PtgNum",f:iM},32:{n:"PtgArray",f:UL},33:{n:"PtgFunc",f:QL},34:{n:"PtgFuncVar",f:JL},35:{n:"PtgName",f:uM},36:{n:"PtgRef",f:KL},37:{n:"PtgArea",f:OL},38:{n:"PtgMemArea",f:dM},39:{n:"PtgMemErr",f:xM},40:{n:"PtgMemNoMem",f:vM},41:{n:"PtgMemFunc",f:pM},42:{n:"PtgRefErr",f:mM},43:{n:"PtgAreaErr",f:ML},44:{n:"PtgRefN",f:XL},45:{n:"PtgAreaN",f:BL},46:{n:"PtgMemAreaN",f:PM},47:{n:"PtgMemNoMemN",f:OM},57:{n:"PtgNameX",f:fM},58:{n:"PtgRef3d",f:YL},59:{n:"PtgArea3d",f:LL},60:{n:"PtgRefErr3d",f:gM},61:{n:"PtgAreaErr3d",f:VL},255:{}},MM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},VM={1:{n:"PtgElfLel",f:qk},2:{n:"PtgElfRw",f:CM},3:{n:"PtgElfCol",f:yM},6:{n:"PtgElfRwV",f:IM},7:{n:"PtgElfColV",f:TM},10:{n:"PtgElfRadical",f:SM},11:{n:"PtgElfRadicalS",f:AM},13:{n:"PtgElfColS",f:wM},15:{n:"PtgElfColSV",f:EM},16:{n:"PtgElfRadicalLel",f:kM},25:{n:"PtgList",f:RM},29:{n:"PtgSxName",f:NM},255:{}},BM={0:{n:"PtgAttrNoop",f:LM},1:{n:"PtgAttrSemi",f:$L},2:{n:"PtgAttrIf",f:HL},4:{n:"PtgAttrChoose",f:jL},8:{n:"PtgAttrGoto",f:zL},16:{n:"PtgAttrSum",f:eM},32:{n:"PtgAttrBaxcel",f:_w},33:{n:"PtgAttrBaxcel",f:_w},64:{n:"PtgAttrSpace",f:GL},65:{n:"PtgAttrSpaceSemi",f:qL},128:{n:"PtgAttrIfError",f:WL},255:{}};function $f(t,e,r,n){if(n.biff<8)return $n(t,e);for(var s=t.l+e,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=cM(t,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=lM(t,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=s-t.l,e!==0&&i.push($n(t,e)),i}function Gf(t,e,r){for(var n=t.l+e,s,i,o=[];n!=t.l;)e=n-t.l,i=t[t.l],s=yw[i]||yw[MM[i]],(i===24||i===25)&&(s=(i===24?VM:BM)[t[t.l+1]]),!s||!s.f?$n(t,e):o.push([s.n,s.f(t,e,r)]);return o}function UM(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var jM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zM(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Kk(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ww(t,e,r){var n=Kk(t,e,r);return n=="#REF"?n:zM(n,r)}function Bn(t,e,r,n,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},c=[],u,h,d,g=0,x=0,_,k="";if(!t[0]||!t[0][0])return"";for(var y=-1,S="",R=0,M=t[0].length;R<M;++R){var N=t[0][R];switch(N[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),h=c.pop(),y>=0){switch(t[0][y][1][0]){case 0:S=Ar(" ",t[0][y][1][1]);break;case 1:S=Ar("\r",t[0][y][1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}h=h+S,y=-1}c.push(h+jM[N[0]]+u);break;case"PtgIsect":u=c.pop(),h=c.pop(),c.push(h+" "+u);break;case"PtgUnion":u=c.pop(),h=c.pop(),c.push(h+","+u);break;case"PtgRange":u=c.pop(),h=c.pop(),c.push(h+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=$u(N[1][1],o,s),c.push(Gu(d,i));break;case"PtgRefN":d=r?$u(N[1][1],r,s):N[1][1],c.push(Gu(d,i));break;case"PtgRef3d":g=N[1][1],d=$u(N[1][2],o,s),k=ww(n,g,s),c.push(k+"!"+Gu(d,i));break;case"PtgFunc":case"PtgFuncVar":var V=N[1][0],W=N[1][1];V||(V=0),V&=127;var j=V==0?[]:c.slice(-V);c.length-=V,W==="User"&&(W=j.shift()),c.push(W+"("+j.join(",")+")");break;case"PtgBool":c.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(N[1]);break;case"PtgNum":c.push(String(N[1]));break;case"PtgStr":c.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(N[1]);break;case"PtgAreaN":_=Y2(N[1][1],r?{s:r}:o,s),c.push(Cm(_,s));break;case"PtgArea":_=Y2(N[1][1],o,s),c.push(Cm(_,s));break;case"PtgArea3d":g=N[1][1],_=N[1][2],k=ww(n,g,s),c.push(k+"!"+Cm(_,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=N[1][2];var A=(n.names||[])[x-1]||(n[0]||[])[x],F=A?A.Name:"SH33TJSNAME"+String(x);F&&F.slice(0,6)=="_xlfn."&&!s.xlfn&&(F=F.slice(6)),c.push(F);break;case"PtgNameX":var I=N[1][1];x=N[1][2];var U;if(s.biff<=5)I<0&&(I=-I),n[I]&&(U=n[I][x]);else{var L="";if(((n[I]||[])[0]||[])[0]==14849||(((n[I]||[])[0]||[])[0]==1025?n[I][x]&&n[I][x].itab>0&&(L=n.SheetNames[n[I][x].itab-1]+"!"):L=n.SheetNames[x-1]+"!"),n[I]&&n[I][x])L+=n[I][x].Name;else if(n[0]&&n[0][x])L+=n[0][x].Name;else{var D=(Kk(n,I,s)||"").split(";;");D[x-1]?L=D[x-1]:L+="SH33TJSERRX"}c.push(L);break}U||(U={Name:"SH33TJSERRY"}),c.push(U.Name);break;case"PtgParen":var B="(",De=")";if(y>=0){switch(S="",t[0][y][1][0]){case 2:B=Ar(" ",t[0][y][1][1])+B;break;case 3:B=Ar("\r",t[0][y][1][1])+B;break;case 4:De=Ar(" ",t[0][y][1][1])+De;break;case 5:De=Ar("\r",t[0][y][1][1])+De;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}y=-1}c.push(B+c.pop()+De);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:N[1][1],r:N[1][0]};var Re={c:r.c,r:r.r};if(n.sharedf[ht(d)]){var Ve=n.sharedf[ht(d)];c.push(Bn(Ve,o,Re,n,s))}else{var Le=!1;for(u=0;u!=n.arrayf.length;++u)if(h=n.arrayf[u],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){c.push(Bn(h[1],o,Re,n,s)),Le=!0;break}Le||c.push(N[1])}break;case"PtgArray":c.push("{"+UM(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=R;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var Ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&Ae.indexOf(t[0][R][0])==-1){N=t[0][y];var ne=!0;switch(N[1][0]){case 4:ne=!1;case 0:S=Ar(" ",N[1][1]);break;case 5:ne=!1;case 1:S=Ar("\r",N[1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}c.push((ne?S:"")+c.pop()+(ne?"":S)),y=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function HM(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,o=t.read_shift(s);if(o==65535)return[[],$n(t,e-2)];var c=Gf(t,o,r);return e!==o+s&&(i=$f(t,e-o-s,c,r)),t.l=n,[c,i]}function WM(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,o=t.read_shift(s);if(o==65535)return[[],$n(t,e-2)];var c=Gf(t,o,r);return e!==o+s&&(i=$f(t,e-o-s,c,r)),t.l=n,[c,i]}function $M(t,e,r,n){var s=t.l+e,i=Gf(t,n,r),o;return s!==t.l&&(o=$f(t,s-t.l,i,r)),[i,o]}function GM(t,e,r){var n=t.l+e,s,i=t.read_shift(2),o=Gf(t,i,r);return i==65535?[[],$n(t,e-2)]:(e!==i+2&&(s=$f(t,n-i-2,o,r)),[o,s])}function qM(t){var e;if(ma(t,t.l+6)!==65535)return[zn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function KM(t){if(t==null){var e=ge(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return gl(t);return gl(0)}function bm(t,e,r){var n=t.l+e,s=Qi(t);r.biff==2&&++t.l;var i=qM(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var c=WM(t,n-t.l,r);return{cell:s,val:i[0],formula:c,shared:o>>3&1,tt:i[1]}}function XM(t,e,r,n,s){var i=vl(e,r,s),o=KM(t.v),c=ge(6),u=33;c.write_shift(2,u),c.write_shift(4,0);for(var h=ge(t.bf.length),d=0;d<t.bf.length;++d)h[d]=t.bf[d];var g=an([i,o,c,h]);return g}function Dd(t,e,r){var n=t.read_shift(4),s=Gf(t,n,r),i=t.read_shift(4),o=i>0?$f(t,i,s,r):null;return[s,o]}var YM=Dd,Pd=Dd,QM=Dd,JM=Dd,ZM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Xk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},e9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ew(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function t9(t){var e="of:="+t.replace(fx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Dm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function r9(t){return t.replace(/\./,"!")}var Ku={},Ec={},Xu=typeof Map<"u";function px(t,e,r){var n=0,s=t.length;if(r){if(Xu?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=Xu?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(Xu?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function Od(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(jn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=_f(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=rd(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function il(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Ro(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,i=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){_a(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=i;++s)if(t[s].numFmtId===n)return s;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Yk(t,e,r,n,s,i){try{n.cellNF&&(t.z=ct[e])}catch(c){if(n.WTF)throw c}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=mr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ct[e]==null&&_a(Zb[e]||"General",e),t.t==="e")t.w=t.w||Na[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=hf(t.v);else if(t.t==="d"){var o=Jr(t.v);(o|0)===o?t.w=o.toString(10):t.w=hf(o)}else{if(t.v===void 0)return"";t.w=pl(t.v,Ec)}else t.t==="d"?t.w=ti(e,Jr(t.v),Ec):t.w=ti(e,t.v,Ec)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=td(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=td(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function n9(t,e,r){if(t&&t["!ref"]){var n=Wt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function s9(t,e){var r=Wt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Et(r))}var i9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,a9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,o9=/<(?:\w:)?hyperlink [^>]*>/mg,l9=/"(\w*:\w*)"/,c9=/<(?:\w:)?col\b[^>]*[\/]?>/g,u9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,f9=/<(?:\w:)?pageMargins[^>]*\/>/g,Qk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,h9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,d9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function p9(t,e,r,n,s,i,o){if(!t)return t;n||(n={"!id":{}});var c=e.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",d="",g=t.match(a9);g?(h=t.slice(0,g.index),d=t.slice(g.index+g[0].length)):h=d=t;var x=h.match(Qk);x?mx(x[0],c,s,r):(x=h.match(h9))&&g9(x[0],x[1]||"",c,s,r);var _=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var k=h.slice(_,_+50).match(l9);k&&s9(c,k[1])}var y=h.match(d9);y&&y[1]&&F9(y[1],s);var S=[];if(e.cellStyles){var R=h.match(c9);R&&S9(S,R)}g&&b9(g[1],c,e,u,i,o);var M=d.match(u9);M&&(c["!autofilter"]=A9(M[0]));var N=[],V=d.match(i9);if(V)for(_=0;_!=V.length;++_)N[_]=Wt(V[_].slice(V[_].indexOf('"')+1));var W=d.match(o9);W&&w9(c,W,n);var j=d.match(f9);if(j&&(c["!margins"]=E9(pt(j[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=Et(u)),e.sheetRows>0&&c["!ref"]){var A=Wt(c["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>u.e.r&&(A.e.r=u.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>u.e.c&&(A.e.c=u.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Et(A))}return S.length>0&&(c["!cols"]=S),N.length>0&&(c["!merges"]=N),c}function m9(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Et(t[r])+'"/>';return e+"</mergeCells>"}function mx(t,e,r,n){var s=pt(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Ht(ir(s.codeName)))}function g9(t,e,r,n,s){mx(t.slice(0,t.indexOf(">")),r,n,s)}function x9(t,e,r,n,s){var i=!1,o={},c=null;if(n.bookType!=="xlsx"&&e.vbaraw){var u=e.SheetNames[r];try{e.Workbook&&(u=e.Workbook.Sheets[r].CodeName||u)}catch{}i=!0,o.codeName=ji(nr(u))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),c=(c||"")+He("outlinePr",null,h)}!i&&!c||(s[s.length]=He("sheetPr",c,o))}var v9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],_9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function y9(t){var e={sheet:1};return v9.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),_9.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=lx(t.password).toString(16).toUpperCase()),He("sheetProtection",null,e)}function w9(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=pt(ir(e[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Ht(i.location))):(i.Target="#"+Ht(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=Wt(i.ref),u=c.s.r;u<=c.e.r;++u)for(var h=c.s.c;h<=c.e.c;++h){var d=ht({c:h,r:u});n?(t[u]||(t[u]=[]),t[u][h]||(t[u][h]={t:"z",v:void 0}),t[u][h].l=i):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=i)}}}function E9(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function T9(t){return il(t),He("pageMargins",null,t)}function S9(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=pt(e[n],!0);s.hidden&&(s.hidden=dr(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,cx(s.width)),Eo(s);i<=o;)t[i++]=gr(s)}}function k9(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=He("col",null,Od(s,n)));return r[r.length]="</cols>",r.join("")}function A9(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function C9(t,e,r,n){var s=typeof t.ref=="string"?t.ref:Et(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=ys(s);o.s.r==o.e.r&&(o.e.r=ys(e["!ref"]).e.r,s=Et(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),He("autoFilter",null,{ref:s})}var I9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function F9(t,e){e.Views||(e.Views=[{}]),(t.match(I9)||[]).forEach(function(r,n){var s=pt(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),dr(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function R9(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),He("sheetViews",He("sheetView",null,s),{})}function N9(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=Na[t.v];break;case"d":n&&n.cellDates?s=mr(t.v,-1).toISOString():(t=gr(t),t.t="n",s=""+(t.v=Jr(mr(t.v)))),typeof t.z>"u"&&(t.z=ct[14]);break;default:s=t.v;break}var c=yn("v",nr(s)),u={r:e},h=Ro(n.cellXfs,t,n);switch(h!==0&&(u.s=h),t.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=yn("v",""+px(n.Strings,t.v,n.revStrings)),u.t="s";break}u.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;c=He("f",nr(t.f),d)+(t.v!=null?c:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(u.cm=1),He("c",c,u)}var b9=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=df("v"),o=df("f");return function(u,h,d,g,x,_){for(var k=0,y="",S=[],R=[],M=0,N=0,V=0,W="",j,A,F=0,I=0,U,L,D=0,B=0,De=Array.isArray(_.CellXf),Re,Ve=[],Le=[],Ae=Array.isArray(h),ne=[],we={},ee=!1,O=!!d.sheetStubs,te=u.split(e),J=0,Z=te.length;J!=Z;++J){y=te[J].trim();var oe=y.length;if(oe!==0){var _e=0;e:for(k=0;k<oe;++k)switch(y[k]){case">":if(y[k-1]!="/"){++k;break e}if(d&&d.cellStyles){if(A=pt(y.slice(_e,k),!0),F=A.r!=null?parseInt(A.r,10):F+1,I=-1,d.sheetRows&&d.sheetRows<F)continue;we={},ee=!1,A.ht&&(ee=!0,we.hpt=parseFloat(A.ht),we.hpx=Dc(we.hpt)),A.hidden=="1"&&(ee=!0,we.hidden=!0),A.outlineLevel!=null&&(ee=!0,we.level=+A.outlineLevel),ee&&(ne[F-1]=we)}break;case"<":_e=k;break}if(_e>=k)break;if(A=pt(y.slice(_e,k),!0),F=A.r!=null?parseInt(A.r,10):F+1,I=-1,!(d.sheetRows&&d.sheetRows<F)){g.s.r>F-1&&(g.s.r=F-1),g.e.r<F-1&&(g.e.r=F-1),d&&d.cellStyles&&(we={},ee=!1,A.ht&&(ee=!0,we.hpt=parseFloat(A.ht),we.hpx=Dc(we.hpt)),A.hidden=="1"&&(ee=!0,we.hidden=!0),A.outlineLevel!=null&&(ee=!0,we.level=+A.outlineLevel),ee&&(ne[F-1]=we)),S=y.slice(k).split(t);for(var ve=0;ve!=S.length&&S[ve].trim().charAt(0)=="<";++ve);for(S=S.slice(ve),k=0;k!=S.length;++k)if(y=S[k].trim(),y.length!==0){if(R=y.match(r),M=k,N=0,V=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,R!=null&&R.length===2){for(M=0,W=R[1],N=0;N!=W.length&&!((V=W.charCodeAt(N)-64)<1||V>26);++N)M=26*M+V;--M,I=M}else++I;for(N=0;N!=y.length&&y.charCodeAt(N)!==62;++N);if(++N,A=pt(y.slice(0,N),!0),A.r||(A.r=ht({r:F-1,c:I})),W=y.slice(N),j={t:""},(R=W.match(i))!=null&&R[1]!==""&&(j.v=Ht(R[1])),d.cellFormula){if((R=W.match(o))!=null&&R[1]!==""){if(j.f=Ht(ir(R[1])).replace(/\r\n/g,`
`),d.xlfn||(j.f=vw(j.f)),R[0].indexOf('t="array"')>-1)j.F=(W.match(s)||[])[1],j.F.indexOf(":")>-1&&Ve.push([Wt(j.F),j.F]);else if(R[0].indexOf('t="shared"')>-1){L=pt(R[0]);var xe=Ht(ir(R[1]));d.xlfn||(xe=vw(xe)),Le[parseInt(L.si,10)]=[L,xe,A.r]}}else(R=W.match(/<f[^>]*\/>/))&&(L=pt(R[0]),Le[L.si]&&(j.f=IL(Le[L.si][1],Le[L.si][2],A.r)));var Te=Tr(A.r);for(N=0;N<Ve.length;++N)Te.r>=Ve[N][0].s.r&&Te.r<=Ve[N][0].e.r&&Te.c>=Ve[N][0].s.c&&Te.c<=Ve[N][0].e.c&&(j.F=Ve[N][1])}if(A.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(O)j.t="z";else continue;else j.t=A.t||"n";switch(g.s.c>I&&(g.s.c=I),g.e.c<I&&(g.e.c=I),j.t){case"n":if(j.v==""||j.v==null){if(!O)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!O)continue;j.t="z"}else U=Ku[parseInt(j.v,10)],j.v=U.t,j.r=U.r,d.cellHTML&&(j.h=U.h);break;case"str":j.t="s",j.v=j.v!=null?ir(j.v):"",d.cellHTML&&(j.h=q1(j.v));break;case"inlineStr":R=W.match(n),j.t="s",R!=null&&(U=ox(R[1]))?(j.v=U.t,d.cellHTML&&(j.h=U.h)):j.v="";break;case"b":j.v=dr(j.v);break;case"d":d.cellDates?j.v=mr(j.v,1):(j.v=Jr(mr(j.v,1)),j.t="n");break;case"e":(!d||d.cellText!==!1)&&(j.w=j.v),j.v=ZS[j.v];break}if(D=B=0,Re=null,De&&A.s!==void 0&&(Re=_.CellXf[A.s],Re!=null&&(Re.numFmtId!=null&&(D=Re.numFmtId),d.cellStyles&&Re.fillId!=null&&(B=Re.fillId))),Yk(j,D,B,d,x,_),d.cellDates&&De&&j.t=="n"&&zc(ct[D])&&(j.t="d",j.v=Nd(j.v)),A.cm&&d.xlmeta){var ut=(d.xlmeta.Cell||[])[+A.cm-1];ut&&ut.type=="XLDAPR"&&(j.D=!0)}if(Ae){var Y=Tr(A.r);h[Y.r]||(h[Y.r]=[]),h[Y.r][Y.c]=j}else h[A.r]=j}}}}ne.length>0&&(h["!rows"]=ne)}})();function D9(t,e,r,n){var s=[],i=[],o=Wt(t["!ref"]),c="",u,h="",d=[],g=0,x=0,_=t["!rows"],k=Array.isArray(t),y={r:h},S,R=-1;for(x=o.s.c;x<=o.e.c;++x)d[x]=Er(x);for(g=o.s.r;g<=o.e.r;++g){for(i=[],h=Or(g),x=o.s.c;x<=o.e.c;++x){u=d[x]+h;var M=k?(t[g]||[])[x]:t[u];M!==void 0&&(c=N9(M,u,t,e))!=null&&i.push(c)}(i.length>0||_&&_[g])&&(y={r:h},_&&_[g]&&(S=_[g],S.hidden&&(y.hidden=1),R=-1,S.hpx?R=yf(S.hpx):S.hpt&&(R=S.hpt),R>-1&&(y.ht=R,y.customHeight=1),S.level&&(y.outlineLevel=S.level)),s[s.length]=He("row",i.join(""),y))}if(_)for(;g<_.length;++g)_&&_[g]&&(y={r:g+1},S=_[g],S.hidden&&(y.hidden=1),R=-1,S.hpx?R=yf(S.hpx):S.hpt&&(R=S.hpt),R>-1&&(y.ht=R,y.customHeight=1),S.level&&(y.outlineLevel=S.level),s[s.length]=He("row","",y));return s.join("")}function Jk(t,e,r,n){var s=[Lr,He("worksheet",null,{xmlns:El[0],"xmlns:r":Yr.r})],i=r.SheetNames[t],o=0,c="",u=r.Sheets[i];u==null&&(u={});var h=u["!ref"]||"A1",d=Wt(h);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),h=Et(d)}n||(n={}),u["!comments"]=[];var g=[];x9(u,r,t,e,s),s[s.length]=He("dimension",null,{ref:h}),s[s.length]=R9(u,e,t,r),e.sheetFormat&&(s[s.length]=He("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(s[s.length]=k9(u,u["!cols"])),s[o=s.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(c=D9(u,e),c.length>0&&(s[s.length]=c)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),u["!protect"]&&(s[s.length]=y9(u["!protect"])),u["!autofilter"]!=null&&(s[s.length]=C9(u["!autofilter"],u,r,t)),u["!merges"]!=null&&u["!merges"].length>0&&(s[s.length]=m9(u["!merges"]));var x=-1,_,k=-1;return u["!links"].length>0&&(s[s.length]="<hyperlinks>",u["!links"].forEach(function(y){y[1].Target&&(_={ref:y[0]},y[1].Target.charAt(0)!="#"&&(k=rr(n,-1,nr(y[1].Target).replace(/#.*$/,""),Ft.HLINK),_["r:id"]="rId"+k),(x=y[1].Target.indexOf("#"))>-1&&(_.location=nr(y[1].Target.slice(x+1))),y[1].Tooltip&&(_.tooltip=nr(y[1].Tooltip)),s[s.length]=He("hyperlink",null,_))}),s[s.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(s[s.length]=T9(u["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=yn("ignoredErrors",He("ignoredError",null,{numberStoredAsText:1,sqref:h}))),g.length>0&&(k=rr(n,-1,"../drawings/drawing"+(t+1)+".xml",Ft.DRAW),s[s.length]=He("drawing",null,{"r:id":"rId"+k}),u["!drawing"]=g),u["!comments"].length>0&&(k=rr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ft.VML),s[s.length]=He("legacyDrawing",null,{"r:id":"rId"+k}),u["!legacy"]=k),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function P9(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function O9(t,e,r){var n=ge(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;s.hpx?i=yf(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var c=0,u=n.l;n.l+=4;for(var h={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var g=-1,x=-1,_=d<<10;_<d+1<<10;++_){h.c=_;var k=Array.isArray(r)?(r[h.r]||[])[h.c]:r[ht(h)];k&&(g<0&&(g=_),x=_)}g<0||(++c,n.write_shift(4,g),n.write_shift(4,x))}var y=n.l;return n.l=u,n.write_shift(4,c),n.l=y,n.length>n.l?n.slice(0,n.l):n}function L9(t,e,r,n){var s=O9(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&Ce(t,0,s)}var M9=Al,V9=$c;function B9(){}function U9(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=HD(t),r}function j9(t,e,r){r==null&&(r=ge(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return J0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),KS(t,r),r.slice(0,r.l)}function z9(t){var e=ri(t);return[e]}function H9(t,e,r){return r==null&&(r=ge(8)),Tl(e,r)}function W9(t){var e=Sl(t);return[e]}function $9(t,e,r){return r==null&&(r=ge(4)),kl(e,r)}function G9(t){var e=ri(t),r=t.read_shift(1);return[e,r,"b"]}function q9(t,e,r){return r==null&&(r=ge(9)),Tl(e,r),r.write_shift(1,t.v?1:0),r}function K9(t){var e=Sl(t),r=t.read_shift(1);return[e,r,"b"]}function X9(t,e,r){return r==null&&(r=ge(5)),kl(e,r),r.write_shift(1,t.v?1:0),r}function Y9(t){var e=ri(t),r=t.read_shift(1);return[e,r,"e"]}function Q9(t,e,r){return r==null&&(r=ge(9)),Tl(e,r),r.write_shift(1,t.v),r}function J9(t){var e=Sl(t),r=t.read_shift(1);return[e,r,"e"]}function Z9(t,e,r){return r==null&&(r=ge(8)),kl(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function e7(t){var e=ri(t),r=t.read_shift(4);return[e,r,"s"]}function t7(t,e,r){return r==null&&(r=ge(12)),Tl(e,r),r.write_shift(4,e.v),r}function r7(t){var e=Sl(t),r=t.read_shift(4);return[e,r,"s"]}function n7(t,e,r){return r==null&&(r=ge(8)),kl(e,r),r.write_shift(4,e.v),r}function s7(t){var e=ri(t),r=zn(t);return[e,r,"n"]}function i7(t,e,r){return r==null&&(r=ge(16)),Tl(e,r),gl(t.v,r),r}function Zk(t){var e=Sl(t),r=zn(t);return[e,r,"n"]}function a7(t,e,r){return r==null&&(r=ge(12)),kl(e,r),gl(t.v,r),r}function o7(t){var e=ri(t),r=rx(t);return[e,r,"n"]}function l7(t,e,r){return r==null&&(r=ge(12)),Tl(e,r),XS(t.v,r),r}function c7(t){var e=Sl(t),r=rx(t);return[e,r,"n"]}function u7(t,e,r){return r==null&&(r=ge(8)),kl(e,r),XS(t.v,r),r}function f7(t){var e=ri(t),r=Z1(t);return[e,r,"is"]}function h7(t){var e=ri(t),r=Hn(t);return[e,r,"str"]}function d7(t,e,r){return r==null&&(r=ge(12+4*t.v.length)),Tl(e,r),on(t.v,r),r.length>r.l?r.slice(0,r.l):r}function p7(t){var e=Sl(t),r=Hn(t);return[e,r,"str"]}function m7(t,e,r){return r==null&&(r=ge(8+4*t.v.length)),kl(e,r),on(t.v,r),r.length>r.l?r.slice(0,r.l):r}function g7(t,e,r){var n=t.l+e,s=ri(t);s.r=r["!row"];var i=t.read_shift(1),o=[s,i,"b"];if(r.cellFormula){t.l+=2;var c=Pd(t,n-t.l,r);o[3]=Bn(c,null,s,r.supbooks,r)}else t.l=n;return o}function x7(t,e,r){var n=t.l+e,s=ri(t);s.r=r["!row"];var i=t.read_shift(1),o=[s,i,"e"];if(r.cellFormula){t.l+=2;var c=Pd(t,n-t.l,r);o[3]=Bn(c,null,s,r.supbooks,r)}else t.l=n;return o}function v7(t,e,r){var n=t.l+e,s=ri(t);s.r=r["!row"];var i=zn(t),o=[s,i,"n"];if(r.cellFormula){t.l+=2;var c=Pd(t,n-t.l,r);o[3]=Bn(c,null,s,r.supbooks,r)}else t.l=n;return o}function _7(t,e,r){var n=t.l+e,s=ri(t);s.r=r["!row"];var i=Hn(t),o=[s,i,"str"];if(r.cellFormula){t.l+=2;var c=Pd(t,n-t.l,r);o[3]=Bn(c,null,s,r.supbooks,r)}else t.l=n;return o}var y7=Al,w7=$c;function E7(t,e){return e==null&&(e=ge(4)),e.write_shift(4,t),e}function T7(t,e){var r=t.l+e,n=Al(t),s=ex(t),i=Hn(t),o=Hn(t),c=Hn(t);t.l=r;var u={rfx:n,relId:s,loc:i,display:c};return o&&(u.Tooltip=o),u}function S7(t,e){var r=ge(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));$c({s:Tr(t[0]),e:Tr(t[0])},r),tx("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return on(s||"",r),on(t[1].Tooltip||"",r),on("",r),r.slice(0,r.l)}function k7(){}function A7(t,e,r){var n=t.l+e,s=YS(t),i=t.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var c=YM(t,n-t.l,r);o[1]=c}else t.l=n;return o}function C7(t,e,r){var n=t.l+e,s=Al(t),i=[s];if(r.cellFormula){var o=JM(t,n-t.l,r);i[1]=o,t.l=n}else t.l=n;return i}function I7(t,e,r){r==null&&(r=ge(18));var n=Od(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var e4=["left","right","top","bottom","header","footer"];function F7(t){var e={};return e4.forEach(function(r){e[r]=zn(t)}),e}function R7(t,e){return e==null&&(e=ge(48)),il(t),e4.forEach(function(r){gl(t[r],e)}),e}function N7(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function b7(t,e,r){r==null&&(r=ge(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function D7(t){var e=ge(24);return e.write_shift(4,4),e.write_shift(4,1),$c(t,e),e}function P7(t,e){return e==null&&(e=ge(66)),e.write_shift(2,t.password?lx(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function O7(){}function L7(){}function M7(t,e,r,n,s,i,o){if(!t)return t;var c=e||{};n||(n={"!id":{}});var u=c.dense?[]:{},h,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,x=!1,_,k,y,S,R,M,N,V,W,j=[];c.biff=12,c["!row"]=0;var A=0,F=!1,I=[],U={},L=c.supbooks||s.supbooks||[[]];if(L.sharedf=U,L.arrayf=I,L.SheetNames=s.SheetNames||s.Sheets.map(function(Ae){return Ae.name}),!c.supbooks&&(c.supbooks=L,s.Names))for(var D=0;D<s.Names.length;++D)L[0][D+1]=s.Names[D];var B=[],De=[],Re=!1;wf[16]={n:"BrtShortReal",f:Zk};var Ve;if(Ra(t,function(ne,we,ee){if(!x)switch(ee){case 148:h=ne;break;case 0:_=ne,c.sheetRows&&c.sheetRows<=_.r&&(x=!0),V=Or(S=_.r),c["!row"]=_.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=Dc(ne.hpt)),De[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:ne[2]},ne[2]){case"n":k.v=ne[1];break;case"s":N=Ku[ne[1]],k.v=N.t,k.r=N.r;break;case"b":k.v=!!ne[1];break;case"e":k.v=ne[1],c.cellText!==!1&&(k.w=Na[k.v]);break;case"str":k.t="s",k.v=ne[1];break;case"is":k.t="s",k.v=ne[1].t;break}if((y=o.CellXf[ne[0].iStyleRef])&&Yk(k,y.numFmtId,null,c,i,o),R=ne[0].c==-1?R+1:ne[0].c,c.dense?(u[S]||(u[S]=[]),u[S][R]=k):u[Er(R)+V]=k,c.cellFormula){for(F=!1,A=0;A<I.length;++A){var O=I[A];_.r>=O[0].s.r&&_.r<=O[0].e.r&&R>=O[0].s.c&&R<=O[0].e.c&&(k.F=Et(O[0]),F=!0)}!F&&ne.length>3&&(k.f=ne[3])}if(d.s.r>_.r&&(d.s.r=_.r),d.s.c>R&&(d.s.c=R),d.e.r<_.r&&(d.e.r=_.r),d.e.c<R&&(d.e.c=R),c.cellDates&&y&&k.t=="n"&&zc(ct[y.numFmtId])){var te=Jo(k.v);te&&(k.t="d",k.v=new Date(te.y,te.m-1,te.d,te.H,te.M,te.S,te.u))}Ve&&(Ve.type=="XLDAPR"&&(k.D=!0),Ve=void 0);break;case 1:case 12:if(!c.sheetStubs||g)break;k={t:"z",v:void 0},R=ne[0].c==-1?R+1:ne[0].c,c.dense?(u[S]||(u[S]=[]),u[S][R]=k):u[Er(R)+V]=k,d.s.r>_.r&&(d.s.r=_.r),d.s.c>R&&(d.s.c=R),d.e.r<_.r&&(d.e.r=_.r),d.e.c<R&&(d.e.c=R),Ve&&(Ve.type=="XLDAPR"&&(k.D=!0),Ve=void 0);break;case 176:j.push(ne);break;case 49:Ve=((c.xlmeta||{}).Cell||[])[ne-1];break;case 494:var J=n["!id"][ne.relId];for(J?(ne.Target=J.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=J):ne.relId==""&&(ne.Target="#"+ne.loc),S=ne.rfx.s.r;S<=ne.rfx.e.r;++S)for(R=ne.rfx.s.c;R<=ne.rfx.e.c;++R)c.dense?(u[S]||(u[S]=[]),u[S][R]||(u[S][R]={t:"z",v:void 0}),u[S][R].l=ne):(M=ht({c:R,r:S}),u[M]||(u[M]={t:"z",v:void 0}),u[M].l=ne);break;case 426:if(!c.cellFormula)break;I.push(ne),W=c.dense?u[S][R]:u[Er(R)+V],W.f=Bn(ne[1],d,{r:_.r,c:R},L,c),W.F=Et(ne[0]);break;case 427:if(!c.cellFormula)break;U[ht(ne[0].s)]=ne[1],W=c.dense?u[S][R]:u[Er(R)+V],W.f=Bn(ne[1],d,{r:_.r,c:R},L,c);break;case 60:if(!c.cellStyles)break;for(;ne.e>=ne.s;)B[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},Re||(Re=!0,cx(ne.w/256)),Eo(B[ne.e+1]);break;case 161:u["!autofilter"]={ref:Et(ne)};break;case 476:u["!margins"]=ne;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),ne.name&&(s.Sheets[r].CodeName=ne.name),(ne.above||ne.left)&&(u["!outline"]={above:ne.above,left:ne.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),ne.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!we.T){if(!g||c.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(d.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(u["!ref"]=Et(h||d)),c.sheetRows&&u["!ref"]){var Le=Wt(u["!ref"]);c.sheetRows<=+Le.e.r&&(Le.e.r=c.sheetRows-1,Le.e.r>d.e.r&&(Le.e.r=d.e.r),Le.e.r<Le.s.r&&(Le.s.r=Le.e.r),Le.e.c>d.e.c&&(Le.e.c=d.e.c),Le.e.c<Le.s.c&&(Le.s.c=Le.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Et(Le))}return j.length>0&&(u["!merges"]=j),B.length>0&&(u["!cols"]=B),De.length>0&&(u["!rows"]=De),u}function V7(t,e,r,n,s,i,o){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=gr(e),e.z=e.z||ct[14],e.v=Jr(mr(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var u={r,c:n};switch(u.s=Ro(s.cellXfs,e,s),e.l&&i["!links"].push([ht(u),e.l]),e.c&&i["!comments"].push([ht(u),e.c]),e.t){case"s":case"str":return s.bookSST?(c=px(s.Strings,e.v,s.revStrings),u.t="s",u.v=c,o?Ce(t,18,n7(e,u)):Ce(t,7,t7(e,u))):(u.t="str",o?Ce(t,17,m7(e,u)):Ce(t,6,d7(e,u))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Ce(t,13,u7(e,u)):Ce(t,2,l7(e,u)):o?Ce(t,16,a7(e,u)):Ce(t,5,i7(e,u)),!0;case"b":return u.t="b",o?Ce(t,15,X9(e,u)):Ce(t,4,q9(e,u)),!0;case"e":return u.t="e",o?Ce(t,14,Z9(e,u)):Ce(t,3,Q9(e,u)),!0}return o?Ce(t,12,$9(e,u)):Ce(t,1,H9(e,u)),!0}function B7(t,e,r,n){var s=Wt(e["!ref"]||"A1"),i,o="",c=[];Ce(t,145);var u=Array.isArray(e),h=s.e.r;e["!rows"]&&(h=Math.max(s.e.r,e["!rows"].length-1));for(var d=s.s.r;d<=h;++d){o=Or(d),L9(t,e,s,d);var g=!1;if(d<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){d===s.s.r&&(c[x]=Er(x)),i=c[x]+o;var _=u?(e[d]||[])[x]:e[i];if(!_){g=!1;continue}g=V7(t,_,d,x,n,e,g)}}Ce(t,146)}function U7(t,e){!e||!e["!merges"]||(Ce(t,177,E7(e["!merges"].length)),e["!merges"].forEach(function(r){Ce(t,176,w7(r))}),Ce(t,178))}function j7(t,e){!e||!e["!cols"]||(Ce(t,390),e["!cols"].forEach(function(r,n){r&&Ce(t,60,I7(n,r))}),Ce(t,391))}function z7(t,e){!e||!e["!ref"]||(Ce(t,648),Ce(t,649,D7(Wt(e["!ref"]))),Ce(t,650))}function H7(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=rr(r,-1,n[1].Target.replace(/#.*$/,""),Ft.HLINK);Ce(t,494,S7(n,s))}}),delete e["!links"]}function W7(t,e,r,n){if(e["!comments"].length>0){var s=rr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ft.VML);Ce(t,551,tx("rId"+s)),e["!legacy"]=s}}function $7(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],i=typeof s.ref=="string"?s.ref:Et(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,c=ys(i);c.s.r==c.e.r&&(c.e.r=ys(e["!ref"]).e.r,i=Et(c));for(var u=0;u<o.length;++u){var h=o[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+i;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ce(t,161,$c(Wt(i))),Ce(t,162)}}function G7(t,e,r){Ce(t,133),Ce(t,137,b7(e,r)),Ce(t,138),Ce(t,134)}function q7(t,e){e["!protect"]&&Ce(t,535,P7(e["!protect"]))}function K7(t,e,r,n){var s=_s(),i=r.SheetNames[t],o=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}var u=Wt(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ce(s,129),(r.vbaraw||o["!outline"])&&Ce(s,147,j9(c,o["!outline"])),Ce(s,148,V9(u)),G7(s,o,r.Workbook),j7(s,o),B7(s,o,t,e),q7(s,o),$7(s,o,r,t),U7(s,o),H7(s,o,n),o["!margins"]&&Ce(s,476,R7(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&z7(s,o),W7(s,o,t,n),Ce(s,130),s.end()}function X7(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var s=Ht((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function Y7(t,e,r,n,s,i){var o=i||{"!type":"chart"};if(!t)return i;var c=0,u=0,h="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var x=X7(g);d.s.r=d.s.c=0,d.e.c=c,h=Er(c),x[0].forEach(function(_,k){o[h+Or(k)]={t:"n",v:_,z:x[1]},u=k}),d.e.r<u&&(d.e.r=u),++c}),c>0&&(o["!ref"]=Et(d)),o}function Q7(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,c=t.match(Qk);return c&&mx(c[0],i,s,r),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function J7(t,e){t.l+=10;var r=Hn(t);return{name:r}}function Z7(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ra(t,function(u,h,d){switch(d){case 550:i["!rel"]=u;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),u.name&&(s.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var gx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eV=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tV=[],rV=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Tw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=dr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Sw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=dr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function t4(t){Sw(t.WBProps,gx),Sw(t.CalcPr,rV),Tw(t.WBView,eV),Tw(t.Sheets,tV),Ec.date1904=dr(t.WBProps.date1904)}function nV(t){return!t.Workbook||!t.Workbook.WBProps?"false":dr(t.Workbook.WBProps.date1904)?"true":"false"}var sV="][*?/\\".split("");function r4(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return sV.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function iV(t,e,r){t.forEach(function(n,s){r4(n);for(var i=0;i<s;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[s]&&e[s].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function aV(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];iV(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)n9(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var oV=/<\w+:workbook/;function lV(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},o=0;if(t.replace(Gn,function(u,h){var d=pt(u);switch(Yi(d[0])){case"<?xml":break;case"<workbook":u.match(oV)&&(s="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":gx.forEach(function(g){if(d[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=dr(d[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(d[g[0]],10);break;default:r.WBProps[g[0]]=d[g[0]]}}),d.codeName&&(r.WBProps.CodeName=ir(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ht(ir(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=ir(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),dr(d.hidden||"0")&&(i.Hidden=!0),o=h+u.length;break;case"</definedName>":i.Ref=Ht(ir(t.slice(o,h))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),El.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return t4(r),r}function n4(t){var e=[Lr];e[e.length]=He("workbook",null,{xmlns:El[0],"xmlns:r":Yr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(gx.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=He("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:nr(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=He("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var u={name:c.Name};c.Comment&&(u.comment=c.Comment),c.Sheet!=null&&(u.localSheetId=""+c.Sheet),c.Hidden&&(u.hidden="1"),c.Ref&&(e[e.length]=He("definedName",nr(c.Ref),u))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function cV(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=yg(t),r.name=Hn(t),r}function uV(t,e){return e||(e=ge(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),tx(t.strRelID,e),on(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function fV(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Hn(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function hV(t,e){e||(e=ge(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),KS(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function dV(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function pV(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=WD(t),o=QM(t,0,r),c=ex(t);t.l=n;var u={Name:i,Ptg:o};return s<268435455&&(u.Sheet=s),c&&(u.Comment=c),u}function mV(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],wf[16]={n:"BrtFRTArchID$",f:dV},Ra(t,function(u,h,d){switch(d){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(e.SID=u.Sheet),u.Ref=Bn(u.Ptg,null,null,o,e),delete e.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,u]):o[0]=[d,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!h.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),t4(r),r.Names=i,r.supbooks=o,r}function gV(t,e){Ce(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Ce(t,156,uV(s))}Ce(t,144)}function xV(t,e){e||(e=ge(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return on("SheetJS",e),on($0.version,e),on($0.version,e),on("7262",e),e.length>e.l?e.slice(0,e.l):e}function vV(t,e){e||(e=ge(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function _V(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(Ce(t,135),Ce(t,158,vV(s)),Ce(t,136))}}function yV(t,e){var r=_s();return Ce(r,131),Ce(r,128,xV()),Ce(r,153,hV(t.Workbook&&t.Workbook.WBProps||null)),_V(r,t),gV(r,t),Ce(r,132),r.end()}function wV(t,e,r){return e.slice(-4)===".bin"?mV(t,r):lV(t,r)}function EV(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?M7(t,n,r,s,i,o,c):p9(t,n,r,s,i,o,c)}function TV(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?Z7(t,n,r,s,i):Q7(t,n,r,s,i)}function SV(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?AL():CL()}function kV(t,e,r,n,s,i,o,c){return e.slice(-4)===".bin"?SL():kL()}function AV(t,e,r,n){return e.slice(-4)===".bin"?wO(t,r,n):cO(t,r,n)}function CV(t,e,r){return Mk(t,r)}function IV(t,e,r){return e.slice(-4)===".bin"?I8(t,r):k8(t,r)}function FV(t,e,r){return e.slice(-4)===".bin"?_L(t,r):uL(t,r)}function RV(t,e,r){return e.slice(-4)===".bin"?oL(t):iL(t)}function NV(t,e,r,n){return r.slice(-4)===".bin"?lL(t,e,r,n):void 0}function bV(t,e,r){return e.slice(-4)===".bin"?rL(t,e,r):sL(t,e,r)}function DV(t,e,r){return(e.slice(-4)===".bin"?yV:n4)(t)}function PV(t,e,r,n,s){return(e.slice(-4)===".bin"?K7:Jk)(t,r,n,s)}function OV(t,e,r){return(e.slice(-4)===".bin"?NO:Ok)(t,r)}function LV(t,e,r){return(e.slice(-4)===".bin"?N8:Ck)(t,r)}function MV(t,e,r){return(e.slice(-4)===".bin"?yL:Uk)(t)}function VV(t){return(t.slice(-4)===".bin"?nL:Vk)()}var s4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,i4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function hi(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(s4),i,o,c,u;if(s)for(u=0;u!=s.length;++u)i=s[u].match(i4),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),n[c]=i[2].slice(1,i[2].length-1));return n}function BV(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(s4),s,i,o,c;if(n)for(c=0;c!=n.length;++c)s=n[c].match(i4),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var Yu;function UV(t,e){var r=Yu[t]||Ht(t);return r==="General"?pl(e):ti(r,e)}function jV(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=dr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=mr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Ht(e)]=s}function zV(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Na[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=hf(t.v):t.w=pl(t.v):t.w=UV(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=Yu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&zc(n)){var s=Jo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function HV(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=tO[n.Pattern]||n.Pattern)}t[e.ID]=e}function WV(t,e,r,n,s,i,o,c,u,h){var d="General",g=n.StyleID,x={};h=h||{};var _=[],k=0;for(g===void 0&&c&&(g=c.StyleID),g===void 0&&o&&(g=o.StyleID);i[g]!==void 0&&(i[g].nf&&(d=i[g].nf),i[g].Interior&&_.push(i[g].Interior),!!i[g].Parent);)g=i[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=dr(t);break;case"String":n.t="s",n.r=j2(Ht(t)),n.v=t.indexOf("<")>-1?Ht(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(mr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Ht(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=ZS[t],h.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=j2(e||t));break}if(zV(n,d,h),h.cellFormula!==!1)if(n.Formula){var y=Ht(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=wc(y,s),delete n.Formula,n.ArrayRange=="RC"?n.F=wc("RC:RC",s):n.ArrayRange&&(n.F=wc(n.ArrayRange,s),u.push([Wt(n.F),n.F]))}else for(k=0;k<u.length;++k)s.r>=u[k][0].s.r&&s.r<=u[k][0].e.r&&s.c>=u[k][0].s.c&&s.c<=u[k][0].e.c&&(n.F=u[k][1]);h.cellStyles&&(_.forEach(function(S){!x.patternType&&S.patternType&&(x.patternType=S.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function $V(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Pm(t,e){var r=e||{};Hc();var n=Ou(K1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ir(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=gr(r);return o.type="string",bc.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Zt){s.indexOf("<"+Zt)>=0&&(i=!0)}),i)return RB(n,r);Yu={"General Number":"General","General Date":ct[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ct[15],"Short Date":ct[14],"Long Time":ct[19],"Medium Time":ct[18],"Short Time":ct[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ct[2],Standard:ct[4],Percent:ct[10],Scientific:ct[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],h,d={},g=[],x=r.dense?[]:{},_="",k={},y={},S=hi('<Data ss:Type="String">'),R=0,M=0,N=0,V={s:{r:2e6,c:2e6},e:{r:0,c:0}},W={},j={},A="",F=0,I=[],U={},L={},D=0,B=[],De=[],Re={},Ve=[],Le,Ae=!1,ne=[],we=[],ee={},O=0,te=0,J={Sheets:[],WBProps:{date1904:!1}},Z={};mf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";c=mf.exec(n);)switch(c[3]=(oe=c[3]).toLowerCase()){case"data":if(oe=="data"){if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?WV(n.slice(R,c.index),A,S,u[u.length-1][0]=="comment"?Re:k,{c:M,r:N},W,Ve[M],y,ne,r):(A="",S=hi(c[0]),R=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(De.length>0&&(k.c=De),(!r.sheetRows||r.sheetRows>N)&&k.v!==void 0&&(r.dense?(x[N]||(x[N]=[]),x[N][M]=k):x[Er(M)+Or(N)]=k),k.HRef&&(k.l={Target:Ht(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(O=M+(parseInt(k.MergeAcross,10)|0),te=N+(parseInt(k.MergeDown,10)|0),I.push({s:{c:M,r:N},e:{c:O,r:te}})),!r.sheetStubs)k.MergeAcross?M=O+1:++M;else if(k.MergeAcross||k.MergeDown){for(var _e=M;_e<=O;++_e)for(var ve=N;ve<=te;++ve)(_e>M||ve>N)&&(r.dense?(x[ve]||(x[ve]=[]),x[ve][_e]={t:"z"}):x[Er(_e)+Or(ve)]={t:"z"});M=O+1}else++M;else k=BV(c[0]),k.Index&&(M=+k.Index-1),M<V.s.c&&(V.s.c=M),M>V.e.c&&(V.e.c=M),c[0].slice(-2)==="/>"&&++M,De=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(N<V.s.r&&(V.s.r=N),N>V.e.r&&(V.e.r=N),c[0].slice(-2)==="/>"&&(y=hi(c[0]),y.Index&&(N=+y.Index-1)),M=0,++N):(y=hi(c[0]),y.Index&&(N=+y.Index-1),ee={},(y.AutoFitHeight=="0"||y.Height)&&(ee.hpx=parseInt(y.Height,10),ee.hpt=yf(ee.hpx),we[N]=ee),y.Hidden=="1"&&(ee.hidden=!0,we[N]=ee));break;case"worksheet":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));g.push(_),V.s.r<=V.e.r&&V.s.c<=V.e.c&&(x["!ref"]=Et(V),r.sheetRows&&r.sheetRows<=V.e.r&&(x["!fullref"]=x["!ref"],V.e.r=r.sheetRows-1,x["!ref"]=Et(V))),I.length&&(x["!merges"]=I),Ve.length>0&&(x["!cols"]=Ve),we.length>0&&(x["!rows"]=we),d[_]=x}else V={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=M=0,u.push([c[3],!1]),h=hi(c[0]),_=Ht(h.Name),x=r.dense?[]:{},I=[],ne=[],we=[],Z={name:_,Hidden:0},J.Sheets.push(Z);break;case"table":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),Ve=[],Ae=!1}break;case"style":c[1]==="/"?HV(W,j,r):j=hi(c[0]);break;case"numberformat":j.nf=Ht(hi(c[0]).Format||"General"),Yu[j.nf]&&(j.nf=Yu[j.nf]);for(var xe=0;xe!=392&&ct[xe]!=j.nf;++xe);if(xe==392){for(xe=57;xe!=392;++xe)if(ct[xe]==null){_a(j.nf,xe);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Le=hi(c[0]),Le.Hidden&&(Le.hidden=!0,delete Le.Hidden),Le.Width&&(Le.wpx=parseInt(Le.Width,10)),!Ae&&Le.wpx>10){Ae=!0,jn=Dk;for(var Te=0;Te<Ve.length;++Te)Ve[Te]&&Eo(Ve[Te])}Ae&&Eo(Le),Ve[Le.Index-1||Ve.length]=Le;for(var ut=0;ut<+Le.Span;++ut)Ve[Ve.length]=gr(Le);break;case"namedrange":if(c[1]==="/")break;J.Names||(J.Names=[]);var Y=pt(c[0]),At={Name:Y.Name,Ref:wc(Y.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(At.Sheet=J.Sheets.length-1),J.Names.push(At);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?A+=n.slice(F,c.index):F=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=hi(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?mP(U,oe,n.slice(D,c.index)):D=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));$V(Re),De.push(Re)}else u.push([c[3],!1]),h=hi(c[0]),Re={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var wt=hi(c[0]);x["!autofilter"]={ref:wc(wt.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return Fw(n,r);var Lt=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Lt=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Lt=!1}break;case"excelworkbook":switch(c[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Lt=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Lt=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(D,c.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else D=c.index+c[0].length;break;case"header":x["!margins"]||il(x["!margins"]={},"xlml"),isNaN(+pt(c[0]).Margin)||(x["!margins"].header=+pt(c[0]).Margin);break;case"footer":x["!margins"]||il(x["!margins"]={},"xlml"),isNaN(+pt(c[0]).Margin)||(x["!margins"].footer=+pt(c[0]).Margin);break;case"pagemargins":var xt=pt(c[0]);x["!margins"]||il(x["!margins"]={},"xlml"),isNaN(+xt.Top)||(x["!margins"].top=+xt.Top),isNaN(+xt.Left)||(x["!margins"].left=+xt.Left),isNaN(+xt.Right)||(x["!margins"].right=+xt.Right),isNaN(+xt.Bottom)||(x["!margins"].bottom=+xt.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Lt=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Lt=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Lt=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Lt=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Lt=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Lt=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Lt=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Lt=!1}break;case"smarttags":break;default:Lt=!1;break}if(Lt||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?jV(L,oe,B,n.slice(D,c.index)):(B=c,D=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var je={};return!r.bookSheets&&!r.bookProps&&(je.Sheets=d),je.SheetNames=g,je.Workbook=J,je.SSF=gr(ct),je.Props=U,je.Custprops=L,je}function Cg(t,e){switch(vx(e=e||{}),e.type||"base64"){case"base64":return Pm(Ms(t),e);case"binary":case"buffer":case"file":return Pm(t,e);case"array":return Pm(Io(t),e)}}function GV(t,e){var r=[];return t.Props&&r.push(gP(t.Props,e)),t.Custprops&&r.push(xP(t.Props,t.Custprops)),r.join("")}function qV(){return""}function KV(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var i=[];i.push(He("NumberFormat",null,{"ss:Format":nr(ct[n.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(He("Style",i.join(""),o))}),He("Styles",r.join(""))}function a4(t){return He("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+hx(t.Ref,{r:0,c:0})})}function XV(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(a4(s)))}return He("Names",r.join(""))}function YV(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],o=0;o<s.length;++o){var c=s[o];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(a4(c)))}return i.join("")}function QV(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(He("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(He("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(He("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(He("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(yn("ProtectContents","True")),t["!protect"].objects&&s.push(yn("ProtectObjects","True")),t["!protect"].scenarios&&s.push(yn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(yn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(yn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":He("WorksheetOptions",s.join(""),{xmlns:bs.x})}function JV(t){return t.map(function(e){var r=_D(e.t||""),n=He("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return He("Comment",n,{"ss:Author":e.a})}).join("")}function ZV(t,e,r,n,s,i,o){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+nr(hx(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var u=Tr(t.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=nr(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=nr(t.l.Tooltip))),r["!merges"])for(var h=r["!merges"],d=0;d!=h.length;++d)h[d].s.c!=o.c||h[d].s.r!=o.r||(h[d].e.c>h[d].s.c&&(c["ss:MergeAcross"]=h[d].e.c-h[d].s.c),h[d].e.r>h[d].s.r&&(c["ss:MergeDown"]=h[d].e.r-h[d].s.r));var g="",x="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",x=String(t.v);break;case"b":g="Boolean",x=t.v?"1":"0";break;case"e":g="Error",x=Na[t.v];break;case"d":g="DateTime",x=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ct[14]);break;case"s":g="String",x=vD(t.v||"");break}var _=Ro(n.cellXfs,t,n);c["ss:StyleID"]="s"+(21+_),c["ss:Index"]=o.c+1;var k=t.v!=null?x:"",y=t.t=="z"?"":'<Data ss:Type="'+g+'">'+k+"</Data>";return(t.c||[]).length>0&&(y+=JV(t.c)),He("Cell",y,c)}function eB(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Dc(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function tB(t,e,r,n){if(!t["!ref"])return"";var s=Wt(t["!ref"]),i=t["!merges"]||[],o=0,c=[];t["!cols"]&&t["!cols"].forEach(function(S,R){Eo(S);var M=!!S.width,N=Od(R,S),V={"ss:Index":R+1};M&&(V["ss:Width"]=vf(N.width)),S.hidden&&(V["ss:Hidden"]="1"),c.push(He("Column",null,V))});for(var u=Array.isArray(t),h=s.s.r;h<=s.e.r;++h){for(var d=[eB(h,(t["!rows"]||[])[h])],g=s.s.c;g<=s.e.c;++g){var x=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>g)&&!(i[o].s.r>h)&&!(i[o].e.c<g)&&!(i[o].e.r<h)){(i[o].s.c!=g||i[o].s.r!=h)&&(x=!0);break}if(!x){var _={r:h,c:g},k=ht(_),y=u?(t[h]||[])[g]:t[k];d.push(ZV(y,k,t,e,r,n,_))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function rB(t,e,r){var n=[],s=r.SheetNames[t],i=r.Sheets[s],o=i?YV(i,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?tB(i,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(QV(i,e,t,r)),n.join("")}function nB(t,e){e||(e={}),t.SSF||(t.SSF=gr(ct)),t.SSF&&(Hc(),Id(t.SSF),e.revssf=Rd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Ro(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(GV(t,e)),r.push(qV()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(He("Worksheet",rB(n,e,t),{"ss:Name":nr(t.SheetNames[n])}));return r[2]=KV(t,e),r[3]=XV(t),Lr+He("Workbook",r.join(""),{xmlns:bs.ss,"xmlns:o":bs.o,"xmlns:x":bs.x,"xmlns:ss":bs.ss,"xmlns:dt":bs.dt,"xmlns:html":bs.html})}function sB(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=XD(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=YD(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var iB=[60,1084,2066,2165,2175];function aB(t,e,r,n,s){var i=n,o=[],c=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(c)}o.push(c),r.l+=i;for(var u=ma(r,r.l),h=Ig[u],d=0;h!=null&&iB.indexOf(u)>-1;)i=ma(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),c=r.slice(d,r.l+4+i),o.push(c),r.l+=4+i,h=Ig[u=ma(r,r.l)];var g=an(o);vn(g,0);var x=0;g.lens=[];for(var _=0;_<o.length;++_)g.lens.push(x),x+=o[_].length;if(g.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+g.length+" < "+n;return e.f(g,g.length,s)}function Oi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ct[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Na[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=hf(t.v):t.w=pl(t.v):t.w=ti(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&zc(ct[n]||String(n))){var s=Jo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function d0(t,e,r){return{v:t,ixfe:e,t:r}}function oB(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},o={},c=null,u=[],h="",d={},g,x="",_,k,y,S,R={},M=[],N,V,W=[],j=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},I=function(ot){return ot<8?rl[ot]:ot<64&&j[ot-8]||rl[ot]},U=function(ot,jt,Gr){var Yt=jt.XF.data;if(!(!Yt||!Yt.patternType||!Gr||!Gr.cellStyles)){jt.s={},jt.s.patternType=Yt.patternType;var kn;(kn=xf(I(Yt.icvFore)))&&(jt.s.fgColor={rgb:kn}),(kn=xf(I(Yt.icvBack)))&&(jt.s.bgColor={rgb:kn})}},L=function(ot,jt,Gr){if(!(ee>1)&&!(Gr.sheetRows&&ot.r>=Gr.sheetRows)){if(Gr.cellStyles&&jt.XF&&jt.XF.data&&U(ot,jt,Gr),delete jt.ixfe,delete jt.XF,g=ot,x=ht(ot),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<o.s.r&&(o.s.r=ot.r),ot.c<o.s.c&&(o.s.c=ot.c),ot.r+1>o.e.r&&(o.e.r=ot.r+1),ot.c+1>o.e.c&&(o.e.c=ot.c+1),Gr.cellFormula&&jt.f){for(var Yt=0;Yt<M.length;++Yt)if(!(M[Yt][0].s.c>ot.c||M[Yt][0].s.r>ot.r)&&!(M[Yt][0].e.c<ot.c||M[Yt][0].e.r<ot.r)){jt.F=Et(M[Yt][0]),(M[Yt][0].s.c!=ot.c||M[Yt][0].s.r!=ot.r)&&delete jt.f,jt.f&&(jt.f=""+Bn(M[Yt][1],o,ot,ne,D));break}}Gr.dense?(s[ot.r]||(s[ot.r]=[]),s[ot.r][ot.c]=jt):s[x]=jt}},D={enc:!1,sbcch:0,snames:[],sharedf:R,arrayf:M,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var B,De=[],Re=[],Ve=[],Le=[],Ae=!1,ne=[];ne.SheetNames=D.snames,ne.sharedf=D.sharedf,ne.arrayf=D.arrayf,ne.names=[],ne.XTI=[];var we=0,ee=0,O=0,te=[],J=[],Z;D.codepage=1200,mi(1200);for(var oe=!1;t.l<t.length-1;){var _e=t.l,ve=t.read_shift(2);if(ve===0&&we===10)break;var xe=t.l===t.length?0:t.read_shift(2),Te=Ig[ve];if(Te&&Te.f){if(e.bookSheets&&we===133&&ve!==133)break;if(we=ve,Te.r===2||Te.r==12){var ut=t.read_shift(2);if(xe-=2,!D.enc&&ut!==ve&&((ut&255)<<8|ut>>8)!==ve)throw new Error("rt mismatch: "+ut+"!="+ve);Te.r==12&&(t.l+=10,xe-=10)}var Y={};if(ve===10?Y=Te.f(t,xe,D):Y=aB(ve,Te,t,xe,D),ee==0&&[9,521,1033,2057].indexOf(we)===-1)continue;switch(ve){case 34:r.opts.Date1904=A.WBProps.date1904=Y;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=Y,!e.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=Y;break;case 66:var At=Number(Y);switch(At){case 21010:At=1200;break;case 32768:At=1e4;break;case 32769:At=1252;break}mi(D.codepage=At),oe=!0;break;case 317:D.rrtabid=Y;break;case 25:D.winlocked=Y;break;case 439:r.opts.RefreshAll=Y;break;case 12:r.opts.CalcCount=Y;break;case 16:r.opts.CalcDelta=Y;break;case 17:r.opts.CalcIter=Y;break;case 13:r.opts.CalcMode=Y;break;case 14:r.opts.CalcPrecision=Y;break;case 95:r.opts.CalcSaveRecalc=Y;break;case 15:D.CalcRefMode=Y;break;case 2211:r.opts.FullCalc=Y;break;case 129:Y.fDialog&&(s["!type"]="dialog"),Y.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Y.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:W.push(Y);break;case 430:ne.push([Y]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(Y);break;case 24:case 536:Z={Name:Y.Name,Ref:Bn(Y.rgce,o,null,ne,D)},Y.itab>0&&(Z.Sheet=Y.itab-1),ne.names.push(Z),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(J[Y.itab-1]={ref:Et(Y.rgce[0][0][1][2])});break;case 22:D.ExternCount=Y;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(Y),ne.XTI=ne.XTI.concat(Y);break;case 2196:if(D.biff<8)break;Z!=null&&(Z.Comment=Y[1]);break;case 18:s["!protect"]=Y;break;case 19:Y!==0&&D.WTF&&console.error("Password verifier: "+Y);break;case 133:i[Y.pos]=Y,D.snames.push(Y.name);break;case 10:{if(--ee)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Et(o),e.sheetRows&&e.sheetRows<=o.e.r){var wt=o.e.r;o.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Et(o),o.e.r=wt}o.e.r++,o.e.c++}De.length>0&&(s["!merges"]=De),Re.length>0&&(s["!objects"]=Re),Ve.length>0&&(s["!cols"]=Ve),Le.length>0&&(s["!rows"]=Le),A.Sheets.push(F)}h===""?d=s:n[h]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),D.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(D.biff=5,oe=!0,mi(D.codepage=28591)),D.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(D.biff=2),ee++)break;if(s=e.dense?[]:{},D.biff<8&&!oe&&(oe=!0,mi(D.codepage=e.codepage||1252)),D.biff<5||Y.BIFFVer==0&&Y.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Lt={pos:t.l-xe,name:h};i[Lt.pos]=Lt,D.snames.push(h)}else h=(i[_e]||{name:""}).name;Y.dt==32&&(s["!type"]="chart"),Y.dt==64&&(s["!type"]="macro"),De=[],Re=[],D.arrayf=M=[],Ve=[],Le=[],Ae=!1,F={Hidden:(i[_e]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[Y.r]||[])[Y.c]:s[ht({c:Y.c,r:Y.r})])&&++Y.c,N={ixfe:Y.ixfe,XF:W[Y.ixfe]||{},v:Y.val,t:"n"},O>0&&(N.z=te[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e);break;case 5:case 517:N={ixfe:Y.ixfe,XF:W[Y.ixfe],v:Y.val,t:Y.t},O>0&&(N.z=te[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e);break;case 638:N={ixfe:Y.ixfe,XF:W[Y.ixfe],v:Y.rknum,t:"n"},O>0&&(N.z=te[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e);break;case 189:for(var xt=Y.c;xt<=Y.C;++xt){var je=Y.rkrec[xt-Y.c][0];N={ixfe:je,XF:W[je],v:Y.rkrec[xt-Y.c][1],t:"n"},O>0&&(N.z=te[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),L({c:xt,r:Y.r},N,e)}break;case 6:case 518:case 1030:{if(Y.val=="String"){c=Y;break}if(N=d0(Y.val,Y.cell.ixfe,Y.tt),N.XF=W[N.ixfe],e.cellFormula){var Zt=Y.formula;if(Zt&&Zt[0]&&Zt[0][0]&&Zt[0][0][0]=="PtgExp"){var Mt=Zt[0][0][1][0],Bt=Zt[0][0][1][1],xr=ht({r:Mt,c:Bt});R[xr]?N.f=""+Bn(Y.formula,o,Y.cell,ne,D):N.F=((e.dense?(s[Mt]||[])[Bt]:s[xr])||{}).F}else N.f=""+Bn(Y.formula,o,Y.cell,ne,D)}O>0&&(N.z=te[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),L(Y.cell,N,e),c=Y}break;case 7:case 519:if(c)c.val=Y,N=d0(Y,c.cell.ixfe,"s"),N.XF=W[N.ixfe],e.cellFormula&&(N.f=""+Bn(c.formula,o,c.cell,ne,D)),O>0&&(N.z=te[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),L(c.cell,N,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{M.push(Y);var Tn=ht(Y[0].s);if(_=e.dense?(s[Y[0].s.r]||[])[Y[0].s.c]:s[Tn],e.cellFormula&&_){if(!c||!Tn||!_)break;_.f=""+Bn(Y[1],o,Y[0],ne,D),_.F=Et(Y[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!c)break;R[ht(c.cell)]=Y[0],_=e.dense?(s[c.cell.r]||[])[c.cell.c]:s[ht(c.cell)],(_||{}).f=""+Bn(Y[0],o,g,ne,D)}}break;case 253:N=d0(u[Y.isst].t,Y.ixfe,"s"),u[Y.isst].h&&(N.h=u[Y.isst].h),N.XF=W[N.ixfe],O>0&&(N.z=te[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e);break;case 513:e.sheetStubs&&(N={ixfe:Y.ixfe,XF:W[Y.ixfe],t:"z"},O>0&&(N.z=te[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e));break;case 190:if(e.sheetStubs)for(var Sn=Y.c;Sn<=Y.C;++Sn){var _r=Y.ixfe[Sn-Y.c];N={ixfe:_r,XF:W[_r],t:"z"},O>0&&(N.z=te[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),L({c:Sn,r:Y.r},N,e)}break;case 214:case 516:case 4:N=d0(Y.val,Y.ixfe,"s"),N.XF=W[N.ixfe],O>0&&(N.z=te[N.ixfe>>8&63]),Oi(N,e,r.opts.Date1904),L({c:Y.c,r:Y.r},N,e);break;case 0:case 512:ee===1&&(o=Y);break;case 252:u=Y;break;case 1054:if(D.biff==4){te[O++]=Y[1];for(var Rr=0;Rr<O+163&&ct[Rr]!=Y[1];++Rr);Rr>=163&&_a(Y[1],O+163)}else _a(Y[1],Y[0]);break;case 30:{te[O++]=Y;for(var qn=0;qn<O+163&&ct[qn]!=Y;++qn);qn>=163&&_a(Y,O+163)}break;case 229:De=De.concat(Y);break;case 93:Re[Y.cmo[0]]=D.lastobj=Y;break;case 438:D.lastobj.TxO=Y;break;case 127:D.lastobj.ImData=Y;break;case 440:for(S=Y[0].s.r;S<=Y[0].e.r;++S)for(y=Y[0].s.c;y<=Y[0].e.c;++y)_=e.dense?(s[S]||[])[y]:s[ht({c:y,r:S})],_&&(_.l=Y[1]);break;case 2048:for(S=Y[0].s.r;S<=Y[0].e.r;++S)for(y=Y[0].s.c;y<=Y[0].e.c;++y)_=e.dense?(s[S]||[])[y]:s[ht({c:y,r:S})],_&&_.l&&(_.l.Tooltip=Y[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;_=e.dense?(s[Y[0].r]||[])[Y[0].c]:s[ht(Y[0])];var as=Re[Y[2]];_||(e.dense?(s[Y[0].r]||(s[Y[0].r]=[]),_=s[Y[0].r][Y[0].c]={t:"z"}):_=s[ht(Y[0])]={t:"z"},o.e.r=Math.max(o.e.r,Y[0].r),o.s.r=Math.min(o.s.r,Y[0].r),o.e.c=Math.max(o.e.c,Y[0].c),o.s.c=Math.min(o.s.c,Y[0].c)),_.c||(_.c=[]),k={a:Y[1],t:as.TxO.t},_.c.push(k)}break;case 2173:KO(W[Y.ixfe],Y.ext);break;case 125:{if(!D.cellStyles)break;for(;Y.e>=Y.s;)Ve[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},Ae||(Ae=!0,cx(Y.w/256)),Eo(Ve[Y.e+1])}break;case 520:{var or={};Y.level!=null&&(Le[Y.r]=or,or.level=Y.level),Y.hidden&&(Le[Y.r]=or,or.hidden=!0),Y.hpt&&(Le[Y.r]=or,or.hpt=Y.hpt,or.hpx=Dc(Y.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||il(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=Y;break;case 161:s["!margins"]||il(s["!margins"]={}),s["!margins"].header=Y.header,s["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(A.Views[0].RTL=!0);break;case 146:j=Y;break;case 2198:B=Y;break;case 140:V=Y;break;case 442:h?F.CodeName=Y||F.name:A.WBProps.CodeName=Y||"ThisWorkbook";break}}else Te||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),t.l+=xe}return r.SheetNames=Fr(i).sort(function(Zr,ot){return Number(Zr)-Number(ot)}).map(function(Zr){return i[Zr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&J.forEach(function(Zr,ot){r.Sheets[r.SheetNames[ot]]["!autofilter"]=Zr}),r.Strings=u,r.SSF=gr(ct),D.enc&&(r.Encryption=D.enc),B&&(r.Themes=B),r.Metadata={},V!==void 0&&(r.Metadata.Country=V),ne.names.length>0&&(A.Names=ne.names),r.Workbook=A,r}var Qu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function lB(t,e,r){var n=nt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=iw(n,wg,Qu.DSI);for(var i in s)e[i]=s[i]}catch(h){if(r.WTF)throw h}var o=nt.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var c=iw(o,Eg,Qu.SI);for(var u in c)e[u]==null&&(e[u]=c[u])}catch(h){if(r.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(ik(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function cB(t,e){var r=[],n=[],s=[],i=0,o,c=O2(wg,"n"),u=O2(Eg,"n");if(t.Props)for(o=Fr(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(u,o[i])?n:s).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=Fr(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(u,o[i])?n:s).push([o[i],t.Custprops[o[i]]]);var h=[];for(i=0;i<s.length;++i)hk.indexOf(s[i][0])>-1||sk.indexOf(s[i][0])>-1||s[i][1]!=null&&h.push(s[i]);n.length&&nt.utils.cfb_add(e,"/SummaryInformation",aw(n,Qu.SI,u,Eg)),(r.length||h.length)&&nt.utils.cfb_add(e,"/DocumentSummaryInformation",aw(r,Qu.DSI,c,wg,h.length?h:null,Qu.UDI))}function o4(t,e){e||(e={}),vx(e),B1(),e.codepage&&V1(e.codepage);var r,n;if(t.FullPaths){if(nt.find(t,"/encryption"))throw new Error("File is password-protected");r=nt.find(t,"!CompObj"),n=nt.find(t,"/Workbook")||nt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ps(Ms(t));break;case"binary":t=Ps(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}vn(t,0),n={content:t}}var s,i;if(r&&sB(r),e.bookProps&&!e.bookSheets)s={};else{var o=Ct?"buffer":"array";if(n&&n.content)s=oB(n.content,e);else if((i=nt.find(t,"PerfectOffice_MAIN"))&&i.content)s=sl.to_workbook(i.content,(e.type=o,e));else if((i=nt.find(t,"NativeContent_MAIN"))&&i.content)s=sl.to_workbook(i.content,(e.type=o,e));else throw(i=nt.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&nt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=EL(t))}var c={};return t.FullPaths&&lB(t,c,e),s.Props=s.Custprops=c,e.bookFiles&&(s.cfb=t),s}function uB(t,e){var r=e||{},n=nt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return nt.utils.cfb_add(n,s,l4(t,r)),r.biff==8&&(t.Props||t.Custprops)&&cB(t,n),r.biff==8&&t.vbaraw&&TL(n,nt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var wf={0:{f:P9},1:{f:z9},2:{f:o7},3:{f:Y9},4:{f:G9},5:{f:s7},6:{f:h7},7:{f:e7},8:{f:_7},9:{f:v7},10:{f:g7},11:{f:x7},12:{f:W9},13:{f:c7},14:{f:J9},15:{f:K9},16:{f:Zk},17:{f:p7},18:{f:r7},19:{f:Z1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:pV},40:{},42:{},43:{f:hO},44:{f:uO},45:{f:mO},46:{f:xO},47:{f:gO},48:{},49:{f:MD},50:{},51:{f:QO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Tk},62:{f:f7},63:{f:aL},64:{f:O7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$n,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:N7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:U9},148:{f:M9,p:16},151:{f:k7},152:{},153:{f:fV},154:{},155:{},156:{f:cV},157:{},158:{},159:{T:1,f:C8},160:{T:-1},161:{T:1,f:Al},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:y7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:XO},336:{T:-1},337:{f:eL,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:yg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ek},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:A7},427:{f:C7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:F7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:B9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:T7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:yg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:xL},633:{T:1},634:{T:-1},635:{T:1,f:mL},636:{T:-1},637:{f:jD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:J7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:L7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ig={6:{f:bm},10:{f:to},12:{f:zr},13:{f:zr},14:{f:Dr},15:{f:Dr},16:{f:zn},17:{f:Dr},18:{f:Dr},19:{f:zr},20:{f:hw},21:{f:hw},23:{f:Ek},24:{f:pw},25:{f:Dr},26:{},27:{},28:{f:L5},29:{},34:{f:Dr},35:{f:dw},38:{f:zn},39:{f:zn},40:{f:zn},41:{f:zn},42:{f:Dr},43:{f:Dr},47:{f:K8},49:{f:c5},51:{f:zr},60:{},61:{f:s5},64:{f:Dr},65:{f:l5},66:{f:zr},77:{},80:{},81:{},82:{},85:{f:zr},89:{},90:{},91:{},92:{f:qP},93:{f:B5},94:{},95:{f:Dr},96:{},97:{},99:{f:Dr},125:{f:Tk},128:{f:S5},129:{f:XP},130:{f:zr},131:{f:Dr},132:{f:Dr},133:{f:YP},134:{},140:{f:q5},141:{f:zr},144:{},146:{f:Y5},151:{},152:{},153:{},154:{},155:{},156:{f:zr},157:{},158:{},160:{f:n8},161:{f:Z5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:y5},190:{f:w5},193:{f:to},197:{},198:{},199:{},200:{},201:{},202:{f:Dr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:zr},220:{},221:{f:Dr},222:{},224:{f:T5},225:{f:GP},226:{f:to},227:{},229:{f:M5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:JP},253:{f:f5},255:{f:e5},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:dk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Dr},353:{f:to},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:F5},431:{f:Dr},432:{},433:{},434:{},437:{},438:{f:z5},439:{f:Dr},440:{f:H5},441:{},442:{f:Hf},443:{},444:{f:zr},445:{},446:{},448:{f:to},449:{f:n5,r:2},450:{f:to},512:{f:cw},513:{f:r8},515:{f:C5},516:{f:d5},517:{f:fw},519:{f:s8},520:{f:t5},523:{},545:{f:mw},549:{f:lw},566:{},574:{f:a5},638:{f:_5},659:{},1048:{},1054:{f:m5},1084:{},1212:{f:D5},2048:{f:$5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:u0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:to},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Q5,r:12},2173:{f:qO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Dr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:b5,r:12},2197:{},2198:{f:jO,r:12},2199:{},2200:{},2201:{},2202:{f:P5,r:12},2203:{f:to},2204:{},2205:{},2206:{},2207:{},2211:{f:r5},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:zr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:e8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:X5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:cw},1:{},2:{f:c8},3:{f:o8},4:{f:a8},5:{f:fw},7:{f:f8},8:{},9:{f:u0},11:{},22:{f:zr},30:{f:x5},31:{},32:{},33:{f:mw},36:{},37:{f:lw},50:{f:h8},62:{},52:{},67:{},68:{f:zr},69:{},86:{},126:{},127:{f:i8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:d8},223:{},234:{},354:{},421:{},518:{f:bm},521:{f:u0},536:{f:pw},547:{f:dw},561:{},579:{},1030:{f:bm},1033:{f:u0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function We(t,e,r,n){var s=e;if(!isNaN(s)){var i=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&Y1(r)&&t.push(r)}}function fB(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return We(t,e,r,s);var i=e;if(!isNaN(i)){for(var o=r.parts||[],c=0,u=0,h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;var d=t.next(4);for(d.write_shift(2,i),d.write_shift(2,h),t.push(r.slice(u,u+h)),u+=h;u<s;){for(d=t.next(4),d.write_shift(2,60),h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;d.write_shift(2,h),t.push(r.slice(u,u+h)),u+=h}}}function qf(t,e,r){return t||(t=ge(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function hB(t,e,r,n){var s=ge(9);return qf(s,t,e),pk(r,n||"b",s),s}function dB(t,e,r){var n=ge(8+2*r.length);return qf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function pB(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?Jr(mr(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?We(t,2,u8(r,n,s)):We(t,3,l8(r,n,s));return;case"b":case"e":We(t,5,hB(r,n,e.v,e.t));return;case"s":case"str":We(t,4,dB(r,n,(e.v||"").slice(0,255)));return}We(t,1,qf(null,r,n))}function mB(t,e,r,n){var s=Array.isArray(e),i=Wt(e["!ref"]||"A1"),o,c="",u=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Et(i)}for(var h=i.s.r;h<=i.e.r;++h){c=Or(h);for(var d=i.s.c;d<=i.e.c;++d){h===i.s.r&&(u[d]=Er(d)),o=u[d]+c;var g=s?(e[h]||[])[d]:e[o];g&&pB(t,g,h,d)}}}function gB(t,e){for(var r=e||{},n=_s(),s=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return We(n,r.biff==4?1033:r.biff==3?521:9,ax(t,16,r)),mB(n,t.Sheets[t.SheetNames[s]],s,r),We(n,10),n.end()}function xB(t,e,r){We(t,49,u5({sz:12,name:"Arial"},r))}function vB(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&We(t,1054,g5(s,e[s],r))})}function _B(t,e){var r=ge(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),We(t,2151,r),r=ge(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),_k(Wt(e["!ref"]||"A1"),r),r.write_shift(4,4),We(t,2152,r)}function yB(t,e){for(var r=0;r<16;++r)We(t,224,uw({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){We(t,224,uw(n,0,e))})}function wB(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];We(t,440,W5(n)),n[1].Tooltip&&We(t,2048,G5(n))}delete e["!links"]}function EB(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&We(t,125,J5(Od(s,n),s))})}}function TB(t,e,r,n,s){var i=16+Ro(s.cellXfs,e,s);if(e.v==null&&!e.bf){We(t,513,vl(r,n,i));return}if(e.bf)We(t,6,XM(e,r,n,s,i));else switch(e.t){case"d":case"n":var o=e.t=="d"?Jr(mr(e.v)):e.v;We(t,515,I5(r,n,o,i));break;case"b":case"e":We(t,517,A5(r,n,e.v,i,s,e.t));break;case"s":case"str":if(s.bookSST){var c=px(s.Strings,e.v,s.revStrings);We(t,253,h5(r,n,c,i))}else We(t,516,p5(r,n,(e.v||"").slice(0,255),i,s));break;default:We(t,513,vl(r,n,i))}}function SB(t,e,r){var n=_s(),s=r.SheetNames[t],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},c=(o.Sheets||[])[t]||{},u=Array.isArray(i),h=e.biff==8,d,g="",x=[],_=Wt(i["!ref"]||"A1"),k=h?65536:16384;if(_.e.c>255||_.e.r>=k){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,k-1)}We(n,2057,ax(r,16,e)),We(n,13,Js(1)),We(n,12,Js(100)),We(n,15,rs(!0)),We(n,17,rs(!1)),We(n,16,gl(.001)),We(n,95,rs(!0)),We(n,42,rs(!1)),We(n,43,rs(!1)),We(n,130,Js(1)),We(n,128,k5()),We(n,131,rs(!1)),We(n,132,rs(!1)),h&&EB(n,i["!cols"]),We(n,512,v5(_,e)),h&&(i["!links"]=[]);for(var y=_.s.r;y<=_.e.r;++y){g=Or(y);for(var S=_.s.c;S<=_.e.c;++S){y===_.s.r&&(x[S]=Er(S)),d=x[S]+g;var R=u?(i[y]||[])[S]:i[d];R&&(TB(n,R,y,S,e),h&&R.l&&i["!links"].push([d,R.l]))}}var M=c.CodeName||c.name||s;return h&&We(n,574,o5((o.Views||[])[0])),h&&(i["!merges"]||[]).length&&We(n,229,V5(i["!merges"])),h&&wB(n,i),We(n,442,mk(M)),h&&_B(n,i),We(n,10),n.end()}function kB(t,e,r){var n=_s(),s=(t||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},c=r.biff==8,u=r.biff==5;if(We(n,2057,ax(t,5,r)),r.bookType=="xla"&&We(n,135),We(n,225,c?Js(1200):null),We(n,193,AP(2)),u&&We(n,191),u&&We(n,192),We(n,226),We(n,92,KP("SheetJS",r)),We(n,66,Js(c?1200:1252)),c&&We(n,353,Js(0)),c&&We(n,448),We(n,317,t8(t.SheetNames.length)),c&&t.vbaraw&&We(n,211),c&&t.vbaraw){var h=o.CodeName||"ThisWorkbook";We(n,442,mk(h))}We(n,156,Js(17)),We(n,25,rs(!1)),We(n,18,rs(!1)),We(n,19,Js(0)),c&&We(n,431,rs(!1)),c&&We(n,444,Js(0)),We(n,61,i5()),We(n,64,rs(!1)),We(n,141,Js(0)),We(n,34,rs(nV(t)=="true")),We(n,14,rs(!0)),c&&We(n,439,rs(!1)),We(n,218,Js(0)),xB(n,t,r),vB(n,t.SSF,r),yB(n,r),c&&We(n,352,rs(!1));var d=n.end(),g=_s();c&&We(g,140,K5()),c&&r.Strings&&fB(g,252,ZP(r.Strings)),We(g,10);var x=g.end(),_=_s(),k=0,y=0;for(y=0;y<t.SheetNames.length;++y)k+=(c?12:11)+(c?2:1)*t.SheetNames[y].length;var S=d.length+k+x.length;for(y=0;y<t.SheetNames.length;++y){var R=i[y]||{};We(_,133,QP({pos:S,hs:R.Hidden||0,dt:0,name:t.SheetNames[y]},r)),S+=e[y].length}var M=_.end();if(k!=M.length)throw new Error("BS8 "+k+" != "+M.length);var N=[];return d.length&&N.push(d),M.length&&N.push(M),x.length&&N.push(x),an(N)}function AB(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=gr(ct)),t&&t.SSF&&(Hc(),Id(t.SSF),r.revssf=Rd(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,_x(r),r.cellXfs=[],Ro(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=SB(s,r,t);return n.unshift(kB(t,n,r)),an(n)}function l4(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=ys(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return AB(t,e);case 4:case 3:case 2:return gB(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function kw(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),o=s.index,c=i&&i.index||t.length,u=uD(t.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,d=0,g=0,x=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(o=0;o<u.length;++o){var y=u[o].trim(),S=y.slice(0,3).toLowerCase();if(S=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}d=0;continue}if(!(S!="<td"&&S!="<th")){var R=y.split(/<\/t[dh]>/i);for(c=0;c<R.length;++c){var M=R[c].trim();if(M.match(/<t[dh]/i)){for(var N=M,V=0;N.charAt(0)=="<"&&(V=N.indexOf(">"))>-1;)N=N.slice(V+1);for(var W=0;W<k.length;++W){var j=k[W];j.s.c==d&&j.s.r<h&&h<=j.e.r&&(d=j.e.c+1,W=-1)}var A=pt(M.slice(0,M.indexOf(">")));x=A.colspan?+A.colspan:1,((g=+A.rowspan)>1||x>1)&&k.push({s:{r:h,c:d},e:{r:h+(g||1)-1,c:d+x-1}});var F=A.t||A["data-t"]||"";if(!N.length){d+=x;continue}if(N=bS(N),_.s.r>h&&(_.s.r=h),_.e.r<h&&(_.e.r=h),_.s.c>d&&(_.s.c=d),_.e.c<d&&(_.e.c=d),!N.length){d+=x;continue}var I={t:"s",v:N};r.raw||!N.trim().length||F=="s"||(N==="TRUE"?I={t:"b",v:!0}:N==="FALSE"?I={t:"b",v:!1}:isNaN(vi(N))?isNaN(Nc(N).getDate())||(I={t:"d",v:mr(N)},r.cellDates||(I={t:"n",v:Jr(I.v)}),I.z=r.dateNF||ct[14]):I={t:"n",v:vi(N)}),r.dense?(n[h]||(n[h]=[]),n[h][d]=I):n[ht({r:h,c:d})]=I,d+=x}}}}return n["!ref"]=Et(_),k.length&&(n["!merges"]=k),n}function CB(t,e,r,n){for(var s=t["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var c=0,u=0,h=0;h<s.length;++h)if(!(s[h].s.r>r||s[h].s.c>o)&&!(s[h].e.r<r||s[h].e.c<o)){if(s[h].s.r<r||s[h].s.c<o){c=-1;break}c=s[h].e.r-s[h].s.r+1,u=s[h].e.c-s[h].s.c+1;break}if(!(c<0)){var d=ht({r,c:o}),g=n.dense?(t[r]||[])[o]:t[d],x=g&&g.v!=null&&(g.h||q1(g.w||(Aa(g),g.w)||""))||"",_={};c>1&&(_.rowspan=c),u>1&&(_.colspan=u),n.editable?x='<span contenteditable="true">'+x+"</span>":g&&(_["data-t"]=g&&g.t||"z",g.v!=null&&(_["data-v"]=g.v),g.z!=null&&(_["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+g.l.Target+'">'+x+"</a>")),_.id=(n.id||"sjs")+"-"+d,i.push(He("td",x,_))}}var k="<tr>";return k+i.join("")+"</tr>"}var IB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',FB="</body></html>";function RB(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Fo(kw(r[0],e),e);var n=Tx();return r.forEach(function(s,i){Sx(n,kw(s,e),"Sheet"+(i+1))}),n}function NB(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function c4(t,e){var r=e||{},n=r.header!=null?r.header:IB,s=r.footer!=null?r.footer:FB,i=[n],o=ys(t["!ref"]);r.dense=Array.isArray(t),i.push(NB(t,o,r));for(var c=o.s.r;c<=o.e.r;++c)i.push(CB(t,o,c,r));return i.push("</table>"+s),i.join("")}function u4(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?Tr(n.origin):n.origin;s=o.r,i=o.c}var c=e.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var d=ys(t["!ref"]);h.s.r=Math.min(h.s.r,d.s.r),h.s.c=Math.min(h.s.c,d.s.c),h.e.r=Math.max(h.e.r,d.e.r),h.e.c=Math.max(h.e.c,d.e.c),s==-1&&(h.e.r=s=d.e.r+1)}var g=[],x=0,_=t["!rows"]||(t["!rows"]=[]),k=0,y=0,S=0,R=0,M=0,N=0;for(t["!cols"]||(t["!cols"]=[]);k<c.length&&y<u;++k){var V=c[k];if(Aw(V)){if(n.display)continue;_[y]={hidden:!0}}var W=V.children;for(S=R=0;S<W.length;++S){var j=W[S];if(!(n.display&&Aw(j))){var A=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):bS(j.innerHTML),F=j.getAttribute("data-z")||j.getAttribute("z");for(x=0;x<g.length;++x){var I=g[x];I.s.c==R+i&&I.s.r<y+s&&y+s<=I.e.r&&(R=I.e.c+1-i,x=-1)}N=+j.getAttribute("colspan")||1,((M=+j.getAttribute("rowspan")||1)>1||N>1)&&g.push({s:{r:y+s,c:R+i},e:{r:y+s+(M||1)-1,c:R+i+(N||1)-1}});var U={t:"s",v:A},L=j.getAttribute("data-t")||j.getAttribute("t")||"";A!=null&&(A.length==0?U.t=L||"z":n.raw||A.trim().length==0||L=="s"||(A==="TRUE"?U={t:"b",v:!0}:A==="FALSE"?U={t:"b",v:!1}:isNaN(vi(A))?isNaN(Nc(A).getDate())||(U={t:"d",v:mr(A)},n.cellDates||(U={t:"n",v:Jr(U.v)}),U.z=n.dateNF||ct[14]):U={t:"n",v:vi(A)})),U.z===void 0&&F!=null&&(U.z=F);var D="",B=j.getElementsByTagName("A");if(B&&B.length)for(var De=0;De<B.length&&!(B[De].hasAttribute("href")&&(D=B[De].getAttribute("href"),D.charAt(0)!="#"));++De);D&&D.charAt(0)!="#"&&(U.l={Target:D}),n.dense?(t[y+s]||(t[y+s]=[]),t[y+s][R+i]=U):t[ht({c:R+i,r:y+s})]=U,h.e.c<R+i&&(h.e.c=R+i),R+=N}}++y}return g.length&&(t["!merges"]=(t["!merges"]||[]).concat(g)),h.e.r=Math.max(h.e.r,y-1+s),t["!ref"]=Et(h),y>=u&&(t["!fullref"]=Et((h.e.r=c.length-k+y-1+s,h))),t}function f4(t,e){var r=e||{},n=r.dense?[]:{};return u4(n,t,e)}function bB(t,e){return Fo(f4(t,e),e)}function Aw(t){var e="",r=DB(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function DB(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function PB(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ht(e.replace(/<[^>]*>/g,""));return[r]}var Cw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function h4(t,e){var r=e||{},n=K1(t),s=[],i,o,c={name:""},u="",h=0,d,g,x={},_=[],k=r.dense?[]:{},y,S,R={value:""},M="",N=0,V=[],W=-1,j=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,I={},U=[],L={},D=0,B=0,De=[],Re=1,Ve=1,Le=[],Ae={Names:[]},ne={},we=["",""],ee=[],O={},te="",J=0,Z=!1,oe=!1,_e=0;for(mf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=mf.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?k["!ref"]=Et(A):k["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(k["!fullref"]=k["!ref"],A.e.r=r.sheetRows-1,k["!ref"]=Et(A)),U.length&&(k["!merges"]=U),De.length&&(k["!rows"]=De),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),_.push(d.name),x[d.name]=k,oe=!1):y[0].charAt(y[0].length-2)!=="/"&&(d=pt(y[0],!1),W=j=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,k=r.dense?[]:{},U=[],De=[],oe=!0);break;case"table-row-group":y[1]==="/"?--F:++F;break;case"table-row":case"":if(y[1]==="/"){W+=Re,Re=1;break}if(g=pt(y[0],!1),g.?W=g.-1:W==-1&&(W=0),Re=+g["number-rows-repeated"]||1,Re<10)for(_e=0;_e<Re;++_e)F>0&&(De[W+_e]={level:F});j=-1;break;case"covered-table-cell":y[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(k[W]||(k[W]=[]),k[W][j]={t:"z"}):k[ht({r:W,c:j})]={t:"z"}),M="",V=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++j,R=pt(y[0],!1),Ve=parseInt(R["number-columns-repeated"]||"1",10),S={t:"z",v:null},R.formula&&r.cellFormula!=!1&&(S.f=Ew(Ht(R.formula))),(R.||R["value-type"])=="string"&&(S.t="s",S.v=Ht(R["string-value"]||""),r.dense?(k[W]||(k[W]=[]),k[W][j]=S):k[ht({r:W,c:j})]=S),j+=Ve-1;else if(y[1]!=="/"){++j,M="",N=0,V=[],Ve=1;var ve=Re?W+Re-1:W;if(j>A.e.c&&(A.e.c=j),j<A.s.c&&(A.s.c=j),W<A.s.r&&(A.s.r=W),ve>A.e.r&&(A.e.r=ve),R=pt(y[0],!1),ee=[],O={},S={t:R.||R["value-type"],v:null},r.cellFormula)if(R.formula&&(R.formula=Ht(R.formula)),R["number-matrix-columns-spanned"]&&R["number-matrix-rows-spanned"]&&(D=parseInt(R["number-matrix-rows-spanned"],10)||0,B=parseInt(R["number-matrix-columns-spanned"],10)||0,L={s:{r:W,c:j},e:{r:W+D-1,c:j+B-1}},S.F=Et(L),Le.push([L,S.F])),R.formula)S.f=Ew(R.formula);else for(_e=0;_e<Le.length;++_e)W>=Le[_e][0].s.r&&W<=Le[_e][0].e.r&&j>=Le[_e][0].s.c&&j<=Le[_e][0].e.c&&(S.F=Le[_e][1]);switch((R["number-columns-spanned"]||R["number-rows-spanned"])&&(D=parseInt(R["number-rows-spanned"],10)||0,B=parseInt(R["number-columns-spanned"],10)||0,L={s:{r:W,c:j},e:{r:W+D-1,c:j+B-1}},U.push(L)),R["number-columns-repeated"]&&(Ve=parseInt(R["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=dr(R["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(R.value);break;case"percentage":S.t="n",S.v=parseFloat(R.value);break;case"currency":S.t="n",S.v=parseFloat(R.value);break;case"date":S.t="d",S.v=mr(R["date-value"]),r.cellDates||(S.t="n",S.v=Jr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=oD(R["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Nd(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(R.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",R["string-value"]!=null&&(M=Ht(R["string-value"]),V=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(Z=!1,S.t==="s"&&(S.v=M||"",V.length&&(S.R=V),Z=N==0),ne.Target&&(S.l=ne),ee.length>0&&(S.c=ee,ee=[]),M&&r.cellText!==!1&&(S.w=M),Z&&(S.t="z",delete S.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=W))for(var xe=0;xe<Re;++xe){if(Ve=parseInt(R["number-columns-repeated"]||"1",10),r.dense)for(k[W+xe]||(k[W+xe]=[]),k[W+xe][j]=xe==0?S:gr(S);--Ve>0;)k[W+xe][j+Ve]=gr(S);else for(k[ht({r:W+xe,c:j})]=S;--Ve>0;)k[ht({r:W+xe,c:j+Ve})]=gr(S);A.e.c<=j&&(A.e.c=j)}Ve=parseInt(R["number-columns-repeated"]||"1",10),j+=Ve-1,Ve=0,S={},M="",V=[]}ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i;O.t=M,V.length&&(O.R=V),O.a=te,ee.push(O)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);te="",J=0,M="",N=0,V=[];break;case"creator":y[1]==="/"?te=n.slice(J,y.index):J=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);M="",N=0,V=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(I[c.name]=u,(i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(u="",c=pt(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=pt(y[0],!1),u+=Cw[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=pt(y[0],!1),u+=Cw[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(h,y.index);break}else h=y.index+y[0].length;break;case"named-range":o=pt(y[0],!1),we=Dm(o["cell-range-address"]);var Te={Name:o.name,Ref:we[0]+"!"+we[1]};oe&&(Te.Sheet=_.length),Ae.Names.push(Te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!R||!R["string-value"])){var ut=PB(n.slice(N,y.index));M=(M.length>0?M+`
`:"")+ut[0]}else pt(y[0],!1),N=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{we=Dm(pt(y[0])["target-range-address"]),x[we[0]]["!autofilter"]={ref:we[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(ne=pt(y[0],!1),!ne.href)break;ne.Target=Ht(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(we=Dm(ne.Target.slice(1)),ne.Target="#"+we[0]+"!"+we[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var Y={Sheets:x,SheetNames:_,Workbook:Ae};return r.bookSheets&&delete Y.Sheets,Y}function Iw(t,e){e=e||{},Qs(t,"META-INF/manifest.xml")&&oP(jr(t,"META-INF/manifest.xml"),e);var r=Os(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=h4(ir(r),e);return Qs(t,"meta.xml")&&(n.Props=rk(jr(t,"meta.xml"))),n}function Fw(t,e){return h4(t,e)}var OB=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+pf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Lr+e}})(),Rw=(function(){var t=function(i){return nr(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,c){var u=[];u.push('      <table:table table:name="'+nr(o.SheetNames[c])+`" table:style-name="ta1">
`);var h=0,d=0,g=ys(i["!ref"]||"A1"),x=i["!merges"]||[],_=0,k=Array.isArray(i);if(i["!cols"])for(d=0;d<=g.e.c;++d)u.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var y="",S=i["!rows"]||[];for(h=0;h<g.s.r;++h)y=S[h]?' table:style-name="ro'+S[h].ods+'"':"",u.push("        <table:table-row"+y+`></table:table-row>
`);for(;h<=g.e.r;++h){for(y=S[h]?' table:style-name="ro'+S[h].ods+'"':"",u.push("        <table:table-row"+y+`>
`),d=0;d<g.s.c;++d)u.push(e);for(;d<=g.e.c;++d){var R=!1,M={},N="";for(_=0;_!=x.length;++_)if(!(x[_].s.c>d)&&!(x[_].s.r>h)&&!(x[_].e.c<d)&&!(x[_].e.r<h)){(x[_].s.c!=d||x[_].s.r!=h)&&(R=!0),M["table:number-columns-spanned"]=x[_].e.c-x[_].s.c+1,M["table:number-rows-spanned"]=x[_].e.r-x[_].s.r+1;break}if(R){u.push(r);continue}var V=ht({r:h,c:d}),W=k?(i[h]||[])[d]:i[V];if(W&&W.f&&(M["table:formula"]=nr(t9(W.f)),W.F&&W.F.slice(0,V.length)==V)){var j=ys(W.F);M["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,M["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!W){u.push(e);continue}switch(W.t){case"b":N=W.v?"TRUE":"FALSE",M["office:value-type"]="boolean",M["office:boolean-value"]=W.v?"true":"false";break;case"n":N=W.w||String(W.v||0),M["office:value-type"]="float",M["office:value"]=W.v||0;break;case"s":case"str":N=W.v==null?"":W.v,M["office:value-type"]="string";break;case"d":N=W.w||mr(W.v).toISOString(),M["office:value-type"]="date",M["office:date-value"]=mr(W.v).toISOString(),M["table:style-name"]="ce1";break;default:u.push(e);continue}var A=t(N);if(W.l&&W.l.Target){var F=W.l.Target;F=F.charAt(0)=="#"?"#"+r9(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),A=He("text:a",A,{"xlink:href":F.replace(/&/g,"&amp;")})}u.push("          "+He("table:table-cell",He("text:p",A,{}),M)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var d=0;d<h["!cols"].length;++d)if(h["!cols"][d]){var g=h["!cols"][d];if(g.width==null&&g.wpx==null&&g.wch==null)continue;Eo(g),g.ods=c;var x=h["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),i.push(`  </style:style>
`),++c}}});var u=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var d=0;d<h["!rows"].length;++d)if(h["!rows"][d]){h["!rows"][d].ods=u;var g=h["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),i.push(`  </style:style>
`),++u}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,c){var u=[Lr],h=pf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=pf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(u.push("<office:document"+h+d+`>
`),u.push(tk().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+h+`>
`),s(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)u.push(n(o.Sheets[o.SheetNames[g]],o,g));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),c.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function d4(t,e){if(e.bookType=="fods")return Rw(t,e);var r=W1(),n="",s=[],i=[];return n="mimetype",Tt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Tt(r,n,Rw(t,e)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Tt(r,n,OB(t,e)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Tt(r,n,Lr+tk()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Tt(r,n,uP(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Tt(r,n,lP(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function _l(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Fg(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):ir(Io(t))}function LB(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ps(ji(t))}function MB(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function So(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function Nw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function VB(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function BB(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)t[e+i]=s&255;t[e+15]|=r>=0?0:128}function Ef(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function tr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Ir(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Kt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Ef(t,r),i=s&7;s=Math.floor(s/8);var o=0,c;if(s==0)break;switch(i){case 0:{for(var u=r[0];t[r[0]++]>=128;);c=t.slice(u,r[0])}break;case 5:o=4,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Ef(t,r),c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var h={data:c,type:i};e[s]==null?e[s]=[h]:e[s].push(h)}return e}function gn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(tr(n*8+s.type)),s.type==2&&e.push(tr(s.data.length)),e.push(s.data))})}),So(e)}function xx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Xs(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Ef(t,n),i=Kt(t.slice(n[0],n[0]+s));n[0]+=s;var o={id:Ir(i[1][0].data),messages:[]};i[2].forEach(function(c){var u=Kt(c.data),h=Ir(u[3][0].data);o.messages.push({meta:u,data:t.slice(n[0],n[0]+h)}),n[0]+=h}),(e=i[3])!=null&&e[0]&&(o.merge=Ir(i[3][0].data)>>>0>0),r.push(o)}return r}function ac(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:tr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:tr(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:tr(o.data.length)}],n[2].push({data:gn(o.meta),type:2})});var i=gn(n);e.push(tr(i.length)),e.push(i),s.forEach(function(o){return e.push(o)})}),So(e)}function UB(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Ef(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=e[r[0]],c>1&&(o|=e[r[0]+1]<<8),c>2&&(o|=e[r[0]+2]<<16),c>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}s.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,h=0;if(i==1?(h=(e[r[0]]>>2&7)+4,u=(e[r[0]++]&224)<<3,u|=e[r[0]++]):(h=(e[r[0]++]>>2)+1,i==2?(u=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(u=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[So(s)],u==0)throw new Error("Invalid offset 0");if(u>s[0].length)throw new Error("Invalid offset beyond length");if(h>=u)for(s.push(s[0].slice(-u)),h-=u;h>=s[s.length-1].length;)s.push(s[s.length-1]),h-=s[s.length-1].length;s.push(s[0].slice(-u,-u+h))}}var d=So(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Ys(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(UB(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return So(e)}function oc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var i=tr(n),o=i.length;e.push(i),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=n}return So(e)}function jB(t,e,r,n){var s=_l(t),i=s.getUint32(4,!0),o=(n>1?12:8)+Nw(i&(n>1?3470:398))*4,c=-1,u=-1,h=NaN,d=new Date(2001,0,1);i&512&&(c=s.getUint32(o,!0),o+=4),o+=Nw(i&(n>1?12288:4096))*4,i&16&&(u=s.getUint32(o,!0),o+=4),i&32&&(h=s.getFloat64(o,!0),o+=8),i&64&&(d.setTime(d.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var g;switch(t[2]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:e[u]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(c>-1)g={t:"s",v:r[c]};else if(u>-1)g={t:"s",v:e[u]};else if(!isNaN(h))g={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return g}function zB(t,e,r){var n=_l(t),s=n.getUint32(8,!0),i=12,o=-1,c=-1,u=NaN,h=NaN,d=new Date(2001,0,1);s&1&&(u=VB(t,i),i+=16),s&2&&(h=n.getFloat64(i,!0),i+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(c=n.getUint32(i,!0),i+=4),s&16&&(o=n.getUint32(i,!0),i+=4);var g;switch(t[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:e[c]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return g}function Om(t,e){var r=new Uint8Array(32),n=_l(r),s=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,BB(r,s,t.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),i|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,s)}function Lm(t,e){var r=new Uint8Array(32),n=_l(r),s=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),i|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,s)}function HB(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return jB(t,e,r,t[0]);case 5:return zB(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Vn(t){var e=Kt(t);return Ef(e[1][0].data)}function bw(t,e){var r=Kt(e.data),n=Ir(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var c=Kt(o.data),u=Ir(c[1][0].data)>>>0;switch(n){case 1:i[u]=Fg(c[3][0].data);break;case 8:{var h=t[Vn(c[9][0].data)][0],d=Kt(h.data),g=t[Vn(d[1][0].data)][0],x=Ir(g.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var _=Kt(g.data);i[u]=_[3].map(function(k){return Fg(k.data)}).join("")}break}}),i}function WB(t,e){var r,n,s,i,o,c,u,h,d,g,x,_,k,y,S=Kt(t),R=Ir(S[1][0].data)>>>0,M=Ir(S[2][0].data)>>>0,N=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&Ir(S[8][0].data)>0||!1,V,W;if((i=(s=S[7])==null?void 0:s[0])!=null&&i.data&&e!=0)V=(c=(o=S[7])==null?void 0:o[0])==null?void 0:c.data,W=(h=(u=S[6])==null?void 0:u[0])==null?void 0:h.data;else if((g=(d=S[4])==null?void 0:d[0])!=null&&g.data&&e!=1)V=(_=(x=S[4])==null?void 0:x[0])==null?void 0:_.data,W=(y=(k=S[3])==null?void 0:k[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var j=N?4:1,A=_l(V),F=[],I=0;I<V.length/2;++I){var U=A.getUint16(I*2,!0);U<65535&&F.push([I,U])}if(F.length!=M)throw"Expected ".concat(M," cells, found ").concat(F.length);var L=[];for(I=0;I<F.length-1;++I)L[F[I][0]]=W.subarray(F[I][1]*j,F[I+1][1]*j);return F.length>=1&&(L[F[F.length-1][0]]=W.subarray(F[F.length-1][1]*j)),{R,cells:L}}function $B(t,e){var r,n=Kt(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Ir(n[7][0].data)>>>0>0?1:0:-1,i=xx(n[5],function(o){return WB(o,s)});return{nrows:Ir(n[4][0].data)>>>0,data:i.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(u,h){if(o[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));o[c.R][h]=u}),o},[])}}function GB(t,e,r){var n,s=Kt(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Ir(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Ir(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Et(i);var o=Kt(s[4][0].data),c=bw(t,t[Vn(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?bw(t,t[Vn(o[17][0].data)][0]):[],h=Kt(o[3][0].data),d=0;h[1].forEach(function(g){var x=Kt(g.data),_=t[Vn(x[2][0].data)][0],k=Ir(_.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var y=$B(t,_);y.data.forEach(function(S,R){S.forEach(function(M,N){var V=ht({r:d+R,c:N}),W=HB(M,c,u);W&&(r[V]=W)})}),d+=y.nrows})}function qB(t,e){var r=Kt(e.data),n={"!ref":"A1"},s=t[Vn(r[2][0].data)],i=Ir(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return GB(t,s[0],n),n}function KB(t,e){var r,n=Kt(e.data),s={name:(r=n[1])!=null&&r[0]?Fg(n[1][0].data):"",sheets:[]},i=xx(n[2],Vn);return i.forEach(function(o){t[o].forEach(function(c){var u=Ir(c.meta[1][0].data);u==6e3&&s.sheets.push(qB(t,c))})}),s}function XB(t,e){var r=Tx(),n=Kt(e.data),s=xx(n[1],Vn);if(s.forEach(function(i){t[i].forEach(function(o){var c=Ir(o.meta[1][0].data);if(c==2){var u=KB(t,o);u.sheets.forEach(function(h,d){Sx(r,h,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Mm(t){var e,r,n,s,i={},o=[];if(t.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var h;try{h=Ys(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var d;try{d=Xs(h)}catch(g){return console.log("## "+(g.message||g))}d.forEach(function(g){i[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var c=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Ir(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||o.forEach(function(u){i[u].forEach(function(h){var d=Ir(h.meta[1][0].data)>>>0;if(d==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return XB(i,c)}function YB(t,e,r){var n,s,i,o;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&Ir(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var u=0,h=_l(t[7][0].data),d=0,g=[],x=_l(t[4][0].data),_=0,k=[],y=0;y<e.length;++y){if(e[y]==null){h.setUint16(y*2,65535,!0),x.setUint16(y*2,65535);continue}h.setUint16(y*2,d,!0),x.setUint16(y*2,_,!0);var S,R;switch(typeof e[y]){case"string":S=Om({t:"s",v:e[y]},r),R=Lm({t:"s",v:e[y]},r);break;case"number":S=Om({t:"n",v:e[y]},r),R=Lm({t:"n",v:e[y]},r);break;case"boolean":S=Om({t:"b",v:e[y]},r),R=Lm({t:"b",v:e[y]},r);break;default:throw new Error("Unsupported value "+e[y])}g.push(S),d+=S.length,k.push(R),_+=R.length,++u}for(t[2][0].data=tr(u);y<t[7][0].data.length/2;++y)h.setUint16(y*2,65535,!0),x.setUint16(y*2,65535,!0);return t[6][0].data=So(g),t[3][0].data=So(k),u}function QB(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ys(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Et(n)));var i=nd(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(te){return te.forEach(function(J){typeof J=="string"&&o.push(J)})});var c={},u=[],h=nt.read(e.numbers,{type:"base64"});h.FileIndex.map(function(te,J){return[te,h.FullPaths[J]]}).forEach(function(te){var J=te[0],Z=te[1];if(J.type==2&&J.name.match(/\.iwa/)){var oe=J.content,_e=Ys(oe),ve=Xs(_e);ve.forEach(function(xe){u.push(xe.id),c[xe.id]={deps:[],location:Z,type:Ir(xe.messages[0].meta[1][0].data)}})}}),u.sort(function(te,J){return te-J});var d=u.filter(function(te){return te>1}).map(function(te){return[te,tr(te)]});h.FileIndex.map(function(te,J){return[te,h.FullPaths[J]]}).forEach(function(te){var J=te[0];if(te[1],!!J.name.match(/\.iwa/)){var Z=Xs(Ys(J.content));Z.forEach(function(oe){oe.messages.forEach(function(_e){d.forEach(function(ve){oe.messages.some(function(xe){return Ir(xe.meta[1][0].data)!=11006&&MB(xe.data,ve[1])})&&c[ve[0]].deps.push(oe.id)})})})}});for(var g=nt.find(h,c[1].location),x=Xs(Ys(g.content)),_,k=0;k<x.length;++k){var y=x[k];y.id==1&&(_=y)}var S=Vn(Kt(_.messages[0].data)[1][0].data);for(g=nt.find(h,c[S].location),x=Xs(Ys(g.content)),k=0;k<x.length;++k)y=x[k],y.id==S&&(_=y);for(S=Vn(Kt(_.messages[0].data)[2][0].data),g=nt.find(h,c[S].location),x=Xs(Ys(g.content)),k=0;k<x.length;++k)y=x[k],y.id==S&&(_=y);for(S=Vn(Kt(_.messages[0].data)[2][0].data),g=nt.find(h,c[S].location),x=Xs(Ys(g.content)),k=0;k<x.length;++k)y=x[k],y.id==S&&(_=y);var R=Kt(_.messages[0].data);{R[6][0].data=tr(n.e.r+1),R[7][0].data=tr(n.e.c+1);var M=Vn(R[46][0].data),N=nt.find(h,c[M].location),V=Xs(Ys(N.content));{for(var W=0;W<V.length&&V[W].id!=M;++W);if(V[W].id!=M)throw"Bad ColumnRowUIDMapArchive";var j=Kt(V[W].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var A=0;A<=n.e.c;++A){var F=[];F[1]=F[2]=[{type:0,data:tr(A+420690)}],j[1].push({type:2,data:gn(F)}),j[2].push({type:0,data:tr(A)}),j[3].push({type:0,data:tr(A)})}j[4]=[],j[5]=[],j[6]=[];for(var I=0;I<=n.e.r;++I)F=[],F[1]=F[2]=[{type:0,data:tr(I+726270)}],j[4].push({type:2,data:gn(F)}),j[5].push({type:0,data:tr(I)}),j[6].push({type:0,data:tr(I)});V[W].messages[0].data=gn(j)}N.content=oc(ac(V)),N.size=N.content.length,delete R[46];var U=Kt(R[4][0].data);{U[7][0].data=tr(n.e.r+1);var L=Kt(U[1][0].data),D=Vn(L[2][0].data);N=nt.find(h,c[D].location),V=Xs(Ys(N.content));{if(V[0].id!=D)throw"Bad HeaderStorageBucket";var B=Kt(V[0].messages[0].data);for(I=0;I<i.length;++I){var De=Kt(B[2][0].data);De[1][0].data=tr(I),De[4][0].data=tr(i[I].length),B[2][I]={type:B[2][0].type,data:gn(De)}}V[0].messages[0].data=gn(B)}N.content=oc(ac(V)),N.size=N.content.length;var Re=Vn(U[2][0].data);N=nt.find(h,c[Re].location),V=Xs(Ys(N.content));{if(V[0].id!=Re)throw"Bad HeaderStorageBucket";for(B=Kt(V[0].messages[0].data),A=0;A<=n.e.c;++A)De=Kt(B[2][0].data),De[1][0].data=tr(A),De[4][0].data=tr(n.e.r+1),B[2][A]={type:B[2][0].type,data:gn(De)};V[0].messages[0].data=gn(B)}N.content=oc(ac(V)),N.size=N.content.length;var Ve=Vn(U[4][0].data);(function(){for(var te=nt.find(h,c[Ve].location),J=Xs(Ys(te.content)),Z,oe=0;oe<J.length;++oe){var _e=J[oe];_e.id==Ve&&(Z=_e)}var ve=Kt(Z.messages[0].data);{ve[3]=[];var xe=[];o.forEach(function(Y,At){xe[1]=[{type:0,data:tr(At)}],xe[2]=[{type:0,data:tr(1)}],xe[3]=[{type:2,data:LB(Y)}],ve[3].push({type:2,data:gn(xe)})})}Z.messages[0].data=gn(ve);var Te=ac(J),ut=oc(Te);te.content=ut,te.size=te.content.length})();var Le=Kt(U[3][0].data);{var Ae=Le[1][0];delete Le[2];var ne=Kt(Ae.data);{var we=Vn(ne[2][0].data);(function(){for(var te=nt.find(h,c[we].location),J=Xs(Ys(te.content)),Z,oe=0;oe<J.length;++oe){var _e=J[oe];_e.id==we&&(Z=_e)}var ve=Kt(Z.messages[0].data);{delete ve[6],delete Le[7];var xe=new Uint8Array(ve[5][0].data);ve[5]=[];for(var Te=0,ut=0;ut<=n.e.r;++ut){var Y=Kt(xe);Te+=YB(Y,i[ut],o),Y[1][0].data=tr(ut),ve[5].push({data:gn(Y),type:2})}ve[1]=[{type:0,data:tr(n.e.c+1)}],ve[2]=[{type:0,data:tr(n.e.r+1)}],ve[3]=[{type:0,data:tr(Te)}],ve[4]=[{type:0,data:tr(n.e.r+1)}]}Z.messages[0].data=gn(ve);var At=ac(J),wt=oc(At);te.content=wt,te.size=te.content.length})()}Ae.data=gn(ne)}U[3][0].data=gn(Le)}R[4][0].data=gn(U)}_.messages[0].data=gn(R);var ee=ac(x),O=oc(ee);return g.content=O,g.size=g.content.length,h}function p4(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function vx(t){p4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function _x(t){p4([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function JB(t){return Ft.WS.indexOf(t)>-1?"sheet":t==Ft.CS?"chart":t==Ft.DS?"dialog":t==Ft.MS?"macro":t&&t.length?t:"sheet"}function ZB(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,JB(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function eU(t,e,r,n,s,i,o,c,u,h,d,g){try{i[n]=qu(Os(t,r,!0),e);var x=jr(t,e),_;switch(c){case"sheet":_=EV(x,e,s,u,i[n],h,d,g);break;case"chart":if(_=TV(x,e,s,u,i[n],h,d,g),!_||!_["!drawel"])break;var k=Mu(_["!drawel"].Target,e),y=gf(k),S=cL(Os(t,k,!0),qu(Os(t,y,!0),k)),R=Mu(S,k),M=gf(R);_=Y7(Os(t,R,!0),R,u,qu(Os(t,M,!0),R),h,_);break;case"macro":_=SV(x,e,s,u,i[n],h,d,g);break;case"dialog":_=kV(x,e,s,u,i[n],h,d,g);break;default:throw new Error("Unrecognized sheet type "+c)}o[n]=_;var N=[];i&&i[n]&&Fr(i[n]).forEach(function(V){var W="";if(i[n][V].Type==Ft.CMNT){W=Mu(i[n][V].Target,e);var j=FV(jr(t,W,!0),W,u);if(!j||!j.length)return;xw(_,j,!1)}i[n][V].Type==Ft.TCMNT&&(W=Mu(i[n][V].Target,e),N=N.concat(fL(jr(t,W,!0),u)))}),N&&N.length&&xw(_,N,!0,u.people||[])}catch(V){if(u.WTF)throw V}}function qs(t){return t.charAt(0)=="/"?t.slice(1):t}function tU(t,e){if(Hc(),e=e||{},vx(e),Qs(t,"META-INF/manifest.xml")||Qs(t,"objectdata.xml"))return Iw(t,e);if(Qs(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Mm<"u"){if(t.FileIndex)return Mm(t);var r=nt.utils.cfb_new();return V2(t).forEach(function(De){Tt(r,De,hD(t,De))}),Mm(r)}throw new Error("Unsupported NUMBERS file")}if(!Qs(t,"[Content_Types].xml"))throw Qs(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Qs(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=V2(t),s=iP(Os(t,"[Content_Types].xml")),i=!1,o,c;if(s.workbooks.length===0&&(c="xl/workbook.xml",jr(t,c,!0)&&s.workbooks.push(c)),s.workbooks.length===0){if(c="xl/workbook.bin",!jr(t,c,!0))throw new Error("Could not find workbook");s.workbooks.push(c),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},h={};if(!e.bookSheets&&!e.bookProps){if(Ku=[],s.sst)try{Ku=IV(jr(t,qs(s.sst)),s.sst,e)}catch(De){if(e.WTF)throw De}e.cellStyles&&s.themes.length&&(u=CV(Os(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(h=AV(jr(t,qs(s.style)),s.style,u,e))}s.links.map(function(De){try{var Re=qu(Os(t,gf(qs(De))),De);return NV(jr(t,qs(De)),Re,De,e)}catch{}});var d=wV(jr(t,qs(s.workbooks[0])),s.workbooks[0],e),g={},x="";s.coreprops.length&&(x=jr(t,qs(s.coreprops[0]),!0),x&&(g=rk(x)),s.extprops.length!==0&&(x=jr(t,qs(s.extprops[0]),!0),x&&hP(x,g,e)));var _={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(x=Os(t,qs(s.custprops[0]),!0),x&&(_=pP(x,e)));var k={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(Re){return Re.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),e.bookProps&&(k.Props=g,k.Custprops=_),e.bookSheets&&typeof o<"u"&&(k.SheetNames=o),e.bookSheets?k.SheetNames:e.bookProps))return k;o={};var y={};e.bookDeps&&s.calcchain&&(y=RV(jr(t,qs(s.calcchain)),s.calcchain));var S=0,R={},M,N;{var V=d.Sheets;g.Worksheets=V.length,g.SheetNames=[];for(var W=0;W!=V.length;++W)g.SheetNames[W]=V[W].name}var j=i?"bin":"xml",A=s.workbooks[0].lastIndexOf("/"),F=(s.workbooks[0].slice(0,A+1)+"_rels/"+s.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Qs(t,F)||(F="xl/_rels/workbook."+j+".rels");var I=qu(Os(t,F,!0),F.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=bV(jr(t,qs(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=dL(jr(t,qs(s.people[0])),e)),I&&(I=ZB(I,d.Sheets));var U=jr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=g.Worksheets;++S){var L="sheet";if(I&&I[S]?(M="xl/"+I[S][1].replace(/[\/]?xl\//,""),Qs(t,M)||(M=I[S][1]),Qs(t,M)||(M=F.replace(/_rels\/.*$/,"")+I[S][1]),L=I[S][2]):(M="xl/worksheets/sheet"+(S+1-U)+"."+j,M=M.replace(/sheet0\./,"sheet.")),N=M.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(g.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,B=0;B!=e.sheets.length;++B)typeof e.sheets[B]=="number"&&e.sheets[B]==S&&(D=1),typeof e.sheets[B]=="string"&&e.sheets[B].toLowerCase()==g.SheetNames[S].toLowerCase()&&(D=1);if(!D)continue e}}eU(t,M,N,g.SheetNames[S],S,R,o,L,e,d,u,h)}return k={Directory:s,Workbook:d,Props:g,Custprops:_,Deps:y,Sheets:o,SheetNames:g.SheetNames,Strings:Ku,Styles:h,Themes:u,SSF:gr(ct)},e&&e.bookFiles&&(t.files?(k.keys=n,k.files=t.files):(k.keys=[],k.files={},t.FullPaths.forEach(function(De,Re){De=De.replace(/^Root Entry[\/]/,""),k.keys.push(De),k.files[De]=t.FileIndex[Re]}))),e&&e.bookVBA&&(s.vba.length>0?k.vbaraw=jr(t,qs(s.vba[0]),!0):s.defaults&&s.defaults.bin===wL&&(k.vbaraw=jr(t,"xl/vbaProject.bin",!0))),k}function rU(t,e){var r=e||{},n="Workbook",s=nt.find(t,n);try{if(n="/!DataSpaces/Version",s=nt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(b8(s.content),n="/!DataSpaces/DataSpaceMap",s=nt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=P8(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=nt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=O8(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=nt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);M8(s.content)}catch{}if(n="/EncryptionInfo",s=nt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=V8(s.content);if(n="/EncryptedPackage",s=nt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],s.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function nU(t,e){return e.bookType=="ods"?d4(t,e):e.bookType=="numbers"?QB(t,e):e.bookType=="xlsb"?sU(t,e):iU(t,e)}function sU(t,e){pc=1024,t&&!t.SSF&&(t.SSF=gr(ct)),t&&t.SSF&&(Hc(),Id(t.SSF),e.revssf=Rd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Xu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=jk.indexOf(e.bookType)>-1,s=sx();_x(e=e||{});var i=W1(),o="",c=0;if(e.cellXfs=[],Ro(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Tt(i,o,nk(t.Props,e)),s.coreprops.push(o),rr(e.rels,2,o,Ft.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(t.SheetNames[h]);t.Props.SheetNames=u}for(t.Props.Worksheets=t.Props.SheetNames.length,Tt(i,o,ak(t.Props)),s.extprops.push(o),rr(e.rels,3,o,Ft.EXT_PROPS),t.Custprops!==t.Props&&Fr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Tt(i,o,ok(t.Custprops)),s.custprops.push(o),rr(e.rels,4,o,Ft.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var d={"!id":{}},g=t.Sheets[t.SheetNames[c-1]],x=(g||{})["!type"]||"sheet";switch(x){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,Tt(i,o,PV(c-1,o,e,t,d)),s.sheets.push(o),rr(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Ft.WS[0])}if(g){var _=g["!comments"],k=!1,y="";_&&_.length>0&&(y="xl/comments"+c+"."+r,Tt(i,y,MV(_,y)),s.comments.push(y),rr(d,-1,"../comments"+c+"."+r,Ft.CMNT),k=!0),g["!legacy"]&&k&&Tt(i,"xl/drawings/vmlDrawing"+c+".vml",Bk(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}d["!id"].rId1&&Tt(i,gf(o),yc(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Tt(i,o,LV(e.Strings,o,e)),s.strs.push(o),rr(e.wbrels,-1,"sharedStrings."+r,Ft.SST)),o="xl/workbook."+r,Tt(i,o,DV(t,o)),s.workbooks.push(o),rr(e.rels,1,o,Ft.WB),o="xl/theme/theme1.xml",Tt(i,o,ux(t.Themes,e)),s.themes.push(o),rr(e.wbrels,-1,"theme/theme1.xml",Ft.THEME),o="xl/styles."+r,Tt(i,o,OV(t,o,e)),s.styles.push(o),rr(e.wbrels,-1,"styles."+r,Ft.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Tt(i,o,t.vbaraw),s.vba.push(o),rr(e.wbrels,-1,"vbaProject.bin",Ft.VBA)),o="xl/metadata."+r,Tt(i,o,VV(o)),s.metadata.push(o),rr(e.wbrels,-1,"metadata."+r,Ft.XLMETA),Tt(i,"[Content_Types].xml",ek(s,e)),Tt(i,"_rels/.rels",yc(e.rels)),Tt(i,"xl/_rels/workbook."+r+".rels",yc(e.wbrels)),delete e.revssf,delete e.ssf,i}function iU(t,e){pc=1024,t&&!t.SSF&&(t.SSF=gr(ct)),t&&t.SSF&&(Hc(),Id(t.SSF),e.revssf=Rd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Xu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=jk.indexOf(e.bookType)>-1,s=sx();_x(e=e||{});var i=W1(),o="",c=0;if(e.cellXfs=[],Ro(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Tt(i,o,nk(t.Props,e)),s.coreprops.push(o),rr(e.rels,2,o,Ft.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(t.SheetNames[h]);t.Props.SheetNames=u}t.Props.Worksheets=t.Props.SheetNames.length,Tt(i,o,ak(t.Props)),s.extprops.push(o),rr(e.rels,3,o,Ft.EXT_PROPS),t.Custprops!==t.Props&&Fr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Tt(i,o,ok(t.Custprops)),s.custprops.push(o),rr(e.rels,4,o,Ft.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,c=1;c<=t.SheetNames.length;++c){var g={"!id":{}},x=t.Sheets[t.SheetNames[c-1]],_=(x||{})["!type"]||"sheet";switch(_){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,Tt(i,o,Jk(c-1,e,t,g)),s.sheets.push(o),rr(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Ft.WS[0])}if(x){var k=x["!comments"],y=!1,S="";if(k&&k.length>0){var R=!1;k.forEach(function(M){M[1].forEach(function(N){N.T==!0&&(R=!0)})}),R&&(S="xl/threadedComments/threadedComment"+c+"."+r,Tt(i,S,hL(k,d,e)),s.threadedcomments.push(S),rr(g,-1,"../threadedComments/threadedComment"+c+"."+r,Ft.TCMNT)),S="xl/comments"+c+"."+r,Tt(i,S,Uk(k)),s.comments.push(S),rr(g,-1,"../comments"+c+"."+r,Ft.CMNT),y=!0}x["!legacy"]&&y&&Tt(i,"xl/drawings/vmlDrawing"+c+".vml",Bk(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&Tt(i,gf(o),yc(g))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Tt(i,o,Ck(e.Strings,e)),s.strs.push(o),rr(e.wbrels,-1,"sharedStrings."+r,Ft.SST)),o="xl/workbook."+r,Tt(i,o,n4(t)),s.workbooks.push(o),rr(e.rels,1,o,Ft.WB),o="xl/theme/theme1.xml",Tt(i,o,ux(t.Themes,e)),s.themes.push(o),rr(e.wbrels,-1,"theme/theme1.xml",Ft.THEME),o="xl/styles."+r,Tt(i,o,Ok(t,e)),s.styles.push(o),rr(e.wbrels,-1,"styles."+r,Ft.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Tt(i,o,t.vbaraw),s.vba.push(o),rr(e.wbrels,-1,"vbaProject.bin",Ft.VBA)),o="xl/metadata."+r,Tt(i,o,Vk()),s.metadata.push(o),rr(e.wbrels,-1,"metadata."+r,Ft.XLMETA),d.length>1&&(o="xl/persons/person.xml",Tt(i,o,pL(d)),s.people.push(o),rr(e.wbrels,-1,"persons/person.xml",Ft.PEOPLE)),Tt(i,"[Content_Types].xml",ek(s,e)),Tt(i,"_rels/.rels",yc(e.rels)),Tt(i,"xl/_rels/workbook."+r+".rels",yc(e.wbrels)),delete e.revssf,delete e.ssf,i}function yx(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ms(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function aU(t,e){return nt.find(t,"EncryptedPackage")?rU(t,e):o4(t,e)}function oU(t,e){var r,n=t,s=e||{};return s.type||(s.type=Ct&&Buffer.isBuffer(t)?"buffer":"base64"),r=FS(n,s),tU(r,s)}function m4(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Cg(t.slice(r),e);default:break e}return bc.to_workbook(t,e)}function lU(t,e){var r="",n=yx(t,e);switch(e.type){case"base64":r=Ms(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=ml(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ir(r)),e.type="binary",m4(r,e)}function cU(t,e){var r=t;return e.type=="base64"&&(r=Ms(r)),r=uf.utils.decode(1200,r.slice(2),"str"),e.type="binary",m4(r,e)}function uU(t){return t.match(/[^\x00-\x7F]/)?ji(t):t}function Vm(t,e,r,n){return n?(r.type="string",bc.to_workbook(t,r)):bc.to_workbook(e,r)}function Rg(t,e){B1();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Rg(new Uint8Array(t),(r=gr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ec={},r.dateNF&&(Ec.dateNF=r.dateNF),r.type||(r.type=Ct&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ct?"buffer":"binary",n=sD(t),typeof Uint8Array<"u"&&!Ct&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=uU(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=gr(r),r.type="array",Rg(U1(n),r)}switch((s=yx(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return aU(nt.read(n,r),r);break;case 9:if(s[1]<=8)return o4(n,r);break;case 60:return Cg(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return m8(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return kk.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?oU(n,r):Vm(t,n,r,i);case 239:return s[3]===60?Cg(n,r):Vm(t,n,r,i);case 255:if(s[1]===254)return cU(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return sl.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return sl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Ag.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return bk.to_workbook(n,r);break;case 10:case 13:case 32:return lU(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return p8.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Ag.to_workbook(n,r):Vm(t,n,r,i)}function g4(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Uf(e.file,nt.write(t,{type:Ct?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return nt.write(t,e)}function fU(t,e){var r=gr(e||{}),n=nU(t,r);return hU(n,r)}function hU(t,e){var r={},n=Ct?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?nt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(Cd(s))}return e.password&&typeof encrypt_agile<"u"?g4(encrypt_agile(s,e.password),e):e.type==="file"?Uf(e.file,s):e.type=="string"?ir(s):s}function dU(t,e){var r=e||{},n=uB(t,r);return g4(n,r)}function Mi(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return ff(ji(n));case"binary":return ji(n);case"string":return t;case"file":return Uf(e.file,n,"utf8");case"buffer":return Ct?Fa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Mi(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function pU(t,e){switch(e.type){case"base64":return ff(t);case"binary":return t;case"string":return t;case"file":return Uf(e.file,t,"binary");case"buffer":return Ct?Fa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function p0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?ff(r):e.type=="string"?ir(r):r;case"file":return Uf(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function wx(t,e){B1(),aV(t);var r=gr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=wx(t,r);return r.type="array",Cd(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Mi(nB(t,r),r);case"slk":case"sylk":return Mi(Sk.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return Mi(c4(t.Sheets[t.SheetNames[s]],r),r);case"txt":return pU(x4(t.Sheets[t.SheetNames[s]],r),r);case"csv":return Mi(Ex(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return Mi(kk.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return p0(Ag.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return Mi(bc.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return Mi(bk.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return Mi(Ak.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return Mi(d4(t,r),r);case"wk1":return p0(sl.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return p0(sl.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),p0(l4(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),dU(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return fU(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function mU(t,e,r,n,s,i,o,c){var u=Or(r),h=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,x=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!o||t[r])for(var _=e.s.c;_<=e.e.c;++_){var k=o?t[r][_]:t[n[_]+u];if(k===void 0||k.t===void 0){if(h===void 0)continue;i[_]!=null&&(x[i[_]]=h);continue}var y=k.v;switch(k.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(i[_]!=null){if(y==null)if(k.t=="e"&&y===null)x[i[_]]=null;else if(h!==void 0)x[i[_]]=h;else if(d&&y===null)x[i[_]]=null;else continue;else x[i[_]]=d&&(k.t!=="n"||k.t==="n"&&c.rawNumbers!==!1)?y:Aa(k,y,c);y!=null&&(g=!1)}}return{row:x,isempty:g}}function nd(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},d=h.range!=null?h.range:t["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof d){case"string":u=Wt(d);break;case"number":u=Wt(t["!ref"]),u.s.r=d;break;default:u=d}n>0&&(s=0);var g=Or(u.s.r),x=[],_=[],k=0,y=0,S=Array.isArray(t),R=u.s.r,M=0,N={};S&&!t[R]&&(t[R]=[]);var V=h.skipHidden&&t["!cols"]||[],W=h.skipHidden&&t["!rows"]||[];for(M=u.s.c;M<=u.e.c;++M)if(!(V[M]||{}).hidden)switch(x[M]=Er(M),r=S?t[R][M]:t[x[M]+g],n){case 1:i[M]=M-u.s.c;break;case 2:i[M]=x[M];break;case 3:i[M]=h.header[M-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=Aa(r,null,h),y=N[o]||0,!y)N[o]=1;else{do c=o+"_"+y++;while(N[c]);N[o]=y,N[c]=1}i[M]=c}for(R=u.s.r+s;R<=u.e.r;++R)if(!(W[R]||{}).hidden){var j=mU(t,u,R,x,n,i,S,h);(j.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(_[k++]=j.row)}return _.length=k,_}var Dw=/"/g;function gU(t,e,r,n,s,i,o,c){for(var u=!0,h=[],d="",g=Or(r),x=e.s.c;x<=e.e.c;++x)if(n[x]){var _=c.dense?(t[r]||[])[x]:t[n[x]+g];if(_==null)d="";else if(_.v!=null){u=!1,d=""+(c.rawNumbers&&_.t=="n"?_.v:Aa(_,null,c));for(var k=0,y=0;k!==d.length;++k)if((y=d.charCodeAt(k))===s||y===i||y===34||c.forceQuotes){d='"'+d.replace(Dw,'""')+'"';break}d=="ID"&&(d='"ID"')}else _.f!=null&&!_.F?(u=!1,d="="+_.f,d.indexOf(",")>=0&&(d='"'+d.replace(Dw,'""')+'"')):d="";h.push(d)}return c.blankrows===!1&&u?null:h.join(o)}function Ex(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Wt(t["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,u=c.charCodeAt(0),h=new RegExp((i=="|"?"\\|":i)+"+$"),d="",g=[];n.dense=Array.isArray(t);for(var x=n.skipHidden&&t["!cols"]||[],_=n.skipHidden&&t["!rows"]||[],k=s.s.c;k<=s.e.c;++k)(x[k]||{}).hidden||(g[k]=Er(k));for(var y=0,S=s.s.r;S<=s.e.r;++S)(_[S]||{}).hidden||(d=gU(t,s,S,g,o,u,i,n),d!=null&&(n.strip&&(d=d.replace(h,"")),(d||n.blankrows!==!1)&&r.push((y++?c:"")+d)));return delete n.dense,r.join("")}function x4(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Ex(t,e);return r}function xU(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Wt(t["!ref"]),i="",o=[],c,u=[],h=Array.isArray(t);for(c=s.s.c;c<=s.e.c;++c)o[c]=Er(c);for(var d=s.s.r;d<=s.e.r;++d)for(i=Or(d),c=s.s.c;c<=s.e.c;++c)if(e=o[c]+i,r=h?(t[d]||[])[c]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=e+"="+n}return u}function v4(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},o=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Tr(n.origin):n.origin;o=u.r,c=u.c}var h,d={s:{c:0,r:0},e:{c,r:o+e.length-1+s}};if(i["!ref"]){var g=Wt(i["!ref"]);d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),o==-1&&(o=g.e.r+1,d.e.r=o+e.length-1+s)}else o==-1&&(o=0,d.e.r=e.length-1+s);var x=n.header||[],_=0;e.forEach(function(y,S){Fr(y).forEach(function(R){(_=x.indexOf(R))==-1&&(x[_=x.length]=R);var M=y[R],N="z",V="",W=ht({c:c+_,r:o+S+s});h=Tf(i,W),M&&typeof M=="object"&&!(M instanceof Date)?i[W]=M:(typeof M=="number"?N="n":typeof M=="boolean"?N="b":typeof M=="string"?N="s":M instanceof Date?(N="d",n.cellDates||(N="n",M=Jr(M)),V=n.dateNF||ct[14]):M===null&&n.nullError&&(N="e",M=0),h?(h.t=N,h.v=M,delete h.w,delete h.R,V&&(h.z=V)):i[W]=h={t:N,v:M},V&&(h.z=V))})}),d.e.c=Math.max(d.e.c,c+x.length-1);var k=Or(o);if(s)for(_=0;_<x.length;++_)i[Er(_+c)+k]={t:"s",v:x[_]};return i["!ref"]=Et(d),i}function vU(t,e){return v4(null,t,e)}function Tf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Tr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Tf(t,ht(e)):Tf(t,ht({r:e,c:r||0}))}function _U(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Tx(){return{SheetNames:[],Sheets:{}}}function Sx(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=o+s)!=-1;++s);}if(r4(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function yU(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=_U(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function wU(t,e){return t.z=e,t}function _4(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function EU(t,e,r){return _4(t,"#"+e,r)}function TU(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function SU(t,e,r,n){for(var s=typeof e!="string"?e:Wt(e),i=typeof e=="string"?e:Et(e),o=s.s.r;o<=s.e.r;++o)for(var c=s.s.c;c<=s.e.c;++c){var u=Tf(t,o,c);u.t="n",u.F=i,delete u.v,o==s.s.r&&c==s.s.c&&(u.f=r,n&&(u.D=!0))}return t}var al={encode_col:Er,encode_row:Or,encode_cell:ht,encode_range:Et,decode_col:J1,decode_row:Q1,split_cell:LD,decode_cell:Tr,decode_range:ys,format_cell:Aa,sheet_add_aoa:qS,sheet_add_json:v4,sheet_add_dom:u4,aoa_to_sheet:Wc,json_to_sheet:vU,table_to_sheet:f4,table_to_book:bB,sheet_to_csv:Ex,sheet_to_txt:x4,sheet_to_json:nd,sheet_to_html:c4,sheet_to_formulae:xU,sheet_to_row_object_array:nd,sheet_get_cell:Tf,book_new:Tx,book_append_sheet:Sx,book_set_sheet_visibility:yU,cell_set_number_format:wU,cell_set_hyperlink:_4,cell_set_internal_link:EU,cell_add_comment:TU,sheet_set_array_formula:SU,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},k0={exports:{}},kU=k0.exports,Pw;function AU(){return Pw||(Pw=1,(function(t,e){(function(r,n){n()})(kU,function(){function r(h,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function n(h,d,g){var x=new XMLHttpRequest;x.open("GET",h),x.responseType="blob",x.onload=function(){u(x.response,d,g)},x.onerror=function(){console.error("could not download file")},x.send()}function s(h){var d=new XMLHttpRequest;d.open("HEAD",h,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function i(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(d)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Xh=="object"&&Xh.global===Xh?Xh:void 0,c=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(h,d,g){var x=o.URL||o.webkitURL,_=document.createElement("a");d=d||h.name||"download",_.download=d,_.rel="noopener",typeof h=="string"?(_.href=h,_.origin===location.origin?i(_):s(_.href)?n(h,d,g):i(_,_.target="_blank")):(_.href=x.createObjectURL(h),setTimeout(function(){x.revokeObjectURL(_.href)},4e4),setTimeout(function(){i(_)},0))}:"msSaveOrOpenBlob"in navigator?function(h,d,g){if(d=d||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(r(h,g),d);else if(s(h))n(h,d,g);else{var x=document.createElement("a");x.href=h,x.target="_blank",setTimeout(function(){i(x)})}}:function(h,d,g,x){if(x=x||open("","_blank"),x&&(x.document.title=x.document.body.innerText="downloading..."),typeof h=="string")return n(h,d,g);var _=h.type==="application/octet-stream",k=/constructor/i.test(o.HTMLElement)||o.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||_&&k||c)&&typeof FileReader<"u"){var S=new FileReader;S.onloadend=function(){var N=S.result;N=y?N:N.replace(/^data:[^;]*;/,"data:attachment/file;"),x?x.location.href=N:location=N,x=null},S.readAsDataURL(h)}else{var R=o.URL||o.webkitURL,M=R.createObjectURL(h);x?x.location=M:location.href=M,x=null,setTimeout(function(){R.revokeObjectURL(M)},4e4)}});o.saveAs=u.saveAs=u,t.exports=u})})(k0)),k0.exports}var y4=AU();const CU=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=s=>{try{const i=new Uint8Array(s.target.result),o=Rg(i,{type:"array"}),c=o.SheetNames[0],u=o.Sheets[c],h=al.sheet_to_json(u,{header:1});if(h.length<2){r(new Error(""));return}const d=h[0],g=h.slice(1).filter(x=>x.some(_=>_));e({headers:d,rows:g,sheetName:c})}catch{r(new Error(" Excel "))}},n.onerror=()=>{r(new Error(""))},n.readAsArrayBuffer(t)}),oj=t=>{const e={number:-1,name:-1,traits:-1,comment:-1},r={number:["","","","no","number",""],name:["","","","name",""],traits:["","","","","traits",""],comment:["","","","comment",""]};return t.forEach((n,s)=>{if(!n)return;const i=String(n).toLowerCase().trim();for(const[o,c]of Object.entries(r))c.some(u=>i.includes(u))&&(e[o]=s)}),e},IU=(t,e={})=>{const{includeNumber:r=!0,includeName:n=!0,includeTraits:s=!0,includeComment:i=!0,includeManualTraits:o=!1}=e,c=[],u=[];r&&u.push(""),n&&u.push(""),s&&u.push(""),o&&u.push(""),i&&u.push(""),c.push(u),t.forEach((g,x)=>{const _=[];r&&_.push(g.number||x+1),n&&_.push(g.name||""),s&&_.push((g.selectedTags||[]).join("")),o&&_.push(g.manualTraits||""),i&&_.push(g.comment||""),c.push(_)});const h=al.aoa_to_sheet(c);h["!cols"]=[{wch:6},{wch:10},{wch:30},{wch:20},{wch:60}];const d=al.book_new();return al.book_append_sheet(d,h,""),wx(d,{bookType:"xlsx",type:"array"})},lj=(t,e="",r={})=>{const n=IU(t,r),s=new Blob([n],{type:"application/octet-stream"});y4.saveAs(s,`${e}.xlsx`)},cj=()=>{const t=[["","","",""],[1,"","",""],[2,"","",""],[3,"","",""]],e=al.aoa_to_sheet(t);e["!cols"]=[{wch:6},{wch:10},{wch:30},{wch:20}];const r=al.book_new();al.book_append_sheet(r,e,"");const n=wx(r,{bookType:"xlsx",type:"array"}),s=new Blob([n],{type:"application/octet-stream"});y4.saveAs(s,".xlsx")},FU=({rawInput:t,setRawInput:e,numberCount:r,setNumberCount:n,onGenerateStudents:s,onGenerateNumbers:i,onResetList:o,onImportFromExcel:c,isGenerating:u})=>{const{toast:h}=zw(),d=ye.useRef(null),[g,x]=ye.useState(!1),_=async R=>{if(R){if(!R.name.match(/\.(xlsx|xls|csv)$/i)){h.error(" Excel  CSV ");return}try{const{headers:M,rows:N}=await CU(R);let V=0,W=1;M.forEach((A,F)=>{const I=String(A||"").toLowerCase();(I.includes("")||I.includes("name"))&&(V=F),(I.includes("")||I.includes("")||I.includes(""))&&(W=F)});const j=N.map(A=>{const F=String(A[V]||"").trim(),I=A[W]?String(A[W]).trim():"";return{name:F,number:I}}).filter(A=>A.name);if(j.length===0){h.error("");return}if(c)c(j),h.success(`  ${j.length} `);else{const A=j.map(F=>F.name).join(`
`);e(A),h.success(` ${j.length} `)}}catch(M){console.error("Excel :",M),h.error("Excel ")}}},k=ye.useCallback(R=>{R.preventDefault(),x(!0)},[]),y=ye.useCallback(R=>{R.preventDefault(),x(!1)},[]),S=ye.useCallback(R=>{R.preventDefault(),x(!1);const M=R.dataTransfer.files[0];M&&_(M)},[]);return w.jsxs("div",{className:"flex-1 w-full flex flex-col gap-3 p-3 sm:p-4 bg-[#FF9F43] border-3 border-[#2D3436] rounded-lg shadow-[4px_4px_0_#2D3436] transform rotate-[-0.5deg]",children:[w.jsxs("div",{className:"flex items-center justify-between gap-2 sm:gap-3 text-white font-black text-base sm:text-xl mb-1",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{className:"text-2xl",children:""}),"1. "]}),w.jsxs("button",{onClick:()=>{var R;return(R=d.current)==null?void 0:R.click()},className:"btn-pop bg-white text-[#1DD1A1] px-3 sm:px-4 py-2 text-sm sm:text-base font-black flex items-center gap-2 shadow-[3px_3px_0_#2D3436] hover:shadow-[4px_4px_0_#2D3436] hover:-translate-y-0.5 transition-all",title:" Excel ",children:[w.jsx(zm,{size:18,className:"sm:w-5 sm:h-5"}),w.jsx("span",{className:"hidden xs:inline",children:"Excel"}),w.jsx("span",{children:""})]}),w.jsx("input",{ref:d,type:"file",accept:".xlsx,.xls,.csv",onChange:R=>_(R.target.files[0]),className:"hidden"})]}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1",children:[w.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[w.jsxs("div",{onDragOver:k,onDragLeave:y,onDrop:S,className:`flex-1 relative ${g?"ring-4 ring-[#54A0FF] ring-offset-2":""}`,children:[w.jsx("textarea",{className:"w-full h-full min-h-[100px] sm:min-h-[120px] p-3 sm:p-4 border-3 border-[#2D3436] rounded-lg outline-none text-sm sm:text-base resize-none font-medium placeholder:text-[#9CA3AF] placeholder:leading-relaxed text-[#2D3436] leading-relaxed bg-white shadow-[inset_2px_2px_4px_rgba(0,0,0,0.1)]",placeholder:` 









Excel 
 Excel `,value:t,onChange:R=>e(R.target.value),disabled:u}),g&&w.jsxs("div",{className:"absolute inset-0 bg-[#54A0FF]/90 border-3 border-dashed border-white rounded-lg flex flex-col items-center justify-center text-white",children:[w.jsx(hC,{size:32,className:"mb-2"}),w.jsx("span",{className:"font-bold",children:" Excel"})]})]}),w.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 bg-white p-2 sm:p-3 border-2 border-[#2D3436] rounded-lg",children:[w.jsxs("span",{className:"text-[#2D3436] font-bold text-xs sm:text-sm flex items-center gap-1",children:[w.jsx(ZA,{size:14})," "]}),w.jsx("input",{type:"number",min:"1",max:"100",value:r,onChange:R=>n(Number(R.target.value)),className:"w-14 sm:w-16 text-center border-2 border-[#2D3436] text-[#2D3436] font-bold text-xs sm:text-sm py-1.5 outline-none rounded"}),w.jsx("span",{className:"text-[#2D3436] text-xs sm:text-sm font-bold",children:""}),w.jsx("button",{onClick:i,className:"btn-pop ml-auto bg-[#FECA57] text-[#2D3436] px-3 py-1 text-xs sm:text-sm",children:" "})]})]}),w.jsxs("div",{className:"flex flex-row sm:flex-col gap-2 sm:gap-3 sm:w-24",children:[w.jsxs("button",{onClick:s,disabled:u,className:"flex-1 btn-pop bg-[#1DD1A1] text-white font-bold px-3 sm:px-2 py-3 sm:py-4 text-sm sm:text-base flex flex-row sm:flex-col items-center justify-center gap-2 disabled:opacity-50",children:[w.jsx(Bw,{size:20}),w.jsx("span",{children:""})]}),w.jsxs("button",{onClick:o,disabled:u,className:"flex-1 btn-pop bg-white text-[#FF6B6B] font-bold px-3 sm:px-2 py-3 sm:py-4 text-sm sm:text-base flex flex-row sm:flex-col items-center justify-center gap-2 disabled:opacity-50",children:[w.jsx(Og,{size:18}),w.jsx("span",{children:""})]})]})]})]})},RU=({students:t,selectedIds:e,isGenerating:r,extraSettings:n,setExtraSettings:s,onGenerateSelected:i,onGenerateAll:o,onDownload:c,onDeleteSelected:u,onResetList:h,isViewingMode:d=!1})=>w.jsxs("div",{className:"flex-1 w-full flex flex-col gap-3 sm:gap-4 p-3 sm:p-4 bg-[#54A0FF] border-3 border-[#2D3436] rounded-lg shadow-[4px_4px_0_#2D3436] transform rotate-[0.5deg]",children:[w.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 text-white font-black text-base sm:text-xl",children:[w.jsx("span",{className:"text-2xl",children:""}),"2. AI "]}),w.jsxs("div",{className:"bg-white/90 border-2 border-[#2D3436] rounded-lg p-2 sm:p-3 flex flex-col gap-2 sm:gap-3",children:[w.jsx("div",{className:"flex items-center justify-between text-xs sm:text-sm font-bold text-[#2D3436] border-b-2 border-dashed border-[#E8DCC8] pb-2",children:w.jsx("span",{className:"flex items-center gap-1",children:" "})}),w.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[w.jsx("div",{className:"flex bg-[#FFF9E6] border-2 border-[#2D3436] rounded-lg overflow-hidden",children:[{val:"normal",label:"",emoji:""},{val:"casual",label:"",emoji:""},{val:"formal",label:"",emoji:""}].map(g=>w.jsxs("button",{onClick:()=>s(x=>({...x,tone:g.val})),className:`px-2 sm:px-3 py-1.5 text-xs sm:text-sm font-bold transition-colors 
                  ${n.tone===g.val?"bg-[#FF6B9D] text-white":"text-[#2D3436] hover:bg-[#FECA57]"}`,children:[w.jsx("span",{className:"hidden sm:inline",children:g.emoji})," ",g.label]},g.val))}),w.jsxs("div",{className:"flex items-center gap-2 bg-[#FFF9E6] border-2 border-[#2D3436] rounded-lg px-2 sm:px-3 py-1.5 ml-auto",children:[w.jsx("span",{className:"text-xs sm:text-sm font-bold text-[#2D3436]",children:" "}),w.jsx("input",{type:"number",min:"20",max:"500",step:"10",value:n.wordCount,onChange:g=>s(x=>({...x,wordCount:Number(g.target.value)})),className:"w-12 text-xs sm:text-sm font-bold text-[#2D3436] text-center outline-none bg-white border-2 border-[#2D3436] rounded"})]})]})]}),!d&&w.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[w.jsxs("button",{onClick:i,disabled:e.size===0||r,className:`flex-1 btn-pop py-3 sm:py-4 text-sm sm:text-base font-black flex items-center justify-center gap-2 
            ${e.size>0&&!r?"bg-white text-[#2D3436]":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-60"}`,children:[w.jsx(uC,{size:18}),r?"...":` (${e.size})`]}),w.jsxs("button",{onClick:o,disabled:t.length===0||r,className:`flex-1 btn-pop py-3 sm:py-4 text-sm sm:text-base font-black flex items-center justify-center gap-2
            ${t.length>0&&!r?"bg-[#FECA57] text-[#2D3436]":"bg-gray-200 text-gray-400 cursor-not-allowed opacity-60"}`,children:[w.jsx("span",{className:"text-xl",children:""}),r?"AI ...":""]})]}),d&&w.jsx("div",{className:"bg-white/80 border-2 border-dashed border-[#2D3436]/30 rounded-lg p-3 text-center",children:w.jsx("span",{className:"text-sm font-bold text-[#636E72]",children:"  - "})}),w.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs sm:text-sm pt-2 border-t-2 border-dashed border-white/50",children:[w.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[w.jsxs("button",{onClick:()=>c("txt"),disabled:t.length===0,className:"btn-pop bg-white text-[#2D3436] px-2 sm:px-3 py-1 flex items-center gap-1 disabled:opacity-50",children:[w.jsx(jm,{size:14})," TXT"]}),w.jsxs("button",{onClick:()=>c("csv"),disabled:t.length===0,className:"btn-pop bg-white text-[#2D3436] px-2 sm:px-3 py-1 flex items-center gap-1 disabled:opacity-50",children:[w.jsx(jm,{size:14})," CSV"]})]}),!d&&w.jsxs("div",{className:"flex gap-2",children:[e.size>0&&w.jsxs("button",{onClick:u,disabled:r,className:"btn-pop bg-[#FF6B6B] text-white px-2 sm:px-3 py-1 flex items-center gap-1 text-xs sm:text-sm disabled:opacity-50",children:[w.jsx(Lg,{size:12}),"  (",e.size,")"]}),w.jsx("button",{onClick:h,disabled:r||t.length===0,className:"text-white/80 hover:text-white font-bold transition-colors disabled:opacity-50",children:" "})]})]})]}),NU=({globalStyles:t,onOpenStyleModal:e,isGenerating:r})=>{const n={qualitative:"#FF6B9D",emotional:"#FF9F43",friendly:"#FECA57",humorous:"#1DD1A1",internal:"#54A0FF",philosophical:"#A29BFE",practical:"#FF6B6B",resonance:"#FF6B9D",blessing:"#FF9F43",scenario:"#FECA57",milestone:"#1DD1A1",journey:"#54A0FF"};return w.jsxs("div",{className:"mb-4 sm:mb-6 bg-[#FFFDF5] border-3 border-[#2D3436] rounded-lg p-3 sm:p-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 shadow-[4px_4px_0_#2D3436]",children:[w.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-[#2D3436] text-sm sm:text-base font-black",children:[w.jsx("span",{className:"text-xl",children:""}),w.jsx("span",{children:""}),w.jsx("div",{className:"flex gap-2 flex-wrap",children:t.length>0?t.map(s=>{var i;return w.jsx("span",{className:"px-3 py-1 border-2 border-[#2D3436] rounded-full text-xs sm:text-sm font-bold text-white shadow-[2px_2px_0_#2D3436]",style:{backgroundColor:n[s]||"#A29BFE"},children:(i=Lw.find(o=>o.id===s))==null?void 0:i.name},s)}):w.jsx("span",{className:"text-[#636E72] font-medium text-xs sm:text-sm bg-[#E8DCC8] px-3 py-1 rounded-full",children:" (: )"})})]}),w.jsxs("button",{onClick:e,disabled:r,className:"btn-pop w-full sm:w-auto bg-[#A29BFE] text-white px-4 sm:px-6 py-2 text-xs sm:text-sm font-bold flex items-center justify-center gap-2 disabled:opacity-50",children:[w.jsx(aC,{size:14})," "]})]})},sd=({text:t,highlight:e,className:r=""})=>{if(!e||!e.trim()||!t)return w.jsx("span",{className:r,children:t});const n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=new RegExp(`(${n})`,"gi"),i=t.split(s);return w.jsx("span",{className:r,children:i.map((o,c)=>o.toLowerCase()===e.toLowerCase()?w.jsx("mark",{className:"bg-[#FECA57] text-[#2D3436] px-0.5 rounded font-bold",children:o},c):o)})},w4=({comment:t,studentName:e,onAdjust:r,isAdjusting:n,disabled:s=!1})=>{const[i,o]=ye.useState(!1),[c,u]=ye.useState(!1),[h,d]=ye.useState(3),g=async()=>{if(t)try{await navigator.clipboard.writeText(t),o(!0),setTimeout(()=>o(!1),2e3)}catch(k){console.error(":",k);const y=document.createElement("textarea");y.value=t,document.body.appendChild(y),y.select(),document.execCommand("copy"),document.body.removeChild(y),o(!0),setTimeout(()=>o(!1),2e3)}},x=[{type:"shorter",label:"",icon:iC,color:"bg-[#54A0FF]"},{type:"detailed",label:"",icon:rC,color:"bg-[#A29BFE]"},{type:"rephrase",label:"",icon:Og,color:"bg-[#FECA57]"}],_=["","","","",""];return!t||t.includes("")||t.includes("")?null:w.jsxs("div",{className:"mt-2 pt-2 border-t-2 border-dashed border-[#E8DCC8]",children:[w.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[x.map(({type:k,label:y,icon:S,color:R})=>w.jsxs("button",{onClick:()=>r(k,h),disabled:s||n,className:`flex items-center gap-1 px-2.5 py-1.5 text-xs font-bold text-white rounded-lg border-2 border-[#2D3436] shadow-[2px_2px_0_#2D3436] transition-all active:shadow-none active:translate-x-0.5 active:translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed ${R}`,children:[n?w.jsx(id,{size:12,className:"animate-spin"}):w.jsx(S,{size:12}),w.jsx("span",{className:"hidden sm:inline",children:y})]},k)),w.jsxs("button",{onClick:()=>u(!c),disabled:s||n,className:`flex items-center gap-1 px-2.5 py-1.5 text-xs font-bold rounded-lg border-2 border-[#2D3436] shadow-[2px_2px_0_#2D3436] transition-all active:shadow-none active:translate-x-0.5 active:translate-y-0.5 disabled:opacity-50 ${c?"bg-[#1DD1A1] text-white":"bg-white text-[#2D3436]"}`,children:[w.jsx(lC,{size:12}),w.jsx("span",{className:"hidden sm:inline",children:""})]}),w.jsx("button",{onClick:g,disabled:s,className:`ml-auto flex items-center gap-1 px-2.5 py-1.5 text-xs font-bold rounded-lg border-2 border-[#2D3436] shadow-[2px_2px_0_#2D3436] transition-all active:shadow-none active:translate-x-0.5 active:translate-y-0.5 disabled:opacity-50 ${i?"bg-[#1DD1A1] text-white":"bg-white text-[#2D3436] hover:bg-[#FF6B9D] hover:text-white"}`,children:i?w.jsxs(w.Fragment,{children:[w.jsx(Ju,{size:12}),w.jsx("span",{children:""})]}):w.jsxs(w.Fragment,{children:[w.jsx(Um,{size:12}),w.jsx("span",{children:""})]})})]}),c&&w.jsxs("div",{className:"mt-3 p-3 bg-white border-2 border-[#E8DCC8] rounded-lg",children:[w.jsxs("div",{className:"flex items-center justify-between text-xs font-bold text-[#636E72] mb-2",children:[w.jsx("span",{children:" "}),w.jsx("span",{className:"text-[#2D3436]",children:_[h-1]}),w.jsx("span",{children:" "})]}),w.jsx("input",{type:"range",min:"1",max:"5",value:h,onChange:k=>d(Number(k.target.value)),className:"w-full h-2 bg-gradient-to-r from-[#54A0FF] via-[#FECA57] to-[#FF6B9D] rounded-lg appearance-none cursor-pointer",style:{WebkitAppearance:"none"}}),w.jsx("p",{className:"text-xs text-[#636E72] mt-2 text-center",children:""})]})]})},bU=({student:t,isSelected:e,isFocused:r,isGenerating:n,isGeneratingSingle:s,onToggleSelection:i,onFocus:o,onOpenSidebar:c,onRemoveTag:u,onUpdateStudent:h,onDeleteStudent:d,onGenerateSingle:g,onSaveTemplate:x,onOpenHistory:_,searchQuery:k="",onAdjustComment:y,adjustingStudentId:S})=>{const R=s===t.id,M=S===t.id,N=V=>V<50?"text-[#FF6B6B]":V>120?"text-[#FF9F43]":"text-[#1DD1A1]";return w.jsxs("div",{className:`bg-[#FFFDF5] border-3 border-[#2D3436] rounded-xl overflow-hidden shadow-[4px_4px_0_#2D3436] transition-all
        ${e?"ring-3 ring-[#FF6B9D]":""}
        ${r?"ring-3 ring-[#54A0FF]":""}
        ${R?"ring-3 ring-[#FECA57] animate-pulse":""}`,children:[w.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5 bg-[#FECA57] border-b-2 border-[#2D3436]",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("button",{onClick:()=>i(t.id),disabled:n||R,className:`w-5 h-5 border-2 border-[#2D3436] rounded flex items-center justify-center flex-shrink-0
              ${e?"bg-[#FF6B9D] text-white":"bg-white"}`,children:e&&w.jsx("span",{className:"text-xs font-bold",children:""})}),w.jsxs("span",{className:"font-black text-[#2D3436] text-sm truncate",children:[" ",w.jsx(sd,{text:t.name,highlight:k})]})]}),w.jsxs("div",{className:"flex items-center gap-1.5",children:[w.jsx("button",{onClick:()=>g(t.id),disabled:n||R,className:"btn-pop px-3 py-1.5 bg-[#1DD1A1] text-white text-xs font-bold flex items-center gap-1 disabled:opacity-50 min-w-[70px] justify-center",children:R?w.jsx(w.Fragment,{children:w.jsx(id,{size:14,className:"animate-spin"})}):w.jsx(w.Fragment,{children:w.jsx(cC,{size:14})})}),w.jsx("button",{onClick:()=>d(t.id),disabled:n||R,className:"text-[#2D3436]/50 hover:text-[#FF6B6B] transition-colors disabled:opacity-30 p-1.5",children:w.jsx(Lg,{size:16})})]})]}),w.jsxs("div",{className:"px-3 py-2.5 border-b-2 border-dashed border-[#E8DCC8]",children:[w.jsx("div",{className:"text-xs font-bold text-[#636E72] mb-1.5",children:" "}),w.jsx("div",{onClick:()=>{o(t.id),c()},className:`p-2 border-2 border-dashed bg-white min-h-[40px] flex flex-wrap gap-1.5 cursor-pointer transition-colors rounded-lg items-center
            ${r?"border-[#54A0FF] bg-[#54A0FF]/10":"border-[#E8DCC8]"}`,children:t.selectedTags.length>0?t.selectedTags.map((V,W)=>w.jsxs("span",{className:"tag-handwrite text-xs",children:[w.jsx(sd,{text:V,highlight:k}),w.jsx("button",{onClick:j=>{j.stopPropagation(),u(t.id,V)},className:"hover:text-[#FF6B6B] ml-1",children:""})]},W)):w.jsx("span",{className:"text-[#636E72]/50 text-xs",children:" ..."})}),w.jsx("input",{type:"text",value:t.manualTraits,onChange:V=>h(t.id,"manualTraits",V.target.value),placeholder:" ...",disabled:n||R,className:"w-full mt-2 p-2 text-sm font-medium outline-none border-2 border-[#E8DCC8] focus:border-[#FF9F43] rounded-lg bg-white text-[#2D3436] placeholder:text-[#636E72]/40"})]}),w.jsxs("div",{className:"px-3 py-2.5 bg-[#FFF9E6]",children:[w.jsxs("div",{className:"text-xs font-bold text-[#636E72] mb-1.5 flex items-center justify-between",children:[w.jsx("span",{className:"flex items-center gap-1",children:" AI "}),w.jsxs("div",{className:"flex items-center gap-3",children:[_&&w.jsxs("button",{onClick:()=>_(t),className:"flex items-center gap-1 text-[#54A0FF] active:text-[#2D3436] transition-colors",title:"",children:[w.jsx(Dg,{size:14}),w.jsx("span",{children:""})]}),t.comment&&!t.comment.includes("")&&!t.comment.includes("")&&w.jsxs("button",{onClick:()=>x(t),className:"flex items-center gap-1 text-[#FF6B9D] active:text-[#FF6B6B] transition-colors",title:"",children:[w.jsx(Pg,{size:14}),w.jsx("span",{children:""})]})]})]}),w.jsx("textarea",{value:t.comment,onChange:V=>h(t.id,"comment",V.target.value),placeholder:" AI ...",disabled:R,className:`w-full text-sm p-3 border-2 border-[#E8DCC8] focus:border-[#1DD1A1] outline-none resize-y min-h-[120px] leading-relaxed font-medium text-[#2D3436] rounded-lg
            ${R?"bg-[#FECA57]/30 animate-pulse":"bg-white"}`}),t.comment&&w.jsxs("div",{className:`text-right text-xs mt-1 font-bold ${N(t.comment.length)}`,children:[t.comment.length," "]}),y&&w.jsx(w4,{comment:t.comment,studentName:t.name,onAdjust:(V,W)=>y(t.id,V,W),isAdjusting:M,disabled:n||R})]})]})},DU=(t,e)=>!(t.student.id!==e.student.id||t.student.name!==e.student.name||t.student.comment!==e.student.comment||t.student.manualTraits!==e.student.manualTraits||t.student.selectedTags.length!==e.student.selectedTags.length||t.student.selectedTags.some((r,n)=>r!==e.student.selectedTags[n])||t.isSelected!==e.isSelected||t.isFocused!==e.isFocused||t.isGenerating!==e.isGenerating||t.isGeneratingSingle!==e.isGeneratingSingle),PU=Sf.memo(bU,DU),OU=({students:t,selectedIds:e,focusedStudentId:r,isGenerating:n,isGeneratingSingle:s,onToggleSelection:i,onToggleAllSelection:o,onFocusStudent:c,onOpenSidebar:u,onRemoveTag:h,onUpdateStudent:d,onDeleteStudent:g,onGenerateSingle:x,onSaveTemplate:_,onOpenHistory:k,searchQuery:y="",onAdjustComment:S,adjustingStudentId:R})=>{const M=typeof window<"u"&&window.innerWidth<768,N=V=>V<50?"text-[#FF6B6B]":V>120?"text-[#FF9F43]":"text-[#1DD1A1]";return M?w.jsx("div",{className:"space-y-4",children:t.length===0?w.jsxs("div",{className:"p-10 text-center font-bold text-lg bg-[#FFFDF5] border-3 border-[#2D3436] rounded-lg shadow-[4px_4px_0_#2D3436]",children:[w.jsx("span",{className:"text-4xl block mb-3",children:""}),w.jsx("span",{className:"text-[#636E72]",children:""})]}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"flex items-center justify-between bg-[#A29BFE] text-white border-3 border-[#2D3436] p-3 rounded-lg shadow-[3px_3px_0_#2D3436]",children:w.jsxs("button",{onClick:o,className:"flex items-center gap-2 font-bold text-sm",disabled:n,children:[w.jsx("span",{className:`w-5 h-5 border-2 border-white rounded flex items-center justify-center ${e.size===t.length&&t.length>0?"bg-white text-[#A29BFE]":""}`,children:e.size===t.length&&t.length>0&&w.jsx("span",{className:"text-xs",children:""})})," (",e.size,"/",t.length,")"]})}),t.map(V=>w.jsx(PU,{student:V,isSelected:e.has(V.id),isFocused:r===V.id,isGenerating:n,isGeneratingSingle:s,onToggleSelection:i,onFocus:c,onOpenSidebar:u,onRemoveTag:h,onUpdateStudent:d,onDeleteStudent:g,onGenerateSingle:x,onSaveTemplate:_,onOpenHistory:k,searchQuery:y,onAdjustComment:S,adjustingStudentId:R},V.id))]})}):w.jsx("div",{className:"card-pop overflow-x-auto max-w-full",children:w.jsxs("table",{className:"w-full text-left border-collapse min-w-[850px]",children:[w.jsx("thead",{className:"bg-[#FF6B9D] text-white",children:w.jsxs("tr",{className:"text-base font-black",children:[w.jsx("th",{className:"p-3 lg:p-4 w-10 text-center border-r-2 border-[#2D3436]/20",children:w.jsx("button",{onClick:o,className:"w-6 h-6 border-2 border-white rounded flex items-center justify-center mx-auto bg-white/20 hover:bg-white/40 transition",disabled:n,children:e.size===t.length&&t.length>0&&w.jsx("span",{className:"text-sm",children:""})})}),w.jsx("th",{className:"p-3 lg:p-4 w-28 lg:w-32 border-r-2 border-[#2D3436]/20",children:" "}),w.jsx("th",{className:"p-3 lg:p-4 border-r-2 border-[#2D3436]/20 w-1/5",children:" "}),w.jsx("th",{className:"p-3 lg:p-4 border-r-2 border-[#2D3436]/20",children:" AI "}),w.jsx("th",{className:"p-3 lg:p-4 w-16 text-center",children:""})]})}),w.jsxs("tbody",{className:"bg-[#FFFDF5]",children:[t.length===0&&w.jsx("tr",{children:w.jsxs("td",{colSpan:"5",className:"p-16 lg:p-20 text-center font-bold text-xl text-[#636E72]",children:[w.jsx("span",{className:"text-5xl block mb-4",children:""}),""]})}),t.map(V=>{const W=s===V.id;return w.jsxs("tr",{className:`border-t-2 border-dashed border-[#E8DCC8] hover:bg-[#FECA57]/20 transition-colors ${e.has(V.id)?"bg-[#FF6B9D]/10":""} ${W?"bg-[#FECA57]/30":""}`,children:[w.jsx("td",{className:"p-4 lg:p-5 text-center align-top pt-6 lg:pt-8 border-r-2 border-dashed border-[#E8DCC8]",children:w.jsx("button",{onClick:()=>i(V.id),disabled:n||W,className:`w-6 h-6 border-2 border-[#2D3436] rounded flex items-center justify-center mx-auto transition ${e.has(V.id)?"bg-[#FF6B9D] text-white":"bg-white hover:bg-[#FECA57]"}`,children:e.has(V.id)&&w.jsx("span",{className:"text-sm font-bold",children:""})})}),w.jsxs("td",{className:"p-4 lg:p-5 align-top pt-6 lg:pt-8 border-r-2 border-dashed border-[#E8DCC8]",children:[w.jsx("div",{className:"font-black text-[#2D3436] text-base lg:text-lg mb-2",children:w.jsx(sd,{text:V.name,highlight:y})}),w.jsx("button",{onClick:()=>x(V.id),disabled:n||W,className:"btn-pop px-4 py-2 bg-[#1DD1A1] text-white text-sm font-black flex items-center gap-2 disabled:opacity-50 w-full justify-center rounded-lg shadow-[2px_2px_0_#2D3436]",children:W?w.jsxs(w.Fragment,{children:[w.jsx(id,{size:16,className:"animate-spin"}),w.jsx("span",{children:"..."})]}):w.jsxs(w.Fragment,{children:[w.jsx("span",{className:"text-lg",children:""}),w.jsx("span",{children:""})]})})]}),w.jsxs("td",{className:"p-4 lg:p-5 align-top border-r-2 border-dashed border-[#E8DCC8]",children:[w.jsx("div",{onClick:()=>{c(V.id),u()},className:`p-3 border-2 border-dashed bg-white min-h-[80px] lg:min-h-[100px] flex flex-col gap-3 cursor-pointer transition-colors rounded-lg ${r===V.id?"border-[#54A0FF] bg-[#54A0FF]/10":"border-[#E8DCC8] hover:border-[#FF9F43]"}`,children:V.selectedTags.length>0?w.jsx("div",{className:"flex flex-wrap gap-2",children:V.selectedTags.map((j,A)=>w.jsxs("span",{className:"tag-handwrite text-sm",children:[w.jsx(sd,{text:j,highlight:y}),w.jsx("button",{onClick:F=>{F.stopPropagation(),h(V.id,j)},className:"hover:text-[#FF6B6B] ml-1",children:""})]},A))}):w.jsx("span",{className:"text-[#636E72]/50 text-sm",children:" ..."})}),w.jsx("input",{type:"text",value:V.manualTraits,onChange:j=>d(V.id,"manualTraits",j.target.value),placeholder:" ...",disabled:n||W,className:"w-full mt-3 p-3 text-sm lg:text-base font-medium outline-none border-2 border-[#E8DCC8] focus:border-[#FF9F43] rounded-lg bg-white text-[#2D3436] placeholder:text-[#636E72]/40 transition-all"})]}),w.jsxs("td",{className:"p-4 lg:p-5 align-top border-r-2 border-dashed border-[#E8DCC8]",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsx("span",{className:"text-xs font-bold text-[#636E72]",children:""}),w.jsxs("div",{className:"flex items-center gap-2",children:[k&&w.jsxs("button",{onClick:()=>k(V),className:"flex items-center gap-1 text-xs text-[#54A0FF] hover:text-[#2D3436] transition-colors font-bold",title:"",children:[w.jsx(Dg,{size:12})," "]}),V.comment&&!V.comment.includes("")&&!V.comment.includes("")&&w.jsxs("button",{onClick:()=>_(V),className:"flex items-center gap-1 text-xs text-[#FF6B9D] hover:text-[#FF6B6B] transition-colors font-bold",title:"",children:[w.jsx(Pg,{size:12})," "]})]})]}),w.jsx("textarea",{value:V.comment,onChange:j=>d(V.id,"comment",j.target.value),placeholder:" AI ...",disabled:W,className:`w-full text-sm lg:text-base p-3 lg:p-4 border-2 border-[#E8DCC8] focus:border-[#1DD1A1] outline-none resize-y min-h-[180px] lg:min-h-[200px] leading-relaxed font-medium text-[#2D3436] rounded-lg transition-all ${W?"bg-[#FECA57]/30 animate-pulse":"bg-white"}`}),V.comment&&w.jsxs("div",{className:`text-right text-xs mt-1 font-bold ${N(V.comment.length)}`,children:[V.comment.length," "]}),S&&w.jsx(w4,{comment:V.comment,studentName:V.name,onAdjust:(j,A)=>S(V.id,j,A),isAdjusting:R===V.id,disabled:n||W})]}),w.jsx("td",{className:"p-4 lg:p-5 text-center align-top pt-6 lg:pt-8",children:w.jsx("button",{onClick:()=>g(V.id),disabled:n||W,className:"text-[#636E72]/50 hover:text-[#FF6B6B] transition-colors disabled:opacity-30",children:w.jsx(Lg,{size:18})})})]},V.id)})]})]})})},LU=Sf.memo(OU),MU=({isOpen:t,onClose:e,selectedIds:r,expandedCategories:n,onToggleCategory:s,onIdiomClick:i,userId:o})=>{const[c,u]=ye.useState(""),h={" ()":"#1DD1A1"," ()":"#FF6B6B"," ()":"#54A0FF"," ()":"#FECA57"," ()":"#FF9F43"," ()":"#A29BFE"," ()":"#FF6B9D"," ()":"#1DD1A1"," ()":"#FECA57"," ()":"#FF6B6B"," ()":"#54A0FF"," ()":"#A29BFE"," ()":"#FF9F43",:"#FF6B9D",:"#636E72"},d=S=>{try{const R=o?`idiom_usage_${o}`:"idiom_usage";return JSON.parse(localStorage.getItem(R)||"{}")[S]||0}catch{return 0}},g=S=>{try{const R=o?`idiom_usage_${o}`:"idiom_usage",M=JSON.parse(localStorage.getItem(R)||"{}");M[S]=(M[S]||0)+1,localStorage.setItem(R,JSON.stringify(M))}catch(R){console.error(":",R)}},x=S=>{g(S),i(S)},_=ye.useMemo(()=>{if(!c.trim())return um;const S=c.trim().toLowerCase(),R={};return Object.entries(um).forEach(([M,N])=>{const V=N.filter(W=>W.toLowerCase().includes(S));V.length>0&&(R[M]=V)}),R},[c]),k=ye.useMemo(()=>Object.values(um).flat().map(M=>({idiom:M,count:d(M)})).filter(M=>M.count>0).sort((M,N)=>N.count-M.count).slice(0,12).map(M=>M.idiom),[t]),y=Object.values(_).reduce((S,R)=>S+R.length,0);return w.jsxs(w.Fragment,{children:[t&&w.jsx("div",{className:"fixed inset-0 bg-black/30 z-40 backdrop-blur-[2px] transition-opacity",onClick:e}),w.jsxs("div",{className:`fixed top-0 right-0 bottom-0 bg-[#FFF9E6] border-l-4 border-[#2D3436] shadow-[-8px_0_0_#2D3436] transform transition-transform duration-300 ease-in-out flex flex-col z-50
          ${t?"translate-x-0":"translate-x-full"}
          w-full sm:w-[80%] md:w-[50%] lg:w-[35%] xl:w-[30%] max-w-[400px]`,children:[w.jsxs("div",{className:"p-3 sm:p-5 bg-[#1DD1A1] border-b-3 border-[#2D3436] flex items-center justify-between shrink-0",children:[w.jsxs("h2",{className:"font-black text-white flex items-center gap-2 sm:gap-3 text-base sm:text-xl",children:[w.jsx("span",{className:"text-2xl",children:""})," "]}),w.jsx("button",{onClick:e,className:"btn-pop p-2 bg-white text-[#2D3436]",children:w.jsx(ol,{size:20})})]}),w.jsxs("div",{className:"p-3 sm:p-4 bg-white border-b-2 border-dashed border-[#E8DCC8]",children:[w.jsxs("div",{className:"relative",children:[w.jsx(Uw,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-[#636E72]"}),w.jsx("input",{type:"text",value:c,onChange:S=>u(S.target.value),placeholder:" ...",className:"w-full pl-10 pr-4 py-2.5 border-2 border-[#2D3436] rounded-lg text-sm font-medium outline-none focus:border-[#1DD1A1] bg-[#FFFDF5]"}),c&&w.jsx("button",{onClick:()=>u(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#636E72] hover:text-[#FF6B6B]",children:""})]}),c&&w.jsxs("div",{className:"mt-2 text-xs text-[#636E72] font-bold",children:[" ",y," "]})]}),w.jsxs("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 space-y-3 sm:space-y-4 mobile-scroll-hide",children:[w.jsxs("div",{className:"text-sm font-bold text-[#2D3436] bg-[#FECA57] px-3 py-2 border-2 border-[#2D3436] rounded-lg inline-flex items-center gap-2 shadow-[2px_2px_0_#2D3436]",children:[w.jsx("span",{children:""})," "]}),r.size>0&&w.jsxs("div",{className:"bg-[#54A0FF] text-white p-3 sm:p-4 border-2 border-[#2D3436] text-xs sm:text-sm font-bold rounded-lg shadow-[3px_3px_0_#2D3436]",children:[w.jsx("span",{className:"block mb-1 text-white/80",children:" "})," ",w.jsx("strong",{children:r.size})," "]}),k.length>0&&!c&&w.jsxs("div",{className:"border-2 border-[#2D3436] rounded-lg overflow-hidden shadow-[3px_3px_0_#2D3436]",children:[w.jsxs("div",{className:"w-full flex items-center justify-between p-3 sm:p-4 text-left text-sm sm:text-base font-black text-white bg-[#FF6B9D]",children:[w.jsx("span",{children:" "}),w.jsx("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded-full",children:k.length})]}),w.jsx("div",{className:"p-3 sm:p-4 bg-[#FFFDF5] flex flex-wrap gap-1.5 sm:gap-2 border-t-2 border-dashed border-[#E8DCC8]",children:k.map((S,R)=>w.jsx("button",{onClick:()=>x(S),className:"px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm bg-[#FF6B9D] border-2 border-[#2D3436] text-white font-bold rounded-lg hover:bg-[#FF5291] transition-all shadow-[2px_2px_0_#2D3436] hover:-translate-y-0.5",children:S},`popular-${S}-${R}`))})]}),Object.entries(_).map(([S,R])=>{const M=h[S]||"#A29BFE";return w.jsxs("div",{className:"border-2 border-[#2D3436] rounded-lg overflow-hidden shadow-[3px_3px_0_#2D3436]",children:[w.jsxs("button",{onClick:()=>s(S),className:"w-full flex items-center justify-between p-3 sm:p-4 text-left text-sm sm:text-base font-black text-white transition-colors",style:{backgroundColor:M},children:[w.jsx("span",{children:S}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded-full",children:R.length}),w.jsx("span",{className:"bg-white/20 rounded-full w-6 h-6 flex items-center justify-center",children:n[S]?"":""})]})]}),(n[S]||c)&&w.jsx("div",{className:"p-3 sm:p-4 bg-[#FFFDF5] flex flex-wrap gap-1.5 sm:gap-2 border-t-2 border-dashed border-[#E8DCC8]",children:R.map((N,V)=>w.jsx("button",{onClick:()=>x(N),className:"px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm bg-white border-2 border-[#2D3436] text-[#2D3436] font-bold rounded-lg hover:text-white transition-all shadow-[2px_2px_0_#2D3436] hover:-translate-y-0.5 hover:shadow-[3px_3px_0_#2D3436] active:translate-y-0 active:shadow-[1px_1px_0_#2D3436]",style:{"--hover-bg":M},onMouseEnter:W=>W.target.style.backgroundColor=M,onMouseLeave:W=>W.target.style.backgroundColor="white",children:c&&N.includes(c)?w.jsx("span",{dangerouslySetInnerHTML:{__html:N.replace(new RegExp(`(${c})`,"gi"),'<mark class="bg-[#FECA57] px-0.5 rounded">$1</mark>')}}):N},`${N}-${V}`))})]},S)}),c&&Object.keys(_).length===0&&w.jsxs("div",{className:"text-center py-10",children:[w.jsx("div",{className:"text-4xl mb-3",children:""}),w.jsxs("p",{className:"text-[#636E72] font-bold",children:["",c,""]})]})]})]})]})},VU=()=>w.jsx("div",{className:"fixed inset-0 z-[90] flex items-center justify-center bg-[#FFF9E6]",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-6xl mb-4 animate-bounce",children:""}),w.jsx("h2",{className:"text-2xl font-black text-[#2D3436] mb-2",children:"..."}),w.jsx("p",{className:"text-[#636E72] font-medium",children:""}),w.jsxs("div",{className:"mt-4 flex justify-center gap-1",children:[w.jsx("span",{className:"w-3 h-3 bg-[#FF6B9D] rounded-full animate-bounce",style:{animationDelay:"0ms"}}),w.jsx("span",{className:"w-3 h-3 bg-[#FECA57] rounded-full animate-bounce",style:{animationDelay:"150ms"}}),w.jsx("span",{className:"w-3 h-3 bg-[#1DD1A1] rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})}),BU=()=>{const[t,e]=ye.useState(null),[r,n]=ye.useState(!1);ye.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches)return;const c=localStorage.getItem("pwa_install_dismissed");if(c&&Date.now()-parseInt(c)<1e3*60*60*24*7)return;const u=h=>{h.preventDefault(),e(h),n(!0)};return window.addEventListener("beforeinstallprompt",u),()=>window.removeEventListener("beforeinstallprompt",u)},[]);const s=async()=>{if(!t)return;t.prompt();const{outcome:o}=await t.userChoice;o==="accepted"&&n(!1),e(null)},i=()=>{n(!1),localStorage.setItem("pwa_install_dismissed",Date.now().toString())};return r?w.jsx("div",{className:"fixed bottom-4 left-4 right-4 sm:left-auto sm:right-4 sm:max-w-sm z-[100] animate-in",children:w.jsxs("div",{className:"bg-[#2D3436] text-white p-4 rounded-lg border-3 border-[#FECA57] shadow-[4px_4px_0_#FECA57] flex items-center gap-3",children:[w.jsx("div",{className:"text-3xl",children:""}),w.jsxs("div",{className:"flex-1",children:[w.jsx("h3",{className:"font-black text-sm",children:""}),w.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:""})]}),w.jsxs("button",{onClick:s,className:"btn-pop px-3 py-2 bg-[#FECA57] text-[#2D3436] text-xs font-bold flex items-center gap-1",children:[w.jsx(jm,{size:14}),""]}),w.jsx("button",{onClick:i,className:"text-white/50 hover:text-white p-1",children:w.jsx(ol,{size:16})})]})}):null},UU=()=>w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm",children:w.jsxs("div",{className:"bg-[#FFF9E6] border-3 border-[#2D3436] rounded-lg p-6 shadow-lg flex flex-col items-center gap-3",children:[w.jsx(id,{size:32,className:"animate-spin text-[#FF6B9D]"}),w.jsx("span",{className:"font-bold text-[#2D3436]",children:"..."})]})}),Bm="student_search_history",jU=5,zU=({searchQuery:t,setSearchQuery:e,filters:r,setFilters:n,totalCount:s,filteredCount:i})=>{const[o,c]=ye.useState(!1),[u,h]=ye.useState([]),d=ye.useRef(null),g=ye.useRef(null);ye.useEffect(()=>{try{const W=localStorage.getItem(Bm);W&&h(JSON.parse(W))}catch(W){console.error(":",W)}},[]);const x=W=>{W.trim()&&h(j=>{const A=j.filter(I=>I!==W),F=[W,...A].slice(0,jU);try{localStorage.setItem(Bm,JSON.stringify(F))}catch(I){console.error(":",I)}return F})};ye.useEffect(()=>{const W=j=>{g.current&&!g.current.contains(j.target)&&c(!1)};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[]);const _=W=>{const j=W.target.value;e(j)},k=()=>{t.trim()&&x(t.trim()),c(!1)},y=W=>{var j;e(W),c(!1),(j=d.current)==null||j.focus()},S=()=>{var W;e(""),(W=d.current)==null||W.focus()},R=(W,j)=>{W.stopPropagation(),h(A=>{const F=A.filter(I=>I!==j);try{localStorage.setItem(Bm,JSON.stringify(F))}catch(I){console.error(":",I)}return F})},M=W=>{n(j=>({...j,[W]:j[W]===null?!0:j[W]===!0?!1:null}))},N=W=>W===!0?"bg-[#1DD1A1] text-white":W===!1?"bg-[#FF6B6B] text-white":"bg-white text-[#2D3436] hover:bg-[#FECA57]",V=(W,j)=>({hasComment:{true:"",false:"",null:""},hasTag:{true:"",false:"",null:""}})[W][j];return w.jsxs("div",{className:"mb-4 space-y-3",children:[w.jsxs("div",{className:"relative",ref:g,children:[w.jsxs("div",{className:"relative flex items-center",children:[w.jsx(Uw,{size:18,className:"absolute left-3 text-[#636E72]"}),w.jsx("input",{ref:d,type:"text",value:t,onChange:_,onFocus:()=>u.length>0&&c(!0),onBlur:()=>setTimeout(k,200),onKeyDown:W=>W.key==="Enter"&&k(),placeholder:" ...",className:"w-full pl-10 pr-10 py-3 text-sm font-medium border-3 border-[#2D3436] rounded-lg bg-white focus:border-[#54A0FF] focus:ring-2 focus:ring-[#54A0FF]/30 outline-none transition-all shadow-[3px_3px_0_#2D3436]"}),t&&w.jsx("button",{onClick:S,className:"absolute right-3 text-[#636E72] hover:text-[#FF6B6B] transition-colors",children:w.jsx(ol,{size:18})})]}),o&&u.length>0&&w.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border-3 border-[#2D3436] rounded-lg shadow-[4px_4px_0_#2D3436] z-20 overflow-hidden",children:[w.jsxs("div",{className:"px-3 py-2 bg-[#F8F9FA] border-b-2 border-[#E8DCC8] flex items-center gap-2 text-xs font-bold text-[#636E72]",children:[w.jsx(eC,{size:14}),""]}),u.map((W,j)=>w.jsxs("div",{onClick:()=>y(W),className:"px-4 py-2.5 text-sm font-medium text-[#2D3436] hover:bg-[#FECA57]/30 cursor-pointer flex items-center justify-between group transition-colors",children:[w.jsx("span",{children:W}),w.jsx("button",{onClick:A=>R(A,W),className:"opacity-0 group-hover:opacity-100 text-[#636E72] hover:text-[#FF6B6B] transition-all",children:w.jsx(ol,{size:14})})]},j))]})]}),w.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs("span",{className:"text-xs font-bold text-[#636E72] flex items-center gap-1",children:[w.jsx(JA,{size:14}),""]}),w.jsxs("button",{onClick:()=>M("hasComment"),className:`px-3 py-1.5 text-xs font-bold border-2 border-[#2D3436] rounded-lg transition-all flex items-center gap-1 shadow-[2px_2px_0_#2D3436] active:shadow-none active:translate-x-0.5 active:translate-y-0.5 ${N(r.hasComment)}`,children:[w.jsx(sC,{size:12}),V("hasComment",r.hasComment)]}),w.jsxs("button",{onClick:()=>M("hasTag"),className:`px-3 py-1.5 text-xs font-bold border-2 border-[#2D3436] rounded-lg transition-all flex items-center gap-1 shadow-[2px_2px_0_#2D3436] active:shadow-none active:translate-x-0.5 active:translate-y-0.5 ${N(r.hasTag)}`,children:[w.jsx(fC,{size:12}),V("hasTag",r.hasTag)]})]}),(t||r.hasComment!==null||r.hasTag!==null)&&w.jsxs("div",{className:"text-xs font-bold text-[#636E72] bg-[#F8F9FA] px-3 py-1.5 rounded-full border-2 border-[#E8DCC8]",children:[" ",w.jsx("span",{className:"text-[#54A0FF]",children:i})," / ",s," "]})]})]})},HU=ye.lazy(()=>Ca(()=>import("./StyleModal-CVIN7a-g.js"),[])),WU=ye.lazy(()=>Ca(()=>import("./ApiKeyModal-C0FhU_ce.js"),__vite__mapDeps([0,1]))),$U=ye.lazy(()=>Ca(()=>import("./TemplateModal-DI6hI4jM.js"),[])),GU=ye.lazy(()=>Ca(()=>import("./ClassModal-Cky9s5J6.js"),__vite__mapDeps([2,3,4]))),qU=ye.lazy(()=>Ca(()=>import("./HistoryModal-ougFI635.js"),[])),KU=ye.lazy(()=>Ca(()=>import("./AdminPanel-E1oFPAsO.js"),__vite__mapDeps([5,4,6,3,1]))),XU=ye.lazy(()=>Ca(()=>import("./ImportExportModal-BpJiQ2jp.js"),__vite__mapDeps([7,8]))),YU=ye.lazy(()=>Ca(()=>import("./PrintModal-DSgrPF9m.js").then(t=>t.P),__vite__mapDeps([9,4,8]))),QU=ye.lazy(()=>Ca(()=>import("./DashboardModal-DZ8el1uZ.js"),__vite__mapDeps([10,6]))),JU=({currentUser:t,onLogout:e,isAdmin:r})=>{const{toast:n}=zw(),{dialog:s,closeDialog:i,showConfirm:o,showAlert:c}=xC(),[u,h]=ye.useState(!1),{students:d,setStudents:g,selectedIds:x,isLoading:_,generateStudents:k,updateStudent:y,deleteStudent:S,deleteSelected:R,resetStudents:M,toggleSelection:N,toggleAllSelection:V,addTagToStudents:W,removeTag:j,syncComment:A}=wb(t==null?void 0:t.uid),[F,I]=ye.useState(`

`),[U,L]=ye.useState(30),[D,B]=ye.useState(!1),[De,Re]=ye.useState(!1),[Ve,Le]=ye.useState(null),[Ae,ne]=ye.useState({current:0,total:0}),[we,ee]=ye.useState(!1),[O,te]=ye.useState(["qualitative"]),[J,Z]=ye.useState(!1),[oe,_e]=ye.useState(!1),[ve,xe]=ye.useState(H_()),[Te,ut]=ye.useState({tone:"normal",wordCount:80}),[Y,At]=ye.useState(null),[wt,Lt]=ye.useState(null),[xt,je]=ye.useState(!1),[Zt,Mt]=ye.useState(0),[Bt,xr]=ye.useState(!1),[Tn,Sn]=ye.useState(null),[_r,Rr]=ye.useState(""),[qn,as]=ye.useState([]),[or,Zr]=ye.useState(!1),[ot,jt]=ye.useState(null),[Gr,Yt]=ye.useState(!1),[kn,ni]=ye.useState(!1),[Kn,si]=ye.useState(!1),[ws,Vs]=ye.useState(0),[Qe,Xn]=ye.useState(null),[Rt,qr]=ye.useState([]),[An,Bs]=ye.useState(""),[Yn,ba]=ye.useState({hasComment:null,hasTag:null}),ln=ye.useMemo(()=>(Qe?Rt:d).filter(Ie=>{var ze,qe,rt,Nt;if(An.trim()){const Gt=An.toLowerCase(),Us=(ze=Ie.name)==null?void 0:ze.toLowerCase().includes(Gt),bt=(qe=Ie.selectedTags)==null?void 0:qe.some(Ji=>Ji.toLowerCase().includes(Gt)),un=(rt=Ie.comment)==null?void 0:rt.toLowerCase().includes(Gt),fn=(Nt=Ie.manualTraits)==null?void 0:Nt.toLowerCase().includes(Gt);if(!Us&&!bt&&!un&&!fn)return!1}if(Yn.hasComment!==null){const Gt=Ie.comment&&Ie.comment.trim()&&!Ie.comment.includes("");if(Yn.hasComment&&!Gt||!Yn.hasComment&&Gt)return!1}if(Yn.hasTag!==null){const Gt=Ie.selectedTags&&Ie.selectedTags.length>0;if(Yn.hasTag&&!Gt||!Yn.hasTag&&Gt)return!1}return!0}),[d,Rt,Qe,An,Yn]);ye.useEffect(()=>{if(!t){localStorage.removeItem("gemini_api_key"),xe(!1);return}localStorage.removeItem("gemini_api_key"),xe(!1),(async()=>{try{const Ie=await _b.getSharedApiKey(t.uid);if(Ie)return localStorage.setItem("gemini_api_key",Ie),xe(!0),!0}catch(Ie){console.error(" API Key :",Ie)}return!1})().then(Ie=>{if(!Ie){const ze=xb.subscribe(qe=>{qe!=null&&qe.apiKey?(localStorage.setItem("gemini_api_key",qe.apiKey),xe(!0)):(localStorage.removeItem("gemini_api_key"),xe(!1))});return()=>ze()}})},[t]),ye.useEffect(()=>{const Se=T2.subscribe(Ie=>{Mt(Ie.length)});return()=>Se()},[]),ye.useEffect(()=>{const Se=fS.subscribe(Ie=>{if(as(Ie),Tn){const ze=Ie.find(qe=>qe.id===Tn);Rr(ze?ze.name:"")}});return()=>Se()},[Tn]),ye.useEffect(()=>{if(!r){Vs(0);return}const Se=io.subscribeAll(Ie=>{const ze=Ie.filter(qe=>qe.role===Ns.PENDING_REVIEW||qe.role===Ns.PENDING);Vs(ze.length)});return()=>Se()},[r]),ye.useEffect(()=>{if(!Qe){qr([]);return}const Se=On.subscribeByUserId(Qe.id,Ie=>{const ze=Ie.map(qe=>({...qe,id:parseInt(qe.id)||qe.id,selectedTags:qe.selectedTags||[],manualTraits:qe.manualTraits||"",comment:qe.comment||""}));qr(ze)});return()=>Se()},[Qe]);const[Qn,cn]=ye.useState(new Set),[os,Cn]=ye.useState(null),Da=Se=>{Xn(Se),cn(new Set),Cn(null)},Es=()=>{Xn(null),cn(new Set),Cn(null)},ls=Se=>{cn(Ie=>{const ze=new Set(Ie);return ze.has(Se)?ze.delete(Se):ze.add(Se),ze})},P=()=>{Qn.size===Rt.length&&Rt.length>0?cn(new Set):cn(new Set(Rt.map(Se=>Se.id)))},q=async(Se,Ie,ze)=>{if(Qe){qr(qe=>qe.map(rt=>rt.id===Se?{...rt,[Ie]:ze}:rt));try{const qe=Rt.find(rt=>rt.id===Se);qe&&await On.updateByUserId(Qe.id,Se,{...qe,[Ie]:ze})}catch(qe){console.error(":",qe)}}},H=async(Se,Ie)=>{if(!Qe)return;const ze=Rt.find(rt=>rt.id===Se);if(!ze)return;const qe=ze.selectedTags.filter(rt=>rt!==Ie);qr(rt=>rt.map(Nt=>Nt.id===Se?{...Nt,selectedTags:qe}:Nt));try{await On.updateByUserId(Qe.id,Se,{selectedTags:qe})}catch(rt){console.error(":",rt)}},G=async Se=>{if(Qe){qr(Ie=>Ie.filter(ze=>ze.id!==Se)),cn(Ie=>{const ze=new Set(Ie);return ze.delete(Se),ze});try{await On.deleteByUserId(Qe.id,Se)}catch(Ie){console.error(":",Ie)}}},K=async()=>{if(!Qe||Qn.size===0)return;const Se=Array.from(Qn);qr(Ie=>Ie.filter(ze=>!Qn.has(ze.id))),cn(new Set);try{for(const Ie of Se)await On.deleteByUserId(Qe.id,Ie)}catch(Ie){console.error(":",Ie)}},X=async(Se,Ie)=>{if(!(!Qe||Se.length===0)){qr(ze=>ze.map(qe=>{if(Se.includes(qe.id)){const rt=qe.selectedTags.includes(Ie)?qe.selectedTags:[...qe.selectedTags,Ie];return{...qe,selectedTags:rt}}return qe}));try{for(const ze of Se){const qe=Rt.find(rt=>rt.id===ze);if(qe&&!qe.selectedTags.includes(Ie)){const rt=[...qe.selectedTags,Ie];await On.updateByUserId(Qe.id,ze,{selectedTags:rt})}}}catch(ze){console.error(":",ze)}}},[ce,me]=ye.useState({" ()":!0," ()":!0});ye.useEffect(()=>{const Se=()=>ee(window.innerWidth<768);return Se(),window.addEventListener("resize",Se),()=>window.removeEventListener("resize",Se)},[]);const le=()=>{F.trim()&&(k(F),I(""))},ue=()=>{if(U<1)return;const Se=[];for(let ze=1;ze<=U;ze++){const qe=ze<10?`0${ze}`:`${ze}`;Se.push(`${qe}`)}const Ie=Se.join(`
`);I(ze=>ze?`${ze}
${Ie}`:Ie)},fe=()=>{o("","",()=>{M(),i()})},Ne=()=>{x.size!==0&&o("",` ${x.size} `,()=>{R(),i()})},Ue=Se=>{let Ie=[];if(Qe){if(Qn.size>0?Ie=Array.from(Qn):os&&(Ie=[os]),Ie.length===0){c("");return}X(Ie,Se)}else{if(x.size>0?Ie=Array.from(x):Ve&&(Ie=[Ve]),Ie.length===0){c("");return}W(Ie,Se)}},Ge=Se=>{me(Ie=>({...Ie,[Se]:!Ie[Se]}))},Oe=Se=>{te(Ie=>Ie.includes(Se)?Ie.filter(qe=>qe!==Se):Ie.length>=2?Ie:[...Ie,Se])},Pe=async(Se=!1)=>{Re(!0);const Ie=d.filter(Nt=>Se?x.has(Nt.id):!0),ze=Ie.length;if(ze===0){Re(!1);return}ne({current:0,total:ze});let qe=0,rt=0;for(let Nt=0;Nt<ze;Nt++){const Gt=Ie[Nt];g(un=>un.map(fn=>fn.id===Gt.id?{...fn,comment:""}:fn));const Us=[...Gt.selectedTags,Gt.manualTraits].filter(Boolean).join(""),bt=await fm(Gt.name,Us,O,Te);g(un=>un.map(fn=>fn.id===Gt.id?{...fn,comment:bt}:fn)),await A(Gt.id,bt),bt.includes("")?rt++:qe++,ne(un=>({...un,current:Nt+1}))}Re(!1),ne({current:0,total:0}),rt>0&&qe===0?n.error(" API Key"):rt>0?n.warning(` ${qe} ${rt} `):n.success(`  ${ze} `)},ft=Se=>{gC(ln,Se)},$t=async Se=>{const Ie=d.find(rt=>rt.id===Se);if(!Ie)return;if(At(Se),Ie.comment&&!Ie.comment.includes(""))try{await S2.add(Se,Ie.comment,O)}catch(rt){console.error(":",rt)}const ze=[...Ie.selectedTags,Ie.manualTraits].filter(Boolean).join(""),qe=await fm(Ie.name,ze,O,Te);g(rt=>rt.map(Nt=>Nt.id===Se?{...Nt,comment:qe}:Nt)),await A(Se,qe),At(null),qe.includes("")?n.error(`${Ie.name}${qe.replace(" ","")}`):n.success(` ${Ie.name} `)},Qt=async Se=>{if(!Qe)return;const Ie=Rt.find(rt=>rt.id===Se);if(!Ie)return;At(Se);const ze=[...Ie.selectedTags,Ie.manualTraits].filter(Boolean).join(""),qe=await fm(Ie.name,ze,O,Te);qr(rt=>rt.map(Nt=>Nt.id===Se?{...Nt,comment:qe}:Nt));try{await On.updateByUserId(Qe.id,Se,{comment:qe})}catch(rt){console.error(":",rt)}At(null),qe.includes("")?n.error(`${Ie.name}${qe.replace(" ","")}`):n.success(` ${Ie.name} `)},lr=async Se=>{try{await T2.add({content:Se.comment,studentName:Se.name,tags:Se.selectedTags,styles:O}),n.success(" ")}catch(Ie){console.error(":",Ie),n.error("")}},Ts=Se=>{Ve&&(y(Ve,"comment",Se),A(Ve,Se))},cs=async(Se,Ie,ze)=>{const qe=d.find(Nt=>Nt.id===Se);if(!qe||!qe.comment)return;if(Lt(Se),!qe.comment.includes(""))try{await S2.add(Se,qe.comment,O)}catch(Nt){console.error(":",Nt)}const rt=await zA(qe.comment,Ie,ze);if(g(Nt=>Nt.map(Gt=>Gt.id===Se?{...Gt,comment:rt}:Gt)),await A(Se,rt),Lt(null),rt.includes(""))n.error(`${qe.name}${rt.replace(" ","")}`);else{const Nt={shorter:"",detailed:"",rephrase:""};n.success(` ${qe.name} ${Nt[Ie]||""}`)}},Jn=async(Se,Ie)=>{Ie==="replace"&&await clearAllStudents();for(const ze of Se)await addStudent(ze.name,ze.selectedTags,ze.comment)};return w.jsxs("div",{className:"min-h-screen max-w-full overflow-x-hidden text-[#2D3436] font-sans flex flex-col relative",children:[_&&w.jsx(VU,{}),w.jsx(Sb,{dialog:s,closeDialog:i}),De&&w.jsx(kb,{progress:Ae}),w.jsxs(ye.Suspense,{fallback:w.jsx(UU,{}),children:[w.jsx(HU,{isOpen:J,onClose:()=>Z(!1),globalStyles:O,toggleGlobalStyle:Oe}),w.jsx(WU,{isOpen:oe,onClose:()=>{_e(!1),xe(H_())},currentUser:t}),w.jsx($U,{isOpen:xt,onClose:()=>je(!1),onApplyTemplate:Ts}),w.jsx(GU,{isOpen:Bt,onClose:()=>xr(!1),currentClassId:Tn,onSelectClass:Se=>{Sn(Se),Se||Rr(""),Xn(null)},currentUser:t,onViewUserStudents:Da}),w.jsx(qU,{isOpen:or,onClose:()=>{Zr(!1),jt(null)},student:ot,onRestore:Se=>{ot&&(y(ot.id,"comment",Se),A(ot.id,Se))}}),w.jsx(KU,{isOpen:u,onClose:()=>h(!1),currentUser:t}),w.jsx(XU,{isOpen:Gr,onClose:()=>Yt(!1),students:Qe?Rt:d,onImport:Qe?()=>{}:Jn,currentClassName:Qe?`${Qe.displayName} `:_r}),w.jsx(YU,{isOpen:kn,onClose:()=>ni(!1),students:Qe?Rt:d,currentClassName:Qe?`${Qe.displayName} `:_r}),w.jsx(QU,{isOpen:Kn,onClose:()=>si(!1),students:Qe?Rt:d,currentClassName:Qe?`${Qe.displayName} `:_r})]}),w.jsx(Eb,{isSidebarOpen:D,setIsSidebarOpen:B,onOpenSettings:()=>_e(!0),onOpenTemplates:()=>je(!0),onOpenClasses:()=>xr(!0),onOpenAdmin:()=>h(!0),onOpenImportExport:()=>Yt(!0),onOpenPrint:()=>ni(!0),onOpenDashboard:()=>si(!0),onLogout:e,hasApiKey:ve,templateCount:Zt,currentClassName:_r,currentUser:t,isAdmin:r,pendingCount:ws}),w.jsxs("div",{className:"flex flex-col flex-1 w-full mx-auto relative",children:[w.jsxs("div",{className:"p-3 sm:p-6 bg-[#FFFDF5] border-b-4 border-[#2D3436] flex flex-col lg:flex-row gap-4 sm:gap-6 items-stretch",children:[w.jsx(FU,{rawInput:F,setRawInput:I,numberCount:U,setNumberCount:L,onGenerateStudents:le,onGenerateNumbers:ue,onResetList:fe,isGenerating:De}),w.jsx(RU,{students:ln,selectedIds:Qe?Qn:x,isGenerating:De,extraSettings:Te,setExtraSettings:ut,onGenerateSelected:Qe?()=>{}:()=>Pe(!0),onGenerateAll:Qe?()=>{}:()=>Pe(!1),onDownload:ft,onDeleteSelected:Qe?K:Ne,onResetList:Qe?()=>{}:fe,isViewingMode:!!Qe})]}),w.jsxs("div",{className:"flex-1 p-3 sm:p-6",children:[Qe&&w.jsxs("div",{className:"mb-4 p-3 sm:p-4 bg-[#54A0FF]/20 border-2 border-[#54A0FF] rounded-lg flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[w.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[Qe.photoURL?w.jsx("img",{src:Qe.photoURL,alt:"",className:"w-10 h-10 rounded-full border-2 border-[#54A0FF] shrink-0"}):w.jsx("div",{className:"w-10 h-10 bg-[#FECA57] rounded-full border-2 border-[#54A0FF] flex items-center justify-center text-lg shrink-0",children:""}),w.jsxs("div",{className:"min-w-0",children:[w.jsxs("p",{className:"font-bold text-[#2D3436] text-sm sm:text-base truncate",children:["  ",Qe.displayName," "]}),w.jsxs("p",{className:"text-xs text-[#636E72] truncate",children:[Qe.email,Qe.customSchoolName&&`  ${Qe.customSchoolName}`]})]})]}),w.jsx("button",{onClick:Es,className:"btn-pop px-4 py-2 bg-[#54A0FF] text-white text-sm font-bold shrink-0",children:" "})]}),!Qe&&w.jsx(zU,{searchQuery:An,setSearchQuery:Bs,filters:Yn,setFilters:ba,totalCount:d.length,filteredCount:ln.length}),w.jsx(NU,{globalStyles:O,onOpenStyleModal:()=>Z(!0),isGenerating:De}),w.jsx(LU,{students:ln,selectedIds:Qe?Qn:x,focusedStudentId:Qe?os:Ve,isGenerating:De,isGeneratingSingle:Y,onToggleSelection:Qe?ls:N,onToggleAllSelection:Qe?P:V,onFocusStudent:Qe?Cn:Le,onOpenSidebar:()=>B(!0),onRemoveTag:Qe?H:j,onUpdateStudent:Qe?q:y,onDeleteStudent:Qe?G:S,onGenerateSingle:Qe?Qt:$t,onSaveTemplate:Qe?()=>{}:lr,onOpenHistory:Qe?()=>{}:Se=>{jt(Se),Zr(!0)},readOnly:!1,searchQuery:An,onAdjustComment:Qe?()=>{}:cs,adjustingStudentId:wt})]}),w.jsx(MU,{isOpen:D,onClose:()=>B(!1),selectedIds:x,expandedCategories:ce,onToggleCategory:Ge,onIdiomClick:Ue,userId:t==null?void 0:t.uid})]}),w.jsx(Tb,{}),w.jsx(BU,{})]})},ZU=()=>{const t=navigator.userAgent||navigator.vendor||window.opera,r=["Line/","FBAN","FBAV","Instagram","Twitter","MicroMessenger","WebView","wv)"].some(i=>t.includes(i)),n=/iPad|iPhone|iPod/.test(t),s=/Android/.test(t);return{isInApp:r,isIOS:n,isAndroid:s}},ej=({onLogin:t})=>{const[e,r]=ye.useState(!1),[n,s]=ye.useState(null),[i,o]=ye.useState(!1),[c]=ye.useState(()=>ZU()),u=window.location.href,h=async()=>{var x,_;r(!0),s(null);const g=await vg.signInWithGoogle();g.success||((x=g.error)!=null&&x.includes("popup")||(_=g.error)!=null&&_.includes("blocked")?s("popup-blocked"):s(g.error)),r(!1)},d=async()=>{try{await navigator.clipboard.writeText(u),o(!0),setTimeout(()=>o(!1),2e3)}catch{const x=document.createElement("textarea");x.value=u,document.body.appendChild(x),x.select(),document.execCommand("copy"),document.body.removeChild(x),o(!0),setTimeout(()=>o(!1),2e3)}};return w.jsx("div",{className:"min-h-screen bg-[#FFF9E6] flex items-center justify-center p-4",children:w.jsxs("div",{className:"card-pop w-full max-w-md p-6 sm:p-8 text-center",children:[w.jsxs("div",{className:"mb-6",children:[w.jsx("div",{className:"inline-block bg-[#FECA57] text-[#2D3436] p-4 border-3 border-[#2D3436] shadow-[4px_4px_0_#2D3436] transform rotate-[-3deg] rounded-lg mb-4",children:w.jsx("span",{className:"text-5xl",children:""})}),w.jsx("h1",{className:"text-3xl font-black text-[#2D3436]",children:w.jsxs("span",{className:"relative",children:[w.jsx("span",{className:"relative z-10",children:""}),w.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-3 bg-[#FF6B9D] -z-0 transform -rotate-1"})]})}),w.jsx("p",{className:"text-[#636E72] font-bold mt-2",children:"AI "})]}),c.isInApp?w.jsxs("div",{className:"bg-[#FF9F43]/20 border-2 border-[#FF9F43] rounded-lg p-4 mb-4 text-left",children:[w.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[w.jsx(Mg,{size:20,className:"text-[#FF9F43] flex-shrink-0 mt-0.5"}),w.jsxs("div",{children:[w.jsx("p",{className:"font-bold text-[#2D3436] text-sm",children:" App "}),w.jsx("p",{className:"text-xs text-[#636E72] mt-1",children:"Google  LINEFacebook  App "})]})]}),w.jsxs("div",{className:"bg-white rounded-lg p-3 border border-[#FF9F43]/30",children:[w.jsx("p",{className:"text-xs font-bold text-[#2D3436] mb-2",children:" "}),w.jsx("ol",{className:"text-xs text-[#636E72] space-y-1.5 ml-4 list-decimal",children:c.isIOS?w.jsxs(w.Fragment,{children:[w.jsxs("li",{children:[" ",w.jsx("strong",{children:""}),"  ",w.jsx("strong",{children:""})," "]}),w.jsxs("li",{children:["",w.jsx("strong",{children:" Safari "}),"",w.jsx("strong",{children:""}),""]})]}):c.isAndroid?w.jsxs(w.Fragment,{children:[w.jsxs("li",{children:[" ",w.jsx("strong",{children:""})," "]}),w.jsxs("li",{children:["",w.jsx("strong",{children:" Chrome "}),"",w.jsx("strong",{children:""}),""]})]}):w.jsxs(w.Fragment,{children:[w.jsx("li",{children:""}),w.jsxs("li",{children:["",w.jsx("strong",{children:""}),""]})]})})]}),w.jsx("button",{onClick:d,className:"w-full mt-3 py-3 px-3 bg-[#FF9F43] text-white rounded-lg text-sm font-bold flex items-center justify-center gap-2 active:opacity-80 border-2 border-[#2D3436] shadow-[3px_3px_0_#2D3436]",children:i?w.jsxs(w.Fragment,{children:[w.jsx(Ju,{size:18})," "]}):w.jsxs(w.Fragment,{children:[w.jsx(Um,{size:18})," "]})}),w.jsx("p",{className:"text-xs text-[#636E72] text-center mt-3",children:"  Safari / Chrome "})]}):w.jsxs(w.Fragment,{children:[w.jsx("div",{className:"bg-[#54A0FF]/20 border-2 border-dashed border-[#54A0FF] rounded-lg p-4 mb-4 text-left",children:w.jsx("p",{className:"text-sm text-[#2D3436] font-medium",children:"  Google "})}),n&&w.jsx("div",{className:"bg-[#FF6B6B]/20 border-2 border-[#FF6B6B] rounded-lg p-3 mb-4 text-left",children:n==="popup-blocked"?w.jsxs(w.Fragment,{children:[w.jsx("p",{className:"font-bold text-[#FF6B6B] text-sm mb-2",children:" Firebase: Error (auth/popup-blocked)."}),w.jsxs("div",{className:"text-xs text-[#636E72] space-y-2",children:[w.jsx("p",{children:"Google "}),w.jsx("div",{className:"bg-white rounded p-2 space-y-1",children:c.isIOS?w.jsxs("ol",{className:"list-decimal ml-4 space-y-1",children:[w.jsxs("li",{children:[" ",w.jsx("strong",{children:""})," "]}),w.jsxs("li",{children:["",w.jsx("strong",{children:" Safari "}),""]}),w.jsx("li",{children:" Safari "})]}):c.isAndroid?w.jsxs("ol",{className:"list-decimal ml-4 space-y-1",children:[w.jsxs("li",{children:[" ",w.jsx("strong",{children:""})," "]}),w.jsxs("li",{children:["",w.jsx("strong",{children:" Chrome "}),""]}),w.jsx("li",{children:" Chrome "})]}):w.jsxs("ol",{className:"list-decimal ml-4 space-y-1",children:[w.jsx("li",{children:""}),w.jsx("li",{children:""}),w.jsx("li",{children:""})]})}),w.jsx("button",{onClick:d,className:"w-full py-2 bg-[#FF6B6B] text-white rounded font-bold text-xs flex items-center justify-center gap-1",children:i?w.jsxs(w.Fragment,{children:[w.jsx(Ju,{size:14})," "]}):w.jsxs(w.Fragment,{children:[w.jsx(Um,{size:14})," "]})})]})]}):w.jsxs("p",{className:"text-sm text-[#FF6B6B] font-bold",children:[" ",n]})}),w.jsx("button",{onClick:h,disabled:e,className:"btn-pop w-full py-4 bg-white text-[#2D3436] font-bold flex items-center justify-center gap-3 text-lg disabled:opacity-50",children:e?w.jsx("span",{className:"animate-spin text-2xl",children:""}):w.jsxs(w.Fragment,{children:[w.jsxs("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",children:[w.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),w.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),w.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),w.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})," Google "]})})]}),w.jsx("p",{className:"text-xs text-[#636E72]/50 mt-6",children:" 2026 "})]})})},tj=["","","","","","","","","","","","","","","","","","","","","",""],rj=({user:t,onLogout:e,schools:r=[],onSubmitApplication:n,needsInfo:s})=>{var I,U,L;const[i,o]=ye.useState("custom"),[c,u]=ye.useState(null),[h,d]=ye.useState(""),[g,x]=ye.useState(""),[_,k]=ye.useState([]),[y,S]=ye.useState(""),[R,M]=ye.useState(!1),N=()=>{const D=y.trim();D&&!_.includes(D)&&(k([..._,D]),S(""))},V=D=>{k(_.filter(B=>B!==D))},W=()=>i==="select"&&c?{schoolId:c,schoolName:null,schoolCity:null}:i==="custom"&&g.trim()?{schoolId:null,schoolName:g.trim(),schoolCity:h}:null,j=()=>W()&&_.length>0,A=async()=>{if(!j())return;const D=W();M(!0);try{await n(t.uid,D,_)}catch(B){console.error(":",B)}M(!1)},F=D=>{D.key==="Enter"&&(D.preventDefault(),N())};return w.jsx("div",{className:"min-h-screen bg-[#FFF9E6] flex items-center justify-center p-4",children:w.jsxs("div",{className:"card-pop w-full max-w-lg p-6 sm:p-8",children:[w.jsx("div",{className:"mb-6 text-center",children:t!=null&&t.photoURL?w.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full border-3 border-[#2D3436] shadow-[3px_3px_0_#2D3436] mx-auto"}):w.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-[#FECA57] rounded-full border-3 border-[#2D3436] shadow-[3px_3px_0_#2D3436] mx-auto flex items-center justify-center",children:w.jsx("span",{className:"text-3xl sm:text-4xl",children:""})})}),w.jsxs("h2",{className:"text-xl sm:text-2xl font-black text-[#2D3436] mb-2 text-center",children:["",(t==null?void 0:t.displayName)||"",""]}),w.jsx("p",{className:"text-[#636E72] text-xs sm:text-sm mb-6 text-center",children:t==null?void 0:t.email}),s?w.jsxs("div",{className:"space-y-4",children:[w.jsx("div",{className:"bg-[#54A0FF]/10 border-2 border-dashed border-[#54A0FF] rounded-lg p-4 mb-4",children:w.jsx("p",{className:"text-sm text-[#2D3436] font-medium text-center",children:" "})}),w.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg p-4",children:[w.jsxs("h4",{className:"font-bold text-[#2D3436] mb-3 flex items-center gap-2 text-sm sm:text-base",children:[w.jsx(GA,{size:18}),""]}),w.jsxs("div",{className:"flex gap-2 mb-3",children:[w.jsx("button",{onClick:()=>o("custom"),className:`flex-1 px-3 py-2 border-2 border-[#2D3436] rounded-lg font-bold text-xs sm:text-sm transition-all
                                        ${i==="custom"?"bg-[#A29BFE] text-white shadow-[2px_2px_0_#2D3436]":"bg-white hover:bg-[#A29BFE]/20"}`,children:" "}),r.length>0&&w.jsx("button",{onClick:()=>o("select"),className:`flex-1 px-3 py-2 border-2 border-[#2D3436] rounded-lg font-bold text-xs sm:text-sm transition-all
                                            ${i==="select"?"bg-[#A29BFE] text-white shadow-[2px_2px_0_#2D3436]":"bg-white hover:bg-[#A29BFE]/20"}`,children:" "})]}),i==="custom"?w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex gap-2",children:[w.jsx("select",{value:h,onChange:D=>d(D.target.value),className:"px-3 py-2 border-2 border-[#2D3436] rounded-lg font-medium bg-white text-sm",children:tj.map(D=>w.jsx("option",{value:D,children:D},D))}),w.jsx("input",{type:"text",value:g,onChange:D=>x(D.target.value),placeholder:"",className:"flex-1 px-3 py-2 border-2 border-[#2D3436] rounded-lg text-sm font-medium"})]}),g.trim()&&w.jsxs("div",{className:"flex items-center gap-2 text-sm text-[#1DD1A1]",children:[w.jsx(Ju,{size:16}),w.jsxs("span",{children:["",h," ",g.trim()]})]})]}):w.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(D=>w.jsxs("button",{onClick:()=>u(c===D.id?null:D.id),className:`px-3 py-2 border-2 border-[#2D3436] rounded-lg font-bold text-xs sm:text-sm transition-all
                                              ${c===D.id?"bg-[#A29BFE] text-white shadow-[2px_2px_0_#2D3436]":"bg-white hover:bg-[#A29BFE]/20"}`,children:[c===D.id&&w.jsx(Ju,{size:14,className:"inline mr-1"})," ",D.name,D.city&&w.jsxs("span",{className:"opacity-70 ml-1",children:["(",D.city,")"]})]},D.id))})]}),w.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg p-4",children:[w.jsxs("h4",{className:"font-bold text-[#2D3436] mb-3 flex items-center gap-2 text-sm sm:text-base",children:[w.jsx(Hm,{size:18}),""]}),_.length>0&&w.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:_.map(D=>w.jsxs("span",{className:"px-3 py-1.5 bg-[#1DD1A1] text-white text-xs sm:text-sm font-bold rounded-lg flex items-center gap-1 border-2 border-[#2D3436]",children:[D,w.jsx("button",{onClick:()=>V(D),className:"hover:bg-white/20 rounded p-0.5",children:w.jsx(ol,{size:14})})]},D))}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{type:"text",value:y,onChange:D=>S(D.target.value),onKeyDown:F,placeholder:"",className:"flex-1 px-3 py-2 border-2 border-[#2D3436] rounded-lg text-sm font-medium"}),w.jsxs("button",{onClick:N,disabled:!y.trim(),className:"btn-pop px-3 py-2 bg-[#1DD1A1] text-white font-bold disabled:opacity-50 flex items-center gap-1",children:[w.jsx(Bw,{size:16}),w.jsx("span",{className:"hidden sm:inline",children:""})]})]})]}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-2",children:[w.jsx("button",{onClick:e,className:"btn-pop px-4 py-3 bg-[#636E72] text-white font-bold order-2 sm:order-1",children:""}),w.jsxs("button",{onClick:A,disabled:!j()||R,className:"btn-pop px-4 py-3 bg-[#54A0FF] text-white font-bold flex-1 flex items-center justify-center gap-2 disabled:opacity-50 order-1 sm:order-2",children:[w.jsx(oC,{size:18}),R?"...":""]})]})]}):w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"bg-[#FECA57]/30 border-3 border-[#FECA57] rounded-lg p-6 mb-6",children:[w.jsx("div",{className:"text-4xl mb-3 animate-bounce",children:w.jsx(Dg,{size:48,className:"mx-auto text-[#FF9F43]"})}),w.jsx("h3",{className:"text-lg sm:text-xl font-black text-[#2D3436] mb-2 text-center",children:" "}),w.jsxs("p",{className:"text-xs sm:text-sm text-[#636E72] font-medium text-center",children:["",w.jsx("br",{}),""]})]}),((t==null?void 0:t.requestedSchoolName)||(t==null?void 0:t.requestedSchoolId)||((I=t==null?void 0:t.requestedClasses)==null?void 0:I.length)>0)&&w.jsxs("div",{className:"bg-white border-2 border-[#2D3436] rounded-lg p-4 mb-6",children:[w.jsx("h4",{className:"font-bold text-[#2D3436] mb-2 text-sm",children:" "}),t.requestedSchoolName&&w.jsxs("p",{className:"text-xs sm:text-sm text-[#636E72]",children:[w.jsx("span",{className:"font-medium",children:""}),t.requestedSchoolCity&&`${t.requestedSchoolCity} `,t.requestedSchoolName]}),t.requestedSchoolId&&r.length>0&&!t.requestedSchoolName&&w.jsxs("p",{className:"text-xs sm:text-sm text-[#636E72]",children:[w.jsx("span",{className:"font-medium",children:""}),((U=r.find(D=>D.id===t.requestedSchoolId))==null?void 0:U.name)||""]}),((L=t.requestedClasses)==null?void 0:L.length)>0&&w.jsxs("p",{className:"text-xs sm:text-sm text-[#636E72]",children:[w.jsx("span",{className:"font-medium",children:""}),t.requestedClasses.join("")]})]}),w.jsx("div",{className:"bg-[#54A0FF]/10 border-2 border-dashed border-[#54A0FF] rounded-lg p-4 mb-6 text-left",children:w.jsxs("p",{className:"text-xs text-[#636E72]",children:[" ",w.jsx("strong",{children:""})," (cagooo@gmail.com) "]})}),w.jsx("button",{onClick:e,className:"btn-pop w-full px-6 py-3 bg-[#636E72] text-white font-bold",children:""})]})]})})},nj=({children:t})=>{var x;const[e,r]=ye.useState(null),[n,s]=ye.useState(!0),[i,o]=ye.useState([]),[c,u]=ye.useState([]);ye.useEffect(()=>{const _=vg.onAuthStateChange(k=>{r(k),s(!1)});return()=>_()},[]),ye.useEffect(()=>{if(!e)return;const _=vb.subscribe(y=>{o(y)}),k=fS.subscribe(y=>{u(y)});return()=>{_(),k()}},[e]);const h=e?{...e,schoolName:e.schoolId?(x=i.find(_=>_.id===e.schoolId))==null?void 0:x.name:e.customSchoolName?e.customSchoolCity?`${e.customSchoolCity} ${e.customSchoolName}`:e.customSchoolName:null,assignedClassNames:(e.assignedClasses||[]).map(_=>{var k;return(k=c.find(y=>y.id===_))==null?void 0:k.name}).filter(Boolean)}:null,d=async()=>{await vg.signOut(),r(null)},g=async(_,k,y)=>{const S=await io.submitApplication(_,k,y);if(S.success){const R=await io.get(_);R&&r(R)}return S};return n?w.jsx("div",{className:"min-h-screen bg-[#FFF9E6] flex items-center justify-center",children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-6xl animate-bounce mb-4",children:""}),w.jsx("p",{className:"font-bold text-[#2D3436]",children:"..."})]})}):e?io.isApproved(e)?Sf.cloneElement(t,{currentUser:h,onLogout:d,isAdmin:io.isAdmin(e)}):w.jsx(rj,{user:e,onLogout:d,schools:i,onSubmitApplication:g,needsInfo:io.needsInfo(e)}):w.jsx(ej,{})};class sj extends Sf.Component{constructor(r){super(r);sm(this,"handleReload",()=>{window.location.reload()});sm(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){this.setState({errorInfo:n}),console.error(" ErrorBoundary :",r,n)}render(){return this.state.hasError?w.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-[#FFF9E6] to-[#FFE4E1] p-4",children:w.jsxs("div",{className:"card-pop max-w-md w-full p-8 bg-white text-center",children:[w.jsxs("div",{className:"mb-6",children:[w.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-[#FF6B6B]/20 rounded-full mb-4",children:w.jsx(Mg,{size:40,className:"text-[#FF6B6B]"})}),w.jsx("div",{className:"text-4xl",children:""})]}),w.jsx("h1",{className:"text-2xl font-black text-[#2D3436] mb-2",children:""}),w.jsx("p",{className:"text-[#636E72] mb-6",children:""}),!1,w.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[w.jsx("button",{onClick:this.handleReset,className:"btn-pop flex-1 py-3 px-4 bg-[#636E72] text-white font-bold flex items-center justify-center gap-2",children:""}),w.jsxs("button",{onClick:this.handleReload,className:"btn-pop flex-1 py-3 px-4 bg-[#FF6B9D] text-white font-bold flex items-center justify-center gap-2",children:[w.jsx(Og,{size:18}),""]})]}),w.jsx("p",{className:"mt-6 text-xs text-[#636E72]",children:""})]})}):this.props.children}}BA.createRoot(document.getElementById("root")).render(w.jsx(Sf.StrictMode,{children:w.jsx(sj,{children:w.jsx(mC,{children:w.jsx(nj,{children:w.jsx(JU,{})})})})}));export{cj as A,GA as B,XA as C,jm as D,$_ as E,zm as F,W_ as G,Pg as H,Xh as I,Ow as J,id as L,Bw as P,Lw as S,Lg as T,Ns as U,ol as X,Ca as _,KA as a,_b as b,kt as c,Um as d,fS as e,vb as f,Hm as g,Ju as h,qA as i,w as j,S2 as k,Dg as l,On as m,q_ as n,aC as o,fC as p,YA as q,ye as r,xb as s,T2 as t,io as u,zw as v,hC as w,CU as x,oj as y,lj as z};
